  
************************************************************************
*                                                                       
* fourzqcd.f                                                            
*                                                                       
* Date: Apr 11, 2006                                                    
* Last update: Jul 26, 2006                                             
*                                                                       
* This routine computes the basic amplitude corresponding to 8          
* outgoing  fermions which can form 4Z.                                 
* All 8 fermions  are supposed  massless.                               
* The input particles are ordered from 1 to 8 in such a way that        
* odd are particles, even antiparticles.                                
* p1, ...p8 are all outgoing momenta                                    
* id1....id8 give the identities of the outgoing particles              
* The routine gives the result "res" which is in this case the modulus  
* square of only 3 forks topologies the different declararion are also  
* temporary                                                             
*                                                                       
* Added QCD contributions of order (alpha_em**4 alpha_strong**2).       
* (To see QCD lines, enter **QCD in I-search)                           
* The subroutine returns the 7 contributions to the total amplitude     
* corresponding to 7 different colour flow configurations.              
* The colour flow configurations are the following (expressed in terms  
* of colour flow lines):                                                
*                                                                       
* cfg #1:    1| 3| 5| 7|   (pure electroweak contribution)              
*             |  |  |  |                                                
*            2| 4| 6| 8|                                                
*                                                                       
*                                                                       
* cfg #2:    5| 1| 3| 7|   (QCD contribution)                           
*             |  |~~|  |                                                
*            6| 2| 4| 8|                                                
*                                                                       
*                                                                       
* cfg #3:    3| 1| 5| 7|   (QCD contribution)                           
*             |  |~~|  |                                                
*            4| 2| 6| 8|                                                
*                                                                       
*                                                                       
* cfg #4:    1| 3| 5| 7|   (QCD contribution)                           
*             |  |~~|  |                                                
*            2| 4| 6| 8|                                                
*                                                                       
*                                                                       
* cfg #5:    3| 1| 7| 5|   (QCD contribution)                           
*             |  |~~|  |                                                
*            4| 2| 8| 6|                                                
*                                                                       
*                                                                       
* cfg #6:    1| 3| 7| 5|   (QCD contribution)                           
*             |  |~~|  |                                                
*            2| 4| 8| 6|                                                
*                                                                       
*                                                                       
* cfg #7:    1| 5| 7| 3|   (QCD contribution)                           
*             |  |~~|  |                                                
*            2| 6| 8| 4|                                                
*                                                                       
************************************************************************
*  Comments:   "Z"  stay for a couple of particles                      
*  which can form a Z (particle anti-particle) .                        
*  Correspondingly  Zline stay for a fermion line which                 
*  ends with two particles  which can form a Z (particle anti-particle) 
*                                                                       
  
      subroutine fourzqcd(p1,p2,p3,p4,p5,p6,p7,p8,
     &              id1,id2,id3,id4,id5,id6,id7,id8,cres)
  
      implicit real*8 (a-b,d-h,o-z)
      implicit double complex (c)
  
  
*FOUR MOMENTA                                                           
  
*single momenta                                                         
      dimension p1(0:3),p2(0:3),p3(0:3),p4(0:3),p5(0:3),p6(0:3),
     &     p7(0:3),p8(0:3)
  
  
*forks momenta                                                          
      dimension p12(0:3),p34(0:3),p56(0:3),p78(0:3)
  
  
*left insertion momenta                                                 
      dimension p134(0:3),p156(0:3),p178(0:3),p312(0:3),p356(0:3),
     &     p378(0:3),p512(0:3),p534(0:3),p578(0:3),p712(0:3),p734(0:3),
     &     p756(0:3),p1234(0:3),p1256(0:3),p1278(0:3),
     &     p3456(0:3),p3478(0:3),p5678(0:3)
  
  
*right insertion momenta                                                
      dimension p234(0:3),p256(0:3),p278(0:3),p412(0:3),p456(0:3),
     &     p478(0:3),p612(0:3),p634(0:3),p678(0:3),p812(0:3),p856(0:3),
     &     p834(0:3)
  
  
*auxiliary structure used in mline                                      
      type aux
         double complex a(2,2),b(2,2),c(2,2),d(2,2)
      end type
      type(aux) clineth,clinet_mu(0:3),clineth_4f(2,2)
  
  
*forks                                                                  
      dimension ch12(2,2),ch34(2,2), ch56(2,2),ch78(2,2),
     &     cz1234(2,2,2,2,0:3),cf1234(2,2,2,2,0:3),
     &     cz1256(2,2,2,2,0:3),cf1256(2,2,2,2,0:3),
     &     cz3478(2,2,2,2,0:3),cf3478(2,2,2,2,0:3),
     &     cz5678(2,2,2,2,0:3),cf5678(2,2,2,2,0:3),
     &     cz1278(2,2,2,2,0:3),cf1278(2,2,2,2,0:3),
     &     cz3456(2,2,2,2,0:3),cf3456(2,2,2,2,0:3),
     &     ch1234(2,2,2,2),ch5678(2,2,2,2),ch1278(2,2,2,2),
     &     ch1256(2,2,2,2),ch3456(2,2,2,2),ch3478(2,2,2,2),
     &     cp1234dotcz1234(2,2,2,2),cp1234dotcz5678(2,2,2,2),
     &     cp1256dotcz1256(2,2,2,2),cp1256dotcz3478(2,2,2,2),
     &     cp1278dotcz1278(2,2,2,2),cp1278dotcz3456(2,2,2,2),
     &     cz_zzhh5678(2,2,2,2),cz_zzhh1234(2,2,2,2),
     &     cz_zzhh3478(2,2,2,2),cz_zzhh1256(2,2,2,2),
     &     cz_zzhh3456(2,2,2,2),cz_zzhh1278(2,2,2,2),
**QCD                                                                   
* g "decaying" to two z's (different colour configurations are taken    
* separately)                                                           
     &     cg1234(2,2,2,2,0:3),cg3412(2,2,2,2,0:3),
     &     cg1256(2,2,2,2,0:3),cg5612(2,2,2,2,0:3),
     &     cg1278(2,2,2,2,0:3),cg7812(2,2,2,2,0:3),
     &     cg3456(2,2,2,2,0:3),cg5634(2,2,2,2,0:3),
     &     cg3478(2,2,2,2,0:3),cg7834(2,2,2,2,0:3),
     &     cg5678(2,2,2,2,0:3),cg7856(2,2,2,2,0:3),
* QCD contributions to Z/gamma/higgs "decaying" to two z's              
     &     czqcd1234(2,2,2,2,0:3),cfqcd1234(2,2,2,2,0:3),
     &     czqcd1256(2,2,2,2,0:3),cfqcd1256(2,2,2,2,0:3),
     &     czqcd3478(2,2,2,2,0:3),cfqcd3478(2,2,2,2,0:3),
     &     czqcd5678(2,2,2,2,0:3),cfqcd5678(2,2,2,2,0:3),
     &     czqcd1278(2,2,2,2,0:3),cfqcd1278(2,2,2,2,0:3),
     &     czqcd3456(2,2,2,2,0:3),cfqcd3456(2,2,2,2,0:3),
     &     chqcd1234(2,2,2,2),chqcd5678(2,2,2,2),chqcd1278(2,2,2,2),
     &     chqcd1256(2,2,2,2),chqcd3456(2,2,2,2),chqcd3478(2,2,2,2)
  
      type polcom
         double complex e(0:3),ek0,v
      end type
      type(polcom) cz12(2,2),cz34(2,2),cf12(2,2),cf34(2,2)
     &     ,cz56(2,2),cz78(2,2),cf56(2,2),cf78(2,2)
  
  
*left t Zline                                                           
      type l_zline
         double complex a(2,2),b(2,2),c(2,2),d(2,2)
      end type
      type(l_zline) l1_34(2,2),l1_56(2,2),l1_78(2,2),
     &     l3_12(2,2),l3_56(2,2),l3_78(2,2),
     &     l5_12(2,2),l5_34(2,2),l5_78(2,2),
     &     l7_12(2,2),l7_34(2,2),l7_56(2,2),
     &     lz1_234(0:3),lz1_256(0:3), lz1_278(0:3), lz3_412(0:3),
     &     lz3_456(0:3),lz3_478(0:3), lz5_612(0:3), lz5_634(0:3),
     &     lz5_678(0:3),lz7_812(0:3), lz7_834(0:3), lz7_856(0:3),
     &     lf1_234(0:3),lf1_256(0:3), lf1_278(0:3), lf3_412(0:3),
     &     lf3_456(0:3),lf3_478(0:3), lf5_612(0:3), lf5_634(0:3),
     &     lf5_678(0:3),lf7_812(0:3), lf7_834(0:3), lf7_856(0:3),
     &     lh1_234,lh1_256, lh1_278, lh3_412,
     &     lh3_456,lh3_478, lh5_612, lh5_634,
     &     lh5_678,lh7_812, lh7_834, lh7_856,
**QCD                                                                   
     &     lg1_34(2,2),lg1_56(2,2),lg1_78(2,2),
     &     lg3_12(2,2),lg3_56(2,2),lg3_78(2,2),
     &     lg5_12(2,2),lg5_34(2,2),lg5_78(2,2),
     &     lg7_12(2,2),lg7_34(2,2),lg7_56(2,2)
  
  
*right t Zline                                                          
      type r_zline
         double complex a(2,2),b(2,2),c(2,2),d(2,2)
      end type
      type(r_zline) r2_34(2,2),r2_56(2,2),r2_78(2,2),
     &     r4_12(2,2),r4_56(2,2),r4_78(2,2),
     &     r6_12(2,2),r6_34(2,2),r6_78(2,2),
     &     r8_12(2,2),r8_34(2,2),r8_56(2,2),
     &     rz2_134(0:3), rz2_156(0:3), rz2_178(0:3), rz4_312(0:3),
     &     rz4_356(0:3), rz4_378(0:3), rz6_512(0:3), rz6_534(0:3),
     &     rz6_578(0:3), rz8_712(0:3), rz8_734(0:3), rz8_756(0:3),
     &     rf2_134(0:3), rf2_156(0:3), rf2_178(0:3), rf4_312(0:3),
     &     rf4_356(0:3), rf4_378(0:3), rf6_512(0:3), rf6_534(0:3),
     &     rf6_578(0:3), rf8_712(0:3), rf8_734(0:3), rf8_756(0:3),
     &     rh2_134, rh2_156, rh2_178, rh4_312,
     &     rh4_356, rh4_378, rh6_512, rh6_534,
     &     rh6_578, rh8_712, rh8_734, rh8_756,
**QCD                                                                   
     &     rg2_34(2,2),rg2_56(2,2),rg2_78(2,2),
     &     rg4_12(2,2),rg4_56(2,2),rg4_78(2,2),
     &     rg6_12(2,2),rg6_34(2,2),rg6_78(2,2),
     &     rg8_12(2,2),rg8_34(2,2),rg8_56(2,2)
  
  
*u t Zline (middele insertion)                                          
      type u_zline
         double complex a(2,2),b(2,2),c(2,2),d(2,2)
      end type
      type(u_zline) u134_56(2,2),u134_78(2,2),
     &     u156_34(2,2),u156_78(2,2),u178_34(2,2),u178_56(2,2),
     &     u312_56(2,2),u312_78(2,2),u356_12(2,2),u356_78(2,2),
     &     u378_12(2,2),u378_56(2,2),u512_34(2,2),u512_78(2,2),
     &     u534_12(2,2),u534_78(2,2),u578_12(2,2),u578_34(2,2),
     &     u712_34(2,2),u734_12(2,2),u756_12(2,2),u712_56(2,2),
     &     u734_56(2,2),u756_34(2,2),
**QCD                                                                   
     &     ug134_56(2,2),ug134_78(2,2),
     &     ug156_34(2,2),ug156_78(2,2),ug178_34(2,2),ug178_56(2,2),
     &     ug312_56(2,2),ug312_78(2,2),ug356_12(2,2),ug356_78(2,2),
     &     ug378_12(2,2),ug378_56(2,2),ug512_34(2,2),ug512_78(2,2),
     &     ug534_12(2,2),ug534_78(2,2),ug578_12(2,2),ug578_34(2,2),
     &     ug712_34(2,2),ug734_12(2,2),ug756_12(2,2),ug712_56(2,2),
     &     ug734_56(2,2),ug756_34(2,2)
  
  
*left*middele  results (two forks)                                      
      type two_forks
         double complex a(2,2),b(2,2),c(2,2),d(2,2)
      end type
      type(two_forks) u1_3456(2,2,2,2),u1_3478(2,2,2,2),
     &     u1_5678(2,2,2,2),u3_1256(2,2,2,2),u3_1278(2,2,2,2),
     &     u3_5678(2,2,2,2),u5_1234(2,2,2,2),u5_3478(2,2,2,2),
     &     u5_1278(2,2,2,2),u7_1234(2,2,2,2),u7_1256(2,2,2,2),
     &     u7_3456(2,2,2,2),
**QCD                                                                   
* gluon connected to Zline 12:                                          
     &     ug3_1256(2,2,2,2),ug3_1278(2,2,2,2),
     &     ug5_1234(2,2,2,2),ug5_1278(2,2,2,2),
     &     ug7_1234(2,2,2,2),ug7_1256(2,2,2,2),
* gluon connected to Zline 34:                                          
     &     ug1_3456(2,2,2,2),ug1_3478(2,2,2,2),
     &     ug5_3412(2,2,2,2),ug5_3478(2,2,2,2),
     &     ug7_3412(2,2,2,2),ug7_3456(2,2,2,2),
* gluon connected to Zline 56:                                          
     &     ug1_5634(2,2,2,2),ug1_5678(2,2,2,2),
     &     ug3_5612(2,2,2,2),ug3_5678(2,2,2,2),
     &     ug7_5612(2,2,2,2),ug7_5634(2,2,2,2),
* gluon connected to Zline 78:                                          
     &     ug1_7834(2,2,2,2),ug1_7856(2,2,2,2),
     &     ug3_7812(2,2,2,2),ug3_7856(2,2,2,2),
     &     ug5_7812(2,2,2,2),ug5_7834(2,2,2,2)
  
  
*3 forks amplitudes (left*middele*right )                               
      type three_forks
         double complex a(2,2),b(2,2),c(2,2),d(2,2)
      end type
      type(three_forks) cline_3forks_12(2,2,2,2,2,2),
     &     cline_3forks_34(2,2,2,2,2,2),cline_3forks_56(2,2,2,2,2,2),
     &     cline_3forks_78(2,2,2,2,2,2),clinetzz(2,2,0:3),
     &     clinetfz(2,2,0:3)
  
  
*Final 3 forks amplitude (summed)                                       
      type three_forks_amp
         double complex pol(2,2)
      end type
      type(three_forks_amp) cres_3forks(2,2,2,2,2,2),
     &     cres_3forks_12(2,2,2,2,2,2),cres_3forks_34(2,2,2,2,2,2),
     &     cres_3forks_56(2,2,2,2,2,2),cres_3forks_78(2,2,2,2,2,2),
     &     creszz_z_zz(2,2,2,2,2,2),creszz_f_zz(2,2,2,2,2,2),
     &     creszz_zz(2,2,2,2,2,2),creszz_h_zz(2,2,2,2,2,2),
     &     cresquad_hh_zz(2,2,2,2,2,2),cresquad_hh_hh(2,2,2,2,2,2)
  
*results                                                                
      type result
         double complex caux(2,2,7) ! last index is the colour config.
      end type
      type(result) cres(2,2,2,2,2,2)
  
  
  
*common blocks                                                          
  
* generic common                                                        
      include 'common.h'
  
  
* 4momenta and their sums                                               
  
* pk0 -- p=p1
      p1k0=p1(0)-p1(1)
* pk0 -- p=p2
      p2k0=p2(0)-p2(1)
* pk0 -- p=p3
      p3k0=p3(0)-p3(1)
* pk0 -- p=p4
      p4k0=p4(0)-p4(1)
* pk0 -- p=p5
      p5k0=p5(0)-p5(1)
* pk0 -- p=p6
      p6k0=p6(0)-p6(1)
* pk0 -- p=p7
      p7k0=p7(0)-p7(1)
* pk0 -- p=p8
      p8k0=p8(0)-p8(1)
  
      do m=0,3
        p12(m)=p1(m)+p2(m)
      enddo
      do m=0,3
        p34(m)=p3(m)+p4(m)
      enddo
      do m=0,3
        p56(m)=p5(m)+p6(m)
      enddo
      do m=0,3
        p78(m)=p7(m)+p8(m)
      enddo
  
      do mu=0,3
        p1234(mu)=p12(mu)+p34(mu)
      enddo
* p.q -- p.q=p1234q,p=p1234,q=p1234,bef=,aft=
      p1234q=(p1234(0)*p1234(0)-p1234(1)*p1234(1)-p1234(2)*p1234
     & (2)-p1234(3)*p1234(3))
      do mu=0,3
        p1256(mu)=p12(mu)+p56(mu)
      enddo
* p.q -- p.q=p1256q,p=p1256,q=p1256,bef=,aft=
      p1256q=(p1256(0)*p1256(0)-p1256(1)*p1256(1)-p1256(2)*p1256
     & (2)-p1256(3)*p1256(3))
      do mu=0,3
        p1278(mu)=p12(mu)+p78(mu)
      enddo
* p.q -- p.q=p1278q,p=p1278,q=p1278,bef=,aft=
      p1278q=(p1278(0)*p1278(0)-p1278(1)*p1278(1)-p1278(2)*p1278
     & (2)-p1278(3)*p1278(3))
      do mu=0,3
        p3456(mu)=p34(mu)+p56(mu)
      enddo
* p.q -- p.q=p3456q,p=p3456,q=p3456,bef=,aft=
      p3456q=(p3456(0)*p3456(0)-p3456(1)*p3456(1)-p3456(2)*p3456
     & (2)-p3456(3)*p3456(3))
      do mu=0,3
        p3478(mu)=p34(mu)+p78(mu)
      enddo
* p.q -- p.q=p3478q,p=p3478,q=p3478,bef=,aft=
      p3478q=(p3478(0)*p3478(0)-p3478(1)*p3478(1)-p3478(2)*p3478
     & (2)-p3478(3)*p3478(3))
      do mu=0,3
        p5678(mu)=p56(mu)+p78(mu)
      enddo
* p.q -- p.q=p5678q,p=p5678,q=p5678,bef=,aft=
      p5678q=(p5678(0)*p5678(0)-p5678(1)*p5678(1)-p5678(2)*p5678
     & (2)-p5678(3)*p5678(3))
  
*                                                                       
*COMPUTE ALL FORKS (Z'S, GAMMA'S, HIGGS'S "DECAYING" TO TWO FERMIONS)   
*                                                                       
*                                                                       
*      Z'S AND GAMMAS  AND HIGGS                                        
*                                                                       
*                                                                       
*            _Z,f,h_/                                                   
*                   \                                                   
  
  
  
* quqd -- p=p1,q=p2
      quqd=p1(0)*p2(0)-p1(1)*p2(1)-p1(2)*p2(2)-p1(3)*p2(3)
      s12=2.d0*quqd+rmass2(id1)+rmass2(id2)
      ccr=zcr(id1)/(-s12+cmz2)
      ccl=zcl(id1)/(-s12+cmz2)
* T -- qu=p1,qd=p2,v=0,a=clinet_mu(0)%a,b=clinet_mu(0)%b,c=clinet_mu(0)%
* c,d=clinet_mu(0)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p1(2)*p2(3)+p2(2)*p1(3)
      ceps_0=eps_0*cim
      ceps_1=p1(3)*cim
      ceps_2=p2(3)*cim
      auxa=-quqd+p1k0*p2(0)+p2k0*p1(0)
      clinet_mu(0)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(0)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(0)%b(1,2)=-ccl*(p2(2)+ceps_2)
      clinet_mu(0)%b(2,1)=ccr*(p2(2)-ceps_2)
      clinet_mu(0)%c(1,2)=ccr*(p1(2)+ceps_1)
      clinet_mu(0)%c(2,1)=ccl*(-p1(2)+ceps_1)
      clinet_mu(0)%d(1,1)=ccl
      clinet_mu(0)%d(2,2)=ccr
* T -- qu=p1,qd=p2,v=1,a=clinet_mu(1)%a,b=clinet_mu(1)%b,c=clinet_mu(1)%
* c,d=clinet_mu(1)%d,cr=ccr,cl=ccl,nsum=0
      auxa=-quqd+p1k0*p2(1)+p2k0*p1(1)
      clinet_mu(1)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(1)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(1)%b(1,2)=-ccl*(p2(2)+ceps_2)
      clinet_mu(1)%b(2,1)=ccr*(p2(2)-ceps_2)
      clinet_mu(1)%c(1,2)=ccr*(p1(2)+ceps_1)
      clinet_mu(1)%c(2,1)=ccl*(-p1(2)+ceps_1)
      clinet_mu(1)%d(1,1)=ccl
      clinet_mu(1)%d(2,2)=ccr
* T -- qu=p1,qd=p2,v=2,a=clinet_mu(2)%a,b=clinet_mu(2)%b,c=clinet_mu(2)%
* c,d=clinet_mu(2)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p1k0*p2(3)+p2k0*p1(3)
      ceps_0=eps_0*cim
      auxa=p1k0*p2(2)+p2k0*p1(2)
      clinet_mu(2)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(2)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(2)%b(1,2)=-ccl*p2k0
      clinet_mu(2)%b(2,1)=ccr*p2k0
      clinet_mu(2)%c(1,2)=ccr*p1k0
      clinet_mu(2)%c(2,1)=-ccl*p1k0
* T -- qu=p1,qd=p2,v=3,a=clinet_mu(3)%a,b=clinet_mu(3)%b,c=clinet_mu(3)%
* c,d=clinet_mu(3)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=p1k0*p2(2)-p2k0*p1(2)
      ceps_0=eps_0*cim
      ceps_1=p1k0*cim
      ceps_2=p2k0*cim
      auxa=+p1k0*p2(3)+p2k0*p1(3)
      clinet_mu(3)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(3)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(3)%b(1,2)=-ccl*ceps_2
      clinet_mu(3)%b(2,1)=-ccr*ceps_2
      clinet_mu(3)%c(1,2)=ccr*ceps_1
      clinet_mu(3)%c(2,1)=ccl*ceps_1
      rmassl=rmass(id1)
      rmassr=-rmassl
      do mu=0,3
* mline -- res=cz12(&1,&2)%e(mu),abcd=clinet_mu(mu)%,m1=rmassl,m2=rmassr
* ,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cz12(iut,jut)%e(mu)=clinet_mu(mu)%a(iut,jut)+rmassl*clinet
     & _mu(mu)%b(iut,jut)+rmassr*clinet_mu(mu)%c(iut,jut)+rmassl
     & *rmassr*clinet_mu(mu)%d(iut,jut)
      enddo
      enddo
      end do
  
      if (imass(id1).eq.1) then
        do i1=1,2
          do i2=1,2
* p.q -- p.q=cauxdot,p=p12,q=cz12(i1,i2)%e,bef=,aft=
      cauxdot=(p12(0)*cz12(i1,i2)%e(0)-p12(1)*cz12(i1,i2)%e(1)-p
     & 12(2)*cz12(i1,i2)%e(2)-p12(3)*cz12(i1,i2)%e(3))
            do mu=0,3
             cz12(i1,i2)%e(mu)=cz12(i1,i2)%e(mu)-p12(mu)*cauxdot
     &             /cmz2
            enddo
          enddo
        enddo
      endif
      do i1=1,2
      do i2=1,2
* pk0 -- p=cz12(i1,i2)%e
      cz12(i1,i2)%ek0=cz12(i1,i2)%e(0)-cz12(i1,i2)%e(1)
      end do
      end do
      ccr=fcr(id1)/(-s12)
      ccl=fcl(id1)/(-s12)
* T -- qu=p1,qd=p2,v=0,a=clinet_mu(0)%a,b=clinet_mu(0)%b,c=clinet_mu(0)%
* c,d=clinet_mu(0)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p1(2)*p2(3)+p2(2)*p1(3)
      ceps_0=eps_0*cim
      ceps_1=p1(3)*cim
      ceps_2=p2(3)*cim
      auxa=-quqd+p1k0*p2(0)+p2k0*p1(0)
      clinet_mu(0)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(0)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(0)%b(1,2)=-ccl*(p2(2)+ceps_2)
      clinet_mu(0)%b(2,1)=ccr*(p2(2)-ceps_2)
      clinet_mu(0)%c(1,2)=ccr*(p1(2)+ceps_1)
      clinet_mu(0)%c(2,1)=ccl*(-p1(2)+ceps_1)
      clinet_mu(0)%d(1,1)=ccl
      clinet_mu(0)%d(2,2)=ccr
* T -- qu=p1,qd=p2,v=1,a=clinet_mu(1)%a,b=clinet_mu(1)%b,c=clinet_mu(1)%
* c,d=clinet_mu(1)%d,cr=ccr,cl=ccl,nsum=0
      auxa=-quqd+p1k0*p2(1)+p2k0*p1(1)
      clinet_mu(1)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(1)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(1)%b(1,2)=-ccl*(p2(2)+ceps_2)
      clinet_mu(1)%b(2,1)=ccr*(p2(2)-ceps_2)
      clinet_mu(1)%c(1,2)=ccr*(p1(2)+ceps_1)
      clinet_mu(1)%c(2,1)=ccl*(-p1(2)+ceps_1)
      clinet_mu(1)%d(1,1)=ccl
      clinet_mu(1)%d(2,2)=ccr
* T -- qu=p1,qd=p2,v=2,a=clinet_mu(2)%a,b=clinet_mu(2)%b,c=clinet_mu(2)%
* c,d=clinet_mu(2)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p1k0*p2(3)+p2k0*p1(3)
      ceps_0=eps_0*cim
      auxa=p1k0*p2(2)+p2k0*p1(2)
      clinet_mu(2)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(2)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(2)%b(1,2)=-ccl*p2k0
      clinet_mu(2)%b(2,1)=ccr*p2k0
      clinet_mu(2)%c(1,2)=ccr*p1k0
      clinet_mu(2)%c(2,1)=-ccl*p1k0
* T -- qu=p1,qd=p2,v=3,a=clinet_mu(3)%a,b=clinet_mu(3)%b,c=clinet_mu(3)%
* c,d=clinet_mu(3)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=p1k0*p2(2)-p2k0*p1(2)
      ceps_0=eps_0*cim
      ceps_1=p1k0*cim
      ceps_2=p2k0*cim
      auxa=+p1k0*p2(3)+p2k0*p1(3)
      clinet_mu(3)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(3)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(3)%b(1,2)=-ccl*ceps_2
      clinet_mu(3)%b(2,1)=-ccr*ceps_2
      clinet_mu(3)%c(1,2)=ccr*ceps_1
      clinet_mu(3)%c(2,1)=ccl*ceps_1
      rmassl=rmass(id1)
      rmassr=-rmassl
      do mu=0,3
* mline -- res=cf12(&1,&2)%e(mu),abcd=clinet_mu(mu)%,m1=rmassl,m2=rmassr
* ,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cf12(iut,jut)%e(mu)=clinet_mu(mu)%a(iut,jut)+rmassl*clinet
     & _mu(mu)%b(iut,jut)+rmassr*clinet_mu(mu)%c(iut,jut)+rmassl
     & *rmassr*clinet_mu(mu)%d(iut,jut)
      enddo
      enddo
      end do
  
      do i1=1,2
      do i2=1,2
* pk0 -- p=cf12(i1,i2)%e
      cf12(i1,i2)%ek0=cf12(i1,i2)%e(0)-cf12(i1,i2)%e(1)
      end do
      end do
  
*      higgs                                                            
* rmh < 0 in our convention means no higgs coupling                     
  
      if (id1.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p1,qd=p2,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p1k0*p2(2)+p2k0*p1(2)
      cauxa=auxa-cim*(p2(3)*p1k0-p1(3)*p2k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p2k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p1k0
      clineth%c(2,2)=clineth%c(1,1)
* mline -- res=ch12(&1,&2),abcd=clineth%,m1=rmassl,m2=rmassr,den=(s12-cm
* h2),nsum=0
      do iut=1,2
      do jut=1,2
      ch12(iut,jut)=(clineth%a(iut,jut)+rmassl*clineth%b(iut,jut
     & )+rmassr*clineth%c(iut,jut)+rmassl*rmassr*clineth%d(iut,j
     & ut))/(s12-cmh2)
      enddo
      enddo
  
      else
        do i1=1,2
          do i2=1,2
            ch12(i1,i2)=czero
          enddo
        enddo
      endif
* quqd -- p=p3,q=p4
      quqd=p3(0)*p4(0)-p3(1)*p4(1)-p3(2)*p4(2)-p3(3)*p4(3)
      s34=2.d0*quqd+rmass2(id3)+rmass2(id4)
      ccr=zcr(id3)/(-s34+cmz2)
      ccl=zcl(id3)/(-s34+cmz2)
* T -- qu=p3,qd=p4,v=0,a=clinet_mu(0)%a,b=clinet_mu(0)%b,c=clinet_mu(0)%
* c,d=clinet_mu(0)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p3(2)*p4(3)+p4(2)*p3(3)
      ceps_0=eps_0*cim
      ceps_1=p3(3)*cim
      ceps_2=p4(3)*cim
      auxa=-quqd+p3k0*p4(0)+p4k0*p3(0)
      clinet_mu(0)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(0)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(0)%b(1,2)=-ccl*(p4(2)+ceps_2)
      clinet_mu(0)%b(2,1)=ccr*(p4(2)-ceps_2)
      clinet_mu(0)%c(1,2)=ccr*(p3(2)+ceps_1)
      clinet_mu(0)%c(2,1)=ccl*(-p3(2)+ceps_1)
      clinet_mu(0)%d(1,1)=ccl
      clinet_mu(0)%d(2,2)=ccr
* T -- qu=p3,qd=p4,v=1,a=clinet_mu(1)%a,b=clinet_mu(1)%b,c=clinet_mu(1)%
* c,d=clinet_mu(1)%d,cr=ccr,cl=ccl,nsum=0
      auxa=-quqd+p3k0*p4(1)+p4k0*p3(1)
      clinet_mu(1)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(1)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(1)%b(1,2)=-ccl*(p4(2)+ceps_2)
      clinet_mu(1)%b(2,1)=ccr*(p4(2)-ceps_2)
      clinet_mu(1)%c(1,2)=ccr*(p3(2)+ceps_1)
      clinet_mu(1)%c(2,1)=ccl*(-p3(2)+ceps_1)
      clinet_mu(1)%d(1,1)=ccl
      clinet_mu(1)%d(2,2)=ccr
* T -- qu=p3,qd=p4,v=2,a=clinet_mu(2)%a,b=clinet_mu(2)%b,c=clinet_mu(2)%
* c,d=clinet_mu(2)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p3k0*p4(3)+p4k0*p3(3)
      ceps_0=eps_0*cim
      auxa=p3k0*p4(2)+p4k0*p3(2)
      clinet_mu(2)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(2)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(2)%b(1,2)=-ccl*p4k0
      clinet_mu(2)%b(2,1)=ccr*p4k0
      clinet_mu(2)%c(1,2)=ccr*p3k0
      clinet_mu(2)%c(2,1)=-ccl*p3k0
* T -- qu=p3,qd=p4,v=3,a=clinet_mu(3)%a,b=clinet_mu(3)%b,c=clinet_mu(3)%
* c,d=clinet_mu(3)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=p3k0*p4(2)-p4k0*p3(2)
      ceps_0=eps_0*cim
      ceps_1=p3k0*cim
      ceps_2=p4k0*cim
      auxa=+p3k0*p4(3)+p4k0*p3(3)
      clinet_mu(3)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(3)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(3)%b(1,2)=-ccl*ceps_2
      clinet_mu(3)%b(2,1)=-ccr*ceps_2
      clinet_mu(3)%c(1,2)=ccr*ceps_1
      clinet_mu(3)%c(2,1)=ccl*ceps_1
      rmassl=rmass(id3)
      rmassr=-rmassl
      do mu=0,3
* mline -- res=cz34(&1,&2)%e(mu),abcd=clinet_mu(mu)%,m1=rmassl,m2=rmassr
* ,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cz34(iut,jut)%e(mu)=clinet_mu(mu)%a(iut,jut)+rmassl*clinet
     & _mu(mu)%b(iut,jut)+rmassr*clinet_mu(mu)%c(iut,jut)+rmassl
     & *rmassr*clinet_mu(mu)%d(iut,jut)
      enddo
      enddo
      end do
  
      if (imass(id3).eq.1) then
        do i1=1,2
          do i2=1,2
* p.q -- p.q=cauxdot,p=p34,q=cz34(i1,i2)%e,bef=,aft=
      cauxdot=(p34(0)*cz34(i1,i2)%e(0)-p34(1)*cz34(i1,i2)%e(1)-p
     & 34(2)*cz34(i1,i2)%e(2)-p34(3)*cz34(i1,i2)%e(3))
            do mu=0,3
             cz34(i1,i2)%e(mu)=cz34(i1,i2)%e(mu)-p34(mu)*cauxdot
     &             /cmz2
            enddo
          enddo
        enddo
      endif
      do i1=1,2
      do i2=1,2
* pk0 -- p=cz34(i1,i2)%e
      cz34(i1,i2)%ek0=cz34(i1,i2)%e(0)-cz34(i1,i2)%e(1)
      end do
      end do
      ccr=fcr(id3)/(-s34)
      ccl=fcl(id3)/(-s34)
* T -- qu=p3,qd=p4,v=0,a=clinet_mu(0)%a,b=clinet_mu(0)%b,c=clinet_mu(0)%
* c,d=clinet_mu(0)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p3(2)*p4(3)+p4(2)*p3(3)
      ceps_0=eps_0*cim
      ceps_1=p3(3)*cim
      ceps_2=p4(3)*cim
      auxa=-quqd+p3k0*p4(0)+p4k0*p3(0)
      clinet_mu(0)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(0)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(0)%b(1,2)=-ccl*(p4(2)+ceps_2)
      clinet_mu(0)%b(2,1)=ccr*(p4(2)-ceps_2)
      clinet_mu(0)%c(1,2)=ccr*(p3(2)+ceps_1)
      clinet_mu(0)%c(2,1)=ccl*(-p3(2)+ceps_1)
      clinet_mu(0)%d(1,1)=ccl
      clinet_mu(0)%d(2,2)=ccr
* T -- qu=p3,qd=p4,v=1,a=clinet_mu(1)%a,b=clinet_mu(1)%b,c=clinet_mu(1)%
* c,d=clinet_mu(1)%d,cr=ccr,cl=ccl,nsum=0
      auxa=-quqd+p3k0*p4(1)+p4k0*p3(1)
      clinet_mu(1)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(1)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(1)%b(1,2)=-ccl*(p4(2)+ceps_2)
      clinet_mu(1)%b(2,1)=ccr*(p4(2)-ceps_2)
      clinet_mu(1)%c(1,2)=ccr*(p3(2)+ceps_1)
      clinet_mu(1)%c(2,1)=ccl*(-p3(2)+ceps_1)
      clinet_mu(1)%d(1,1)=ccl
      clinet_mu(1)%d(2,2)=ccr
* T -- qu=p3,qd=p4,v=2,a=clinet_mu(2)%a,b=clinet_mu(2)%b,c=clinet_mu(2)%
* c,d=clinet_mu(2)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p3k0*p4(3)+p4k0*p3(3)
      ceps_0=eps_0*cim
      auxa=p3k0*p4(2)+p4k0*p3(2)
      clinet_mu(2)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(2)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(2)%b(1,2)=-ccl*p4k0
      clinet_mu(2)%b(2,1)=ccr*p4k0
      clinet_mu(2)%c(1,2)=ccr*p3k0
      clinet_mu(2)%c(2,1)=-ccl*p3k0
* T -- qu=p3,qd=p4,v=3,a=clinet_mu(3)%a,b=clinet_mu(3)%b,c=clinet_mu(3)%
* c,d=clinet_mu(3)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=p3k0*p4(2)-p4k0*p3(2)
      ceps_0=eps_0*cim
      ceps_1=p3k0*cim
      ceps_2=p4k0*cim
      auxa=+p3k0*p4(3)+p4k0*p3(3)
      clinet_mu(3)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(3)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(3)%b(1,2)=-ccl*ceps_2
      clinet_mu(3)%b(2,1)=-ccr*ceps_2
      clinet_mu(3)%c(1,2)=ccr*ceps_1
      clinet_mu(3)%c(2,1)=ccl*ceps_1
      rmassl=rmass(id3)
      rmassr=-rmassl
      do mu=0,3
* mline -- res=cf34(&1,&2)%e(mu),abcd=clinet_mu(mu)%,m1=rmassl,m2=rmassr
* ,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cf34(iut,jut)%e(mu)=clinet_mu(mu)%a(iut,jut)+rmassl*clinet
     & _mu(mu)%b(iut,jut)+rmassr*clinet_mu(mu)%c(iut,jut)+rmassl
     & *rmassr*clinet_mu(mu)%d(iut,jut)
      enddo
      enddo
      end do
  
      do i1=1,2
      do i2=1,2
* pk0 -- p=cf34(i1,i2)%e
      cf34(i1,i2)%ek0=cf34(i1,i2)%e(0)-cf34(i1,i2)%e(1)
      end do
      end do
  
*      higgs                                                            
* rmh < 0 in our convention means no higgs coupling                     
  
      if (id3.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p3,qd=p4,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p3k0*p4(2)+p4k0*p3(2)
      cauxa=auxa-cim*(p4(3)*p3k0-p3(3)*p4k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p4k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p3k0
      clineth%c(2,2)=clineth%c(1,1)
* mline -- res=ch34(&1,&2),abcd=clineth%,m1=rmassl,m2=rmassr,den=(s34-cm
* h2),nsum=0
      do iut=1,2
      do jut=1,2
      ch34(iut,jut)=(clineth%a(iut,jut)+rmassl*clineth%b(iut,jut
     & )+rmassr*clineth%c(iut,jut)+rmassl*rmassr*clineth%d(iut,j
     & ut))/(s34-cmh2)
      enddo
      enddo
  
      else
        do i3=1,2
          do i4=1,2
            ch34(i3,i4)=czero
          enddo
        enddo
      endif
* quqd -- p=p5,q=p6
      quqd=p5(0)*p6(0)-p5(1)*p6(1)-p5(2)*p6(2)-p5(3)*p6(3)
      s56=2.d0*quqd+rmass2(id5)+rmass2(id6)
      ccr=zcr(id5)/(-s56+cmz2)
      ccl=zcl(id5)/(-s56+cmz2)
* T -- qu=p5,qd=p6,v=0,a=clinet_mu(0)%a,b=clinet_mu(0)%b,c=clinet_mu(0)%
* c,d=clinet_mu(0)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p5(2)*p6(3)+p6(2)*p5(3)
      ceps_0=eps_0*cim
      ceps_1=p5(3)*cim
      ceps_2=p6(3)*cim
      auxa=-quqd+p5k0*p6(0)+p6k0*p5(0)
      clinet_mu(0)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(0)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(0)%b(1,2)=-ccl*(p6(2)+ceps_2)
      clinet_mu(0)%b(2,1)=ccr*(p6(2)-ceps_2)
      clinet_mu(0)%c(1,2)=ccr*(p5(2)+ceps_1)
      clinet_mu(0)%c(2,1)=ccl*(-p5(2)+ceps_1)
      clinet_mu(0)%d(1,1)=ccl
      clinet_mu(0)%d(2,2)=ccr
* T -- qu=p5,qd=p6,v=1,a=clinet_mu(1)%a,b=clinet_mu(1)%b,c=clinet_mu(1)%
* c,d=clinet_mu(1)%d,cr=ccr,cl=ccl,nsum=0
      auxa=-quqd+p5k0*p6(1)+p6k0*p5(1)
      clinet_mu(1)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(1)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(1)%b(1,2)=-ccl*(p6(2)+ceps_2)
      clinet_mu(1)%b(2,1)=ccr*(p6(2)-ceps_2)
      clinet_mu(1)%c(1,2)=ccr*(p5(2)+ceps_1)
      clinet_mu(1)%c(2,1)=ccl*(-p5(2)+ceps_1)
      clinet_mu(1)%d(1,1)=ccl
      clinet_mu(1)%d(2,2)=ccr
* T -- qu=p5,qd=p6,v=2,a=clinet_mu(2)%a,b=clinet_mu(2)%b,c=clinet_mu(2)%
* c,d=clinet_mu(2)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p5k0*p6(3)+p6k0*p5(3)
      ceps_0=eps_0*cim
      auxa=p5k0*p6(2)+p6k0*p5(2)
      clinet_mu(2)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(2)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(2)%b(1,2)=-ccl*p6k0
      clinet_mu(2)%b(2,1)=ccr*p6k0
      clinet_mu(2)%c(1,2)=ccr*p5k0
      clinet_mu(2)%c(2,1)=-ccl*p5k0
* T -- qu=p5,qd=p6,v=3,a=clinet_mu(3)%a,b=clinet_mu(3)%b,c=clinet_mu(3)%
* c,d=clinet_mu(3)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=p5k0*p6(2)-p6k0*p5(2)
      ceps_0=eps_0*cim
      ceps_1=p5k0*cim
      ceps_2=p6k0*cim
      auxa=+p5k0*p6(3)+p6k0*p5(3)
      clinet_mu(3)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(3)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(3)%b(1,2)=-ccl*ceps_2
      clinet_mu(3)%b(2,1)=-ccr*ceps_2
      clinet_mu(3)%c(1,2)=ccr*ceps_1
      clinet_mu(3)%c(2,1)=ccl*ceps_1
      rmassl=rmass(id5)
      rmassr=-rmassl
      do mu=0,3
* mline -- res=cz56(&1,&2)%e(mu),abcd=clinet_mu(mu)%,m1=rmassl,m2=rmassr
* ,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cz56(iut,jut)%e(mu)=clinet_mu(mu)%a(iut,jut)+rmassl*clinet
     & _mu(mu)%b(iut,jut)+rmassr*clinet_mu(mu)%c(iut,jut)+rmassl
     & *rmassr*clinet_mu(mu)%d(iut,jut)
      enddo
      enddo
      end do
  
      if (imass(id5).eq.1) then
        do i1=1,2
          do i2=1,2
* p.q -- p.q=cauxdot,p=p56,q=cz56(i1,i2)%e,bef=,aft=
      cauxdot=(p56(0)*cz56(i1,i2)%e(0)-p56(1)*cz56(i1,i2)%e(1)-p
     & 56(2)*cz56(i1,i2)%e(2)-p56(3)*cz56(i1,i2)%e(3))
            do mu=0,3
             cz56(i1,i2)%e(mu)=cz56(i1,i2)%e(mu)-p56(mu)*cauxdot
     &             /cmz2
            enddo
          enddo
        enddo
      endif
      do i1=1,2
      do i2=1,2
* pk0 -- p=cz56(i1,i2)%e
      cz56(i1,i2)%ek0=cz56(i1,i2)%e(0)-cz56(i1,i2)%e(1)
      end do
      end do
      ccr=fcr(id5)/(-s56)
      ccl=fcl(id5)/(-s56)
* T -- qu=p5,qd=p6,v=0,a=clinet_mu(0)%a,b=clinet_mu(0)%b,c=clinet_mu(0)%
* c,d=clinet_mu(0)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p5(2)*p6(3)+p6(2)*p5(3)
      ceps_0=eps_0*cim
      ceps_1=p5(3)*cim
      ceps_2=p6(3)*cim
      auxa=-quqd+p5k0*p6(0)+p6k0*p5(0)
      clinet_mu(0)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(0)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(0)%b(1,2)=-ccl*(p6(2)+ceps_2)
      clinet_mu(0)%b(2,1)=ccr*(p6(2)-ceps_2)
      clinet_mu(0)%c(1,2)=ccr*(p5(2)+ceps_1)
      clinet_mu(0)%c(2,1)=ccl*(-p5(2)+ceps_1)
      clinet_mu(0)%d(1,1)=ccl
      clinet_mu(0)%d(2,2)=ccr
* T -- qu=p5,qd=p6,v=1,a=clinet_mu(1)%a,b=clinet_mu(1)%b,c=clinet_mu(1)%
* c,d=clinet_mu(1)%d,cr=ccr,cl=ccl,nsum=0
      auxa=-quqd+p5k0*p6(1)+p6k0*p5(1)
      clinet_mu(1)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(1)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(1)%b(1,2)=-ccl*(p6(2)+ceps_2)
      clinet_mu(1)%b(2,1)=ccr*(p6(2)-ceps_2)
      clinet_mu(1)%c(1,2)=ccr*(p5(2)+ceps_1)
      clinet_mu(1)%c(2,1)=ccl*(-p5(2)+ceps_1)
      clinet_mu(1)%d(1,1)=ccl
      clinet_mu(1)%d(2,2)=ccr
* T -- qu=p5,qd=p6,v=2,a=clinet_mu(2)%a,b=clinet_mu(2)%b,c=clinet_mu(2)%
* c,d=clinet_mu(2)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p5k0*p6(3)+p6k0*p5(3)
      ceps_0=eps_0*cim
      auxa=p5k0*p6(2)+p6k0*p5(2)
      clinet_mu(2)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(2)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(2)%b(1,2)=-ccl*p6k0
      clinet_mu(2)%b(2,1)=ccr*p6k0
      clinet_mu(2)%c(1,2)=ccr*p5k0
      clinet_mu(2)%c(2,1)=-ccl*p5k0
* T -- qu=p5,qd=p6,v=3,a=clinet_mu(3)%a,b=clinet_mu(3)%b,c=clinet_mu(3)%
* c,d=clinet_mu(3)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=p5k0*p6(2)-p6k0*p5(2)
      ceps_0=eps_0*cim
      ceps_1=p5k0*cim
      ceps_2=p6k0*cim
      auxa=+p5k0*p6(3)+p6k0*p5(3)
      clinet_mu(3)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(3)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(3)%b(1,2)=-ccl*ceps_2
      clinet_mu(3)%b(2,1)=-ccr*ceps_2
      clinet_mu(3)%c(1,2)=ccr*ceps_1
      clinet_mu(3)%c(2,1)=ccl*ceps_1
      rmassl=rmass(id5)
      rmassr=-rmassl
      do mu=0,3
* mline -- res=cf56(&1,&2)%e(mu),abcd=clinet_mu(mu)%,m1=rmassl,m2=rmassr
* ,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cf56(iut,jut)%e(mu)=clinet_mu(mu)%a(iut,jut)+rmassl*clinet
     & _mu(mu)%b(iut,jut)+rmassr*clinet_mu(mu)%c(iut,jut)+rmassl
     & *rmassr*clinet_mu(mu)%d(iut,jut)
      enddo
      enddo
      end do
  
      do i1=1,2
      do i2=1,2
* pk0 -- p=cf56(i1,i2)%e
      cf56(i1,i2)%ek0=cf56(i1,i2)%e(0)-cf56(i1,i2)%e(1)
      end do
      end do
  
*      higgs                                                            
* rmh < 0 in our convention means no higgs coupling                     
  
      if (id5.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p5,qd=p6,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p5k0*p6(2)+p6k0*p5(2)
      cauxa=auxa-cim*(p6(3)*p5k0-p5(3)*p6k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p6k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p5k0
      clineth%c(2,2)=clineth%c(1,1)
* mline -- res=ch56(&1,&2),abcd=clineth%,m1=rmassl,m2=rmassr,den=(s56-cm
* h2),nsum=0
      do iut=1,2
      do jut=1,2
      ch56(iut,jut)=(clineth%a(iut,jut)+rmassl*clineth%b(iut,jut
     & )+rmassr*clineth%c(iut,jut)+rmassl*rmassr*clineth%d(iut,j
     & ut))/(s56-cmh2)
      enddo
      enddo
  
      else
        do i5=1,2
          do i6=1,2
            ch56(i5,i6)=czero
          enddo
        enddo
      endif
* quqd -- p=p7,q=p8
      quqd=p7(0)*p8(0)-p7(1)*p8(1)-p7(2)*p8(2)-p7(3)*p8(3)
      s78=2.d0*quqd+rmass2(id7)+rmass2(id8)
      ccr=zcr(id7)/(-s78+cmz2)
      ccl=zcl(id7)/(-s78+cmz2)
* T -- qu=p7,qd=p8,v=0,a=clinet_mu(0)%a,b=clinet_mu(0)%b,c=clinet_mu(0)%
* c,d=clinet_mu(0)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p7(2)*p8(3)+p8(2)*p7(3)
      ceps_0=eps_0*cim
      ceps_1=p7(3)*cim
      ceps_2=p8(3)*cim
      auxa=-quqd+p7k0*p8(0)+p8k0*p7(0)
      clinet_mu(0)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(0)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(0)%b(1,2)=-ccl*(p8(2)+ceps_2)
      clinet_mu(0)%b(2,1)=ccr*(p8(2)-ceps_2)
      clinet_mu(0)%c(1,2)=ccr*(p7(2)+ceps_1)
      clinet_mu(0)%c(2,1)=ccl*(-p7(2)+ceps_1)
      clinet_mu(0)%d(1,1)=ccl
      clinet_mu(0)%d(2,2)=ccr
* T -- qu=p7,qd=p8,v=1,a=clinet_mu(1)%a,b=clinet_mu(1)%b,c=clinet_mu(1)%
* c,d=clinet_mu(1)%d,cr=ccr,cl=ccl,nsum=0
      auxa=-quqd+p7k0*p8(1)+p8k0*p7(1)
      clinet_mu(1)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(1)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(1)%b(1,2)=-ccl*(p8(2)+ceps_2)
      clinet_mu(1)%b(2,1)=ccr*(p8(2)-ceps_2)
      clinet_mu(1)%c(1,2)=ccr*(p7(2)+ceps_1)
      clinet_mu(1)%c(2,1)=ccl*(-p7(2)+ceps_1)
      clinet_mu(1)%d(1,1)=ccl
      clinet_mu(1)%d(2,2)=ccr
* T -- qu=p7,qd=p8,v=2,a=clinet_mu(2)%a,b=clinet_mu(2)%b,c=clinet_mu(2)%
* c,d=clinet_mu(2)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p7k0*p8(3)+p8k0*p7(3)
      ceps_0=eps_0*cim
      auxa=p7k0*p8(2)+p8k0*p7(2)
      clinet_mu(2)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(2)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(2)%b(1,2)=-ccl*p8k0
      clinet_mu(2)%b(2,1)=ccr*p8k0
      clinet_mu(2)%c(1,2)=ccr*p7k0
      clinet_mu(2)%c(2,1)=-ccl*p7k0
* T -- qu=p7,qd=p8,v=3,a=clinet_mu(3)%a,b=clinet_mu(3)%b,c=clinet_mu(3)%
* c,d=clinet_mu(3)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=p7k0*p8(2)-p8k0*p7(2)
      ceps_0=eps_0*cim
      ceps_1=p7k0*cim
      ceps_2=p8k0*cim
      auxa=+p7k0*p8(3)+p8k0*p7(3)
      clinet_mu(3)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(3)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(3)%b(1,2)=-ccl*ceps_2
      clinet_mu(3)%b(2,1)=-ccr*ceps_2
      clinet_mu(3)%c(1,2)=ccr*ceps_1
      clinet_mu(3)%c(2,1)=ccl*ceps_1
      rmassl=rmass(id7)
      rmassr=-rmassl
      do mu=0,3
* mline -- res=cz78(&1,&2)%e(mu),abcd=clinet_mu(mu)%,m1=rmassl,m2=rmassr
* ,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cz78(iut,jut)%e(mu)=clinet_mu(mu)%a(iut,jut)+rmassl*clinet
     & _mu(mu)%b(iut,jut)+rmassr*clinet_mu(mu)%c(iut,jut)+rmassl
     & *rmassr*clinet_mu(mu)%d(iut,jut)
      enddo
      enddo
      end do
  
      if (imass(id7).eq.1) then
        do i1=1,2
          do i2=1,2
* p.q -- p.q=cauxdot,p=p78,q=cz78(i1,i2)%e,bef=,aft=
      cauxdot=(p78(0)*cz78(i1,i2)%e(0)-p78(1)*cz78(i1,i2)%e(1)-p
     & 78(2)*cz78(i1,i2)%e(2)-p78(3)*cz78(i1,i2)%e(3))
            do mu=0,3
             cz78(i1,i2)%e(mu)=cz78(i1,i2)%e(mu)-p78(mu)*cauxdot
     &             /cmz2
            enddo
          enddo
        enddo
      endif
      do i1=1,2
      do i2=1,2
* pk0 -- p=cz78(i1,i2)%e
      cz78(i1,i2)%ek0=cz78(i1,i2)%e(0)-cz78(i1,i2)%e(1)
      end do
      end do
      ccr=fcr(id7)/(-s78)
      ccl=fcl(id7)/(-s78)
* T -- qu=p7,qd=p8,v=0,a=clinet_mu(0)%a,b=clinet_mu(0)%b,c=clinet_mu(0)%
* c,d=clinet_mu(0)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p7(2)*p8(3)+p8(2)*p7(3)
      ceps_0=eps_0*cim
      ceps_1=p7(3)*cim
      ceps_2=p8(3)*cim
      auxa=-quqd+p7k0*p8(0)+p8k0*p7(0)
      clinet_mu(0)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(0)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(0)%b(1,2)=-ccl*(p8(2)+ceps_2)
      clinet_mu(0)%b(2,1)=ccr*(p8(2)-ceps_2)
      clinet_mu(0)%c(1,2)=ccr*(p7(2)+ceps_1)
      clinet_mu(0)%c(2,1)=ccl*(-p7(2)+ceps_1)
      clinet_mu(0)%d(1,1)=ccl
      clinet_mu(0)%d(2,2)=ccr
* T -- qu=p7,qd=p8,v=1,a=clinet_mu(1)%a,b=clinet_mu(1)%b,c=clinet_mu(1)%
* c,d=clinet_mu(1)%d,cr=ccr,cl=ccl,nsum=0
      auxa=-quqd+p7k0*p8(1)+p8k0*p7(1)
      clinet_mu(1)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(1)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(1)%b(1,2)=-ccl*(p8(2)+ceps_2)
      clinet_mu(1)%b(2,1)=ccr*(p8(2)-ceps_2)
      clinet_mu(1)%c(1,2)=ccr*(p7(2)+ceps_1)
      clinet_mu(1)%c(2,1)=ccl*(-p7(2)+ceps_1)
      clinet_mu(1)%d(1,1)=ccl
      clinet_mu(1)%d(2,2)=ccr
* T -- qu=p7,qd=p8,v=2,a=clinet_mu(2)%a,b=clinet_mu(2)%b,c=clinet_mu(2)%
* c,d=clinet_mu(2)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=-p7k0*p8(3)+p8k0*p7(3)
      ceps_0=eps_0*cim
      auxa=p7k0*p8(2)+p8k0*p7(2)
      clinet_mu(2)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(2)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(2)%b(1,2)=-ccl*p8k0
      clinet_mu(2)%b(2,1)=ccr*p8k0
      clinet_mu(2)%c(1,2)=ccr*p7k0
      clinet_mu(2)%c(2,1)=-ccl*p7k0
* T -- qu=p7,qd=p8,v=3,a=clinet_mu(3)%a,b=clinet_mu(3)%b,c=clinet_mu(3)%
* c,d=clinet_mu(3)%d,cr=ccr,cl=ccl,nsum=0
      eps_0=p7k0*p8(2)-p8k0*p7(2)
      ceps_0=eps_0*cim
      ceps_1=p7k0*cim
      ceps_2=p8k0*cim
      auxa=+p7k0*p8(3)+p8k0*p7(3)
      clinet_mu(3)%a(1,1)=ccr*(auxa+ceps_0)
      clinet_mu(3)%a(2,2)=ccl*(auxa-ceps_0)
      clinet_mu(3)%b(1,2)=-ccl*ceps_2
      clinet_mu(3)%b(2,1)=-ccr*ceps_2
      clinet_mu(3)%c(1,2)=ccr*ceps_1
      clinet_mu(3)%c(2,1)=ccl*ceps_1
      rmassl=rmass(id7)
      rmassr=-rmassl
      do mu=0,3
* mline -- res=cf78(&1,&2)%e(mu),abcd=clinet_mu(mu)%,m1=rmassl,m2=rmassr
* ,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cf78(iut,jut)%e(mu)=clinet_mu(mu)%a(iut,jut)+rmassl*clinet
     & _mu(mu)%b(iut,jut)+rmassr*clinet_mu(mu)%c(iut,jut)+rmassl
     & *rmassr*clinet_mu(mu)%d(iut,jut)
      enddo
      enddo
      end do
  
      do i1=1,2
      do i2=1,2
* pk0 -- p=cf78(i1,i2)%e
      cf78(i1,i2)%ek0=cf78(i1,i2)%e(0)-cf78(i1,i2)%e(1)
      end do
      end do
  
*      higgs                                                            
* rmh < 0 in our convention means no higgs coupling                     
  
      if (id7.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p7,qd=p8,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p7k0*p8(2)+p8k0*p7(2)
      cauxa=auxa-cim*(p8(3)*p7k0-p7(3)*p8k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p8k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p7k0
      clineth%c(2,2)=clineth%c(1,1)
* mline -- res=ch78(&1,&2),abcd=clineth%,m1=rmassl,m2=rmassr,den=(s78-cm
* h2),nsum=0
      do iut=1,2
      do jut=1,2
      ch78(iut,jut)=(clineth%a(iut,jut)+rmassl*clineth%b(iut,jut
     & )+rmassr*clineth%c(iut,jut)+rmassl*rmassr*clineth%d(iut,j
     & ut))/(s78-cmh2)
      enddo
      enddo
  
      else
        do i7=1,2
          do i8=1,2
            ch78(i7,i8)=czero
          enddo
        enddo
      endif
  
  
  
  
* COMPUTE ALL SINGLE INSERTIONS OF THE TYPE LI_ (I=1,3,5,7)  FOR A ZLINE
* AND A Z  GAMMA AND EVENTUALLY HIGGS INSERTION                         
*                                                                       
*        i __                                                           
*            |_Z,f,h_/                                                  
*            |       \                                                  
*                                                                       
*together with its propagator and pk0                                   
*                                                                       
**QCD                                                                   
*    and their QCD counterparts                                         
*        i __                                                           
*            |~~g~~<      e.g. lg1_34                                   
*            |                                                          
*                                                                       
*As g_strong and e are factorized, this class of QCD subdiagrams differs
*from that of gamma insertions by a factor (fcl(id_i))*(fcl(id_j)), with
*j={1,3,5,7}.                                                           
  
      do m=0,3
        p134(m)=p1(m)+p34(m)
      enddo
* pk0 -- p=p134
      p134k0=p134(0)-p134(1)
* p.q -- p.q=p134q,p=p134,q=p134,bef=,aft=
      p134q=(p134(0)*p134(0)-p134(1)*p134(1)-p134(2)*p134(2)-p13
     & 4(3)*p134(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id1).ne.1) then
* quqd -- p=p1,q=p134
      quqd=p1(0)*p134(0)-p1(1)*p134(1)-p1(2)*p134(2)-p1(3)*p134(
     & 3)
      ccr=fcr(id1)/((p134q-rmass2(id1))*p134k0)
      ccl=fcl(id1)/((p134q-rmass2(id1))*p134k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p1,qd=p134,v=cf34(i1,i2)%e,a=l1_34(i1,i2)%a,b=l1_34(i1,i2)%b,c
* =l1_34(i1,i2)%c,d=l1_34(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf34(i1,i2)%ek0*(p1(2)*p134(3)-p134(2)*p1(3))+p1k0
     & *(cf34(i1,i2)%e(2)*p134(3)-p134(2)*cf34(i1,i2)%e(3))-p134
     & k0*(cf34(i1,i2)%e(2)*p1(3)-p1(2)*cf34(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf34(i1,i2)%e(3)*p1k0+p1(3)*cf34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf34(i1,i2)%e(3)*p134k0+p134(3)*cf34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf34(i1,i2)%e(0)*p1(0)-cf34(i1,i2)%e(1)*p1(1)-cf34(i1
     & ,i2)%e(2)*p1(2)-cf34(i1,i2)%e(3)*p1(3)
      cvqd=cf34(i1,i2)%e(0)*p134(0)-cf34(i1,i2)%e(1)*p134(1)-cf3
     & 4(i1,i2)%e(2)*p134(2)-cf34(i1,i2)%e(3)*p134(3)
      cauxa=-cf34(i1,i2)%ek0*quqd+p1k0*cvqd+p134k0*cvqu
      cauxb=-cf34(i1,i2)%ek0*p134(2)+p134k0*cf34(i1,i2)%e(2)
      cauxc=+cf34(i1,i2)%ek0*p1(2)-p1k0*cf34(i1,i2)%e(2)
      l1_34(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      l1_34(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      l1_34(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      l1_34(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      l1_34(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      l1_34(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      l1_34(i1,i2)%d(1,1)=ccl*cf34(i1,i2)%ek0
      l1_34(i1,i2)%d(2,2)=ccr*cf34(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                l1_34(i1,i2)%a(iut,jut)=czero
                l1_34(i1,i2)%b(iut,jut)=czero
                l1_34(i1,i2)%c(iut,jut)=czero
                l1_34(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id1).ne.1 .and. ilept(id3).ne.1) then
        do iut=1,2
          do jut=1,2
            lg1_34(iut,jut)%a(1,1) = l1_34(iut,jut)%a(1,1)
     &           /((fcl(id1))*(fcl(id3)))
            lg1_34(iut,jut)%a(2,2) = l1_34(iut,jut)%a(2,2)
     &           /((fcl(id1))*(fcl(id3)))
            lg1_34(iut,jut)%b(1,2) = l1_34(iut,jut)%b(1,2)
     &           /((fcl(id1))*(fcl(id3)))
            lg1_34(iut,jut)%b(2,1) = l1_34(iut,jut)%b(2,1)
     &           /((fcl(id1))*(fcl(id3)))
            lg1_34(iut,jut)%c(1,2) = l1_34(iut,jut)%c(1,2)
     &           /((fcl(id1))*(fcl(id3)))
            lg1_34(iut,jut)%c(2,1) = l1_34(iut,jut)%c(2,1)
     &           /((fcl(id1))*(fcl(id3)))
            lg1_34(iut,jut)%d(1,1) = l1_34(iut,jut)%d(1,1)
     &           /((fcl(id1))*(fcl(id3)))
            lg1_34(iut,jut)%d(2,2) = l1_34(iut,jut)%d(2,2)
     &           /((fcl(id1))*(fcl(id3)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            lg1_34(iut,jut)%a(1,1) = czero
            lg1_34(iut,jut)%a(2,2) = czero
            lg1_34(iut,jut)%b(1,2) = czero
            lg1_34(iut,jut)%b(2,1) = czero
            lg1_34(iut,jut)%c(1,2) = czero
            lg1_34(iut,jut)%c(2,1) = czero
            lg1_34(iut,jut)%d(1,1) = czero
            lg1_34(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p1,q=p134
      quqd=p1(0)*p134(0)-p1(1)*p134(1)-p1(2)*p134(2)-p1(3)*p134(
     & 3)
      ccr=zcr(id1)/((p134q-rmass2(id1))*p134k0)
      ccl=zcl(id1)/((p134q-rmass2(id1))*p134k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p1,qd=p134,v=cz34(i1,i2)%e,a=l1_34(i1,i2)%a,b=l1_34(i1,i2)%b,c
* =l1_34(i1,i2)%c,d=l1_34(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz34(i1,i2)%ek0*(p1(2)*p134(3)-p134(2)*p1(3))+p1k0
     & *(cz34(i1,i2)%e(2)*p134(3)-p134(2)*cz34(i1,i2)%e(3))-p134
     & k0*(cz34(i1,i2)%e(2)*p1(3)-p1(2)*cz34(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz34(i1,i2)%e(3)*p1k0+p1(3)*cz34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz34(i1,i2)%e(3)*p134k0+p134(3)*cz34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz34(i1,i2)%e(0)*p1(0)-cz34(i1,i2)%e(1)*p1(1)-cz34(i1
     & ,i2)%e(2)*p1(2)-cz34(i1,i2)%e(3)*p1(3)
      cvqd=cz34(i1,i2)%e(0)*p134(0)-cz34(i1,i2)%e(1)*p134(1)-cz3
     & 4(i1,i2)%e(2)*p134(2)-cz34(i1,i2)%e(3)*p134(3)
      cauxa=-cz34(i1,i2)%ek0*quqd+p1k0*cvqd+p134k0*cvqu
      cauxb=-cz34(i1,i2)%ek0*p134(2)+p134k0*cz34(i1,i2)%e(2)
      cauxc=+cz34(i1,i2)%ek0*p1(2)-p1k0*cz34(i1,i2)%e(2)
      l1_34(i1,i2)%a(1,1)=l1_34(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      l1_34(i1,i2)%a(2,2)=l1_34(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      l1_34(i1,i2)%b(1,2)=l1_34(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      l1_34(i1,i2)%b(2,1)=l1_34(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      l1_34(i1,i2)%c(1,2)=l1_34(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      l1_34(i1,i2)%c(2,1)=l1_34(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      l1_34(i1,i2)%d(1,1)=l1_34(i1,i2)%d(1,1)+ccl*cz34(i1,i2)%ek
     & 0
      l1_34(i1,i2)%d(2,2)=l1_34(i1,i2)%d(2,2)+ccr*cz34(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.id3.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p1,qd=p134,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p1k0*p134(2)+p134k0*p1(2)
      cauxa=auxa-cim*(p134(3)*p1k0-p1(3)*p134k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p134k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p1k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p134q-rmass2(id1))*p134k0)
       do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l1_34(i1,i2)%a(i3,i4)=ch34(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  l1_34(i1,i2)%b(i3,i4)=ch34(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  l1_34(i1,i2)%c(i3,i4)=ch34(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l1_34(i1,i2)%a(i3,i4)=czero
                else
                  l1_34(i1,i2)%b(i3,i4)=czero
                  l1_34(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
      do m=0,3
        p156(m)=p1(m)+p56(m)
      enddo
* pk0 -- p=p156
      p156k0=p156(0)-p156(1)
* p.q -- p.q=p156q,p=p156,q=p156,bef=,aft=
      p156q=(p156(0)*p156(0)-p156(1)*p156(1)-p156(2)*p156(2)-p15
     & 6(3)*p156(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id1).ne.1) then
* quqd -- p=p1,q=p156
      quqd=p1(0)*p156(0)-p1(1)*p156(1)-p1(2)*p156(2)-p1(3)*p156(
     & 3)
      ccr=fcr(id1)/((p156q-rmass2(id1))*p156k0)
      ccl=fcl(id1)/((p156q-rmass2(id1))*p156k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p1,qd=p156,v=cf56(i1,i2)%e,a=l1_56(i1,i2)%a,b=l1_56(i1,i2)%b,c
* =l1_56(i1,i2)%c,d=l1_56(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf56(i1,i2)%ek0*(p1(2)*p156(3)-p156(2)*p1(3))+p1k0
     & *(cf56(i1,i2)%e(2)*p156(3)-p156(2)*cf56(i1,i2)%e(3))-p156
     & k0*(cf56(i1,i2)%e(2)*p1(3)-p1(2)*cf56(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf56(i1,i2)%e(3)*p1k0+p1(3)*cf56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf56(i1,i2)%e(3)*p156k0+p156(3)*cf56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf56(i1,i2)%e(0)*p1(0)-cf56(i1,i2)%e(1)*p1(1)-cf56(i1
     & ,i2)%e(2)*p1(2)-cf56(i1,i2)%e(3)*p1(3)
      cvqd=cf56(i1,i2)%e(0)*p156(0)-cf56(i1,i2)%e(1)*p156(1)-cf5
     & 6(i1,i2)%e(2)*p156(2)-cf56(i1,i2)%e(3)*p156(3)
      cauxa=-cf56(i1,i2)%ek0*quqd+p1k0*cvqd+p156k0*cvqu
      cauxb=-cf56(i1,i2)%ek0*p156(2)+p156k0*cf56(i1,i2)%e(2)
      cauxc=+cf56(i1,i2)%ek0*p1(2)-p1k0*cf56(i1,i2)%e(2)
      l1_56(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      l1_56(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      l1_56(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      l1_56(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      l1_56(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      l1_56(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      l1_56(i1,i2)%d(1,1)=ccl*cf56(i1,i2)%ek0
      l1_56(i1,i2)%d(2,2)=ccr*cf56(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                l1_56(i1,i2)%a(iut,jut)=czero
                l1_56(i1,i2)%b(iut,jut)=czero
                l1_56(i1,i2)%c(iut,jut)=czero
                l1_56(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id1).ne.1 .and. ilept(id5).ne.1) then
        do iut=1,2
          do jut=1,2
            lg1_56(iut,jut)%a(1,1) = l1_56(iut,jut)%a(1,1)
     &           /((fcl(id1))*(fcl(id5)))
            lg1_56(iut,jut)%a(2,2) = l1_56(iut,jut)%a(2,2)
     &           /((fcl(id1))*(fcl(id5)))
            lg1_56(iut,jut)%b(1,2) = l1_56(iut,jut)%b(1,2)
     &           /((fcl(id1))*(fcl(id5)))
            lg1_56(iut,jut)%b(2,1) = l1_56(iut,jut)%b(2,1)
     &           /((fcl(id1))*(fcl(id5)))
            lg1_56(iut,jut)%c(1,2) = l1_56(iut,jut)%c(1,2)
     &           /((fcl(id1))*(fcl(id5)))
            lg1_56(iut,jut)%c(2,1) = l1_56(iut,jut)%c(2,1)
     &           /((fcl(id1))*(fcl(id5)))
            lg1_56(iut,jut)%d(1,1) = l1_56(iut,jut)%d(1,1)
     &           /((fcl(id1))*(fcl(id5)))
            lg1_56(iut,jut)%d(2,2) = l1_56(iut,jut)%d(2,2)
     &           /((fcl(id1))*(fcl(id5)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            lg1_56(iut,jut)%a(1,1) = czero
            lg1_56(iut,jut)%a(2,2) = czero
            lg1_56(iut,jut)%b(1,2) = czero
            lg1_56(iut,jut)%b(2,1) = czero
            lg1_56(iut,jut)%c(1,2) = czero
            lg1_56(iut,jut)%c(2,1) = czero
            lg1_56(iut,jut)%d(1,1) = czero
            lg1_56(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p1,q=p156
      quqd=p1(0)*p156(0)-p1(1)*p156(1)-p1(2)*p156(2)-p1(3)*p156(
     & 3)
      ccr=zcr(id1)/((p156q-rmass2(id1))*p156k0)
      ccl=zcl(id1)/((p156q-rmass2(id1))*p156k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p1,qd=p156,v=cz56(i1,i2)%e,a=l1_56(i1,i2)%a,b=l1_56(i1,i2)%b,c
* =l1_56(i1,i2)%c,d=l1_56(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz56(i1,i2)%ek0*(p1(2)*p156(3)-p156(2)*p1(3))+p1k0
     & *(cz56(i1,i2)%e(2)*p156(3)-p156(2)*cz56(i1,i2)%e(3))-p156
     & k0*(cz56(i1,i2)%e(2)*p1(3)-p1(2)*cz56(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz56(i1,i2)%e(3)*p1k0+p1(3)*cz56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz56(i1,i2)%e(3)*p156k0+p156(3)*cz56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz56(i1,i2)%e(0)*p1(0)-cz56(i1,i2)%e(1)*p1(1)-cz56(i1
     & ,i2)%e(2)*p1(2)-cz56(i1,i2)%e(3)*p1(3)
      cvqd=cz56(i1,i2)%e(0)*p156(0)-cz56(i1,i2)%e(1)*p156(1)-cz5
     & 6(i1,i2)%e(2)*p156(2)-cz56(i1,i2)%e(3)*p156(3)
      cauxa=-cz56(i1,i2)%ek0*quqd+p1k0*cvqd+p156k0*cvqu
      cauxb=-cz56(i1,i2)%ek0*p156(2)+p156k0*cz56(i1,i2)%e(2)
      cauxc=+cz56(i1,i2)%ek0*p1(2)-p1k0*cz56(i1,i2)%e(2)
      l1_56(i1,i2)%a(1,1)=l1_56(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      l1_56(i1,i2)%a(2,2)=l1_56(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      l1_56(i1,i2)%b(1,2)=l1_56(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      l1_56(i1,i2)%b(2,1)=l1_56(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      l1_56(i1,i2)%c(1,2)=l1_56(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      l1_56(i1,i2)%c(2,1)=l1_56(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      l1_56(i1,i2)%d(1,1)=l1_56(i1,i2)%d(1,1)+ccl*cz56(i1,i2)%ek
     & 0
      l1_56(i1,i2)%d(2,2)=l1_56(i1,i2)%d(2,2)+ccr*cz56(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.id5.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p1,qd=p156,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p1k0*p156(2)+p156k0*p1(2)
      cauxa=auxa-cim*(p156(3)*p1k0-p1(3)*p156k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p156k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p1k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p156q-rmass2(id1))*p156k0)
       do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l1_56(i1,i2)%a(i3,i4)=ch56(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  l1_56(i1,i2)%b(i3,i4)=ch56(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  l1_56(i1,i2)%c(i3,i4)=ch56(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l1_56(i1,i2)%a(i3,i4)=czero
                else
                  l1_56(i1,i2)%b(i3,i4)=czero
                  l1_56(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
      do m=0,3
        p178(m)=p1(m)+p78(m)
      enddo
* pk0 -- p=p178
      p178k0=p178(0)-p178(1)
* p.q -- p.q=p178q,p=p178,q=p178,bef=,aft=
      p178q=(p178(0)*p178(0)-p178(1)*p178(1)-p178(2)*p178(2)-p17
     & 8(3)*p178(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id1).ne.1) then
* quqd -- p=p1,q=p178
      quqd=p1(0)*p178(0)-p1(1)*p178(1)-p1(2)*p178(2)-p1(3)*p178(
     & 3)
      ccr=fcr(id1)/((p178q-rmass2(id1))*p178k0)
      ccl=fcl(id1)/((p178q-rmass2(id1))*p178k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p1,qd=p178,v=cf78(i1,i2)%e,a=l1_78(i1,i2)%a,b=l1_78(i1,i2)%b,c
* =l1_78(i1,i2)%c,d=l1_78(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf78(i1,i2)%ek0*(p1(2)*p178(3)-p178(2)*p1(3))+p1k0
     & *(cf78(i1,i2)%e(2)*p178(3)-p178(2)*cf78(i1,i2)%e(3))-p178
     & k0*(cf78(i1,i2)%e(2)*p1(3)-p1(2)*cf78(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf78(i1,i2)%e(3)*p1k0+p1(3)*cf78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf78(i1,i2)%e(3)*p178k0+p178(3)*cf78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf78(i1,i2)%e(0)*p1(0)-cf78(i1,i2)%e(1)*p1(1)-cf78(i1
     & ,i2)%e(2)*p1(2)-cf78(i1,i2)%e(3)*p1(3)
      cvqd=cf78(i1,i2)%e(0)*p178(0)-cf78(i1,i2)%e(1)*p178(1)-cf7
     & 8(i1,i2)%e(2)*p178(2)-cf78(i1,i2)%e(3)*p178(3)
      cauxa=-cf78(i1,i2)%ek0*quqd+p1k0*cvqd+p178k0*cvqu
      cauxb=-cf78(i1,i2)%ek0*p178(2)+p178k0*cf78(i1,i2)%e(2)
      cauxc=+cf78(i1,i2)%ek0*p1(2)-p1k0*cf78(i1,i2)%e(2)
      l1_78(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      l1_78(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      l1_78(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      l1_78(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      l1_78(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      l1_78(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      l1_78(i1,i2)%d(1,1)=ccl*cf78(i1,i2)%ek0
      l1_78(i1,i2)%d(2,2)=ccr*cf78(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                l1_78(i1,i2)%a(iut,jut)=czero
                l1_78(i1,i2)%b(iut,jut)=czero
                l1_78(i1,i2)%c(iut,jut)=czero
                l1_78(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id1).ne.1 .and. ilept(id7).ne.1) then
        do iut=1,2
          do jut=1,2
            lg1_78(iut,jut)%a(1,1) = l1_78(iut,jut)%a(1,1)
     &           /((fcl(id1))*(fcl(id7)))
            lg1_78(iut,jut)%a(2,2) = l1_78(iut,jut)%a(2,2)
     &           /((fcl(id1))*(fcl(id7)))
            lg1_78(iut,jut)%b(1,2) = l1_78(iut,jut)%b(1,2)
     &           /((fcl(id1))*(fcl(id7)))
            lg1_78(iut,jut)%b(2,1) = l1_78(iut,jut)%b(2,1)
     &           /((fcl(id1))*(fcl(id7)))
            lg1_78(iut,jut)%c(1,2) = l1_78(iut,jut)%c(1,2)
     &           /((fcl(id1))*(fcl(id7)))
            lg1_78(iut,jut)%c(2,1) = l1_78(iut,jut)%c(2,1)
     &           /((fcl(id1))*(fcl(id7)))
            lg1_78(iut,jut)%d(1,1) = l1_78(iut,jut)%d(1,1)
     &           /((fcl(id1))*(fcl(id7)))
            lg1_78(iut,jut)%d(2,2) = l1_78(iut,jut)%d(2,2)
     &           /((fcl(id1))*(fcl(id7)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            lg1_78(iut,jut)%a(1,1) = czero
            lg1_78(iut,jut)%a(2,2) = czero
            lg1_78(iut,jut)%b(1,2) = czero
            lg1_78(iut,jut)%b(2,1) = czero
            lg1_78(iut,jut)%c(1,2) = czero
            lg1_78(iut,jut)%c(2,1) = czero
            lg1_78(iut,jut)%d(1,1) = czero
            lg1_78(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p1,q=p178
      quqd=p1(0)*p178(0)-p1(1)*p178(1)-p1(2)*p178(2)-p1(3)*p178(
     & 3)
      ccr=zcr(id1)/((p178q-rmass2(id1))*p178k0)
      ccl=zcl(id1)/((p178q-rmass2(id1))*p178k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p1,qd=p178,v=cz78(i1,i2)%e,a=l1_78(i1,i2)%a,b=l1_78(i1,i2)%b,c
* =l1_78(i1,i2)%c,d=l1_78(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz78(i1,i2)%ek0*(p1(2)*p178(3)-p178(2)*p1(3))+p1k0
     & *(cz78(i1,i2)%e(2)*p178(3)-p178(2)*cz78(i1,i2)%e(3))-p178
     & k0*(cz78(i1,i2)%e(2)*p1(3)-p1(2)*cz78(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz78(i1,i2)%e(3)*p1k0+p1(3)*cz78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz78(i1,i2)%e(3)*p178k0+p178(3)*cz78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz78(i1,i2)%e(0)*p1(0)-cz78(i1,i2)%e(1)*p1(1)-cz78(i1
     & ,i2)%e(2)*p1(2)-cz78(i1,i2)%e(3)*p1(3)
      cvqd=cz78(i1,i2)%e(0)*p178(0)-cz78(i1,i2)%e(1)*p178(1)-cz7
     & 8(i1,i2)%e(2)*p178(2)-cz78(i1,i2)%e(3)*p178(3)
      cauxa=-cz78(i1,i2)%ek0*quqd+p1k0*cvqd+p178k0*cvqu
      cauxb=-cz78(i1,i2)%ek0*p178(2)+p178k0*cz78(i1,i2)%e(2)
      cauxc=+cz78(i1,i2)%ek0*p1(2)-p1k0*cz78(i1,i2)%e(2)
      l1_78(i1,i2)%a(1,1)=l1_78(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      l1_78(i1,i2)%a(2,2)=l1_78(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      l1_78(i1,i2)%b(1,2)=l1_78(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      l1_78(i1,i2)%b(2,1)=l1_78(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      l1_78(i1,i2)%c(1,2)=l1_78(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      l1_78(i1,i2)%c(2,1)=l1_78(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      l1_78(i1,i2)%d(1,1)=l1_78(i1,i2)%d(1,1)+ccl*cz78(i1,i2)%ek
     & 0
      l1_78(i1,i2)%d(2,2)=l1_78(i1,i2)%d(2,2)+ccr*cz78(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.id7.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p1,qd=p178,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p1k0*p178(2)+p178k0*p1(2)
      cauxa=auxa-cim*(p178(3)*p1k0-p1(3)*p178k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p178k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p1k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p178q-rmass2(id1))*p178k0)
       do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l1_78(i1,i2)%a(i3,i4)=ch78(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  l1_78(i1,i2)%b(i3,i4)=ch78(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  l1_78(i1,i2)%c(i3,i4)=ch78(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l1_78(i1,i2)%a(i3,i4)=czero
                else
                  l1_78(i1,i2)%b(i3,i4)=czero
                  l1_78(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
      do m=0,3
        p312(m)=p3(m)+p12(m)
      enddo
* pk0 -- p=p312
      p312k0=p312(0)-p312(1)
* p.q -- p.q=p312q,p=p312,q=p312,bef=,aft=
      p312q=(p312(0)*p312(0)-p312(1)*p312(1)-p312(2)*p312(2)-p31
     & 2(3)*p312(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id3).ne.1) then
* quqd -- p=p3,q=p312
      quqd=p3(0)*p312(0)-p3(1)*p312(1)-p3(2)*p312(2)-p3(3)*p312(
     & 3)
      ccr=fcr(id3)/((p312q-rmass2(id3))*p312k0)
      ccl=fcl(id3)/((p312q-rmass2(id3))*p312k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p3,qd=p312,v=cf12(i1,i2)%e,a=l3_12(i1,i2)%a,b=l3_12(i1,i2)%b,c
* =l3_12(i1,i2)%c,d=l3_12(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf12(i1,i2)%ek0*(p3(2)*p312(3)-p312(2)*p3(3))+p3k0
     & *(cf12(i1,i2)%e(2)*p312(3)-p312(2)*cf12(i1,i2)%e(3))-p312
     & k0*(cf12(i1,i2)%e(2)*p3(3)-p3(2)*cf12(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf12(i1,i2)%e(3)*p3k0+p3(3)*cf12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf12(i1,i2)%e(3)*p312k0+p312(3)*cf12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf12(i1,i2)%e(0)*p3(0)-cf12(i1,i2)%e(1)*p3(1)-cf12(i1
     & ,i2)%e(2)*p3(2)-cf12(i1,i2)%e(3)*p3(3)
      cvqd=cf12(i1,i2)%e(0)*p312(0)-cf12(i1,i2)%e(1)*p312(1)-cf1
     & 2(i1,i2)%e(2)*p312(2)-cf12(i1,i2)%e(3)*p312(3)
      cauxa=-cf12(i1,i2)%ek0*quqd+p3k0*cvqd+p312k0*cvqu
      cauxb=-cf12(i1,i2)%ek0*p312(2)+p312k0*cf12(i1,i2)%e(2)
      cauxc=+cf12(i1,i2)%ek0*p3(2)-p3k0*cf12(i1,i2)%e(2)
      l3_12(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      l3_12(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      l3_12(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      l3_12(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      l3_12(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      l3_12(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      l3_12(i1,i2)%d(1,1)=ccl*cf12(i1,i2)%ek0
      l3_12(i1,i2)%d(2,2)=ccr*cf12(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                l3_12(i1,i2)%a(iut,jut)=czero
                l3_12(i1,i2)%b(iut,jut)=czero
                l3_12(i1,i2)%c(iut,jut)=czero
                l3_12(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id3).ne.1 .and. ilept(id1).ne.1) then
        do iut=1,2
          do jut=1,2
            lg3_12(iut,jut)%a(1,1) = l3_12(iut,jut)%a(1,1)
     &           /((fcl(id3))*(fcl(id1)))
            lg3_12(iut,jut)%a(2,2) = l3_12(iut,jut)%a(2,2)
     &           /((fcl(id3))*(fcl(id1)))
            lg3_12(iut,jut)%b(1,2) = l3_12(iut,jut)%b(1,2)
     &           /((fcl(id3))*(fcl(id1)))
            lg3_12(iut,jut)%b(2,1) = l3_12(iut,jut)%b(2,1)
     &           /((fcl(id3))*(fcl(id1)))
            lg3_12(iut,jut)%c(1,2) = l3_12(iut,jut)%c(1,2)
     &           /((fcl(id3))*(fcl(id1)))
            lg3_12(iut,jut)%c(2,1) = l3_12(iut,jut)%c(2,1)
     &           /((fcl(id3))*(fcl(id1)))
            lg3_12(iut,jut)%d(1,1) = l3_12(iut,jut)%d(1,1)
     &           /((fcl(id3))*(fcl(id1)))
            lg3_12(iut,jut)%d(2,2) = l3_12(iut,jut)%d(2,2)
     &           /((fcl(id3))*(fcl(id1)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            lg3_12(iut,jut)%a(1,1) = czero
            lg3_12(iut,jut)%a(2,2) = czero
            lg3_12(iut,jut)%b(1,2) = czero
            lg3_12(iut,jut)%b(2,1) = czero
            lg3_12(iut,jut)%c(1,2) = czero
            lg3_12(iut,jut)%c(2,1) = czero
            lg3_12(iut,jut)%d(1,1) = czero
            lg3_12(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p3,q=p312
      quqd=p3(0)*p312(0)-p3(1)*p312(1)-p3(2)*p312(2)-p3(3)*p312(
     & 3)
      ccr=zcr(id3)/((p312q-rmass2(id3))*p312k0)
      ccl=zcl(id3)/((p312q-rmass2(id3))*p312k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p3,qd=p312,v=cz12(i1,i2)%e,a=l3_12(i1,i2)%a,b=l3_12(i1,i2)%b,c
* =l3_12(i1,i2)%c,d=l3_12(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz12(i1,i2)%ek0*(p3(2)*p312(3)-p312(2)*p3(3))+p3k0
     & *(cz12(i1,i2)%e(2)*p312(3)-p312(2)*cz12(i1,i2)%e(3))-p312
     & k0*(cz12(i1,i2)%e(2)*p3(3)-p3(2)*cz12(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz12(i1,i2)%e(3)*p3k0+p3(3)*cz12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz12(i1,i2)%e(3)*p312k0+p312(3)*cz12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz12(i1,i2)%e(0)*p3(0)-cz12(i1,i2)%e(1)*p3(1)-cz12(i1
     & ,i2)%e(2)*p3(2)-cz12(i1,i2)%e(3)*p3(3)
      cvqd=cz12(i1,i2)%e(0)*p312(0)-cz12(i1,i2)%e(1)*p312(1)-cz1
     & 2(i1,i2)%e(2)*p312(2)-cz12(i1,i2)%e(3)*p312(3)
      cauxa=-cz12(i1,i2)%ek0*quqd+p3k0*cvqd+p312k0*cvqu
      cauxb=-cz12(i1,i2)%ek0*p312(2)+p312k0*cz12(i1,i2)%e(2)
      cauxc=+cz12(i1,i2)%ek0*p3(2)-p3k0*cz12(i1,i2)%e(2)
      l3_12(i1,i2)%a(1,1)=l3_12(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      l3_12(i1,i2)%a(2,2)=l3_12(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      l3_12(i1,i2)%b(1,2)=l3_12(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      l3_12(i1,i2)%b(2,1)=l3_12(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      l3_12(i1,i2)%c(1,2)=l3_12(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      l3_12(i1,i2)%c(2,1)=l3_12(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      l3_12(i1,i2)%d(1,1)=l3_12(i1,i2)%d(1,1)+ccl*cz12(i1,i2)%ek
     & 0
      l3_12(i1,i2)%d(2,2)=l3_12(i1,i2)%d(2,2)+ccr*cz12(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.id1.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p3,qd=p312,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p3k0*p312(2)+p312k0*p3(2)
      cauxa=auxa-cim*(p312(3)*p3k0-p3(3)*p312k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p312k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p3k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p312q-rmass2(id3))*p312k0)
       do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l3_12(i1,i2)%a(i3,i4)=ch12(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  l3_12(i1,i2)%b(i3,i4)=ch12(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  l3_12(i1,i2)%c(i3,i4)=ch12(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l3_12(i1,i2)%a(i3,i4)=czero
                else
                  l3_12(i1,i2)%b(i3,i4)=czero
                  l3_12(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
      do m=0,3
        p356(m)=p3(m)+p56(m)
      enddo
* pk0 -- p=p356
      p356k0=p356(0)-p356(1)
* p.q -- p.q=p356q,p=p356,q=p356,bef=,aft=
      p356q=(p356(0)*p356(0)-p356(1)*p356(1)-p356(2)*p356(2)-p35
     & 6(3)*p356(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id3).ne.1) then
* quqd -- p=p3,q=p356
      quqd=p3(0)*p356(0)-p3(1)*p356(1)-p3(2)*p356(2)-p3(3)*p356(
     & 3)
      ccr=fcr(id3)/((p356q-rmass2(id3))*p356k0)
      ccl=fcl(id3)/((p356q-rmass2(id3))*p356k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p3,qd=p356,v=cf56(i1,i2)%e,a=l3_56(i1,i2)%a,b=l3_56(i1,i2)%b,c
* =l3_56(i1,i2)%c,d=l3_56(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf56(i1,i2)%ek0*(p3(2)*p356(3)-p356(2)*p3(3))+p3k0
     & *(cf56(i1,i2)%e(2)*p356(3)-p356(2)*cf56(i1,i2)%e(3))-p356
     & k0*(cf56(i1,i2)%e(2)*p3(3)-p3(2)*cf56(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf56(i1,i2)%e(3)*p3k0+p3(3)*cf56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf56(i1,i2)%e(3)*p356k0+p356(3)*cf56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf56(i1,i2)%e(0)*p3(0)-cf56(i1,i2)%e(1)*p3(1)-cf56(i1
     & ,i2)%e(2)*p3(2)-cf56(i1,i2)%e(3)*p3(3)
      cvqd=cf56(i1,i2)%e(0)*p356(0)-cf56(i1,i2)%e(1)*p356(1)-cf5
     & 6(i1,i2)%e(2)*p356(2)-cf56(i1,i2)%e(3)*p356(3)
      cauxa=-cf56(i1,i2)%ek0*quqd+p3k0*cvqd+p356k0*cvqu
      cauxb=-cf56(i1,i2)%ek0*p356(2)+p356k0*cf56(i1,i2)%e(2)
      cauxc=+cf56(i1,i2)%ek0*p3(2)-p3k0*cf56(i1,i2)%e(2)
      l3_56(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      l3_56(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      l3_56(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      l3_56(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      l3_56(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      l3_56(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      l3_56(i1,i2)%d(1,1)=ccl*cf56(i1,i2)%ek0
      l3_56(i1,i2)%d(2,2)=ccr*cf56(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                l3_56(i1,i2)%a(iut,jut)=czero
                l3_56(i1,i2)%b(iut,jut)=czero
                l3_56(i1,i2)%c(iut,jut)=czero
                l3_56(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id3).ne.1 .and. ilept(id5).ne.1) then
        do iut=1,2
          do jut=1,2
            lg3_56(iut,jut)%a(1,1) = l3_56(iut,jut)%a(1,1)
     &           /((fcl(id3))*(fcl(id5)))
            lg3_56(iut,jut)%a(2,2) = l3_56(iut,jut)%a(2,2)
     &           /((fcl(id3))*(fcl(id5)))
            lg3_56(iut,jut)%b(1,2) = l3_56(iut,jut)%b(1,2)
     &           /((fcl(id3))*(fcl(id5)))
            lg3_56(iut,jut)%b(2,1) = l3_56(iut,jut)%b(2,1)
     &           /((fcl(id3))*(fcl(id5)))
            lg3_56(iut,jut)%c(1,2) = l3_56(iut,jut)%c(1,2)
     &           /((fcl(id3))*(fcl(id5)))
            lg3_56(iut,jut)%c(2,1) = l3_56(iut,jut)%c(2,1)
     &           /((fcl(id3))*(fcl(id5)))
            lg3_56(iut,jut)%d(1,1) = l3_56(iut,jut)%d(1,1)
     &           /((fcl(id3))*(fcl(id5)))
            lg3_56(iut,jut)%d(2,2) = l3_56(iut,jut)%d(2,2)
     &           /((fcl(id3))*(fcl(id5)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            lg3_56(iut,jut)%a(1,1) = czero
            lg3_56(iut,jut)%a(2,2) = czero
            lg3_56(iut,jut)%b(1,2) = czero
            lg3_56(iut,jut)%b(2,1) = czero
            lg3_56(iut,jut)%c(1,2) = czero
            lg3_56(iut,jut)%c(2,1) = czero
            lg3_56(iut,jut)%d(1,1) = czero
            lg3_56(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p3,q=p356
      quqd=p3(0)*p356(0)-p3(1)*p356(1)-p3(2)*p356(2)-p3(3)*p356(
     & 3)
      ccr=zcr(id3)/((p356q-rmass2(id3))*p356k0)
      ccl=zcl(id3)/((p356q-rmass2(id3))*p356k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p3,qd=p356,v=cz56(i1,i2)%e,a=l3_56(i1,i2)%a,b=l3_56(i1,i2)%b,c
* =l3_56(i1,i2)%c,d=l3_56(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz56(i1,i2)%ek0*(p3(2)*p356(3)-p356(2)*p3(3))+p3k0
     & *(cz56(i1,i2)%e(2)*p356(3)-p356(2)*cz56(i1,i2)%e(3))-p356
     & k0*(cz56(i1,i2)%e(2)*p3(3)-p3(2)*cz56(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz56(i1,i2)%e(3)*p3k0+p3(3)*cz56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz56(i1,i2)%e(3)*p356k0+p356(3)*cz56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz56(i1,i2)%e(0)*p3(0)-cz56(i1,i2)%e(1)*p3(1)-cz56(i1
     & ,i2)%e(2)*p3(2)-cz56(i1,i2)%e(3)*p3(3)
      cvqd=cz56(i1,i2)%e(0)*p356(0)-cz56(i1,i2)%e(1)*p356(1)-cz5
     & 6(i1,i2)%e(2)*p356(2)-cz56(i1,i2)%e(3)*p356(3)
      cauxa=-cz56(i1,i2)%ek0*quqd+p3k0*cvqd+p356k0*cvqu
      cauxb=-cz56(i1,i2)%ek0*p356(2)+p356k0*cz56(i1,i2)%e(2)
      cauxc=+cz56(i1,i2)%ek0*p3(2)-p3k0*cz56(i1,i2)%e(2)
      l3_56(i1,i2)%a(1,1)=l3_56(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      l3_56(i1,i2)%a(2,2)=l3_56(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      l3_56(i1,i2)%b(1,2)=l3_56(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      l3_56(i1,i2)%b(2,1)=l3_56(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      l3_56(i1,i2)%c(1,2)=l3_56(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      l3_56(i1,i2)%c(2,1)=l3_56(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      l3_56(i1,i2)%d(1,1)=l3_56(i1,i2)%d(1,1)+ccl*cz56(i1,i2)%ek
     & 0
      l3_56(i1,i2)%d(2,2)=l3_56(i1,i2)%d(2,2)+ccr*cz56(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.id5.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p3,qd=p356,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p3k0*p356(2)+p356k0*p3(2)
      cauxa=auxa-cim*(p356(3)*p3k0-p3(3)*p356k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p356k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p3k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p356q-rmass2(id3))*p356k0)
       do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l3_56(i1,i2)%a(i3,i4)=ch56(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  l3_56(i1,i2)%b(i3,i4)=ch56(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  l3_56(i1,i2)%c(i3,i4)=ch56(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l3_56(i1,i2)%a(i3,i4)=czero
                else
                  l3_56(i1,i2)%b(i3,i4)=czero
                  l3_56(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
      do m=0,3
        p378(m)=p3(m)+p78(m)
      enddo
* pk0 -- p=p378
      p378k0=p378(0)-p378(1)
* p.q -- p.q=p378q,p=p378,q=p378,bef=,aft=
      p378q=(p378(0)*p378(0)-p378(1)*p378(1)-p378(2)*p378(2)-p37
     & 8(3)*p378(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id3).ne.1) then
* quqd -- p=p3,q=p378
      quqd=p3(0)*p378(0)-p3(1)*p378(1)-p3(2)*p378(2)-p3(3)*p378(
     & 3)
      ccr=fcr(id3)/((p378q-rmass2(id3))*p378k0)
      ccl=fcl(id3)/((p378q-rmass2(id3))*p378k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p3,qd=p378,v=cf78(i1,i2)%e,a=l3_78(i1,i2)%a,b=l3_78(i1,i2)%b,c
* =l3_78(i1,i2)%c,d=l3_78(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf78(i1,i2)%ek0*(p3(2)*p378(3)-p378(2)*p3(3))+p3k0
     & *(cf78(i1,i2)%e(2)*p378(3)-p378(2)*cf78(i1,i2)%e(3))-p378
     & k0*(cf78(i1,i2)%e(2)*p3(3)-p3(2)*cf78(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf78(i1,i2)%e(3)*p3k0+p3(3)*cf78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf78(i1,i2)%e(3)*p378k0+p378(3)*cf78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf78(i1,i2)%e(0)*p3(0)-cf78(i1,i2)%e(1)*p3(1)-cf78(i1
     & ,i2)%e(2)*p3(2)-cf78(i1,i2)%e(3)*p3(3)
      cvqd=cf78(i1,i2)%e(0)*p378(0)-cf78(i1,i2)%e(1)*p378(1)-cf7
     & 8(i1,i2)%e(2)*p378(2)-cf78(i1,i2)%e(3)*p378(3)
      cauxa=-cf78(i1,i2)%ek0*quqd+p3k0*cvqd+p378k0*cvqu
      cauxb=-cf78(i1,i2)%ek0*p378(2)+p378k0*cf78(i1,i2)%e(2)
      cauxc=+cf78(i1,i2)%ek0*p3(2)-p3k0*cf78(i1,i2)%e(2)
      l3_78(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      l3_78(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      l3_78(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      l3_78(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      l3_78(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      l3_78(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      l3_78(i1,i2)%d(1,1)=ccl*cf78(i1,i2)%ek0
      l3_78(i1,i2)%d(2,2)=ccr*cf78(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                l3_78(i1,i2)%a(iut,jut)=czero
                l3_78(i1,i2)%b(iut,jut)=czero
                l3_78(i1,i2)%c(iut,jut)=czero
                l3_78(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id3).ne.1 .and. ilept(id7).ne.1) then
        do iut=1,2
          do jut=1,2
            lg3_78(iut,jut)%a(1,1) = l3_78(iut,jut)%a(1,1)
     &           /((fcl(id3))*(fcl(id7)))
            lg3_78(iut,jut)%a(2,2) = l3_78(iut,jut)%a(2,2)
     &           /((fcl(id3))*(fcl(id7)))
            lg3_78(iut,jut)%b(1,2) = l3_78(iut,jut)%b(1,2)
     &           /((fcl(id3))*(fcl(id7)))
            lg3_78(iut,jut)%b(2,1) = l3_78(iut,jut)%b(2,1)
     &           /((fcl(id3))*(fcl(id7)))
            lg3_78(iut,jut)%c(1,2) = l3_78(iut,jut)%c(1,2)
     &           /((fcl(id3))*(fcl(id7)))
            lg3_78(iut,jut)%c(2,1) = l3_78(iut,jut)%c(2,1)
     &           /((fcl(id3))*(fcl(id7)))
            lg3_78(iut,jut)%d(1,1) = l3_78(iut,jut)%d(1,1)
     &           /((fcl(id3))*(fcl(id7)))
            lg3_78(iut,jut)%d(2,2) = l3_78(iut,jut)%d(2,2)
     &           /((fcl(id3))*(fcl(id7)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            lg3_78(iut,jut)%a(1,1) = czero
            lg3_78(iut,jut)%a(2,2) = czero
            lg3_78(iut,jut)%b(1,2) = czero
            lg3_78(iut,jut)%b(2,1) = czero
            lg3_78(iut,jut)%c(1,2) = czero
            lg3_78(iut,jut)%c(2,1) = czero
            lg3_78(iut,jut)%d(1,1) = czero
            lg3_78(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p3,q=p378
      quqd=p3(0)*p378(0)-p3(1)*p378(1)-p3(2)*p378(2)-p3(3)*p378(
     & 3)
      ccr=zcr(id3)/((p378q-rmass2(id3))*p378k0)
      ccl=zcl(id3)/((p378q-rmass2(id3))*p378k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p3,qd=p378,v=cz78(i1,i2)%e,a=l3_78(i1,i2)%a,b=l3_78(i1,i2)%b,c
* =l3_78(i1,i2)%c,d=l3_78(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz78(i1,i2)%ek0*(p3(2)*p378(3)-p378(2)*p3(3))+p3k0
     & *(cz78(i1,i2)%e(2)*p378(3)-p378(2)*cz78(i1,i2)%e(3))-p378
     & k0*(cz78(i1,i2)%e(2)*p3(3)-p3(2)*cz78(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz78(i1,i2)%e(3)*p3k0+p3(3)*cz78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz78(i1,i2)%e(3)*p378k0+p378(3)*cz78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz78(i1,i2)%e(0)*p3(0)-cz78(i1,i2)%e(1)*p3(1)-cz78(i1
     & ,i2)%e(2)*p3(2)-cz78(i1,i2)%e(3)*p3(3)
      cvqd=cz78(i1,i2)%e(0)*p378(0)-cz78(i1,i2)%e(1)*p378(1)-cz7
     & 8(i1,i2)%e(2)*p378(2)-cz78(i1,i2)%e(3)*p378(3)
      cauxa=-cz78(i1,i2)%ek0*quqd+p3k0*cvqd+p378k0*cvqu
      cauxb=-cz78(i1,i2)%ek0*p378(2)+p378k0*cz78(i1,i2)%e(2)
      cauxc=+cz78(i1,i2)%ek0*p3(2)-p3k0*cz78(i1,i2)%e(2)
      l3_78(i1,i2)%a(1,1)=l3_78(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      l3_78(i1,i2)%a(2,2)=l3_78(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      l3_78(i1,i2)%b(1,2)=l3_78(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      l3_78(i1,i2)%b(2,1)=l3_78(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      l3_78(i1,i2)%c(1,2)=l3_78(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      l3_78(i1,i2)%c(2,1)=l3_78(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      l3_78(i1,i2)%d(1,1)=l3_78(i1,i2)%d(1,1)+ccl*cz78(i1,i2)%ek
     & 0
      l3_78(i1,i2)%d(2,2)=l3_78(i1,i2)%d(2,2)+ccr*cz78(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.id7.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p3,qd=p378,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p3k0*p378(2)+p378k0*p3(2)
      cauxa=auxa-cim*(p378(3)*p3k0-p3(3)*p378k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p378k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p3k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p378q-rmass2(id3))*p378k0)
       do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l3_78(i1,i2)%a(i3,i4)=ch78(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  l3_78(i1,i2)%b(i3,i4)=ch78(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  l3_78(i1,i2)%c(i3,i4)=ch78(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l3_78(i1,i2)%a(i3,i4)=czero
                else
                  l3_78(i1,i2)%b(i3,i4)=czero
                  l3_78(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
      do m=0,3
        p512(m)=p5(m)+p12(m)
      enddo
* pk0 -- p=p512
      p512k0=p512(0)-p512(1)
* p.q -- p.q=p512q,p=p512,q=p512,bef=,aft=
      p512q=(p512(0)*p512(0)-p512(1)*p512(1)-p512(2)*p512(2)-p51
     & 2(3)*p512(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id5).ne.1) then
* quqd -- p=p5,q=p512
      quqd=p5(0)*p512(0)-p5(1)*p512(1)-p5(2)*p512(2)-p5(3)*p512(
     & 3)
      ccr=fcr(id5)/((p512q-rmass2(id5))*p512k0)
      ccl=fcl(id5)/((p512q-rmass2(id5))*p512k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p5,qd=p512,v=cf12(i1,i2)%e,a=l5_12(i1,i2)%a,b=l5_12(i1,i2)%b,c
* =l5_12(i1,i2)%c,d=l5_12(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf12(i1,i2)%ek0*(p5(2)*p512(3)-p512(2)*p5(3))+p5k0
     & *(cf12(i1,i2)%e(2)*p512(3)-p512(2)*cf12(i1,i2)%e(3))-p512
     & k0*(cf12(i1,i2)%e(2)*p5(3)-p5(2)*cf12(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf12(i1,i2)%e(3)*p5k0+p5(3)*cf12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf12(i1,i2)%e(3)*p512k0+p512(3)*cf12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf12(i1,i2)%e(0)*p5(0)-cf12(i1,i2)%e(1)*p5(1)-cf12(i1
     & ,i2)%e(2)*p5(2)-cf12(i1,i2)%e(3)*p5(3)
      cvqd=cf12(i1,i2)%e(0)*p512(0)-cf12(i1,i2)%e(1)*p512(1)-cf1
     & 2(i1,i2)%e(2)*p512(2)-cf12(i1,i2)%e(3)*p512(3)
      cauxa=-cf12(i1,i2)%ek0*quqd+p5k0*cvqd+p512k0*cvqu
      cauxb=-cf12(i1,i2)%ek0*p512(2)+p512k0*cf12(i1,i2)%e(2)
      cauxc=+cf12(i1,i2)%ek0*p5(2)-p5k0*cf12(i1,i2)%e(2)
      l5_12(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      l5_12(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      l5_12(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      l5_12(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      l5_12(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      l5_12(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      l5_12(i1,i2)%d(1,1)=ccl*cf12(i1,i2)%ek0
      l5_12(i1,i2)%d(2,2)=ccr*cf12(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                l5_12(i1,i2)%a(iut,jut)=czero
                l5_12(i1,i2)%b(iut,jut)=czero
                l5_12(i1,i2)%c(iut,jut)=czero
                l5_12(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id5).ne.1 .and. ilept(id1).ne.1) then
        do iut=1,2
          do jut=1,2
            lg5_12(iut,jut)%a(1,1) = l5_12(iut,jut)%a(1,1)
     &           /((fcl(id5))*(fcl(id1)))
            lg5_12(iut,jut)%a(2,2) = l5_12(iut,jut)%a(2,2)
     &           /((fcl(id5))*(fcl(id1)))
            lg5_12(iut,jut)%b(1,2) = l5_12(iut,jut)%b(1,2)
     &           /((fcl(id5))*(fcl(id1)))
            lg5_12(iut,jut)%b(2,1) = l5_12(iut,jut)%b(2,1)
     &           /((fcl(id5))*(fcl(id1)))
            lg5_12(iut,jut)%c(1,2) = l5_12(iut,jut)%c(1,2)
     &           /((fcl(id5))*(fcl(id1)))
            lg5_12(iut,jut)%c(2,1) = l5_12(iut,jut)%c(2,1)
     &           /((fcl(id5))*(fcl(id1)))
            lg5_12(iut,jut)%d(1,1) = l5_12(iut,jut)%d(1,1)
     &           /((fcl(id5))*(fcl(id1)))
            lg5_12(iut,jut)%d(2,2) = l5_12(iut,jut)%d(2,2)
     &           /((fcl(id5))*(fcl(id1)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            lg5_12(iut,jut)%a(1,1) = czero
            lg5_12(iut,jut)%a(2,2) = czero
            lg5_12(iut,jut)%b(1,2) = czero
            lg5_12(iut,jut)%b(2,1) = czero
            lg5_12(iut,jut)%c(1,2) = czero
            lg5_12(iut,jut)%c(2,1) = czero
            lg5_12(iut,jut)%d(1,1) = czero
            lg5_12(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p5,q=p512
      quqd=p5(0)*p512(0)-p5(1)*p512(1)-p5(2)*p512(2)-p5(3)*p512(
     & 3)
      ccr=zcr(id5)/((p512q-rmass2(id5))*p512k0)
      ccl=zcl(id5)/((p512q-rmass2(id5))*p512k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p5,qd=p512,v=cz12(i1,i2)%e,a=l5_12(i1,i2)%a,b=l5_12(i1,i2)%b,c
* =l5_12(i1,i2)%c,d=l5_12(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz12(i1,i2)%ek0*(p5(2)*p512(3)-p512(2)*p5(3))+p5k0
     & *(cz12(i1,i2)%e(2)*p512(3)-p512(2)*cz12(i1,i2)%e(3))-p512
     & k0*(cz12(i1,i2)%e(2)*p5(3)-p5(2)*cz12(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz12(i1,i2)%e(3)*p5k0+p5(3)*cz12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz12(i1,i2)%e(3)*p512k0+p512(3)*cz12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz12(i1,i2)%e(0)*p5(0)-cz12(i1,i2)%e(1)*p5(1)-cz12(i1
     & ,i2)%e(2)*p5(2)-cz12(i1,i2)%e(3)*p5(3)
      cvqd=cz12(i1,i2)%e(0)*p512(0)-cz12(i1,i2)%e(1)*p512(1)-cz1
     & 2(i1,i2)%e(2)*p512(2)-cz12(i1,i2)%e(3)*p512(3)
      cauxa=-cz12(i1,i2)%ek0*quqd+p5k0*cvqd+p512k0*cvqu
      cauxb=-cz12(i1,i2)%ek0*p512(2)+p512k0*cz12(i1,i2)%e(2)
      cauxc=+cz12(i1,i2)%ek0*p5(2)-p5k0*cz12(i1,i2)%e(2)
      l5_12(i1,i2)%a(1,1)=l5_12(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      l5_12(i1,i2)%a(2,2)=l5_12(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      l5_12(i1,i2)%b(1,2)=l5_12(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      l5_12(i1,i2)%b(2,1)=l5_12(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      l5_12(i1,i2)%c(1,2)=l5_12(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      l5_12(i1,i2)%c(2,1)=l5_12(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      l5_12(i1,i2)%d(1,1)=l5_12(i1,i2)%d(1,1)+ccl*cz12(i1,i2)%ek
     & 0
      l5_12(i1,i2)%d(2,2)=l5_12(i1,i2)%d(2,2)+ccr*cz12(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.id1.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p5,qd=p512,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p5k0*p512(2)+p512k0*p5(2)
      cauxa=auxa-cim*(p512(3)*p5k0-p5(3)*p512k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p512k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p5k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p512q-rmass2(id5))*p512k0)
       do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l5_12(i1,i2)%a(i3,i4)=ch12(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  l5_12(i1,i2)%b(i3,i4)=ch12(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  l5_12(i1,i2)%c(i3,i4)=ch12(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l5_12(i1,i2)%a(i3,i4)=czero
                else
                  l5_12(i1,i2)%b(i3,i4)=czero
                  l5_12(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
      do m=0,3
        p534(m)=p5(m)+p34(m)
      enddo
* pk0 -- p=p534
      p534k0=p534(0)-p534(1)
* p.q -- p.q=p534q,p=p534,q=p534,bef=,aft=
      p534q=(p534(0)*p534(0)-p534(1)*p534(1)-p534(2)*p534(2)-p53
     & 4(3)*p534(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id5).ne.1) then
* quqd -- p=p5,q=p534
      quqd=p5(0)*p534(0)-p5(1)*p534(1)-p5(2)*p534(2)-p5(3)*p534(
     & 3)
      ccr=fcr(id5)/((p534q-rmass2(id5))*p534k0)
      ccl=fcl(id5)/((p534q-rmass2(id5))*p534k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p5,qd=p534,v=cf34(i1,i2)%e,a=l5_34(i1,i2)%a,b=l5_34(i1,i2)%b,c
* =l5_34(i1,i2)%c,d=l5_34(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf34(i1,i2)%ek0*(p5(2)*p534(3)-p534(2)*p5(3))+p5k0
     & *(cf34(i1,i2)%e(2)*p534(3)-p534(2)*cf34(i1,i2)%e(3))-p534
     & k0*(cf34(i1,i2)%e(2)*p5(3)-p5(2)*cf34(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf34(i1,i2)%e(3)*p5k0+p5(3)*cf34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf34(i1,i2)%e(3)*p534k0+p534(3)*cf34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf34(i1,i2)%e(0)*p5(0)-cf34(i1,i2)%e(1)*p5(1)-cf34(i1
     & ,i2)%e(2)*p5(2)-cf34(i1,i2)%e(3)*p5(3)
      cvqd=cf34(i1,i2)%e(0)*p534(0)-cf34(i1,i2)%e(1)*p534(1)-cf3
     & 4(i1,i2)%e(2)*p534(2)-cf34(i1,i2)%e(3)*p534(3)
      cauxa=-cf34(i1,i2)%ek0*quqd+p5k0*cvqd+p534k0*cvqu
      cauxb=-cf34(i1,i2)%ek0*p534(2)+p534k0*cf34(i1,i2)%e(2)
      cauxc=+cf34(i1,i2)%ek0*p5(2)-p5k0*cf34(i1,i2)%e(2)
      l5_34(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      l5_34(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      l5_34(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      l5_34(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      l5_34(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      l5_34(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      l5_34(i1,i2)%d(1,1)=ccl*cf34(i1,i2)%ek0
      l5_34(i1,i2)%d(2,2)=ccr*cf34(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                l5_34(i1,i2)%a(iut,jut)=czero
                l5_34(i1,i2)%b(iut,jut)=czero
                l5_34(i1,i2)%c(iut,jut)=czero
                l5_34(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id5).ne.1 .and. ilept(id3).ne.1) then
        do iut=1,2
          do jut=1,2
            lg5_34(iut,jut)%a(1,1) = l5_34(iut,jut)%a(1,1)
     &           /((fcl(id5))*(fcl(id3)))
            lg5_34(iut,jut)%a(2,2) = l5_34(iut,jut)%a(2,2)
     &           /((fcl(id5))*(fcl(id3)))
            lg5_34(iut,jut)%b(1,2) = l5_34(iut,jut)%b(1,2)
     &           /((fcl(id5))*(fcl(id3)))
            lg5_34(iut,jut)%b(2,1) = l5_34(iut,jut)%b(2,1)
     &           /((fcl(id5))*(fcl(id3)))
            lg5_34(iut,jut)%c(1,2) = l5_34(iut,jut)%c(1,2)
     &           /((fcl(id5))*(fcl(id3)))
            lg5_34(iut,jut)%c(2,1) = l5_34(iut,jut)%c(2,1)
     &           /((fcl(id5))*(fcl(id3)))
            lg5_34(iut,jut)%d(1,1) = l5_34(iut,jut)%d(1,1)
     &           /((fcl(id5))*(fcl(id3)))
            lg5_34(iut,jut)%d(2,2) = l5_34(iut,jut)%d(2,2)
     &           /((fcl(id5))*(fcl(id3)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            lg5_34(iut,jut)%a(1,1) = czero
            lg5_34(iut,jut)%a(2,2) = czero
            lg5_34(iut,jut)%b(1,2) = czero
            lg5_34(iut,jut)%b(2,1) = czero
            lg5_34(iut,jut)%c(1,2) = czero
            lg5_34(iut,jut)%c(2,1) = czero
            lg5_34(iut,jut)%d(1,1) = czero
            lg5_34(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p5,q=p534
      quqd=p5(0)*p534(0)-p5(1)*p534(1)-p5(2)*p534(2)-p5(3)*p534(
     & 3)
      ccr=zcr(id5)/((p534q-rmass2(id5))*p534k0)
      ccl=zcl(id5)/((p534q-rmass2(id5))*p534k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p5,qd=p534,v=cz34(i1,i2)%e,a=l5_34(i1,i2)%a,b=l5_34(i1,i2)%b,c
* =l5_34(i1,i2)%c,d=l5_34(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz34(i1,i2)%ek0*(p5(2)*p534(3)-p534(2)*p5(3))+p5k0
     & *(cz34(i1,i2)%e(2)*p534(3)-p534(2)*cz34(i1,i2)%e(3))-p534
     & k0*(cz34(i1,i2)%e(2)*p5(3)-p5(2)*cz34(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz34(i1,i2)%e(3)*p5k0+p5(3)*cz34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz34(i1,i2)%e(3)*p534k0+p534(3)*cz34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz34(i1,i2)%e(0)*p5(0)-cz34(i1,i2)%e(1)*p5(1)-cz34(i1
     & ,i2)%e(2)*p5(2)-cz34(i1,i2)%e(3)*p5(3)
      cvqd=cz34(i1,i2)%e(0)*p534(0)-cz34(i1,i2)%e(1)*p534(1)-cz3
     & 4(i1,i2)%e(2)*p534(2)-cz34(i1,i2)%e(3)*p534(3)
      cauxa=-cz34(i1,i2)%ek0*quqd+p5k0*cvqd+p534k0*cvqu
      cauxb=-cz34(i1,i2)%ek0*p534(2)+p534k0*cz34(i1,i2)%e(2)
      cauxc=+cz34(i1,i2)%ek0*p5(2)-p5k0*cz34(i1,i2)%e(2)
      l5_34(i1,i2)%a(1,1)=l5_34(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      l5_34(i1,i2)%a(2,2)=l5_34(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      l5_34(i1,i2)%b(1,2)=l5_34(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      l5_34(i1,i2)%b(2,1)=l5_34(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      l5_34(i1,i2)%c(1,2)=l5_34(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      l5_34(i1,i2)%c(2,1)=l5_34(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      l5_34(i1,i2)%d(1,1)=l5_34(i1,i2)%d(1,1)+ccl*cz34(i1,i2)%ek
     & 0
      l5_34(i1,i2)%d(2,2)=l5_34(i1,i2)%d(2,2)+ccr*cz34(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.id3.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p5,qd=p534,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p5k0*p534(2)+p534k0*p5(2)
      cauxa=auxa-cim*(p534(3)*p5k0-p5(3)*p534k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p534k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p5k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p534q-rmass2(id5))*p534k0)
       do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l5_34(i1,i2)%a(i3,i4)=ch34(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  l5_34(i1,i2)%b(i3,i4)=ch34(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  l5_34(i1,i2)%c(i3,i4)=ch34(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l5_34(i1,i2)%a(i3,i4)=czero
                else
                  l5_34(i1,i2)%b(i3,i4)=czero
                  l5_34(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
      do m=0,3
        p578(m)=p5(m)+p78(m)
      enddo
* pk0 -- p=p578
      p578k0=p578(0)-p578(1)
* p.q -- p.q=p578q,p=p578,q=p578,bef=,aft=
      p578q=(p578(0)*p578(0)-p578(1)*p578(1)-p578(2)*p578(2)-p57
     & 8(3)*p578(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id5).ne.1) then
* quqd -- p=p5,q=p578
      quqd=p5(0)*p578(0)-p5(1)*p578(1)-p5(2)*p578(2)-p5(3)*p578(
     & 3)
      ccr=fcr(id5)/((p578q-rmass2(id5))*p578k0)
      ccl=fcl(id5)/((p578q-rmass2(id5))*p578k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p5,qd=p578,v=cf78(i1,i2)%e,a=l5_78(i1,i2)%a,b=l5_78(i1,i2)%b,c
* =l5_78(i1,i2)%c,d=l5_78(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf78(i1,i2)%ek0*(p5(2)*p578(3)-p578(2)*p5(3))+p5k0
     & *(cf78(i1,i2)%e(2)*p578(3)-p578(2)*cf78(i1,i2)%e(3))-p578
     & k0*(cf78(i1,i2)%e(2)*p5(3)-p5(2)*cf78(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf78(i1,i2)%e(3)*p5k0+p5(3)*cf78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf78(i1,i2)%e(3)*p578k0+p578(3)*cf78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf78(i1,i2)%e(0)*p5(0)-cf78(i1,i2)%e(1)*p5(1)-cf78(i1
     & ,i2)%e(2)*p5(2)-cf78(i1,i2)%e(3)*p5(3)
      cvqd=cf78(i1,i2)%e(0)*p578(0)-cf78(i1,i2)%e(1)*p578(1)-cf7
     & 8(i1,i2)%e(2)*p578(2)-cf78(i1,i2)%e(3)*p578(3)
      cauxa=-cf78(i1,i2)%ek0*quqd+p5k0*cvqd+p578k0*cvqu
      cauxb=-cf78(i1,i2)%ek0*p578(2)+p578k0*cf78(i1,i2)%e(2)
      cauxc=+cf78(i1,i2)%ek0*p5(2)-p5k0*cf78(i1,i2)%e(2)
      l5_78(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      l5_78(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      l5_78(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      l5_78(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      l5_78(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      l5_78(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      l5_78(i1,i2)%d(1,1)=ccl*cf78(i1,i2)%ek0
      l5_78(i1,i2)%d(2,2)=ccr*cf78(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                l5_78(i1,i2)%a(iut,jut)=czero
                l5_78(i1,i2)%b(iut,jut)=czero
                l5_78(i1,i2)%c(iut,jut)=czero
                l5_78(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id5).ne.1 .and. ilept(id7).ne.1) then
        do iut=1,2
          do jut=1,2
            lg5_78(iut,jut)%a(1,1) = l5_78(iut,jut)%a(1,1)
     &           /((fcl(id5))*(fcl(id7)))
            lg5_78(iut,jut)%a(2,2) = l5_78(iut,jut)%a(2,2)
     &           /((fcl(id5))*(fcl(id7)))
            lg5_78(iut,jut)%b(1,2) = l5_78(iut,jut)%b(1,2)
     &           /((fcl(id5))*(fcl(id7)))
            lg5_78(iut,jut)%b(2,1) = l5_78(iut,jut)%b(2,1)
     &           /((fcl(id5))*(fcl(id7)))
            lg5_78(iut,jut)%c(1,2) = l5_78(iut,jut)%c(1,2)
     &           /((fcl(id5))*(fcl(id7)))
            lg5_78(iut,jut)%c(2,1) = l5_78(iut,jut)%c(2,1)
     &           /((fcl(id5))*(fcl(id7)))
            lg5_78(iut,jut)%d(1,1) = l5_78(iut,jut)%d(1,1)
     &           /((fcl(id5))*(fcl(id7)))
            lg5_78(iut,jut)%d(2,2) = l5_78(iut,jut)%d(2,2)
     &           /((fcl(id5))*(fcl(id7)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            lg5_78(iut,jut)%a(1,1) = czero
            lg5_78(iut,jut)%a(2,2) = czero
            lg5_78(iut,jut)%b(1,2) = czero
            lg5_78(iut,jut)%b(2,1) = czero
            lg5_78(iut,jut)%c(1,2) = czero
            lg5_78(iut,jut)%c(2,1) = czero
            lg5_78(iut,jut)%d(1,1) = czero
            lg5_78(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p5,q=p578
      quqd=p5(0)*p578(0)-p5(1)*p578(1)-p5(2)*p578(2)-p5(3)*p578(
     & 3)
      ccr=zcr(id5)/((p578q-rmass2(id5))*p578k0)
      ccl=zcl(id5)/((p578q-rmass2(id5))*p578k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p5,qd=p578,v=cz78(i1,i2)%e,a=l5_78(i1,i2)%a,b=l5_78(i1,i2)%b,c
* =l5_78(i1,i2)%c,d=l5_78(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz78(i1,i2)%ek0*(p5(2)*p578(3)-p578(2)*p5(3))+p5k0
     & *(cz78(i1,i2)%e(2)*p578(3)-p578(2)*cz78(i1,i2)%e(3))-p578
     & k0*(cz78(i1,i2)%e(2)*p5(3)-p5(2)*cz78(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz78(i1,i2)%e(3)*p5k0+p5(3)*cz78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz78(i1,i2)%e(3)*p578k0+p578(3)*cz78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz78(i1,i2)%e(0)*p5(0)-cz78(i1,i2)%e(1)*p5(1)-cz78(i1
     & ,i2)%e(2)*p5(2)-cz78(i1,i2)%e(3)*p5(3)
      cvqd=cz78(i1,i2)%e(0)*p578(0)-cz78(i1,i2)%e(1)*p578(1)-cz7
     & 8(i1,i2)%e(2)*p578(2)-cz78(i1,i2)%e(3)*p578(3)
      cauxa=-cz78(i1,i2)%ek0*quqd+p5k0*cvqd+p578k0*cvqu
      cauxb=-cz78(i1,i2)%ek0*p578(2)+p578k0*cz78(i1,i2)%e(2)
      cauxc=+cz78(i1,i2)%ek0*p5(2)-p5k0*cz78(i1,i2)%e(2)
      l5_78(i1,i2)%a(1,1)=l5_78(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      l5_78(i1,i2)%a(2,2)=l5_78(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      l5_78(i1,i2)%b(1,2)=l5_78(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      l5_78(i1,i2)%b(2,1)=l5_78(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      l5_78(i1,i2)%c(1,2)=l5_78(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      l5_78(i1,i2)%c(2,1)=l5_78(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      l5_78(i1,i2)%d(1,1)=l5_78(i1,i2)%d(1,1)+ccl*cz78(i1,i2)%ek
     & 0
      l5_78(i1,i2)%d(2,2)=l5_78(i1,i2)%d(2,2)+ccr*cz78(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.id7.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p5,qd=p578,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p5k0*p578(2)+p578k0*p5(2)
      cauxa=auxa-cim*(p578(3)*p5k0-p5(3)*p578k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p578k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p5k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p578q-rmass2(id5))*p578k0)
       do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l5_78(i1,i2)%a(i3,i4)=ch78(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  l5_78(i1,i2)%b(i3,i4)=ch78(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  l5_78(i1,i2)%c(i3,i4)=ch78(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l5_78(i1,i2)%a(i3,i4)=czero
                else
                  l5_78(i1,i2)%b(i3,i4)=czero
                  l5_78(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
      do m=0,3
        p712(m)=p7(m)+p12(m)
      enddo
* pk0 -- p=p712
      p712k0=p712(0)-p712(1)
* p.q -- p.q=p712q,p=p712,q=p712,bef=,aft=
      p712q=(p712(0)*p712(0)-p712(1)*p712(1)-p712(2)*p712(2)-p71
     & 2(3)*p712(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id7).ne.1) then
* quqd -- p=p7,q=p712
      quqd=p7(0)*p712(0)-p7(1)*p712(1)-p7(2)*p712(2)-p7(3)*p712(
     & 3)
      ccr=fcr(id7)/((p712q-rmass2(id7))*p712k0)
      ccl=fcl(id7)/((p712q-rmass2(id7))*p712k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p7,qd=p712,v=cf12(i1,i2)%e,a=l7_12(i1,i2)%a,b=l7_12(i1,i2)%b,c
* =l7_12(i1,i2)%c,d=l7_12(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf12(i1,i2)%ek0*(p7(2)*p712(3)-p712(2)*p7(3))+p7k0
     & *(cf12(i1,i2)%e(2)*p712(3)-p712(2)*cf12(i1,i2)%e(3))-p712
     & k0*(cf12(i1,i2)%e(2)*p7(3)-p7(2)*cf12(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf12(i1,i2)%e(3)*p7k0+p7(3)*cf12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf12(i1,i2)%e(3)*p712k0+p712(3)*cf12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf12(i1,i2)%e(0)*p7(0)-cf12(i1,i2)%e(1)*p7(1)-cf12(i1
     & ,i2)%e(2)*p7(2)-cf12(i1,i2)%e(3)*p7(3)
      cvqd=cf12(i1,i2)%e(0)*p712(0)-cf12(i1,i2)%e(1)*p712(1)-cf1
     & 2(i1,i2)%e(2)*p712(2)-cf12(i1,i2)%e(3)*p712(3)
      cauxa=-cf12(i1,i2)%ek0*quqd+p7k0*cvqd+p712k0*cvqu
      cauxb=-cf12(i1,i2)%ek0*p712(2)+p712k0*cf12(i1,i2)%e(2)
      cauxc=+cf12(i1,i2)%ek0*p7(2)-p7k0*cf12(i1,i2)%e(2)
      l7_12(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      l7_12(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      l7_12(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      l7_12(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      l7_12(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      l7_12(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      l7_12(i1,i2)%d(1,1)=ccl*cf12(i1,i2)%ek0
      l7_12(i1,i2)%d(2,2)=ccr*cf12(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                l7_12(i1,i2)%a(iut,jut)=czero
                l7_12(i1,i2)%b(iut,jut)=czero
                l7_12(i1,i2)%c(iut,jut)=czero
                l7_12(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id7).ne.1 .and. ilept(id1).ne.1) then
        do iut=1,2
          do jut=1,2
            lg7_12(iut,jut)%a(1,1) = l7_12(iut,jut)%a(1,1)
     &           /((fcl(id7))*(fcl(id1)))
            lg7_12(iut,jut)%a(2,2) = l7_12(iut,jut)%a(2,2)
     &           /((fcl(id7))*(fcl(id1)))
            lg7_12(iut,jut)%b(1,2) = l7_12(iut,jut)%b(1,2)
     &           /((fcl(id7))*(fcl(id1)))
            lg7_12(iut,jut)%b(2,1) = l7_12(iut,jut)%b(2,1)
     &           /((fcl(id7))*(fcl(id1)))
            lg7_12(iut,jut)%c(1,2) = l7_12(iut,jut)%c(1,2)
     &           /((fcl(id7))*(fcl(id1)))
            lg7_12(iut,jut)%c(2,1) = l7_12(iut,jut)%c(2,1)
     &           /((fcl(id7))*(fcl(id1)))
            lg7_12(iut,jut)%d(1,1) = l7_12(iut,jut)%d(1,1)
     &           /((fcl(id7))*(fcl(id1)))
            lg7_12(iut,jut)%d(2,2) = l7_12(iut,jut)%d(2,2)
     &           /((fcl(id7))*(fcl(id1)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            lg7_12(iut,jut)%a(1,1) = czero
            lg7_12(iut,jut)%a(2,2) = czero
            lg7_12(iut,jut)%b(1,2) = czero
            lg7_12(iut,jut)%b(2,1) = czero
            lg7_12(iut,jut)%c(1,2) = czero
            lg7_12(iut,jut)%c(2,1) = czero
            lg7_12(iut,jut)%d(1,1) = czero
            lg7_12(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p7,q=p712
      quqd=p7(0)*p712(0)-p7(1)*p712(1)-p7(2)*p712(2)-p7(3)*p712(
     & 3)
      ccr=zcr(id7)/((p712q-rmass2(id7))*p712k0)
      ccl=zcl(id7)/((p712q-rmass2(id7))*p712k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p7,qd=p712,v=cz12(i1,i2)%e,a=l7_12(i1,i2)%a,b=l7_12(i1,i2)%b,c
* =l7_12(i1,i2)%c,d=l7_12(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz12(i1,i2)%ek0*(p7(2)*p712(3)-p712(2)*p7(3))+p7k0
     & *(cz12(i1,i2)%e(2)*p712(3)-p712(2)*cz12(i1,i2)%e(3))-p712
     & k0*(cz12(i1,i2)%e(2)*p7(3)-p7(2)*cz12(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz12(i1,i2)%e(3)*p7k0+p7(3)*cz12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz12(i1,i2)%e(3)*p712k0+p712(3)*cz12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz12(i1,i2)%e(0)*p7(0)-cz12(i1,i2)%e(1)*p7(1)-cz12(i1
     & ,i2)%e(2)*p7(2)-cz12(i1,i2)%e(3)*p7(3)
      cvqd=cz12(i1,i2)%e(0)*p712(0)-cz12(i1,i2)%e(1)*p712(1)-cz1
     & 2(i1,i2)%e(2)*p712(2)-cz12(i1,i2)%e(3)*p712(3)
      cauxa=-cz12(i1,i2)%ek0*quqd+p7k0*cvqd+p712k0*cvqu
      cauxb=-cz12(i1,i2)%ek0*p712(2)+p712k0*cz12(i1,i2)%e(2)
      cauxc=+cz12(i1,i2)%ek0*p7(2)-p7k0*cz12(i1,i2)%e(2)
      l7_12(i1,i2)%a(1,1)=l7_12(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      l7_12(i1,i2)%a(2,2)=l7_12(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      l7_12(i1,i2)%b(1,2)=l7_12(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      l7_12(i1,i2)%b(2,1)=l7_12(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      l7_12(i1,i2)%c(1,2)=l7_12(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      l7_12(i1,i2)%c(2,1)=l7_12(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      l7_12(i1,i2)%d(1,1)=l7_12(i1,i2)%d(1,1)+ccl*cz12(i1,i2)%ek
     & 0
      l7_12(i1,i2)%d(2,2)=l7_12(i1,i2)%d(2,2)+ccr*cz12(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
* rmh < 0 in our convention means no higgs coupling                     
      if (id7.eq.5.and.id1.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p7,qd=p712,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p7k0*p712(2)+p712k0*p7(2)
      cauxa=auxa-cim*(p712(3)*p7k0-p7(3)*p712k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p712k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p7k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p712q-rmass2(id7))*p712k0)
       do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l7_12(i1,i2)%a(i3,i4)=ch12(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  l7_12(i1,i2)%b(i3,i4)=ch12(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  l7_12(i1,i2)%c(i3,i4)=ch12(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l7_12(i1,i2)%a(i3,i4)=czero
                else
                  l7_12(i1,i2)%b(i3,i4)=czero
                  l7_12(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
      do m=0,3
        p734(m)=p7(m)+p34(m)
      enddo
* pk0 -- p=p734
      p734k0=p734(0)-p734(1)
* p.q -- p.q=p734q,p=p734,q=p734,bef=,aft=
      p734q=(p734(0)*p734(0)-p734(1)*p734(1)-p734(2)*p734(2)-p73
     & 4(3)*p734(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id7).ne.1) then
* quqd -- p=p7,q=p734
      quqd=p7(0)*p734(0)-p7(1)*p734(1)-p7(2)*p734(2)-p7(3)*p734(
     & 3)
      ccr=fcr(id7)/((p734q-rmass2(id7))*p734k0)
      ccl=fcl(id7)/((p734q-rmass2(id7))*p734k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p7,qd=p734,v=cf34(i1,i2)%e,a=l7_34(i1,i2)%a,b=l7_34(i1,i2)%b,c
* =l7_34(i1,i2)%c,d=l7_34(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf34(i1,i2)%ek0*(p7(2)*p734(3)-p734(2)*p7(3))+p7k0
     & *(cf34(i1,i2)%e(2)*p734(3)-p734(2)*cf34(i1,i2)%e(3))-p734
     & k0*(cf34(i1,i2)%e(2)*p7(3)-p7(2)*cf34(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf34(i1,i2)%e(3)*p7k0+p7(3)*cf34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf34(i1,i2)%e(3)*p734k0+p734(3)*cf34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf34(i1,i2)%e(0)*p7(0)-cf34(i1,i2)%e(1)*p7(1)-cf34(i1
     & ,i2)%e(2)*p7(2)-cf34(i1,i2)%e(3)*p7(3)
      cvqd=cf34(i1,i2)%e(0)*p734(0)-cf34(i1,i2)%e(1)*p734(1)-cf3
     & 4(i1,i2)%e(2)*p734(2)-cf34(i1,i2)%e(3)*p734(3)
      cauxa=-cf34(i1,i2)%ek0*quqd+p7k0*cvqd+p734k0*cvqu
      cauxb=-cf34(i1,i2)%ek0*p734(2)+p734k0*cf34(i1,i2)%e(2)
      cauxc=+cf34(i1,i2)%ek0*p7(2)-p7k0*cf34(i1,i2)%e(2)
      l7_34(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      l7_34(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      l7_34(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      l7_34(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      l7_34(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      l7_34(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      l7_34(i1,i2)%d(1,1)=ccl*cf34(i1,i2)%ek0
      l7_34(i1,i2)%d(2,2)=ccr*cf34(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                l7_34(i1,i2)%a(iut,jut)=czero
                l7_34(i1,i2)%b(iut,jut)=czero
                l7_34(i1,i2)%c(iut,jut)=czero
                l7_34(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id7).ne.1 .and. ilept(id3).ne.1) then
        do iut=1,2
          do jut=1,2
            lg7_34(iut,jut)%a(1,1) = l7_34(iut,jut)%a(1,1)
     &           /((fcl(id7))*(fcl(id3)))
            lg7_34(iut,jut)%a(2,2) = l7_34(iut,jut)%a(2,2)
     &           /((fcl(id7))*(fcl(id3)))
            lg7_34(iut,jut)%b(1,2) = l7_34(iut,jut)%b(1,2)
     &           /((fcl(id7))*(fcl(id3)))
            lg7_34(iut,jut)%b(2,1) = l7_34(iut,jut)%b(2,1)
     &           /((fcl(id7))*(fcl(id3)))
            lg7_34(iut,jut)%c(1,2) = l7_34(iut,jut)%c(1,2)
     &           /((fcl(id7))*(fcl(id3)))
            lg7_34(iut,jut)%c(2,1) = l7_34(iut,jut)%c(2,1)
     &           /((fcl(id7))*(fcl(id3)))
            lg7_34(iut,jut)%d(1,1) = l7_34(iut,jut)%d(1,1)
     &           /((fcl(id7))*(fcl(id3)))
            lg7_34(iut,jut)%d(2,2) = l7_34(iut,jut)%d(2,2)
     &           /((fcl(id7))*(fcl(id3)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            lg7_34(iut,jut)%a(1,1) = czero
            lg7_34(iut,jut)%a(2,2) = czero
            lg7_34(iut,jut)%b(1,2) = czero
            lg7_34(iut,jut)%b(2,1) = czero
            lg7_34(iut,jut)%c(1,2) = czero
            lg7_34(iut,jut)%c(2,1) = czero
            lg7_34(iut,jut)%d(1,1) = czero
            lg7_34(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p7,q=p734
      quqd=p7(0)*p734(0)-p7(1)*p734(1)-p7(2)*p734(2)-p7(3)*p734(
     & 3)
      ccr=zcr(id7)/((p734q-rmass2(id7))*p734k0)
      ccl=zcl(id7)/((p734q-rmass2(id7))*p734k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p7,qd=p734,v=cz34(i1,i2)%e,a=l7_34(i1,i2)%a,b=l7_34(i1,i2)%b,c
* =l7_34(i1,i2)%c,d=l7_34(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz34(i1,i2)%ek0*(p7(2)*p734(3)-p734(2)*p7(3))+p7k0
     & *(cz34(i1,i2)%e(2)*p734(3)-p734(2)*cz34(i1,i2)%e(3))-p734
     & k0*(cz34(i1,i2)%e(2)*p7(3)-p7(2)*cz34(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz34(i1,i2)%e(3)*p7k0+p7(3)*cz34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz34(i1,i2)%e(3)*p734k0+p734(3)*cz34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz34(i1,i2)%e(0)*p7(0)-cz34(i1,i2)%e(1)*p7(1)-cz34(i1
     & ,i2)%e(2)*p7(2)-cz34(i1,i2)%e(3)*p7(3)
      cvqd=cz34(i1,i2)%e(0)*p734(0)-cz34(i1,i2)%e(1)*p734(1)-cz3
     & 4(i1,i2)%e(2)*p734(2)-cz34(i1,i2)%e(3)*p734(3)
      cauxa=-cz34(i1,i2)%ek0*quqd+p7k0*cvqd+p734k0*cvqu
      cauxb=-cz34(i1,i2)%ek0*p734(2)+p734k0*cz34(i1,i2)%e(2)
      cauxc=+cz34(i1,i2)%ek0*p7(2)-p7k0*cz34(i1,i2)%e(2)
      l7_34(i1,i2)%a(1,1)=l7_34(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      l7_34(i1,i2)%a(2,2)=l7_34(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      l7_34(i1,i2)%b(1,2)=l7_34(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      l7_34(i1,i2)%b(2,1)=l7_34(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      l7_34(i1,i2)%c(1,2)=l7_34(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      l7_34(i1,i2)%c(2,1)=l7_34(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      l7_34(i1,i2)%d(1,1)=l7_34(i1,i2)%d(1,1)+ccl*cz34(i1,i2)%ek
     & 0
      l7_34(i1,i2)%d(2,2)=l7_34(i1,i2)%d(2,2)+ccr*cz34(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
* rmh < 0 in our convention means no higgs coupling                     
      if (id7.eq.5.and.id3.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p7,qd=p734,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p7k0*p734(2)+p734k0*p7(2)
      cauxa=auxa-cim*(p734(3)*p7k0-p7(3)*p734k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p734k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p7k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p734q-rmass2(id7))*p734k0)
       do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l7_34(i1,i2)%a(i3,i4)=ch34(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  l7_34(i1,i2)%b(i3,i4)=ch34(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  l7_34(i1,i2)%c(i3,i4)=ch34(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l7_34(i1,i2)%a(i3,i4)=czero
                else
                  l7_34(i1,i2)%b(i3,i4)=czero
                  l7_34(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
      do m=0,3
        p756(m)=p7(m)+p56(m)
      enddo
* pk0 -- p=p756
      p756k0=p756(0)-p756(1)
* p.q -- p.q=p756q,p=p756,q=p756,bef=,aft=
      p756q=(p756(0)*p756(0)-p756(1)*p756(1)-p756(2)*p756(2)-p75
     & 6(3)*p756(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id7).ne.1) then
* quqd -- p=p7,q=p756
      quqd=p7(0)*p756(0)-p7(1)*p756(1)-p7(2)*p756(2)-p7(3)*p756(
     & 3)
      ccr=fcr(id7)/((p756q-rmass2(id7))*p756k0)
      ccl=fcl(id7)/((p756q-rmass2(id7))*p756k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p7,qd=p756,v=cf56(i1,i2)%e,a=l7_56(i1,i2)%a,b=l7_56(i1,i2)%b,c
* =l7_56(i1,i2)%c,d=l7_56(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf56(i1,i2)%ek0*(p7(2)*p756(3)-p756(2)*p7(3))+p7k0
     & *(cf56(i1,i2)%e(2)*p756(3)-p756(2)*cf56(i1,i2)%e(3))-p756
     & k0*(cf56(i1,i2)%e(2)*p7(3)-p7(2)*cf56(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf56(i1,i2)%e(3)*p7k0+p7(3)*cf56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf56(i1,i2)%e(3)*p756k0+p756(3)*cf56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf56(i1,i2)%e(0)*p7(0)-cf56(i1,i2)%e(1)*p7(1)-cf56(i1
     & ,i2)%e(2)*p7(2)-cf56(i1,i2)%e(3)*p7(3)
      cvqd=cf56(i1,i2)%e(0)*p756(0)-cf56(i1,i2)%e(1)*p756(1)-cf5
     & 6(i1,i2)%e(2)*p756(2)-cf56(i1,i2)%e(3)*p756(3)
      cauxa=-cf56(i1,i2)%ek0*quqd+p7k0*cvqd+p756k0*cvqu
      cauxb=-cf56(i1,i2)%ek0*p756(2)+p756k0*cf56(i1,i2)%e(2)
      cauxc=+cf56(i1,i2)%ek0*p7(2)-p7k0*cf56(i1,i2)%e(2)
      l7_56(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      l7_56(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      l7_56(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      l7_56(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      l7_56(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      l7_56(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      l7_56(i1,i2)%d(1,1)=ccl*cf56(i1,i2)%ek0
      l7_56(i1,i2)%d(2,2)=ccr*cf56(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                l7_56(i1,i2)%a(iut,jut)=czero
                l7_56(i1,i2)%b(iut,jut)=czero
                l7_56(i1,i2)%c(iut,jut)=czero
                l7_56(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id7).ne.1 .and. ilept(id5).ne.1) then
        do iut=1,2
          do jut=1,2
            lg7_56(iut,jut)%a(1,1) = l7_56(iut,jut)%a(1,1)
     &           /((fcl(id7))*(fcl(id5)))
            lg7_56(iut,jut)%a(2,2) = l7_56(iut,jut)%a(2,2)
     &           /((fcl(id7))*(fcl(id5)))
            lg7_56(iut,jut)%b(1,2) = l7_56(iut,jut)%b(1,2)
     &           /((fcl(id7))*(fcl(id5)))
            lg7_56(iut,jut)%b(2,1) = l7_56(iut,jut)%b(2,1)
     &           /((fcl(id7))*(fcl(id5)))
            lg7_56(iut,jut)%c(1,2) = l7_56(iut,jut)%c(1,2)
     &           /((fcl(id7))*(fcl(id5)))
            lg7_56(iut,jut)%c(2,1) = l7_56(iut,jut)%c(2,1)
     &           /((fcl(id7))*(fcl(id5)))
            lg7_56(iut,jut)%d(1,1) = l7_56(iut,jut)%d(1,1)
     &           /((fcl(id7))*(fcl(id5)))
            lg7_56(iut,jut)%d(2,2) = l7_56(iut,jut)%d(2,2)
     &           /((fcl(id7))*(fcl(id5)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            lg7_56(iut,jut)%a(1,1) = czero
            lg7_56(iut,jut)%a(2,2) = czero
            lg7_56(iut,jut)%b(1,2) = czero
            lg7_56(iut,jut)%b(2,1) = czero
            lg7_56(iut,jut)%c(1,2) = czero
            lg7_56(iut,jut)%c(2,1) = czero
            lg7_56(iut,jut)%d(1,1) = czero
            lg7_56(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p7,q=p756
      quqd=p7(0)*p756(0)-p7(1)*p756(1)-p7(2)*p756(2)-p7(3)*p756(
     & 3)
      ccr=zcr(id7)/((p756q-rmass2(id7))*p756k0)
      ccl=zcl(id7)/((p756q-rmass2(id7))*p756k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p7,qd=p756,v=cz56(i1,i2)%e,a=l7_56(i1,i2)%a,b=l7_56(i1,i2)%b,c
* =l7_56(i1,i2)%c,d=l7_56(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz56(i1,i2)%ek0*(p7(2)*p756(3)-p756(2)*p7(3))+p7k0
     & *(cz56(i1,i2)%e(2)*p756(3)-p756(2)*cz56(i1,i2)%e(3))-p756
     & k0*(cz56(i1,i2)%e(2)*p7(3)-p7(2)*cz56(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz56(i1,i2)%e(3)*p7k0+p7(3)*cz56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz56(i1,i2)%e(3)*p756k0+p756(3)*cz56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz56(i1,i2)%e(0)*p7(0)-cz56(i1,i2)%e(1)*p7(1)-cz56(i1
     & ,i2)%e(2)*p7(2)-cz56(i1,i2)%e(3)*p7(3)
      cvqd=cz56(i1,i2)%e(0)*p756(0)-cz56(i1,i2)%e(1)*p756(1)-cz5
     & 6(i1,i2)%e(2)*p756(2)-cz56(i1,i2)%e(3)*p756(3)
      cauxa=-cz56(i1,i2)%ek0*quqd+p7k0*cvqd+p756k0*cvqu
      cauxb=-cz56(i1,i2)%ek0*p756(2)+p756k0*cz56(i1,i2)%e(2)
      cauxc=+cz56(i1,i2)%ek0*p7(2)-p7k0*cz56(i1,i2)%e(2)
      l7_56(i1,i2)%a(1,1)=l7_56(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      l7_56(i1,i2)%a(2,2)=l7_56(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      l7_56(i1,i2)%b(1,2)=l7_56(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      l7_56(i1,i2)%b(2,1)=l7_56(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      l7_56(i1,i2)%c(1,2)=l7_56(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      l7_56(i1,i2)%c(2,1)=l7_56(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      l7_56(i1,i2)%d(1,1)=l7_56(i1,i2)%d(1,1)+ccl*cz56(i1,i2)%ek
     & 0
      l7_56(i1,i2)%d(2,2)=l7_56(i1,i2)%d(2,2)+ccr*cz56(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
* rmh < 0 in our convention means no higgs coupling                     
      if (id7.eq.5.and.id5.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p7,qd=p756,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p7k0*p756(2)+p756k0*p7(2)
      cauxa=auxa-cim*(p756(3)*p7k0-p7(3)*p756k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p756k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p7k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p756q-rmass2(id7))*p756k0)
       do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l7_56(i1,i2)%a(i3,i4)=ch56(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  l7_56(i1,i2)%b(i3,i4)=ch56(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  l7_56(i1,i2)%c(i3,i4)=ch56(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  l7_56(i1,i2)%a(i3,i4)=czero
                else
                  l7_56(i1,i2)%b(i3,i4)=czero
                  l7_56(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
* COMPUTE ALL SINGLE INSERTIONS OF THE TYPE RI_ (I=2,4,6,8)  FOR A ZLINE
* AND A Z  GAMMA AND EVENTUALLY HIGGS INSERTION                         
*                                                                       
*            |_Z,f,h_/                                                  
*         i__|       \                                                  
*                                                                       
*together with its propagator and pk0                                   
*                                                                       
**QCD                                                                   
*    and their QCD counterparts                                         
*                                                                       
*            |~~g~~<                                                    
*         i__|                                                          
*                                                                       
*As g_strong and e are factorized, this class of QCD subdiagrams differs
*from that of gamma insertions by a factor (fcl(id_i))*(fcl(id_j)), with
*j={1,3,5,7} (notice that fcl=fcr for all fermions).                    
  
      do m=0,3
        p234(m)=-p2(m)-p34(m)
      enddo
* pk0 -- p=p234
      p234k0=p234(0)-p234(1)
* p.q -- p.q=p234q,p=p234,q=p234,bef=,aft=
      p234q=(p234(0)*p234(0)-p234(1)*p234(1)-p234(2)*p234(2)-p23
     & 4(3)*p234(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id2).ne.1) then
* quqd -- p=p234,q=p2
      quqd=p234(0)*p2(0)-p234(1)*p2(1)-p234(2)*p2(2)-p234(3)*p2(
     & 3)
      ccr=fcr(id2)/((p234q-rmass2(id2))*p234k0)
      ccl=fcl(id2)/((p234q-rmass2(id2))*p234k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p234,qd=p2,v=cf34(i1,i2)%e,a=r2_34(i1,i2)%a,b=r2_34(i1,i2)%b,c
* =r2_34(i1,i2)%c,d=r2_34(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf34(i1,i2)%ek0*(p234(2)*p2(3)-p2(2)*p234(3))+p234
     & k0*(cf34(i1,i2)%e(2)*p2(3)-p2(2)*cf34(i1,i2)%e(3))-p2k0*(
     & cf34(i1,i2)%e(2)*p234(3)-p234(2)*cf34(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf34(i1,i2)%e(3)*p234k0+p234(3)*cf34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf34(i1,i2)%e(3)*p2k0+p2(3)*cf34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf34(i1,i2)%e(0)*p234(0)-cf34(i1,i2)%e(1)*p234(1)-cf3
     & 4(i1,i2)%e(2)*p234(2)-cf34(i1,i2)%e(3)*p234(3)
      cvqd=cf34(i1,i2)%e(0)*p2(0)-cf34(i1,i2)%e(1)*p2(1)-cf34(i1
     & ,i2)%e(2)*p2(2)-cf34(i1,i2)%e(3)*p2(3)
      cauxa=-cf34(i1,i2)%ek0*quqd+p234k0*cvqd+p2k0*cvqu
      cauxb=-cf34(i1,i2)%ek0*p2(2)+p2k0*cf34(i1,i2)%e(2)
      cauxc=+cf34(i1,i2)%ek0*p234(2)-p234k0*cf34(i1,i2)%e(2)
      r2_34(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      r2_34(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      r2_34(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      r2_34(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      r2_34(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      r2_34(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      r2_34(i1,i2)%d(1,1)=ccl*cf34(i1,i2)%ek0
      r2_34(i1,i2)%d(2,2)=ccr*cf34(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                r2_34(i1,i2)%a(iut,jut)=czero
                r2_34(i1,i2)%b(iut,jut)=czero
                r2_34(i1,i2)%c(iut,jut)=czero
                r2_34(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id2).ne.1 .and. ilept(id4).ne.1) then
        do iut=1,2
          do jut=1,2
            rg2_34(iut,jut)%a(1,1) = r2_34(iut,jut)%a(1,1)
     &           /((fcl(id2))*(fcl(id4)))
            rg2_34(iut,jut)%a(2,2) = r2_34(iut,jut)%a(2,2)
     &           /((fcl(id2))*(fcl(id4)))
            rg2_34(iut,jut)%b(1,2) = r2_34(iut,jut)%b(1,2)
     &           /((fcl(id2))*(fcl(id4)))
            rg2_34(iut,jut)%b(2,1) = r2_34(iut,jut)%b(2,1)
     &           /((fcl(id2))*(fcl(id4)))
            rg2_34(iut,jut)%c(1,2) = r2_34(iut,jut)%c(1,2)
     &           /((fcl(id2))*(fcl(id4)))
            rg2_34(iut,jut)%c(2,1) = r2_34(iut,jut)%c(2,1)
     &           /((fcl(id2))*(fcl(id4)))
            rg2_34(iut,jut)%d(1,1) = r2_34(iut,jut)%d(1,1)
     &           /((fcl(id2))*(fcl(id4)))
            rg2_34(iut,jut)%d(2,2) = r2_34(iut,jut)%d(2,2)
     &           /((fcl(id2))*(fcl(id4)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            rg2_34(iut,jut)%a(1,1) = czero
            rg2_34(iut,jut)%a(2,2) = czero
            rg2_34(iut,jut)%b(1,2) = czero
            rg2_34(iut,jut)%b(2,1) = czero
            rg2_34(iut,jut)%c(1,2) = czero
            rg2_34(iut,jut)%c(2,1) = czero
            rg2_34(iut,jut)%d(1,1) = czero
            rg2_34(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p234,q=p2
      quqd=p234(0)*p2(0)-p234(1)*p2(1)-p234(2)*p2(2)-p234(3)*p2(
     & 3)
      ccr=zcr(id2)/((p234q-rmass2(id2))*p234k0)
      ccl=zcl(id2)/((p234q-rmass2(id2))*p234k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p234,qd=p2,v=cz34(i1,i2)%e,a=r2_34(i1,i2)%a,b=r2_34(i1,i2)%b,c
* =r2_34(i1,i2)%c,d=r2_34(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz34(i1,i2)%ek0*(p234(2)*p2(3)-p2(2)*p234(3))+p234
     & k0*(cz34(i1,i2)%e(2)*p2(3)-p2(2)*cz34(i1,i2)%e(3))-p2k0*(
     & cz34(i1,i2)%e(2)*p234(3)-p234(2)*cz34(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz34(i1,i2)%e(3)*p234k0+p234(3)*cz34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz34(i1,i2)%e(3)*p2k0+p2(3)*cz34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz34(i1,i2)%e(0)*p234(0)-cz34(i1,i2)%e(1)*p234(1)-cz3
     & 4(i1,i2)%e(2)*p234(2)-cz34(i1,i2)%e(3)*p234(3)
      cvqd=cz34(i1,i2)%e(0)*p2(0)-cz34(i1,i2)%e(1)*p2(1)-cz34(i1
     & ,i2)%e(2)*p2(2)-cz34(i1,i2)%e(3)*p2(3)
      cauxa=-cz34(i1,i2)%ek0*quqd+p234k0*cvqd+p2k0*cvqu
      cauxb=-cz34(i1,i2)%ek0*p2(2)+p2k0*cz34(i1,i2)%e(2)
      cauxc=+cz34(i1,i2)%ek0*p234(2)-p234k0*cz34(i1,i2)%e(2)
      r2_34(i1,i2)%a(1,1)=r2_34(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      r2_34(i1,i2)%a(2,2)=r2_34(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      r2_34(i1,i2)%b(1,2)=r2_34(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      r2_34(i1,i2)%b(2,1)=r2_34(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      r2_34(i1,i2)%c(1,2)=r2_34(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      r2_34(i1,i2)%c(2,1)=r2_34(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      r2_34(i1,i2)%d(1,1)=r2_34(i1,i2)%d(1,1)+ccl*cz34(i1,i2)%ek
     & 0
      r2_34(i1,i2)%d(2,2)=r2_34(i1,i2)%d(2,2)+ccr*cz34(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id2.eq.-5.and.id4.eq.-5.and.rmh.ge.0.d0) then
  
* TH -- qu=p234,qd=p2,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p234k0*p2(2)+p2k0*p234(2)
      cauxa=auxa-cim*(p2(3)*p234k0-p234(3)*p2k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p2k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p234k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p234q-rmass2(id2))*p234k0)
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r2_34(i1,i2)%a(i3,i4)=ch34(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  r2_34(i1,i2)%b(i3,i4)=ch34(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  r2_34(i1,i2)%c(i3,i4)=ch34(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r2_34(i1,i2)%a(i3,i4)=czero
                else
                  r2_34(i1,i2)%b(i3,i4)=czero
                  r2_34(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
      do m=0,3
        p256(m)=-p2(m)-p56(m)
      enddo
* pk0 -- p=p256
      p256k0=p256(0)-p256(1)
* p.q -- p.q=p256q,p=p256,q=p256,bef=,aft=
      p256q=(p256(0)*p256(0)-p256(1)*p256(1)-p256(2)*p256(2)-p25
     & 6(3)*p256(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id2).ne.1) then
* quqd -- p=p256,q=p2
      quqd=p256(0)*p2(0)-p256(1)*p2(1)-p256(2)*p2(2)-p256(3)*p2(
     & 3)
      ccr=fcr(id2)/((p256q-rmass2(id2))*p256k0)
      ccl=fcl(id2)/((p256q-rmass2(id2))*p256k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p256,qd=p2,v=cf56(i1,i2)%e,a=r2_56(i1,i2)%a,b=r2_56(i1,i2)%b,c
* =r2_56(i1,i2)%c,d=r2_56(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf56(i1,i2)%ek0*(p256(2)*p2(3)-p2(2)*p256(3))+p256
     & k0*(cf56(i1,i2)%e(2)*p2(3)-p2(2)*cf56(i1,i2)%e(3))-p2k0*(
     & cf56(i1,i2)%e(2)*p256(3)-p256(2)*cf56(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf56(i1,i2)%e(3)*p256k0+p256(3)*cf56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf56(i1,i2)%e(3)*p2k0+p2(3)*cf56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf56(i1,i2)%e(0)*p256(0)-cf56(i1,i2)%e(1)*p256(1)-cf5
     & 6(i1,i2)%e(2)*p256(2)-cf56(i1,i2)%e(3)*p256(3)
      cvqd=cf56(i1,i2)%e(0)*p2(0)-cf56(i1,i2)%e(1)*p2(1)-cf56(i1
     & ,i2)%e(2)*p2(2)-cf56(i1,i2)%e(3)*p2(3)
      cauxa=-cf56(i1,i2)%ek0*quqd+p256k0*cvqd+p2k0*cvqu
      cauxb=-cf56(i1,i2)%ek0*p2(2)+p2k0*cf56(i1,i2)%e(2)
      cauxc=+cf56(i1,i2)%ek0*p256(2)-p256k0*cf56(i1,i2)%e(2)
      r2_56(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      r2_56(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      r2_56(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      r2_56(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      r2_56(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      r2_56(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      r2_56(i1,i2)%d(1,1)=ccl*cf56(i1,i2)%ek0
      r2_56(i1,i2)%d(2,2)=ccr*cf56(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                r2_56(i1,i2)%a(iut,jut)=czero
                r2_56(i1,i2)%b(iut,jut)=czero
                r2_56(i1,i2)%c(iut,jut)=czero
                r2_56(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id2).ne.1 .and. ilept(id6).ne.1) then
        do iut=1,2
          do jut=1,2
            rg2_56(iut,jut)%a(1,1) = r2_56(iut,jut)%a(1,1)
     &           /((fcl(id2))*(fcl(id6)))
            rg2_56(iut,jut)%a(2,2) = r2_56(iut,jut)%a(2,2)
     &           /((fcl(id2))*(fcl(id6)))
            rg2_56(iut,jut)%b(1,2) = r2_56(iut,jut)%b(1,2)
     &           /((fcl(id2))*(fcl(id6)))
            rg2_56(iut,jut)%b(2,1) = r2_56(iut,jut)%b(2,1)
     &           /((fcl(id2))*(fcl(id6)))
            rg2_56(iut,jut)%c(1,2) = r2_56(iut,jut)%c(1,2)
     &           /((fcl(id2))*(fcl(id6)))
            rg2_56(iut,jut)%c(2,1) = r2_56(iut,jut)%c(2,1)
     &           /((fcl(id2))*(fcl(id6)))
            rg2_56(iut,jut)%d(1,1) = r2_56(iut,jut)%d(1,1)
     &           /((fcl(id2))*(fcl(id6)))
            rg2_56(iut,jut)%d(2,2) = r2_56(iut,jut)%d(2,2)
     &           /((fcl(id2))*(fcl(id6)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            rg2_56(iut,jut)%a(1,1) = czero
            rg2_56(iut,jut)%a(2,2) = czero
            rg2_56(iut,jut)%b(1,2) = czero
            rg2_56(iut,jut)%b(2,1) = czero
            rg2_56(iut,jut)%c(1,2) = czero
            rg2_56(iut,jut)%c(2,1) = czero
            rg2_56(iut,jut)%d(1,1) = czero
            rg2_56(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p256,q=p2
      quqd=p256(0)*p2(0)-p256(1)*p2(1)-p256(2)*p2(2)-p256(3)*p2(
     & 3)
      ccr=zcr(id2)/((p256q-rmass2(id2))*p256k0)
      ccl=zcl(id2)/((p256q-rmass2(id2))*p256k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p256,qd=p2,v=cz56(i1,i2)%e,a=r2_56(i1,i2)%a,b=r2_56(i1,i2)%b,c
* =r2_56(i1,i2)%c,d=r2_56(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz56(i1,i2)%ek0*(p256(2)*p2(3)-p2(2)*p256(3))+p256
     & k0*(cz56(i1,i2)%e(2)*p2(3)-p2(2)*cz56(i1,i2)%e(3))-p2k0*(
     & cz56(i1,i2)%e(2)*p256(3)-p256(2)*cz56(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz56(i1,i2)%e(3)*p256k0+p256(3)*cz56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz56(i1,i2)%e(3)*p2k0+p2(3)*cz56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz56(i1,i2)%e(0)*p256(0)-cz56(i1,i2)%e(1)*p256(1)-cz5
     & 6(i1,i2)%e(2)*p256(2)-cz56(i1,i2)%e(3)*p256(3)
      cvqd=cz56(i1,i2)%e(0)*p2(0)-cz56(i1,i2)%e(1)*p2(1)-cz56(i1
     & ,i2)%e(2)*p2(2)-cz56(i1,i2)%e(3)*p2(3)
      cauxa=-cz56(i1,i2)%ek0*quqd+p256k0*cvqd+p2k0*cvqu
      cauxb=-cz56(i1,i2)%ek0*p2(2)+p2k0*cz56(i1,i2)%e(2)
      cauxc=+cz56(i1,i2)%ek0*p256(2)-p256k0*cz56(i1,i2)%e(2)
      r2_56(i1,i2)%a(1,1)=r2_56(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      r2_56(i1,i2)%a(2,2)=r2_56(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      r2_56(i1,i2)%b(1,2)=r2_56(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      r2_56(i1,i2)%b(2,1)=r2_56(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      r2_56(i1,i2)%c(1,2)=r2_56(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      r2_56(i1,i2)%c(2,1)=r2_56(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      r2_56(i1,i2)%d(1,1)=r2_56(i1,i2)%d(1,1)+ccl*cz56(i1,i2)%ek
     & 0
      r2_56(i1,i2)%d(2,2)=r2_56(i1,i2)%d(2,2)+ccr*cz56(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id2.eq.-5.and.id6.eq.-5.and.rmh.ge.0.d0) then
  
* TH -- qu=p256,qd=p2,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p256k0*p2(2)+p2k0*p256(2)
      cauxa=auxa-cim*(p2(3)*p256k0-p256(3)*p2k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p2k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p256k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p256q-rmass2(id2))*p256k0)
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r2_56(i1,i2)%a(i3,i4)=ch56(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  r2_56(i1,i2)%b(i3,i4)=ch56(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  r2_56(i1,i2)%c(i3,i4)=ch56(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r2_56(i1,i2)%a(i3,i4)=czero
                else
                  r2_56(i1,i2)%b(i3,i4)=czero
                  r2_56(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
      do m=0,3
        p278(m)=-p2(m)-p78(m)
      enddo
* pk0 -- p=p278
      p278k0=p278(0)-p278(1)
* p.q -- p.q=p278q,p=p278,q=p278,bef=,aft=
      p278q=(p278(0)*p278(0)-p278(1)*p278(1)-p278(2)*p278(2)-p27
     & 8(3)*p278(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id2).ne.1) then
* quqd -- p=p278,q=p2
      quqd=p278(0)*p2(0)-p278(1)*p2(1)-p278(2)*p2(2)-p278(3)*p2(
     & 3)
      ccr=fcr(id2)/((p278q-rmass2(id2))*p278k0)
      ccl=fcl(id2)/((p278q-rmass2(id2))*p278k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p278,qd=p2,v=cf78(i1,i2)%e,a=r2_78(i1,i2)%a,b=r2_78(i1,i2)%b,c
* =r2_78(i1,i2)%c,d=r2_78(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf78(i1,i2)%ek0*(p278(2)*p2(3)-p2(2)*p278(3))+p278
     & k0*(cf78(i1,i2)%e(2)*p2(3)-p2(2)*cf78(i1,i2)%e(3))-p2k0*(
     & cf78(i1,i2)%e(2)*p278(3)-p278(2)*cf78(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf78(i1,i2)%e(3)*p278k0+p278(3)*cf78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf78(i1,i2)%e(3)*p2k0+p2(3)*cf78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf78(i1,i2)%e(0)*p278(0)-cf78(i1,i2)%e(1)*p278(1)-cf7
     & 8(i1,i2)%e(2)*p278(2)-cf78(i1,i2)%e(3)*p278(3)
      cvqd=cf78(i1,i2)%e(0)*p2(0)-cf78(i1,i2)%e(1)*p2(1)-cf78(i1
     & ,i2)%e(2)*p2(2)-cf78(i1,i2)%e(3)*p2(3)
      cauxa=-cf78(i1,i2)%ek0*quqd+p278k0*cvqd+p2k0*cvqu
      cauxb=-cf78(i1,i2)%ek0*p2(2)+p2k0*cf78(i1,i2)%e(2)
      cauxc=+cf78(i1,i2)%ek0*p278(2)-p278k0*cf78(i1,i2)%e(2)
      r2_78(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      r2_78(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      r2_78(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      r2_78(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      r2_78(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      r2_78(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      r2_78(i1,i2)%d(1,1)=ccl*cf78(i1,i2)%ek0
      r2_78(i1,i2)%d(2,2)=ccr*cf78(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                r2_78(i1,i2)%a(iut,jut)=czero
                r2_78(i1,i2)%b(iut,jut)=czero
                r2_78(i1,i2)%c(iut,jut)=czero
                r2_78(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id2).ne.1 .and. ilept(id8).ne.1) then
        do iut=1,2
          do jut=1,2
            rg2_78(iut,jut)%a(1,1) = r2_78(iut,jut)%a(1,1)
     &           /((fcl(id2))*(fcl(id8)))
            rg2_78(iut,jut)%a(2,2) = r2_78(iut,jut)%a(2,2)
     &           /((fcl(id2))*(fcl(id8)))
            rg2_78(iut,jut)%b(1,2) = r2_78(iut,jut)%b(1,2)
     &           /((fcl(id2))*(fcl(id8)))
            rg2_78(iut,jut)%b(2,1) = r2_78(iut,jut)%b(2,1)
     &           /((fcl(id2))*(fcl(id8)))
            rg2_78(iut,jut)%c(1,2) = r2_78(iut,jut)%c(1,2)
     &           /((fcl(id2))*(fcl(id8)))
            rg2_78(iut,jut)%c(2,1) = r2_78(iut,jut)%c(2,1)
     &           /((fcl(id2))*(fcl(id8)))
            rg2_78(iut,jut)%d(1,1) = r2_78(iut,jut)%d(1,1)
     &           /((fcl(id2))*(fcl(id8)))
            rg2_78(iut,jut)%d(2,2) = r2_78(iut,jut)%d(2,2)
     &           /((fcl(id2))*(fcl(id8)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            rg2_78(iut,jut)%a(1,1) = czero
            rg2_78(iut,jut)%a(2,2) = czero
            rg2_78(iut,jut)%b(1,2) = czero
            rg2_78(iut,jut)%b(2,1) = czero
            rg2_78(iut,jut)%c(1,2) = czero
            rg2_78(iut,jut)%c(2,1) = czero
            rg2_78(iut,jut)%d(1,1) = czero
            rg2_78(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p278,q=p2
      quqd=p278(0)*p2(0)-p278(1)*p2(1)-p278(2)*p2(2)-p278(3)*p2(
     & 3)
      ccr=zcr(id2)/((p278q-rmass2(id2))*p278k0)
      ccl=zcl(id2)/((p278q-rmass2(id2))*p278k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p278,qd=p2,v=cz78(i1,i2)%e,a=r2_78(i1,i2)%a,b=r2_78(i1,i2)%b,c
* =r2_78(i1,i2)%c,d=r2_78(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz78(i1,i2)%ek0*(p278(2)*p2(3)-p2(2)*p278(3))+p278
     & k0*(cz78(i1,i2)%e(2)*p2(3)-p2(2)*cz78(i1,i2)%e(3))-p2k0*(
     & cz78(i1,i2)%e(2)*p278(3)-p278(2)*cz78(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz78(i1,i2)%e(3)*p278k0+p278(3)*cz78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz78(i1,i2)%e(3)*p2k0+p2(3)*cz78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz78(i1,i2)%e(0)*p278(0)-cz78(i1,i2)%e(1)*p278(1)-cz7
     & 8(i1,i2)%e(2)*p278(2)-cz78(i1,i2)%e(3)*p278(3)
      cvqd=cz78(i1,i2)%e(0)*p2(0)-cz78(i1,i2)%e(1)*p2(1)-cz78(i1
     & ,i2)%e(2)*p2(2)-cz78(i1,i2)%e(3)*p2(3)
      cauxa=-cz78(i1,i2)%ek0*quqd+p278k0*cvqd+p2k0*cvqu
      cauxb=-cz78(i1,i2)%ek0*p2(2)+p2k0*cz78(i1,i2)%e(2)
      cauxc=+cz78(i1,i2)%ek0*p278(2)-p278k0*cz78(i1,i2)%e(2)
      r2_78(i1,i2)%a(1,1)=r2_78(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      r2_78(i1,i2)%a(2,2)=r2_78(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      r2_78(i1,i2)%b(1,2)=r2_78(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      r2_78(i1,i2)%b(2,1)=r2_78(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      r2_78(i1,i2)%c(1,2)=r2_78(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      r2_78(i1,i2)%c(2,1)=r2_78(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      r2_78(i1,i2)%d(1,1)=r2_78(i1,i2)%d(1,1)+ccl*cz78(i1,i2)%ek
     & 0
      r2_78(i1,i2)%d(2,2)=r2_78(i1,i2)%d(2,2)+ccr*cz78(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id2.eq.-5.and.id8.eq.-5.and.rmh.ge.0.d0) then
  
* TH -- qu=p278,qd=p2,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p278k0*p2(2)+p2k0*p278(2)
      cauxa=auxa-cim*(p2(3)*p278k0-p278(3)*p2k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p2k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p278k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p278q-rmass2(id2))*p278k0)
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r2_78(i1,i2)%a(i3,i4)=ch78(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  r2_78(i1,i2)%b(i3,i4)=ch78(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  r2_78(i1,i2)%c(i3,i4)=ch78(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r2_78(i1,i2)%a(i3,i4)=czero
                else
                  r2_78(i1,i2)%b(i3,i4)=czero
                  r2_78(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
      do m=0,3
        p412(m)=-p4(m)-p12(m)
      enddo
* pk0 -- p=p412
      p412k0=p412(0)-p412(1)
* p.q -- p.q=p412q,p=p412,q=p412,bef=,aft=
      p412q=(p412(0)*p412(0)-p412(1)*p412(1)-p412(2)*p412(2)-p41
     & 2(3)*p412(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id4).ne.1) then
* quqd -- p=p412,q=p4
      quqd=p412(0)*p4(0)-p412(1)*p4(1)-p412(2)*p4(2)-p412(3)*p4(
     & 3)
      ccr=fcr(id4)/((p412q-rmass2(id4))*p412k0)
      ccl=fcl(id4)/((p412q-rmass2(id4))*p412k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p412,qd=p4,v=cf12(i1,i2)%e,a=r4_12(i1,i2)%a,b=r4_12(i1,i2)%b,c
* =r4_12(i1,i2)%c,d=r4_12(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf12(i1,i2)%ek0*(p412(2)*p4(3)-p4(2)*p412(3))+p412
     & k0*(cf12(i1,i2)%e(2)*p4(3)-p4(2)*cf12(i1,i2)%e(3))-p4k0*(
     & cf12(i1,i2)%e(2)*p412(3)-p412(2)*cf12(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf12(i1,i2)%e(3)*p412k0+p412(3)*cf12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf12(i1,i2)%e(3)*p4k0+p4(3)*cf12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf12(i1,i2)%e(0)*p412(0)-cf12(i1,i2)%e(1)*p412(1)-cf1
     & 2(i1,i2)%e(2)*p412(2)-cf12(i1,i2)%e(3)*p412(3)
      cvqd=cf12(i1,i2)%e(0)*p4(0)-cf12(i1,i2)%e(1)*p4(1)-cf12(i1
     & ,i2)%e(2)*p4(2)-cf12(i1,i2)%e(3)*p4(3)
      cauxa=-cf12(i1,i2)%ek0*quqd+p412k0*cvqd+p4k0*cvqu
      cauxb=-cf12(i1,i2)%ek0*p4(2)+p4k0*cf12(i1,i2)%e(2)
      cauxc=+cf12(i1,i2)%ek0*p412(2)-p412k0*cf12(i1,i2)%e(2)
      r4_12(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      r4_12(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      r4_12(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      r4_12(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      r4_12(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      r4_12(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      r4_12(i1,i2)%d(1,1)=ccl*cf12(i1,i2)%ek0
      r4_12(i1,i2)%d(2,2)=ccr*cf12(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                r4_12(i1,i2)%a(iut,jut)=czero
                r4_12(i1,i2)%b(iut,jut)=czero
                r4_12(i1,i2)%c(iut,jut)=czero
                r4_12(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id4).ne.1 .and. ilept(id2).ne.1) then
        do iut=1,2
          do jut=1,2
            rg4_12(iut,jut)%a(1,1) = r4_12(iut,jut)%a(1,1)
     &           /((fcl(id4))*(fcl(id2)))
            rg4_12(iut,jut)%a(2,2) = r4_12(iut,jut)%a(2,2)
     &           /((fcl(id4))*(fcl(id2)))
            rg4_12(iut,jut)%b(1,2) = r4_12(iut,jut)%b(1,2)
     &           /((fcl(id4))*(fcl(id2)))
            rg4_12(iut,jut)%b(2,1) = r4_12(iut,jut)%b(2,1)
     &           /((fcl(id4))*(fcl(id2)))
            rg4_12(iut,jut)%c(1,2) = r4_12(iut,jut)%c(1,2)
     &           /((fcl(id4))*(fcl(id2)))
            rg4_12(iut,jut)%c(2,1) = r4_12(iut,jut)%c(2,1)
     &           /((fcl(id4))*(fcl(id2)))
            rg4_12(iut,jut)%d(1,1) = r4_12(iut,jut)%d(1,1)
     &           /((fcl(id4))*(fcl(id2)))
            rg4_12(iut,jut)%d(2,2) = r4_12(iut,jut)%d(2,2)
     &           /((fcl(id4))*(fcl(id2)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            rg4_12(iut,jut)%a(1,1) = czero
            rg4_12(iut,jut)%a(2,2) = czero
            rg4_12(iut,jut)%b(1,2) = czero
            rg4_12(iut,jut)%b(2,1) = czero
            rg4_12(iut,jut)%c(1,2) = czero
            rg4_12(iut,jut)%c(2,1) = czero
            rg4_12(iut,jut)%d(1,1) = czero
            rg4_12(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p412,q=p4
      quqd=p412(0)*p4(0)-p412(1)*p4(1)-p412(2)*p4(2)-p412(3)*p4(
     & 3)
      ccr=zcr(id4)/((p412q-rmass2(id4))*p412k0)
      ccl=zcl(id4)/((p412q-rmass2(id4))*p412k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p412,qd=p4,v=cz12(i1,i2)%e,a=r4_12(i1,i2)%a,b=r4_12(i1,i2)%b,c
* =r4_12(i1,i2)%c,d=r4_12(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz12(i1,i2)%ek0*(p412(2)*p4(3)-p4(2)*p412(3))+p412
     & k0*(cz12(i1,i2)%e(2)*p4(3)-p4(2)*cz12(i1,i2)%e(3))-p4k0*(
     & cz12(i1,i2)%e(2)*p412(3)-p412(2)*cz12(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz12(i1,i2)%e(3)*p412k0+p412(3)*cz12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz12(i1,i2)%e(3)*p4k0+p4(3)*cz12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz12(i1,i2)%e(0)*p412(0)-cz12(i1,i2)%e(1)*p412(1)-cz1
     & 2(i1,i2)%e(2)*p412(2)-cz12(i1,i2)%e(3)*p412(3)
      cvqd=cz12(i1,i2)%e(0)*p4(0)-cz12(i1,i2)%e(1)*p4(1)-cz12(i1
     & ,i2)%e(2)*p4(2)-cz12(i1,i2)%e(3)*p4(3)
      cauxa=-cz12(i1,i2)%ek0*quqd+p412k0*cvqd+p4k0*cvqu
      cauxb=-cz12(i1,i2)%ek0*p4(2)+p4k0*cz12(i1,i2)%e(2)
      cauxc=+cz12(i1,i2)%ek0*p412(2)-p412k0*cz12(i1,i2)%e(2)
      r4_12(i1,i2)%a(1,1)=r4_12(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      r4_12(i1,i2)%a(2,2)=r4_12(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      r4_12(i1,i2)%b(1,2)=r4_12(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      r4_12(i1,i2)%b(2,1)=r4_12(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      r4_12(i1,i2)%c(1,2)=r4_12(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      r4_12(i1,i2)%c(2,1)=r4_12(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      r4_12(i1,i2)%d(1,1)=r4_12(i1,i2)%d(1,1)+ccl*cz12(i1,i2)%ek
     & 0
      r4_12(i1,i2)%d(2,2)=r4_12(i1,i2)%d(2,2)+ccr*cz12(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id4.eq.-5.and.id2.eq.-5.and.rmh.ge.0.d0) then
  
* TH -- qu=p412,qd=p4,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p412k0*p4(2)+p4k0*p412(2)
      cauxa=auxa-cim*(p4(3)*p412k0-p412(3)*p4k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p4k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p412k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p412q-rmass2(id4))*p412k0)
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r4_12(i1,i2)%a(i3,i4)=ch12(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  r4_12(i1,i2)%b(i3,i4)=ch12(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  r4_12(i1,i2)%c(i3,i4)=ch12(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r4_12(i1,i2)%a(i3,i4)=czero
                else
                  r4_12(i1,i2)%b(i3,i4)=czero
                  r4_12(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
      do m=0,3
        p456(m)=-p4(m)-p56(m)
      enddo
* pk0 -- p=p456
      p456k0=p456(0)-p456(1)
* p.q -- p.q=p456q,p=p456,q=p456,bef=,aft=
      p456q=(p456(0)*p456(0)-p456(1)*p456(1)-p456(2)*p456(2)-p45
     & 6(3)*p456(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id4).ne.1) then
* quqd -- p=p456,q=p4
      quqd=p456(0)*p4(0)-p456(1)*p4(1)-p456(2)*p4(2)-p456(3)*p4(
     & 3)
      ccr=fcr(id4)/((p456q-rmass2(id4))*p456k0)
      ccl=fcl(id4)/((p456q-rmass2(id4))*p456k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p456,qd=p4,v=cf56(i1,i2)%e,a=r4_56(i1,i2)%a,b=r4_56(i1,i2)%b,c
* =r4_56(i1,i2)%c,d=r4_56(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf56(i1,i2)%ek0*(p456(2)*p4(3)-p4(2)*p456(3))+p456
     & k0*(cf56(i1,i2)%e(2)*p4(3)-p4(2)*cf56(i1,i2)%e(3))-p4k0*(
     & cf56(i1,i2)%e(2)*p456(3)-p456(2)*cf56(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf56(i1,i2)%e(3)*p456k0+p456(3)*cf56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf56(i1,i2)%e(3)*p4k0+p4(3)*cf56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf56(i1,i2)%e(0)*p456(0)-cf56(i1,i2)%e(1)*p456(1)-cf5
     & 6(i1,i2)%e(2)*p456(2)-cf56(i1,i2)%e(3)*p456(3)
      cvqd=cf56(i1,i2)%e(0)*p4(0)-cf56(i1,i2)%e(1)*p4(1)-cf56(i1
     & ,i2)%e(2)*p4(2)-cf56(i1,i2)%e(3)*p4(3)
      cauxa=-cf56(i1,i2)%ek0*quqd+p456k0*cvqd+p4k0*cvqu
      cauxb=-cf56(i1,i2)%ek0*p4(2)+p4k0*cf56(i1,i2)%e(2)
      cauxc=+cf56(i1,i2)%ek0*p456(2)-p456k0*cf56(i1,i2)%e(2)
      r4_56(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      r4_56(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      r4_56(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      r4_56(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      r4_56(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      r4_56(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      r4_56(i1,i2)%d(1,1)=ccl*cf56(i1,i2)%ek0
      r4_56(i1,i2)%d(2,2)=ccr*cf56(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                r4_56(i1,i2)%a(iut,jut)=czero
                r4_56(i1,i2)%b(iut,jut)=czero
                r4_56(i1,i2)%c(iut,jut)=czero
                r4_56(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id4).ne.1 .and. ilept(id6).ne.1) then
        do iut=1,2
          do jut=1,2
            rg4_56(iut,jut)%a(1,1) = r4_56(iut,jut)%a(1,1)
     &           /((fcl(id4))*(fcl(id6)))
            rg4_56(iut,jut)%a(2,2) = r4_56(iut,jut)%a(2,2)
     &           /((fcl(id4))*(fcl(id6)))
            rg4_56(iut,jut)%b(1,2) = r4_56(iut,jut)%b(1,2)
     &           /((fcl(id4))*(fcl(id6)))
            rg4_56(iut,jut)%b(2,1) = r4_56(iut,jut)%b(2,1)
     &           /((fcl(id4))*(fcl(id6)))
            rg4_56(iut,jut)%c(1,2) = r4_56(iut,jut)%c(1,2)
     &           /((fcl(id4))*(fcl(id6)))
            rg4_56(iut,jut)%c(2,1) = r4_56(iut,jut)%c(2,1)
     &           /((fcl(id4))*(fcl(id6)))
            rg4_56(iut,jut)%d(1,1) = r4_56(iut,jut)%d(1,1)
     &           /((fcl(id4))*(fcl(id6)))
            rg4_56(iut,jut)%d(2,2) = r4_56(iut,jut)%d(2,2)
     &           /((fcl(id4))*(fcl(id6)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            rg4_56(iut,jut)%a(1,1) = czero
            rg4_56(iut,jut)%a(2,2) = czero
            rg4_56(iut,jut)%b(1,2) = czero
            rg4_56(iut,jut)%b(2,1) = czero
            rg4_56(iut,jut)%c(1,2) = czero
            rg4_56(iut,jut)%c(2,1) = czero
            rg4_56(iut,jut)%d(1,1) = czero
            rg4_56(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p456,q=p4
      quqd=p456(0)*p4(0)-p456(1)*p4(1)-p456(2)*p4(2)-p456(3)*p4(
     & 3)
      ccr=zcr(id4)/((p456q-rmass2(id4))*p456k0)
      ccl=zcl(id4)/((p456q-rmass2(id4))*p456k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p456,qd=p4,v=cz56(i1,i2)%e,a=r4_56(i1,i2)%a,b=r4_56(i1,i2)%b,c
* =r4_56(i1,i2)%c,d=r4_56(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz56(i1,i2)%ek0*(p456(2)*p4(3)-p4(2)*p456(3))+p456
     & k0*(cz56(i1,i2)%e(2)*p4(3)-p4(2)*cz56(i1,i2)%e(3))-p4k0*(
     & cz56(i1,i2)%e(2)*p456(3)-p456(2)*cz56(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz56(i1,i2)%e(3)*p456k0+p456(3)*cz56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz56(i1,i2)%e(3)*p4k0+p4(3)*cz56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz56(i1,i2)%e(0)*p456(0)-cz56(i1,i2)%e(1)*p456(1)-cz5
     & 6(i1,i2)%e(2)*p456(2)-cz56(i1,i2)%e(3)*p456(3)
      cvqd=cz56(i1,i2)%e(0)*p4(0)-cz56(i1,i2)%e(1)*p4(1)-cz56(i1
     & ,i2)%e(2)*p4(2)-cz56(i1,i2)%e(3)*p4(3)
      cauxa=-cz56(i1,i2)%ek0*quqd+p456k0*cvqd+p4k0*cvqu
      cauxb=-cz56(i1,i2)%ek0*p4(2)+p4k0*cz56(i1,i2)%e(2)
      cauxc=+cz56(i1,i2)%ek0*p456(2)-p456k0*cz56(i1,i2)%e(2)
      r4_56(i1,i2)%a(1,1)=r4_56(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      r4_56(i1,i2)%a(2,2)=r4_56(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      r4_56(i1,i2)%b(1,2)=r4_56(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      r4_56(i1,i2)%b(2,1)=r4_56(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      r4_56(i1,i2)%c(1,2)=r4_56(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      r4_56(i1,i2)%c(2,1)=r4_56(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      r4_56(i1,i2)%d(1,1)=r4_56(i1,i2)%d(1,1)+ccl*cz56(i1,i2)%ek
     & 0
      r4_56(i1,i2)%d(2,2)=r4_56(i1,i2)%d(2,2)+ccr*cz56(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id4.eq.-5.and.id6.eq.-5.and.rmh.ge.0.d0) then
  
* TH -- qu=p456,qd=p4,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p456k0*p4(2)+p4k0*p456(2)
      cauxa=auxa-cim*(p4(3)*p456k0-p456(3)*p4k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p4k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p456k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p456q-rmass2(id4))*p456k0)
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r4_56(i1,i2)%a(i3,i4)=ch56(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  r4_56(i1,i2)%b(i3,i4)=ch56(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  r4_56(i1,i2)%c(i3,i4)=ch56(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r4_56(i1,i2)%a(i3,i4)=czero
                else
                  r4_56(i1,i2)%b(i3,i4)=czero
                  r4_56(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
      do m=0,3
        p478(m)=-p4(m)-p78(m)
      enddo
* pk0 -- p=p478
      p478k0=p478(0)-p478(1)
* p.q -- p.q=p478q,p=p478,q=p478,bef=,aft=
      p478q=(p478(0)*p478(0)-p478(1)*p478(1)-p478(2)*p478(2)-p47
     & 8(3)*p478(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id4).ne.1) then
* quqd -- p=p478,q=p4
      quqd=p478(0)*p4(0)-p478(1)*p4(1)-p478(2)*p4(2)-p478(3)*p4(
     & 3)
      ccr=fcr(id4)/((p478q-rmass2(id4))*p478k0)
      ccl=fcl(id4)/((p478q-rmass2(id4))*p478k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p478,qd=p4,v=cf78(i1,i2)%e,a=r4_78(i1,i2)%a,b=r4_78(i1,i2)%b,c
* =r4_78(i1,i2)%c,d=r4_78(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf78(i1,i2)%ek0*(p478(2)*p4(3)-p4(2)*p478(3))+p478
     & k0*(cf78(i1,i2)%e(2)*p4(3)-p4(2)*cf78(i1,i2)%e(3))-p4k0*(
     & cf78(i1,i2)%e(2)*p478(3)-p478(2)*cf78(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf78(i1,i2)%e(3)*p478k0+p478(3)*cf78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf78(i1,i2)%e(3)*p4k0+p4(3)*cf78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf78(i1,i2)%e(0)*p478(0)-cf78(i1,i2)%e(1)*p478(1)-cf7
     & 8(i1,i2)%e(2)*p478(2)-cf78(i1,i2)%e(3)*p478(3)
      cvqd=cf78(i1,i2)%e(0)*p4(0)-cf78(i1,i2)%e(1)*p4(1)-cf78(i1
     & ,i2)%e(2)*p4(2)-cf78(i1,i2)%e(3)*p4(3)
      cauxa=-cf78(i1,i2)%ek0*quqd+p478k0*cvqd+p4k0*cvqu
      cauxb=-cf78(i1,i2)%ek0*p4(2)+p4k0*cf78(i1,i2)%e(2)
      cauxc=+cf78(i1,i2)%ek0*p478(2)-p478k0*cf78(i1,i2)%e(2)
      r4_78(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      r4_78(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      r4_78(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      r4_78(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      r4_78(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      r4_78(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      r4_78(i1,i2)%d(1,1)=ccl*cf78(i1,i2)%ek0
      r4_78(i1,i2)%d(2,2)=ccr*cf78(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                r4_78(i1,i2)%a(iut,jut)=czero
                r4_78(i1,i2)%b(iut,jut)=czero
                r4_78(i1,i2)%c(iut,jut)=czero
                r4_78(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id4).ne.1 .and. ilept(id8).ne.1) then
        do iut=1,2
          do jut=1,2
            rg4_78(iut,jut)%a(1,1) = r4_78(iut,jut)%a(1,1)
     &           /((fcl(id4))*(fcl(id8)))
            rg4_78(iut,jut)%a(2,2) = r4_78(iut,jut)%a(2,2)
     &           /((fcl(id4))*(fcl(id8)))
            rg4_78(iut,jut)%b(1,2) = r4_78(iut,jut)%b(1,2)
     &           /((fcl(id4))*(fcl(id8)))
            rg4_78(iut,jut)%b(2,1) = r4_78(iut,jut)%b(2,1)
     &           /((fcl(id4))*(fcl(id8)))
            rg4_78(iut,jut)%c(1,2) = r4_78(iut,jut)%c(1,2)
     &           /((fcl(id4))*(fcl(id8)))
            rg4_78(iut,jut)%c(2,1) = r4_78(iut,jut)%c(2,1)
     &           /((fcl(id4))*(fcl(id8)))
            rg4_78(iut,jut)%d(1,1) = r4_78(iut,jut)%d(1,1)
     &           /((fcl(id4))*(fcl(id8)))
            rg4_78(iut,jut)%d(2,2) = r4_78(iut,jut)%d(2,2)
     &           /((fcl(id4))*(fcl(id8)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            rg4_78(iut,jut)%a(1,1) = czero
            rg4_78(iut,jut)%a(2,2) = czero
            rg4_78(iut,jut)%b(1,2) = czero
            rg4_78(iut,jut)%b(2,1) = czero
            rg4_78(iut,jut)%c(1,2) = czero
            rg4_78(iut,jut)%c(2,1) = czero
            rg4_78(iut,jut)%d(1,1) = czero
            rg4_78(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p478,q=p4
      quqd=p478(0)*p4(0)-p478(1)*p4(1)-p478(2)*p4(2)-p478(3)*p4(
     & 3)
      ccr=zcr(id4)/((p478q-rmass2(id4))*p478k0)
      ccl=zcl(id4)/((p478q-rmass2(id4))*p478k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p478,qd=p4,v=cz78(i1,i2)%e,a=r4_78(i1,i2)%a,b=r4_78(i1,i2)%b,c
* =r4_78(i1,i2)%c,d=r4_78(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz78(i1,i2)%ek0*(p478(2)*p4(3)-p4(2)*p478(3))+p478
     & k0*(cz78(i1,i2)%e(2)*p4(3)-p4(2)*cz78(i1,i2)%e(3))-p4k0*(
     & cz78(i1,i2)%e(2)*p478(3)-p478(2)*cz78(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz78(i1,i2)%e(3)*p478k0+p478(3)*cz78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz78(i1,i2)%e(3)*p4k0+p4(3)*cz78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz78(i1,i2)%e(0)*p478(0)-cz78(i1,i2)%e(1)*p478(1)-cz7
     & 8(i1,i2)%e(2)*p478(2)-cz78(i1,i2)%e(3)*p478(3)
      cvqd=cz78(i1,i2)%e(0)*p4(0)-cz78(i1,i2)%e(1)*p4(1)-cz78(i1
     & ,i2)%e(2)*p4(2)-cz78(i1,i2)%e(3)*p4(3)
      cauxa=-cz78(i1,i2)%ek0*quqd+p478k0*cvqd+p4k0*cvqu
      cauxb=-cz78(i1,i2)%ek0*p4(2)+p4k0*cz78(i1,i2)%e(2)
      cauxc=+cz78(i1,i2)%ek0*p478(2)-p478k0*cz78(i1,i2)%e(2)
      r4_78(i1,i2)%a(1,1)=r4_78(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      r4_78(i1,i2)%a(2,2)=r4_78(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      r4_78(i1,i2)%b(1,2)=r4_78(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      r4_78(i1,i2)%b(2,1)=r4_78(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      r4_78(i1,i2)%c(1,2)=r4_78(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      r4_78(i1,i2)%c(2,1)=r4_78(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      r4_78(i1,i2)%d(1,1)=r4_78(i1,i2)%d(1,1)+ccl*cz78(i1,i2)%ek
     & 0
      r4_78(i1,i2)%d(2,2)=r4_78(i1,i2)%d(2,2)+ccr*cz78(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id4.eq.-5.and.id8.eq.-5.and.rmh.ge.0.d0) then
  
* TH -- qu=p478,qd=p4,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p478k0*p4(2)+p4k0*p478(2)
      cauxa=auxa-cim*(p4(3)*p478k0-p478(3)*p4k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p4k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p478k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p478q-rmass2(id4))*p478k0)
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r4_78(i1,i2)%a(i3,i4)=ch78(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  r4_78(i1,i2)%b(i3,i4)=ch78(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  r4_78(i1,i2)%c(i3,i4)=ch78(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r4_78(i1,i2)%a(i3,i4)=czero
                else
                  r4_78(i1,i2)%b(i3,i4)=czero
                  r4_78(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
      do m=0,3
        p612(m)=-p6(m)-p12(m)
      enddo
* pk0 -- p=p612
      p612k0=p612(0)-p612(1)
* p.q -- p.q=p612q,p=p612,q=p612,bef=,aft=
      p612q=(p612(0)*p612(0)-p612(1)*p612(1)-p612(2)*p612(2)-p61
     & 2(3)*p612(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id6).ne.1) then
* quqd -- p=p612,q=p6
      quqd=p612(0)*p6(0)-p612(1)*p6(1)-p612(2)*p6(2)-p612(3)*p6(
     & 3)
      ccr=fcr(id6)/((p612q-rmass2(id6))*p612k0)
      ccl=fcl(id6)/((p612q-rmass2(id6))*p612k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p612,qd=p6,v=cf12(i1,i2)%e,a=r6_12(i1,i2)%a,b=r6_12(i1,i2)%b,c
* =r6_12(i1,i2)%c,d=r6_12(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf12(i1,i2)%ek0*(p612(2)*p6(3)-p6(2)*p612(3))+p612
     & k0*(cf12(i1,i2)%e(2)*p6(3)-p6(2)*cf12(i1,i2)%e(3))-p6k0*(
     & cf12(i1,i2)%e(2)*p612(3)-p612(2)*cf12(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf12(i1,i2)%e(3)*p612k0+p612(3)*cf12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf12(i1,i2)%e(3)*p6k0+p6(3)*cf12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf12(i1,i2)%e(0)*p612(0)-cf12(i1,i2)%e(1)*p612(1)-cf1
     & 2(i1,i2)%e(2)*p612(2)-cf12(i1,i2)%e(3)*p612(3)
      cvqd=cf12(i1,i2)%e(0)*p6(0)-cf12(i1,i2)%e(1)*p6(1)-cf12(i1
     & ,i2)%e(2)*p6(2)-cf12(i1,i2)%e(3)*p6(3)
      cauxa=-cf12(i1,i2)%ek0*quqd+p612k0*cvqd+p6k0*cvqu
      cauxb=-cf12(i1,i2)%ek0*p6(2)+p6k0*cf12(i1,i2)%e(2)
      cauxc=+cf12(i1,i2)%ek0*p612(2)-p612k0*cf12(i1,i2)%e(2)
      r6_12(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      r6_12(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      r6_12(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      r6_12(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      r6_12(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      r6_12(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      r6_12(i1,i2)%d(1,1)=ccl*cf12(i1,i2)%ek0
      r6_12(i1,i2)%d(2,2)=ccr*cf12(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                r6_12(i1,i2)%a(iut,jut)=czero
                r6_12(i1,i2)%b(iut,jut)=czero
                r6_12(i1,i2)%c(iut,jut)=czero
                r6_12(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id6).ne.1 .and. ilept(id2).ne.1) then
        do iut=1,2
          do jut=1,2
            rg6_12(iut,jut)%a(1,1) = r6_12(iut,jut)%a(1,1)
     &           /((fcl(id6))*(fcl(id2)))
            rg6_12(iut,jut)%a(2,2) = r6_12(iut,jut)%a(2,2)
     &           /((fcl(id6))*(fcl(id2)))
            rg6_12(iut,jut)%b(1,2) = r6_12(iut,jut)%b(1,2)
     &           /((fcl(id6))*(fcl(id2)))
            rg6_12(iut,jut)%b(2,1) = r6_12(iut,jut)%b(2,1)
     &           /((fcl(id6))*(fcl(id2)))
            rg6_12(iut,jut)%c(1,2) = r6_12(iut,jut)%c(1,2)
     &           /((fcl(id6))*(fcl(id2)))
            rg6_12(iut,jut)%c(2,1) = r6_12(iut,jut)%c(2,1)
     &           /((fcl(id6))*(fcl(id2)))
            rg6_12(iut,jut)%d(1,1) = r6_12(iut,jut)%d(1,1)
     &           /((fcl(id6))*(fcl(id2)))
            rg6_12(iut,jut)%d(2,2) = r6_12(iut,jut)%d(2,2)
     &           /((fcl(id6))*(fcl(id2)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            rg6_12(iut,jut)%a(1,1) = czero
            rg6_12(iut,jut)%a(2,2) = czero
            rg6_12(iut,jut)%b(1,2) = czero
            rg6_12(iut,jut)%b(2,1) = czero
            rg6_12(iut,jut)%c(1,2) = czero
            rg6_12(iut,jut)%c(2,1) = czero
            rg6_12(iut,jut)%d(1,1) = czero
            rg6_12(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p612,q=p6
      quqd=p612(0)*p6(0)-p612(1)*p6(1)-p612(2)*p6(2)-p612(3)*p6(
     & 3)
      ccr=zcr(id6)/((p612q-rmass2(id6))*p612k0)
      ccl=zcl(id6)/((p612q-rmass2(id6))*p612k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p612,qd=p6,v=cz12(i1,i2)%e,a=r6_12(i1,i2)%a,b=r6_12(i1,i2)%b,c
* =r6_12(i1,i2)%c,d=r6_12(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz12(i1,i2)%ek0*(p612(2)*p6(3)-p6(2)*p612(3))+p612
     & k0*(cz12(i1,i2)%e(2)*p6(3)-p6(2)*cz12(i1,i2)%e(3))-p6k0*(
     & cz12(i1,i2)%e(2)*p612(3)-p612(2)*cz12(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz12(i1,i2)%e(3)*p612k0+p612(3)*cz12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz12(i1,i2)%e(3)*p6k0+p6(3)*cz12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz12(i1,i2)%e(0)*p612(0)-cz12(i1,i2)%e(1)*p612(1)-cz1
     & 2(i1,i2)%e(2)*p612(2)-cz12(i1,i2)%e(3)*p612(3)
      cvqd=cz12(i1,i2)%e(0)*p6(0)-cz12(i1,i2)%e(1)*p6(1)-cz12(i1
     & ,i2)%e(2)*p6(2)-cz12(i1,i2)%e(3)*p6(3)
      cauxa=-cz12(i1,i2)%ek0*quqd+p612k0*cvqd+p6k0*cvqu
      cauxb=-cz12(i1,i2)%ek0*p6(2)+p6k0*cz12(i1,i2)%e(2)
      cauxc=+cz12(i1,i2)%ek0*p612(2)-p612k0*cz12(i1,i2)%e(2)
      r6_12(i1,i2)%a(1,1)=r6_12(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      r6_12(i1,i2)%a(2,2)=r6_12(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      r6_12(i1,i2)%b(1,2)=r6_12(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      r6_12(i1,i2)%b(2,1)=r6_12(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      r6_12(i1,i2)%c(1,2)=r6_12(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      r6_12(i1,i2)%c(2,1)=r6_12(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      r6_12(i1,i2)%d(1,1)=r6_12(i1,i2)%d(1,1)+ccl*cz12(i1,i2)%ek
     & 0
      r6_12(i1,i2)%d(2,2)=r6_12(i1,i2)%d(2,2)+ccr*cz12(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id6.eq.-5.and.id2.eq.-5.and.rmh.ge.0.d0) then
  
* TH -- qu=p612,qd=p6,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p612k0*p6(2)+p6k0*p612(2)
      cauxa=auxa-cim*(p6(3)*p612k0-p612(3)*p6k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p6k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p612k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p612q-rmass2(id6))*p612k0)
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r6_12(i1,i2)%a(i3,i4)=ch12(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  r6_12(i1,i2)%b(i3,i4)=ch12(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  r6_12(i1,i2)%c(i3,i4)=ch12(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r6_12(i1,i2)%a(i3,i4)=czero
                else
                  r6_12(i1,i2)%b(i3,i4)=czero
                  r6_12(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
      do m=0,3
        p634(m)=-p6(m)-p34(m)
      enddo
* pk0 -- p=p634
      p634k0=p634(0)-p634(1)
* p.q -- p.q=p634q,p=p634,q=p634,bef=,aft=
      p634q=(p634(0)*p634(0)-p634(1)*p634(1)-p634(2)*p634(2)-p63
     & 4(3)*p634(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id6).ne.1) then
* quqd -- p=p634,q=p6
      quqd=p634(0)*p6(0)-p634(1)*p6(1)-p634(2)*p6(2)-p634(3)*p6(
     & 3)
      ccr=fcr(id6)/((p634q-rmass2(id6))*p634k0)
      ccl=fcl(id6)/((p634q-rmass2(id6))*p634k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p634,qd=p6,v=cf34(i1,i2)%e,a=r6_34(i1,i2)%a,b=r6_34(i1,i2)%b,c
* =r6_34(i1,i2)%c,d=r6_34(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf34(i1,i2)%ek0*(p634(2)*p6(3)-p6(2)*p634(3))+p634
     & k0*(cf34(i1,i2)%e(2)*p6(3)-p6(2)*cf34(i1,i2)%e(3))-p6k0*(
     & cf34(i1,i2)%e(2)*p634(3)-p634(2)*cf34(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf34(i1,i2)%e(3)*p634k0+p634(3)*cf34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf34(i1,i2)%e(3)*p6k0+p6(3)*cf34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf34(i1,i2)%e(0)*p634(0)-cf34(i1,i2)%e(1)*p634(1)-cf3
     & 4(i1,i2)%e(2)*p634(2)-cf34(i1,i2)%e(3)*p634(3)
      cvqd=cf34(i1,i2)%e(0)*p6(0)-cf34(i1,i2)%e(1)*p6(1)-cf34(i1
     & ,i2)%e(2)*p6(2)-cf34(i1,i2)%e(3)*p6(3)
      cauxa=-cf34(i1,i2)%ek0*quqd+p634k0*cvqd+p6k0*cvqu
      cauxb=-cf34(i1,i2)%ek0*p6(2)+p6k0*cf34(i1,i2)%e(2)
      cauxc=+cf34(i1,i2)%ek0*p634(2)-p634k0*cf34(i1,i2)%e(2)
      r6_34(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      r6_34(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      r6_34(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      r6_34(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      r6_34(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      r6_34(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      r6_34(i1,i2)%d(1,1)=ccl*cf34(i1,i2)%ek0
      r6_34(i1,i2)%d(2,2)=ccr*cf34(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                r6_34(i1,i2)%a(iut,jut)=czero
                r6_34(i1,i2)%b(iut,jut)=czero
                r6_34(i1,i2)%c(iut,jut)=czero
                r6_34(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id6).ne.1 .and. ilept(id4).ne.1) then
        do iut=1,2
          do jut=1,2
            rg6_34(iut,jut)%a(1,1) = r6_34(iut,jut)%a(1,1)
     &           /((fcl(id6))*(fcl(id4)))
            rg6_34(iut,jut)%a(2,2) = r6_34(iut,jut)%a(2,2)
     &           /((fcl(id6))*(fcl(id4)))
            rg6_34(iut,jut)%b(1,2) = r6_34(iut,jut)%b(1,2)
     &           /((fcl(id6))*(fcl(id4)))
            rg6_34(iut,jut)%b(2,1) = r6_34(iut,jut)%b(2,1)
     &           /((fcl(id6))*(fcl(id4)))
            rg6_34(iut,jut)%c(1,2) = r6_34(iut,jut)%c(1,2)
     &           /((fcl(id6))*(fcl(id4)))
            rg6_34(iut,jut)%c(2,1) = r6_34(iut,jut)%c(2,1)
     &           /((fcl(id6))*(fcl(id4)))
            rg6_34(iut,jut)%d(1,1) = r6_34(iut,jut)%d(1,1)
     &           /((fcl(id6))*(fcl(id4)))
            rg6_34(iut,jut)%d(2,2) = r6_34(iut,jut)%d(2,2)
     &           /((fcl(id6))*(fcl(id4)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            rg6_34(iut,jut)%a(1,1) = czero
            rg6_34(iut,jut)%a(2,2) = czero
            rg6_34(iut,jut)%b(1,2) = czero
            rg6_34(iut,jut)%b(2,1) = czero
            rg6_34(iut,jut)%c(1,2) = czero
            rg6_34(iut,jut)%c(2,1) = czero
            rg6_34(iut,jut)%d(1,1) = czero
            rg6_34(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p634,q=p6
      quqd=p634(0)*p6(0)-p634(1)*p6(1)-p634(2)*p6(2)-p634(3)*p6(
     & 3)
      ccr=zcr(id6)/((p634q-rmass2(id6))*p634k0)
      ccl=zcl(id6)/((p634q-rmass2(id6))*p634k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p634,qd=p6,v=cz34(i1,i2)%e,a=r6_34(i1,i2)%a,b=r6_34(i1,i2)%b,c
* =r6_34(i1,i2)%c,d=r6_34(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz34(i1,i2)%ek0*(p634(2)*p6(3)-p6(2)*p634(3))+p634
     & k0*(cz34(i1,i2)%e(2)*p6(3)-p6(2)*cz34(i1,i2)%e(3))-p6k0*(
     & cz34(i1,i2)%e(2)*p634(3)-p634(2)*cz34(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz34(i1,i2)%e(3)*p634k0+p634(3)*cz34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz34(i1,i2)%e(3)*p6k0+p6(3)*cz34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz34(i1,i2)%e(0)*p634(0)-cz34(i1,i2)%e(1)*p634(1)-cz3
     & 4(i1,i2)%e(2)*p634(2)-cz34(i1,i2)%e(3)*p634(3)
      cvqd=cz34(i1,i2)%e(0)*p6(0)-cz34(i1,i2)%e(1)*p6(1)-cz34(i1
     & ,i2)%e(2)*p6(2)-cz34(i1,i2)%e(3)*p6(3)
      cauxa=-cz34(i1,i2)%ek0*quqd+p634k0*cvqd+p6k0*cvqu
      cauxb=-cz34(i1,i2)%ek0*p6(2)+p6k0*cz34(i1,i2)%e(2)
      cauxc=+cz34(i1,i2)%ek0*p634(2)-p634k0*cz34(i1,i2)%e(2)
      r6_34(i1,i2)%a(1,1)=r6_34(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      r6_34(i1,i2)%a(2,2)=r6_34(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      r6_34(i1,i2)%b(1,2)=r6_34(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      r6_34(i1,i2)%b(2,1)=r6_34(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      r6_34(i1,i2)%c(1,2)=r6_34(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      r6_34(i1,i2)%c(2,1)=r6_34(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      r6_34(i1,i2)%d(1,1)=r6_34(i1,i2)%d(1,1)+ccl*cz34(i1,i2)%ek
     & 0
      r6_34(i1,i2)%d(2,2)=r6_34(i1,i2)%d(2,2)+ccr*cz34(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id6.eq.-5.and.id4.eq.-5.and.rmh.ge.0.d0) then
  
* TH -- qu=p634,qd=p6,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p634k0*p6(2)+p6k0*p634(2)
      cauxa=auxa-cim*(p6(3)*p634k0-p634(3)*p6k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p6k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p634k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p634q-rmass2(id6))*p634k0)
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r6_34(i1,i2)%a(i3,i4)=ch34(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  r6_34(i1,i2)%b(i3,i4)=ch34(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  r6_34(i1,i2)%c(i3,i4)=ch34(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r6_34(i1,i2)%a(i3,i4)=czero
                else
                  r6_34(i1,i2)%b(i3,i4)=czero
                  r6_34(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
      do m=0,3
        p678(m)=-p6(m)-p78(m)
      enddo
* pk0 -- p=p678
      p678k0=p678(0)-p678(1)
* p.q -- p.q=p678q,p=p678,q=p678,bef=,aft=
      p678q=(p678(0)*p678(0)-p678(1)*p678(1)-p678(2)*p678(2)-p67
     & 8(3)*p678(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id6).ne.1) then
* quqd -- p=p678,q=p6
      quqd=p678(0)*p6(0)-p678(1)*p6(1)-p678(2)*p6(2)-p678(3)*p6(
     & 3)
      ccr=fcr(id6)/((p678q-rmass2(id6))*p678k0)
      ccl=fcl(id6)/((p678q-rmass2(id6))*p678k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p678,qd=p6,v=cf78(i1,i2)%e,a=r6_78(i1,i2)%a,b=r6_78(i1,i2)%b,c
* =r6_78(i1,i2)%c,d=r6_78(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf78(i1,i2)%ek0*(p678(2)*p6(3)-p6(2)*p678(3))+p678
     & k0*(cf78(i1,i2)%e(2)*p6(3)-p6(2)*cf78(i1,i2)%e(3))-p6k0*(
     & cf78(i1,i2)%e(2)*p678(3)-p678(2)*cf78(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf78(i1,i2)%e(3)*p678k0+p678(3)*cf78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf78(i1,i2)%e(3)*p6k0+p6(3)*cf78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf78(i1,i2)%e(0)*p678(0)-cf78(i1,i2)%e(1)*p678(1)-cf7
     & 8(i1,i2)%e(2)*p678(2)-cf78(i1,i2)%e(3)*p678(3)
      cvqd=cf78(i1,i2)%e(0)*p6(0)-cf78(i1,i2)%e(1)*p6(1)-cf78(i1
     & ,i2)%e(2)*p6(2)-cf78(i1,i2)%e(3)*p6(3)
      cauxa=-cf78(i1,i2)%ek0*quqd+p678k0*cvqd+p6k0*cvqu
      cauxb=-cf78(i1,i2)%ek0*p6(2)+p6k0*cf78(i1,i2)%e(2)
      cauxc=+cf78(i1,i2)%ek0*p678(2)-p678k0*cf78(i1,i2)%e(2)
      r6_78(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      r6_78(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      r6_78(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      r6_78(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      r6_78(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      r6_78(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      r6_78(i1,i2)%d(1,1)=ccl*cf78(i1,i2)%ek0
      r6_78(i1,i2)%d(2,2)=ccr*cf78(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                r6_78(i1,i2)%a(iut,jut)=czero
                r6_78(i1,i2)%b(iut,jut)=czero
                r6_78(i1,i2)%c(iut,jut)=czero
                r6_78(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id6).ne.1 .and. ilept(id8).ne.1) then
        do iut=1,2
          do jut=1,2
            rg6_78(iut,jut)%a(1,1) = r6_78(iut,jut)%a(1,1)
     &           /((fcl(id6))*(fcl(id8)))
            rg6_78(iut,jut)%a(2,2) = r6_78(iut,jut)%a(2,2)
     &           /((fcl(id6))*(fcl(id8)))
            rg6_78(iut,jut)%b(1,2) = r6_78(iut,jut)%b(1,2)
     &           /((fcl(id6))*(fcl(id8)))
            rg6_78(iut,jut)%b(2,1) = r6_78(iut,jut)%b(2,1)
     &           /((fcl(id6))*(fcl(id8)))
            rg6_78(iut,jut)%c(1,2) = r6_78(iut,jut)%c(1,2)
     &           /((fcl(id6))*(fcl(id8)))
            rg6_78(iut,jut)%c(2,1) = r6_78(iut,jut)%c(2,1)
     &           /((fcl(id6))*(fcl(id8)))
            rg6_78(iut,jut)%d(1,1) = r6_78(iut,jut)%d(1,1)
     &           /((fcl(id6))*(fcl(id8)))
            rg6_78(iut,jut)%d(2,2) = r6_78(iut,jut)%d(2,2)
     &           /((fcl(id6))*(fcl(id8)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            rg6_78(iut,jut)%a(1,1) = czero
            rg6_78(iut,jut)%a(2,2) = czero
            rg6_78(iut,jut)%b(1,2) = czero
            rg6_78(iut,jut)%b(2,1) = czero
            rg6_78(iut,jut)%c(1,2) = czero
            rg6_78(iut,jut)%c(2,1) = czero
            rg6_78(iut,jut)%d(1,1) = czero
            rg6_78(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p678,q=p6
      quqd=p678(0)*p6(0)-p678(1)*p6(1)-p678(2)*p6(2)-p678(3)*p6(
     & 3)
      ccr=zcr(id6)/((p678q-rmass2(id6))*p678k0)
      ccl=zcl(id6)/((p678q-rmass2(id6))*p678k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p678,qd=p6,v=cz78(i1,i2)%e,a=r6_78(i1,i2)%a,b=r6_78(i1,i2)%b,c
* =r6_78(i1,i2)%c,d=r6_78(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz78(i1,i2)%ek0*(p678(2)*p6(3)-p6(2)*p678(3))+p678
     & k0*(cz78(i1,i2)%e(2)*p6(3)-p6(2)*cz78(i1,i2)%e(3))-p6k0*(
     & cz78(i1,i2)%e(2)*p678(3)-p678(2)*cz78(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz78(i1,i2)%e(3)*p678k0+p678(3)*cz78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz78(i1,i2)%e(3)*p6k0+p6(3)*cz78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz78(i1,i2)%e(0)*p678(0)-cz78(i1,i2)%e(1)*p678(1)-cz7
     & 8(i1,i2)%e(2)*p678(2)-cz78(i1,i2)%e(3)*p678(3)
      cvqd=cz78(i1,i2)%e(0)*p6(0)-cz78(i1,i2)%e(1)*p6(1)-cz78(i1
     & ,i2)%e(2)*p6(2)-cz78(i1,i2)%e(3)*p6(3)
      cauxa=-cz78(i1,i2)%ek0*quqd+p678k0*cvqd+p6k0*cvqu
      cauxb=-cz78(i1,i2)%ek0*p6(2)+p6k0*cz78(i1,i2)%e(2)
      cauxc=+cz78(i1,i2)%ek0*p678(2)-p678k0*cz78(i1,i2)%e(2)
      r6_78(i1,i2)%a(1,1)=r6_78(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      r6_78(i1,i2)%a(2,2)=r6_78(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      r6_78(i1,i2)%b(1,2)=r6_78(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      r6_78(i1,i2)%b(2,1)=r6_78(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      r6_78(i1,i2)%c(1,2)=r6_78(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      r6_78(i1,i2)%c(2,1)=r6_78(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      r6_78(i1,i2)%d(1,1)=r6_78(i1,i2)%d(1,1)+ccl*cz78(i1,i2)%ek
     & 0
      r6_78(i1,i2)%d(2,2)=r6_78(i1,i2)%d(2,2)+ccr*cz78(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id6.eq.-5.and.id8.eq.-5.and.rmh.ge.0.d0) then
  
* TH -- qu=p678,qd=p6,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p678k0*p6(2)+p6k0*p678(2)
      cauxa=auxa-cim*(p6(3)*p678k0-p678(3)*p6k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p6k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p678k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p678q-rmass2(id6))*p678k0)
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r6_78(i1,i2)%a(i3,i4)=ch78(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  r6_78(i1,i2)%b(i3,i4)=ch78(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  r6_78(i1,i2)%c(i3,i4)=ch78(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r6_78(i1,i2)%a(i3,i4)=czero
                else
                  r6_78(i1,i2)%b(i3,i4)=czero
                  r6_78(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
      do m=0,3
        p812(m)=-p8(m)-p12(m)
      enddo
* pk0 -- p=p812
      p812k0=p812(0)-p812(1)
* p.q -- p.q=p812q,p=p812,q=p812,bef=,aft=
      p812q=(p812(0)*p812(0)-p812(1)*p812(1)-p812(2)*p812(2)-p81
     & 2(3)*p812(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id8).ne.1) then
* quqd -- p=p812,q=p8
      quqd=p812(0)*p8(0)-p812(1)*p8(1)-p812(2)*p8(2)-p812(3)*p8(
     & 3)
      ccr=fcr(id8)/((p812q-rmass2(id8))*p812k0)
      ccl=fcl(id8)/((p812q-rmass2(id8))*p812k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p812,qd=p8,v=cf12(i1,i2)%e,a=r8_12(i1,i2)%a,b=r8_12(i1,i2)%b,c
* =r8_12(i1,i2)%c,d=r8_12(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf12(i1,i2)%ek0*(p812(2)*p8(3)-p8(2)*p812(3))+p812
     & k0*(cf12(i1,i2)%e(2)*p8(3)-p8(2)*cf12(i1,i2)%e(3))-p8k0*(
     & cf12(i1,i2)%e(2)*p812(3)-p812(2)*cf12(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf12(i1,i2)%e(3)*p812k0+p812(3)*cf12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf12(i1,i2)%e(3)*p8k0+p8(3)*cf12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf12(i1,i2)%e(0)*p812(0)-cf12(i1,i2)%e(1)*p812(1)-cf1
     & 2(i1,i2)%e(2)*p812(2)-cf12(i1,i2)%e(3)*p812(3)
      cvqd=cf12(i1,i2)%e(0)*p8(0)-cf12(i1,i2)%e(1)*p8(1)-cf12(i1
     & ,i2)%e(2)*p8(2)-cf12(i1,i2)%e(3)*p8(3)
      cauxa=-cf12(i1,i2)%ek0*quqd+p812k0*cvqd+p8k0*cvqu
      cauxb=-cf12(i1,i2)%ek0*p8(2)+p8k0*cf12(i1,i2)%e(2)
      cauxc=+cf12(i1,i2)%ek0*p812(2)-p812k0*cf12(i1,i2)%e(2)
      r8_12(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      r8_12(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      r8_12(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      r8_12(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      r8_12(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      r8_12(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      r8_12(i1,i2)%d(1,1)=ccl*cf12(i1,i2)%ek0
      r8_12(i1,i2)%d(2,2)=ccr*cf12(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                r8_12(i1,i2)%a(iut,jut)=czero
                r8_12(i1,i2)%b(iut,jut)=czero
                r8_12(i1,i2)%c(iut,jut)=czero
                r8_12(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id8).ne.1 .and. ilept(id2).ne.1) then
        do iut=1,2
          do jut=1,2
            rg8_12(iut,jut)%a(1,1) = r8_12(iut,jut)%a(1,1)
     &           /((fcl(id8))*(fcl(id2)))
            rg8_12(iut,jut)%a(2,2) = r8_12(iut,jut)%a(2,2)
     &           /((fcl(id8))*(fcl(id2)))
            rg8_12(iut,jut)%b(1,2) = r8_12(iut,jut)%b(1,2)
     &           /((fcl(id8))*(fcl(id2)))
            rg8_12(iut,jut)%b(2,1) = r8_12(iut,jut)%b(2,1)
     &           /((fcl(id8))*(fcl(id2)))
            rg8_12(iut,jut)%c(1,2) = r8_12(iut,jut)%c(1,2)
     &           /((fcl(id8))*(fcl(id2)))
            rg8_12(iut,jut)%c(2,1) = r8_12(iut,jut)%c(2,1)
     &           /((fcl(id8))*(fcl(id2)))
            rg8_12(iut,jut)%d(1,1) = r8_12(iut,jut)%d(1,1)
     &           /((fcl(id8))*(fcl(id2)))
            rg8_12(iut,jut)%d(2,2) = r8_12(iut,jut)%d(2,2)
     &           /((fcl(id8))*(fcl(id2)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            rg8_12(iut,jut)%a(1,1) = czero
            rg8_12(iut,jut)%a(2,2) = czero
            rg8_12(iut,jut)%b(1,2) = czero
            rg8_12(iut,jut)%b(2,1) = czero
            rg8_12(iut,jut)%c(1,2) = czero
            rg8_12(iut,jut)%c(2,1) = czero
            rg8_12(iut,jut)%d(1,1) = czero
            rg8_12(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p812,q=p8
      quqd=p812(0)*p8(0)-p812(1)*p8(1)-p812(2)*p8(2)-p812(3)*p8(
     & 3)
      ccr=zcr(id8)/((p812q-rmass2(id8))*p812k0)
      ccl=zcl(id8)/((p812q-rmass2(id8))*p812k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p812,qd=p8,v=cz12(i1,i2)%e,a=r8_12(i1,i2)%a,b=r8_12(i1,i2)%b,c
* =r8_12(i1,i2)%c,d=r8_12(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz12(i1,i2)%ek0*(p812(2)*p8(3)-p8(2)*p812(3))+p812
     & k0*(cz12(i1,i2)%e(2)*p8(3)-p8(2)*cz12(i1,i2)%e(3))-p8k0*(
     & cz12(i1,i2)%e(2)*p812(3)-p812(2)*cz12(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz12(i1,i2)%e(3)*p812k0+p812(3)*cz12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz12(i1,i2)%e(3)*p8k0+p8(3)*cz12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz12(i1,i2)%e(0)*p812(0)-cz12(i1,i2)%e(1)*p812(1)-cz1
     & 2(i1,i2)%e(2)*p812(2)-cz12(i1,i2)%e(3)*p812(3)
      cvqd=cz12(i1,i2)%e(0)*p8(0)-cz12(i1,i2)%e(1)*p8(1)-cz12(i1
     & ,i2)%e(2)*p8(2)-cz12(i1,i2)%e(3)*p8(3)
      cauxa=-cz12(i1,i2)%ek0*quqd+p812k0*cvqd+p8k0*cvqu
      cauxb=-cz12(i1,i2)%ek0*p8(2)+p8k0*cz12(i1,i2)%e(2)
      cauxc=+cz12(i1,i2)%ek0*p812(2)-p812k0*cz12(i1,i2)%e(2)
      r8_12(i1,i2)%a(1,1)=r8_12(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      r8_12(i1,i2)%a(2,2)=r8_12(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      r8_12(i1,i2)%b(1,2)=r8_12(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      r8_12(i1,i2)%b(2,1)=r8_12(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      r8_12(i1,i2)%c(1,2)=r8_12(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      r8_12(i1,i2)%c(2,1)=r8_12(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      r8_12(i1,i2)%d(1,1)=r8_12(i1,i2)%d(1,1)+ccl*cz12(i1,i2)%ek
     & 0
      r8_12(i1,i2)%d(2,2)=r8_12(i1,i2)%d(2,2)+ccr*cz12(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id8.eq.-5.and.id2.eq.-5.and.rmh.ge.0.d0) then
  
* TH -- qu=p812,qd=p8,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p812k0*p8(2)+p8k0*p812(2)
      cauxa=auxa-cim*(p8(3)*p812k0-p812(3)*p8k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p8k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p812k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p812q-rmass2(id8))*p812k0)
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r8_12(i1,i2)%a(i3,i4)=ch12(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  r8_12(i1,i2)%b(i3,i4)=ch12(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  r8_12(i1,i2)%c(i3,i4)=ch12(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r8_12(i1,i2)%a(i3,i4)=czero
                else
                  r8_12(i1,i2)%b(i3,i4)=czero
                  r8_12(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
      do m=0,3
        p834(m)=-p8(m)-p34(m)
      enddo
* pk0 -- p=p834
      p834k0=p834(0)-p834(1)
* p.q -- p.q=p834q,p=p834,q=p834,bef=,aft=
      p834q=(p834(0)*p834(0)-p834(1)*p834(1)-p834(2)*p834(2)-p83
     & 4(3)*p834(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id8).ne.1) then
* quqd -- p=p834,q=p8
      quqd=p834(0)*p8(0)-p834(1)*p8(1)-p834(2)*p8(2)-p834(3)*p8(
     & 3)
      ccr=fcr(id8)/((p834q-rmass2(id8))*p834k0)
      ccl=fcl(id8)/((p834q-rmass2(id8))*p834k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p834,qd=p8,v=cf34(i1,i2)%e,a=r8_34(i1,i2)%a,b=r8_34(i1,i2)%b,c
* =r8_34(i1,i2)%c,d=r8_34(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf34(i1,i2)%ek0*(p834(2)*p8(3)-p8(2)*p834(3))+p834
     & k0*(cf34(i1,i2)%e(2)*p8(3)-p8(2)*cf34(i1,i2)%e(3))-p8k0*(
     & cf34(i1,i2)%e(2)*p834(3)-p834(2)*cf34(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf34(i1,i2)%e(3)*p834k0+p834(3)*cf34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf34(i1,i2)%e(3)*p8k0+p8(3)*cf34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf34(i1,i2)%e(0)*p834(0)-cf34(i1,i2)%e(1)*p834(1)-cf3
     & 4(i1,i2)%e(2)*p834(2)-cf34(i1,i2)%e(3)*p834(3)
      cvqd=cf34(i1,i2)%e(0)*p8(0)-cf34(i1,i2)%e(1)*p8(1)-cf34(i1
     & ,i2)%e(2)*p8(2)-cf34(i1,i2)%e(3)*p8(3)
      cauxa=-cf34(i1,i2)%ek0*quqd+p834k0*cvqd+p8k0*cvqu
      cauxb=-cf34(i1,i2)%ek0*p8(2)+p8k0*cf34(i1,i2)%e(2)
      cauxc=+cf34(i1,i2)%ek0*p834(2)-p834k0*cf34(i1,i2)%e(2)
      r8_34(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      r8_34(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      r8_34(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      r8_34(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      r8_34(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      r8_34(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      r8_34(i1,i2)%d(1,1)=ccl*cf34(i1,i2)%ek0
      r8_34(i1,i2)%d(2,2)=ccr*cf34(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                r8_34(i1,i2)%a(iut,jut)=czero
                r8_34(i1,i2)%b(iut,jut)=czero
                r8_34(i1,i2)%c(iut,jut)=czero
                r8_34(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id8).ne.1 .and. ilept(id4).ne.1) then
        do iut=1,2
          do jut=1,2
            rg8_34(iut,jut)%a(1,1) = r8_34(iut,jut)%a(1,1)
     &           /((fcl(id8))*(fcl(id4)))
            rg8_34(iut,jut)%a(2,2) = r8_34(iut,jut)%a(2,2)
     &           /((fcl(id8))*(fcl(id4)))
            rg8_34(iut,jut)%b(1,2) = r8_34(iut,jut)%b(1,2)
     &           /((fcl(id8))*(fcl(id4)))
            rg8_34(iut,jut)%b(2,1) = r8_34(iut,jut)%b(2,1)
     &           /((fcl(id8))*(fcl(id4)))
            rg8_34(iut,jut)%c(1,2) = r8_34(iut,jut)%c(1,2)
     &           /((fcl(id8))*(fcl(id4)))
            rg8_34(iut,jut)%c(2,1) = r8_34(iut,jut)%c(2,1)
     &           /((fcl(id8))*(fcl(id4)))
            rg8_34(iut,jut)%d(1,1) = r8_34(iut,jut)%d(1,1)
     &           /((fcl(id8))*(fcl(id4)))
            rg8_34(iut,jut)%d(2,2) = r8_34(iut,jut)%d(2,2)
     &           /((fcl(id8))*(fcl(id4)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            rg8_34(iut,jut)%a(1,1) = czero
            rg8_34(iut,jut)%a(2,2) = czero
            rg8_34(iut,jut)%b(1,2) = czero
            rg8_34(iut,jut)%b(2,1) = czero
            rg8_34(iut,jut)%c(1,2) = czero
            rg8_34(iut,jut)%c(2,1) = czero
            rg8_34(iut,jut)%d(1,1) = czero
            rg8_34(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p834,q=p8
      quqd=p834(0)*p8(0)-p834(1)*p8(1)-p834(2)*p8(2)-p834(3)*p8(
     & 3)
      ccr=zcr(id8)/((p834q-rmass2(id8))*p834k0)
      ccl=zcl(id8)/((p834q-rmass2(id8))*p834k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p834,qd=p8,v=cz34(i1,i2)%e,a=r8_34(i1,i2)%a,b=r8_34(i1,i2)%b,c
* =r8_34(i1,i2)%c,d=r8_34(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz34(i1,i2)%ek0*(p834(2)*p8(3)-p8(2)*p834(3))+p834
     & k0*(cz34(i1,i2)%e(2)*p8(3)-p8(2)*cz34(i1,i2)%e(3))-p8k0*(
     & cz34(i1,i2)%e(2)*p834(3)-p834(2)*cz34(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz34(i1,i2)%e(3)*p834k0+p834(3)*cz34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz34(i1,i2)%e(3)*p8k0+p8(3)*cz34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz34(i1,i2)%e(0)*p834(0)-cz34(i1,i2)%e(1)*p834(1)-cz3
     & 4(i1,i2)%e(2)*p834(2)-cz34(i1,i2)%e(3)*p834(3)
      cvqd=cz34(i1,i2)%e(0)*p8(0)-cz34(i1,i2)%e(1)*p8(1)-cz34(i1
     & ,i2)%e(2)*p8(2)-cz34(i1,i2)%e(3)*p8(3)
      cauxa=-cz34(i1,i2)%ek0*quqd+p834k0*cvqd+p8k0*cvqu
      cauxb=-cz34(i1,i2)%ek0*p8(2)+p8k0*cz34(i1,i2)%e(2)
      cauxc=+cz34(i1,i2)%ek0*p834(2)-p834k0*cz34(i1,i2)%e(2)
      r8_34(i1,i2)%a(1,1)=r8_34(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      r8_34(i1,i2)%a(2,2)=r8_34(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      r8_34(i1,i2)%b(1,2)=r8_34(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      r8_34(i1,i2)%b(2,1)=r8_34(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      r8_34(i1,i2)%c(1,2)=r8_34(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      r8_34(i1,i2)%c(2,1)=r8_34(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      r8_34(i1,i2)%d(1,1)=r8_34(i1,i2)%d(1,1)+ccl*cz34(i1,i2)%ek
     & 0
      r8_34(i1,i2)%d(2,2)=r8_34(i1,i2)%d(2,2)+ccr*cz34(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id8.eq.-5.and.id4.eq.-5.and.rmh.ge.0.d0) then
  
* TH -- qu=p834,qd=p8,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p834k0*p8(2)+p8k0*p834(2)
      cauxa=auxa-cim*(p8(3)*p834k0-p834(3)*p8k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p8k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p834k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p834q-rmass2(id8))*p834k0)
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r8_34(i1,i2)%a(i3,i4)=ch34(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  r8_34(i1,i2)%b(i3,i4)=ch34(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  r8_34(i1,i2)%c(i3,i4)=ch34(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r8_34(i1,i2)%a(i3,i4)=czero
                else
                  r8_34(i1,i2)%b(i3,i4)=czero
                  r8_34(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
      do m=0,3
        p856(m)=-p8(m)-p56(m)
      enddo
* pk0 -- p=p856
      p856k0=p856(0)-p856(1)
* p.q -- p.q=p856q,p=p856,q=p856,bef=,aft=
      p856q=(p856(0)*p856(0)-p856(1)*p856(1)-p856(2)*p856(2)-p85
     & 6(3)*p856(3))
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id8).ne.1) then
* quqd -- p=p856,q=p8
      quqd=p856(0)*p8(0)-p856(1)*p8(1)-p856(2)*p8(2)-p856(3)*p8(
     & 3)
      ccr=fcr(id8)/((p856q-rmass2(id8))*p856k0)
      ccl=fcl(id8)/((p856q-rmass2(id8))*p856k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p856,qd=p8,v=cf56(i1,i2)%e,a=r8_56(i1,i2)%a,b=r8_56(i1,i2)%b,c
* =r8_56(i1,i2)%c,d=r8_56(i1,i2)%d,cr=ccr,cl=ccl,nsum=0
      ceps_0=-cf56(i1,i2)%ek0*(p856(2)*p8(3)-p8(2)*p856(3))+p856
     & k0*(cf56(i1,i2)%e(2)*p8(3)-p8(2)*cf56(i1,i2)%e(3))-p8k0*(
     & cf56(i1,i2)%e(2)*p856(3)-p856(2)*cf56(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cf56(i1,i2)%e(3)*p856k0+p856(3)*cf56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf56(i1,i2)%e(3)*p8k0+p8(3)*cf56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf56(i1,i2)%e(0)*p856(0)-cf56(i1,i2)%e(1)*p856(1)-cf5
     & 6(i1,i2)%e(2)*p856(2)-cf56(i1,i2)%e(3)*p856(3)
      cvqd=cf56(i1,i2)%e(0)*p8(0)-cf56(i1,i2)%e(1)*p8(1)-cf56(i1
     & ,i2)%e(2)*p8(2)-cf56(i1,i2)%e(3)*p8(3)
      cauxa=-cf56(i1,i2)%ek0*quqd+p856k0*cvqd+p8k0*cvqu
      cauxb=-cf56(i1,i2)%ek0*p8(2)+p8k0*cf56(i1,i2)%e(2)
      cauxc=+cf56(i1,i2)%ek0*p856(2)-p856k0*cf56(i1,i2)%e(2)
      r8_56(i1,i2)%a(1,1)=ccr*(cauxa+ceps_0)
      r8_56(i1,i2)%a(2,2)=ccl*(cauxa-ceps_0)
      r8_56(i1,i2)%b(1,2)=ccl*(cauxb-ceps_2)
      r8_56(i1,i2)%b(2,1)=ccr*(-cauxb-ceps_2)
      r8_56(i1,i2)%c(1,2)=ccr*(cauxc+ceps_1)
      r8_56(i1,i2)%c(2,1)=ccl*(-cauxc+ceps_1)
      r8_56(i1,i2)%d(1,1)=ccl*cf56(i1,i2)%ek0
      r8_56(i1,i2)%d(2,2)=ccr*cf56(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                r8_56(i1,i2)%a(iut,jut)=czero
                r8_56(i1,i2)%b(iut,jut)=czero
                r8_56(i1,i2)%c(iut,jut)=czero
                r8_56(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id8).ne.1 .and. ilept(id6).ne.1) then
        do iut=1,2
          do jut=1,2
            rg8_56(iut,jut)%a(1,1) = r8_56(iut,jut)%a(1,1)
     &           /((fcl(id8))*(fcl(id6)))
            rg8_56(iut,jut)%a(2,2) = r8_56(iut,jut)%a(2,2)
     &           /((fcl(id8))*(fcl(id6)))
            rg8_56(iut,jut)%b(1,2) = r8_56(iut,jut)%b(1,2)
     &           /((fcl(id8))*(fcl(id6)))
            rg8_56(iut,jut)%b(2,1) = r8_56(iut,jut)%b(2,1)
     &           /((fcl(id8))*(fcl(id6)))
            rg8_56(iut,jut)%c(1,2) = r8_56(iut,jut)%c(1,2)
     &           /((fcl(id8))*(fcl(id6)))
            rg8_56(iut,jut)%c(2,1) = r8_56(iut,jut)%c(2,1)
     &           /((fcl(id8))*(fcl(id6)))
            rg8_56(iut,jut)%d(1,1) = r8_56(iut,jut)%d(1,1)
     &           /((fcl(id8))*(fcl(id6)))
            rg8_56(iut,jut)%d(2,2) = r8_56(iut,jut)%d(2,2)
     &           /((fcl(id8))*(fcl(id6)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            rg8_56(iut,jut)%a(1,1) = czero
            rg8_56(iut,jut)%a(2,2) = czero
            rg8_56(iut,jut)%b(1,2) = czero
            rg8_56(iut,jut)%b(2,1) = czero
            rg8_56(iut,jut)%c(1,2) = czero
            rg8_56(iut,jut)%c(2,1) = czero
            rg8_56(iut,jut)%d(1,1) = czero
            rg8_56(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p856,q=p8
      quqd=p856(0)*p8(0)-p856(1)*p8(1)-p856(2)*p8(2)-p856(3)*p8(
     & 3)
      ccr=zcr(id8)/((p856q-rmass2(id8))*p856k0)
      ccl=zcl(id8)/((p856q-rmass2(id8))*p856k0)
      do i1=1,2
      do i2=1,2
* T -- qu=p856,qd=p8,v=cz56(i1,i2)%e,a=r8_56(i1,i2)%a,b=r8_56(i1,i2)%b,c
* =r8_56(i1,i2)%c,d=r8_56(i1,i2)%d,cr=ccr,cl=ccl,nsum=1
      ceps_0=-cz56(i1,i2)%ek0*(p856(2)*p8(3)-p8(2)*p856(3))+p856
     & k0*(cz56(i1,i2)%e(2)*p8(3)-p8(2)*cz56(i1,i2)%e(3))-p8k0*(
     & cz56(i1,i2)%e(2)*p856(3)-p856(2)*cz56(i1,i2)%e(3))
      ceps_0=ceps_0*cim
      ceps_1=-cz56(i1,i2)%e(3)*p856k0+p856(3)*cz56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz56(i1,i2)%e(3)*p8k0+p8(3)*cz56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz56(i1,i2)%e(0)*p856(0)-cz56(i1,i2)%e(1)*p856(1)-cz5
     & 6(i1,i2)%e(2)*p856(2)-cz56(i1,i2)%e(3)*p856(3)
      cvqd=cz56(i1,i2)%e(0)*p8(0)-cz56(i1,i2)%e(1)*p8(1)-cz56(i1
     & ,i2)%e(2)*p8(2)-cz56(i1,i2)%e(3)*p8(3)
      cauxa=-cz56(i1,i2)%ek0*quqd+p856k0*cvqd+p8k0*cvqu
      cauxb=-cz56(i1,i2)%ek0*p8(2)+p8k0*cz56(i1,i2)%e(2)
      cauxc=+cz56(i1,i2)%ek0*p856(2)-p856k0*cz56(i1,i2)%e(2)
      r8_56(i1,i2)%a(1,1)=r8_56(i1,i2)%a(1,1)+ccr*(cauxa+ceps_0)
      r8_56(i1,i2)%a(2,2)=r8_56(i1,i2)%a(2,2)+ccl*(cauxa-ceps_0)
      r8_56(i1,i2)%b(1,2)=r8_56(i1,i2)%b(1,2)+ccl*(cauxb-ceps_2)
      r8_56(i1,i2)%b(2,1)=r8_56(i1,i2)%b(2,1)+ccr*(-cauxb-ceps_2
     & )
      r8_56(i1,i2)%c(1,2)=r8_56(i1,i2)%c(1,2)+ccr*(cauxc+ceps_1)
      r8_56(i1,i2)%c(2,1)=r8_56(i1,i2)%c(2,1)+ccl*(-cauxc+ceps_1
     & )
      r8_56(i1,i2)%d(1,1)=r8_56(i1,i2)%d(1,1)+ccl*cz56(i1,i2)%ek
     & 0
      r8_56(i1,i2)%d(2,2)=r8_56(i1,i2)%d(2,2)+ccr*cz56(i1,i2)%ek
     & 0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id8.eq.-5.and.id6.eq.-5.and.rmh.ge.0.d0) then
  
* TH -- qu=p856,qd=p8,a=clineth%a,b=clineth%b,c=clineth%c,coupl=1.
      auxa=-p856k0*p8(2)+p8k0*p856(2)
      cauxa=auxa-cim*(p8(3)*p856k0-p856(3)*p8k0)
      clineth%a(1,2)=cauxa
      clineth%a(2,1)=-conjg(cauxa)
      clineth%b(1,1)=p8k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=p856k0
      clineth%c(2,2)=clineth%c(1,1)
  
      cfactor= rhbb/((p856q-rmass2(id8))*p856k0)
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r8_56(i1,i2)%a(i3,i4)=ch56(i1,i2)*clineth%a(i3,i4)
     &                 *cfactor
                else
                  r8_56(i1,i2)%b(i3,i4)=ch56(i1,i2)*clineth%b(i3,i4)
     &                 *cfactor
                  r8_56(i1,i2)%c(i3,i4)=ch56(i1,i2)*clineth%c(i3,i4)
     &                 *cfactor
                endif
              enddo
            enddo
          enddo
        enddo
      else
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  r8_56(i1,i2)%a(i3,i4)=czero
                else
                  r8_56(i1,i2)%b(i3,i4)=czero
                  r8_56(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
* COMPUTE ALL SINGLE Z OR GAMMA OR HIGGS INSERTIONS IN THE MIDDLE OF A  
*  TRIPLE INSERTION ZLINE                                               
*                                                                       
*            |                                                          
*            |_Z,f,h__/                                                 
*            |        \                                                 
*            |                                                          
*                                                                       
**QCD                                                                   
*    and their QCD counterparts                                         
*                                                                       
*            |                                                          
*            |~~g~~<                                                    
*            |                                                          
*                                                                       
*As g_strong and e are factorized, this class of QCD subdiagrams differs
*from that of gamma insertions by a factor (fcl(id_i))*(fcl(id_j)), with
*i,j={1,3,5,7} (notice that fcl=fcr for all fermions).                  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id1).ne.1) then
* quqd -- p=p134,q=p278
      quqd=p134(0)*p278(0)-p134(1)*p278(1)-p134(2)*p278(2)-p134(
     & 3)*p278(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p134,qd=p278,v=cf56(i1,i2)%e,a=u134_56(i1,i2)%a,b=u134_56(i1,i
* 2)%b,c=u134_56(i1,i2)%c,d=u134_56(i1,i2)%d,cr=fcr(id1),cl=fcl(id1),nsu
* m=0
      ceps_0=-cf56(i1,i2)%ek0*(p134(2)*p278(3)-p278(2)*p134(3))+
     & p134k0*(cf56(i1,i2)%e(2)*p278(3)-p278(2)*cf56(i1,i2)%e(3)
     & )-p278k0*(cf56(i1,i2)%e(2)*p134(3)-p134(2)*cf56(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf56(i1,i2)%e(3)*p134k0+p134(3)*cf56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf56(i1,i2)%e(3)*p278k0+p278(3)*cf56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf56(i1,i2)%e(0)*p134(0)-cf56(i1,i2)%e(1)*p134(1)-cf5
     & 6(i1,i2)%e(2)*p134(2)-cf56(i1,i2)%e(3)*p134(3)
      cvqd=cf56(i1,i2)%e(0)*p278(0)-cf56(i1,i2)%e(1)*p278(1)-cf5
     & 6(i1,i2)%e(2)*p278(2)-cf56(i1,i2)%e(3)*p278(3)
      cauxa=-cf56(i1,i2)%ek0*quqd+p134k0*cvqd+p278k0*cvqu
      cauxb=-cf56(i1,i2)%ek0*p278(2)+p278k0*cf56(i1,i2)%e(2)
      cauxc=+cf56(i1,i2)%ek0*p134(2)-p134k0*cf56(i1,i2)%e(2)
      u134_56(i1,i2)%a(1,1)=fcr(id1)*(cauxa+ceps_0)
      u134_56(i1,i2)%a(2,2)=fcl(id1)*(cauxa-ceps_0)
      u134_56(i1,i2)%b(1,2)=fcl(id1)*(cauxb-ceps_2)
      u134_56(i1,i2)%b(2,1)=fcr(id1)*(-cauxb-ceps_2)
      u134_56(i1,i2)%c(1,2)=fcr(id1)*(cauxc+ceps_1)
      u134_56(i1,i2)%c(2,1)=fcl(id1)*(-cauxc+ceps_1)
      u134_56(i1,i2)%d(1,1)=fcl(id1)*cf56(i1,i2)%ek0
      u134_56(i1,i2)%d(2,2)=fcr(id1)*cf56(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u134_56(i1,i2)%a(iut,jut)=czero
                u134_56(i1,i2)%b(iut,jut)=czero
                u134_56(i1,i2)%c(iut,jut)=czero
                u134_56(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id1).ne.1 .and. ilept(id5).ne.1) then
        do iut=1,2
          do jut=1,2
            ug134_56(iut,jut)%a(1,1) = u134_56(iut,jut)%a(1,1)
     &           /((fcl(id1))*(fcl(id5)))
            ug134_56(iut,jut)%a(2,2) = u134_56(iut,jut)%a(2,2)
     &           /((fcl(id1))*(fcl(id5)))
            ug134_56(iut,jut)%b(1,2) = u134_56(iut,jut)%b(1,2)
     &           /((fcl(id1))*(fcl(id5)))
            ug134_56(iut,jut)%b(2,1) = u134_56(iut,jut)%b(2,1)
     &           /((fcl(id1))*(fcl(id5)))
            ug134_56(iut,jut)%c(1,2) = u134_56(iut,jut)%c(1,2)
     &           /((fcl(id1))*(fcl(id5)))
            ug134_56(iut,jut)%c(2,1) = u134_56(iut,jut)%c(2,1)
     &           /((fcl(id1))*(fcl(id5)))
            ug134_56(iut,jut)%d(1,1) = u134_56(iut,jut)%d(1,1)
     &           /((fcl(id1))*(fcl(id5)))
            ug134_56(iut,jut)%d(2,2) = u134_56(iut,jut)%d(2,2)
     &           /((fcl(id1))*(fcl(id5)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug134_56(iut,jut)%a(1,1) = czero
            ug134_56(iut,jut)%a(2,2) = czero
            ug134_56(iut,jut)%b(1,2) = czero
            ug134_56(iut,jut)%b(2,1) = czero
            ug134_56(iut,jut)%c(1,2) = czero
            ug134_56(iut,jut)%c(2,1) = czero
            ug134_56(iut,jut)%d(1,1) = czero
            ug134_56(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p134,q=p278
      quqd=p134(0)*p278(0)-p134(1)*p278(1)-p134(2)*p278(2)-p134(
     & 3)*p278(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p134,qd=p278,v=cz56(i1,i2)%e,a=u134_56(i1,i2)%a,b=u134_56(i1,i
* 2)%b,c=u134_56(i1,i2)%c,d=u134_56(i1,i2)%d,cr=zcr(id1),cl=zcl(id1),nsu
* m=1
      ceps_0=-cz56(i1,i2)%ek0*(p134(2)*p278(3)-p278(2)*p134(3))+
     & p134k0*(cz56(i1,i2)%e(2)*p278(3)-p278(2)*cz56(i1,i2)%e(3)
     & )-p278k0*(cz56(i1,i2)%e(2)*p134(3)-p134(2)*cz56(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz56(i1,i2)%e(3)*p134k0+p134(3)*cz56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz56(i1,i2)%e(3)*p278k0+p278(3)*cz56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz56(i1,i2)%e(0)*p134(0)-cz56(i1,i2)%e(1)*p134(1)-cz5
     & 6(i1,i2)%e(2)*p134(2)-cz56(i1,i2)%e(3)*p134(3)
      cvqd=cz56(i1,i2)%e(0)*p278(0)-cz56(i1,i2)%e(1)*p278(1)-cz5
     & 6(i1,i2)%e(2)*p278(2)-cz56(i1,i2)%e(3)*p278(3)
      cauxa=-cz56(i1,i2)%ek0*quqd+p134k0*cvqd+p278k0*cvqu
      cauxb=-cz56(i1,i2)%ek0*p278(2)+p278k0*cz56(i1,i2)%e(2)
      cauxc=+cz56(i1,i2)%ek0*p134(2)-p134k0*cz56(i1,i2)%e(2)
      u134_56(i1,i2)%a(1,1)=u134_56(i1,i2)%a(1,1)+zcr(id1)*(caux
     & a+ceps_0)
      u134_56(i1,i2)%a(2,2)=u134_56(i1,i2)%a(2,2)+zcl(id1)*(caux
     & a-ceps_0)
      u134_56(i1,i2)%b(1,2)=u134_56(i1,i2)%b(1,2)+zcl(id1)*(caux
     & b-ceps_2)
      u134_56(i1,i2)%b(2,1)=u134_56(i1,i2)%b(2,1)+zcr(id1)*(-cau
     & xb-ceps_2)
      u134_56(i1,i2)%c(1,2)=u134_56(i1,i2)%c(1,2)+zcr(id1)*(caux
     & c+ceps_1)
      u134_56(i1,i2)%c(2,1)=u134_56(i1,i2)%c(2,1)+zcl(id1)*(-cau
     & xc+ceps_1)
      u134_56(i1,i2)%d(1,1)=u134_56(i1,i2)%d(1,1)+zcl(id1)*cz56(
     & i1,i2)%ek0
      u134_56(i1,i2)%d(2,2)=u134_56(i1,i2)%d(2,2)+zcr(id1)*cz56(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.id5.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p134,qd=p278,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p134k0*p278(2)+p278k0*p134(2)
      cauxa=auxa-cim*(p278(3)*p134k0-p134(3)*p278k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p278k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p134k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u134_56(i1,i2)%a(i3,i4)=ch56(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u134_56(i1,i2)%b(i3,i4)=ch56(i1,i2)
     &                 *clineth%b(i3,i4)
                  u134_56(i1,i2)%c(i3,i4)=ch56(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u134_56(i1,i2)%a(i3,i4)=czero
                else
                  u134_56(i1,i2)%b(i3,i4)=czero
                  u134_56(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id1).ne.1) then
* quqd -- p=p134,q=p256
      quqd=p134(0)*p256(0)-p134(1)*p256(1)-p134(2)*p256(2)-p134(
     & 3)*p256(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p134,qd=p256,v=cf78(i1,i2)%e,a=u134_78(i1,i2)%a,b=u134_78(i1,i
* 2)%b,c=u134_78(i1,i2)%c,d=u134_78(i1,i2)%d,cr=fcr(id1),cl=fcl(id1),nsu
* m=0
      ceps_0=-cf78(i1,i2)%ek0*(p134(2)*p256(3)-p256(2)*p134(3))+
     & p134k0*(cf78(i1,i2)%e(2)*p256(3)-p256(2)*cf78(i1,i2)%e(3)
     & )-p256k0*(cf78(i1,i2)%e(2)*p134(3)-p134(2)*cf78(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf78(i1,i2)%e(3)*p134k0+p134(3)*cf78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf78(i1,i2)%e(3)*p256k0+p256(3)*cf78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf78(i1,i2)%e(0)*p134(0)-cf78(i1,i2)%e(1)*p134(1)-cf7
     & 8(i1,i2)%e(2)*p134(2)-cf78(i1,i2)%e(3)*p134(3)
      cvqd=cf78(i1,i2)%e(0)*p256(0)-cf78(i1,i2)%e(1)*p256(1)-cf7
     & 8(i1,i2)%e(2)*p256(2)-cf78(i1,i2)%e(3)*p256(3)
      cauxa=-cf78(i1,i2)%ek0*quqd+p134k0*cvqd+p256k0*cvqu
      cauxb=-cf78(i1,i2)%ek0*p256(2)+p256k0*cf78(i1,i2)%e(2)
      cauxc=+cf78(i1,i2)%ek0*p134(2)-p134k0*cf78(i1,i2)%e(2)
      u134_78(i1,i2)%a(1,1)=fcr(id1)*(cauxa+ceps_0)
      u134_78(i1,i2)%a(2,2)=fcl(id1)*(cauxa-ceps_0)
      u134_78(i1,i2)%b(1,2)=fcl(id1)*(cauxb-ceps_2)
      u134_78(i1,i2)%b(2,1)=fcr(id1)*(-cauxb-ceps_2)
      u134_78(i1,i2)%c(1,2)=fcr(id1)*(cauxc+ceps_1)
      u134_78(i1,i2)%c(2,1)=fcl(id1)*(-cauxc+ceps_1)
      u134_78(i1,i2)%d(1,1)=fcl(id1)*cf78(i1,i2)%ek0
      u134_78(i1,i2)%d(2,2)=fcr(id1)*cf78(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u134_78(i1,i2)%a(iut,jut)=czero
                u134_78(i1,i2)%b(iut,jut)=czero
                u134_78(i1,i2)%c(iut,jut)=czero
                u134_78(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id1).ne.1 .and. ilept(id7).ne.1) then
        do iut=1,2
          do jut=1,2
            ug134_78(iut,jut)%a(1,1) = u134_78(iut,jut)%a(1,1)
     &           /((fcl(id1))*(fcl(id7)))
            ug134_78(iut,jut)%a(2,2) = u134_78(iut,jut)%a(2,2)
     &           /((fcl(id1))*(fcl(id7)))
            ug134_78(iut,jut)%b(1,2) = u134_78(iut,jut)%b(1,2)
     &           /((fcl(id1))*(fcl(id7)))
            ug134_78(iut,jut)%b(2,1) = u134_78(iut,jut)%b(2,1)
     &           /((fcl(id1))*(fcl(id7)))
            ug134_78(iut,jut)%c(1,2) = u134_78(iut,jut)%c(1,2)
     &           /((fcl(id1))*(fcl(id7)))
            ug134_78(iut,jut)%c(2,1) = u134_78(iut,jut)%c(2,1)
     &           /((fcl(id1))*(fcl(id7)))
            ug134_78(iut,jut)%d(1,1) = u134_78(iut,jut)%d(1,1)
     &           /((fcl(id1))*(fcl(id7)))
            ug134_78(iut,jut)%d(2,2) = u134_78(iut,jut)%d(2,2)
     &           /((fcl(id1))*(fcl(id7)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug134_78(iut,jut)%a(1,1) = czero
            ug134_78(iut,jut)%a(2,2) = czero
            ug134_78(iut,jut)%b(1,2) = czero
            ug134_78(iut,jut)%b(2,1) = czero
            ug134_78(iut,jut)%c(1,2) = czero
            ug134_78(iut,jut)%c(2,1) = czero
            ug134_78(iut,jut)%d(1,1) = czero
            ug134_78(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p134,q=p256
      quqd=p134(0)*p256(0)-p134(1)*p256(1)-p134(2)*p256(2)-p134(
     & 3)*p256(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p134,qd=p256,v=cz78(i1,i2)%e,a=u134_78(i1,i2)%a,b=u134_78(i1,i
* 2)%b,c=u134_78(i1,i2)%c,d=u134_78(i1,i2)%d,cr=zcr(id1),cl=zcl(id1),nsu
* m=1
      ceps_0=-cz78(i1,i2)%ek0*(p134(2)*p256(3)-p256(2)*p134(3))+
     & p134k0*(cz78(i1,i2)%e(2)*p256(3)-p256(2)*cz78(i1,i2)%e(3)
     & )-p256k0*(cz78(i1,i2)%e(2)*p134(3)-p134(2)*cz78(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz78(i1,i2)%e(3)*p134k0+p134(3)*cz78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz78(i1,i2)%e(3)*p256k0+p256(3)*cz78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz78(i1,i2)%e(0)*p134(0)-cz78(i1,i2)%e(1)*p134(1)-cz7
     & 8(i1,i2)%e(2)*p134(2)-cz78(i1,i2)%e(3)*p134(3)
      cvqd=cz78(i1,i2)%e(0)*p256(0)-cz78(i1,i2)%e(1)*p256(1)-cz7
     & 8(i1,i2)%e(2)*p256(2)-cz78(i1,i2)%e(3)*p256(3)
      cauxa=-cz78(i1,i2)%ek0*quqd+p134k0*cvqd+p256k0*cvqu
      cauxb=-cz78(i1,i2)%ek0*p256(2)+p256k0*cz78(i1,i2)%e(2)
      cauxc=+cz78(i1,i2)%ek0*p134(2)-p134k0*cz78(i1,i2)%e(2)
      u134_78(i1,i2)%a(1,1)=u134_78(i1,i2)%a(1,1)+zcr(id1)*(caux
     & a+ceps_0)
      u134_78(i1,i2)%a(2,2)=u134_78(i1,i2)%a(2,2)+zcl(id1)*(caux
     & a-ceps_0)
      u134_78(i1,i2)%b(1,2)=u134_78(i1,i2)%b(1,2)+zcl(id1)*(caux
     & b-ceps_2)
      u134_78(i1,i2)%b(2,1)=u134_78(i1,i2)%b(2,1)+zcr(id1)*(-cau
     & xb-ceps_2)
      u134_78(i1,i2)%c(1,2)=u134_78(i1,i2)%c(1,2)+zcr(id1)*(caux
     & c+ceps_1)
      u134_78(i1,i2)%c(2,1)=u134_78(i1,i2)%c(2,1)+zcl(id1)*(-cau
     & xc+ceps_1)
      u134_78(i1,i2)%d(1,1)=u134_78(i1,i2)%d(1,1)+zcl(id1)*cz78(
     & i1,i2)%ek0
      u134_78(i1,i2)%d(2,2)=u134_78(i1,i2)%d(2,2)+zcr(id1)*cz78(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.id7.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p134,qd=p256,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p134k0*p256(2)+p256k0*p134(2)
      cauxa=auxa-cim*(p256(3)*p134k0-p134(3)*p256k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p256k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p134k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u134_78(i1,i2)%a(i3,i4)=ch78(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u134_78(i1,i2)%b(i3,i4)=ch78(i1,i2)
     &                 *clineth%b(i3,i4)
                  u134_78(i1,i2)%c(i3,i4)=ch78(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u134_78(i1,i2)%a(i3,i4)=czero
                else
                  u134_78(i1,i2)%b(i3,i4)=czero
                  u134_78(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id1).ne.1) then
* quqd -- p=p156,q=p278
      quqd=p156(0)*p278(0)-p156(1)*p278(1)-p156(2)*p278(2)-p156(
     & 3)*p278(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p156,qd=p278,v=cf34(i1,i2)%e,a=u156_34(i1,i2)%a,b=u156_34(i1,i
* 2)%b,c=u156_34(i1,i2)%c,d=u156_34(i1,i2)%d,cr=fcr(id1),cl=fcl(id1),nsu
* m=0
      ceps_0=-cf34(i1,i2)%ek0*(p156(2)*p278(3)-p278(2)*p156(3))+
     & p156k0*(cf34(i1,i2)%e(2)*p278(3)-p278(2)*cf34(i1,i2)%e(3)
     & )-p278k0*(cf34(i1,i2)%e(2)*p156(3)-p156(2)*cf34(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf34(i1,i2)%e(3)*p156k0+p156(3)*cf34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf34(i1,i2)%e(3)*p278k0+p278(3)*cf34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf34(i1,i2)%e(0)*p156(0)-cf34(i1,i2)%e(1)*p156(1)-cf3
     & 4(i1,i2)%e(2)*p156(2)-cf34(i1,i2)%e(3)*p156(3)
      cvqd=cf34(i1,i2)%e(0)*p278(0)-cf34(i1,i2)%e(1)*p278(1)-cf3
     & 4(i1,i2)%e(2)*p278(2)-cf34(i1,i2)%e(3)*p278(3)
      cauxa=-cf34(i1,i2)%ek0*quqd+p156k0*cvqd+p278k0*cvqu
      cauxb=-cf34(i1,i2)%ek0*p278(2)+p278k0*cf34(i1,i2)%e(2)
      cauxc=+cf34(i1,i2)%ek0*p156(2)-p156k0*cf34(i1,i2)%e(2)
      u156_34(i1,i2)%a(1,1)=fcr(id1)*(cauxa+ceps_0)
      u156_34(i1,i2)%a(2,2)=fcl(id1)*(cauxa-ceps_0)
      u156_34(i1,i2)%b(1,2)=fcl(id1)*(cauxb-ceps_2)
      u156_34(i1,i2)%b(2,1)=fcr(id1)*(-cauxb-ceps_2)
      u156_34(i1,i2)%c(1,2)=fcr(id1)*(cauxc+ceps_1)
      u156_34(i1,i2)%c(2,1)=fcl(id1)*(-cauxc+ceps_1)
      u156_34(i1,i2)%d(1,1)=fcl(id1)*cf34(i1,i2)%ek0
      u156_34(i1,i2)%d(2,2)=fcr(id1)*cf34(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u156_34(i1,i2)%a(iut,jut)=czero
                u156_34(i1,i2)%b(iut,jut)=czero
                u156_34(i1,i2)%c(iut,jut)=czero
                u156_34(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id1).ne.1 .and. ilept(id3).ne.1) then
        do iut=1,2
          do jut=1,2
            ug156_34(iut,jut)%a(1,1) = u156_34(iut,jut)%a(1,1)
     &           /((fcl(id1))*(fcl(id3)))
            ug156_34(iut,jut)%a(2,2) = u156_34(iut,jut)%a(2,2)
     &           /((fcl(id1))*(fcl(id3)))
            ug156_34(iut,jut)%b(1,2) = u156_34(iut,jut)%b(1,2)
     &           /((fcl(id1))*(fcl(id3)))
            ug156_34(iut,jut)%b(2,1) = u156_34(iut,jut)%b(2,1)
     &           /((fcl(id1))*(fcl(id3)))
            ug156_34(iut,jut)%c(1,2) = u156_34(iut,jut)%c(1,2)
     &           /((fcl(id1))*(fcl(id3)))
            ug156_34(iut,jut)%c(2,1) = u156_34(iut,jut)%c(2,1)
     &           /((fcl(id1))*(fcl(id3)))
            ug156_34(iut,jut)%d(1,1) = u156_34(iut,jut)%d(1,1)
     &           /((fcl(id1))*(fcl(id3)))
            ug156_34(iut,jut)%d(2,2) = u156_34(iut,jut)%d(2,2)
     &           /((fcl(id1))*(fcl(id3)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug156_34(iut,jut)%a(1,1) = czero
            ug156_34(iut,jut)%a(2,2) = czero
            ug156_34(iut,jut)%b(1,2) = czero
            ug156_34(iut,jut)%b(2,1) = czero
            ug156_34(iut,jut)%c(1,2) = czero
            ug156_34(iut,jut)%c(2,1) = czero
            ug156_34(iut,jut)%d(1,1) = czero
            ug156_34(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p156,q=p278
      quqd=p156(0)*p278(0)-p156(1)*p278(1)-p156(2)*p278(2)-p156(
     & 3)*p278(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p156,qd=p278,v=cz34(i1,i2)%e,a=u156_34(i1,i2)%a,b=u156_34(i1,i
* 2)%b,c=u156_34(i1,i2)%c,d=u156_34(i1,i2)%d,cr=zcr(id1),cl=zcl(id1),nsu
* m=1
      ceps_0=-cz34(i1,i2)%ek0*(p156(2)*p278(3)-p278(2)*p156(3))+
     & p156k0*(cz34(i1,i2)%e(2)*p278(3)-p278(2)*cz34(i1,i2)%e(3)
     & )-p278k0*(cz34(i1,i2)%e(2)*p156(3)-p156(2)*cz34(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz34(i1,i2)%e(3)*p156k0+p156(3)*cz34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz34(i1,i2)%e(3)*p278k0+p278(3)*cz34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz34(i1,i2)%e(0)*p156(0)-cz34(i1,i2)%e(1)*p156(1)-cz3
     & 4(i1,i2)%e(2)*p156(2)-cz34(i1,i2)%e(3)*p156(3)
      cvqd=cz34(i1,i2)%e(0)*p278(0)-cz34(i1,i2)%e(1)*p278(1)-cz3
     & 4(i1,i2)%e(2)*p278(2)-cz34(i1,i2)%e(3)*p278(3)
      cauxa=-cz34(i1,i2)%ek0*quqd+p156k0*cvqd+p278k0*cvqu
      cauxb=-cz34(i1,i2)%ek0*p278(2)+p278k0*cz34(i1,i2)%e(2)
      cauxc=+cz34(i1,i2)%ek0*p156(2)-p156k0*cz34(i1,i2)%e(2)
      u156_34(i1,i2)%a(1,1)=u156_34(i1,i2)%a(1,1)+zcr(id1)*(caux
     & a+ceps_0)
      u156_34(i1,i2)%a(2,2)=u156_34(i1,i2)%a(2,2)+zcl(id1)*(caux
     & a-ceps_0)
      u156_34(i1,i2)%b(1,2)=u156_34(i1,i2)%b(1,2)+zcl(id1)*(caux
     & b-ceps_2)
      u156_34(i1,i2)%b(2,1)=u156_34(i1,i2)%b(2,1)+zcr(id1)*(-cau
     & xb-ceps_2)
      u156_34(i1,i2)%c(1,2)=u156_34(i1,i2)%c(1,2)+zcr(id1)*(caux
     & c+ceps_1)
      u156_34(i1,i2)%c(2,1)=u156_34(i1,i2)%c(2,1)+zcl(id1)*(-cau
     & xc+ceps_1)
      u156_34(i1,i2)%d(1,1)=u156_34(i1,i2)%d(1,1)+zcl(id1)*cz34(
     & i1,i2)%ek0
      u156_34(i1,i2)%d(2,2)=u156_34(i1,i2)%d(2,2)+zcr(id1)*cz34(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.id3.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p156,qd=p278,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p156k0*p278(2)+p278k0*p156(2)
      cauxa=auxa-cim*(p278(3)*p156k0-p156(3)*p278k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p278k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p156k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u156_34(i1,i2)%a(i3,i4)=ch34(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u156_34(i1,i2)%b(i3,i4)=ch34(i1,i2)
     &                 *clineth%b(i3,i4)
                  u156_34(i1,i2)%c(i3,i4)=ch34(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u156_34(i1,i2)%a(i3,i4)=czero
                else
                  u156_34(i1,i2)%b(i3,i4)=czero
                  u156_34(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id1).ne.1) then
* quqd -- p=p156,q=p234
      quqd=p156(0)*p234(0)-p156(1)*p234(1)-p156(2)*p234(2)-p156(
     & 3)*p234(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p156,qd=p234,v=cf78(i1,i2)%e,a=u156_78(i1,i2)%a,b=u156_78(i1,i
* 2)%b,c=u156_78(i1,i2)%c,d=u156_78(i1,i2)%d,cr=fcr(id1),cl=fcl(id1),nsu
* m=0
      ceps_0=-cf78(i1,i2)%ek0*(p156(2)*p234(3)-p234(2)*p156(3))+
     & p156k0*(cf78(i1,i2)%e(2)*p234(3)-p234(2)*cf78(i1,i2)%e(3)
     & )-p234k0*(cf78(i1,i2)%e(2)*p156(3)-p156(2)*cf78(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf78(i1,i2)%e(3)*p156k0+p156(3)*cf78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf78(i1,i2)%e(3)*p234k0+p234(3)*cf78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf78(i1,i2)%e(0)*p156(0)-cf78(i1,i2)%e(1)*p156(1)-cf7
     & 8(i1,i2)%e(2)*p156(2)-cf78(i1,i2)%e(3)*p156(3)
      cvqd=cf78(i1,i2)%e(0)*p234(0)-cf78(i1,i2)%e(1)*p234(1)-cf7
     & 8(i1,i2)%e(2)*p234(2)-cf78(i1,i2)%e(3)*p234(3)
      cauxa=-cf78(i1,i2)%ek0*quqd+p156k0*cvqd+p234k0*cvqu
      cauxb=-cf78(i1,i2)%ek0*p234(2)+p234k0*cf78(i1,i2)%e(2)
      cauxc=+cf78(i1,i2)%ek0*p156(2)-p156k0*cf78(i1,i2)%e(2)
      u156_78(i1,i2)%a(1,1)=fcr(id1)*(cauxa+ceps_0)
      u156_78(i1,i2)%a(2,2)=fcl(id1)*(cauxa-ceps_0)
      u156_78(i1,i2)%b(1,2)=fcl(id1)*(cauxb-ceps_2)
      u156_78(i1,i2)%b(2,1)=fcr(id1)*(-cauxb-ceps_2)
      u156_78(i1,i2)%c(1,2)=fcr(id1)*(cauxc+ceps_1)
      u156_78(i1,i2)%c(2,1)=fcl(id1)*(-cauxc+ceps_1)
      u156_78(i1,i2)%d(1,1)=fcl(id1)*cf78(i1,i2)%ek0
      u156_78(i1,i2)%d(2,2)=fcr(id1)*cf78(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u156_78(i1,i2)%a(iut,jut)=czero
                u156_78(i1,i2)%b(iut,jut)=czero
                u156_78(i1,i2)%c(iut,jut)=czero
                u156_78(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id1).ne.1 .and. ilept(id7).ne.1) then
        do iut=1,2
          do jut=1,2
            ug156_78(iut,jut)%a(1,1) = u156_78(iut,jut)%a(1,1)
     &           /((fcl(id1))*(fcl(id7)))
            ug156_78(iut,jut)%a(2,2) = u156_78(iut,jut)%a(2,2)
     &           /((fcl(id1))*(fcl(id7)))
            ug156_78(iut,jut)%b(1,2) = u156_78(iut,jut)%b(1,2)
     &           /((fcl(id1))*(fcl(id7)))
            ug156_78(iut,jut)%b(2,1) = u156_78(iut,jut)%b(2,1)
     &           /((fcl(id1))*(fcl(id7)))
            ug156_78(iut,jut)%c(1,2) = u156_78(iut,jut)%c(1,2)
     &           /((fcl(id1))*(fcl(id7)))
            ug156_78(iut,jut)%c(2,1) = u156_78(iut,jut)%c(2,1)
     &           /((fcl(id1))*(fcl(id7)))
            ug156_78(iut,jut)%d(1,1) = u156_78(iut,jut)%d(1,1)
     &           /((fcl(id1))*(fcl(id7)))
            ug156_78(iut,jut)%d(2,2) = u156_78(iut,jut)%d(2,2)
     &           /((fcl(id1))*(fcl(id7)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug156_78(iut,jut)%a(1,1) = czero
            ug156_78(iut,jut)%a(2,2) = czero
            ug156_78(iut,jut)%b(1,2) = czero
            ug156_78(iut,jut)%b(2,1) = czero
            ug156_78(iut,jut)%c(1,2) = czero
            ug156_78(iut,jut)%c(2,1) = czero
            ug156_78(iut,jut)%d(1,1) = czero
            ug156_78(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p156,q=p234
      quqd=p156(0)*p234(0)-p156(1)*p234(1)-p156(2)*p234(2)-p156(
     & 3)*p234(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p156,qd=p234,v=cz78(i1,i2)%e,a=u156_78(i1,i2)%a,b=u156_78(i1,i
* 2)%b,c=u156_78(i1,i2)%c,d=u156_78(i1,i2)%d,cr=zcr(id1),cl=zcl(id1),nsu
* m=1
      ceps_0=-cz78(i1,i2)%ek0*(p156(2)*p234(3)-p234(2)*p156(3))+
     & p156k0*(cz78(i1,i2)%e(2)*p234(3)-p234(2)*cz78(i1,i2)%e(3)
     & )-p234k0*(cz78(i1,i2)%e(2)*p156(3)-p156(2)*cz78(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz78(i1,i2)%e(3)*p156k0+p156(3)*cz78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz78(i1,i2)%e(3)*p234k0+p234(3)*cz78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz78(i1,i2)%e(0)*p156(0)-cz78(i1,i2)%e(1)*p156(1)-cz7
     & 8(i1,i2)%e(2)*p156(2)-cz78(i1,i2)%e(3)*p156(3)
      cvqd=cz78(i1,i2)%e(0)*p234(0)-cz78(i1,i2)%e(1)*p234(1)-cz7
     & 8(i1,i2)%e(2)*p234(2)-cz78(i1,i2)%e(3)*p234(3)
      cauxa=-cz78(i1,i2)%ek0*quqd+p156k0*cvqd+p234k0*cvqu
      cauxb=-cz78(i1,i2)%ek0*p234(2)+p234k0*cz78(i1,i2)%e(2)
      cauxc=+cz78(i1,i2)%ek0*p156(2)-p156k0*cz78(i1,i2)%e(2)
      u156_78(i1,i2)%a(1,1)=u156_78(i1,i2)%a(1,1)+zcr(id1)*(caux
     & a+ceps_0)
      u156_78(i1,i2)%a(2,2)=u156_78(i1,i2)%a(2,2)+zcl(id1)*(caux
     & a-ceps_0)
      u156_78(i1,i2)%b(1,2)=u156_78(i1,i2)%b(1,2)+zcl(id1)*(caux
     & b-ceps_2)
      u156_78(i1,i2)%b(2,1)=u156_78(i1,i2)%b(2,1)+zcr(id1)*(-cau
     & xb-ceps_2)
      u156_78(i1,i2)%c(1,2)=u156_78(i1,i2)%c(1,2)+zcr(id1)*(caux
     & c+ceps_1)
      u156_78(i1,i2)%c(2,1)=u156_78(i1,i2)%c(2,1)+zcl(id1)*(-cau
     & xc+ceps_1)
      u156_78(i1,i2)%d(1,1)=u156_78(i1,i2)%d(1,1)+zcl(id1)*cz78(
     & i1,i2)%ek0
      u156_78(i1,i2)%d(2,2)=u156_78(i1,i2)%d(2,2)+zcr(id1)*cz78(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.id7.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p156,qd=p234,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p156k0*p234(2)+p234k0*p156(2)
      cauxa=auxa-cim*(p234(3)*p156k0-p156(3)*p234k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p234k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p156k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u156_78(i1,i2)%a(i3,i4)=ch78(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u156_78(i1,i2)%b(i3,i4)=ch78(i1,i2)
     &                 *clineth%b(i3,i4)
                  u156_78(i1,i2)%c(i3,i4)=ch78(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u156_78(i1,i2)%a(i3,i4)=czero
                else
                  u156_78(i1,i2)%b(i3,i4)=czero
                  u156_78(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id1).ne.1) then
* quqd -- p=p178,q=p256
      quqd=p178(0)*p256(0)-p178(1)*p256(1)-p178(2)*p256(2)-p178(
     & 3)*p256(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p178,qd=p256,v=cf34(i1,i2)%e,a=u178_34(i1,i2)%a,b=u178_34(i1,i
* 2)%b,c=u178_34(i1,i2)%c,d=u178_34(i1,i2)%d,cr=fcr(id1),cl=fcl(id1),nsu
* m=0
      ceps_0=-cf34(i1,i2)%ek0*(p178(2)*p256(3)-p256(2)*p178(3))+
     & p178k0*(cf34(i1,i2)%e(2)*p256(3)-p256(2)*cf34(i1,i2)%e(3)
     & )-p256k0*(cf34(i1,i2)%e(2)*p178(3)-p178(2)*cf34(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf34(i1,i2)%e(3)*p178k0+p178(3)*cf34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf34(i1,i2)%e(3)*p256k0+p256(3)*cf34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf34(i1,i2)%e(0)*p178(0)-cf34(i1,i2)%e(1)*p178(1)-cf3
     & 4(i1,i2)%e(2)*p178(2)-cf34(i1,i2)%e(3)*p178(3)
      cvqd=cf34(i1,i2)%e(0)*p256(0)-cf34(i1,i2)%e(1)*p256(1)-cf3
     & 4(i1,i2)%e(2)*p256(2)-cf34(i1,i2)%e(3)*p256(3)
      cauxa=-cf34(i1,i2)%ek0*quqd+p178k0*cvqd+p256k0*cvqu
      cauxb=-cf34(i1,i2)%ek0*p256(2)+p256k0*cf34(i1,i2)%e(2)
      cauxc=+cf34(i1,i2)%ek0*p178(2)-p178k0*cf34(i1,i2)%e(2)
      u178_34(i1,i2)%a(1,1)=fcr(id1)*(cauxa+ceps_0)
      u178_34(i1,i2)%a(2,2)=fcl(id1)*(cauxa-ceps_0)
      u178_34(i1,i2)%b(1,2)=fcl(id1)*(cauxb-ceps_2)
      u178_34(i1,i2)%b(2,1)=fcr(id1)*(-cauxb-ceps_2)
      u178_34(i1,i2)%c(1,2)=fcr(id1)*(cauxc+ceps_1)
      u178_34(i1,i2)%c(2,1)=fcl(id1)*(-cauxc+ceps_1)
      u178_34(i1,i2)%d(1,1)=fcl(id1)*cf34(i1,i2)%ek0
      u178_34(i1,i2)%d(2,2)=fcr(id1)*cf34(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u178_34(i1,i2)%a(iut,jut)=czero
                u178_34(i1,i2)%b(iut,jut)=czero
                u178_34(i1,i2)%c(iut,jut)=czero
                u178_34(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id1).ne.1 .and. ilept(id3).ne.1) then
        do iut=1,2
          do jut=1,2
            ug178_34(iut,jut)%a(1,1) = u178_34(iut,jut)%a(1,1)
     &           /((fcl(id1))*(fcl(id3)))
            ug178_34(iut,jut)%a(2,2) = u178_34(iut,jut)%a(2,2)
     &           /((fcl(id1))*(fcl(id3)))
            ug178_34(iut,jut)%b(1,2) = u178_34(iut,jut)%b(1,2)
     &           /((fcl(id1))*(fcl(id3)))
            ug178_34(iut,jut)%b(2,1) = u178_34(iut,jut)%b(2,1)
     &           /((fcl(id1))*(fcl(id3)))
            ug178_34(iut,jut)%c(1,2) = u178_34(iut,jut)%c(1,2)
     &           /((fcl(id1))*(fcl(id3)))
            ug178_34(iut,jut)%c(2,1) = u178_34(iut,jut)%c(2,1)
     &           /((fcl(id1))*(fcl(id3)))
            ug178_34(iut,jut)%d(1,1) = u178_34(iut,jut)%d(1,1)
     &           /((fcl(id1))*(fcl(id3)))
            ug178_34(iut,jut)%d(2,2) = u178_34(iut,jut)%d(2,2)
     &           /((fcl(id1))*(fcl(id3)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug178_34(iut,jut)%a(1,1) = czero
            ug178_34(iut,jut)%a(2,2) = czero
            ug178_34(iut,jut)%b(1,2) = czero
            ug178_34(iut,jut)%b(2,1) = czero
            ug178_34(iut,jut)%c(1,2) = czero
            ug178_34(iut,jut)%c(2,1) = czero
            ug178_34(iut,jut)%d(1,1) = czero
            ug178_34(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p178,q=p256
      quqd=p178(0)*p256(0)-p178(1)*p256(1)-p178(2)*p256(2)-p178(
     & 3)*p256(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p178,qd=p256,v=cz34(i1,i2)%e,a=u178_34(i1,i2)%a,b=u178_34(i1,i
* 2)%b,c=u178_34(i1,i2)%c,d=u178_34(i1,i2)%d,cr=zcr(id1),cl=zcl(id1),nsu
* m=1
      ceps_0=-cz34(i1,i2)%ek0*(p178(2)*p256(3)-p256(2)*p178(3))+
     & p178k0*(cz34(i1,i2)%e(2)*p256(3)-p256(2)*cz34(i1,i2)%e(3)
     & )-p256k0*(cz34(i1,i2)%e(2)*p178(3)-p178(2)*cz34(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz34(i1,i2)%e(3)*p178k0+p178(3)*cz34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz34(i1,i2)%e(3)*p256k0+p256(3)*cz34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz34(i1,i2)%e(0)*p178(0)-cz34(i1,i2)%e(1)*p178(1)-cz3
     & 4(i1,i2)%e(2)*p178(2)-cz34(i1,i2)%e(3)*p178(3)
      cvqd=cz34(i1,i2)%e(0)*p256(0)-cz34(i1,i2)%e(1)*p256(1)-cz3
     & 4(i1,i2)%e(2)*p256(2)-cz34(i1,i2)%e(3)*p256(3)
      cauxa=-cz34(i1,i2)%ek0*quqd+p178k0*cvqd+p256k0*cvqu
      cauxb=-cz34(i1,i2)%ek0*p256(2)+p256k0*cz34(i1,i2)%e(2)
      cauxc=+cz34(i1,i2)%ek0*p178(2)-p178k0*cz34(i1,i2)%e(2)
      u178_34(i1,i2)%a(1,1)=u178_34(i1,i2)%a(1,1)+zcr(id1)*(caux
     & a+ceps_0)
      u178_34(i1,i2)%a(2,2)=u178_34(i1,i2)%a(2,2)+zcl(id1)*(caux
     & a-ceps_0)
      u178_34(i1,i2)%b(1,2)=u178_34(i1,i2)%b(1,2)+zcl(id1)*(caux
     & b-ceps_2)
      u178_34(i1,i2)%b(2,1)=u178_34(i1,i2)%b(2,1)+zcr(id1)*(-cau
     & xb-ceps_2)
      u178_34(i1,i2)%c(1,2)=u178_34(i1,i2)%c(1,2)+zcr(id1)*(caux
     & c+ceps_1)
      u178_34(i1,i2)%c(2,1)=u178_34(i1,i2)%c(2,1)+zcl(id1)*(-cau
     & xc+ceps_1)
      u178_34(i1,i2)%d(1,1)=u178_34(i1,i2)%d(1,1)+zcl(id1)*cz34(
     & i1,i2)%ek0
      u178_34(i1,i2)%d(2,2)=u178_34(i1,i2)%d(2,2)+zcr(id1)*cz34(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.id3.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p178,qd=p256,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p178k0*p256(2)+p256k0*p178(2)
      cauxa=auxa-cim*(p256(3)*p178k0-p178(3)*p256k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p256k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p178k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u178_34(i1,i2)%a(i3,i4)=ch34(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u178_34(i1,i2)%b(i3,i4)=ch34(i1,i2)
     &                 *clineth%b(i3,i4)
                  u178_34(i1,i2)%c(i3,i4)=ch34(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u178_34(i1,i2)%a(i3,i4)=czero
                else
                  u178_34(i1,i2)%b(i3,i4)=czero
                  u178_34(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id1).ne.1) then
* quqd -- p=p178,q=p234
      quqd=p178(0)*p234(0)-p178(1)*p234(1)-p178(2)*p234(2)-p178(
     & 3)*p234(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p178,qd=p234,v=cf56(i1,i2)%e,a=u178_56(i1,i2)%a,b=u178_56(i1,i
* 2)%b,c=u178_56(i1,i2)%c,d=u178_56(i1,i2)%d,cr=fcr(id1),cl=fcl(id1),nsu
* m=0
      ceps_0=-cf56(i1,i2)%ek0*(p178(2)*p234(3)-p234(2)*p178(3))+
     & p178k0*(cf56(i1,i2)%e(2)*p234(3)-p234(2)*cf56(i1,i2)%e(3)
     & )-p234k0*(cf56(i1,i2)%e(2)*p178(3)-p178(2)*cf56(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf56(i1,i2)%e(3)*p178k0+p178(3)*cf56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf56(i1,i2)%e(3)*p234k0+p234(3)*cf56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf56(i1,i2)%e(0)*p178(0)-cf56(i1,i2)%e(1)*p178(1)-cf5
     & 6(i1,i2)%e(2)*p178(2)-cf56(i1,i2)%e(3)*p178(3)
      cvqd=cf56(i1,i2)%e(0)*p234(0)-cf56(i1,i2)%e(1)*p234(1)-cf5
     & 6(i1,i2)%e(2)*p234(2)-cf56(i1,i2)%e(3)*p234(3)
      cauxa=-cf56(i1,i2)%ek0*quqd+p178k0*cvqd+p234k0*cvqu
      cauxb=-cf56(i1,i2)%ek0*p234(2)+p234k0*cf56(i1,i2)%e(2)
      cauxc=+cf56(i1,i2)%ek0*p178(2)-p178k0*cf56(i1,i2)%e(2)
      u178_56(i1,i2)%a(1,1)=fcr(id1)*(cauxa+ceps_0)
      u178_56(i1,i2)%a(2,2)=fcl(id1)*(cauxa-ceps_0)
      u178_56(i1,i2)%b(1,2)=fcl(id1)*(cauxb-ceps_2)
      u178_56(i1,i2)%b(2,1)=fcr(id1)*(-cauxb-ceps_2)
      u178_56(i1,i2)%c(1,2)=fcr(id1)*(cauxc+ceps_1)
      u178_56(i1,i2)%c(2,1)=fcl(id1)*(-cauxc+ceps_1)
      u178_56(i1,i2)%d(1,1)=fcl(id1)*cf56(i1,i2)%ek0
      u178_56(i1,i2)%d(2,2)=fcr(id1)*cf56(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u178_56(i1,i2)%a(iut,jut)=czero
                u178_56(i1,i2)%b(iut,jut)=czero
                u178_56(i1,i2)%c(iut,jut)=czero
                u178_56(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id1).ne.1 .and. ilept(id5).ne.1) then
        do iut=1,2
          do jut=1,2
            ug178_56(iut,jut)%a(1,1) = u178_56(iut,jut)%a(1,1)
     &           /((fcl(id1))*(fcl(id5)))
            ug178_56(iut,jut)%a(2,2) = u178_56(iut,jut)%a(2,2)
     &           /((fcl(id1))*(fcl(id5)))
            ug178_56(iut,jut)%b(1,2) = u178_56(iut,jut)%b(1,2)
     &           /((fcl(id1))*(fcl(id5)))
            ug178_56(iut,jut)%b(2,1) = u178_56(iut,jut)%b(2,1)
     &           /((fcl(id1))*(fcl(id5)))
            ug178_56(iut,jut)%c(1,2) = u178_56(iut,jut)%c(1,2)
     &           /((fcl(id1))*(fcl(id5)))
            ug178_56(iut,jut)%c(2,1) = u178_56(iut,jut)%c(2,1)
     &           /((fcl(id1))*(fcl(id5)))
            ug178_56(iut,jut)%d(1,1) = u178_56(iut,jut)%d(1,1)
     &           /((fcl(id1))*(fcl(id5)))
            ug178_56(iut,jut)%d(2,2) = u178_56(iut,jut)%d(2,2)
     &           /((fcl(id1))*(fcl(id5)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug178_56(iut,jut)%a(1,1) = czero
            ug178_56(iut,jut)%a(2,2) = czero
            ug178_56(iut,jut)%b(1,2) = czero
            ug178_56(iut,jut)%b(2,1) = czero
            ug178_56(iut,jut)%c(1,2) = czero
            ug178_56(iut,jut)%c(2,1) = czero
            ug178_56(iut,jut)%d(1,1) = czero
            ug178_56(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p178,q=p234
      quqd=p178(0)*p234(0)-p178(1)*p234(1)-p178(2)*p234(2)-p178(
     & 3)*p234(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p178,qd=p234,v=cz56(i1,i2)%e,a=u178_56(i1,i2)%a,b=u178_56(i1,i
* 2)%b,c=u178_56(i1,i2)%c,d=u178_56(i1,i2)%d,cr=zcr(id1),cl=zcl(id1),nsu
* m=1
      ceps_0=-cz56(i1,i2)%ek0*(p178(2)*p234(3)-p234(2)*p178(3))+
     & p178k0*(cz56(i1,i2)%e(2)*p234(3)-p234(2)*cz56(i1,i2)%e(3)
     & )-p234k0*(cz56(i1,i2)%e(2)*p178(3)-p178(2)*cz56(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz56(i1,i2)%e(3)*p178k0+p178(3)*cz56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz56(i1,i2)%e(3)*p234k0+p234(3)*cz56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz56(i1,i2)%e(0)*p178(0)-cz56(i1,i2)%e(1)*p178(1)-cz5
     & 6(i1,i2)%e(2)*p178(2)-cz56(i1,i2)%e(3)*p178(3)
      cvqd=cz56(i1,i2)%e(0)*p234(0)-cz56(i1,i2)%e(1)*p234(1)-cz5
     & 6(i1,i2)%e(2)*p234(2)-cz56(i1,i2)%e(3)*p234(3)
      cauxa=-cz56(i1,i2)%ek0*quqd+p178k0*cvqd+p234k0*cvqu
      cauxb=-cz56(i1,i2)%ek0*p234(2)+p234k0*cz56(i1,i2)%e(2)
      cauxc=+cz56(i1,i2)%ek0*p178(2)-p178k0*cz56(i1,i2)%e(2)
      u178_56(i1,i2)%a(1,1)=u178_56(i1,i2)%a(1,1)+zcr(id1)*(caux
     & a+ceps_0)
      u178_56(i1,i2)%a(2,2)=u178_56(i1,i2)%a(2,2)+zcl(id1)*(caux
     & a-ceps_0)
      u178_56(i1,i2)%b(1,2)=u178_56(i1,i2)%b(1,2)+zcl(id1)*(caux
     & b-ceps_2)
      u178_56(i1,i2)%b(2,1)=u178_56(i1,i2)%b(2,1)+zcr(id1)*(-cau
     & xb-ceps_2)
      u178_56(i1,i2)%c(1,2)=u178_56(i1,i2)%c(1,2)+zcr(id1)*(caux
     & c+ceps_1)
      u178_56(i1,i2)%c(2,1)=u178_56(i1,i2)%c(2,1)+zcl(id1)*(-cau
     & xc+ceps_1)
      u178_56(i1,i2)%d(1,1)=u178_56(i1,i2)%d(1,1)+zcl(id1)*cz56(
     & i1,i2)%ek0
      u178_56(i1,i2)%d(2,2)=u178_56(i1,i2)%d(2,2)+zcr(id1)*cz56(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.id5.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p178,qd=p234,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p178k0*p234(2)+p234k0*p178(2)
      cauxa=auxa-cim*(p234(3)*p178k0-p178(3)*p234k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p234k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p178k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u178_56(i1,i2)%a(i3,i4)=ch56(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u178_56(i1,i2)%b(i3,i4)=ch56(i1,i2)
     &                 *clineth%b(i3,i4)
                  u178_56(i1,i2)%c(i3,i4)=ch56(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u178_56(i1,i2)%a(i3,i4)=czero
                else
                  u178_56(i1,i2)%b(i3,i4)=czero
                  u178_56(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id3).ne.1) then
* quqd -- p=p312,q=p478
      quqd=p312(0)*p478(0)-p312(1)*p478(1)-p312(2)*p478(2)-p312(
     & 3)*p478(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p312,qd=p478,v=cf56(i1,i2)%e,a=u312_56(i1,i2)%a,b=u312_56(i1,i
* 2)%b,c=u312_56(i1,i2)%c,d=u312_56(i1,i2)%d,cr=fcr(id3),cl=fcl(id3),nsu
* m=0
      ceps_0=-cf56(i1,i2)%ek0*(p312(2)*p478(3)-p478(2)*p312(3))+
     & p312k0*(cf56(i1,i2)%e(2)*p478(3)-p478(2)*cf56(i1,i2)%e(3)
     & )-p478k0*(cf56(i1,i2)%e(2)*p312(3)-p312(2)*cf56(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf56(i1,i2)%e(3)*p312k0+p312(3)*cf56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf56(i1,i2)%e(3)*p478k0+p478(3)*cf56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf56(i1,i2)%e(0)*p312(0)-cf56(i1,i2)%e(1)*p312(1)-cf5
     & 6(i1,i2)%e(2)*p312(2)-cf56(i1,i2)%e(3)*p312(3)
      cvqd=cf56(i1,i2)%e(0)*p478(0)-cf56(i1,i2)%e(1)*p478(1)-cf5
     & 6(i1,i2)%e(2)*p478(2)-cf56(i1,i2)%e(3)*p478(3)
      cauxa=-cf56(i1,i2)%ek0*quqd+p312k0*cvqd+p478k0*cvqu
      cauxb=-cf56(i1,i2)%ek0*p478(2)+p478k0*cf56(i1,i2)%e(2)
      cauxc=+cf56(i1,i2)%ek0*p312(2)-p312k0*cf56(i1,i2)%e(2)
      u312_56(i1,i2)%a(1,1)=fcr(id3)*(cauxa+ceps_0)
      u312_56(i1,i2)%a(2,2)=fcl(id3)*(cauxa-ceps_0)
      u312_56(i1,i2)%b(1,2)=fcl(id3)*(cauxb-ceps_2)
      u312_56(i1,i2)%b(2,1)=fcr(id3)*(-cauxb-ceps_2)
      u312_56(i1,i2)%c(1,2)=fcr(id3)*(cauxc+ceps_1)
      u312_56(i1,i2)%c(2,1)=fcl(id3)*(-cauxc+ceps_1)
      u312_56(i1,i2)%d(1,1)=fcl(id3)*cf56(i1,i2)%ek0
      u312_56(i1,i2)%d(2,2)=fcr(id3)*cf56(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u312_56(i1,i2)%a(iut,jut)=czero
                u312_56(i1,i2)%b(iut,jut)=czero
                u312_56(i1,i2)%c(iut,jut)=czero
                u312_56(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id3).ne.1 .and. ilept(id5).ne.1) then
        do iut=1,2
          do jut=1,2
            ug312_56(iut,jut)%a(1,1) = u312_56(iut,jut)%a(1,1)
     &           /((fcl(id3))*(fcl(id5)))
            ug312_56(iut,jut)%a(2,2) = u312_56(iut,jut)%a(2,2)
     &           /((fcl(id3))*(fcl(id5)))
            ug312_56(iut,jut)%b(1,2) = u312_56(iut,jut)%b(1,2)
     &           /((fcl(id3))*(fcl(id5)))
            ug312_56(iut,jut)%b(2,1) = u312_56(iut,jut)%b(2,1)
     &           /((fcl(id3))*(fcl(id5)))
            ug312_56(iut,jut)%c(1,2) = u312_56(iut,jut)%c(1,2)
     &           /((fcl(id3))*(fcl(id5)))
            ug312_56(iut,jut)%c(2,1) = u312_56(iut,jut)%c(2,1)
     &           /((fcl(id3))*(fcl(id5)))
            ug312_56(iut,jut)%d(1,1) = u312_56(iut,jut)%d(1,1)
     &           /((fcl(id3))*(fcl(id5)))
            ug312_56(iut,jut)%d(2,2) = u312_56(iut,jut)%d(2,2)
     &           /((fcl(id3))*(fcl(id5)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug312_56(iut,jut)%a(1,1) = czero
            ug312_56(iut,jut)%a(2,2) = czero
            ug312_56(iut,jut)%b(1,2) = czero
            ug312_56(iut,jut)%b(2,1) = czero
            ug312_56(iut,jut)%c(1,2) = czero
            ug312_56(iut,jut)%c(2,1) = czero
            ug312_56(iut,jut)%d(1,1) = czero
            ug312_56(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p312,q=p478
      quqd=p312(0)*p478(0)-p312(1)*p478(1)-p312(2)*p478(2)-p312(
     & 3)*p478(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p312,qd=p478,v=cz56(i1,i2)%e,a=u312_56(i1,i2)%a,b=u312_56(i1,i
* 2)%b,c=u312_56(i1,i2)%c,d=u312_56(i1,i2)%d,cr=zcr(id3),cl=zcl(id3),nsu
* m=1
      ceps_0=-cz56(i1,i2)%ek0*(p312(2)*p478(3)-p478(2)*p312(3))+
     & p312k0*(cz56(i1,i2)%e(2)*p478(3)-p478(2)*cz56(i1,i2)%e(3)
     & )-p478k0*(cz56(i1,i2)%e(2)*p312(3)-p312(2)*cz56(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz56(i1,i2)%e(3)*p312k0+p312(3)*cz56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz56(i1,i2)%e(3)*p478k0+p478(3)*cz56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz56(i1,i2)%e(0)*p312(0)-cz56(i1,i2)%e(1)*p312(1)-cz5
     & 6(i1,i2)%e(2)*p312(2)-cz56(i1,i2)%e(3)*p312(3)
      cvqd=cz56(i1,i2)%e(0)*p478(0)-cz56(i1,i2)%e(1)*p478(1)-cz5
     & 6(i1,i2)%e(2)*p478(2)-cz56(i1,i2)%e(3)*p478(3)
      cauxa=-cz56(i1,i2)%ek0*quqd+p312k0*cvqd+p478k0*cvqu
      cauxb=-cz56(i1,i2)%ek0*p478(2)+p478k0*cz56(i1,i2)%e(2)
      cauxc=+cz56(i1,i2)%ek0*p312(2)-p312k0*cz56(i1,i2)%e(2)
      u312_56(i1,i2)%a(1,1)=u312_56(i1,i2)%a(1,1)+zcr(id3)*(caux
     & a+ceps_0)
      u312_56(i1,i2)%a(2,2)=u312_56(i1,i2)%a(2,2)+zcl(id3)*(caux
     & a-ceps_0)
      u312_56(i1,i2)%b(1,2)=u312_56(i1,i2)%b(1,2)+zcl(id3)*(caux
     & b-ceps_2)
      u312_56(i1,i2)%b(2,1)=u312_56(i1,i2)%b(2,1)+zcr(id3)*(-cau
     & xb-ceps_2)
      u312_56(i1,i2)%c(1,2)=u312_56(i1,i2)%c(1,2)+zcr(id3)*(caux
     & c+ceps_1)
      u312_56(i1,i2)%c(2,1)=u312_56(i1,i2)%c(2,1)+zcl(id3)*(-cau
     & xc+ceps_1)
      u312_56(i1,i2)%d(1,1)=u312_56(i1,i2)%d(1,1)+zcl(id3)*cz56(
     & i1,i2)%ek0
      u312_56(i1,i2)%d(2,2)=u312_56(i1,i2)%d(2,2)+zcr(id3)*cz56(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.id5.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p312,qd=p478,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p312k0*p478(2)+p478k0*p312(2)
      cauxa=auxa-cim*(p478(3)*p312k0-p312(3)*p478k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p478k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p312k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u312_56(i1,i2)%a(i3,i4)=ch56(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u312_56(i1,i2)%b(i3,i4)=ch56(i1,i2)
     &                 *clineth%b(i3,i4)
                  u312_56(i1,i2)%c(i3,i4)=ch56(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u312_56(i1,i2)%a(i3,i4)=czero
                else
                  u312_56(i1,i2)%b(i3,i4)=czero
                  u312_56(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id3).ne.1) then
* quqd -- p=p312,q=p456
      quqd=p312(0)*p456(0)-p312(1)*p456(1)-p312(2)*p456(2)-p312(
     & 3)*p456(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p312,qd=p456,v=cf78(i1,i2)%e,a=u312_78(i1,i2)%a,b=u312_78(i1,i
* 2)%b,c=u312_78(i1,i2)%c,d=u312_78(i1,i2)%d,cr=fcr(id3),cl=fcl(id3),nsu
* m=0
      ceps_0=-cf78(i1,i2)%ek0*(p312(2)*p456(3)-p456(2)*p312(3))+
     & p312k0*(cf78(i1,i2)%e(2)*p456(3)-p456(2)*cf78(i1,i2)%e(3)
     & )-p456k0*(cf78(i1,i2)%e(2)*p312(3)-p312(2)*cf78(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf78(i1,i2)%e(3)*p312k0+p312(3)*cf78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf78(i1,i2)%e(3)*p456k0+p456(3)*cf78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf78(i1,i2)%e(0)*p312(0)-cf78(i1,i2)%e(1)*p312(1)-cf7
     & 8(i1,i2)%e(2)*p312(2)-cf78(i1,i2)%e(3)*p312(3)
      cvqd=cf78(i1,i2)%e(0)*p456(0)-cf78(i1,i2)%e(1)*p456(1)-cf7
     & 8(i1,i2)%e(2)*p456(2)-cf78(i1,i2)%e(3)*p456(3)
      cauxa=-cf78(i1,i2)%ek0*quqd+p312k0*cvqd+p456k0*cvqu
      cauxb=-cf78(i1,i2)%ek0*p456(2)+p456k0*cf78(i1,i2)%e(2)
      cauxc=+cf78(i1,i2)%ek0*p312(2)-p312k0*cf78(i1,i2)%e(2)
      u312_78(i1,i2)%a(1,1)=fcr(id3)*(cauxa+ceps_0)
      u312_78(i1,i2)%a(2,2)=fcl(id3)*(cauxa-ceps_0)
      u312_78(i1,i2)%b(1,2)=fcl(id3)*(cauxb-ceps_2)
      u312_78(i1,i2)%b(2,1)=fcr(id3)*(-cauxb-ceps_2)
      u312_78(i1,i2)%c(1,2)=fcr(id3)*(cauxc+ceps_1)
      u312_78(i1,i2)%c(2,1)=fcl(id3)*(-cauxc+ceps_1)
      u312_78(i1,i2)%d(1,1)=fcl(id3)*cf78(i1,i2)%ek0
      u312_78(i1,i2)%d(2,2)=fcr(id3)*cf78(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u312_78(i1,i2)%a(iut,jut)=czero
                u312_78(i1,i2)%b(iut,jut)=czero
                u312_78(i1,i2)%c(iut,jut)=czero
                u312_78(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id3).ne.1 .and. ilept(id7).ne.1) then
        do iut=1,2
          do jut=1,2
            ug312_78(iut,jut)%a(1,1) = u312_78(iut,jut)%a(1,1)
     &           /((fcl(id3))*(fcl(id7)))
            ug312_78(iut,jut)%a(2,2) = u312_78(iut,jut)%a(2,2)
     &           /((fcl(id3))*(fcl(id7)))
            ug312_78(iut,jut)%b(1,2) = u312_78(iut,jut)%b(1,2)
     &           /((fcl(id3))*(fcl(id7)))
            ug312_78(iut,jut)%b(2,1) = u312_78(iut,jut)%b(2,1)
     &           /((fcl(id3))*(fcl(id7)))
            ug312_78(iut,jut)%c(1,2) = u312_78(iut,jut)%c(1,2)
     &           /((fcl(id3))*(fcl(id7)))
            ug312_78(iut,jut)%c(2,1) = u312_78(iut,jut)%c(2,1)
     &           /((fcl(id3))*(fcl(id7)))
            ug312_78(iut,jut)%d(1,1) = u312_78(iut,jut)%d(1,1)
     &           /((fcl(id3))*(fcl(id7)))
            ug312_78(iut,jut)%d(2,2) = u312_78(iut,jut)%d(2,2)
     &           /((fcl(id3))*(fcl(id7)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug312_78(iut,jut)%a(1,1) = czero
            ug312_78(iut,jut)%a(2,2) = czero
            ug312_78(iut,jut)%b(1,2) = czero
            ug312_78(iut,jut)%b(2,1) = czero
            ug312_78(iut,jut)%c(1,2) = czero
            ug312_78(iut,jut)%c(2,1) = czero
            ug312_78(iut,jut)%d(1,1) = czero
            ug312_78(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p312,q=p456
      quqd=p312(0)*p456(0)-p312(1)*p456(1)-p312(2)*p456(2)-p312(
     & 3)*p456(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p312,qd=p456,v=cz78(i1,i2)%e,a=u312_78(i1,i2)%a,b=u312_78(i1,i
* 2)%b,c=u312_78(i1,i2)%c,d=u312_78(i1,i2)%d,cr=zcr(id3),cl=zcl(id3),nsu
* m=1
      ceps_0=-cz78(i1,i2)%ek0*(p312(2)*p456(3)-p456(2)*p312(3))+
     & p312k0*(cz78(i1,i2)%e(2)*p456(3)-p456(2)*cz78(i1,i2)%e(3)
     & )-p456k0*(cz78(i1,i2)%e(2)*p312(3)-p312(2)*cz78(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz78(i1,i2)%e(3)*p312k0+p312(3)*cz78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz78(i1,i2)%e(3)*p456k0+p456(3)*cz78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz78(i1,i2)%e(0)*p312(0)-cz78(i1,i2)%e(1)*p312(1)-cz7
     & 8(i1,i2)%e(2)*p312(2)-cz78(i1,i2)%e(3)*p312(3)
      cvqd=cz78(i1,i2)%e(0)*p456(0)-cz78(i1,i2)%e(1)*p456(1)-cz7
     & 8(i1,i2)%e(2)*p456(2)-cz78(i1,i2)%e(3)*p456(3)
      cauxa=-cz78(i1,i2)%ek0*quqd+p312k0*cvqd+p456k0*cvqu
      cauxb=-cz78(i1,i2)%ek0*p456(2)+p456k0*cz78(i1,i2)%e(2)
      cauxc=+cz78(i1,i2)%ek0*p312(2)-p312k0*cz78(i1,i2)%e(2)
      u312_78(i1,i2)%a(1,1)=u312_78(i1,i2)%a(1,1)+zcr(id3)*(caux
     & a+ceps_0)
      u312_78(i1,i2)%a(2,2)=u312_78(i1,i2)%a(2,2)+zcl(id3)*(caux
     & a-ceps_0)
      u312_78(i1,i2)%b(1,2)=u312_78(i1,i2)%b(1,2)+zcl(id3)*(caux
     & b-ceps_2)
      u312_78(i1,i2)%b(2,1)=u312_78(i1,i2)%b(2,1)+zcr(id3)*(-cau
     & xb-ceps_2)
      u312_78(i1,i2)%c(1,2)=u312_78(i1,i2)%c(1,2)+zcr(id3)*(caux
     & c+ceps_1)
      u312_78(i1,i2)%c(2,1)=u312_78(i1,i2)%c(2,1)+zcl(id3)*(-cau
     & xc+ceps_1)
      u312_78(i1,i2)%d(1,1)=u312_78(i1,i2)%d(1,1)+zcl(id3)*cz78(
     & i1,i2)%ek0
      u312_78(i1,i2)%d(2,2)=u312_78(i1,i2)%d(2,2)+zcr(id3)*cz78(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.id7.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p312,qd=p456,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p312k0*p456(2)+p456k0*p312(2)
      cauxa=auxa-cim*(p456(3)*p312k0-p312(3)*p456k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p456k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p312k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u312_78(i1,i2)%a(i3,i4)=ch78(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u312_78(i1,i2)%b(i3,i4)=ch78(i1,i2)
     &                 *clineth%b(i3,i4)
                  u312_78(i1,i2)%c(i3,i4)=ch78(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u312_78(i1,i2)%a(i3,i4)=czero
                else
                  u312_78(i1,i2)%b(i3,i4)=czero
                  u312_78(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id3).ne.1) then
* quqd -- p=p356,q=p478
      quqd=p356(0)*p478(0)-p356(1)*p478(1)-p356(2)*p478(2)-p356(
     & 3)*p478(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p356,qd=p478,v=cf12(i1,i2)%e,a=u356_12(i1,i2)%a,b=u356_12(i1,i
* 2)%b,c=u356_12(i1,i2)%c,d=u356_12(i1,i2)%d,cr=fcr(id3),cl=fcl(id3),nsu
* m=0
      ceps_0=-cf12(i1,i2)%ek0*(p356(2)*p478(3)-p478(2)*p356(3))+
     & p356k0*(cf12(i1,i2)%e(2)*p478(3)-p478(2)*cf12(i1,i2)%e(3)
     & )-p478k0*(cf12(i1,i2)%e(2)*p356(3)-p356(2)*cf12(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf12(i1,i2)%e(3)*p356k0+p356(3)*cf12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf12(i1,i2)%e(3)*p478k0+p478(3)*cf12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf12(i1,i2)%e(0)*p356(0)-cf12(i1,i2)%e(1)*p356(1)-cf1
     & 2(i1,i2)%e(2)*p356(2)-cf12(i1,i2)%e(3)*p356(3)
      cvqd=cf12(i1,i2)%e(0)*p478(0)-cf12(i1,i2)%e(1)*p478(1)-cf1
     & 2(i1,i2)%e(2)*p478(2)-cf12(i1,i2)%e(3)*p478(3)
      cauxa=-cf12(i1,i2)%ek0*quqd+p356k0*cvqd+p478k0*cvqu
      cauxb=-cf12(i1,i2)%ek0*p478(2)+p478k0*cf12(i1,i2)%e(2)
      cauxc=+cf12(i1,i2)%ek0*p356(2)-p356k0*cf12(i1,i2)%e(2)
      u356_12(i1,i2)%a(1,1)=fcr(id3)*(cauxa+ceps_0)
      u356_12(i1,i2)%a(2,2)=fcl(id3)*(cauxa-ceps_0)
      u356_12(i1,i2)%b(1,2)=fcl(id3)*(cauxb-ceps_2)
      u356_12(i1,i2)%b(2,1)=fcr(id3)*(-cauxb-ceps_2)
      u356_12(i1,i2)%c(1,2)=fcr(id3)*(cauxc+ceps_1)
      u356_12(i1,i2)%c(2,1)=fcl(id3)*(-cauxc+ceps_1)
      u356_12(i1,i2)%d(1,1)=fcl(id3)*cf12(i1,i2)%ek0
      u356_12(i1,i2)%d(2,2)=fcr(id3)*cf12(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u356_12(i1,i2)%a(iut,jut)=czero
                u356_12(i1,i2)%b(iut,jut)=czero
                u356_12(i1,i2)%c(iut,jut)=czero
                u356_12(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id3).ne.1 .and. ilept(id1).ne.1) then
        do iut=1,2
          do jut=1,2
            ug356_12(iut,jut)%a(1,1) = u356_12(iut,jut)%a(1,1)
     &           /((fcl(id3))*(fcl(id1)))
            ug356_12(iut,jut)%a(2,2) = u356_12(iut,jut)%a(2,2)
     &           /((fcl(id3))*(fcl(id1)))
            ug356_12(iut,jut)%b(1,2) = u356_12(iut,jut)%b(1,2)
     &           /((fcl(id3))*(fcl(id1)))
            ug356_12(iut,jut)%b(2,1) = u356_12(iut,jut)%b(2,1)
     &           /((fcl(id3))*(fcl(id1)))
            ug356_12(iut,jut)%c(1,2) = u356_12(iut,jut)%c(1,2)
     &           /((fcl(id3))*(fcl(id1)))
            ug356_12(iut,jut)%c(2,1) = u356_12(iut,jut)%c(2,1)
     &           /((fcl(id3))*(fcl(id1)))
            ug356_12(iut,jut)%d(1,1) = u356_12(iut,jut)%d(1,1)
     &           /((fcl(id3))*(fcl(id1)))
            ug356_12(iut,jut)%d(2,2) = u356_12(iut,jut)%d(2,2)
     &           /((fcl(id3))*(fcl(id1)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug356_12(iut,jut)%a(1,1) = czero
            ug356_12(iut,jut)%a(2,2) = czero
            ug356_12(iut,jut)%b(1,2) = czero
            ug356_12(iut,jut)%b(2,1) = czero
            ug356_12(iut,jut)%c(1,2) = czero
            ug356_12(iut,jut)%c(2,1) = czero
            ug356_12(iut,jut)%d(1,1) = czero
            ug356_12(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p356,q=p478
      quqd=p356(0)*p478(0)-p356(1)*p478(1)-p356(2)*p478(2)-p356(
     & 3)*p478(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p356,qd=p478,v=cz12(i1,i2)%e,a=u356_12(i1,i2)%a,b=u356_12(i1,i
* 2)%b,c=u356_12(i1,i2)%c,d=u356_12(i1,i2)%d,cr=zcr(id3),cl=zcl(id3),nsu
* m=1
      ceps_0=-cz12(i1,i2)%ek0*(p356(2)*p478(3)-p478(2)*p356(3))+
     & p356k0*(cz12(i1,i2)%e(2)*p478(3)-p478(2)*cz12(i1,i2)%e(3)
     & )-p478k0*(cz12(i1,i2)%e(2)*p356(3)-p356(2)*cz12(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz12(i1,i2)%e(3)*p356k0+p356(3)*cz12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz12(i1,i2)%e(3)*p478k0+p478(3)*cz12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz12(i1,i2)%e(0)*p356(0)-cz12(i1,i2)%e(1)*p356(1)-cz1
     & 2(i1,i2)%e(2)*p356(2)-cz12(i1,i2)%e(3)*p356(3)
      cvqd=cz12(i1,i2)%e(0)*p478(0)-cz12(i1,i2)%e(1)*p478(1)-cz1
     & 2(i1,i2)%e(2)*p478(2)-cz12(i1,i2)%e(3)*p478(3)
      cauxa=-cz12(i1,i2)%ek0*quqd+p356k0*cvqd+p478k0*cvqu
      cauxb=-cz12(i1,i2)%ek0*p478(2)+p478k0*cz12(i1,i2)%e(2)
      cauxc=+cz12(i1,i2)%ek0*p356(2)-p356k0*cz12(i1,i2)%e(2)
      u356_12(i1,i2)%a(1,1)=u356_12(i1,i2)%a(1,1)+zcr(id3)*(caux
     & a+ceps_0)
      u356_12(i1,i2)%a(2,2)=u356_12(i1,i2)%a(2,2)+zcl(id3)*(caux
     & a-ceps_0)
      u356_12(i1,i2)%b(1,2)=u356_12(i1,i2)%b(1,2)+zcl(id3)*(caux
     & b-ceps_2)
      u356_12(i1,i2)%b(2,1)=u356_12(i1,i2)%b(2,1)+zcr(id3)*(-cau
     & xb-ceps_2)
      u356_12(i1,i2)%c(1,2)=u356_12(i1,i2)%c(1,2)+zcr(id3)*(caux
     & c+ceps_1)
      u356_12(i1,i2)%c(2,1)=u356_12(i1,i2)%c(2,1)+zcl(id3)*(-cau
     & xc+ceps_1)
      u356_12(i1,i2)%d(1,1)=u356_12(i1,i2)%d(1,1)+zcl(id3)*cz12(
     & i1,i2)%ek0
      u356_12(i1,i2)%d(2,2)=u356_12(i1,i2)%d(2,2)+zcr(id3)*cz12(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.id1.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p356,qd=p478,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p356k0*p478(2)+p478k0*p356(2)
      cauxa=auxa-cim*(p478(3)*p356k0-p356(3)*p478k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p478k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p356k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u356_12(i1,i2)%a(i3,i4)=ch12(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u356_12(i1,i2)%b(i3,i4)=ch12(i1,i2)
     &                 *clineth%b(i3,i4)
                  u356_12(i1,i2)%c(i3,i4)=ch12(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u356_12(i1,i2)%a(i3,i4)=czero
                else
                  u356_12(i1,i2)%b(i3,i4)=czero
                  u356_12(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id3).ne.1) then
* quqd -- p=p356,q=p412
      quqd=p356(0)*p412(0)-p356(1)*p412(1)-p356(2)*p412(2)-p356(
     & 3)*p412(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p356,qd=p412,v=cf78(i1,i2)%e,a=u356_78(i1,i2)%a,b=u356_78(i1,i
* 2)%b,c=u356_78(i1,i2)%c,d=u356_78(i1,i2)%d,cr=fcr(id3),cl=fcl(id3),nsu
* m=0
      ceps_0=-cf78(i1,i2)%ek0*(p356(2)*p412(3)-p412(2)*p356(3))+
     & p356k0*(cf78(i1,i2)%e(2)*p412(3)-p412(2)*cf78(i1,i2)%e(3)
     & )-p412k0*(cf78(i1,i2)%e(2)*p356(3)-p356(2)*cf78(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf78(i1,i2)%e(3)*p356k0+p356(3)*cf78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf78(i1,i2)%e(3)*p412k0+p412(3)*cf78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf78(i1,i2)%e(0)*p356(0)-cf78(i1,i2)%e(1)*p356(1)-cf7
     & 8(i1,i2)%e(2)*p356(2)-cf78(i1,i2)%e(3)*p356(3)
      cvqd=cf78(i1,i2)%e(0)*p412(0)-cf78(i1,i2)%e(1)*p412(1)-cf7
     & 8(i1,i2)%e(2)*p412(2)-cf78(i1,i2)%e(3)*p412(3)
      cauxa=-cf78(i1,i2)%ek0*quqd+p356k0*cvqd+p412k0*cvqu
      cauxb=-cf78(i1,i2)%ek0*p412(2)+p412k0*cf78(i1,i2)%e(2)
      cauxc=+cf78(i1,i2)%ek0*p356(2)-p356k0*cf78(i1,i2)%e(2)
      u356_78(i1,i2)%a(1,1)=fcr(id3)*(cauxa+ceps_0)
      u356_78(i1,i2)%a(2,2)=fcl(id3)*(cauxa-ceps_0)
      u356_78(i1,i2)%b(1,2)=fcl(id3)*(cauxb-ceps_2)
      u356_78(i1,i2)%b(2,1)=fcr(id3)*(-cauxb-ceps_2)
      u356_78(i1,i2)%c(1,2)=fcr(id3)*(cauxc+ceps_1)
      u356_78(i1,i2)%c(2,1)=fcl(id3)*(-cauxc+ceps_1)
      u356_78(i1,i2)%d(1,1)=fcl(id3)*cf78(i1,i2)%ek0
      u356_78(i1,i2)%d(2,2)=fcr(id3)*cf78(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u356_78(i1,i2)%a(iut,jut)=czero
                u356_78(i1,i2)%b(iut,jut)=czero
                u356_78(i1,i2)%c(iut,jut)=czero
                u356_78(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id3).ne.1 .and. ilept(id7).ne.1) then
        do iut=1,2
          do jut=1,2
            ug356_78(iut,jut)%a(1,1) = u356_78(iut,jut)%a(1,1)
     &           /((fcl(id3))*(fcl(id7)))
            ug356_78(iut,jut)%a(2,2) = u356_78(iut,jut)%a(2,2)
     &           /((fcl(id3))*(fcl(id7)))
            ug356_78(iut,jut)%b(1,2) = u356_78(iut,jut)%b(1,2)
     &           /((fcl(id3))*(fcl(id7)))
            ug356_78(iut,jut)%b(2,1) = u356_78(iut,jut)%b(2,1)
     &           /((fcl(id3))*(fcl(id7)))
            ug356_78(iut,jut)%c(1,2) = u356_78(iut,jut)%c(1,2)
     &           /((fcl(id3))*(fcl(id7)))
            ug356_78(iut,jut)%c(2,1) = u356_78(iut,jut)%c(2,1)
     &           /((fcl(id3))*(fcl(id7)))
            ug356_78(iut,jut)%d(1,1) = u356_78(iut,jut)%d(1,1)
     &           /((fcl(id3))*(fcl(id7)))
            ug356_78(iut,jut)%d(2,2) = u356_78(iut,jut)%d(2,2)
     &           /((fcl(id3))*(fcl(id7)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug356_78(iut,jut)%a(1,1) = czero
            ug356_78(iut,jut)%a(2,2) = czero
            ug356_78(iut,jut)%b(1,2) = czero
            ug356_78(iut,jut)%b(2,1) = czero
            ug356_78(iut,jut)%c(1,2) = czero
            ug356_78(iut,jut)%c(2,1) = czero
            ug356_78(iut,jut)%d(1,1) = czero
            ug356_78(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p356,q=p412
      quqd=p356(0)*p412(0)-p356(1)*p412(1)-p356(2)*p412(2)-p356(
     & 3)*p412(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p356,qd=p412,v=cz78(i1,i2)%e,a=u356_78(i1,i2)%a,b=u356_78(i1,i
* 2)%b,c=u356_78(i1,i2)%c,d=u356_78(i1,i2)%d,cr=zcr(id3),cl=zcl(id3),nsu
* m=1
      ceps_0=-cz78(i1,i2)%ek0*(p356(2)*p412(3)-p412(2)*p356(3))+
     & p356k0*(cz78(i1,i2)%e(2)*p412(3)-p412(2)*cz78(i1,i2)%e(3)
     & )-p412k0*(cz78(i1,i2)%e(2)*p356(3)-p356(2)*cz78(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz78(i1,i2)%e(3)*p356k0+p356(3)*cz78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz78(i1,i2)%e(3)*p412k0+p412(3)*cz78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz78(i1,i2)%e(0)*p356(0)-cz78(i1,i2)%e(1)*p356(1)-cz7
     & 8(i1,i2)%e(2)*p356(2)-cz78(i1,i2)%e(3)*p356(3)
      cvqd=cz78(i1,i2)%e(0)*p412(0)-cz78(i1,i2)%e(1)*p412(1)-cz7
     & 8(i1,i2)%e(2)*p412(2)-cz78(i1,i2)%e(3)*p412(3)
      cauxa=-cz78(i1,i2)%ek0*quqd+p356k0*cvqd+p412k0*cvqu
      cauxb=-cz78(i1,i2)%ek0*p412(2)+p412k0*cz78(i1,i2)%e(2)
      cauxc=+cz78(i1,i2)%ek0*p356(2)-p356k0*cz78(i1,i2)%e(2)
      u356_78(i1,i2)%a(1,1)=u356_78(i1,i2)%a(1,1)+zcr(id3)*(caux
     & a+ceps_0)
      u356_78(i1,i2)%a(2,2)=u356_78(i1,i2)%a(2,2)+zcl(id3)*(caux
     & a-ceps_0)
      u356_78(i1,i2)%b(1,2)=u356_78(i1,i2)%b(1,2)+zcl(id3)*(caux
     & b-ceps_2)
      u356_78(i1,i2)%b(2,1)=u356_78(i1,i2)%b(2,1)+zcr(id3)*(-cau
     & xb-ceps_2)
      u356_78(i1,i2)%c(1,2)=u356_78(i1,i2)%c(1,2)+zcr(id3)*(caux
     & c+ceps_1)
      u356_78(i1,i2)%c(2,1)=u356_78(i1,i2)%c(2,1)+zcl(id3)*(-cau
     & xc+ceps_1)
      u356_78(i1,i2)%d(1,1)=u356_78(i1,i2)%d(1,1)+zcl(id3)*cz78(
     & i1,i2)%ek0
      u356_78(i1,i2)%d(2,2)=u356_78(i1,i2)%d(2,2)+zcr(id3)*cz78(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.id7.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p356,qd=p412,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p356k0*p412(2)+p412k0*p356(2)
      cauxa=auxa-cim*(p412(3)*p356k0-p356(3)*p412k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p412k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p356k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u356_78(i1,i2)%a(i3,i4)=ch78(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u356_78(i1,i2)%b(i3,i4)=ch78(i1,i2)
     &                 *clineth%b(i3,i4)
                  u356_78(i1,i2)%c(i3,i4)=ch78(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u356_78(i1,i2)%a(i3,i4)=czero
                else
                  u356_78(i1,i2)%b(i3,i4)=czero
                  u356_78(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id3).ne.1) then
* quqd -- p=p378,q=p456
      quqd=p378(0)*p456(0)-p378(1)*p456(1)-p378(2)*p456(2)-p378(
     & 3)*p456(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p378,qd=p456,v=cf12(i1,i2)%e,a=u378_12(i1,i2)%a,b=u378_12(i1,i
* 2)%b,c=u378_12(i1,i2)%c,d=u378_12(i1,i2)%d,cr=fcr(id3),cl=fcl(id3),nsu
* m=0
      ceps_0=-cf12(i1,i2)%ek0*(p378(2)*p456(3)-p456(2)*p378(3))+
     & p378k0*(cf12(i1,i2)%e(2)*p456(3)-p456(2)*cf12(i1,i2)%e(3)
     & )-p456k0*(cf12(i1,i2)%e(2)*p378(3)-p378(2)*cf12(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf12(i1,i2)%e(3)*p378k0+p378(3)*cf12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf12(i1,i2)%e(3)*p456k0+p456(3)*cf12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf12(i1,i2)%e(0)*p378(0)-cf12(i1,i2)%e(1)*p378(1)-cf1
     & 2(i1,i2)%e(2)*p378(2)-cf12(i1,i2)%e(3)*p378(3)
      cvqd=cf12(i1,i2)%e(0)*p456(0)-cf12(i1,i2)%e(1)*p456(1)-cf1
     & 2(i1,i2)%e(2)*p456(2)-cf12(i1,i2)%e(3)*p456(3)
      cauxa=-cf12(i1,i2)%ek0*quqd+p378k0*cvqd+p456k0*cvqu
      cauxb=-cf12(i1,i2)%ek0*p456(2)+p456k0*cf12(i1,i2)%e(2)
      cauxc=+cf12(i1,i2)%ek0*p378(2)-p378k0*cf12(i1,i2)%e(2)
      u378_12(i1,i2)%a(1,1)=fcr(id3)*(cauxa+ceps_0)
      u378_12(i1,i2)%a(2,2)=fcl(id3)*(cauxa-ceps_0)
      u378_12(i1,i2)%b(1,2)=fcl(id3)*(cauxb-ceps_2)
      u378_12(i1,i2)%b(2,1)=fcr(id3)*(-cauxb-ceps_2)
      u378_12(i1,i2)%c(1,2)=fcr(id3)*(cauxc+ceps_1)
      u378_12(i1,i2)%c(2,1)=fcl(id3)*(-cauxc+ceps_1)
      u378_12(i1,i2)%d(1,1)=fcl(id3)*cf12(i1,i2)%ek0
      u378_12(i1,i2)%d(2,2)=fcr(id3)*cf12(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u378_12(i1,i2)%a(iut,jut)=czero
                u378_12(i1,i2)%b(iut,jut)=czero
                u378_12(i1,i2)%c(iut,jut)=czero
                u378_12(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id3).ne.1 .and. ilept(id1).ne.1) then
        do iut=1,2
          do jut=1,2
            ug378_12(iut,jut)%a(1,1) = u378_12(iut,jut)%a(1,1)
     &           /((fcl(id3))*(fcl(id1)))
            ug378_12(iut,jut)%a(2,2) = u378_12(iut,jut)%a(2,2)
     &           /((fcl(id3))*(fcl(id1)))
            ug378_12(iut,jut)%b(1,2) = u378_12(iut,jut)%b(1,2)
     &           /((fcl(id3))*(fcl(id1)))
            ug378_12(iut,jut)%b(2,1) = u378_12(iut,jut)%b(2,1)
     &           /((fcl(id3))*(fcl(id1)))
            ug378_12(iut,jut)%c(1,2) = u378_12(iut,jut)%c(1,2)
     &           /((fcl(id3))*(fcl(id1)))
            ug378_12(iut,jut)%c(2,1) = u378_12(iut,jut)%c(2,1)
     &           /((fcl(id3))*(fcl(id1)))
            ug378_12(iut,jut)%d(1,1) = u378_12(iut,jut)%d(1,1)
     &           /((fcl(id3))*(fcl(id1)))
            ug378_12(iut,jut)%d(2,2) = u378_12(iut,jut)%d(2,2)
     &           /((fcl(id3))*(fcl(id1)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug378_12(iut,jut)%a(1,1) = czero
            ug378_12(iut,jut)%a(2,2) = czero
            ug378_12(iut,jut)%b(1,2) = czero
            ug378_12(iut,jut)%b(2,1) = czero
            ug378_12(iut,jut)%c(1,2) = czero
            ug378_12(iut,jut)%c(2,1) = czero
            ug378_12(iut,jut)%d(1,1) = czero
            ug378_12(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p378,q=p456
      quqd=p378(0)*p456(0)-p378(1)*p456(1)-p378(2)*p456(2)-p378(
     & 3)*p456(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p378,qd=p456,v=cz12(i1,i2)%e,a=u378_12(i1,i2)%a,b=u378_12(i1,i
* 2)%b,c=u378_12(i1,i2)%c,d=u378_12(i1,i2)%d,cr=zcr(id3),cl=zcl(id3),nsu
* m=1
      ceps_0=-cz12(i1,i2)%ek0*(p378(2)*p456(3)-p456(2)*p378(3))+
     & p378k0*(cz12(i1,i2)%e(2)*p456(3)-p456(2)*cz12(i1,i2)%e(3)
     & )-p456k0*(cz12(i1,i2)%e(2)*p378(3)-p378(2)*cz12(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz12(i1,i2)%e(3)*p378k0+p378(3)*cz12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz12(i1,i2)%e(3)*p456k0+p456(3)*cz12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz12(i1,i2)%e(0)*p378(0)-cz12(i1,i2)%e(1)*p378(1)-cz1
     & 2(i1,i2)%e(2)*p378(2)-cz12(i1,i2)%e(3)*p378(3)
      cvqd=cz12(i1,i2)%e(0)*p456(0)-cz12(i1,i2)%e(1)*p456(1)-cz1
     & 2(i1,i2)%e(2)*p456(2)-cz12(i1,i2)%e(3)*p456(3)
      cauxa=-cz12(i1,i2)%ek0*quqd+p378k0*cvqd+p456k0*cvqu
      cauxb=-cz12(i1,i2)%ek0*p456(2)+p456k0*cz12(i1,i2)%e(2)
      cauxc=+cz12(i1,i2)%ek0*p378(2)-p378k0*cz12(i1,i2)%e(2)
      u378_12(i1,i2)%a(1,1)=u378_12(i1,i2)%a(1,1)+zcr(id3)*(caux
     & a+ceps_0)
      u378_12(i1,i2)%a(2,2)=u378_12(i1,i2)%a(2,2)+zcl(id3)*(caux
     & a-ceps_0)
      u378_12(i1,i2)%b(1,2)=u378_12(i1,i2)%b(1,2)+zcl(id3)*(caux
     & b-ceps_2)
      u378_12(i1,i2)%b(2,1)=u378_12(i1,i2)%b(2,1)+zcr(id3)*(-cau
     & xb-ceps_2)
      u378_12(i1,i2)%c(1,2)=u378_12(i1,i2)%c(1,2)+zcr(id3)*(caux
     & c+ceps_1)
      u378_12(i1,i2)%c(2,1)=u378_12(i1,i2)%c(2,1)+zcl(id3)*(-cau
     & xc+ceps_1)
      u378_12(i1,i2)%d(1,1)=u378_12(i1,i2)%d(1,1)+zcl(id3)*cz12(
     & i1,i2)%ek0
      u378_12(i1,i2)%d(2,2)=u378_12(i1,i2)%d(2,2)+zcr(id3)*cz12(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.id1.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p378,qd=p456,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p378k0*p456(2)+p456k0*p378(2)
      cauxa=auxa-cim*(p456(3)*p378k0-p378(3)*p456k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p456k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p378k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u378_12(i1,i2)%a(i3,i4)=ch12(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u378_12(i1,i2)%b(i3,i4)=ch12(i1,i2)
     &                 *clineth%b(i3,i4)
                  u378_12(i1,i2)%c(i3,i4)=ch12(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u378_12(i1,i2)%a(i3,i4)=czero
                else
                  u378_12(i1,i2)%b(i3,i4)=czero
                  u378_12(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id3).ne.1) then
* quqd -- p=p378,q=p412
      quqd=p378(0)*p412(0)-p378(1)*p412(1)-p378(2)*p412(2)-p378(
     & 3)*p412(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p378,qd=p412,v=cf56(i1,i2)%e,a=u378_56(i1,i2)%a,b=u378_56(i1,i
* 2)%b,c=u378_56(i1,i2)%c,d=u378_56(i1,i2)%d,cr=fcr(id3),cl=fcl(id3),nsu
* m=0
      ceps_0=-cf56(i1,i2)%ek0*(p378(2)*p412(3)-p412(2)*p378(3))+
     & p378k0*(cf56(i1,i2)%e(2)*p412(3)-p412(2)*cf56(i1,i2)%e(3)
     & )-p412k0*(cf56(i1,i2)%e(2)*p378(3)-p378(2)*cf56(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf56(i1,i2)%e(3)*p378k0+p378(3)*cf56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf56(i1,i2)%e(3)*p412k0+p412(3)*cf56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf56(i1,i2)%e(0)*p378(0)-cf56(i1,i2)%e(1)*p378(1)-cf5
     & 6(i1,i2)%e(2)*p378(2)-cf56(i1,i2)%e(3)*p378(3)
      cvqd=cf56(i1,i2)%e(0)*p412(0)-cf56(i1,i2)%e(1)*p412(1)-cf5
     & 6(i1,i2)%e(2)*p412(2)-cf56(i1,i2)%e(3)*p412(3)
      cauxa=-cf56(i1,i2)%ek0*quqd+p378k0*cvqd+p412k0*cvqu
      cauxb=-cf56(i1,i2)%ek0*p412(2)+p412k0*cf56(i1,i2)%e(2)
      cauxc=+cf56(i1,i2)%ek0*p378(2)-p378k0*cf56(i1,i2)%e(2)
      u378_56(i1,i2)%a(1,1)=fcr(id3)*(cauxa+ceps_0)
      u378_56(i1,i2)%a(2,2)=fcl(id3)*(cauxa-ceps_0)
      u378_56(i1,i2)%b(1,2)=fcl(id3)*(cauxb-ceps_2)
      u378_56(i1,i2)%b(2,1)=fcr(id3)*(-cauxb-ceps_2)
      u378_56(i1,i2)%c(1,2)=fcr(id3)*(cauxc+ceps_1)
      u378_56(i1,i2)%c(2,1)=fcl(id3)*(-cauxc+ceps_1)
      u378_56(i1,i2)%d(1,1)=fcl(id3)*cf56(i1,i2)%ek0
      u378_56(i1,i2)%d(2,2)=fcr(id3)*cf56(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u378_56(i1,i2)%a(iut,jut)=czero
                u378_56(i1,i2)%b(iut,jut)=czero
                u378_56(i1,i2)%c(iut,jut)=czero
                u378_56(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id3).ne.1 .and. ilept(id5).ne.1) then
        do iut=1,2
          do jut=1,2
            ug378_56(iut,jut)%a(1,1) = u378_56(iut,jut)%a(1,1)
     &           /((fcl(id3))*(fcl(id5)))
            ug378_56(iut,jut)%a(2,2) = u378_56(iut,jut)%a(2,2)
     &           /((fcl(id3))*(fcl(id5)))
            ug378_56(iut,jut)%b(1,2) = u378_56(iut,jut)%b(1,2)
     &           /((fcl(id3))*(fcl(id5)))
            ug378_56(iut,jut)%b(2,1) = u378_56(iut,jut)%b(2,1)
     &           /((fcl(id3))*(fcl(id5)))
            ug378_56(iut,jut)%c(1,2) = u378_56(iut,jut)%c(1,2)
     &           /((fcl(id3))*(fcl(id5)))
            ug378_56(iut,jut)%c(2,1) = u378_56(iut,jut)%c(2,1)
     &           /((fcl(id3))*(fcl(id5)))
            ug378_56(iut,jut)%d(1,1) = u378_56(iut,jut)%d(1,1)
     &           /((fcl(id3))*(fcl(id5)))
            ug378_56(iut,jut)%d(2,2) = u378_56(iut,jut)%d(2,2)
     &           /((fcl(id3))*(fcl(id5)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug378_56(iut,jut)%a(1,1) = czero
            ug378_56(iut,jut)%a(2,2) = czero
            ug378_56(iut,jut)%b(1,2) = czero
            ug378_56(iut,jut)%b(2,1) = czero
            ug378_56(iut,jut)%c(1,2) = czero
            ug378_56(iut,jut)%c(2,1) = czero
            ug378_56(iut,jut)%d(1,1) = czero
            ug378_56(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p378,q=p412
      quqd=p378(0)*p412(0)-p378(1)*p412(1)-p378(2)*p412(2)-p378(
     & 3)*p412(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p378,qd=p412,v=cz56(i1,i2)%e,a=u378_56(i1,i2)%a,b=u378_56(i1,i
* 2)%b,c=u378_56(i1,i2)%c,d=u378_56(i1,i2)%d,cr=zcr(id3),cl=zcl(id3),nsu
* m=1
      ceps_0=-cz56(i1,i2)%ek0*(p378(2)*p412(3)-p412(2)*p378(3))+
     & p378k0*(cz56(i1,i2)%e(2)*p412(3)-p412(2)*cz56(i1,i2)%e(3)
     & )-p412k0*(cz56(i1,i2)%e(2)*p378(3)-p378(2)*cz56(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz56(i1,i2)%e(3)*p378k0+p378(3)*cz56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz56(i1,i2)%e(3)*p412k0+p412(3)*cz56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz56(i1,i2)%e(0)*p378(0)-cz56(i1,i2)%e(1)*p378(1)-cz5
     & 6(i1,i2)%e(2)*p378(2)-cz56(i1,i2)%e(3)*p378(3)
      cvqd=cz56(i1,i2)%e(0)*p412(0)-cz56(i1,i2)%e(1)*p412(1)-cz5
     & 6(i1,i2)%e(2)*p412(2)-cz56(i1,i2)%e(3)*p412(3)
      cauxa=-cz56(i1,i2)%ek0*quqd+p378k0*cvqd+p412k0*cvqu
      cauxb=-cz56(i1,i2)%ek0*p412(2)+p412k0*cz56(i1,i2)%e(2)
      cauxc=+cz56(i1,i2)%ek0*p378(2)-p378k0*cz56(i1,i2)%e(2)
      u378_56(i1,i2)%a(1,1)=u378_56(i1,i2)%a(1,1)+zcr(id3)*(caux
     & a+ceps_0)
      u378_56(i1,i2)%a(2,2)=u378_56(i1,i2)%a(2,2)+zcl(id3)*(caux
     & a-ceps_0)
      u378_56(i1,i2)%b(1,2)=u378_56(i1,i2)%b(1,2)+zcl(id3)*(caux
     & b-ceps_2)
      u378_56(i1,i2)%b(2,1)=u378_56(i1,i2)%b(2,1)+zcr(id3)*(-cau
     & xb-ceps_2)
      u378_56(i1,i2)%c(1,2)=u378_56(i1,i2)%c(1,2)+zcr(id3)*(caux
     & c+ceps_1)
      u378_56(i1,i2)%c(2,1)=u378_56(i1,i2)%c(2,1)+zcl(id3)*(-cau
     & xc+ceps_1)
      u378_56(i1,i2)%d(1,1)=u378_56(i1,i2)%d(1,1)+zcl(id3)*cz56(
     & i1,i2)%ek0
      u378_56(i1,i2)%d(2,2)=u378_56(i1,i2)%d(2,2)+zcr(id3)*cz56(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.id5.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p378,qd=p412,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p378k0*p412(2)+p412k0*p378(2)
      cauxa=auxa-cim*(p412(3)*p378k0-p378(3)*p412k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p412k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p378k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u378_56(i1,i2)%a(i3,i4)=ch56(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u378_56(i1,i2)%b(i3,i4)=ch56(i1,i2)
     &                 *clineth%b(i3,i4)
                  u378_56(i1,i2)%c(i3,i4)=ch56(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u378_56(i1,i2)%a(i3,i4)=czero
                else
                  u378_56(i1,i2)%b(i3,i4)=czero
                  u378_56(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id5).ne.1) then
* quqd -- p=p512,q=p678
      quqd=p512(0)*p678(0)-p512(1)*p678(1)-p512(2)*p678(2)-p512(
     & 3)*p678(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p512,qd=p678,v=cf34(i1,i2)%e,a=u512_34(i1,i2)%a,b=u512_34(i1,i
* 2)%b,c=u512_34(i1,i2)%c,d=u512_34(i1,i2)%d,cr=fcr(id5),cl=fcl(id5),nsu
* m=0
      ceps_0=-cf34(i1,i2)%ek0*(p512(2)*p678(3)-p678(2)*p512(3))+
     & p512k0*(cf34(i1,i2)%e(2)*p678(3)-p678(2)*cf34(i1,i2)%e(3)
     & )-p678k0*(cf34(i1,i2)%e(2)*p512(3)-p512(2)*cf34(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf34(i1,i2)%e(3)*p512k0+p512(3)*cf34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf34(i1,i2)%e(3)*p678k0+p678(3)*cf34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf34(i1,i2)%e(0)*p512(0)-cf34(i1,i2)%e(1)*p512(1)-cf3
     & 4(i1,i2)%e(2)*p512(2)-cf34(i1,i2)%e(3)*p512(3)
      cvqd=cf34(i1,i2)%e(0)*p678(0)-cf34(i1,i2)%e(1)*p678(1)-cf3
     & 4(i1,i2)%e(2)*p678(2)-cf34(i1,i2)%e(3)*p678(3)
      cauxa=-cf34(i1,i2)%ek0*quqd+p512k0*cvqd+p678k0*cvqu
      cauxb=-cf34(i1,i2)%ek0*p678(2)+p678k0*cf34(i1,i2)%e(2)
      cauxc=+cf34(i1,i2)%ek0*p512(2)-p512k0*cf34(i1,i2)%e(2)
      u512_34(i1,i2)%a(1,1)=fcr(id5)*(cauxa+ceps_0)
      u512_34(i1,i2)%a(2,2)=fcl(id5)*(cauxa-ceps_0)
      u512_34(i1,i2)%b(1,2)=fcl(id5)*(cauxb-ceps_2)
      u512_34(i1,i2)%b(2,1)=fcr(id5)*(-cauxb-ceps_2)
      u512_34(i1,i2)%c(1,2)=fcr(id5)*(cauxc+ceps_1)
      u512_34(i1,i2)%c(2,1)=fcl(id5)*(-cauxc+ceps_1)
      u512_34(i1,i2)%d(1,1)=fcl(id5)*cf34(i1,i2)%ek0
      u512_34(i1,i2)%d(2,2)=fcr(id5)*cf34(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u512_34(i1,i2)%a(iut,jut)=czero
                u512_34(i1,i2)%b(iut,jut)=czero
                u512_34(i1,i2)%c(iut,jut)=czero
                u512_34(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id5).ne.1 .and. ilept(id3).ne.1) then
        do iut=1,2
          do jut=1,2
            ug512_34(iut,jut)%a(1,1) = u512_34(iut,jut)%a(1,1)
     &           /((fcl(id5))*(fcl(id3)))
            ug512_34(iut,jut)%a(2,2) = u512_34(iut,jut)%a(2,2)
     &           /((fcl(id5))*(fcl(id3)))
            ug512_34(iut,jut)%b(1,2) = u512_34(iut,jut)%b(1,2)
     &           /((fcl(id5))*(fcl(id3)))
            ug512_34(iut,jut)%b(2,1) = u512_34(iut,jut)%b(2,1)
     &           /((fcl(id5))*(fcl(id3)))
            ug512_34(iut,jut)%c(1,2) = u512_34(iut,jut)%c(1,2)
     &           /((fcl(id5))*(fcl(id3)))
            ug512_34(iut,jut)%c(2,1) = u512_34(iut,jut)%c(2,1)
     &           /((fcl(id5))*(fcl(id3)))
            ug512_34(iut,jut)%d(1,1) = u512_34(iut,jut)%d(1,1)
     &           /((fcl(id5))*(fcl(id3)))
            ug512_34(iut,jut)%d(2,2) = u512_34(iut,jut)%d(2,2)
     &           /((fcl(id5))*(fcl(id3)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug512_34(iut,jut)%a(1,1) = czero
            ug512_34(iut,jut)%a(2,2) = czero
            ug512_34(iut,jut)%b(1,2) = czero
            ug512_34(iut,jut)%b(2,1) = czero
            ug512_34(iut,jut)%c(1,2) = czero
            ug512_34(iut,jut)%c(2,1) = czero
            ug512_34(iut,jut)%d(1,1) = czero
            ug512_34(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p512,q=p678
      quqd=p512(0)*p678(0)-p512(1)*p678(1)-p512(2)*p678(2)-p512(
     & 3)*p678(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p512,qd=p678,v=cz34(i1,i2)%e,a=u512_34(i1,i2)%a,b=u512_34(i1,i
* 2)%b,c=u512_34(i1,i2)%c,d=u512_34(i1,i2)%d,cr=zcr(id5),cl=zcl(id5),nsu
* m=1
      ceps_0=-cz34(i1,i2)%ek0*(p512(2)*p678(3)-p678(2)*p512(3))+
     & p512k0*(cz34(i1,i2)%e(2)*p678(3)-p678(2)*cz34(i1,i2)%e(3)
     & )-p678k0*(cz34(i1,i2)%e(2)*p512(3)-p512(2)*cz34(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz34(i1,i2)%e(3)*p512k0+p512(3)*cz34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz34(i1,i2)%e(3)*p678k0+p678(3)*cz34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz34(i1,i2)%e(0)*p512(0)-cz34(i1,i2)%e(1)*p512(1)-cz3
     & 4(i1,i2)%e(2)*p512(2)-cz34(i1,i2)%e(3)*p512(3)
      cvqd=cz34(i1,i2)%e(0)*p678(0)-cz34(i1,i2)%e(1)*p678(1)-cz3
     & 4(i1,i2)%e(2)*p678(2)-cz34(i1,i2)%e(3)*p678(3)
      cauxa=-cz34(i1,i2)%ek0*quqd+p512k0*cvqd+p678k0*cvqu
      cauxb=-cz34(i1,i2)%ek0*p678(2)+p678k0*cz34(i1,i2)%e(2)
      cauxc=+cz34(i1,i2)%ek0*p512(2)-p512k0*cz34(i1,i2)%e(2)
      u512_34(i1,i2)%a(1,1)=u512_34(i1,i2)%a(1,1)+zcr(id5)*(caux
     & a+ceps_0)
      u512_34(i1,i2)%a(2,2)=u512_34(i1,i2)%a(2,2)+zcl(id5)*(caux
     & a-ceps_0)
      u512_34(i1,i2)%b(1,2)=u512_34(i1,i2)%b(1,2)+zcl(id5)*(caux
     & b-ceps_2)
      u512_34(i1,i2)%b(2,1)=u512_34(i1,i2)%b(2,1)+zcr(id5)*(-cau
     & xb-ceps_2)
      u512_34(i1,i2)%c(1,2)=u512_34(i1,i2)%c(1,2)+zcr(id5)*(caux
     & c+ceps_1)
      u512_34(i1,i2)%c(2,1)=u512_34(i1,i2)%c(2,1)+zcl(id5)*(-cau
     & xc+ceps_1)
      u512_34(i1,i2)%d(1,1)=u512_34(i1,i2)%d(1,1)+zcl(id5)*cz34(
     & i1,i2)%ek0
      u512_34(i1,i2)%d(2,2)=u512_34(i1,i2)%d(2,2)+zcr(id5)*cz34(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.id3.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p512,qd=p678,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p512k0*p678(2)+p678k0*p512(2)
      cauxa=auxa-cim*(p678(3)*p512k0-p512(3)*p678k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p678k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p512k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u512_34(i1,i2)%a(i3,i4)=ch34(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u512_34(i1,i2)%b(i3,i4)=ch34(i1,i2)
     &                 *clineth%b(i3,i4)
                  u512_34(i1,i2)%c(i3,i4)=ch34(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u512_34(i1,i2)%a(i3,i4)=czero
                else
                  u512_34(i1,i2)%b(i3,i4)=czero
                  u512_34(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id5).ne.1) then
* quqd -- p=p512,q=p634
      quqd=p512(0)*p634(0)-p512(1)*p634(1)-p512(2)*p634(2)-p512(
     & 3)*p634(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p512,qd=p634,v=cf78(i1,i2)%e,a=u512_78(i1,i2)%a,b=u512_78(i1,i
* 2)%b,c=u512_78(i1,i2)%c,d=u512_78(i1,i2)%d,cr=fcr(id5),cl=fcl(id5),nsu
* m=0
      ceps_0=-cf78(i1,i2)%ek0*(p512(2)*p634(3)-p634(2)*p512(3))+
     & p512k0*(cf78(i1,i2)%e(2)*p634(3)-p634(2)*cf78(i1,i2)%e(3)
     & )-p634k0*(cf78(i1,i2)%e(2)*p512(3)-p512(2)*cf78(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf78(i1,i2)%e(3)*p512k0+p512(3)*cf78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf78(i1,i2)%e(3)*p634k0+p634(3)*cf78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf78(i1,i2)%e(0)*p512(0)-cf78(i1,i2)%e(1)*p512(1)-cf7
     & 8(i1,i2)%e(2)*p512(2)-cf78(i1,i2)%e(3)*p512(3)
      cvqd=cf78(i1,i2)%e(0)*p634(0)-cf78(i1,i2)%e(1)*p634(1)-cf7
     & 8(i1,i2)%e(2)*p634(2)-cf78(i1,i2)%e(3)*p634(3)
      cauxa=-cf78(i1,i2)%ek0*quqd+p512k0*cvqd+p634k0*cvqu
      cauxb=-cf78(i1,i2)%ek0*p634(2)+p634k0*cf78(i1,i2)%e(2)
      cauxc=+cf78(i1,i2)%ek0*p512(2)-p512k0*cf78(i1,i2)%e(2)
      u512_78(i1,i2)%a(1,1)=fcr(id5)*(cauxa+ceps_0)
      u512_78(i1,i2)%a(2,2)=fcl(id5)*(cauxa-ceps_0)
      u512_78(i1,i2)%b(1,2)=fcl(id5)*(cauxb-ceps_2)
      u512_78(i1,i2)%b(2,1)=fcr(id5)*(-cauxb-ceps_2)
      u512_78(i1,i2)%c(1,2)=fcr(id5)*(cauxc+ceps_1)
      u512_78(i1,i2)%c(2,1)=fcl(id5)*(-cauxc+ceps_1)
      u512_78(i1,i2)%d(1,1)=fcl(id5)*cf78(i1,i2)%ek0
      u512_78(i1,i2)%d(2,2)=fcr(id5)*cf78(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u512_78(i1,i2)%a(iut,jut)=czero
                u512_78(i1,i2)%b(iut,jut)=czero
                u512_78(i1,i2)%c(iut,jut)=czero
                u512_78(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id5).ne.1 .and. ilept(id7).ne.1) then
        do iut=1,2
          do jut=1,2
            ug512_78(iut,jut)%a(1,1) = u512_78(iut,jut)%a(1,1)
     &           /((fcl(id5))*(fcl(id7)))
            ug512_78(iut,jut)%a(2,2) = u512_78(iut,jut)%a(2,2)
     &           /((fcl(id5))*(fcl(id7)))
            ug512_78(iut,jut)%b(1,2) = u512_78(iut,jut)%b(1,2)
     &           /((fcl(id5))*(fcl(id7)))
            ug512_78(iut,jut)%b(2,1) = u512_78(iut,jut)%b(2,1)
     &           /((fcl(id5))*(fcl(id7)))
            ug512_78(iut,jut)%c(1,2) = u512_78(iut,jut)%c(1,2)
     &           /((fcl(id5))*(fcl(id7)))
            ug512_78(iut,jut)%c(2,1) = u512_78(iut,jut)%c(2,1)
     &           /((fcl(id5))*(fcl(id7)))
            ug512_78(iut,jut)%d(1,1) = u512_78(iut,jut)%d(1,1)
     &           /((fcl(id5))*(fcl(id7)))
            ug512_78(iut,jut)%d(2,2) = u512_78(iut,jut)%d(2,2)
     &           /((fcl(id5))*(fcl(id7)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug512_78(iut,jut)%a(1,1) = czero
            ug512_78(iut,jut)%a(2,2) = czero
            ug512_78(iut,jut)%b(1,2) = czero
            ug512_78(iut,jut)%b(2,1) = czero
            ug512_78(iut,jut)%c(1,2) = czero
            ug512_78(iut,jut)%c(2,1) = czero
            ug512_78(iut,jut)%d(1,1) = czero
            ug512_78(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p512,q=p634
      quqd=p512(0)*p634(0)-p512(1)*p634(1)-p512(2)*p634(2)-p512(
     & 3)*p634(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p512,qd=p634,v=cz78(i1,i2)%e,a=u512_78(i1,i2)%a,b=u512_78(i1,i
* 2)%b,c=u512_78(i1,i2)%c,d=u512_78(i1,i2)%d,cr=zcr(id5),cl=zcl(id5),nsu
* m=1
      ceps_0=-cz78(i1,i2)%ek0*(p512(2)*p634(3)-p634(2)*p512(3))+
     & p512k0*(cz78(i1,i2)%e(2)*p634(3)-p634(2)*cz78(i1,i2)%e(3)
     & )-p634k0*(cz78(i1,i2)%e(2)*p512(3)-p512(2)*cz78(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz78(i1,i2)%e(3)*p512k0+p512(3)*cz78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz78(i1,i2)%e(3)*p634k0+p634(3)*cz78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz78(i1,i2)%e(0)*p512(0)-cz78(i1,i2)%e(1)*p512(1)-cz7
     & 8(i1,i2)%e(2)*p512(2)-cz78(i1,i2)%e(3)*p512(3)
      cvqd=cz78(i1,i2)%e(0)*p634(0)-cz78(i1,i2)%e(1)*p634(1)-cz7
     & 8(i1,i2)%e(2)*p634(2)-cz78(i1,i2)%e(3)*p634(3)
      cauxa=-cz78(i1,i2)%ek0*quqd+p512k0*cvqd+p634k0*cvqu
      cauxb=-cz78(i1,i2)%ek0*p634(2)+p634k0*cz78(i1,i2)%e(2)
      cauxc=+cz78(i1,i2)%ek0*p512(2)-p512k0*cz78(i1,i2)%e(2)
      u512_78(i1,i2)%a(1,1)=u512_78(i1,i2)%a(1,1)+zcr(id5)*(caux
     & a+ceps_0)
      u512_78(i1,i2)%a(2,2)=u512_78(i1,i2)%a(2,2)+zcl(id5)*(caux
     & a-ceps_0)
      u512_78(i1,i2)%b(1,2)=u512_78(i1,i2)%b(1,2)+zcl(id5)*(caux
     & b-ceps_2)
      u512_78(i1,i2)%b(2,1)=u512_78(i1,i2)%b(2,1)+zcr(id5)*(-cau
     & xb-ceps_2)
      u512_78(i1,i2)%c(1,2)=u512_78(i1,i2)%c(1,2)+zcr(id5)*(caux
     & c+ceps_1)
      u512_78(i1,i2)%c(2,1)=u512_78(i1,i2)%c(2,1)+zcl(id5)*(-cau
     & xc+ceps_1)
      u512_78(i1,i2)%d(1,1)=u512_78(i1,i2)%d(1,1)+zcl(id5)*cz78(
     & i1,i2)%ek0
      u512_78(i1,i2)%d(2,2)=u512_78(i1,i2)%d(2,2)+zcr(id5)*cz78(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.id7.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p512,qd=p634,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p512k0*p634(2)+p634k0*p512(2)
      cauxa=auxa-cim*(p634(3)*p512k0-p512(3)*p634k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p634k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p512k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u512_78(i1,i2)%a(i3,i4)=ch78(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u512_78(i1,i2)%b(i3,i4)=ch78(i1,i2)
     &                 *clineth%b(i3,i4)
                  u512_78(i1,i2)%c(i3,i4)=ch78(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u512_78(i1,i2)%a(i3,i4)=czero
                else
                  u512_78(i1,i2)%b(i3,i4)=czero
                  u512_78(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id5).ne.1) then
* quqd -- p=p534,q=p678
      quqd=p534(0)*p678(0)-p534(1)*p678(1)-p534(2)*p678(2)-p534(
     & 3)*p678(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p534,qd=p678,v=cf12(i1,i2)%e,a=u534_12(i1,i2)%a,b=u534_12(i1,i
* 2)%b,c=u534_12(i1,i2)%c,d=u534_12(i1,i2)%d,cr=fcr(id5),cl=fcl(id5),nsu
* m=0
      ceps_0=-cf12(i1,i2)%ek0*(p534(2)*p678(3)-p678(2)*p534(3))+
     & p534k0*(cf12(i1,i2)%e(2)*p678(3)-p678(2)*cf12(i1,i2)%e(3)
     & )-p678k0*(cf12(i1,i2)%e(2)*p534(3)-p534(2)*cf12(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf12(i1,i2)%e(3)*p534k0+p534(3)*cf12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf12(i1,i2)%e(3)*p678k0+p678(3)*cf12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf12(i1,i2)%e(0)*p534(0)-cf12(i1,i2)%e(1)*p534(1)-cf1
     & 2(i1,i2)%e(2)*p534(2)-cf12(i1,i2)%e(3)*p534(3)
      cvqd=cf12(i1,i2)%e(0)*p678(0)-cf12(i1,i2)%e(1)*p678(1)-cf1
     & 2(i1,i2)%e(2)*p678(2)-cf12(i1,i2)%e(3)*p678(3)
      cauxa=-cf12(i1,i2)%ek0*quqd+p534k0*cvqd+p678k0*cvqu
      cauxb=-cf12(i1,i2)%ek0*p678(2)+p678k0*cf12(i1,i2)%e(2)
      cauxc=+cf12(i1,i2)%ek0*p534(2)-p534k0*cf12(i1,i2)%e(2)
      u534_12(i1,i2)%a(1,1)=fcr(id5)*(cauxa+ceps_0)
      u534_12(i1,i2)%a(2,2)=fcl(id5)*(cauxa-ceps_0)
      u534_12(i1,i2)%b(1,2)=fcl(id5)*(cauxb-ceps_2)
      u534_12(i1,i2)%b(2,1)=fcr(id5)*(-cauxb-ceps_2)
      u534_12(i1,i2)%c(1,2)=fcr(id5)*(cauxc+ceps_1)
      u534_12(i1,i2)%c(2,1)=fcl(id5)*(-cauxc+ceps_1)
      u534_12(i1,i2)%d(1,1)=fcl(id5)*cf12(i1,i2)%ek0
      u534_12(i1,i2)%d(2,2)=fcr(id5)*cf12(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u534_12(i1,i2)%a(iut,jut)=czero
                u534_12(i1,i2)%b(iut,jut)=czero
                u534_12(i1,i2)%c(iut,jut)=czero
                u534_12(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id5).ne.1 .and. ilept(id1).ne.1) then
        do iut=1,2
          do jut=1,2
            ug534_12(iut,jut)%a(1,1) = u534_12(iut,jut)%a(1,1)
     &           /((fcl(id5))*(fcl(id1)))
            ug534_12(iut,jut)%a(2,2) = u534_12(iut,jut)%a(2,2)
     &           /((fcl(id5))*(fcl(id1)))
            ug534_12(iut,jut)%b(1,2) = u534_12(iut,jut)%b(1,2)
     &           /((fcl(id5))*(fcl(id1)))
            ug534_12(iut,jut)%b(2,1) = u534_12(iut,jut)%b(2,1)
     &           /((fcl(id5))*(fcl(id1)))
            ug534_12(iut,jut)%c(1,2) = u534_12(iut,jut)%c(1,2)
     &           /((fcl(id5))*(fcl(id1)))
            ug534_12(iut,jut)%c(2,1) = u534_12(iut,jut)%c(2,1)
     &           /((fcl(id5))*(fcl(id1)))
            ug534_12(iut,jut)%d(1,1) = u534_12(iut,jut)%d(1,1)
     &           /((fcl(id5))*(fcl(id1)))
            ug534_12(iut,jut)%d(2,2) = u534_12(iut,jut)%d(2,2)
     &           /((fcl(id5))*(fcl(id1)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug534_12(iut,jut)%a(1,1) = czero
            ug534_12(iut,jut)%a(2,2) = czero
            ug534_12(iut,jut)%b(1,2) = czero
            ug534_12(iut,jut)%b(2,1) = czero
            ug534_12(iut,jut)%c(1,2) = czero
            ug534_12(iut,jut)%c(2,1) = czero
            ug534_12(iut,jut)%d(1,1) = czero
            ug534_12(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p534,q=p678
      quqd=p534(0)*p678(0)-p534(1)*p678(1)-p534(2)*p678(2)-p534(
     & 3)*p678(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p534,qd=p678,v=cz12(i1,i2)%e,a=u534_12(i1,i2)%a,b=u534_12(i1,i
* 2)%b,c=u534_12(i1,i2)%c,d=u534_12(i1,i2)%d,cr=zcr(id5),cl=zcl(id5),nsu
* m=1
      ceps_0=-cz12(i1,i2)%ek0*(p534(2)*p678(3)-p678(2)*p534(3))+
     & p534k0*(cz12(i1,i2)%e(2)*p678(3)-p678(2)*cz12(i1,i2)%e(3)
     & )-p678k0*(cz12(i1,i2)%e(2)*p534(3)-p534(2)*cz12(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz12(i1,i2)%e(3)*p534k0+p534(3)*cz12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz12(i1,i2)%e(3)*p678k0+p678(3)*cz12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz12(i1,i2)%e(0)*p534(0)-cz12(i1,i2)%e(1)*p534(1)-cz1
     & 2(i1,i2)%e(2)*p534(2)-cz12(i1,i2)%e(3)*p534(3)
      cvqd=cz12(i1,i2)%e(0)*p678(0)-cz12(i1,i2)%e(1)*p678(1)-cz1
     & 2(i1,i2)%e(2)*p678(2)-cz12(i1,i2)%e(3)*p678(3)
      cauxa=-cz12(i1,i2)%ek0*quqd+p534k0*cvqd+p678k0*cvqu
      cauxb=-cz12(i1,i2)%ek0*p678(2)+p678k0*cz12(i1,i2)%e(2)
      cauxc=+cz12(i1,i2)%ek0*p534(2)-p534k0*cz12(i1,i2)%e(2)
      u534_12(i1,i2)%a(1,1)=u534_12(i1,i2)%a(1,1)+zcr(id5)*(caux
     & a+ceps_0)
      u534_12(i1,i2)%a(2,2)=u534_12(i1,i2)%a(2,2)+zcl(id5)*(caux
     & a-ceps_0)
      u534_12(i1,i2)%b(1,2)=u534_12(i1,i2)%b(1,2)+zcl(id5)*(caux
     & b-ceps_2)
      u534_12(i1,i2)%b(2,1)=u534_12(i1,i2)%b(2,1)+zcr(id5)*(-cau
     & xb-ceps_2)
      u534_12(i1,i2)%c(1,2)=u534_12(i1,i2)%c(1,2)+zcr(id5)*(caux
     & c+ceps_1)
      u534_12(i1,i2)%c(2,1)=u534_12(i1,i2)%c(2,1)+zcl(id5)*(-cau
     & xc+ceps_1)
      u534_12(i1,i2)%d(1,1)=u534_12(i1,i2)%d(1,1)+zcl(id5)*cz12(
     & i1,i2)%ek0
      u534_12(i1,i2)%d(2,2)=u534_12(i1,i2)%d(2,2)+zcr(id5)*cz12(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.id1.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p534,qd=p678,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p534k0*p678(2)+p678k0*p534(2)
      cauxa=auxa-cim*(p678(3)*p534k0-p534(3)*p678k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p678k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p534k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u534_12(i1,i2)%a(i3,i4)=ch12(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u534_12(i1,i2)%b(i3,i4)=ch12(i1,i2)
     &                 *clineth%b(i3,i4)
                  u534_12(i1,i2)%c(i3,i4)=ch12(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u534_12(i1,i2)%a(i3,i4)=czero
                else
                  u534_12(i1,i2)%b(i3,i4)=czero
                  u534_12(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id5).ne.1) then
* quqd -- p=p534,q=p612
      quqd=p534(0)*p612(0)-p534(1)*p612(1)-p534(2)*p612(2)-p534(
     & 3)*p612(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p534,qd=p612,v=cf78(i1,i2)%e,a=u534_78(i1,i2)%a,b=u534_78(i1,i
* 2)%b,c=u534_78(i1,i2)%c,d=u534_78(i1,i2)%d,cr=fcr(id5),cl=fcl(id5),nsu
* m=0
      ceps_0=-cf78(i1,i2)%ek0*(p534(2)*p612(3)-p612(2)*p534(3))+
     & p534k0*(cf78(i1,i2)%e(2)*p612(3)-p612(2)*cf78(i1,i2)%e(3)
     & )-p612k0*(cf78(i1,i2)%e(2)*p534(3)-p534(2)*cf78(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf78(i1,i2)%e(3)*p534k0+p534(3)*cf78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf78(i1,i2)%e(3)*p612k0+p612(3)*cf78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf78(i1,i2)%e(0)*p534(0)-cf78(i1,i2)%e(1)*p534(1)-cf7
     & 8(i1,i2)%e(2)*p534(2)-cf78(i1,i2)%e(3)*p534(3)
      cvqd=cf78(i1,i2)%e(0)*p612(0)-cf78(i1,i2)%e(1)*p612(1)-cf7
     & 8(i1,i2)%e(2)*p612(2)-cf78(i1,i2)%e(3)*p612(3)
      cauxa=-cf78(i1,i2)%ek0*quqd+p534k0*cvqd+p612k0*cvqu
      cauxb=-cf78(i1,i2)%ek0*p612(2)+p612k0*cf78(i1,i2)%e(2)
      cauxc=+cf78(i1,i2)%ek0*p534(2)-p534k0*cf78(i1,i2)%e(2)
      u534_78(i1,i2)%a(1,1)=fcr(id5)*(cauxa+ceps_0)
      u534_78(i1,i2)%a(2,2)=fcl(id5)*(cauxa-ceps_0)
      u534_78(i1,i2)%b(1,2)=fcl(id5)*(cauxb-ceps_2)
      u534_78(i1,i2)%b(2,1)=fcr(id5)*(-cauxb-ceps_2)
      u534_78(i1,i2)%c(1,2)=fcr(id5)*(cauxc+ceps_1)
      u534_78(i1,i2)%c(2,1)=fcl(id5)*(-cauxc+ceps_1)
      u534_78(i1,i2)%d(1,1)=fcl(id5)*cf78(i1,i2)%ek0
      u534_78(i1,i2)%d(2,2)=fcr(id5)*cf78(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u534_78(i1,i2)%a(iut,jut)=czero
                u534_78(i1,i2)%b(iut,jut)=czero
                u534_78(i1,i2)%c(iut,jut)=czero
                u534_78(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id5).ne.1 .and. ilept(id7).ne.1) then
        do iut=1,2
          do jut=1,2
            ug534_78(iut,jut)%a(1,1) = u534_78(iut,jut)%a(1,1)
     &           /((fcl(id5))*(fcl(id7)))
            ug534_78(iut,jut)%a(2,2) = u534_78(iut,jut)%a(2,2)
     &           /((fcl(id5))*(fcl(id7)))
            ug534_78(iut,jut)%b(1,2) = u534_78(iut,jut)%b(1,2)
     &           /((fcl(id5))*(fcl(id7)))
            ug534_78(iut,jut)%b(2,1) = u534_78(iut,jut)%b(2,1)
     &           /((fcl(id5))*(fcl(id7)))
            ug534_78(iut,jut)%c(1,2) = u534_78(iut,jut)%c(1,2)
     &           /((fcl(id5))*(fcl(id7)))
            ug534_78(iut,jut)%c(2,1) = u534_78(iut,jut)%c(2,1)
     &           /((fcl(id5))*(fcl(id7)))
            ug534_78(iut,jut)%d(1,1) = u534_78(iut,jut)%d(1,1)
     &           /((fcl(id5))*(fcl(id7)))
            ug534_78(iut,jut)%d(2,2) = u534_78(iut,jut)%d(2,2)
     &           /((fcl(id5))*(fcl(id7)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug534_78(iut,jut)%a(1,1) = czero
            ug534_78(iut,jut)%a(2,2) = czero
            ug534_78(iut,jut)%b(1,2) = czero
            ug534_78(iut,jut)%b(2,1) = czero
            ug534_78(iut,jut)%c(1,2) = czero
            ug534_78(iut,jut)%c(2,1) = czero
            ug534_78(iut,jut)%d(1,1) = czero
            ug534_78(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p534,q=p612
      quqd=p534(0)*p612(0)-p534(1)*p612(1)-p534(2)*p612(2)-p534(
     & 3)*p612(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p534,qd=p612,v=cz78(i1,i2)%e,a=u534_78(i1,i2)%a,b=u534_78(i1,i
* 2)%b,c=u534_78(i1,i2)%c,d=u534_78(i1,i2)%d,cr=zcr(id5),cl=zcl(id5),nsu
* m=1
      ceps_0=-cz78(i1,i2)%ek0*(p534(2)*p612(3)-p612(2)*p534(3))+
     & p534k0*(cz78(i1,i2)%e(2)*p612(3)-p612(2)*cz78(i1,i2)%e(3)
     & )-p612k0*(cz78(i1,i2)%e(2)*p534(3)-p534(2)*cz78(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz78(i1,i2)%e(3)*p534k0+p534(3)*cz78(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz78(i1,i2)%e(3)*p612k0+p612(3)*cz78(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz78(i1,i2)%e(0)*p534(0)-cz78(i1,i2)%e(1)*p534(1)-cz7
     & 8(i1,i2)%e(2)*p534(2)-cz78(i1,i2)%e(3)*p534(3)
      cvqd=cz78(i1,i2)%e(0)*p612(0)-cz78(i1,i2)%e(1)*p612(1)-cz7
     & 8(i1,i2)%e(2)*p612(2)-cz78(i1,i2)%e(3)*p612(3)
      cauxa=-cz78(i1,i2)%ek0*quqd+p534k0*cvqd+p612k0*cvqu
      cauxb=-cz78(i1,i2)%ek0*p612(2)+p612k0*cz78(i1,i2)%e(2)
      cauxc=+cz78(i1,i2)%ek0*p534(2)-p534k0*cz78(i1,i2)%e(2)
      u534_78(i1,i2)%a(1,1)=u534_78(i1,i2)%a(1,1)+zcr(id5)*(caux
     & a+ceps_0)
      u534_78(i1,i2)%a(2,2)=u534_78(i1,i2)%a(2,2)+zcl(id5)*(caux
     & a-ceps_0)
      u534_78(i1,i2)%b(1,2)=u534_78(i1,i2)%b(1,2)+zcl(id5)*(caux
     & b-ceps_2)
      u534_78(i1,i2)%b(2,1)=u534_78(i1,i2)%b(2,1)+zcr(id5)*(-cau
     & xb-ceps_2)
      u534_78(i1,i2)%c(1,2)=u534_78(i1,i2)%c(1,2)+zcr(id5)*(caux
     & c+ceps_1)
      u534_78(i1,i2)%c(2,1)=u534_78(i1,i2)%c(2,1)+zcl(id5)*(-cau
     & xc+ceps_1)
      u534_78(i1,i2)%d(1,1)=u534_78(i1,i2)%d(1,1)+zcl(id5)*cz78(
     & i1,i2)%ek0
      u534_78(i1,i2)%d(2,2)=u534_78(i1,i2)%d(2,2)+zcr(id5)*cz78(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.id7.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p534,qd=p612,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p534k0*p612(2)+p612k0*p534(2)
      cauxa=auxa-cim*(p612(3)*p534k0-p534(3)*p612k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p612k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p534k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u534_78(i1,i2)%a(i3,i4)=ch78(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u534_78(i1,i2)%b(i3,i4)=ch78(i1,i2)
     &                 *clineth%b(i3,i4)
                  u534_78(i1,i2)%c(i3,i4)=ch78(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u534_78(i1,i2)%a(i3,i4)=czero
                else
                  u534_78(i1,i2)%b(i3,i4)=czero
                  u534_78(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id5).ne.1) then
* quqd -- p=p578,q=p634
      quqd=p578(0)*p634(0)-p578(1)*p634(1)-p578(2)*p634(2)-p578(
     & 3)*p634(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p578,qd=p634,v=cf12(i1,i2)%e,a=u578_12(i1,i2)%a,b=u578_12(i1,i
* 2)%b,c=u578_12(i1,i2)%c,d=u578_12(i1,i2)%d,cr=fcr(id5),cl=fcl(id5),nsu
* m=0
      ceps_0=-cf12(i1,i2)%ek0*(p578(2)*p634(3)-p634(2)*p578(3))+
     & p578k0*(cf12(i1,i2)%e(2)*p634(3)-p634(2)*cf12(i1,i2)%e(3)
     & )-p634k0*(cf12(i1,i2)%e(2)*p578(3)-p578(2)*cf12(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf12(i1,i2)%e(3)*p578k0+p578(3)*cf12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf12(i1,i2)%e(3)*p634k0+p634(3)*cf12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf12(i1,i2)%e(0)*p578(0)-cf12(i1,i2)%e(1)*p578(1)-cf1
     & 2(i1,i2)%e(2)*p578(2)-cf12(i1,i2)%e(3)*p578(3)
      cvqd=cf12(i1,i2)%e(0)*p634(0)-cf12(i1,i2)%e(1)*p634(1)-cf1
     & 2(i1,i2)%e(2)*p634(2)-cf12(i1,i2)%e(3)*p634(3)
      cauxa=-cf12(i1,i2)%ek0*quqd+p578k0*cvqd+p634k0*cvqu
      cauxb=-cf12(i1,i2)%ek0*p634(2)+p634k0*cf12(i1,i2)%e(2)
      cauxc=+cf12(i1,i2)%ek0*p578(2)-p578k0*cf12(i1,i2)%e(2)
      u578_12(i1,i2)%a(1,1)=fcr(id5)*(cauxa+ceps_0)
      u578_12(i1,i2)%a(2,2)=fcl(id5)*(cauxa-ceps_0)
      u578_12(i1,i2)%b(1,2)=fcl(id5)*(cauxb-ceps_2)
      u578_12(i1,i2)%b(2,1)=fcr(id5)*(-cauxb-ceps_2)
      u578_12(i1,i2)%c(1,2)=fcr(id5)*(cauxc+ceps_1)
      u578_12(i1,i2)%c(2,1)=fcl(id5)*(-cauxc+ceps_1)
      u578_12(i1,i2)%d(1,1)=fcl(id5)*cf12(i1,i2)%ek0
      u578_12(i1,i2)%d(2,2)=fcr(id5)*cf12(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u578_12(i1,i2)%a(iut,jut)=czero
                u578_12(i1,i2)%b(iut,jut)=czero
                u578_12(i1,i2)%c(iut,jut)=czero
                u578_12(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id5).ne.1 .and. ilept(id1).ne.1) then
        do iut=1,2
          do jut=1,2
            ug578_12(iut,jut)%a(1,1) = u578_12(iut,jut)%a(1,1)
     &           /((fcl(id5))*(fcl(id1)))
            ug578_12(iut,jut)%a(2,2) = u578_12(iut,jut)%a(2,2)
     &           /((fcl(id5))*(fcl(id1)))
            ug578_12(iut,jut)%b(1,2) = u578_12(iut,jut)%b(1,2)
     &           /((fcl(id5))*(fcl(id1)))
            ug578_12(iut,jut)%b(2,1) = u578_12(iut,jut)%b(2,1)
     &           /((fcl(id5))*(fcl(id1)))
            ug578_12(iut,jut)%c(1,2) = u578_12(iut,jut)%c(1,2)
     &           /((fcl(id5))*(fcl(id1)))
            ug578_12(iut,jut)%c(2,1) = u578_12(iut,jut)%c(2,1)
     &           /((fcl(id5))*(fcl(id1)))
            ug578_12(iut,jut)%d(1,1) = u578_12(iut,jut)%d(1,1)
     &           /((fcl(id5))*(fcl(id1)))
            ug578_12(iut,jut)%d(2,2) = u578_12(iut,jut)%d(2,2)
     &           /((fcl(id5))*(fcl(id1)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug578_12(iut,jut)%a(1,1) = czero
            ug578_12(iut,jut)%a(2,2) = czero
            ug578_12(iut,jut)%b(1,2) = czero
            ug578_12(iut,jut)%b(2,1) = czero
            ug578_12(iut,jut)%c(1,2) = czero
            ug578_12(iut,jut)%c(2,1) = czero
            ug578_12(iut,jut)%d(1,1) = czero
            ug578_12(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p578,q=p634
      quqd=p578(0)*p634(0)-p578(1)*p634(1)-p578(2)*p634(2)-p578(
     & 3)*p634(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p578,qd=p634,v=cz12(i1,i2)%e,a=u578_12(i1,i2)%a,b=u578_12(i1,i
* 2)%b,c=u578_12(i1,i2)%c,d=u578_12(i1,i2)%d,cr=zcr(id5),cl=zcl(id5),nsu
* m=1
      ceps_0=-cz12(i1,i2)%ek0*(p578(2)*p634(3)-p634(2)*p578(3))+
     & p578k0*(cz12(i1,i2)%e(2)*p634(3)-p634(2)*cz12(i1,i2)%e(3)
     & )-p634k0*(cz12(i1,i2)%e(2)*p578(3)-p578(2)*cz12(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz12(i1,i2)%e(3)*p578k0+p578(3)*cz12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz12(i1,i2)%e(3)*p634k0+p634(3)*cz12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz12(i1,i2)%e(0)*p578(0)-cz12(i1,i2)%e(1)*p578(1)-cz1
     & 2(i1,i2)%e(2)*p578(2)-cz12(i1,i2)%e(3)*p578(3)
      cvqd=cz12(i1,i2)%e(0)*p634(0)-cz12(i1,i2)%e(1)*p634(1)-cz1
     & 2(i1,i2)%e(2)*p634(2)-cz12(i1,i2)%e(3)*p634(3)
      cauxa=-cz12(i1,i2)%ek0*quqd+p578k0*cvqd+p634k0*cvqu
      cauxb=-cz12(i1,i2)%ek0*p634(2)+p634k0*cz12(i1,i2)%e(2)
      cauxc=+cz12(i1,i2)%ek0*p578(2)-p578k0*cz12(i1,i2)%e(2)
      u578_12(i1,i2)%a(1,1)=u578_12(i1,i2)%a(1,1)+zcr(id5)*(caux
     & a+ceps_0)
      u578_12(i1,i2)%a(2,2)=u578_12(i1,i2)%a(2,2)+zcl(id5)*(caux
     & a-ceps_0)
      u578_12(i1,i2)%b(1,2)=u578_12(i1,i2)%b(1,2)+zcl(id5)*(caux
     & b-ceps_2)
      u578_12(i1,i2)%b(2,1)=u578_12(i1,i2)%b(2,1)+zcr(id5)*(-cau
     & xb-ceps_2)
      u578_12(i1,i2)%c(1,2)=u578_12(i1,i2)%c(1,2)+zcr(id5)*(caux
     & c+ceps_1)
      u578_12(i1,i2)%c(2,1)=u578_12(i1,i2)%c(2,1)+zcl(id5)*(-cau
     & xc+ceps_1)
      u578_12(i1,i2)%d(1,1)=u578_12(i1,i2)%d(1,1)+zcl(id5)*cz12(
     & i1,i2)%ek0
      u578_12(i1,i2)%d(2,2)=u578_12(i1,i2)%d(2,2)+zcr(id5)*cz12(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.id1.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p578,qd=p634,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p578k0*p634(2)+p634k0*p578(2)
      cauxa=auxa-cim*(p634(3)*p578k0-p578(3)*p634k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p634k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p578k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u578_12(i1,i2)%a(i3,i4)=ch12(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u578_12(i1,i2)%b(i3,i4)=ch12(i1,i2)
     &                 *clineth%b(i3,i4)
                  u578_12(i1,i2)%c(i3,i4)=ch12(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u578_12(i1,i2)%a(i3,i4)=czero
                else
                  u578_12(i1,i2)%b(i3,i4)=czero
                  u578_12(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id5).ne.1) then
* quqd -- p=p578,q=p612
      quqd=p578(0)*p612(0)-p578(1)*p612(1)-p578(2)*p612(2)-p578(
     & 3)*p612(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p578,qd=p612,v=cf34(i1,i2)%e,a=u578_34(i1,i2)%a,b=u578_34(i1,i
* 2)%b,c=u578_34(i1,i2)%c,d=u578_34(i1,i2)%d,cr=fcr(id5),cl=fcl(id5),nsu
* m=0
      ceps_0=-cf34(i1,i2)%ek0*(p578(2)*p612(3)-p612(2)*p578(3))+
     & p578k0*(cf34(i1,i2)%e(2)*p612(3)-p612(2)*cf34(i1,i2)%e(3)
     & )-p612k0*(cf34(i1,i2)%e(2)*p578(3)-p578(2)*cf34(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf34(i1,i2)%e(3)*p578k0+p578(3)*cf34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf34(i1,i2)%e(3)*p612k0+p612(3)*cf34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf34(i1,i2)%e(0)*p578(0)-cf34(i1,i2)%e(1)*p578(1)-cf3
     & 4(i1,i2)%e(2)*p578(2)-cf34(i1,i2)%e(3)*p578(3)
      cvqd=cf34(i1,i2)%e(0)*p612(0)-cf34(i1,i2)%e(1)*p612(1)-cf3
     & 4(i1,i2)%e(2)*p612(2)-cf34(i1,i2)%e(3)*p612(3)
      cauxa=-cf34(i1,i2)%ek0*quqd+p578k0*cvqd+p612k0*cvqu
      cauxb=-cf34(i1,i2)%ek0*p612(2)+p612k0*cf34(i1,i2)%e(2)
      cauxc=+cf34(i1,i2)%ek0*p578(2)-p578k0*cf34(i1,i2)%e(2)
      u578_34(i1,i2)%a(1,1)=fcr(id5)*(cauxa+ceps_0)
      u578_34(i1,i2)%a(2,2)=fcl(id5)*(cauxa-ceps_0)
      u578_34(i1,i2)%b(1,2)=fcl(id5)*(cauxb-ceps_2)
      u578_34(i1,i2)%b(2,1)=fcr(id5)*(-cauxb-ceps_2)
      u578_34(i1,i2)%c(1,2)=fcr(id5)*(cauxc+ceps_1)
      u578_34(i1,i2)%c(2,1)=fcl(id5)*(-cauxc+ceps_1)
      u578_34(i1,i2)%d(1,1)=fcl(id5)*cf34(i1,i2)%ek0
      u578_34(i1,i2)%d(2,2)=fcr(id5)*cf34(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u578_34(i1,i2)%a(iut,jut)=czero
                u578_34(i1,i2)%b(iut,jut)=czero
                u578_34(i1,i2)%c(iut,jut)=czero
                u578_34(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id5).ne.1 .and. ilept(id3).ne.1) then
        do iut=1,2
          do jut=1,2
            ug578_34(iut,jut)%a(1,1) = u578_34(iut,jut)%a(1,1)
     &           /((fcl(id5))*(fcl(id3)))
            ug578_34(iut,jut)%a(2,2) = u578_34(iut,jut)%a(2,2)
     &           /((fcl(id5))*(fcl(id3)))
            ug578_34(iut,jut)%b(1,2) = u578_34(iut,jut)%b(1,2)
     &           /((fcl(id5))*(fcl(id3)))
            ug578_34(iut,jut)%b(2,1) = u578_34(iut,jut)%b(2,1)
     &           /((fcl(id5))*(fcl(id3)))
            ug578_34(iut,jut)%c(1,2) = u578_34(iut,jut)%c(1,2)
     &           /((fcl(id5))*(fcl(id3)))
            ug578_34(iut,jut)%c(2,1) = u578_34(iut,jut)%c(2,1)
     &           /((fcl(id5))*(fcl(id3)))
            ug578_34(iut,jut)%d(1,1) = u578_34(iut,jut)%d(1,1)
     &           /((fcl(id5))*(fcl(id3)))
            ug578_34(iut,jut)%d(2,2) = u578_34(iut,jut)%d(2,2)
     &           /((fcl(id5))*(fcl(id3)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug578_34(iut,jut)%a(1,1) = czero
            ug578_34(iut,jut)%a(2,2) = czero
            ug578_34(iut,jut)%b(1,2) = czero
            ug578_34(iut,jut)%b(2,1) = czero
            ug578_34(iut,jut)%c(1,2) = czero
            ug578_34(iut,jut)%c(2,1) = czero
            ug578_34(iut,jut)%d(1,1) = czero
            ug578_34(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p578,q=p612
      quqd=p578(0)*p612(0)-p578(1)*p612(1)-p578(2)*p612(2)-p578(
     & 3)*p612(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p578,qd=p612,v=cz34(i1,i2)%e,a=u578_34(i1,i2)%a,b=u578_34(i1,i
* 2)%b,c=u578_34(i1,i2)%c,d=u578_34(i1,i2)%d,cr=zcr(id5),cl=zcl(id5),nsu
* m=1
      ceps_0=-cz34(i1,i2)%ek0*(p578(2)*p612(3)-p612(2)*p578(3))+
     & p578k0*(cz34(i1,i2)%e(2)*p612(3)-p612(2)*cz34(i1,i2)%e(3)
     & )-p612k0*(cz34(i1,i2)%e(2)*p578(3)-p578(2)*cz34(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz34(i1,i2)%e(3)*p578k0+p578(3)*cz34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz34(i1,i2)%e(3)*p612k0+p612(3)*cz34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz34(i1,i2)%e(0)*p578(0)-cz34(i1,i2)%e(1)*p578(1)-cz3
     & 4(i1,i2)%e(2)*p578(2)-cz34(i1,i2)%e(3)*p578(3)
      cvqd=cz34(i1,i2)%e(0)*p612(0)-cz34(i1,i2)%e(1)*p612(1)-cz3
     & 4(i1,i2)%e(2)*p612(2)-cz34(i1,i2)%e(3)*p612(3)
      cauxa=-cz34(i1,i2)%ek0*quqd+p578k0*cvqd+p612k0*cvqu
      cauxb=-cz34(i1,i2)%ek0*p612(2)+p612k0*cz34(i1,i2)%e(2)
      cauxc=+cz34(i1,i2)%ek0*p578(2)-p578k0*cz34(i1,i2)%e(2)
      u578_34(i1,i2)%a(1,1)=u578_34(i1,i2)%a(1,1)+zcr(id5)*(caux
     & a+ceps_0)
      u578_34(i1,i2)%a(2,2)=u578_34(i1,i2)%a(2,2)+zcl(id5)*(caux
     & a-ceps_0)
      u578_34(i1,i2)%b(1,2)=u578_34(i1,i2)%b(1,2)+zcl(id5)*(caux
     & b-ceps_2)
      u578_34(i1,i2)%b(2,1)=u578_34(i1,i2)%b(2,1)+zcr(id5)*(-cau
     & xb-ceps_2)
      u578_34(i1,i2)%c(1,2)=u578_34(i1,i2)%c(1,2)+zcr(id5)*(caux
     & c+ceps_1)
      u578_34(i1,i2)%c(2,1)=u578_34(i1,i2)%c(2,1)+zcl(id5)*(-cau
     & xc+ceps_1)
      u578_34(i1,i2)%d(1,1)=u578_34(i1,i2)%d(1,1)+zcl(id5)*cz34(
     & i1,i2)%ek0
      u578_34(i1,i2)%d(2,2)=u578_34(i1,i2)%d(2,2)+zcr(id5)*cz34(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.id3.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p578,qd=p612,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p578k0*p612(2)+p612k0*p578(2)
      cauxa=auxa-cim*(p612(3)*p578k0-p578(3)*p612k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p612k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p578k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u578_34(i1,i2)%a(i3,i4)=ch34(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u578_34(i1,i2)%b(i3,i4)=ch34(i1,i2)
     &                 *clineth%b(i3,i4)
                  u578_34(i1,i2)%c(i3,i4)=ch34(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u578_34(i1,i2)%a(i3,i4)=czero
                else
                  u578_34(i1,i2)%b(i3,i4)=czero
                  u578_34(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id7).ne.1) then
* quqd -- p=p712,q=p856
      quqd=p712(0)*p856(0)-p712(1)*p856(1)-p712(2)*p856(2)-p712(
     & 3)*p856(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p712,qd=p856,v=cf34(i1,i2)%e,a=u712_34(i1,i2)%a,b=u712_34(i1,i
* 2)%b,c=u712_34(i1,i2)%c,d=u712_34(i1,i2)%d,cr=fcr(id7),cl=fcl(id7),nsu
* m=0
      ceps_0=-cf34(i1,i2)%ek0*(p712(2)*p856(3)-p856(2)*p712(3))+
     & p712k0*(cf34(i1,i2)%e(2)*p856(3)-p856(2)*cf34(i1,i2)%e(3)
     & )-p856k0*(cf34(i1,i2)%e(2)*p712(3)-p712(2)*cf34(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf34(i1,i2)%e(3)*p712k0+p712(3)*cf34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf34(i1,i2)%e(3)*p856k0+p856(3)*cf34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf34(i1,i2)%e(0)*p712(0)-cf34(i1,i2)%e(1)*p712(1)-cf3
     & 4(i1,i2)%e(2)*p712(2)-cf34(i1,i2)%e(3)*p712(3)
      cvqd=cf34(i1,i2)%e(0)*p856(0)-cf34(i1,i2)%e(1)*p856(1)-cf3
     & 4(i1,i2)%e(2)*p856(2)-cf34(i1,i2)%e(3)*p856(3)
      cauxa=-cf34(i1,i2)%ek0*quqd+p712k0*cvqd+p856k0*cvqu
      cauxb=-cf34(i1,i2)%ek0*p856(2)+p856k0*cf34(i1,i2)%e(2)
      cauxc=+cf34(i1,i2)%ek0*p712(2)-p712k0*cf34(i1,i2)%e(2)
      u712_34(i1,i2)%a(1,1)=fcr(id7)*(cauxa+ceps_0)
      u712_34(i1,i2)%a(2,2)=fcl(id7)*(cauxa-ceps_0)
      u712_34(i1,i2)%b(1,2)=fcl(id7)*(cauxb-ceps_2)
      u712_34(i1,i2)%b(2,1)=fcr(id7)*(-cauxb-ceps_2)
      u712_34(i1,i2)%c(1,2)=fcr(id7)*(cauxc+ceps_1)
      u712_34(i1,i2)%c(2,1)=fcl(id7)*(-cauxc+ceps_1)
      u712_34(i1,i2)%d(1,1)=fcl(id7)*cf34(i1,i2)%ek0
      u712_34(i1,i2)%d(2,2)=fcr(id7)*cf34(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u712_34(i1,i2)%a(iut,jut)=czero
                u712_34(i1,i2)%b(iut,jut)=czero
                u712_34(i1,i2)%c(iut,jut)=czero
                u712_34(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id7).ne.1 .and. ilept(id3).ne.1) then
        do iut=1,2
          do jut=1,2
            ug712_34(iut,jut)%a(1,1) = u712_34(iut,jut)%a(1,1)
     &           /((fcl(id7))*(fcl(id3)))
            ug712_34(iut,jut)%a(2,2) = u712_34(iut,jut)%a(2,2)
     &           /((fcl(id7))*(fcl(id3)))
            ug712_34(iut,jut)%b(1,2) = u712_34(iut,jut)%b(1,2)
     &           /((fcl(id7))*(fcl(id3)))
            ug712_34(iut,jut)%b(2,1) = u712_34(iut,jut)%b(2,1)
     &           /((fcl(id7))*(fcl(id3)))
            ug712_34(iut,jut)%c(1,2) = u712_34(iut,jut)%c(1,2)
     &           /((fcl(id7))*(fcl(id3)))
            ug712_34(iut,jut)%c(2,1) = u712_34(iut,jut)%c(2,1)
     &           /((fcl(id7))*(fcl(id3)))
            ug712_34(iut,jut)%d(1,1) = u712_34(iut,jut)%d(1,1)
     &           /((fcl(id7))*(fcl(id3)))
            ug712_34(iut,jut)%d(2,2) = u712_34(iut,jut)%d(2,2)
     &           /((fcl(id7))*(fcl(id3)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug712_34(iut,jut)%a(1,1) = czero
            ug712_34(iut,jut)%a(2,2) = czero
            ug712_34(iut,jut)%b(1,2) = czero
            ug712_34(iut,jut)%b(2,1) = czero
            ug712_34(iut,jut)%c(1,2) = czero
            ug712_34(iut,jut)%c(2,1) = czero
            ug712_34(iut,jut)%d(1,1) = czero
            ug712_34(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p712,q=p856
      quqd=p712(0)*p856(0)-p712(1)*p856(1)-p712(2)*p856(2)-p712(
     & 3)*p856(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p712,qd=p856,v=cz34(i1,i2)%e,a=u712_34(i1,i2)%a,b=u712_34(i1,i
* 2)%b,c=u712_34(i1,i2)%c,d=u712_34(i1,i2)%d,cr=zcr(id7),cl=zcl(id7),nsu
* m=1
      ceps_0=-cz34(i1,i2)%ek0*(p712(2)*p856(3)-p856(2)*p712(3))+
     & p712k0*(cz34(i1,i2)%e(2)*p856(3)-p856(2)*cz34(i1,i2)%e(3)
     & )-p856k0*(cz34(i1,i2)%e(2)*p712(3)-p712(2)*cz34(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz34(i1,i2)%e(3)*p712k0+p712(3)*cz34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz34(i1,i2)%e(3)*p856k0+p856(3)*cz34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz34(i1,i2)%e(0)*p712(0)-cz34(i1,i2)%e(1)*p712(1)-cz3
     & 4(i1,i2)%e(2)*p712(2)-cz34(i1,i2)%e(3)*p712(3)
      cvqd=cz34(i1,i2)%e(0)*p856(0)-cz34(i1,i2)%e(1)*p856(1)-cz3
     & 4(i1,i2)%e(2)*p856(2)-cz34(i1,i2)%e(3)*p856(3)
      cauxa=-cz34(i1,i2)%ek0*quqd+p712k0*cvqd+p856k0*cvqu
      cauxb=-cz34(i1,i2)%ek0*p856(2)+p856k0*cz34(i1,i2)%e(2)
      cauxc=+cz34(i1,i2)%ek0*p712(2)-p712k0*cz34(i1,i2)%e(2)
      u712_34(i1,i2)%a(1,1)=u712_34(i1,i2)%a(1,1)+zcr(id7)*(caux
     & a+ceps_0)
      u712_34(i1,i2)%a(2,2)=u712_34(i1,i2)%a(2,2)+zcl(id7)*(caux
     & a-ceps_0)
      u712_34(i1,i2)%b(1,2)=u712_34(i1,i2)%b(1,2)+zcl(id7)*(caux
     & b-ceps_2)
      u712_34(i1,i2)%b(2,1)=u712_34(i1,i2)%b(2,1)+zcr(id7)*(-cau
     & xb-ceps_2)
      u712_34(i1,i2)%c(1,2)=u712_34(i1,i2)%c(1,2)+zcr(id7)*(caux
     & c+ceps_1)
      u712_34(i1,i2)%c(2,1)=u712_34(i1,i2)%c(2,1)+zcl(id7)*(-cau
     & xc+ceps_1)
      u712_34(i1,i2)%d(1,1)=u712_34(i1,i2)%d(1,1)+zcl(id7)*cz34(
     & i1,i2)%ek0
      u712_34(i1,i2)%d(2,2)=u712_34(i1,i2)%d(2,2)+zcr(id7)*cz34(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id7.eq.5.and.id3.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p712,qd=p856,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p712k0*p856(2)+p856k0*p712(2)
      cauxa=auxa-cim*(p856(3)*p712k0-p712(3)*p856k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p856k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p712k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u712_34(i1,i2)%a(i3,i4)=ch34(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u712_34(i1,i2)%b(i3,i4)=ch34(i1,i2)
     &                 *clineth%b(i3,i4)
                  u712_34(i1,i2)%c(i3,i4)=ch34(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u712_34(i1,i2)%a(i3,i4)=czero
                else
                  u712_34(i1,i2)%b(i3,i4)=czero
                  u712_34(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id7).ne.1) then
* quqd -- p=p712,q=p834
      quqd=p712(0)*p834(0)-p712(1)*p834(1)-p712(2)*p834(2)-p712(
     & 3)*p834(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p712,qd=p834,v=cf56(i1,i2)%e,a=u712_56(i1,i2)%a,b=u712_56(i1,i
* 2)%b,c=u712_56(i1,i2)%c,d=u712_56(i1,i2)%d,cr=fcr(id7),cl=fcl(id7),nsu
* m=0
      ceps_0=-cf56(i1,i2)%ek0*(p712(2)*p834(3)-p834(2)*p712(3))+
     & p712k0*(cf56(i1,i2)%e(2)*p834(3)-p834(2)*cf56(i1,i2)%e(3)
     & )-p834k0*(cf56(i1,i2)%e(2)*p712(3)-p712(2)*cf56(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf56(i1,i2)%e(3)*p712k0+p712(3)*cf56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf56(i1,i2)%e(3)*p834k0+p834(3)*cf56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf56(i1,i2)%e(0)*p712(0)-cf56(i1,i2)%e(1)*p712(1)-cf5
     & 6(i1,i2)%e(2)*p712(2)-cf56(i1,i2)%e(3)*p712(3)
      cvqd=cf56(i1,i2)%e(0)*p834(0)-cf56(i1,i2)%e(1)*p834(1)-cf5
     & 6(i1,i2)%e(2)*p834(2)-cf56(i1,i2)%e(3)*p834(3)
      cauxa=-cf56(i1,i2)%ek0*quqd+p712k0*cvqd+p834k0*cvqu
      cauxb=-cf56(i1,i2)%ek0*p834(2)+p834k0*cf56(i1,i2)%e(2)
      cauxc=+cf56(i1,i2)%ek0*p712(2)-p712k0*cf56(i1,i2)%e(2)
      u712_56(i1,i2)%a(1,1)=fcr(id7)*(cauxa+ceps_0)
      u712_56(i1,i2)%a(2,2)=fcl(id7)*(cauxa-ceps_0)
      u712_56(i1,i2)%b(1,2)=fcl(id7)*(cauxb-ceps_2)
      u712_56(i1,i2)%b(2,1)=fcr(id7)*(-cauxb-ceps_2)
      u712_56(i1,i2)%c(1,2)=fcr(id7)*(cauxc+ceps_1)
      u712_56(i1,i2)%c(2,1)=fcl(id7)*(-cauxc+ceps_1)
      u712_56(i1,i2)%d(1,1)=fcl(id7)*cf56(i1,i2)%ek0
      u712_56(i1,i2)%d(2,2)=fcr(id7)*cf56(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u712_56(i1,i2)%a(iut,jut)=czero
                u712_56(i1,i2)%b(iut,jut)=czero
                u712_56(i1,i2)%c(iut,jut)=czero
                u712_56(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id7).ne.1 .and. ilept(id5).ne.1) then
        do iut=1,2
          do jut=1,2
            ug712_56(iut,jut)%a(1,1) = u712_56(iut,jut)%a(1,1)
     &           /((fcl(id7))*(fcl(id5)))
            ug712_56(iut,jut)%a(2,2) = u712_56(iut,jut)%a(2,2)
     &           /((fcl(id7))*(fcl(id5)))
            ug712_56(iut,jut)%b(1,2) = u712_56(iut,jut)%b(1,2)
     &           /((fcl(id7))*(fcl(id5)))
            ug712_56(iut,jut)%b(2,1) = u712_56(iut,jut)%b(2,1)
     &           /((fcl(id7))*(fcl(id5)))
            ug712_56(iut,jut)%c(1,2) = u712_56(iut,jut)%c(1,2)
     &           /((fcl(id7))*(fcl(id5)))
            ug712_56(iut,jut)%c(2,1) = u712_56(iut,jut)%c(2,1)
     &           /((fcl(id7))*(fcl(id5)))
            ug712_56(iut,jut)%d(1,1) = u712_56(iut,jut)%d(1,1)
     &           /((fcl(id7))*(fcl(id5)))
            ug712_56(iut,jut)%d(2,2) = u712_56(iut,jut)%d(2,2)
     &           /((fcl(id7))*(fcl(id5)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug712_56(iut,jut)%a(1,1) = czero
            ug712_56(iut,jut)%a(2,2) = czero
            ug712_56(iut,jut)%b(1,2) = czero
            ug712_56(iut,jut)%b(2,1) = czero
            ug712_56(iut,jut)%c(1,2) = czero
            ug712_56(iut,jut)%c(2,1) = czero
            ug712_56(iut,jut)%d(1,1) = czero
            ug712_56(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p712,q=p834
      quqd=p712(0)*p834(0)-p712(1)*p834(1)-p712(2)*p834(2)-p712(
     & 3)*p834(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p712,qd=p834,v=cz56(i1,i2)%e,a=u712_56(i1,i2)%a,b=u712_56(i1,i
* 2)%b,c=u712_56(i1,i2)%c,d=u712_56(i1,i2)%d,cr=zcr(id7),cl=zcl(id7),nsu
* m=1
      ceps_0=-cz56(i1,i2)%ek0*(p712(2)*p834(3)-p834(2)*p712(3))+
     & p712k0*(cz56(i1,i2)%e(2)*p834(3)-p834(2)*cz56(i1,i2)%e(3)
     & )-p834k0*(cz56(i1,i2)%e(2)*p712(3)-p712(2)*cz56(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz56(i1,i2)%e(3)*p712k0+p712(3)*cz56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz56(i1,i2)%e(3)*p834k0+p834(3)*cz56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz56(i1,i2)%e(0)*p712(0)-cz56(i1,i2)%e(1)*p712(1)-cz5
     & 6(i1,i2)%e(2)*p712(2)-cz56(i1,i2)%e(3)*p712(3)
      cvqd=cz56(i1,i2)%e(0)*p834(0)-cz56(i1,i2)%e(1)*p834(1)-cz5
     & 6(i1,i2)%e(2)*p834(2)-cz56(i1,i2)%e(3)*p834(3)
      cauxa=-cz56(i1,i2)%ek0*quqd+p712k0*cvqd+p834k0*cvqu
      cauxb=-cz56(i1,i2)%ek0*p834(2)+p834k0*cz56(i1,i2)%e(2)
      cauxc=+cz56(i1,i2)%ek0*p712(2)-p712k0*cz56(i1,i2)%e(2)
      u712_56(i1,i2)%a(1,1)=u712_56(i1,i2)%a(1,1)+zcr(id7)*(caux
     & a+ceps_0)
      u712_56(i1,i2)%a(2,2)=u712_56(i1,i2)%a(2,2)+zcl(id7)*(caux
     & a-ceps_0)
      u712_56(i1,i2)%b(1,2)=u712_56(i1,i2)%b(1,2)+zcl(id7)*(caux
     & b-ceps_2)
      u712_56(i1,i2)%b(2,1)=u712_56(i1,i2)%b(2,1)+zcr(id7)*(-cau
     & xb-ceps_2)
      u712_56(i1,i2)%c(1,2)=u712_56(i1,i2)%c(1,2)+zcr(id7)*(caux
     & c+ceps_1)
      u712_56(i1,i2)%c(2,1)=u712_56(i1,i2)%c(2,1)+zcl(id7)*(-cau
     & xc+ceps_1)
      u712_56(i1,i2)%d(1,1)=u712_56(i1,i2)%d(1,1)+zcl(id7)*cz56(
     & i1,i2)%ek0
      u712_56(i1,i2)%d(2,2)=u712_56(i1,i2)%d(2,2)+zcr(id7)*cz56(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id7.eq.5.and.id5.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p712,qd=p834,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p712k0*p834(2)+p834k0*p712(2)
      cauxa=auxa-cim*(p834(3)*p712k0-p712(3)*p834k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p834k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p712k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u712_56(i1,i2)%a(i3,i4)=ch56(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u712_56(i1,i2)%b(i3,i4)=ch56(i1,i2)
     &                 *clineth%b(i3,i4)
                  u712_56(i1,i2)%c(i3,i4)=ch56(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u712_56(i1,i2)%a(i3,i4)=czero
                else
                  u712_56(i1,i2)%b(i3,i4)=czero
                  u712_56(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id7).ne.1) then
* quqd -- p=p734,q=p856
      quqd=p734(0)*p856(0)-p734(1)*p856(1)-p734(2)*p856(2)-p734(
     & 3)*p856(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p734,qd=p856,v=cf12(i1,i2)%e,a=u734_12(i1,i2)%a,b=u734_12(i1,i
* 2)%b,c=u734_12(i1,i2)%c,d=u734_12(i1,i2)%d,cr=fcr(id7),cl=fcl(id7),nsu
* m=0
      ceps_0=-cf12(i1,i2)%ek0*(p734(2)*p856(3)-p856(2)*p734(3))+
     & p734k0*(cf12(i1,i2)%e(2)*p856(3)-p856(2)*cf12(i1,i2)%e(3)
     & )-p856k0*(cf12(i1,i2)%e(2)*p734(3)-p734(2)*cf12(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf12(i1,i2)%e(3)*p734k0+p734(3)*cf12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf12(i1,i2)%e(3)*p856k0+p856(3)*cf12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf12(i1,i2)%e(0)*p734(0)-cf12(i1,i2)%e(1)*p734(1)-cf1
     & 2(i1,i2)%e(2)*p734(2)-cf12(i1,i2)%e(3)*p734(3)
      cvqd=cf12(i1,i2)%e(0)*p856(0)-cf12(i1,i2)%e(1)*p856(1)-cf1
     & 2(i1,i2)%e(2)*p856(2)-cf12(i1,i2)%e(3)*p856(3)
      cauxa=-cf12(i1,i2)%ek0*quqd+p734k0*cvqd+p856k0*cvqu
      cauxb=-cf12(i1,i2)%ek0*p856(2)+p856k0*cf12(i1,i2)%e(2)
      cauxc=+cf12(i1,i2)%ek0*p734(2)-p734k0*cf12(i1,i2)%e(2)
      u734_12(i1,i2)%a(1,1)=fcr(id7)*(cauxa+ceps_0)
      u734_12(i1,i2)%a(2,2)=fcl(id7)*(cauxa-ceps_0)
      u734_12(i1,i2)%b(1,2)=fcl(id7)*(cauxb-ceps_2)
      u734_12(i1,i2)%b(2,1)=fcr(id7)*(-cauxb-ceps_2)
      u734_12(i1,i2)%c(1,2)=fcr(id7)*(cauxc+ceps_1)
      u734_12(i1,i2)%c(2,1)=fcl(id7)*(-cauxc+ceps_1)
      u734_12(i1,i2)%d(1,1)=fcl(id7)*cf12(i1,i2)%ek0
      u734_12(i1,i2)%d(2,2)=fcr(id7)*cf12(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u734_12(i1,i2)%a(iut,jut)=czero
                u734_12(i1,i2)%b(iut,jut)=czero
                u734_12(i1,i2)%c(iut,jut)=czero
                u734_12(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id7).ne.1 .and. ilept(id1).ne.1) then
        do iut=1,2
          do jut=1,2
            ug734_12(iut,jut)%a(1,1) = u734_12(iut,jut)%a(1,1)
     &           /((fcl(id7))*(fcl(id1)))
            ug734_12(iut,jut)%a(2,2) = u734_12(iut,jut)%a(2,2)
     &           /((fcl(id7))*(fcl(id1)))
            ug734_12(iut,jut)%b(1,2) = u734_12(iut,jut)%b(1,2)
     &           /((fcl(id7))*(fcl(id1)))
            ug734_12(iut,jut)%b(2,1) = u734_12(iut,jut)%b(2,1)
     &           /((fcl(id7))*(fcl(id1)))
            ug734_12(iut,jut)%c(1,2) = u734_12(iut,jut)%c(1,2)
     &           /((fcl(id7))*(fcl(id1)))
            ug734_12(iut,jut)%c(2,1) = u734_12(iut,jut)%c(2,1)
     &           /((fcl(id7))*(fcl(id1)))
            ug734_12(iut,jut)%d(1,1) = u734_12(iut,jut)%d(1,1)
     &           /((fcl(id7))*(fcl(id1)))
            ug734_12(iut,jut)%d(2,2) = u734_12(iut,jut)%d(2,2)
     &           /((fcl(id7))*(fcl(id1)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug734_12(iut,jut)%a(1,1) = czero
            ug734_12(iut,jut)%a(2,2) = czero
            ug734_12(iut,jut)%b(1,2) = czero
            ug734_12(iut,jut)%b(2,1) = czero
            ug734_12(iut,jut)%c(1,2) = czero
            ug734_12(iut,jut)%c(2,1) = czero
            ug734_12(iut,jut)%d(1,1) = czero
            ug734_12(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p734,q=p856
      quqd=p734(0)*p856(0)-p734(1)*p856(1)-p734(2)*p856(2)-p734(
     & 3)*p856(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p734,qd=p856,v=cz12(i1,i2)%e,a=u734_12(i1,i2)%a,b=u734_12(i1,i
* 2)%b,c=u734_12(i1,i2)%c,d=u734_12(i1,i2)%d,cr=zcr(id7),cl=zcl(id7),nsu
* m=1
      ceps_0=-cz12(i1,i2)%ek0*(p734(2)*p856(3)-p856(2)*p734(3))+
     & p734k0*(cz12(i1,i2)%e(2)*p856(3)-p856(2)*cz12(i1,i2)%e(3)
     & )-p856k0*(cz12(i1,i2)%e(2)*p734(3)-p734(2)*cz12(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz12(i1,i2)%e(3)*p734k0+p734(3)*cz12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz12(i1,i2)%e(3)*p856k0+p856(3)*cz12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz12(i1,i2)%e(0)*p734(0)-cz12(i1,i2)%e(1)*p734(1)-cz1
     & 2(i1,i2)%e(2)*p734(2)-cz12(i1,i2)%e(3)*p734(3)
      cvqd=cz12(i1,i2)%e(0)*p856(0)-cz12(i1,i2)%e(1)*p856(1)-cz1
     & 2(i1,i2)%e(2)*p856(2)-cz12(i1,i2)%e(3)*p856(3)
      cauxa=-cz12(i1,i2)%ek0*quqd+p734k0*cvqd+p856k0*cvqu
      cauxb=-cz12(i1,i2)%ek0*p856(2)+p856k0*cz12(i1,i2)%e(2)
      cauxc=+cz12(i1,i2)%ek0*p734(2)-p734k0*cz12(i1,i2)%e(2)
      u734_12(i1,i2)%a(1,1)=u734_12(i1,i2)%a(1,1)+zcr(id7)*(caux
     & a+ceps_0)
      u734_12(i1,i2)%a(2,2)=u734_12(i1,i2)%a(2,2)+zcl(id7)*(caux
     & a-ceps_0)
      u734_12(i1,i2)%b(1,2)=u734_12(i1,i2)%b(1,2)+zcl(id7)*(caux
     & b-ceps_2)
      u734_12(i1,i2)%b(2,1)=u734_12(i1,i2)%b(2,1)+zcr(id7)*(-cau
     & xb-ceps_2)
      u734_12(i1,i2)%c(1,2)=u734_12(i1,i2)%c(1,2)+zcr(id7)*(caux
     & c+ceps_1)
      u734_12(i1,i2)%c(2,1)=u734_12(i1,i2)%c(2,1)+zcl(id7)*(-cau
     & xc+ceps_1)
      u734_12(i1,i2)%d(1,1)=u734_12(i1,i2)%d(1,1)+zcl(id7)*cz12(
     & i1,i2)%ek0
      u734_12(i1,i2)%d(2,2)=u734_12(i1,i2)%d(2,2)+zcr(id7)*cz12(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id7.eq.5.and.id1.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p734,qd=p856,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p734k0*p856(2)+p856k0*p734(2)
      cauxa=auxa-cim*(p856(3)*p734k0-p734(3)*p856k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p856k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p734k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u734_12(i1,i2)%a(i3,i4)=ch12(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u734_12(i1,i2)%b(i3,i4)=ch12(i1,i2)
     &                 *clineth%b(i3,i4)
                  u734_12(i1,i2)%c(i3,i4)=ch12(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u734_12(i1,i2)%a(i3,i4)=czero
                else
                  u734_12(i1,i2)%b(i3,i4)=czero
                  u734_12(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id7).ne.1) then
* quqd -- p=p734,q=p812
      quqd=p734(0)*p812(0)-p734(1)*p812(1)-p734(2)*p812(2)-p734(
     & 3)*p812(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p734,qd=p812,v=cf56(i1,i2)%e,a=u734_56(i1,i2)%a,b=u734_56(i1,i
* 2)%b,c=u734_56(i1,i2)%c,d=u734_56(i1,i2)%d,cr=fcr(id7),cl=fcl(id7),nsu
* m=0
      ceps_0=-cf56(i1,i2)%ek0*(p734(2)*p812(3)-p812(2)*p734(3))+
     & p734k0*(cf56(i1,i2)%e(2)*p812(3)-p812(2)*cf56(i1,i2)%e(3)
     & )-p812k0*(cf56(i1,i2)%e(2)*p734(3)-p734(2)*cf56(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf56(i1,i2)%e(3)*p734k0+p734(3)*cf56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf56(i1,i2)%e(3)*p812k0+p812(3)*cf56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf56(i1,i2)%e(0)*p734(0)-cf56(i1,i2)%e(1)*p734(1)-cf5
     & 6(i1,i2)%e(2)*p734(2)-cf56(i1,i2)%e(3)*p734(3)
      cvqd=cf56(i1,i2)%e(0)*p812(0)-cf56(i1,i2)%e(1)*p812(1)-cf5
     & 6(i1,i2)%e(2)*p812(2)-cf56(i1,i2)%e(3)*p812(3)
      cauxa=-cf56(i1,i2)%ek0*quqd+p734k0*cvqd+p812k0*cvqu
      cauxb=-cf56(i1,i2)%ek0*p812(2)+p812k0*cf56(i1,i2)%e(2)
      cauxc=+cf56(i1,i2)%ek0*p734(2)-p734k0*cf56(i1,i2)%e(2)
      u734_56(i1,i2)%a(1,1)=fcr(id7)*(cauxa+ceps_0)
      u734_56(i1,i2)%a(2,2)=fcl(id7)*(cauxa-ceps_0)
      u734_56(i1,i2)%b(1,2)=fcl(id7)*(cauxb-ceps_2)
      u734_56(i1,i2)%b(2,1)=fcr(id7)*(-cauxb-ceps_2)
      u734_56(i1,i2)%c(1,2)=fcr(id7)*(cauxc+ceps_1)
      u734_56(i1,i2)%c(2,1)=fcl(id7)*(-cauxc+ceps_1)
      u734_56(i1,i2)%d(1,1)=fcl(id7)*cf56(i1,i2)%ek0
      u734_56(i1,i2)%d(2,2)=fcr(id7)*cf56(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u734_56(i1,i2)%a(iut,jut)=czero
                u734_56(i1,i2)%b(iut,jut)=czero
                u734_56(i1,i2)%c(iut,jut)=czero
                u734_56(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id7).ne.1 .and. ilept(id5).ne.1) then
        do iut=1,2
          do jut=1,2
            ug734_56(iut,jut)%a(1,1) = u734_56(iut,jut)%a(1,1)
     &           /((fcl(id7))*(fcl(id5)))
            ug734_56(iut,jut)%a(2,2) = u734_56(iut,jut)%a(2,2)
     &           /((fcl(id7))*(fcl(id5)))
            ug734_56(iut,jut)%b(1,2) = u734_56(iut,jut)%b(1,2)
     &           /((fcl(id7))*(fcl(id5)))
            ug734_56(iut,jut)%b(2,1) = u734_56(iut,jut)%b(2,1)
     &           /((fcl(id7))*(fcl(id5)))
            ug734_56(iut,jut)%c(1,2) = u734_56(iut,jut)%c(1,2)
     &           /((fcl(id7))*(fcl(id5)))
            ug734_56(iut,jut)%c(2,1) = u734_56(iut,jut)%c(2,1)
     &           /((fcl(id7))*(fcl(id5)))
            ug734_56(iut,jut)%d(1,1) = u734_56(iut,jut)%d(1,1)
     &           /((fcl(id7))*(fcl(id5)))
            ug734_56(iut,jut)%d(2,2) = u734_56(iut,jut)%d(2,2)
     &           /((fcl(id7))*(fcl(id5)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug734_56(iut,jut)%a(1,1) = czero
            ug734_56(iut,jut)%a(2,2) = czero
            ug734_56(iut,jut)%b(1,2) = czero
            ug734_56(iut,jut)%b(2,1) = czero
            ug734_56(iut,jut)%c(1,2) = czero
            ug734_56(iut,jut)%c(2,1) = czero
            ug734_56(iut,jut)%d(1,1) = czero
            ug734_56(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p734,q=p812
      quqd=p734(0)*p812(0)-p734(1)*p812(1)-p734(2)*p812(2)-p734(
     & 3)*p812(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p734,qd=p812,v=cz56(i1,i2)%e,a=u734_56(i1,i2)%a,b=u734_56(i1,i
* 2)%b,c=u734_56(i1,i2)%c,d=u734_56(i1,i2)%d,cr=zcr(id7),cl=zcl(id7),nsu
* m=1
      ceps_0=-cz56(i1,i2)%ek0*(p734(2)*p812(3)-p812(2)*p734(3))+
     & p734k0*(cz56(i1,i2)%e(2)*p812(3)-p812(2)*cz56(i1,i2)%e(3)
     & )-p812k0*(cz56(i1,i2)%e(2)*p734(3)-p734(2)*cz56(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz56(i1,i2)%e(3)*p734k0+p734(3)*cz56(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz56(i1,i2)%e(3)*p812k0+p812(3)*cz56(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz56(i1,i2)%e(0)*p734(0)-cz56(i1,i2)%e(1)*p734(1)-cz5
     & 6(i1,i2)%e(2)*p734(2)-cz56(i1,i2)%e(3)*p734(3)
      cvqd=cz56(i1,i2)%e(0)*p812(0)-cz56(i1,i2)%e(1)*p812(1)-cz5
     & 6(i1,i2)%e(2)*p812(2)-cz56(i1,i2)%e(3)*p812(3)
      cauxa=-cz56(i1,i2)%ek0*quqd+p734k0*cvqd+p812k0*cvqu
      cauxb=-cz56(i1,i2)%ek0*p812(2)+p812k0*cz56(i1,i2)%e(2)
      cauxc=+cz56(i1,i2)%ek0*p734(2)-p734k0*cz56(i1,i2)%e(2)
      u734_56(i1,i2)%a(1,1)=u734_56(i1,i2)%a(1,1)+zcr(id7)*(caux
     & a+ceps_0)
      u734_56(i1,i2)%a(2,2)=u734_56(i1,i2)%a(2,2)+zcl(id7)*(caux
     & a-ceps_0)
      u734_56(i1,i2)%b(1,2)=u734_56(i1,i2)%b(1,2)+zcl(id7)*(caux
     & b-ceps_2)
      u734_56(i1,i2)%b(2,1)=u734_56(i1,i2)%b(2,1)+zcr(id7)*(-cau
     & xb-ceps_2)
      u734_56(i1,i2)%c(1,2)=u734_56(i1,i2)%c(1,2)+zcr(id7)*(caux
     & c+ceps_1)
      u734_56(i1,i2)%c(2,1)=u734_56(i1,i2)%c(2,1)+zcl(id7)*(-cau
     & xc+ceps_1)
      u734_56(i1,i2)%d(1,1)=u734_56(i1,i2)%d(1,1)+zcl(id7)*cz56(
     & i1,i2)%ek0
      u734_56(i1,i2)%d(2,2)=u734_56(i1,i2)%d(2,2)+zcr(id7)*cz56(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id7.eq.5.and.id5.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p734,qd=p812,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p734k0*p812(2)+p812k0*p734(2)
      cauxa=auxa-cim*(p812(3)*p734k0-p734(3)*p812k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p812k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p734k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u734_56(i1,i2)%a(i3,i4)=ch56(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u734_56(i1,i2)%b(i3,i4)=ch56(i1,i2)
     &                 *clineth%b(i3,i4)
                  u734_56(i1,i2)%c(i3,i4)=ch56(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u734_56(i1,i2)%a(i3,i4)=czero
                else
                  u734_56(i1,i2)%b(i3,i4)=czero
                  u734_56(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id7).ne.1) then
* quqd -- p=p756,q=p834
      quqd=p756(0)*p834(0)-p756(1)*p834(1)-p756(2)*p834(2)-p756(
     & 3)*p834(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p756,qd=p834,v=cf12(i1,i2)%e,a=u756_12(i1,i2)%a,b=u756_12(i1,i
* 2)%b,c=u756_12(i1,i2)%c,d=u756_12(i1,i2)%d,cr=fcr(id7),cl=fcl(id7),nsu
* m=0
      ceps_0=-cf12(i1,i2)%ek0*(p756(2)*p834(3)-p834(2)*p756(3))+
     & p756k0*(cf12(i1,i2)%e(2)*p834(3)-p834(2)*cf12(i1,i2)%e(3)
     & )-p834k0*(cf12(i1,i2)%e(2)*p756(3)-p756(2)*cf12(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf12(i1,i2)%e(3)*p756k0+p756(3)*cf12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf12(i1,i2)%e(3)*p834k0+p834(3)*cf12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf12(i1,i2)%e(0)*p756(0)-cf12(i1,i2)%e(1)*p756(1)-cf1
     & 2(i1,i2)%e(2)*p756(2)-cf12(i1,i2)%e(3)*p756(3)
      cvqd=cf12(i1,i2)%e(0)*p834(0)-cf12(i1,i2)%e(1)*p834(1)-cf1
     & 2(i1,i2)%e(2)*p834(2)-cf12(i1,i2)%e(3)*p834(3)
      cauxa=-cf12(i1,i2)%ek0*quqd+p756k0*cvqd+p834k0*cvqu
      cauxb=-cf12(i1,i2)%ek0*p834(2)+p834k0*cf12(i1,i2)%e(2)
      cauxc=+cf12(i1,i2)%ek0*p756(2)-p756k0*cf12(i1,i2)%e(2)
      u756_12(i1,i2)%a(1,1)=fcr(id7)*(cauxa+ceps_0)
      u756_12(i1,i2)%a(2,2)=fcl(id7)*(cauxa-ceps_0)
      u756_12(i1,i2)%b(1,2)=fcl(id7)*(cauxb-ceps_2)
      u756_12(i1,i2)%b(2,1)=fcr(id7)*(-cauxb-ceps_2)
      u756_12(i1,i2)%c(1,2)=fcr(id7)*(cauxc+ceps_1)
      u756_12(i1,i2)%c(2,1)=fcl(id7)*(-cauxc+ceps_1)
      u756_12(i1,i2)%d(1,1)=fcl(id7)*cf12(i1,i2)%ek0
      u756_12(i1,i2)%d(2,2)=fcr(id7)*cf12(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u756_12(i1,i2)%a(iut,jut)=czero
                u756_12(i1,i2)%b(iut,jut)=czero
                u756_12(i1,i2)%c(iut,jut)=czero
                u756_12(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id7).ne.1 .and. ilept(id1).ne.1) then
        do iut=1,2
          do jut=1,2
            ug756_12(iut,jut)%a(1,1) = u756_12(iut,jut)%a(1,1)
     &           /((fcl(id7))*(fcl(id1)))
            ug756_12(iut,jut)%a(2,2) = u756_12(iut,jut)%a(2,2)
     &           /((fcl(id7))*(fcl(id1)))
            ug756_12(iut,jut)%b(1,2) = u756_12(iut,jut)%b(1,2)
     &           /((fcl(id7))*(fcl(id1)))
            ug756_12(iut,jut)%b(2,1) = u756_12(iut,jut)%b(2,1)
     &           /((fcl(id7))*(fcl(id1)))
            ug756_12(iut,jut)%c(1,2) = u756_12(iut,jut)%c(1,2)
     &           /((fcl(id7))*(fcl(id1)))
            ug756_12(iut,jut)%c(2,1) = u756_12(iut,jut)%c(2,1)
     &           /((fcl(id7))*(fcl(id1)))
            ug756_12(iut,jut)%d(1,1) = u756_12(iut,jut)%d(1,1)
     &           /((fcl(id7))*(fcl(id1)))
            ug756_12(iut,jut)%d(2,2) = u756_12(iut,jut)%d(2,2)
     &           /((fcl(id7))*(fcl(id1)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug756_12(iut,jut)%a(1,1) = czero
            ug756_12(iut,jut)%a(2,2) = czero
            ug756_12(iut,jut)%b(1,2) = czero
            ug756_12(iut,jut)%b(2,1) = czero
            ug756_12(iut,jut)%c(1,2) = czero
            ug756_12(iut,jut)%c(2,1) = czero
            ug756_12(iut,jut)%d(1,1) = czero
            ug756_12(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p756,q=p834
      quqd=p756(0)*p834(0)-p756(1)*p834(1)-p756(2)*p834(2)-p756(
     & 3)*p834(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p756,qd=p834,v=cz12(i1,i2)%e,a=u756_12(i1,i2)%a,b=u756_12(i1,i
* 2)%b,c=u756_12(i1,i2)%c,d=u756_12(i1,i2)%d,cr=zcr(id7),cl=zcl(id7),nsu
* m=1
      ceps_0=-cz12(i1,i2)%ek0*(p756(2)*p834(3)-p834(2)*p756(3))+
     & p756k0*(cz12(i1,i2)%e(2)*p834(3)-p834(2)*cz12(i1,i2)%e(3)
     & )-p834k0*(cz12(i1,i2)%e(2)*p756(3)-p756(2)*cz12(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz12(i1,i2)%e(3)*p756k0+p756(3)*cz12(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz12(i1,i2)%e(3)*p834k0+p834(3)*cz12(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz12(i1,i2)%e(0)*p756(0)-cz12(i1,i2)%e(1)*p756(1)-cz1
     & 2(i1,i2)%e(2)*p756(2)-cz12(i1,i2)%e(3)*p756(3)
      cvqd=cz12(i1,i2)%e(0)*p834(0)-cz12(i1,i2)%e(1)*p834(1)-cz1
     & 2(i1,i2)%e(2)*p834(2)-cz12(i1,i2)%e(3)*p834(3)
      cauxa=-cz12(i1,i2)%ek0*quqd+p756k0*cvqd+p834k0*cvqu
      cauxb=-cz12(i1,i2)%ek0*p834(2)+p834k0*cz12(i1,i2)%e(2)
      cauxc=+cz12(i1,i2)%ek0*p756(2)-p756k0*cz12(i1,i2)%e(2)
      u756_12(i1,i2)%a(1,1)=u756_12(i1,i2)%a(1,1)+zcr(id7)*(caux
     & a+ceps_0)
      u756_12(i1,i2)%a(2,2)=u756_12(i1,i2)%a(2,2)+zcl(id7)*(caux
     & a-ceps_0)
      u756_12(i1,i2)%b(1,2)=u756_12(i1,i2)%b(1,2)+zcl(id7)*(caux
     & b-ceps_2)
      u756_12(i1,i2)%b(2,1)=u756_12(i1,i2)%b(2,1)+zcr(id7)*(-cau
     & xb-ceps_2)
      u756_12(i1,i2)%c(1,2)=u756_12(i1,i2)%c(1,2)+zcr(id7)*(caux
     & c+ceps_1)
      u756_12(i1,i2)%c(2,1)=u756_12(i1,i2)%c(2,1)+zcl(id7)*(-cau
     & xc+ceps_1)
      u756_12(i1,i2)%d(1,1)=u756_12(i1,i2)%d(1,1)+zcl(id7)*cz12(
     & i1,i2)%ek0
      u756_12(i1,i2)%d(2,2)=u756_12(i1,i2)%d(2,2)+zcr(id7)*cz12(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id7.eq.5.and.id1.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p756,qd=p834,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p756k0*p834(2)+p834k0*p756(2)
      cauxa=auxa-cim*(p834(3)*p756k0-p756(3)*p834k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p834k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p756k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u756_12(i1,i2)%a(i3,i4)=ch12(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u756_12(i1,i2)%b(i3,i4)=ch12(i1,i2)
     &                 *clineth%b(i3,i4)
                  u756_12(i1,i2)%c(i3,i4)=ch12(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u756_12(i1,i2)%a(i3,i4)=czero
                else
                  u756_12(i1,i2)%b(i3,i4)=czero
                  u756_12(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
*first step - compute gamma insertion                                   
      if(ineutri(id7).ne.1) then
* quqd -- p=p756,q=p812
      quqd=p756(0)*p812(0)-p756(1)*p812(1)-p756(2)*p812(2)-p756(
     & 3)*p812(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p756,qd=p812,v=cf34(i1,i2)%e,a=u756_34(i1,i2)%a,b=u756_34(i1,i
* 2)%b,c=u756_34(i1,i2)%c,d=u756_34(i1,i2)%d,cr=fcr(id7),cl=fcl(id7),nsu
* m=0
      ceps_0=-cf34(i1,i2)%ek0*(p756(2)*p812(3)-p812(2)*p756(3))+
     & p756k0*(cf34(i1,i2)%e(2)*p812(3)-p812(2)*cf34(i1,i2)%e(3)
     & )-p812k0*(cf34(i1,i2)%e(2)*p756(3)-p756(2)*cf34(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cf34(i1,i2)%e(3)*p756k0+p756(3)*cf34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cf34(i1,i2)%e(3)*p812k0+p812(3)*cf34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cf34(i1,i2)%e(0)*p756(0)-cf34(i1,i2)%e(1)*p756(1)-cf3
     & 4(i1,i2)%e(2)*p756(2)-cf34(i1,i2)%e(3)*p756(3)
      cvqd=cf34(i1,i2)%e(0)*p812(0)-cf34(i1,i2)%e(1)*p812(1)-cf3
     & 4(i1,i2)%e(2)*p812(2)-cf34(i1,i2)%e(3)*p812(3)
      cauxa=-cf34(i1,i2)%ek0*quqd+p756k0*cvqd+p812k0*cvqu
      cauxb=-cf34(i1,i2)%ek0*p812(2)+p812k0*cf34(i1,i2)%e(2)
      cauxc=+cf34(i1,i2)%ek0*p756(2)-p756k0*cf34(i1,i2)%e(2)
      u756_34(i1,i2)%a(1,1)=fcr(id7)*(cauxa+ceps_0)
      u756_34(i1,i2)%a(2,2)=fcl(id7)*(cauxa-ceps_0)
      u756_34(i1,i2)%b(1,2)=fcl(id7)*(cauxb-ceps_2)
      u756_34(i1,i2)%b(2,1)=fcr(id7)*(-cauxb-ceps_2)
      u756_34(i1,i2)%c(1,2)=fcr(id7)*(cauxc+ceps_1)
      u756_34(i1,i2)%c(2,1)=fcl(id7)*(-cauxc+ceps_1)
      u756_34(i1,i2)%d(1,1)=fcl(id7)*cf34(i1,i2)%ek0
      u756_34(i1,i2)%d(2,2)=fcr(id7)*cf34(i1,i2)%ek0
      end do
      end do
      else   ! set to zero eventual nonzero components
        do i1=1,2
          do i2=1,2
            do iut=1,2
              do jut=1,2
                u756_34(i1,i2)%a(iut,jut)=czero
                u756_34(i1,i2)%b(iut,jut)=czero
                u756_34(i1,i2)%c(iut,jut)=czero
                u756_34(i1,i2)%d(iut,jut)=czero
              enddo
            enddo
          enddo
        enddo
      endif
  
**QCD: second step - compute gluon insertion                            
      if(ilept(id7).ne.1 .and. ilept(id3).ne.1) then
        do iut=1,2
          do jut=1,2
            ug756_34(iut,jut)%a(1,1) = u756_34(iut,jut)%a(1,1)
     &           /((fcl(id7))*(fcl(id3)))
            ug756_34(iut,jut)%a(2,2) = u756_34(iut,jut)%a(2,2)
     &           /((fcl(id7))*(fcl(id3)))
            ug756_34(iut,jut)%b(1,2) = u756_34(iut,jut)%b(1,2)
     &           /((fcl(id7))*(fcl(id3)))
            ug756_34(iut,jut)%b(2,1) = u756_34(iut,jut)%b(2,1)
     &           /((fcl(id7))*(fcl(id3)))
            ug756_34(iut,jut)%c(1,2) = u756_34(iut,jut)%c(1,2)
     &           /((fcl(id7))*(fcl(id3)))
            ug756_34(iut,jut)%c(2,1) = u756_34(iut,jut)%c(2,1)
     &           /((fcl(id7))*(fcl(id3)))
            ug756_34(iut,jut)%d(1,1) = u756_34(iut,jut)%d(1,1)
     &           /((fcl(id7))*(fcl(id3)))
            ug756_34(iut,jut)%d(2,2) = u756_34(iut,jut)%d(2,2)
     &           /((fcl(id7))*(fcl(id3)))
          enddo
        enddo
      else
        do iut=1,2
          do jut=1,2
            ug756_34(iut,jut)%a(1,1) = czero
            ug756_34(iut,jut)%a(2,2) = czero
            ug756_34(iut,jut)%b(1,2) = czero
            ug756_34(iut,jut)%b(2,1) = czero
            ug756_34(iut,jut)%c(1,2) = czero
            ug756_34(iut,jut)%c(2,1) = czero
            ug756_34(iut,jut)%d(1,1) = czero
            ug756_34(iut,jut)%d(2,2) = czero
          enddo
        enddo
      endif
  
*third step - compute Z insertion and add it to the gamma one           
* quqd -- p=p756,q=p812
      quqd=p756(0)*p812(0)-p756(1)*p812(1)-p756(2)*p812(2)-p756(
     & 3)*p812(3)
      do i1=1,2
      do i2=1,2
* T -- qu=p756,qd=p812,v=cz34(i1,i2)%e,a=u756_34(i1,i2)%a,b=u756_34(i1,i
* 2)%b,c=u756_34(i1,i2)%c,d=u756_34(i1,i2)%d,cr=zcr(id7),cl=zcl(id7),nsu
* m=1
      ceps_0=-cz34(i1,i2)%ek0*(p756(2)*p812(3)-p812(2)*p756(3))+
     & p756k0*(cz34(i1,i2)%e(2)*p812(3)-p812(2)*cz34(i1,i2)%e(3)
     & )-p812k0*(cz34(i1,i2)%e(2)*p756(3)-p756(2)*cz34(i1,i2)%e(
     & 3))
      ceps_0=ceps_0*cim
      ceps_1=-cz34(i1,i2)%e(3)*p756k0+p756(3)*cz34(i1,i2)%ek0
      ceps_1=ceps_1*cim
      ceps_2=-cz34(i1,i2)%e(3)*p812k0+p812(3)*cz34(i1,i2)%ek0
      ceps_2=ceps_2*cim
      cvqu=cz34(i1,i2)%e(0)*p756(0)-cz34(i1,i2)%e(1)*p756(1)-cz3
     & 4(i1,i2)%e(2)*p756(2)-cz34(i1,i2)%e(3)*p756(3)
      cvqd=cz34(i1,i2)%e(0)*p812(0)-cz34(i1,i2)%e(1)*p812(1)-cz3
     & 4(i1,i2)%e(2)*p812(2)-cz34(i1,i2)%e(3)*p812(3)
      cauxa=-cz34(i1,i2)%ek0*quqd+p756k0*cvqd+p812k0*cvqu
      cauxb=-cz34(i1,i2)%ek0*p812(2)+p812k0*cz34(i1,i2)%e(2)
      cauxc=+cz34(i1,i2)%ek0*p756(2)-p756k0*cz34(i1,i2)%e(2)
      u756_34(i1,i2)%a(1,1)=u756_34(i1,i2)%a(1,1)+zcr(id7)*(caux
     & a+ceps_0)
      u756_34(i1,i2)%a(2,2)=u756_34(i1,i2)%a(2,2)+zcl(id7)*(caux
     & a-ceps_0)
      u756_34(i1,i2)%b(1,2)=u756_34(i1,i2)%b(1,2)+zcl(id7)*(caux
     & b-ceps_2)
      u756_34(i1,i2)%b(2,1)=u756_34(i1,i2)%b(2,1)+zcr(id7)*(-cau
     & xb-ceps_2)
      u756_34(i1,i2)%c(1,2)=u756_34(i1,i2)%c(1,2)+zcr(id7)*(caux
     & c+ceps_1)
      u756_34(i1,i2)%c(2,1)=u756_34(i1,i2)%c(2,1)+zcl(id7)*(-cau
     & xc+ceps_1)
      u756_34(i1,i2)%d(1,1)=u756_34(i1,i2)%d(1,1)+zcl(id7)*cz34(
     & i1,i2)%ek0
      u756_34(i1,i2)%d(2,2)=u756_34(i1,i2)%d(2,2)+zcr(id7)*cz34(
     & i1,i2)%ek0
      end do
      end do
  
  
*fourth step - compute higgs insertion (if required) and join it        
*together with the gamma+Z one                                          
* rmh < 0 in our convention means no higgs coupling                     
      if (id7.eq.5.and.id3.eq.5.and.rmh.ge.0.d0) then
  
* TH -- qu=p756,qd=p812,a=clineth%a,b=clineth%b,c=clineth%c,coupl=rhbb
      auxa=-p756k0*p812(2)+p812k0*p756(2)
      cauxa=auxa-cim*(p812(3)*p756k0-p756(3)*p812k0)
      clineth%a(1,2)=rhbb*cauxa
      clineth%a(2,1)=-rhbb*conjg(cauxa)
      clineth%b(1,1)=rhbb*p812k0
      clineth%b(2,2)=clineth%b(1,1)
      clineth%c(1,1)=rhbb*p756k0
      clineth%c(2,2)=clineth%c(1,1)
  
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u756_34(i1,i2)%a(i3,i4)=ch34(i1,i2)
     &                 *clineth%a(i3,i4)
                else
                  u756_34(i1,i2)%b(i3,i4)=ch34(i1,i2)
     &                 *clineth%b(i3,i4)
                  u756_34(i1,i2)%c(i3,i4)=ch34(i1,i2)
     &                 *clineth%c(i3,i4)
                endif
              enddo
            enddo
          enddo
        enddo
      else
         do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                if (i3.ne.i4) then
                  u756_34(i1,i2)%a(i3,i4)=czero
                else
                  u756_34(i1,i2)%b(i3,i4)=czero
                  u756_34(i1,i2)%c(i3,i4)=czero
                endif
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
  
  
  
* COMPUTE ALL DOUBLE INSERTIONS  OF THE TYPE UI_JKLM                    
*     FOR A ZLINE                                                       
*                                                                       
*        I __                                                           
*            |___/                                                      
*            |   \                                                      
*            |                                                          
*            |___/                                                      
*            |   \                                                      
*            |                                                          
*                                                                       
*                                                                       
**QCD                                                                   
*    and their QCD counterparts (a gluon instead of a Z/gamma/higgs     
*    insertion)                                                         
*                                                                       
*     i __            i __                                              
*         |~~~g~~~<       |_Z,f,H_/                                     
*         |               |       \                                     
*         |               |                                             
*         |_Z,f,H_/       |~~~g~~~<                                     
*         |       \       |                                             
*                                                                       
  
*Initialization of the variables to sum                                 
      do i1=1,2
       do i2=1,2
        do i3=1,2
         do i4=1,2
          do i5=1,2
           do i6=1,2
  
                u1_3456(i1,i2,i3,i4)%a(i5,i6)=czero
                u1_3456(i1,i2,i3,i4)%b(i5,i6)=czero
                u1_3456(i1,i2,i3,i4)%c(i5,i6)=czero
                u1_3456(i1,i2,i3,i4)%d(i5,i6)=czero
  
                u1_3478(i1,i2,i3,i4)%a(i5,i6)=czero
                u1_3478(i1,i2,i3,i4)%b(i5,i6)=czero
                u1_3478(i1,i2,i3,i4)%c(i5,i6)=czero
                u1_3478(i1,i2,i3,i4)%d(i5,i6)=czero
  
                u1_5678(i1,i2,i3,i4)%a(i5,i6)=czero
                u1_5678(i1,i2,i3,i4)%b(i5,i6)=czero
                u1_5678(i1,i2,i3,i4)%c(i5,i6)=czero
                u1_5678(i1,i2,i3,i4)%d(i5,i6)=czero
  
                u3_1256(i1,i2,i3,i4)%a(i5,i6)=czero
                u3_1256(i1,i2,i3,i4)%b(i5,i6)=czero
                u3_1256(i1,i2,i3,i4)%c(i5,i6)=czero
                u3_1256(i1,i2,i3,i4)%d(i5,i6)=czero
  
                u3_1278(i1,i2,i3,i4)%a(i5,i6)=czero
                u3_1278(i1,i2,i3,i4)%b(i5,i6)=czero
                u3_1278(i1,i2,i3,i4)%c(i5,i6)=czero
                u3_1278(i1,i2,i3,i4)%d(i5,i6)=czero
  
                u3_5678(i1,i2,i3,i4)%a(i5,i6)=czero
                u3_5678(i1,i2,i3,i4)%b(i5,i6)=czero
                u3_5678(i1,i2,i3,i4)%c(i5,i6)=czero
                u3_5678(i1,i2,i3,i4)%d(i5,i6)=czero
  
                u5_1234(i1,i2,i3,i4)%a(i5,i6)=czero
                u5_1234(i1,i2,i3,i4)%b(i5,i6)=czero
                u5_1234(i1,i2,i3,i4)%c(i5,i6)=czero
                u5_1234(i1,i2,i3,i4)%d(i5,i6)=czero
  
                u5_1278(i1,i2,i3,i4)%a(i5,i6)=czero
                u5_1278(i1,i2,i3,i4)%b(i5,i6)=czero
                u5_1278(i1,i2,i3,i4)%c(i5,i6)=czero
                u5_1278(i1,i2,i3,i4)%d(i5,i6)=czero
  
                u5_3478(i1,i2,i3,i4)%a(i5,i6)=czero
                u5_3478(i1,i2,i3,i4)%b(i5,i6)=czero
                u5_3478(i1,i2,i3,i4)%c(i5,i6)=czero
                u5_3478(i1,i2,i3,i4)%d(i5,i6)=czero
  
  
                u7_1234(i1,i2,i3,i4)%a(i5,i6)=czero
                u7_1234(i1,i2,i3,i4)%b(i5,i6)=czero
                u7_1234(i1,i2,i3,i4)%c(i5,i6)=czero
                u7_1234(i1,i2,i3,i4)%d(i5,i6)=czero
  
                u7_1256(i1,i2,i3,i4)%a(i5,i6)=czero
                u7_1256(i1,i2,i3,i4)%b(i5,i6)=czero
                u7_1256(i1,i2,i3,i4)%c(i5,i6)=czero
                u7_1256(i1,i2,i3,i4)%d(i5,i6)=czero
  
                u7_3456(i1,i2,i3,i4)%a(i5,i6)=czero
                u7_3456(i1,i2,i3,i4)%b(i5,i6)=czero
                u7_3456(i1,i2,i3,i4)%c(i5,i6)=czero
                u7_3456(i1,i2,i3,i4)%d(i5,i6)=czero
  
  
  
           enddo
          enddo
         enddo
        enddo
       enddo
      enddo
  
  
* p.q -- p.q=p134q,p=p134,q=p134,bef=,aft=
      p134q=(p134(0)*p134(0)-p134(1)*p134(1)-p134(2)*p134(2)-p13
     & 4(3)*p134(3))
  
      if(id1.ne.5.or.(id3.ne.5.and.id5.ne.5))then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=u1_3456(i3,i4,i5,i6)%a,bb=u1_3456(i3,i4,i5,i6)%b,cc=u1_3456(i
* 3,i4,i5,i6)%c,dd=u1_3456(i3,i4,i5,i6)%d,a1=l1_34(i3,i4)%a,b1=l1_34(i3,
* i4)%b,c1=l1_34(i3,i4)%c,d1=l1_34(i3,i4)%d,a2=u134_56(i5,i6)%a,b2=u134_
* 56(i5,i6)%b,c2=u134_56(i5,i6)%c,d2=u134_56(i5,i6)%d,prq=p134q,m=rmass(
* id1),nsum=1
      u1_3456(i3,i4,i5,i6)%a(1,1)=u1_3456(i3,i4,i5,i6)%a(1,1)+l1
     & _34(i3,i4)%a(1,1)*u134_56(i5,i6)%a(1,1)+l1_34(i3,i4)%c(1,
     & 2)*p134q*u134_56(i5,i6)%b(2,1)
      u1_3456(i3,i4,i5,i6)%b(1,1)=u1_3456(i3,i4,i5,i6)%b(1,1)+rm
     & ass(id1)*(l1_34(i3,i4)%d(1,1)*u134_56(i5,i6)%a(1,1)+l1_34
     & (i3,i4)%b(1,2)*u134_56(i5,i6)%b(2,1))
      u1_3456(i3,i4,i5,i6)%c(1,1)=u1_3456(i3,i4,i5,i6)%c(1,1)+rm
     & ass(id1)*(l1_34(i3,i4)%a(1,1)*u134_56(i5,i6)%d(1,1)+l1_34
     & (i3,i4)%c(1,2)*u134_56(i5,i6)%c(2,1))
      u1_3456(i3,i4,i5,i6)%d(1,1)=u1_3456(i3,i4,i5,i6)%d(1,1)+l1
     & _34(i3,i4)%d(1,1)*p134q*u134_56(i5,i6)%d(1,1)+l1_34(i3,i4
     & )%b(1,2)*u134_56(i5,i6)%c(2,1)
      u1_3456(i3,i4,i5,i6)%a(1,2)=u1_3456(i3,i4,i5,i6)%a(1,2)+rm
     & ass(id1)*(l1_34(i3,i4)%a(1,1)*u134_56(i5,i6)%b(1,2)+l1_34
     & (i3,i4)%c(1,2)*u134_56(i5,i6)%a(2,2))
      u1_3456(i3,i4,i5,i6)%b(1,2)=u1_3456(i3,i4,i5,i6)%b(1,2)+l1
     & _34(i3,i4)%d(1,1)*p134q*u134_56(i5,i6)%b(1,2)+l1_34(i3,i4
     & )%b(1,2)*u134_56(i5,i6)%a(2,2)
      u1_3456(i3,i4,i5,i6)%c(1,2)=u1_3456(i3,i4,i5,i6)%c(1,2)+l1
     & _34(i3,i4)%a(1,1)*u134_56(i5,i6)%c(1,2)+l1_34(i3,i4)%c(1,
     & 2)*p134q*u134_56(i5,i6)%d(2,2)
      u1_3456(i3,i4,i5,i6)%d(1,2)=u1_3456(i3,i4,i5,i6)%d(1,2)+rm
     & ass(id1)*(l1_34(i3,i4)%d(1,1)*u134_56(i5,i6)%c(1,2)+l1_34
     & (i3,i4)%b(1,2)*u134_56(i5,i6)%d(2,2))
      u1_3456(i3,i4,i5,i6)%a(2,1)=u1_3456(i3,i4,i5,i6)%a(2,1)+rm
     & ass(id1)*(l1_34(i3,i4)%c(2,1)*u134_56(i5,i6)%a(1,1)+l1_34
     & (i3,i4)%a(2,2)*u134_56(i5,i6)%b(2,1))
      u1_3456(i3,i4,i5,i6)%b(2,1)=u1_3456(i3,i4,i5,i6)%b(2,1)+l1
     & _34(i3,i4)%b(2,1)*u134_56(i5,i6)%a(1,1)+l1_34(i3,i4)%d(2,
     & 2)*p134q*u134_56(i5,i6)%b(2,1)
      u1_3456(i3,i4,i5,i6)%c(2,1)=u1_3456(i3,i4,i5,i6)%c(2,1)+l1
     & _34(i3,i4)%c(2,1)*p134q*u134_56(i5,i6)%d(1,1)+l1_34(i3,i4
     & )%a(2,2)*u134_56(i5,i6)%c(2,1)
      u1_3456(i3,i4,i5,i6)%d(2,1)=u1_3456(i3,i4,i5,i6)%d(2,1)+rm
     & ass(id1)*(l1_34(i3,i4)%b(2,1)*u134_56(i5,i6)%d(1,1)+l1_34
     & (i3,i4)%d(2,2)*u134_56(i5,i6)%c(2,1))
      u1_3456(i3,i4,i5,i6)%a(2,2)=u1_3456(i3,i4,i5,i6)%a(2,2)+l1
     & _34(i3,i4)%c(2,1)*p134q*u134_56(i5,i6)%b(1,2)+l1_34(i3,i4
     & )%a(2,2)*u134_56(i5,i6)%a(2,2)
      u1_3456(i3,i4,i5,i6)%b(2,2)=u1_3456(i3,i4,i5,i6)%b(2,2)+rm
     & ass(id1)*(l1_34(i3,i4)%b(2,1)*u134_56(i5,i6)%b(1,2)+l1_34
     & (i3,i4)%d(2,2)*u134_56(i5,i6)%a(2,2))
      u1_3456(i3,i4,i5,i6)%c(2,2)=u1_3456(i3,i4,i5,i6)%c(2,2)+rm
     & ass(id1)*(l1_34(i3,i4)%c(2,1)*u134_56(i5,i6)%c(1,2)+l1_34
     & (i3,i4)%a(2,2)*u134_56(i5,i6)%d(2,2))
      u1_3456(i3,i4,i5,i6)%d(2,2)=u1_3456(i3,i4,i5,i6)%d(2,2)+l1
     & _34(i3,i4)%b(2,1)*u134_56(i5,i6)%c(1,2)+l1_34(i3,i4)%d(2,
     & 2)*p134q*u134_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id1.eq.5.and.id3.eq.5.and.id5.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=u1_3456(i3,i4,i5,i6)%a,bb=u1_3456(i3,i4,i5,i6)%b,cc=u1_3456
* (i3,i4,i5,i6)%c,dd=u1_3456(i3,i4,i5,i6)%d,a1=l1_34(i3,i4)%a,b1=l1_34(i
* 3,i4)%b,c1=l1_34(i3,i4)%c,d1=l1_34(i3,i4)%d,a2=u134_56(i5,i6)%a,b2=u13
* 4_56(i5,i6)%b,c2=u134_56(i5,i6)%c,d2=u134_56(i5,i6)%d,prq=p134q,m=rmas
* s(id1),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u134_56(i5,i6)%a(1,jut)+rmass(id1)*u134_56(i5,i6)%b(1,
     & jut)
      cx2=u134_56(i5,i6)%a(2,jut)+rmass(id1)*u134_56(i5,i6)%b(2,
     & jut)
      cy1=p134q*u134_56(i5,i6)%b(1,jut)+rmass(id1)*u134_56(i5,i6
     & )%a(1,jut)
      cy2=p134q*u134_56(i5,i6)%b(2,jut)+rmass(id1)*u134_56(i5,i6
     & )%a(2,jut)
      u1_3456(i3,i4,i5,i6)%a(iut,jut)=u1_3456(i3,i4,i5,i6)%a(iut
     & ,jut)+l1_34(i3,i4)%a(iut,1)*cx1+l1_34(i3,i4)%c(iut,1)*cy1
     & +l1_34(i3,i4)%a(iut,2)*cx2+l1_34(i3,i4)%c(iut,2)*cy2
      u1_3456(i3,i4,i5,i6)%b(iut,jut)=u1_3456(i3,i4,i5,i6)%b(iut
     & ,jut)+l1_34(i3,i4)%b(iut,1)*cx1+l1_34(i3,i4)%d(iut,1)*cy1
     & +l1_34(i3,i4)%b(iut,2)*cx2+l1_34(i3,i4)%d(iut,2)*cy2
      cw1=u134_56(i5,i6)%c(1,jut)+rmass(id1)*u134_56(i5,i6)%d(1,
     & jut)
      cw2=u134_56(i5,i6)%c(2,jut)+rmass(id1)*u134_56(i5,i6)%d(2,
     & jut)
      cz1=p134q*u134_56(i5,i6)%d(1,jut)+rmass(id1)*u134_56(i5,i6
     & )%c(1,jut)
      cz2=p134q*u134_56(i5,i6)%d(2,jut)+rmass(id1)*u134_56(i5,i6
     & )%c(2,jut)
      u1_3456(i3,i4,i5,i6)%c(iut,jut)=u1_3456(i3,i4,i5,i6)%c(iut
     & ,jut)+l1_34(i3,i4)%a(iut,1)*cw1+l1_34(i3,i4)%c(iut,1)*cz1
     & +l1_34(i3,i4)%a(iut,2)*cw2+l1_34(i3,i4)%c(iut,2)*cz2
      u1_3456(i3,i4,i5,i6)%d(iut,jut)=u1_3456(i3,i4,i5,i6)%d(iut
     & ,jut)+l1_34(i3,i4)%b(iut,1)*cw1+l1_34(i3,i4)%d(iut,1)*cz1
     & +l1_34(i3,i4)%b(iut,2)*cw2+l1_34(i3,i4)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id1.eq.5.and.id3.eq.5.and.id5.ne.5)then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=u1_3456(i3,i4,i5,i6)%a,bb=u1_3456(i3,i4,i5,i6)%b,cc=u1_3456(
* i3,i4,i5,i6)%c,dd=u1_3456(i3,i4,i5,i6)%d,a1=l1_34(i3,i4)%a,b1=l1_34(i3
* ,i4)%b,c1=l1_34(i3,i4)%c,d1=l1_34(i3,i4)%d,a2=u134_56(i5,i6)%a,b2=u134
* _56(i5,i6)%b,c2=u134_56(i5,i6)%c,d2=u134_56(i5,i6)%d,prq=p134q,m=rmass
* (id1),nsum=1
      do iut=1,2
      cx1=l1_34(i3,i4)%a(iut,1)+l1_34(i3,i4)%c(iut,1)*rmass(id1)
      cx2=l1_34(i3,i4)%c(iut,2)*p134q+l1_34(i3,i4)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_34(i3,i4)%b(iut,1)+l1_34(i3,i4)%d(iut,1)*rmass(id1)
      cy2=l1_34(i3,i4)%d(iut,2)*p134q+l1_34(i3,i4)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_34(i3,i4)%c(iut,1)*p134q+l1_34(i3,i4)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_34(i3,i4)%a(iut,2)+l1_34(i3,i4)%c(iut,2)*rmass(id1)
      cz1=l1_34(i3,i4)%d(iut,1)*p134q+l1_34(i3,i4)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_34(i3,i4)%b(iut,2)+l1_34(i3,i4)%d(iut,2)*rmass(id1)
      u1_3456(i3,i4,i5,i6)%a(iut,1)=u1_3456(i3,i4,i5,i6)%a(iut,1
     & )+cx1*u134_56(i5,i6)%a(1,1)+cx2*u134_56(i5,i6)%b(2,1)
      u1_3456(i3,i4,i5,i6)%b(iut,1)=u1_3456(i3,i4,i5,i6)%b(iut,1
     & )+cy1*u134_56(i5,i6)%a(1,1)+cy2*u134_56(i5,i6)%b(2,1)
      u1_3456(i3,i4,i5,i6)%c(iut,1)=u1_3456(i3,i4,i5,i6)%c(iut,1
     & )+cw1*u134_56(i5,i6)%d(1,1)+cw2*u134_56(i5,i6)%c(2,1)
      u1_3456(i3,i4,i5,i6)%d(iut,1)=u1_3456(i3,i4,i5,i6)%d(iut,1
     & )+cz1*u134_56(i5,i6)%d(1,1)+cz2*u134_56(i5,i6)%c(2,1)
      u1_3456(i3,i4,i5,i6)%a(iut,2)=u1_3456(i3,i4,i5,i6)%a(iut,2
     & )+cw1*u134_56(i5,i6)%b(1,2)+cw2*u134_56(i5,i6)%a(2,2)
      u1_3456(i3,i4,i5,i6)%b(iut,2)=u1_3456(i3,i4,i5,i6)%b(iut,2
     & )+cz1*u134_56(i5,i6)%b(1,2)+cz2*u134_56(i5,i6)%a(2,2)
      u1_3456(i3,i4,i5,i6)%c(iut,2)=u1_3456(i3,i4,i5,i6)%c(iut,2
     & )+cx1*u134_56(i5,i6)%c(1,2)+cx2*u134_56(i5,i6)%d(2,2)
      u1_3456(i3,i4,i5,i6)%d(iut,2)=u1_3456(i3,i4,i5,i6)%d(iut,2
     & )+cy1*u134_56(i5,i6)%c(1,2)+cy2*u134_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id1.eq.5.and.id3.ne.5.and.id5.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TTs -- aa=u1_3456(i3,i4,i5,i6)%a,bb=u1_3456(i3,i4,i5,i6)%b,cc=u1_3456(
* i3,i4,i5,i6)%c,dd=u1_3456(i3,i4,i5,i6)%d,a1=l1_34(i3,i4)%a,b1=l1_34(i3
* ,i4)%b,c1=l1_34(i3,i4)%c,d1=l1_34(i3,i4)%d,a2=u134_56(i5,i6)%a,b2=u134
* _56(i5,i6)%b,c2=u134_56(i5,i6)%c,d2=u134_56(i5,i6)%d,prq=p134q,m=rmass
* (id1),nsum=1
      do jut=1,2
      cx1=u134_56(i5,i6)%a(1,jut)+rmass(id1)*u134_56(i5,i6)%b(1,
     & jut)
      cx2=u134_56(i5,i6)%a(2,jut)+rmass(id1)*u134_56(i5,i6)%b(2,
     & jut)
      cy1=p134q*u134_56(i5,i6)%b(1,jut)+rmass(id1)*u134_56(i5,i6
     & )%a(1,jut)
      cy2=p134q*u134_56(i5,i6)%b(2,jut)+rmass(id1)*u134_56(i5,i6
     & )%a(2,jut)
      cw1=u134_56(i5,i6)%c(1,jut)+rmass(id1)*u134_56(i5,i6)%d(1,
     & jut)
      cw2=u134_56(i5,i6)%c(2,jut)+rmass(id1)*u134_56(i5,i6)%d(2,
     & jut)
      cz1=p134q*u134_56(i5,i6)%d(1,jut)+rmass(id1)*u134_56(i5,i6
     & )%c(1,jut)
      cz2=p134q*u134_56(i5,i6)%d(2,jut)+rmass(id1)*u134_56(i5,i6
     & )%c(2,jut)
      u1_3456(i3,i4,i5,i6)%a(1,jut)=u1_3456(i3,i4,i5,i6)%a(1,jut
     & )+l1_34(i3,i4)%a(1,1)*cx1+l1_34(i3,i4)%c(1,2)*cy2
      u1_3456(i3,i4,i5,i6)%b(1,jut)=u1_3456(i3,i4,i5,i6)%b(1,jut
     & )+l1_34(i3,i4)%d(1,1)*cy1+l1_34(i3,i4)%b(1,2)*cx2
      u1_3456(i3,i4,i5,i6)%c(1,jut)=u1_3456(i3,i4,i5,i6)%c(1,jut
     & )+l1_34(i3,i4)%a(1,1)*cw1+l1_34(i3,i4)%c(1,2)*cz2
      u1_3456(i3,i4,i5,i6)%d(1,jut)=u1_3456(i3,i4,i5,i6)%d(1,jut
     & )+l1_34(i3,i4)%d(1,1)*cz1+l1_34(i3,i4)%b(1,2)*cw2
      u1_3456(i3,i4,i5,i6)%a(2,jut)=u1_3456(i3,i4,i5,i6)%a(2,jut
     & )+l1_34(i3,i4)%c(2,1)*cy1+l1_34(i3,i4)%a(2,2)*cx2
      u1_3456(i3,i4,i5,i6)%b(2,jut)=u1_3456(i3,i4,i5,i6)%b(2,jut
     & )+l1_34(i3,i4)%b(2,1)*cx1+l1_34(i3,i4)%d(2,2)*cy2
      u1_3456(i3,i4,i5,i6)%c(2,jut)=u1_3456(i3,i4,i5,i6)%c(2,jut
     & )+l1_34(i3,i4)%c(2,1)*cz1+l1_34(i3,i4)%a(2,2)*cw2
      u1_3456(i3,i4,i5,i6)%d(2,jut)=u1_3456(i3,i4,i5,i6)%d(2,jut
     & )+l1_34(i3,i4)%b(2,1)*cw1+l1_34(i3,i4)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p156q,p=p156,q=p156,bef=,aft=
      p156q=(p156(0)*p156(0)-p156(1)*p156(1)-p156(2)*p156(2)-p15
     & 6(3)*p156(3))
  
      if(id1.ne.5.or.(id5.ne.5.and.id3.ne.5))then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=u1_3456(i3,i4,i5,i6)%a,bb=u1_3456(i3,i4,i5,i6)%b,cc=u1_3456(i
* 3,i4,i5,i6)%c,dd=u1_3456(i3,i4,i5,i6)%d,a1=l1_56(i5,i6)%a,b1=l1_56(i5,
* i6)%b,c1=l1_56(i5,i6)%c,d1=l1_56(i5,i6)%d,a2=u156_34(i3,i4)%a,b2=u156_
* 34(i3,i4)%b,c2=u156_34(i3,i4)%c,d2=u156_34(i3,i4)%d,prq=p156q,m=rmass(
* id1),nsum=1
      u1_3456(i3,i4,i5,i6)%a(1,1)=u1_3456(i3,i4,i5,i6)%a(1,1)+l1
     & _56(i5,i6)%a(1,1)*u156_34(i3,i4)%a(1,1)+l1_56(i5,i6)%c(1,
     & 2)*p156q*u156_34(i3,i4)%b(2,1)
      u1_3456(i3,i4,i5,i6)%b(1,1)=u1_3456(i3,i4,i5,i6)%b(1,1)+rm
     & ass(id1)*(l1_56(i5,i6)%d(1,1)*u156_34(i3,i4)%a(1,1)+l1_56
     & (i5,i6)%b(1,2)*u156_34(i3,i4)%b(2,1))
      u1_3456(i3,i4,i5,i6)%c(1,1)=u1_3456(i3,i4,i5,i6)%c(1,1)+rm
     & ass(id1)*(l1_56(i5,i6)%a(1,1)*u156_34(i3,i4)%d(1,1)+l1_56
     & (i5,i6)%c(1,2)*u156_34(i3,i4)%c(2,1))
      u1_3456(i3,i4,i5,i6)%d(1,1)=u1_3456(i3,i4,i5,i6)%d(1,1)+l1
     & _56(i5,i6)%d(1,1)*p156q*u156_34(i3,i4)%d(1,1)+l1_56(i5,i6
     & )%b(1,2)*u156_34(i3,i4)%c(2,1)
      u1_3456(i3,i4,i5,i6)%a(1,2)=u1_3456(i3,i4,i5,i6)%a(1,2)+rm
     & ass(id1)*(l1_56(i5,i6)%a(1,1)*u156_34(i3,i4)%b(1,2)+l1_56
     & (i5,i6)%c(1,2)*u156_34(i3,i4)%a(2,2))
      u1_3456(i3,i4,i5,i6)%b(1,2)=u1_3456(i3,i4,i5,i6)%b(1,2)+l1
     & _56(i5,i6)%d(1,1)*p156q*u156_34(i3,i4)%b(1,2)+l1_56(i5,i6
     & )%b(1,2)*u156_34(i3,i4)%a(2,2)
      u1_3456(i3,i4,i5,i6)%c(1,2)=u1_3456(i3,i4,i5,i6)%c(1,2)+l1
     & _56(i5,i6)%a(1,1)*u156_34(i3,i4)%c(1,2)+l1_56(i5,i6)%c(1,
     & 2)*p156q*u156_34(i3,i4)%d(2,2)
      u1_3456(i3,i4,i5,i6)%d(1,2)=u1_3456(i3,i4,i5,i6)%d(1,2)+rm
     & ass(id1)*(l1_56(i5,i6)%d(1,1)*u156_34(i3,i4)%c(1,2)+l1_56
     & (i5,i6)%b(1,2)*u156_34(i3,i4)%d(2,2))
      u1_3456(i3,i4,i5,i6)%a(2,1)=u1_3456(i3,i4,i5,i6)%a(2,1)+rm
     & ass(id1)*(l1_56(i5,i6)%c(2,1)*u156_34(i3,i4)%a(1,1)+l1_56
     & (i5,i6)%a(2,2)*u156_34(i3,i4)%b(2,1))
      u1_3456(i3,i4,i5,i6)%b(2,1)=u1_3456(i3,i4,i5,i6)%b(2,1)+l1
     & _56(i5,i6)%b(2,1)*u156_34(i3,i4)%a(1,1)+l1_56(i5,i6)%d(2,
     & 2)*p156q*u156_34(i3,i4)%b(2,1)
      u1_3456(i3,i4,i5,i6)%c(2,1)=u1_3456(i3,i4,i5,i6)%c(2,1)+l1
     & _56(i5,i6)%c(2,1)*p156q*u156_34(i3,i4)%d(1,1)+l1_56(i5,i6
     & )%a(2,2)*u156_34(i3,i4)%c(2,1)
      u1_3456(i3,i4,i5,i6)%d(2,1)=u1_3456(i3,i4,i5,i6)%d(2,1)+rm
     & ass(id1)*(l1_56(i5,i6)%b(2,1)*u156_34(i3,i4)%d(1,1)+l1_56
     & (i5,i6)%d(2,2)*u156_34(i3,i4)%c(2,1))
      u1_3456(i3,i4,i5,i6)%a(2,2)=u1_3456(i3,i4,i5,i6)%a(2,2)+l1
     & _56(i5,i6)%c(2,1)*p156q*u156_34(i3,i4)%b(1,2)+l1_56(i5,i6
     & )%a(2,2)*u156_34(i3,i4)%a(2,2)
      u1_3456(i3,i4,i5,i6)%b(2,2)=u1_3456(i3,i4,i5,i6)%b(2,2)+rm
     & ass(id1)*(l1_56(i5,i6)%b(2,1)*u156_34(i3,i4)%b(1,2)+l1_56
     & (i5,i6)%d(2,2)*u156_34(i3,i4)%a(2,2))
      u1_3456(i3,i4,i5,i6)%c(2,2)=u1_3456(i3,i4,i5,i6)%c(2,2)+rm
     & ass(id1)*(l1_56(i5,i6)%c(2,1)*u156_34(i3,i4)%c(1,2)+l1_56
     & (i5,i6)%a(2,2)*u156_34(i3,i4)%d(2,2))
      u1_3456(i3,i4,i5,i6)%d(2,2)=u1_3456(i3,i4,i5,i6)%d(2,2)+l1
     & _56(i5,i6)%b(2,1)*u156_34(i3,i4)%c(1,2)+l1_56(i5,i6)%d(2,
     & 2)*p156q*u156_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id1.eq.5.and.id5.eq.5.and.id3.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=u1_3456(i3,i4,i5,i6)%a,bb=u1_3456(i3,i4,i5,i6)%b,cc=u1_3456
* (i3,i4,i5,i6)%c,dd=u1_3456(i3,i4,i5,i6)%d,a1=l1_56(i5,i6)%a,b1=l1_56(i
* 5,i6)%b,c1=l1_56(i5,i6)%c,d1=l1_56(i5,i6)%d,a2=u156_34(i3,i4)%a,b2=u15
* 6_34(i3,i4)%b,c2=u156_34(i3,i4)%c,d2=u156_34(i3,i4)%d,prq=p156q,m=rmas
* s(id1),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u156_34(i3,i4)%a(1,jut)+rmass(id1)*u156_34(i3,i4)%b(1,
     & jut)
      cx2=u156_34(i3,i4)%a(2,jut)+rmass(id1)*u156_34(i3,i4)%b(2,
     & jut)
      cy1=p156q*u156_34(i3,i4)%b(1,jut)+rmass(id1)*u156_34(i3,i4
     & )%a(1,jut)
      cy2=p156q*u156_34(i3,i4)%b(2,jut)+rmass(id1)*u156_34(i3,i4
     & )%a(2,jut)
      u1_3456(i3,i4,i5,i6)%a(iut,jut)=u1_3456(i3,i4,i5,i6)%a(iut
     & ,jut)+l1_56(i5,i6)%a(iut,1)*cx1+l1_56(i5,i6)%c(iut,1)*cy1
     & +l1_56(i5,i6)%a(iut,2)*cx2+l1_56(i5,i6)%c(iut,2)*cy2
      u1_3456(i3,i4,i5,i6)%b(iut,jut)=u1_3456(i3,i4,i5,i6)%b(iut
     & ,jut)+l1_56(i5,i6)%b(iut,1)*cx1+l1_56(i5,i6)%d(iut,1)*cy1
     & +l1_56(i5,i6)%b(iut,2)*cx2+l1_56(i5,i6)%d(iut,2)*cy2
      cw1=u156_34(i3,i4)%c(1,jut)+rmass(id1)*u156_34(i3,i4)%d(1,
     & jut)
      cw2=u156_34(i3,i4)%c(2,jut)+rmass(id1)*u156_34(i3,i4)%d(2,
     & jut)
      cz1=p156q*u156_34(i3,i4)%d(1,jut)+rmass(id1)*u156_34(i3,i4
     & )%c(1,jut)
      cz2=p156q*u156_34(i3,i4)%d(2,jut)+rmass(id1)*u156_34(i3,i4
     & )%c(2,jut)
      u1_3456(i3,i4,i5,i6)%c(iut,jut)=u1_3456(i3,i4,i5,i6)%c(iut
     & ,jut)+l1_56(i5,i6)%a(iut,1)*cw1+l1_56(i5,i6)%c(iut,1)*cz1
     & +l1_56(i5,i6)%a(iut,2)*cw2+l1_56(i5,i6)%c(iut,2)*cz2
      u1_3456(i3,i4,i5,i6)%d(iut,jut)=u1_3456(i3,i4,i5,i6)%d(iut
     & ,jut)+l1_56(i5,i6)%b(iut,1)*cw1+l1_56(i5,i6)%d(iut,1)*cz1
     & +l1_56(i5,i6)%b(iut,2)*cw2+l1_56(i5,i6)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id1.eq.5.and.id5.eq.5.and.id3.ne.5)then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=u1_3456(i3,i4,i5,i6)%a,bb=u1_3456(i3,i4,i5,i6)%b,cc=u1_3456(
* i3,i4,i5,i6)%c,dd=u1_3456(i3,i4,i5,i6)%d,a1=l1_56(i5,i6)%a,b1=l1_56(i5
* ,i6)%b,c1=l1_56(i5,i6)%c,d1=l1_56(i5,i6)%d,a2=u156_34(i3,i4)%a,b2=u156
* _34(i3,i4)%b,c2=u156_34(i3,i4)%c,d2=u156_34(i3,i4)%d,prq=p156q,m=rmass
* (id1),nsum=1
      do iut=1,2
      cx1=l1_56(i5,i6)%a(iut,1)+l1_56(i5,i6)%c(iut,1)*rmass(id1)
      cx2=l1_56(i5,i6)%c(iut,2)*p156q+l1_56(i5,i6)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_56(i5,i6)%b(iut,1)+l1_56(i5,i6)%d(iut,1)*rmass(id1)
      cy2=l1_56(i5,i6)%d(iut,2)*p156q+l1_56(i5,i6)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_56(i5,i6)%c(iut,1)*p156q+l1_56(i5,i6)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_56(i5,i6)%a(iut,2)+l1_56(i5,i6)%c(iut,2)*rmass(id1)
      cz1=l1_56(i5,i6)%d(iut,1)*p156q+l1_56(i5,i6)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_56(i5,i6)%b(iut,2)+l1_56(i5,i6)%d(iut,2)*rmass(id1)
      u1_3456(i3,i4,i5,i6)%a(iut,1)=u1_3456(i3,i4,i5,i6)%a(iut,1
     & )+cx1*u156_34(i3,i4)%a(1,1)+cx2*u156_34(i3,i4)%b(2,1)
      u1_3456(i3,i4,i5,i6)%b(iut,1)=u1_3456(i3,i4,i5,i6)%b(iut,1
     & )+cy1*u156_34(i3,i4)%a(1,1)+cy2*u156_34(i3,i4)%b(2,1)
      u1_3456(i3,i4,i5,i6)%c(iut,1)=u1_3456(i3,i4,i5,i6)%c(iut,1
     & )+cw1*u156_34(i3,i4)%d(1,1)+cw2*u156_34(i3,i4)%c(2,1)
      u1_3456(i3,i4,i5,i6)%d(iut,1)=u1_3456(i3,i4,i5,i6)%d(iut,1
     & )+cz1*u156_34(i3,i4)%d(1,1)+cz2*u156_34(i3,i4)%c(2,1)
      u1_3456(i3,i4,i5,i6)%a(iut,2)=u1_3456(i3,i4,i5,i6)%a(iut,2
     & )+cw1*u156_34(i3,i4)%b(1,2)+cw2*u156_34(i3,i4)%a(2,2)
      u1_3456(i3,i4,i5,i6)%b(iut,2)=u1_3456(i3,i4,i5,i6)%b(iut,2
     & )+cz1*u156_34(i3,i4)%b(1,2)+cz2*u156_34(i3,i4)%a(2,2)
      u1_3456(i3,i4,i5,i6)%c(iut,2)=u1_3456(i3,i4,i5,i6)%c(iut,2
     & )+cx1*u156_34(i3,i4)%c(1,2)+cx2*u156_34(i3,i4)%d(2,2)
      u1_3456(i3,i4,i5,i6)%d(iut,2)=u1_3456(i3,i4,i5,i6)%d(iut,2
     & )+cy1*u156_34(i3,i4)%c(1,2)+cy2*u156_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id1.eq.5.and.id5.ne.5.and.id3.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TTs -- aa=u1_3456(i3,i4,i5,i6)%a,bb=u1_3456(i3,i4,i5,i6)%b,cc=u1_3456(
* i3,i4,i5,i6)%c,dd=u1_3456(i3,i4,i5,i6)%d,a1=l1_56(i5,i6)%a,b1=l1_56(i5
* ,i6)%b,c1=l1_56(i5,i6)%c,d1=l1_56(i5,i6)%d,a2=u156_34(i3,i4)%a,b2=u156
* _34(i3,i4)%b,c2=u156_34(i3,i4)%c,d2=u156_34(i3,i4)%d,prq=p156q,m=rmass
* (id1),nsum=1
      do jut=1,2
      cx1=u156_34(i3,i4)%a(1,jut)+rmass(id1)*u156_34(i3,i4)%b(1,
     & jut)
      cx2=u156_34(i3,i4)%a(2,jut)+rmass(id1)*u156_34(i3,i4)%b(2,
     & jut)
      cy1=p156q*u156_34(i3,i4)%b(1,jut)+rmass(id1)*u156_34(i3,i4
     & )%a(1,jut)
      cy2=p156q*u156_34(i3,i4)%b(2,jut)+rmass(id1)*u156_34(i3,i4
     & )%a(2,jut)
      cw1=u156_34(i3,i4)%c(1,jut)+rmass(id1)*u156_34(i3,i4)%d(1,
     & jut)
      cw2=u156_34(i3,i4)%c(2,jut)+rmass(id1)*u156_34(i3,i4)%d(2,
     & jut)
      cz1=p156q*u156_34(i3,i4)%d(1,jut)+rmass(id1)*u156_34(i3,i4
     & )%c(1,jut)
      cz2=p156q*u156_34(i3,i4)%d(2,jut)+rmass(id1)*u156_34(i3,i4
     & )%c(2,jut)
      u1_3456(i3,i4,i5,i6)%a(1,jut)=u1_3456(i3,i4,i5,i6)%a(1,jut
     & )+l1_56(i5,i6)%a(1,1)*cx1+l1_56(i5,i6)%c(1,2)*cy2
      u1_3456(i3,i4,i5,i6)%b(1,jut)=u1_3456(i3,i4,i5,i6)%b(1,jut
     & )+l1_56(i5,i6)%d(1,1)*cy1+l1_56(i5,i6)%b(1,2)*cx2
      u1_3456(i3,i4,i5,i6)%c(1,jut)=u1_3456(i3,i4,i5,i6)%c(1,jut
     & )+l1_56(i5,i6)%a(1,1)*cw1+l1_56(i5,i6)%c(1,2)*cz2
      u1_3456(i3,i4,i5,i6)%d(1,jut)=u1_3456(i3,i4,i5,i6)%d(1,jut
     & )+l1_56(i5,i6)%d(1,1)*cz1+l1_56(i5,i6)%b(1,2)*cw2
      u1_3456(i3,i4,i5,i6)%a(2,jut)=u1_3456(i3,i4,i5,i6)%a(2,jut
     & )+l1_56(i5,i6)%c(2,1)*cy1+l1_56(i5,i6)%a(2,2)*cx2
      u1_3456(i3,i4,i5,i6)%b(2,jut)=u1_3456(i3,i4,i5,i6)%b(2,jut
     & )+l1_56(i5,i6)%b(2,1)*cx1+l1_56(i5,i6)%d(2,2)*cy2
      u1_3456(i3,i4,i5,i6)%c(2,jut)=u1_3456(i3,i4,i5,i6)%c(2,jut
     & )+l1_56(i5,i6)%c(2,1)*cz1+l1_56(i5,i6)%a(2,2)*cw2
      u1_3456(i3,i4,i5,i6)%d(2,jut)=u1_3456(i3,i4,i5,i6)%d(2,jut
     & )+l1_56(i5,i6)%b(2,1)*cw1+l1_56(i5,i6)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p134q,p=p134,q=p134,bef=,aft=
      p134q=(p134(0)*p134(0)-p134(1)*p134(1)-p134(2)*p134(2)-p13
     & 4(3)*p134(3))
  
      if(id1.ne.5.or.(id3.ne.5.and.id7.ne.5))then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=u1_3478(i3,i4,i7,i8)%a,bb=u1_3478(i3,i4,i7,i8)%b,cc=u1_3478(i
* 3,i4,i7,i8)%c,dd=u1_3478(i3,i4,i7,i8)%d,a1=l1_34(i3,i4)%a,b1=l1_34(i3,
* i4)%b,c1=l1_34(i3,i4)%c,d1=l1_34(i3,i4)%d,a2=u134_78(i7,i8)%a,b2=u134_
* 78(i7,i8)%b,c2=u134_78(i7,i8)%c,d2=u134_78(i7,i8)%d,prq=p134q,m=rmass(
* id1),nsum=1
      u1_3478(i3,i4,i7,i8)%a(1,1)=u1_3478(i3,i4,i7,i8)%a(1,1)+l1
     & _34(i3,i4)%a(1,1)*u134_78(i7,i8)%a(1,1)+l1_34(i3,i4)%c(1,
     & 2)*p134q*u134_78(i7,i8)%b(2,1)
      u1_3478(i3,i4,i7,i8)%b(1,1)=u1_3478(i3,i4,i7,i8)%b(1,1)+rm
     & ass(id1)*(l1_34(i3,i4)%d(1,1)*u134_78(i7,i8)%a(1,1)+l1_34
     & (i3,i4)%b(1,2)*u134_78(i7,i8)%b(2,1))
      u1_3478(i3,i4,i7,i8)%c(1,1)=u1_3478(i3,i4,i7,i8)%c(1,1)+rm
     & ass(id1)*(l1_34(i3,i4)%a(1,1)*u134_78(i7,i8)%d(1,1)+l1_34
     & (i3,i4)%c(1,2)*u134_78(i7,i8)%c(2,1))
      u1_3478(i3,i4,i7,i8)%d(1,1)=u1_3478(i3,i4,i7,i8)%d(1,1)+l1
     & _34(i3,i4)%d(1,1)*p134q*u134_78(i7,i8)%d(1,1)+l1_34(i3,i4
     & )%b(1,2)*u134_78(i7,i8)%c(2,1)
      u1_3478(i3,i4,i7,i8)%a(1,2)=u1_3478(i3,i4,i7,i8)%a(1,2)+rm
     & ass(id1)*(l1_34(i3,i4)%a(1,1)*u134_78(i7,i8)%b(1,2)+l1_34
     & (i3,i4)%c(1,2)*u134_78(i7,i8)%a(2,2))
      u1_3478(i3,i4,i7,i8)%b(1,2)=u1_3478(i3,i4,i7,i8)%b(1,2)+l1
     & _34(i3,i4)%d(1,1)*p134q*u134_78(i7,i8)%b(1,2)+l1_34(i3,i4
     & )%b(1,2)*u134_78(i7,i8)%a(2,2)
      u1_3478(i3,i4,i7,i8)%c(1,2)=u1_3478(i3,i4,i7,i8)%c(1,2)+l1
     & _34(i3,i4)%a(1,1)*u134_78(i7,i8)%c(1,2)+l1_34(i3,i4)%c(1,
     & 2)*p134q*u134_78(i7,i8)%d(2,2)
      u1_3478(i3,i4,i7,i8)%d(1,2)=u1_3478(i3,i4,i7,i8)%d(1,2)+rm
     & ass(id1)*(l1_34(i3,i4)%d(1,1)*u134_78(i7,i8)%c(1,2)+l1_34
     & (i3,i4)%b(1,2)*u134_78(i7,i8)%d(2,2))
      u1_3478(i3,i4,i7,i8)%a(2,1)=u1_3478(i3,i4,i7,i8)%a(2,1)+rm
     & ass(id1)*(l1_34(i3,i4)%c(2,1)*u134_78(i7,i8)%a(1,1)+l1_34
     & (i3,i4)%a(2,2)*u134_78(i7,i8)%b(2,1))
      u1_3478(i3,i4,i7,i8)%b(2,1)=u1_3478(i3,i4,i7,i8)%b(2,1)+l1
     & _34(i3,i4)%b(2,1)*u134_78(i7,i8)%a(1,1)+l1_34(i3,i4)%d(2,
     & 2)*p134q*u134_78(i7,i8)%b(2,1)
      u1_3478(i3,i4,i7,i8)%c(2,1)=u1_3478(i3,i4,i7,i8)%c(2,1)+l1
     & _34(i3,i4)%c(2,1)*p134q*u134_78(i7,i8)%d(1,1)+l1_34(i3,i4
     & )%a(2,2)*u134_78(i7,i8)%c(2,1)
      u1_3478(i3,i4,i7,i8)%d(2,1)=u1_3478(i3,i4,i7,i8)%d(2,1)+rm
     & ass(id1)*(l1_34(i3,i4)%b(2,1)*u134_78(i7,i8)%d(1,1)+l1_34
     & (i3,i4)%d(2,2)*u134_78(i7,i8)%c(2,1))
      u1_3478(i3,i4,i7,i8)%a(2,2)=u1_3478(i3,i4,i7,i8)%a(2,2)+l1
     & _34(i3,i4)%c(2,1)*p134q*u134_78(i7,i8)%b(1,2)+l1_34(i3,i4
     & )%a(2,2)*u134_78(i7,i8)%a(2,2)
      u1_3478(i3,i4,i7,i8)%b(2,2)=u1_3478(i3,i4,i7,i8)%b(2,2)+rm
     & ass(id1)*(l1_34(i3,i4)%b(2,1)*u134_78(i7,i8)%b(1,2)+l1_34
     & (i3,i4)%d(2,2)*u134_78(i7,i8)%a(2,2))
      u1_3478(i3,i4,i7,i8)%c(2,2)=u1_3478(i3,i4,i7,i8)%c(2,2)+rm
     & ass(id1)*(l1_34(i3,i4)%c(2,1)*u134_78(i7,i8)%c(1,2)+l1_34
     & (i3,i4)%a(2,2)*u134_78(i7,i8)%d(2,2))
      u1_3478(i3,i4,i7,i8)%d(2,2)=u1_3478(i3,i4,i7,i8)%d(2,2)+l1
     & _34(i3,i4)%b(2,1)*u134_78(i7,i8)%c(1,2)+l1_34(i3,i4)%d(2,
     & 2)*p134q*u134_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id1.eq.5.and.id3.eq.5.and.id7.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=u1_3478(i3,i4,i7,i8)%a,bb=u1_3478(i3,i4,i7,i8)%b,cc=u1_3478
* (i3,i4,i7,i8)%c,dd=u1_3478(i3,i4,i7,i8)%d,a1=l1_34(i3,i4)%a,b1=l1_34(i
* 3,i4)%b,c1=l1_34(i3,i4)%c,d1=l1_34(i3,i4)%d,a2=u134_78(i7,i8)%a,b2=u13
* 4_78(i7,i8)%b,c2=u134_78(i7,i8)%c,d2=u134_78(i7,i8)%d,prq=p134q,m=rmas
* s(id1),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u134_78(i7,i8)%a(1,jut)+rmass(id1)*u134_78(i7,i8)%b(1,
     & jut)
      cx2=u134_78(i7,i8)%a(2,jut)+rmass(id1)*u134_78(i7,i8)%b(2,
     & jut)
      cy1=p134q*u134_78(i7,i8)%b(1,jut)+rmass(id1)*u134_78(i7,i8
     & )%a(1,jut)
      cy2=p134q*u134_78(i7,i8)%b(2,jut)+rmass(id1)*u134_78(i7,i8
     & )%a(2,jut)
      u1_3478(i3,i4,i7,i8)%a(iut,jut)=u1_3478(i3,i4,i7,i8)%a(iut
     & ,jut)+l1_34(i3,i4)%a(iut,1)*cx1+l1_34(i3,i4)%c(iut,1)*cy1
     & +l1_34(i3,i4)%a(iut,2)*cx2+l1_34(i3,i4)%c(iut,2)*cy2
      u1_3478(i3,i4,i7,i8)%b(iut,jut)=u1_3478(i3,i4,i7,i8)%b(iut
     & ,jut)+l1_34(i3,i4)%b(iut,1)*cx1+l1_34(i3,i4)%d(iut,1)*cy1
     & +l1_34(i3,i4)%b(iut,2)*cx2+l1_34(i3,i4)%d(iut,2)*cy2
      cw1=u134_78(i7,i8)%c(1,jut)+rmass(id1)*u134_78(i7,i8)%d(1,
     & jut)
      cw2=u134_78(i7,i8)%c(2,jut)+rmass(id1)*u134_78(i7,i8)%d(2,
     & jut)
      cz1=p134q*u134_78(i7,i8)%d(1,jut)+rmass(id1)*u134_78(i7,i8
     & )%c(1,jut)
      cz2=p134q*u134_78(i7,i8)%d(2,jut)+rmass(id1)*u134_78(i7,i8
     & )%c(2,jut)
      u1_3478(i3,i4,i7,i8)%c(iut,jut)=u1_3478(i3,i4,i7,i8)%c(iut
     & ,jut)+l1_34(i3,i4)%a(iut,1)*cw1+l1_34(i3,i4)%c(iut,1)*cz1
     & +l1_34(i3,i4)%a(iut,2)*cw2+l1_34(i3,i4)%c(iut,2)*cz2
      u1_3478(i3,i4,i7,i8)%d(iut,jut)=u1_3478(i3,i4,i7,i8)%d(iut
     & ,jut)+l1_34(i3,i4)%b(iut,1)*cw1+l1_34(i3,i4)%d(iut,1)*cz1
     & +l1_34(i3,i4)%b(iut,2)*cw2+l1_34(i3,i4)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id1.eq.5.and.id3.eq.5.and.id7.ne.5)then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=u1_3478(i3,i4,i7,i8)%a,bb=u1_3478(i3,i4,i7,i8)%b,cc=u1_3478(
* i3,i4,i7,i8)%c,dd=u1_3478(i3,i4,i7,i8)%d,a1=l1_34(i3,i4)%a,b1=l1_34(i3
* ,i4)%b,c1=l1_34(i3,i4)%c,d1=l1_34(i3,i4)%d,a2=u134_78(i7,i8)%a,b2=u134
* _78(i7,i8)%b,c2=u134_78(i7,i8)%c,d2=u134_78(i7,i8)%d,prq=p134q,m=rmass
* (id1),nsum=1
      do iut=1,2
      cx1=l1_34(i3,i4)%a(iut,1)+l1_34(i3,i4)%c(iut,1)*rmass(id1)
      cx2=l1_34(i3,i4)%c(iut,2)*p134q+l1_34(i3,i4)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_34(i3,i4)%b(iut,1)+l1_34(i3,i4)%d(iut,1)*rmass(id1)
      cy2=l1_34(i3,i4)%d(iut,2)*p134q+l1_34(i3,i4)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_34(i3,i4)%c(iut,1)*p134q+l1_34(i3,i4)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_34(i3,i4)%a(iut,2)+l1_34(i3,i4)%c(iut,2)*rmass(id1)
      cz1=l1_34(i3,i4)%d(iut,1)*p134q+l1_34(i3,i4)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_34(i3,i4)%b(iut,2)+l1_34(i3,i4)%d(iut,2)*rmass(id1)
      u1_3478(i3,i4,i7,i8)%a(iut,1)=u1_3478(i3,i4,i7,i8)%a(iut,1
     & )+cx1*u134_78(i7,i8)%a(1,1)+cx2*u134_78(i7,i8)%b(2,1)
      u1_3478(i3,i4,i7,i8)%b(iut,1)=u1_3478(i3,i4,i7,i8)%b(iut,1
     & )+cy1*u134_78(i7,i8)%a(1,1)+cy2*u134_78(i7,i8)%b(2,1)
      u1_3478(i3,i4,i7,i8)%c(iut,1)=u1_3478(i3,i4,i7,i8)%c(iut,1
     & )+cw1*u134_78(i7,i8)%d(1,1)+cw2*u134_78(i7,i8)%c(2,1)
      u1_3478(i3,i4,i7,i8)%d(iut,1)=u1_3478(i3,i4,i7,i8)%d(iut,1
     & )+cz1*u134_78(i7,i8)%d(1,1)+cz2*u134_78(i7,i8)%c(2,1)
      u1_3478(i3,i4,i7,i8)%a(iut,2)=u1_3478(i3,i4,i7,i8)%a(iut,2
     & )+cw1*u134_78(i7,i8)%b(1,2)+cw2*u134_78(i7,i8)%a(2,2)
      u1_3478(i3,i4,i7,i8)%b(iut,2)=u1_3478(i3,i4,i7,i8)%b(iut,2
     & )+cz1*u134_78(i7,i8)%b(1,2)+cz2*u134_78(i7,i8)%a(2,2)
      u1_3478(i3,i4,i7,i8)%c(iut,2)=u1_3478(i3,i4,i7,i8)%c(iut,2
     & )+cx1*u134_78(i7,i8)%c(1,2)+cx2*u134_78(i7,i8)%d(2,2)
      u1_3478(i3,i4,i7,i8)%d(iut,2)=u1_3478(i3,i4,i7,i8)%d(iut,2
     & )+cy1*u134_78(i7,i8)%c(1,2)+cy2*u134_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id1.eq.5.and.id3.ne.5.and.id7.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=u1_3478(i3,i4,i7,i8)%a,bb=u1_3478(i3,i4,i7,i8)%b,cc=u1_3478(
* i3,i4,i7,i8)%c,dd=u1_3478(i3,i4,i7,i8)%d,a1=l1_34(i3,i4)%a,b1=l1_34(i3
* ,i4)%b,c1=l1_34(i3,i4)%c,d1=l1_34(i3,i4)%d,a2=u134_78(i7,i8)%a,b2=u134
* _78(i7,i8)%b,c2=u134_78(i7,i8)%c,d2=u134_78(i7,i8)%d,prq=p134q,m=rmass
* (id1),nsum=1
      do jut=1,2
      cx1=u134_78(i7,i8)%a(1,jut)+rmass(id1)*u134_78(i7,i8)%b(1,
     & jut)
      cx2=u134_78(i7,i8)%a(2,jut)+rmass(id1)*u134_78(i7,i8)%b(2,
     & jut)
      cy1=p134q*u134_78(i7,i8)%b(1,jut)+rmass(id1)*u134_78(i7,i8
     & )%a(1,jut)
      cy2=p134q*u134_78(i7,i8)%b(2,jut)+rmass(id1)*u134_78(i7,i8
     & )%a(2,jut)
      cw1=u134_78(i7,i8)%c(1,jut)+rmass(id1)*u134_78(i7,i8)%d(1,
     & jut)
      cw2=u134_78(i7,i8)%c(2,jut)+rmass(id1)*u134_78(i7,i8)%d(2,
     & jut)
      cz1=p134q*u134_78(i7,i8)%d(1,jut)+rmass(id1)*u134_78(i7,i8
     & )%c(1,jut)
      cz2=p134q*u134_78(i7,i8)%d(2,jut)+rmass(id1)*u134_78(i7,i8
     & )%c(2,jut)
      u1_3478(i3,i4,i7,i8)%a(1,jut)=u1_3478(i3,i4,i7,i8)%a(1,jut
     & )+l1_34(i3,i4)%a(1,1)*cx1+l1_34(i3,i4)%c(1,2)*cy2
      u1_3478(i3,i4,i7,i8)%b(1,jut)=u1_3478(i3,i4,i7,i8)%b(1,jut
     & )+l1_34(i3,i4)%d(1,1)*cy1+l1_34(i3,i4)%b(1,2)*cx2
      u1_3478(i3,i4,i7,i8)%c(1,jut)=u1_3478(i3,i4,i7,i8)%c(1,jut
     & )+l1_34(i3,i4)%a(1,1)*cw1+l1_34(i3,i4)%c(1,2)*cz2
      u1_3478(i3,i4,i7,i8)%d(1,jut)=u1_3478(i3,i4,i7,i8)%d(1,jut
     & )+l1_34(i3,i4)%d(1,1)*cz1+l1_34(i3,i4)%b(1,2)*cw2
      u1_3478(i3,i4,i7,i8)%a(2,jut)=u1_3478(i3,i4,i7,i8)%a(2,jut
     & )+l1_34(i3,i4)%c(2,1)*cy1+l1_34(i3,i4)%a(2,2)*cx2
      u1_3478(i3,i4,i7,i8)%b(2,jut)=u1_3478(i3,i4,i7,i8)%b(2,jut
     & )+l1_34(i3,i4)%b(2,1)*cx1+l1_34(i3,i4)%d(2,2)*cy2
      u1_3478(i3,i4,i7,i8)%c(2,jut)=u1_3478(i3,i4,i7,i8)%c(2,jut
     & )+l1_34(i3,i4)%c(2,1)*cz1+l1_34(i3,i4)%a(2,2)*cw2
      u1_3478(i3,i4,i7,i8)%d(2,jut)=u1_3478(i3,i4,i7,i8)%d(2,jut
     & )+l1_34(i3,i4)%b(2,1)*cw1+l1_34(i3,i4)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p178q,p=p178,q=p178,bef=,aft=
      p178q=(p178(0)*p178(0)-p178(1)*p178(1)-p178(2)*p178(2)-p17
     & 8(3)*p178(3))
  
      if(id1.ne.5.or.(id7.ne.5.and.id3.ne.5))then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=u1_3478(i3,i4,i7,i8)%a,bb=u1_3478(i3,i4,i7,i8)%b,cc=u1_3478(i
* 3,i4,i7,i8)%c,dd=u1_3478(i3,i4,i7,i8)%d,a1=l1_78(i7,i8)%a,b1=l1_78(i7,
* i8)%b,c1=l1_78(i7,i8)%c,d1=l1_78(i7,i8)%d,a2=u178_34(i3,i4)%a,b2=u178_
* 34(i3,i4)%b,c2=u178_34(i3,i4)%c,d2=u178_34(i3,i4)%d,prq=p178q,m=rmass(
* id1),nsum=1
      u1_3478(i3,i4,i7,i8)%a(1,1)=u1_3478(i3,i4,i7,i8)%a(1,1)+l1
     & _78(i7,i8)%a(1,1)*u178_34(i3,i4)%a(1,1)+l1_78(i7,i8)%c(1,
     & 2)*p178q*u178_34(i3,i4)%b(2,1)
      u1_3478(i3,i4,i7,i8)%b(1,1)=u1_3478(i3,i4,i7,i8)%b(1,1)+rm
     & ass(id1)*(l1_78(i7,i8)%d(1,1)*u178_34(i3,i4)%a(1,1)+l1_78
     & (i7,i8)%b(1,2)*u178_34(i3,i4)%b(2,1))
      u1_3478(i3,i4,i7,i8)%c(1,1)=u1_3478(i3,i4,i7,i8)%c(1,1)+rm
     & ass(id1)*(l1_78(i7,i8)%a(1,1)*u178_34(i3,i4)%d(1,1)+l1_78
     & (i7,i8)%c(1,2)*u178_34(i3,i4)%c(2,1))
      u1_3478(i3,i4,i7,i8)%d(1,1)=u1_3478(i3,i4,i7,i8)%d(1,1)+l1
     & _78(i7,i8)%d(1,1)*p178q*u178_34(i3,i4)%d(1,1)+l1_78(i7,i8
     & )%b(1,2)*u178_34(i3,i4)%c(2,1)
      u1_3478(i3,i4,i7,i8)%a(1,2)=u1_3478(i3,i4,i7,i8)%a(1,2)+rm
     & ass(id1)*(l1_78(i7,i8)%a(1,1)*u178_34(i3,i4)%b(1,2)+l1_78
     & (i7,i8)%c(1,2)*u178_34(i3,i4)%a(2,2))
      u1_3478(i3,i4,i7,i8)%b(1,2)=u1_3478(i3,i4,i7,i8)%b(1,2)+l1
     & _78(i7,i8)%d(1,1)*p178q*u178_34(i3,i4)%b(1,2)+l1_78(i7,i8
     & )%b(1,2)*u178_34(i3,i4)%a(2,2)
      u1_3478(i3,i4,i7,i8)%c(1,2)=u1_3478(i3,i4,i7,i8)%c(1,2)+l1
     & _78(i7,i8)%a(1,1)*u178_34(i3,i4)%c(1,2)+l1_78(i7,i8)%c(1,
     & 2)*p178q*u178_34(i3,i4)%d(2,2)
      u1_3478(i3,i4,i7,i8)%d(1,2)=u1_3478(i3,i4,i7,i8)%d(1,2)+rm
     & ass(id1)*(l1_78(i7,i8)%d(1,1)*u178_34(i3,i4)%c(1,2)+l1_78
     & (i7,i8)%b(1,2)*u178_34(i3,i4)%d(2,2))
      u1_3478(i3,i4,i7,i8)%a(2,1)=u1_3478(i3,i4,i7,i8)%a(2,1)+rm
     & ass(id1)*(l1_78(i7,i8)%c(2,1)*u178_34(i3,i4)%a(1,1)+l1_78
     & (i7,i8)%a(2,2)*u178_34(i3,i4)%b(2,1))
      u1_3478(i3,i4,i7,i8)%b(2,1)=u1_3478(i3,i4,i7,i8)%b(2,1)+l1
     & _78(i7,i8)%b(2,1)*u178_34(i3,i4)%a(1,1)+l1_78(i7,i8)%d(2,
     & 2)*p178q*u178_34(i3,i4)%b(2,1)
      u1_3478(i3,i4,i7,i8)%c(2,1)=u1_3478(i3,i4,i7,i8)%c(2,1)+l1
     & _78(i7,i8)%c(2,1)*p178q*u178_34(i3,i4)%d(1,1)+l1_78(i7,i8
     & )%a(2,2)*u178_34(i3,i4)%c(2,1)
      u1_3478(i3,i4,i7,i8)%d(2,1)=u1_3478(i3,i4,i7,i8)%d(2,1)+rm
     & ass(id1)*(l1_78(i7,i8)%b(2,1)*u178_34(i3,i4)%d(1,1)+l1_78
     & (i7,i8)%d(2,2)*u178_34(i3,i4)%c(2,1))
      u1_3478(i3,i4,i7,i8)%a(2,2)=u1_3478(i3,i4,i7,i8)%a(2,2)+l1
     & _78(i7,i8)%c(2,1)*p178q*u178_34(i3,i4)%b(1,2)+l1_78(i7,i8
     & )%a(2,2)*u178_34(i3,i4)%a(2,2)
      u1_3478(i3,i4,i7,i8)%b(2,2)=u1_3478(i3,i4,i7,i8)%b(2,2)+rm
     & ass(id1)*(l1_78(i7,i8)%b(2,1)*u178_34(i3,i4)%b(1,2)+l1_78
     & (i7,i8)%d(2,2)*u178_34(i3,i4)%a(2,2))
      u1_3478(i3,i4,i7,i8)%c(2,2)=u1_3478(i3,i4,i7,i8)%c(2,2)+rm
     & ass(id1)*(l1_78(i7,i8)%c(2,1)*u178_34(i3,i4)%c(1,2)+l1_78
     & (i7,i8)%a(2,2)*u178_34(i3,i4)%d(2,2))
      u1_3478(i3,i4,i7,i8)%d(2,2)=u1_3478(i3,i4,i7,i8)%d(2,2)+l1
     & _78(i7,i8)%b(2,1)*u178_34(i3,i4)%c(1,2)+l1_78(i7,i8)%d(2,
     & 2)*p178q*u178_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id1.eq.5.and.id7.eq.5.and.id3.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=u1_3478(i3,i4,i7,i8)%a,bb=u1_3478(i3,i4,i7,i8)%b,cc=u1_3478
* (i3,i4,i7,i8)%c,dd=u1_3478(i3,i4,i7,i8)%d,a1=l1_78(i7,i8)%a,b1=l1_78(i
* 7,i8)%b,c1=l1_78(i7,i8)%c,d1=l1_78(i7,i8)%d,a2=u178_34(i3,i4)%a,b2=u17
* 8_34(i3,i4)%b,c2=u178_34(i3,i4)%c,d2=u178_34(i3,i4)%d,prq=p178q,m=rmas
* s(id1),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u178_34(i3,i4)%a(1,jut)+rmass(id1)*u178_34(i3,i4)%b(1,
     & jut)
      cx2=u178_34(i3,i4)%a(2,jut)+rmass(id1)*u178_34(i3,i4)%b(2,
     & jut)
      cy1=p178q*u178_34(i3,i4)%b(1,jut)+rmass(id1)*u178_34(i3,i4
     & )%a(1,jut)
      cy2=p178q*u178_34(i3,i4)%b(2,jut)+rmass(id1)*u178_34(i3,i4
     & )%a(2,jut)
      u1_3478(i3,i4,i7,i8)%a(iut,jut)=u1_3478(i3,i4,i7,i8)%a(iut
     & ,jut)+l1_78(i7,i8)%a(iut,1)*cx1+l1_78(i7,i8)%c(iut,1)*cy1
     & +l1_78(i7,i8)%a(iut,2)*cx2+l1_78(i7,i8)%c(iut,2)*cy2
      u1_3478(i3,i4,i7,i8)%b(iut,jut)=u1_3478(i3,i4,i7,i8)%b(iut
     & ,jut)+l1_78(i7,i8)%b(iut,1)*cx1+l1_78(i7,i8)%d(iut,1)*cy1
     & +l1_78(i7,i8)%b(iut,2)*cx2+l1_78(i7,i8)%d(iut,2)*cy2
      cw1=u178_34(i3,i4)%c(1,jut)+rmass(id1)*u178_34(i3,i4)%d(1,
     & jut)
      cw2=u178_34(i3,i4)%c(2,jut)+rmass(id1)*u178_34(i3,i4)%d(2,
     & jut)
      cz1=p178q*u178_34(i3,i4)%d(1,jut)+rmass(id1)*u178_34(i3,i4
     & )%c(1,jut)
      cz2=p178q*u178_34(i3,i4)%d(2,jut)+rmass(id1)*u178_34(i3,i4
     & )%c(2,jut)
      u1_3478(i3,i4,i7,i8)%c(iut,jut)=u1_3478(i3,i4,i7,i8)%c(iut
     & ,jut)+l1_78(i7,i8)%a(iut,1)*cw1+l1_78(i7,i8)%c(iut,1)*cz1
     & +l1_78(i7,i8)%a(iut,2)*cw2+l1_78(i7,i8)%c(iut,2)*cz2
      u1_3478(i3,i4,i7,i8)%d(iut,jut)=u1_3478(i3,i4,i7,i8)%d(iut
     & ,jut)+l1_78(i7,i8)%b(iut,1)*cw1+l1_78(i7,i8)%d(iut,1)*cz1
     & +l1_78(i7,i8)%b(iut,2)*cw2+l1_78(i7,i8)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id1.eq.5.and.id7.eq.5.and.id3.ne.5)then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=u1_3478(i3,i4,i7,i8)%a,bb=u1_3478(i3,i4,i7,i8)%b,cc=u1_3478(
* i3,i4,i7,i8)%c,dd=u1_3478(i3,i4,i7,i8)%d,a1=l1_78(i7,i8)%a,b1=l1_78(i7
* ,i8)%b,c1=l1_78(i7,i8)%c,d1=l1_78(i7,i8)%d,a2=u178_34(i3,i4)%a,b2=u178
* _34(i3,i4)%b,c2=u178_34(i3,i4)%c,d2=u178_34(i3,i4)%d,prq=p178q,m=rmass
* (id1),nsum=1
      do iut=1,2
      cx1=l1_78(i7,i8)%a(iut,1)+l1_78(i7,i8)%c(iut,1)*rmass(id1)
      cx2=l1_78(i7,i8)%c(iut,2)*p178q+l1_78(i7,i8)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_78(i7,i8)%b(iut,1)+l1_78(i7,i8)%d(iut,1)*rmass(id1)
      cy2=l1_78(i7,i8)%d(iut,2)*p178q+l1_78(i7,i8)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_78(i7,i8)%c(iut,1)*p178q+l1_78(i7,i8)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_78(i7,i8)%a(iut,2)+l1_78(i7,i8)%c(iut,2)*rmass(id1)
      cz1=l1_78(i7,i8)%d(iut,1)*p178q+l1_78(i7,i8)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_78(i7,i8)%b(iut,2)+l1_78(i7,i8)%d(iut,2)*rmass(id1)
      u1_3478(i3,i4,i7,i8)%a(iut,1)=u1_3478(i3,i4,i7,i8)%a(iut,1
     & )+cx1*u178_34(i3,i4)%a(1,1)+cx2*u178_34(i3,i4)%b(2,1)
      u1_3478(i3,i4,i7,i8)%b(iut,1)=u1_3478(i3,i4,i7,i8)%b(iut,1
     & )+cy1*u178_34(i3,i4)%a(1,1)+cy2*u178_34(i3,i4)%b(2,1)
      u1_3478(i3,i4,i7,i8)%c(iut,1)=u1_3478(i3,i4,i7,i8)%c(iut,1
     & )+cw1*u178_34(i3,i4)%d(1,1)+cw2*u178_34(i3,i4)%c(2,1)
      u1_3478(i3,i4,i7,i8)%d(iut,1)=u1_3478(i3,i4,i7,i8)%d(iut,1
     & )+cz1*u178_34(i3,i4)%d(1,1)+cz2*u178_34(i3,i4)%c(2,1)
      u1_3478(i3,i4,i7,i8)%a(iut,2)=u1_3478(i3,i4,i7,i8)%a(iut,2
     & )+cw1*u178_34(i3,i4)%b(1,2)+cw2*u178_34(i3,i4)%a(2,2)
      u1_3478(i3,i4,i7,i8)%b(iut,2)=u1_3478(i3,i4,i7,i8)%b(iut,2
     & )+cz1*u178_34(i3,i4)%b(1,2)+cz2*u178_34(i3,i4)%a(2,2)
      u1_3478(i3,i4,i7,i8)%c(iut,2)=u1_3478(i3,i4,i7,i8)%c(iut,2
     & )+cx1*u178_34(i3,i4)%c(1,2)+cx2*u178_34(i3,i4)%d(2,2)
      u1_3478(i3,i4,i7,i8)%d(iut,2)=u1_3478(i3,i4,i7,i8)%d(iut,2
     & )+cy1*u178_34(i3,i4)%c(1,2)+cy2*u178_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id1.eq.5.and.id7.ne.5.and.id3.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=u1_3478(i3,i4,i7,i8)%a,bb=u1_3478(i3,i4,i7,i8)%b,cc=u1_3478(
* i3,i4,i7,i8)%c,dd=u1_3478(i3,i4,i7,i8)%d,a1=l1_78(i7,i8)%a,b1=l1_78(i7
* ,i8)%b,c1=l1_78(i7,i8)%c,d1=l1_78(i7,i8)%d,a2=u178_34(i3,i4)%a,b2=u178
* _34(i3,i4)%b,c2=u178_34(i3,i4)%c,d2=u178_34(i3,i4)%d,prq=p178q,m=rmass
* (id1),nsum=1
      do jut=1,2
      cx1=u178_34(i3,i4)%a(1,jut)+rmass(id1)*u178_34(i3,i4)%b(1,
     & jut)
      cx2=u178_34(i3,i4)%a(2,jut)+rmass(id1)*u178_34(i3,i4)%b(2,
     & jut)
      cy1=p178q*u178_34(i3,i4)%b(1,jut)+rmass(id1)*u178_34(i3,i4
     & )%a(1,jut)
      cy2=p178q*u178_34(i3,i4)%b(2,jut)+rmass(id1)*u178_34(i3,i4
     & )%a(2,jut)
      cw1=u178_34(i3,i4)%c(1,jut)+rmass(id1)*u178_34(i3,i4)%d(1,
     & jut)
      cw2=u178_34(i3,i4)%c(2,jut)+rmass(id1)*u178_34(i3,i4)%d(2,
     & jut)
      cz1=p178q*u178_34(i3,i4)%d(1,jut)+rmass(id1)*u178_34(i3,i4
     & )%c(1,jut)
      cz2=p178q*u178_34(i3,i4)%d(2,jut)+rmass(id1)*u178_34(i3,i4
     & )%c(2,jut)
      u1_3478(i3,i4,i7,i8)%a(1,jut)=u1_3478(i3,i4,i7,i8)%a(1,jut
     & )+l1_78(i7,i8)%a(1,1)*cx1+l1_78(i7,i8)%c(1,2)*cy2
      u1_3478(i3,i4,i7,i8)%b(1,jut)=u1_3478(i3,i4,i7,i8)%b(1,jut
     & )+l1_78(i7,i8)%d(1,1)*cy1+l1_78(i7,i8)%b(1,2)*cx2
      u1_3478(i3,i4,i7,i8)%c(1,jut)=u1_3478(i3,i4,i7,i8)%c(1,jut
     & )+l1_78(i7,i8)%a(1,1)*cw1+l1_78(i7,i8)%c(1,2)*cz2
      u1_3478(i3,i4,i7,i8)%d(1,jut)=u1_3478(i3,i4,i7,i8)%d(1,jut
     & )+l1_78(i7,i8)%d(1,1)*cz1+l1_78(i7,i8)%b(1,2)*cw2
      u1_3478(i3,i4,i7,i8)%a(2,jut)=u1_3478(i3,i4,i7,i8)%a(2,jut
     & )+l1_78(i7,i8)%c(2,1)*cy1+l1_78(i7,i8)%a(2,2)*cx2
      u1_3478(i3,i4,i7,i8)%b(2,jut)=u1_3478(i3,i4,i7,i8)%b(2,jut
     & )+l1_78(i7,i8)%b(2,1)*cx1+l1_78(i7,i8)%d(2,2)*cy2
      u1_3478(i3,i4,i7,i8)%c(2,jut)=u1_3478(i3,i4,i7,i8)%c(2,jut
     & )+l1_78(i7,i8)%c(2,1)*cz1+l1_78(i7,i8)%a(2,2)*cw2
      u1_3478(i3,i4,i7,i8)%d(2,jut)=u1_3478(i3,i4,i7,i8)%d(2,jut
     & )+l1_78(i7,i8)%b(2,1)*cw1+l1_78(i7,i8)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p156q,p=p156,q=p156,bef=,aft=
      p156q=(p156(0)*p156(0)-p156(1)*p156(1)-p156(2)*p156(2)-p15
     & 6(3)*p156(3))
  
      if(id1.ne.5.or.(id5.ne.5.and.id7.ne.5))then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=u1_5678(i5,i6,i7,i8)%a,bb=u1_5678(i5,i6,i7,i8)%b,cc=u1_5678(i
* 5,i6,i7,i8)%c,dd=u1_5678(i5,i6,i7,i8)%d,a1=l1_56(i5,i6)%a,b1=l1_56(i5,
* i6)%b,c1=l1_56(i5,i6)%c,d1=l1_56(i5,i6)%d,a2=u156_78(i7,i8)%a,b2=u156_
* 78(i7,i8)%b,c2=u156_78(i7,i8)%c,d2=u156_78(i7,i8)%d,prq=p156q,m=rmass(
* id1),nsum=1
      u1_5678(i5,i6,i7,i8)%a(1,1)=u1_5678(i5,i6,i7,i8)%a(1,1)+l1
     & _56(i5,i6)%a(1,1)*u156_78(i7,i8)%a(1,1)+l1_56(i5,i6)%c(1,
     & 2)*p156q*u156_78(i7,i8)%b(2,1)
      u1_5678(i5,i6,i7,i8)%b(1,1)=u1_5678(i5,i6,i7,i8)%b(1,1)+rm
     & ass(id1)*(l1_56(i5,i6)%d(1,1)*u156_78(i7,i8)%a(1,1)+l1_56
     & (i5,i6)%b(1,2)*u156_78(i7,i8)%b(2,1))
      u1_5678(i5,i6,i7,i8)%c(1,1)=u1_5678(i5,i6,i7,i8)%c(1,1)+rm
     & ass(id1)*(l1_56(i5,i6)%a(1,1)*u156_78(i7,i8)%d(1,1)+l1_56
     & (i5,i6)%c(1,2)*u156_78(i7,i8)%c(2,1))
      u1_5678(i5,i6,i7,i8)%d(1,1)=u1_5678(i5,i6,i7,i8)%d(1,1)+l1
     & _56(i5,i6)%d(1,1)*p156q*u156_78(i7,i8)%d(1,1)+l1_56(i5,i6
     & )%b(1,2)*u156_78(i7,i8)%c(2,1)
      u1_5678(i5,i6,i7,i8)%a(1,2)=u1_5678(i5,i6,i7,i8)%a(1,2)+rm
     & ass(id1)*(l1_56(i5,i6)%a(1,1)*u156_78(i7,i8)%b(1,2)+l1_56
     & (i5,i6)%c(1,2)*u156_78(i7,i8)%a(2,2))
      u1_5678(i5,i6,i7,i8)%b(1,2)=u1_5678(i5,i6,i7,i8)%b(1,2)+l1
     & _56(i5,i6)%d(1,1)*p156q*u156_78(i7,i8)%b(1,2)+l1_56(i5,i6
     & )%b(1,2)*u156_78(i7,i8)%a(2,2)
      u1_5678(i5,i6,i7,i8)%c(1,2)=u1_5678(i5,i6,i7,i8)%c(1,2)+l1
     & _56(i5,i6)%a(1,1)*u156_78(i7,i8)%c(1,2)+l1_56(i5,i6)%c(1,
     & 2)*p156q*u156_78(i7,i8)%d(2,2)
      u1_5678(i5,i6,i7,i8)%d(1,2)=u1_5678(i5,i6,i7,i8)%d(1,2)+rm
     & ass(id1)*(l1_56(i5,i6)%d(1,1)*u156_78(i7,i8)%c(1,2)+l1_56
     & (i5,i6)%b(1,2)*u156_78(i7,i8)%d(2,2))
      u1_5678(i5,i6,i7,i8)%a(2,1)=u1_5678(i5,i6,i7,i8)%a(2,1)+rm
     & ass(id1)*(l1_56(i5,i6)%c(2,1)*u156_78(i7,i8)%a(1,1)+l1_56
     & (i5,i6)%a(2,2)*u156_78(i7,i8)%b(2,1))
      u1_5678(i5,i6,i7,i8)%b(2,1)=u1_5678(i5,i6,i7,i8)%b(2,1)+l1
     & _56(i5,i6)%b(2,1)*u156_78(i7,i8)%a(1,1)+l1_56(i5,i6)%d(2,
     & 2)*p156q*u156_78(i7,i8)%b(2,1)
      u1_5678(i5,i6,i7,i8)%c(2,1)=u1_5678(i5,i6,i7,i8)%c(2,1)+l1
     & _56(i5,i6)%c(2,1)*p156q*u156_78(i7,i8)%d(1,1)+l1_56(i5,i6
     & )%a(2,2)*u156_78(i7,i8)%c(2,1)
      u1_5678(i5,i6,i7,i8)%d(2,1)=u1_5678(i5,i6,i7,i8)%d(2,1)+rm
     & ass(id1)*(l1_56(i5,i6)%b(2,1)*u156_78(i7,i8)%d(1,1)+l1_56
     & (i5,i6)%d(2,2)*u156_78(i7,i8)%c(2,1))
      u1_5678(i5,i6,i7,i8)%a(2,2)=u1_5678(i5,i6,i7,i8)%a(2,2)+l1
     & _56(i5,i6)%c(2,1)*p156q*u156_78(i7,i8)%b(1,2)+l1_56(i5,i6
     & )%a(2,2)*u156_78(i7,i8)%a(2,2)
      u1_5678(i5,i6,i7,i8)%b(2,2)=u1_5678(i5,i6,i7,i8)%b(2,2)+rm
     & ass(id1)*(l1_56(i5,i6)%b(2,1)*u156_78(i7,i8)%b(1,2)+l1_56
     & (i5,i6)%d(2,2)*u156_78(i7,i8)%a(2,2))
      u1_5678(i5,i6,i7,i8)%c(2,2)=u1_5678(i5,i6,i7,i8)%c(2,2)+rm
     & ass(id1)*(l1_56(i5,i6)%c(2,1)*u156_78(i7,i8)%c(1,2)+l1_56
     & (i5,i6)%a(2,2)*u156_78(i7,i8)%d(2,2))
      u1_5678(i5,i6,i7,i8)%d(2,2)=u1_5678(i5,i6,i7,i8)%d(2,2)+l1
     & _56(i5,i6)%b(2,1)*u156_78(i7,i8)%c(1,2)+l1_56(i5,i6)%d(2,
     & 2)*p156q*u156_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id1.eq.5.and.id5.eq.5.and.id7.eq.5)then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=u1_5678(i5,i6,i7,i8)%a,bb=u1_5678(i5,i6,i7,i8)%b,cc=u1_5678
* (i5,i6,i7,i8)%c,dd=u1_5678(i5,i6,i7,i8)%d,a1=l1_56(i5,i6)%a,b1=l1_56(i
* 5,i6)%b,c1=l1_56(i5,i6)%c,d1=l1_56(i5,i6)%d,a2=u156_78(i7,i8)%a,b2=u15
* 6_78(i7,i8)%b,c2=u156_78(i7,i8)%c,d2=u156_78(i7,i8)%d,prq=p156q,m=rmas
* s(id1),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u156_78(i7,i8)%a(1,jut)+rmass(id1)*u156_78(i7,i8)%b(1,
     & jut)
      cx2=u156_78(i7,i8)%a(2,jut)+rmass(id1)*u156_78(i7,i8)%b(2,
     & jut)
      cy1=p156q*u156_78(i7,i8)%b(1,jut)+rmass(id1)*u156_78(i7,i8
     & )%a(1,jut)
      cy2=p156q*u156_78(i7,i8)%b(2,jut)+rmass(id1)*u156_78(i7,i8
     & )%a(2,jut)
      u1_5678(i5,i6,i7,i8)%a(iut,jut)=u1_5678(i5,i6,i7,i8)%a(iut
     & ,jut)+l1_56(i5,i6)%a(iut,1)*cx1+l1_56(i5,i6)%c(iut,1)*cy1
     & +l1_56(i5,i6)%a(iut,2)*cx2+l1_56(i5,i6)%c(iut,2)*cy2
      u1_5678(i5,i6,i7,i8)%b(iut,jut)=u1_5678(i5,i6,i7,i8)%b(iut
     & ,jut)+l1_56(i5,i6)%b(iut,1)*cx1+l1_56(i5,i6)%d(iut,1)*cy1
     & +l1_56(i5,i6)%b(iut,2)*cx2+l1_56(i5,i6)%d(iut,2)*cy2
      cw1=u156_78(i7,i8)%c(1,jut)+rmass(id1)*u156_78(i7,i8)%d(1,
     & jut)
      cw2=u156_78(i7,i8)%c(2,jut)+rmass(id1)*u156_78(i7,i8)%d(2,
     & jut)
      cz1=p156q*u156_78(i7,i8)%d(1,jut)+rmass(id1)*u156_78(i7,i8
     & )%c(1,jut)
      cz2=p156q*u156_78(i7,i8)%d(2,jut)+rmass(id1)*u156_78(i7,i8
     & )%c(2,jut)
      u1_5678(i5,i6,i7,i8)%c(iut,jut)=u1_5678(i5,i6,i7,i8)%c(iut
     & ,jut)+l1_56(i5,i6)%a(iut,1)*cw1+l1_56(i5,i6)%c(iut,1)*cz1
     & +l1_56(i5,i6)%a(iut,2)*cw2+l1_56(i5,i6)%c(iut,2)*cz2
      u1_5678(i5,i6,i7,i8)%d(iut,jut)=u1_5678(i5,i6,i7,i8)%d(iut
     & ,jut)+l1_56(i5,i6)%b(iut,1)*cw1+l1_56(i5,i6)%d(iut,1)*cz1
     & +l1_56(i5,i6)%b(iut,2)*cw2+l1_56(i5,i6)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id1.eq.5.and.id5.eq.5.and.id7.ne.5)then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=u1_5678(i5,i6,i7,i8)%a,bb=u1_5678(i5,i6,i7,i8)%b,cc=u1_5678(
* i5,i6,i7,i8)%c,dd=u1_5678(i5,i6,i7,i8)%d,a1=l1_56(i5,i6)%a,b1=l1_56(i5
* ,i6)%b,c1=l1_56(i5,i6)%c,d1=l1_56(i5,i6)%d,a2=u156_78(i7,i8)%a,b2=u156
* _78(i7,i8)%b,c2=u156_78(i7,i8)%c,d2=u156_78(i7,i8)%d,prq=p156q,m=rmass
* (id1),nsum=1
      do iut=1,2
      cx1=l1_56(i5,i6)%a(iut,1)+l1_56(i5,i6)%c(iut,1)*rmass(id1)
      cx2=l1_56(i5,i6)%c(iut,2)*p156q+l1_56(i5,i6)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_56(i5,i6)%b(iut,1)+l1_56(i5,i6)%d(iut,1)*rmass(id1)
      cy2=l1_56(i5,i6)%d(iut,2)*p156q+l1_56(i5,i6)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_56(i5,i6)%c(iut,1)*p156q+l1_56(i5,i6)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_56(i5,i6)%a(iut,2)+l1_56(i5,i6)%c(iut,2)*rmass(id1)
      cz1=l1_56(i5,i6)%d(iut,1)*p156q+l1_56(i5,i6)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_56(i5,i6)%b(iut,2)+l1_56(i5,i6)%d(iut,2)*rmass(id1)
      u1_5678(i5,i6,i7,i8)%a(iut,1)=u1_5678(i5,i6,i7,i8)%a(iut,1
     & )+cx1*u156_78(i7,i8)%a(1,1)+cx2*u156_78(i7,i8)%b(2,1)
      u1_5678(i5,i6,i7,i8)%b(iut,1)=u1_5678(i5,i6,i7,i8)%b(iut,1
     & )+cy1*u156_78(i7,i8)%a(1,1)+cy2*u156_78(i7,i8)%b(2,1)
      u1_5678(i5,i6,i7,i8)%c(iut,1)=u1_5678(i5,i6,i7,i8)%c(iut,1
     & )+cw1*u156_78(i7,i8)%d(1,1)+cw2*u156_78(i7,i8)%c(2,1)
      u1_5678(i5,i6,i7,i8)%d(iut,1)=u1_5678(i5,i6,i7,i8)%d(iut,1
     & )+cz1*u156_78(i7,i8)%d(1,1)+cz2*u156_78(i7,i8)%c(2,1)
      u1_5678(i5,i6,i7,i8)%a(iut,2)=u1_5678(i5,i6,i7,i8)%a(iut,2
     & )+cw1*u156_78(i7,i8)%b(1,2)+cw2*u156_78(i7,i8)%a(2,2)
      u1_5678(i5,i6,i7,i8)%b(iut,2)=u1_5678(i5,i6,i7,i8)%b(iut,2
     & )+cz1*u156_78(i7,i8)%b(1,2)+cz2*u156_78(i7,i8)%a(2,2)
      u1_5678(i5,i6,i7,i8)%c(iut,2)=u1_5678(i5,i6,i7,i8)%c(iut,2
     & )+cx1*u156_78(i7,i8)%c(1,2)+cx2*u156_78(i7,i8)%d(2,2)
      u1_5678(i5,i6,i7,i8)%d(iut,2)=u1_5678(i5,i6,i7,i8)%d(iut,2
     & )+cy1*u156_78(i7,i8)%c(1,2)+cy2*u156_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id1.eq.5.and.id5.ne.5.and.id7.eq.5)then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=u1_5678(i5,i6,i7,i8)%a,bb=u1_5678(i5,i6,i7,i8)%b,cc=u1_5678(
* i5,i6,i7,i8)%c,dd=u1_5678(i5,i6,i7,i8)%d,a1=l1_56(i5,i6)%a,b1=l1_56(i5
* ,i6)%b,c1=l1_56(i5,i6)%c,d1=l1_56(i5,i6)%d,a2=u156_78(i7,i8)%a,b2=u156
* _78(i7,i8)%b,c2=u156_78(i7,i8)%c,d2=u156_78(i7,i8)%d,prq=p156q,m=rmass
* (id1),nsum=1
      do jut=1,2
      cx1=u156_78(i7,i8)%a(1,jut)+rmass(id1)*u156_78(i7,i8)%b(1,
     & jut)
      cx2=u156_78(i7,i8)%a(2,jut)+rmass(id1)*u156_78(i7,i8)%b(2,
     & jut)
      cy1=p156q*u156_78(i7,i8)%b(1,jut)+rmass(id1)*u156_78(i7,i8
     & )%a(1,jut)
      cy2=p156q*u156_78(i7,i8)%b(2,jut)+rmass(id1)*u156_78(i7,i8
     & )%a(2,jut)
      cw1=u156_78(i7,i8)%c(1,jut)+rmass(id1)*u156_78(i7,i8)%d(1,
     & jut)
      cw2=u156_78(i7,i8)%c(2,jut)+rmass(id1)*u156_78(i7,i8)%d(2,
     & jut)
      cz1=p156q*u156_78(i7,i8)%d(1,jut)+rmass(id1)*u156_78(i7,i8
     & )%c(1,jut)
      cz2=p156q*u156_78(i7,i8)%d(2,jut)+rmass(id1)*u156_78(i7,i8
     & )%c(2,jut)
      u1_5678(i5,i6,i7,i8)%a(1,jut)=u1_5678(i5,i6,i7,i8)%a(1,jut
     & )+l1_56(i5,i6)%a(1,1)*cx1+l1_56(i5,i6)%c(1,2)*cy2
      u1_5678(i5,i6,i7,i8)%b(1,jut)=u1_5678(i5,i6,i7,i8)%b(1,jut
     & )+l1_56(i5,i6)%d(1,1)*cy1+l1_56(i5,i6)%b(1,2)*cx2
      u1_5678(i5,i6,i7,i8)%c(1,jut)=u1_5678(i5,i6,i7,i8)%c(1,jut
     & )+l1_56(i5,i6)%a(1,1)*cw1+l1_56(i5,i6)%c(1,2)*cz2
      u1_5678(i5,i6,i7,i8)%d(1,jut)=u1_5678(i5,i6,i7,i8)%d(1,jut
     & )+l1_56(i5,i6)%d(1,1)*cz1+l1_56(i5,i6)%b(1,2)*cw2
      u1_5678(i5,i6,i7,i8)%a(2,jut)=u1_5678(i5,i6,i7,i8)%a(2,jut
     & )+l1_56(i5,i6)%c(2,1)*cy1+l1_56(i5,i6)%a(2,2)*cx2
      u1_5678(i5,i6,i7,i8)%b(2,jut)=u1_5678(i5,i6,i7,i8)%b(2,jut
     & )+l1_56(i5,i6)%b(2,1)*cx1+l1_56(i5,i6)%d(2,2)*cy2
      u1_5678(i5,i6,i7,i8)%c(2,jut)=u1_5678(i5,i6,i7,i8)%c(2,jut
     & )+l1_56(i5,i6)%c(2,1)*cz1+l1_56(i5,i6)%a(2,2)*cw2
      u1_5678(i5,i6,i7,i8)%d(2,jut)=u1_5678(i5,i6,i7,i8)%d(2,jut
     & )+l1_56(i5,i6)%b(2,1)*cw1+l1_56(i5,i6)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p178q,p=p178,q=p178,bef=,aft=
      p178q=(p178(0)*p178(0)-p178(1)*p178(1)-p178(2)*p178(2)-p17
     & 8(3)*p178(3))
  
      if(id1.ne.5.or.(id7.ne.5.and.id5.ne.5))then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=u1_5678(i5,i6,i7,i8)%a,bb=u1_5678(i5,i6,i7,i8)%b,cc=u1_5678(i
* 5,i6,i7,i8)%c,dd=u1_5678(i5,i6,i7,i8)%d,a1=l1_78(i7,i8)%a,b1=l1_78(i7,
* i8)%b,c1=l1_78(i7,i8)%c,d1=l1_78(i7,i8)%d,a2=u178_56(i5,i6)%a,b2=u178_
* 56(i5,i6)%b,c2=u178_56(i5,i6)%c,d2=u178_56(i5,i6)%d,prq=p178q,m=rmass(
* id1),nsum=1
      u1_5678(i5,i6,i7,i8)%a(1,1)=u1_5678(i5,i6,i7,i8)%a(1,1)+l1
     & _78(i7,i8)%a(1,1)*u178_56(i5,i6)%a(1,1)+l1_78(i7,i8)%c(1,
     & 2)*p178q*u178_56(i5,i6)%b(2,1)
      u1_5678(i5,i6,i7,i8)%b(1,1)=u1_5678(i5,i6,i7,i8)%b(1,1)+rm
     & ass(id1)*(l1_78(i7,i8)%d(1,1)*u178_56(i5,i6)%a(1,1)+l1_78
     & (i7,i8)%b(1,2)*u178_56(i5,i6)%b(2,1))
      u1_5678(i5,i6,i7,i8)%c(1,1)=u1_5678(i5,i6,i7,i8)%c(1,1)+rm
     & ass(id1)*(l1_78(i7,i8)%a(1,1)*u178_56(i5,i6)%d(1,1)+l1_78
     & (i7,i8)%c(1,2)*u178_56(i5,i6)%c(2,1))
      u1_5678(i5,i6,i7,i8)%d(1,1)=u1_5678(i5,i6,i7,i8)%d(1,1)+l1
     & _78(i7,i8)%d(1,1)*p178q*u178_56(i5,i6)%d(1,1)+l1_78(i7,i8
     & )%b(1,2)*u178_56(i5,i6)%c(2,1)
      u1_5678(i5,i6,i7,i8)%a(1,2)=u1_5678(i5,i6,i7,i8)%a(1,2)+rm
     & ass(id1)*(l1_78(i7,i8)%a(1,1)*u178_56(i5,i6)%b(1,2)+l1_78
     & (i7,i8)%c(1,2)*u178_56(i5,i6)%a(2,2))
      u1_5678(i5,i6,i7,i8)%b(1,2)=u1_5678(i5,i6,i7,i8)%b(1,2)+l1
     & _78(i7,i8)%d(1,1)*p178q*u178_56(i5,i6)%b(1,2)+l1_78(i7,i8
     & )%b(1,2)*u178_56(i5,i6)%a(2,2)
      u1_5678(i5,i6,i7,i8)%c(1,2)=u1_5678(i5,i6,i7,i8)%c(1,2)+l1
     & _78(i7,i8)%a(1,1)*u178_56(i5,i6)%c(1,2)+l1_78(i7,i8)%c(1,
     & 2)*p178q*u178_56(i5,i6)%d(2,2)
      u1_5678(i5,i6,i7,i8)%d(1,2)=u1_5678(i5,i6,i7,i8)%d(1,2)+rm
     & ass(id1)*(l1_78(i7,i8)%d(1,1)*u178_56(i5,i6)%c(1,2)+l1_78
     & (i7,i8)%b(1,2)*u178_56(i5,i6)%d(2,2))
      u1_5678(i5,i6,i7,i8)%a(2,1)=u1_5678(i5,i6,i7,i8)%a(2,1)+rm
     & ass(id1)*(l1_78(i7,i8)%c(2,1)*u178_56(i5,i6)%a(1,1)+l1_78
     & (i7,i8)%a(2,2)*u178_56(i5,i6)%b(2,1))
      u1_5678(i5,i6,i7,i8)%b(2,1)=u1_5678(i5,i6,i7,i8)%b(2,1)+l1
     & _78(i7,i8)%b(2,1)*u178_56(i5,i6)%a(1,1)+l1_78(i7,i8)%d(2,
     & 2)*p178q*u178_56(i5,i6)%b(2,1)
      u1_5678(i5,i6,i7,i8)%c(2,1)=u1_5678(i5,i6,i7,i8)%c(2,1)+l1
     & _78(i7,i8)%c(2,1)*p178q*u178_56(i5,i6)%d(1,1)+l1_78(i7,i8
     & )%a(2,2)*u178_56(i5,i6)%c(2,1)
      u1_5678(i5,i6,i7,i8)%d(2,1)=u1_5678(i5,i6,i7,i8)%d(2,1)+rm
     & ass(id1)*(l1_78(i7,i8)%b(2,1)*u178_56(i5,i6)%d(1,1)+l1_78
     & (i7,i8)%d(2,2)*u178_56(i5,i6)%c(2,1))
      u1_5678(i5,i6,i7,i8)%a(2,2)=u1_5678(i5,i6,i7,i8)%a(2,2)+l1
     & _78(i7,i8)%c(2,1)*p178q*u178_56(i5,i6)%b(1,2)+l1_78(i7,i8
     & )%a(2,2)*u178_56(i5,i6)%a(2,2)
      u1_5678(i5,i6,i7,i8)%b(2,2)=u1_5678(i5,i6,i7,i8)%b(2,2)+rm
     & ass(id1)*(l1_78(i7,i8)%b(2,1)*u178_56(i5,i6)%b(1,2)+l1_78
     & (i7,i8)%d(2,2)*u178_56(i5,i6)%a(2,2))
      u1_5678(i5,i6,i7,i8)%c(2,2)=u1_5678(i5,i6,i7,i8)%c(2,2)+rm
     & ass(id1)*(l1_78(i7,i8)%c(2,1)*u178_56(i5,i6)%c(1,2)+l1_78
     & (i7,i8)%a(2,2)*u178_56(i5,i6)%d(2,2))
      u1_5678(i5,i6,i7,i8)%d(2,2)=u1_5678(i5,i6,i7,i8)%d(2,2)+l1
     & _78(i7,i8)%b(2,1)*u178_56(i5,i6)%c(1,2)+l1_78(i7,i8)%d(2,
     & 2)*p178q*u178_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id1.eq.5.and.id7.eq.5.and.id5.eq.5)then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=u1_5678(i5,i6,i7,i8)%a,bb=u1_5678(i5,i6,i7,i8)%b,cc=u1_5678
* (i5,i6,i7,i8)%c,dd=u1_5678(i5,i6,i7,i8)%d,a1=l1_78(i7,i8)%a,b1=l1_78(i
* 7,i8)%b,c1=l1_78(i7,i8)%c,d1=l1_78(i7,i8)%d,a2=u178_56(i5,i6)%a,b2=u17
* 8_56(i5,i6)%b,c2=u178_56(i5,i6)%c,d2=u178_56(i5,i6)%d,prq=p178q,m=rmas
* s(id1),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u178_56(i5,i6)%a(1,jut)+rmass(id1)*u178_56(i5,i6)%b(1,
     & jut)
      cx2=u178_56(i5,i6)%a(2,jut)+rmass(id1)*u178_56(i5,i6)%b(2,
     & jut)
      cy1=p178q*u178_56(i5,i6)%b(1,jut)+rmass(id1)*u178_56(i5,i6
     & )%a(1,jut)
      cy2=p178q*u178_56(i5,i6)%b(2,jut)+rmass(id1)*u178_56(i5,i6
     & )%a(2,jut)
      u1_5678(i5,i6,i7,i8)%a(iut,jut)=u1_5678(i5,i6,i7,i8)%a(iut
     & ,jut)+l1_78(i7,i8)%a(iut,1)*cx1+l1_78(i7,i8)%c(iut,1)*cy1
     & +l1_78(i7,i8)%a(iut,2)*cx2+l1_78(i7,i8)%c(iut,2)*cy2
      u1_5678(i5,i6,i7,i8)%b(iut,jut)=u1_5678(i5,i6,i7,i8)%b(iut
     & ,jut)+l1_78(i7,i8)%b(iut,1)*cx1+l1_78(i7,i8)%d(iut,1)*cy1
     & +l1_78(i7,i8)%b(iut,2)*cx2+l1_78(i7,i8)%d(iut,2)*cy2
      cw1=u178_56(i5,i6)%c(1,jut)+rmass(id1)*u178_56(i5,i6)%d(1,
     & jut)
      cw2=u178_56(i5,i6)%c(2,jut)+rmass(id1)*u178_56(i5,i6)%d(2,
     & jut)
      cz1=p178q*u178_56(i5,i6)%d(1,jut)+rmass(id1)*u178_56(i5,i6
     & )%c(1,jut)
      cz2=p178q*u178_56(i5,i6)%d(2,jut)+rmass(id1)*u178_56(i5,i6
     & )%c(2,jut)
      u1_5678(i5,i6,i7,i8)%c(iut,jut)=u1_5678(i5,i6,i7,i8)%c(iut
     & ,jut)+l1_78(i7,i8)%a(iut,1)*cw1+l1_78(i7,i8)%c(iut,1)*cz1
     & +l1_78(i7,i8)%a(iut,2)*cw2+l1_78(i7,i8)%c(iut,2)*cz2
      u1_5678(i5,i6,i7,i8)%d(iut,jut)=u1_5678(i5,i6,i7,i8)%d(iut
     & ,jut)+l1_78(i7,i8)%b(iut,1)*cw1+l1_78(i7,i8)%d(iut,1)*cz1
     & +l1_78(i7,i8)%b(iut,2)*cw2+l1_78(i7,i8)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id1.eq.5.and.id7.eq.5.and.id5.ne.5)then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=u1_5678(i5,i6,i7,i8)%a,bb=u1_5678(i5,i6,i7,i8)%b,cc=u1_5678(
* i5,i6,i7,i8)%c,dd=u1_5678(i5,i6,i7,i8)%d,a1=l1_78(i7,i8)%a,b1=l1_78(i7
* ,i8)%b,c1=l1_78(i7,i8)%c,d1=l1_78(i7,i8)%d,a2=u178_56(i5,i6)%a,b2=u178
* _56(i5,i6)%b,c2=u178_56(i5,i6)%c,d2=u178_56(i5,i6)%d,prq=p178q,m=rmass
* (id1),nsum=1
      do iut=1,2
      cx1=l1_78(i7,i8)%a(iut,1)+l1_78(i7,i8)%c(iut,1)*rmass(id1)
      cx2=l1_78(i7,i8)%c(iut,2)*p178q+l1_78(i7,i8)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_78(i7,i8)%b(iut,1)+l1_78(i7,i8)%d(iut,1)*rmass(id1)
      cy2=l1_78(i7,i8)%d(iut,2)*p178q+l1_78(i7,i8)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_78(i7,i8)%c(iut,1)*p178q+l1_78(i7,i8)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_78(i7,i8)%a(iut,2)+l1_78(i7,i8)%c(iut,2)*rmass(id1)
      cz1=l1_78(i7,i8)%d(iut,1)*p178q+l1_78(i7,i8)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_78(i7,i8)%b(iut,2)+l1_78(i7,i8)%d(iut,2)*rmass(id1)
      u1_5678(i5,i6,i7,i8)%a(iut,1)=u1_5678(i5,i6,i7,i8)%a(iut,1
     & )+cx1*u178_56(i5,i6)%a(1,1)+cx2*u178_56(i5,i6)%b(2,1)
      u1_5678(i5,i6,i7,i8)%b(iut,1)=u1_5678(i5,i6,i7,i8)%b(iut,1
     & )+cy1*u178_56(i5,i6)%a(1,1)+cy2*u178_56(i5,i6)%b(2,1)
      u1_5678(i5,i6,i7,i8)%c(iut,1)=u1_5678(i5,i6,i7,i8)%c(iut,1
     & )+cw1*u178_56(i5,i6)%d(1,1)+cw2*u178_56(i5,i6)%c(2,1)
      u1_5678(i5,i6,i7,i8)%d(iut,1)=u1_5678(i5,i6,i7,i8)%d(iut,1
     & )+cz1*u178_56(i5,i6)%d(1,1)+cz2*u178_56(i5,i6)%c(2,1)
      u1_5678(i5,i6,i7,i8)%a(iut,2)=u1_5678(i5,i6,i7,i8)%a(iut,2
     & )+cw1*u178_56(i5,i6)%b(1,2)+cw2*u178_56(i5,i6)%a(2,2)
      u1_5678(i5,i6,i7,i8)%b(iut,2)=u1_5678(i5,i6,i7,i8)%b(iut,2
     & )+cz1*u178_56(i5,i6)%b(1,2)+cz2*u178_56(i5,i6)%a(2,2)
      u1_5678(i5,i6,i7,i8)%c(iut,2)=u1_5678(i5,i6,i7,i8)%c(iut,2
     & )+cx1*u178_56(i5,i6)%c(1,2)+cx2*u178_56(i5,i6)%d(2,2)
      u1_5678(i5,i6,i7,i8)%d(iut,2)=u1_5678(i5,i6,i7,i8)%d(iut,2
     & )+cy1*u178_56(i5,i6)%c(1,2)+cy2*u178_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id1.eq.5.and.id7.ne.5.and.id5.eq.5)then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=u1_5678(i5,i6,i7,i8)%a,bb=u1_5678(i5,i6,i7,i8)%b,cc=u1_5678(
* i5,i6,i7,i8)%c,dd=u1_5678(i5,i6,i7,i8)%d,a1=l1_78(i7,i8)%a,b1=l1_78(i7
* ,i8)%b,c1=l1_78(i7,i8)%c,d1=l1_78(i7,i8)%d,a2=u178_56(i5,i6)%a,b2=u178
* _56(i5,i6)%b,c2=u178_56(i5,i6)%c,d2=u178_56(i5,i6)%d,prq=p178q,m=rmass
* (id1),nsum=1
      do jut=1,2
      cx1=u178_56(i5,i6)%a(1,jut)+rmass(id1)*u178_56(i5,i6)%b(1,
     & jut)
      cx2=u178_56(i5,i6)%a(2,jut)+rmass(id1)*u178_56(i5,i6)%b(2,
     & jut)
      cy1=p178q*u178_56(i5,i6)%b(1,jut)+rmass(id1)*u178_56(i5,i6
     & )%a(1,jut)
      cy2=p178q*u178_56(i5,i6)%b(2,jut)+rmass(id1)*u178_56(i5,i6
     & )%a(2,jut)
      cw1=u178_56(i5,i6)%c(1,jut)+rmass(id1)*u178_56(i5,i6)%d(1,
     & jut)
      cw2=u178_56(i5,i6)%c(2,jut)+rmass(id1)*u178_56(i5,i6)%d(2,
     & jut)
      cz1=p178q*u178_56(i5,i6)%d(1,jut)+rmass(id1)*u178_56(i5,i6
     & )%c(1,jut)
      cz2=p178q*u178_56(i5,i6)%d(2,jut)+rmass(id1)*u178_56(i5,i6
     & )%c(2,jut)
      u1_5678(i5,i6,i7,i8)%a(1,jut)=u1_5678(i5,i6,i7,i8)%a(1,jut
     & )+l1_78(i7,i8)%a(1,1)*cx1+l1_78(i7,i8)%c(1,2)*cy2
      u1_5678(i5,i6,i7,i8)%b(1,jut)=u1_5678(i5,i6,i7,i8)%b(1,jut
     & )+l1_78(i7,i8)%d(1,1)*cy1+l1_78(i7,i8)%b(1,2)*cx2
      u1_5678(i5,i6,i7,i8)%c(1,jut)=u1_5678(i5,i6,i7,i8)%c(1,jut
     & )+l1_78(i7,i8)%a(1,1)*cw1+l1_78(i7,i8)%c(1,2)*cz2
      u1_5678(i5,i6,i7,i8)%d(1,jut)=u1_5678(i5,i6,i7,i8)%d(1,jut
     & )+l1_78(i7,i8)%d(1,1)*cz1+l1_78(i7,i8)%b(1,2)*cw2
      u1_5678(i5,i6,i7,i8)%a(2,jut)=u1_5678(i5,i6,i7,i8)%a(2,jut
     & )+l1_78(i7,i8)%c(2,1)*cy1+l1_78(i7,i8)%a(2,2)*cx2
      u1_5678(i5,i6,i7,i8)%b(2,jut)=u1_5678(i5,i6,i7,i8)%b(2,jut
     & )+l1_78(i7,i8)%b(2,1)*cx1+l1_78(i7,i8)%d(2,2)*cy2
      u1_5678(i5,i6,i7,i8)%c(2,jut)=u1_5678(i5,i6,i7,i8)%c(2,jut
     & )+l1_78(i7,i8)%c(2,1)*cz1+l1_78(i7,i8)%a(2,2)*cw2
      u1_5678(i5,i6,i7,i8)%d(2,jut)=u1_5678(i5,i6,i7,i8)%d(2,jut
     & )+l1_78(i7,i8)%b(2,1)*cw1+l1_78(i7,i8)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p312q,p=p312,q=p312,bef=,aft=
      p312q=(p312(0)*p312(0)-p312(1)*p312(1)-p312(2)*p312(2)-p31
     & 2(3)*p312(3))
  
      if(id3.ne.5.or.(id1.ne.5.and.id5.ne.5))then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=u3_1256(i1,i2,i5,i6)%a,bb=u3_1256(i1,i2,i5,i6)%b,cc=u3_1256(i
* 1,i2,i5,i6)%c,dd=u3_1256(i1,i2,i5,i6)%d,a1=l3_12(i1,i2)%a,b1=l3_12(i1,
* i2)%b,c1=l3_12(i1,i2)%c,d1=l3_12(i1,i2)%d,a2=u312_56(i5,i6)%a,b2=u312_
* 56(i5,i6)%b,c2=u312_56(i5,i6)%c,d2=u312_56(i5,i6)%d,prq=p312q,m=rmass(
* id3),nsum=1
      u3_1256(i1,i2,i5,i6)%a(1,1)=u3_1256(i1,i2,i5,i6)%a(1,1)+l3
     & _12(i1,i2)%a(1,1)*u312_56(i5,i6)%a(1,1)+l3_12(i1,i2)%c(1,
     & 2)*p312q*u312_56(i5,i6)%b(2,1)
      u3_1256(i1,i2,i5,i6)%b(1,1)=u3_1256(i1,i2,i5,i6)%b(1,1)+rm
     & ass(id3)*(l3_12(i1,i2)%d(1,1)*u312_56(i5,i6)%a(1,1)+l3_12
     & (i1,i2)%b(1,2)*u312_56(i5,i6)%b(2,1))
      u3_1256(i1,i2,i5,i6)%c(1,1)=u3_1256(i1,i2,i5,i6)%c(1,1)+rm
     & ass(id3)*(l3_12(i1,i2)%a(1,1)*u312_56(i5,i6)%d(1,1)+l3_12
     & (i1,i2)%c(1,2)*u312_56(i5,i6)%c(2,1))
      u3_1256(i1,i2,i5,i6)%d(1,1)=u3_1256(i1,i2,i5,i6)%d(1,1)+l3
     & _12(i1,i2)%d(1,1)*p312q*u312_56(i5,i6)%d(1,1)+l3_12(i1,i2
     & )%b(1,2)*u312_56(i5,i6)%c(2,1)
      u3_1256(i1,i2,i5,i6)%a(1,2)=u3_1256(i1,i2,i5,i6)%a(1,2)+rm
     & ass(id3)*(l3_12(i1,i2)%a(1,1)*u312_56(i5,i6)%b(1,2)+l3_12
     & (i1,i2)%c(1,2)*u312_56(i5,i6)%a(2,2))
      u3_1256(i1,i2,i5,i6)%b(1,2)=u3_1256(i1,i2,i5,i6)%b(1,2)+l3
     & _12(i1,i2)%d(1,1)*p312q*u312_56(i5,i6)%b(1,2)+l3_12(i1,i2
     & )%b(1,2)*u312_56(i5,i6)%a(2,2)
      u3_1256(i1,i2,i5,i6)%c(1,2)=u3_1256(i1,i2,i5,i6)%c(1,2)+l3
     & _12(i1,i2)%a(1,1)*u312_56(i5,i6)%c(1,2)+l3_12(i1,i2)%c(1,
     & 2)*p312q*u312_56(i5,i6)%d(2,2)
      u3_1256(i1,i2,i5,i6)%d(1,2)=u3_1256(i1,i2,i5,i6)%d(1,2)+rm
     & ass(id3)*(l3_12(i1,i2)%d(1,1)*u312_56(i5,i6)%c(1,2)+l3_12
     & (i1,i2)%b(1,2)*u312_56(i5,i6)%d(2,2))
      u3_1256(i1,i2,i5,i6)%a(2,1)=u3_1256(i1,i2,i5,i6)%a(2,1)+rm
     & ass(id3)*(l3_12(i1,i2)%c(2,1)*u312_56(i5,i6)%a(1,1)+l3_12
     & (i1,i2)%a(2,2)*u312_56(i5,i6)%b(2,1))
      u3_1256(i1,i2,i5,i6)%b(2,1)=u3_1256(i1,i2,i5,i6)%b(2,1)+l3
     & _12(i1,i2)%b(2,1)*u312_56(i5,i6)%a(1,1)+l3_12(i1,i2)%d(2,
     & 2)*p312q*u312_56(i5,i6)%b(2,1)
      u3_1256(i1,i2,i5,i6)%c(2,1)=u3_1256(i1,i2,i5,i6)%c(2,1)+l3
     & _12(i1,i2)%c(2,1)*p312q*u312_56(i5,i6)%d(1,1)+l3_12(i1,i2
     & )%a(2,2)*u312_56(i5,i6)%c(2,1)
      u3_1256(i1,i2,i5,i6)%d(2,1)=u3_1256(i1,i2,i5,i6)%d(2,1)+rm
     & ass(id3)*(l3_12(i1,i2)%b(2,1)*u312_56(i5,i6)%d(1,1)+l3_12
     & (i1,i2)%d(2,2)*u312_56(i5,i6)%c(2,1))
      u3_1256(i1,i2,i5,i6)%a(2,2)=u3_1256(i1,i2,i5,i6)%a(2,2)+l3
     & _12(i1,i2)%c(2,1)*p312q*u312_56(i5,i6)%b(1,2)+l3_12(i1,i2
     & )%a(2,2)*u312_56(i5,i6)%a(2,2)
      u3_1256(i1,i2,i5,i6)%b(2,2)=u3_1256(i1,i2,i5,i6)%b(2,2)+rm
     & ass(id3)*(l3_12(i1,i2)%b(2,1)*u312_56(i5,i6)%b(1,2)+l3_12
     & (i1,i2)%d(2,2)*u312_56(i5,i6)%a(2,2))
      u3_1256(i1,i2,i5,i6)%c(2,2)=u3_1256(i1,i2,i5,i6)%c(2,2)+rm
     & ass(id3)*(l3_12(i1,i2)%c(2,1)*u312_56(i5,i6)%c(1,2)+l3_12
     & (i1,i2)%a(2,2)*u312_56(i5,i6)%d(2,2))
      u3_1256(i1,i2,i5,i6)%d(2,2)=u3_1256(i1,i2,i5,i6)%d(2,2)+l3
     & _12(i1,i2)%b(2,1)*u312_56(i5,i6)%c(1,2)+l3_12(i1,i2)%d(2,
     & 2)*p312q*u312_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id3.eq.5.and.id1.eq.5.and.id5.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=u3_1256(i1,i2,i5,i6)%a,bb=u3_1256(i1,i2,i5,i6)%b,cc=u3_1256
* (i1,i2,i5,i6)%c,dd=u3_1256(i1,i2,i5,i6)%d,a1=l3_12(i1,i2)%a,b1=l3_12(i
* 1,i2)%b,c1=l3_12(i1,i2)%c,d1=l3_12(i1,i2)%d,a2=u312_56(i5,i6)%a,b2=u31
* 2_56(i5,i6)%b,c2=u312_56(i5,i6)%c,d2=u312_56(i5,i6)%d,prq=p312q,m=rmas
* s(id3),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u312_56(i5,i6)%a(1,jut)+rmass(id3)*u312_56(i5,i6)%b(1,
     & jut)
      cx2=u312_56(i5,i6)%a(2,jut)+rmass(id3)*u312_56(i5,i6)%b(2,
     & jut)
      cy1=p312q*u312_56(i5,i6)%b(1,jut)+rmass(id3)*u312_56(i5,i6
     & )%a(1,jut)
      cy2=p312q*u312_56(i5,i6)%b(2,jut)+rmass(id3)*u312_56(i5,i6
     & )%a(2,jut)
      u3_1256(i1,i2,i5,i6)%a(iut,jut)=u3_1256(i1,i2,i5,i6)%a(iut
     & ,jut)+l3_12(i1,i2)%a(iut,1)*cx1+l3_12(i1,i2)%c(iut,1)*cy1
     & +l3_12(i1,i2)%a(iut,2)*cx2+l3_12(i1,i2)%c(iut,2)*cy2
      u3_1256(i1,i2,i5,i6)%b(iut,jut)=u3_1256(i1,i2,i5,i6)%b(iut
     & ,jut)+l3_12(i1,i2)%b(iut,1)*cx1+l3_12(i1,i2)%d(iut,1)*cy1
     & +l3_12(i1,i2)%b(iut,2)*cx2+l3_12(i1,i2)%d(iut,2)*cy2
      cw1=u312_56(i5,i6)%c(1,jut)+rmass(id3)*u312_56(i5,i6)%d(1,
     & jut)
      cw2=u312_56(i5,i6)%c(2,jut)+rmass(id3)*u312_56(i5,i6)%d(2,
     & jut)
      cz1=p312q*u312_56(i5,i6)%d(1,jut)+rmass(id3)*u312_56(i5,i6
     & )%c(1,jut)
      cz2=p312q*u312_56(i5,i6)%d(2,jut)+rmass(id3)*u312_56(i5,i6
     & )%c(2,jut)
      u3_1256(i1,i2,i5,i6)%c(iut,jut)=u3_1256(i1,i2,i5,i6)%c(iut
     & ,jut)+l3_12(i1,i2)%a(iut,1)*cw1+l3_12(i1,i2)%c(iut,1)*cz1
     & +l3_12(i1,i2)%a(iut,2)*cw2+l3_12(i1,i2)%c(iut,2)*cz2
      u3_1256(i1,i2,i5,i6)%d(iut,jut)=u3_1256(i1,i2,i5,i6)%d(iut
     & ,jut)+l3_12(i1,i2)%b(iut,1)*cw1+l3_12(i1,i2)%d(iut,1)*cz1
     & +l3_12(i1,i2)%b(iut,2)*cw2+l3_12(i1,i2)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id3.eq.5.and.id1.eq.5.and.id5.ne.5)then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=u3_1256(i1,i2,i5,i6)%a,bb=u3_1256(i1,i2,i5,i6)%b,cc=u3_1256(
* i1,i2,i5,i6)%c,dd=u3_1256(i1,i2,i5,i6)%d,a1=l3_12(i1,i2)%a,b1=l3_12(i1
* ,i2)%b,c1=l3_12(i1,i2)%c,d1=l3_12(i1,i2)%d,a2=u312_56(i5,i6)%a,b2=u312
* _56(i5,i6)%b,c2=u312_56(i5,i6)%c,d2=u312_56(i5,i6)%d,prq=p312q,m=rmass
* (id3),nsum=1
      do iut=1,2
      cx1=l3_12(i1,i2)%a(iut,1)+l3_12(i1,i2)%c(iut,1)*rmass(id3)
      cx2=l3_12(i1,i2)%c(iut,2)*p312q+l3_12(i1,i2)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_12(i1,i2)%b(iut,1)+l3_12(i1,i2)%d(iut,1)*rmass(id3)
      cy2=l3_12(i1,i2)%d(iut,2)*p312q+l3_12(i1,i2)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_12(i1,i2)%c(iut,1)*p312q+l3_12(i1,i2)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_12(i1,i2)%a(iut,2)+l3_12(i1,i2)%c(iut,2)*rmass(id3)
      cz1=l3_12(i1,i2)%d(iut,1)*p312q+l3_12(i1,i2)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_12(i1,i2)%b(iut,2)+l3_12(i1,i2)%d(iut,2)*rmass(id3)
      u3_1256(i1,i2,i5,i6)%a(iut,1)=u3_1256(i1,i2,i5,i6)%a(iut,1
     & )+cx1*u312_56(i5,i6)%a(1,1)+cx2*u312_56(i5,i6)%b(2,1)
      u3_1256(i1,i2,i5,i6)%b(iut,1)=u3_1256(i1,i2,i5,i6)%b(iut,1
     & )+cy1*u312_56(i5,i6)%a(1,1)+cy2*u312_56(i5,i6)%b(2,1)
      u3_1256(i1,i2,i5,i6)%c(iut,1)=u3_1256(i1,i2,i5,i6)%c(iut,1
     & )+cw1*u312_56(i5,i6)%d(1,1)+cw2*u312_56(i5,i6)%c(2,1)
      u3_1256(i1,i2,i5,i6)%d(iut,1)=u3_1256(i1,i2,i5,i6)%d(iut,1
     & )+cz1*u312_56(i5,i6)%d(1,1)+cz2*u312_56(i5,i6)%c(2,1)
      u3_1256(i1,i2,i5,i6)%a(iut,2)=u3_1256(i1,i2,i5,i6)%a(iut,2
     & )+cw1*u312_56(i5,i6)%b(1,2)+cw2*u312_56(i5,i6)%a(2,2)
      u3_1256(i1,i2,i5,i6)%b(iut,2)=u3_1256(i1,i2,i5,i6)%b(iut,2
     & )+cz1*u312_56(i5,i6)%b(1,2)+cz2*u312_56(i5,i6)%a(2,2)
      u3_1256(i1,i2,i5,i6)%c(iut,2)=u3_1256(i1,i2,i5,i6)%c(iut,2
     & )+cx1*u312_56(i5,i6)%c(1,2)+cx2*u312_56(i5,i6)%d(2,2)
      u3_1256(i1,i2,i5,i6)%d(iut,2)=u3_1256(i1,i2,i5,i6)%d(iut,2
     & )+cy1*u312_56(i5,i6)%c(1,2)+cy2*u312_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id3.eq.5.and.id1.ne.5.and.id5.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TTs -- aa=u3_1256(i1,i2,i5,i6)%a,bb=u3_1256(i1,i2,i5,i6)%b,cc=u3_1256(
* i1,i2,i5,i6)%c,dd=u3_1256(i1,i2,i5,i6)%d,a1=l3_12(i1,i2)%a,b1=l3_12(i1
* ,i2)%b,c1=l3_12(i1,i2)%c,d1=l3_12(i1,i2)%d,a2=u312_56(i5,i6)%a,b2=u312
* _56(i5,i6)%b,c2=u312_56(i5,i6)%c,d2=u312_56(i5,i6)%d,prq=p312q,m=rmass
* (id3),nsum=1
      do jut=1,2
      cx1=u312_56(i5,i6)%a(1,jut)+rmass(id3)*u312_56(i5,i6)%b(1,
     & jut)
      cx2=u312_56(i5,i6)%a(2,jut)+rmass(id3)*u312_56(i5,i6)%b(2,
     & jut)
      cy1=p312q*u312_56(i5,i6)%b(1,jut)+rmass(id3)*u312_56(i5,i6
     & )%a(1,jut)
      cy2=p312q*u312_56(i5,i6)%b(2,jut)+rmass(id3)*u312_56(i5,i6
     & )%a(2,jut)
      cw1=u312_56(i5,i6)%c(1,jut)+rmass(id3)*u312_56(i5,i6)%d(1,
     & jut)
      cw2=u312_56(i5,i6)%c(2,jut)+rmass(id3)*u312_56(i5,i6)%d(2,
     & jut)
      cz1=p312q*u312_56(i5,i6)%d(1,jut)+rmass(id3)*u312_56(i5,i6
     & )%c(1,jut)
      cz2=p312q*u312_56(i5,i6)%d(2,jut)+rmass(id3)*u312_56(i5,i6
     & )%c(2,jut)
      u3_1256(i1,i2,i5,i6)%a(1,jut)=u3_1256(i1,i2,i5,i6)%a(1,jut
     & )+l3_12(i1,i2)%a(1,1)*cx1+l3_12(i1,i2)%c(1,2)*cy2
      u3_1256(i1,i2,i5,i6)%b(1,jut)=u3_1256(i1,i2,i5,i6)%b(1,jut
     & )+l3_12(i1,i2)%d(1,1)*cy1+l3_12(i1,i2)%b(1,2)*cx2
      u3_1256(i1,i2,i5,i6)%c(1,jut)=u3_1256(i1,i2,i5,i6)%c(1,jut
     & )+l3_12(i1,i2)%a(1,1)*cw1+l3_12(i1,i2)%c(1,2)*cz2
      u3_1256(i1,i2,i5,i6)%d(1,jut)=u3_1256(i1,i2,i5,i6)%d(1,jut
     & )+l3_12(i1,i2)%d(1,1)*cz1+l3_12(i1,i2)%b(1,2)*cw2
      u3_1256(i1,i2,i5,i6)%a(2,jut)=u3_1256(i1,i2,i5,i6)%a(2,jut
     & )+l3_12(i1,i2)%c(2,1)*cy1+l3_12(i1,i2)%a(2,2)*cx2
      u3_1256(i1,i2,i5,i6)%b(2,jut)=u3_1256(i1,i2,i5,i6)%b(2,jut
     & )+l3_12(i1,i2)%b(2,1)*cx1+l3_12(i1,i2)%d(2,2)*cy2
      u3_1256(i1,i2,i5,i6)%c(2,jut)=u3_1256(i1,i2,i5,i6)%c(2,jut
     & )+l3_12(i1,i2)%c(2,1)*cz1+l3_12(i1,i2)%a(2,2)*cw2
      u3_1256(i1,i2,i5,i6)%d(2,jut)=u3_1256(i1,i2,i5,i6)%d(2,jut
     & )+l3_12(i1,i2)%b(2,1)*cw1+l3_12(i1,i2)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p356q,p=p356,q=p356,bef=,aft=
      p356q=(p356(0)*p356(0)-p356(1)*p356(1)-p356(2)*p356(2)-p35
     & 6(3)*p356(3))
  
      if(id3.ne.5.or.(id5.ne.5.and.id1.ne.5))then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=u3_1256(i1,i2,i5,i6)%a,bb=u3_1256(i1,i2,i5,i6)%b,cc=u3_1256(i
* 1,i2,i5,i6)%c,dd=u3_1256(i1,i2,i5,i6)%d,a1=l3_56(i5,i6)%a,b1=l3_56(i5,
* i6)%b,c1=l3_56(i5,i6)%c,d1=l3_56(i5,i6)%d,a2=u356_12(i1,i2)%a,b2=u356_
* 12(i1,i2)%b,c2=u356_12(i1,i2)%c,d2=u356_12(i1,i2)%d,prq=p356q,m=rmass(
* id3),nsum=1
      u3_1256(i1,i2,i5,i6)%a(1,1)=u3_1256(i1,i2,i5,i6)%a(1,1)+l3
     & _56(i5,i6)%a(1,1)*u356_12(i1,i2)%a(1,1)+l3_56(i5,i6)%c(1,
     & 2)*p356q*u356_12(i1,i2)%b(2,1)
      u3_1256(i1,i2,i5,i6)%b(1,1)=u3_1256(i1,i2,i5,i6)%b(1,1)+rm
     & ass(id3)*(l3_56(i5,i6)%d(1,1)*u356_12(i1,i2)%a(1,1)+l3_56
     & (i5,i6)%b(1,2)*u356_12(i1,i2)%b(2,1))
      u3_1256(i1,i2,i5,i6)%c(1,1)=u3_1256(i1,i2,i5,i6)%c(1,1)+rm
     & ass(id3)*(l3_56(i5,i6)%a(1,1)*u356_12(i1,i2)%d(1,1)+l3_56
     & (i5,i6)%c(1,2)*u356_12(i1,i2)%c(2,1))
      u3_1256(i1,i2,i5,i6)%d(1,1)=u3_1256(i1,i2,i5,i6)%d(1,1)+l3
     & _56(i5,i6)%d(1,1)*p356q*u356_12(i1,i2)%d(1,1)+l3_56(i5,i6
     & )%b(1,2)*u356_12(i1,i2)%c(2,1)
      u3_1256(i1,i2,i5,i6)%a(1,2)=u3_1256(i1,i2,i5,i6)%a(1,2)+rm
     & ass(id3)*(l3_56(i5,i6)%a(1,1)*u356_12(i1,i2)%b(1,2)+l3_56
     & (i5,i6)%c(1,2)*u356_12(i1,i2)%a(2,2))
      u3_1256(i1,i2,i5,i6)%b(1,2)=u3_1256(i1,i2,i5,i6)%b(1,2)+l3
     & _56(i5,i6)%d(1,1)*p356q*u356_12(i1,i2)%b(1,2)+l3_56(i5,i6
     & )%b(1,2)*u356_12(i1,i2)%a(2,2)
      u3_1256(i1,i2,i5,i6)%c(1,2)=u3_1256(i1,i2,i5,i6)%c(1,2)+l3
     & _56(i5,i6)%a(1,1)*u356_12(i1,i2)%c(1,2)+l3_56(i5,i6)%c(1,
     & 2)*p356q*u356_12(i1,i2)%d(2,2)
      u3_1256(i1,i2,i5,i6)%d(1,2)=u3_1256(i1,i2,i5,i6)%d(1,2)+rm
     & ass(id3)*(l3_56(i5,i6)%d(1,1)*u356_12(i1,i2)%c(1,2)+l3_56
     & (i5,i6)%b(1,2)*u356_12(i1,i2)%d(2,2))
      u3_1256(i1,i2,i5,i6)%a(2,1)=u3_1256(i1,i2,i5,i6)%a(2,1)+rm
     & ass(id3)*(l3_56(i5,i6)%c(2,1)*u356_12(i1,i2)%a(1,1)+l3_56
     & (i5,i6)%a(2,2)*u356_12(i1,i2)%b(2,1))
      u3_1256(i1,i2,i5,i6)%b(2,1)=u3_1256(i1,i2,i5,i6)%b(2,1)+l3
     & _56(i5,i6)%b(2,1)*u356_12(i1,i2)%a(1,1)+l3_56(i5,i6)%d(2,
     & 2)*p356q*u356_12(i1,i2)%b(2,1)
      u3_1256(i1,i2,i5,i6)%c(2,1)=u3_1256(i1,i2,i5,i6)%c(2,1)+l3
     & _56(i5,i6)%c(2,1)*p356q*u356_12(i1,i2)%d(1,1)+l3_56(i5,i6
     & )%a(2,2)*u356_12(i1,i2)%c(2,1)
      u3_1256(i1,i2,i5,i6)%d(2,1)=u3_1256(i1,i2,i5,i6)%d(2,1)+rm
     & ass(id3)*(l3_56(i5,i6)%b(2,1)*u356_12(i1,i2)%d(1,1)+l3_56
     & (i5,i6)%d(2,2)*u356_12(i1,i2)%c(2,1))
      u3_1256(i1,i2,i5,i6)%a(2,2)=u3_1256(i1,i2,i5,i6)%a(2,2)+l3
     & _56(i5,i6)%c(2,1)*p356q*u356_12(i1,i2)%b(1,2)+l3_56(i5,i6
     & )%a(2,2)*u356_12(i1,i2)%a(2,2)
      u3_1256(i1,i2,i5,i6)%b(2,2)=u3_1256(i1,i2,i5,i6)%b(2,2)+rm
     & ass(id3)*(l3_56(i5,i6)%b(2,1)*u356_12(i1,i2)%b(1,2)+l3_56
     & (i5,i6)%d(2,2)*u356_12(i1,i2)%a(2,2))
      u3_1256(i1,i2,i5,i6)%c(2,2)=u3_1256(i1,i2,i5,i6)%c(2,2)+rm
     & ass(id3)*(l3_56(i5,i6)%c(2,1)*u356_12(i1,i2)%c(1,2)+l3_56
     & (i5,i6)%a(2,2)*u356_12(i1,i2)%d(2,2))
      u3_1256(i1,i2,i5,i6)%d(2,2)=u3_1256(i1,i2,i5,i6)%d(2,2)+l3
     & _56(i5,i6)%b(2,1)*u356_12(i1,i2)%c(1,2)+l3_56(i5,i6)%d(2,
     & 2)*p356q*u356_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id3.eq.5.and.id5.eq.5.and.id1.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=u3_1256(i1,i2,i5,i6)%a,bb=u3_1256(i1,i2,i5,i6)%b,cc=u3_1256
* (i1,i2,i5,i6)%c,dd=u3_1256(i1,i2,i5,i6)%d,a1=l3_56(i5,i6)%a,b1=l3_56(i
* 5,i6)%b,c1=l3_56(i5,i6)%c,d1=l3_56(i5,i6)%d,a2=u356_12(i1,i2)%a,b2=u35
* 6_12(i1,i2)%b,c2=u356_12(i1,i2)%c,d2=u356_12(i1,i2)%d,prq=p356q,m=rmas
* s(id3),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u356_12(i1,i2)%a(1,jut)+rmass(id3)*u356_12(i1,i2)%b(1,
     & jut)
      cx2=u356_12(i1,i2)%a(2,jut)+rmass(id3)*u356_12(i1,i2)%b(2,
     & jut)
      cy1=p356q*u356_12(i1,i2)%b(1,jut)+rmass(id3)*u356_12(i1,i2
     & )%a(1,jut)
      cy2=p356q*u356_12(i1,i2)%b(2,jut)+rmass(id3)*u356_12(i1,i2
     & )%a(2,jut)
      u3_1256(i1,i2,i5,i6)%a(iut,jut)=u3_1256(i1,i2,i5,i6)%a(iut
     & ,jut)+l3_56(i5,i6)%a(iut,1)*cx1+l3_56(i5,i6)%c(iut,1)*cy1
     & +l3_56(i5,i6)%a(iut,2)*cx2+l3_56(i5,i6)%c(iut,2)*cy2
      u3_1256(i1,i2,i5,i6)%b(iut,jut)=u3_1256(i1,i2,i5,i6)%b(iut
     & ,jut)+l3_56(i5,i6)%b(iut,1)*cx1+l3_56(i5,i6)%d(iut,1)*cy1
     & +l3_56(i5,i6)%b(iut,2)*cx2+l3_56(i5,i6)%d(iut,2)*cy2
      cw1=u356_12(i1,i2)%c(1,jut)+rmass(id3)*u356_12(i1,i2)%d(1,
     & jut)
      cw2=u356_12(i1,i2)%c(2,jut)+rmass(id3)*u356_12(i1,i2)%d(2,
     & jut)
      cz1=p356q*u356_12(i1,i2)%d(1,jut)+rmass(id3)*u356_12(i1,i2
     & )%c(1,jut)
      cz2=p356q*u356_12(i1,i2)%d(2,jut)+rmass(id3)*u356_12(i1,i2
     & )%c(2,jut)
      u3_1256(i1,i2,i5,i6)%c(iut,jut)=u3_1256(i1,i2,i5,i6)%c(iut
     & ,jut)+l3_56(i5,i6)%a(iut,1)*cw1+l3_56(i5,i6)%c(iut,1)*cz1
     & +l3_56(i5,i6)%a(iut,2)*cw2+l3_56(i5,i6)%c(iut,2)*cz2
      u3_1256(i1,i2,i5,i6)%d(iut,jut)=u3_1256(i1,i2,i5,i6)%d(iut
     & ,jut)+l3_56(i5,i6)%b(iut,1)*cw1+l3_56(i5,i6)%d(iut,1)*cz1
     & +l3_56(i5,i6)%b(iut,2)*cw2+l3_56(i5,i6)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id3.eq.5.and.id5.eq.5.and.id1.ne.5)then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=u3_1256(i1,i2,i5,i6)%a,bb=u3_1256(i1,i2,i5,i6)%b,cc=u3_1256(
* i1,i2,i5,i6)%c,dd=u3_1256(i1,i2,i5,i6)%d,a1=l3_56(i5,i6)%a,b1=l3_56(i5
* ,i6)%b,c1=l3_56(i5,i6)%c,d1=l3_56(i5,i6)%d,a2=u356_12(i1,i2)%a,b2=u356
* _12(i1,i2)%b,c2=u356_12(i1,i2)%c,d2=u356_12(i1,i2)%d,prq=p356q,m=rmass
* (id3),nsum=1
      do iut=1,2
      cx1=l3_56(i5,i6)%a(iut,1)+l3_56(i5,i6)%c(iut,1)*rmass(id3)
      cx2=l3_56(i5,i6)%c(iut,2)*p356q+l3_56(i5,i6)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_56(i5,i6)%b(iut,1)+l3_56(i5,i6)%d(iut,1)*rmass(id3)
      cy2=l3_56(i5,i6)%d(iut,2)*p356q+l3_56(i5,i6)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_56(i5,i6)%c(iut,1)*p356q+l3_56(i5,i6)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_56(i5,i6)%a(iut,2)+l3_56(i5,i6)%c(iut,2)*rmass(id3)
      cz1=l3_56(i5,i6)%d(iut,1)*p356q+l3_56(i5,i6)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_56(i5,i6)%b(iut,2)+l3_56(i5,i6)%d(iut,2)*rmass(id3)
      u3_1256(i1,i2,i5,i6)%a(iut,1)=u3_1256(i1,i2,i5,i6)%a(iut,1
     & )+cx1*u356_12(i1,i2)%a(1,1)+cx2*u356_12(i1,i2)%b(2,1)
      u3_1256(i1,i2,i5,i6)%b(iut,1)=u3_1256(i1,i2,i5,i6)%b(iut,1
     & )+cy1*u356_12(i1,i2)%a(1,1)+cy2*u356_12(i1,i2)%b(2,1)
      u3_1256(i1,i2,i5,i6)%c(iut,1)=u3_1256(i1,i2,i5,i6)%c(iut,1
     & )+cw1*u356_12(i1,i2)%d(1,1)+cw2*u356_12(i1,i2)%c(2,1)
      u3_1256(i1,i2,i5,i6)%d(iut,1)=u3_1256(i1,i2,i5,i6)%d(iut,1
     & )+cz1*u356_12(i1,i2)%d(1,1)+cz2*u356_12(i1,i2)%c(2,1)
      u3_1256(i1,i2,i5,i6)%a(iut,2)=u3_1256(i1,i2,i5,i6)%a(iut,2
     & )+cw1*u356_12(i1,i2)%b(1,2)+cw2*u356_12(i1,i2)%a(2,2)
      u3_1256(i1,i2,i5,i6)%b(iut,2)=u3_1256(i1,i2,i5,i6)%b(iut,2
     & )+cz1*u356_12(i1,i2)%b(1,2)+cz2*u356_12(i1,i2)%a(2,2)
      u3_1256(i1,i2,i5,i6)%c(iut,2)=u3_1256(i1,i2,i5,i6)%c(iut,2
     & )+cx1*u356_12(i1,i2)%c(1,2)+cx2*u356_12(i1,i2)%d(2,2)
      u3_1256(i1,i2,i5,i6)%d(iut,2)=u3_1256(i1,i2,i5,i6)%d(iut,2
     & )+cy1*u356_12(i1,i2)%c(1,2)+cy2*u356_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id3.eq.5.and.id5.ne.5.and.id1.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TTs -- aa=u3_1256(i1,i2,i5,i6)%a,bb=u3_1256(i1,i2,i5,i6)%b,cc=u3_1256(
* i1,i2,i5,i6)%c,dd=u3_1256(i1,i2,i5,i6)%d,a1=l3_56(i5,i6)%a,b1=l3_56(i5
* ,i6)%b,c1=l3_56(i5,i6)%c,d1=l3_56(i5,i6)%d,a2=u356_12(i1,i2)%a,b2=u356
* _12(i1,i2)%b,c2=u356_12(i1,i2)%c,d2=u356_12(i1,i2)%d,prq=p356q,m=rmass
* (id3),nsum=1
      do jut=1,2
      cx1=u356_12(i1,i2)%a(1,jut)+rmass(id3)*u356_12(i1,i2)%b(1,
     & jut)
      cx2=u356_12(i1,i2)%a(2,jut)+rmass(id3)*u356_12(i1,i2)%b(2,
     & jut)
      cy1=p356q*u356_12(i1,i2)%b(1,jut)+rmass(id3)*u356_12(i1,i2
     & )%a(1,jut)
      cy2=p356q*u356_12(i1,i2)%b(2,jut)+rmass(id3)*u356_12(i1,i2
     & )%a(2,jut)
      cw1=u356_12(i1,i2)%c(1,jut)+rmass(id3)*u356_12(i1,i2)%d(1,
     & jut)
      cw2=u356_12(i1,i2)%c(2,jut)+rmass(id3)*u356_12(i1,i2)%d(2,
     & jut)
      cz1=p356q*u356_12(i1,i2)%d(1,jut)+rmass(id3)*u356_12(i1,i2
     & )%c(1,jut)
      cz2=p356q*u356_12(i1,i2)%d(2,jut)+rmass(id3)*u356_12(i1,i2
     & )%c(2,jut)
      u3_1256(i1,i2,i5,i6)%a(1,jut)=u3_1256(i1,i2,i5,i6)%a(1,jut
     & )+l3_56(i5,i6)%a(1,1)*cx1+l3_56(i5,i6)%c(1,2)*cy2
      u3_1256(i1,i2,i5,i6)%b(1,jut)=u3_1256(i1,i2,i5,i6)%b(1,jut
     & )+l3_56(i5,i6)%d(1,1)*cy1+l3_56(i5,i6)%b(1,2)*cx2
      u3_1256(i1,i2,i5,i6)%c(1,jut)=u3_1256(i1,i2,i5,i6)%c(1,jut
     & )+l3_56(i5,i6)%a(1,1)*cw1+l3_56(i5,i6)%c(1,2)*cz2
      u3_1256(i1,i2,i5,i6)%d(1,jut)=u3_1256(i1,i2,i5,i6)%d(1,jut
     & )+l3_56(i5,i6)%d(1,1)*cz1+l3_56(i5,i6)%b(1,2)*cw2
      u3_1256(i1,i2,i5,i6)%a(2,jut)=u3_1256(i1,i2,i5,i6)%a(2,jut
     & )+l3_56(i5,i6)%c(2,1)*cy1+l3_56(i5,i6)%a(2,2)*cx2
      u3_1256(i1,i2,i5,i6)%b(2,jut)=u3_1256(i1,i2,i5,i6)%b(2,jut
     & )+l3_56(i5,i6)%b(2,1)*cx1+l3_56(i5,i6)%d(2,2)*cy2
      u3_1256(i1,i2,i5,i6)%c(2,jut)=u3_1256(i1,i2,i5,i6)%c(2,jut
     & )+l3_56(i5,i6)%c(2,1)*cz1+l3_56(i5,i6)%a(2,2)*cw2
      u3_1256(i1,i2,i5,i6)%d(2,jut)=u3_1256(i1,i2,i5,i6)%d(2,jut
     & )+l3_56(i5,i6)%b(2,1)*cw1+l3_56(i5,i6)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p312q,p=p312,q=p312,bef=,aft=
      p312q=(p312(0)*p312(0)-p312(1)*p312(1)-p312(2)*p312(2)-p31
     & 2(3)*p312(3))
  
      if(id3.ne.5.or.(id1.ne.5.and.id7.ne.5))then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=u3_1278(i1,i2,i7,i8)%a,bb=u3_1278(i1,i2,i7,i8)%b,cc=u3_1278(i
* 1,i2,i7,i8)%c,dd=u3_1278(i1,i2,i7,i8)%d,a1=l3_12(i1,i2)%a,b1=l3_12(i1,
* i2)%b,c1=l3_12(i1,i2)%c,d1=l3_12(i1,i2)%d,a2=u312_78(i7,i8)%a,b2=u312_
* 78(i7,i8)%b,c2=u312_78(i7,i8)%c,d2=u312_78(i7,i8)%d,prq=p312q,m=rmass(
* id3),nsum=1
      u3_1278(i1,i2,i7,i8)%a(1,1)=u3_1278(i1,i2,i7,i8)%a(1,1)+l3
     & _12(i1,i2)%a(1,1)*u312_78(i7,i8)%a(1,1)+l3_12(i1,i2)%c(1,
     & 2)*p312q*u312_78(i7,i8)%b(2,1)
      u3_1278(i1,i2,i7,i8)%b(1,1)=u3_1278(i1,i2,i7,i8)%b(1,1)+rm
     & ass(id3)*(l3_12(i1,i2)%d(1,1)*u312_78(i7,i8)%a(1,1)+l3_12
     & (i1,i2)%b(1,2)*u312_78(i7,i8)%b(2,1))
      u3_1278(i1,i2,i7,i8)%c(1,1)=u3_1278(i1,i2,i7,i8)%c(1,1)+rm
     & ass(id3)*(l3_12(i1,i2)%a(1,1)*u312_78(i7,i8)%d(1,1)+l3_12
     & (i1,i2)%c(1,2)*u312_78(i7,i8)%c(2,1))
      u3_1278(i1,i2,i7,i8)%d(1,1)=u3_1278(i1,i2,i7,i8)%d(1,1)+l3
     & _12(i1,i2)%d(1,1)*p312q*u312_78(i7,i8)%d(1,1)+l3_12(i1,i2
     & )%b(1,2)*u312_78(i7,i8)%c(2,1)
      u3_1278(i1,i2,i7,i8)%a(1,2)=u3_1278(i1,i2,i7,i8)%a(1,2)+rm
     & ass(id3)*(l3_12(i1,i2)%a(1,1)*u312_78(i7,i8)%b(1,2)+l3_12
     & (i1,i2)%c(1,2)*u312_78(i7,i8)%a(2,2))
      u3_1278(i1,i2,i7,i8)%b(1,2)=u3_1278(i1,i2,i7,i8)%b(1,2)+l3
     & _12(i1,i2)%d(1,1)*p312q*u312_78(i7,i8)%b(1,2)+l3_12(i1,i2
     & )%b(1,2)*u312_78(i7,i8)%a(2,2)
      u3_1278(i1,i2,i7,i8)%c(1,2)=u3_1278(i1,i2,i7,i8)%c(1,2)+l3
     & _12(i1,i2)%a(1,1)*u312_78(i7,i8)%c(1,2)+l3_12(i1,i2)%c(1,
     & 2)*p312q*u312_78(i7,i8)%d(2,2)
      u3_1278(i1,i2,i7,i8)%d(1,2)=u3_1278(i1,i2,i7,i8)%d(1,2)+rm
     & ass(id3)*(l3_12(i1,i2)%d(1,1)*u312_78(i7,i8)%c(1,2)+l3_12
     & (i1,i2)%b(1,2)*u312_78(i7,i8)%d(2,2))
      u3_1278(i1,i2,i7,i8)%a(2,1)=u3_1278(i1,i2,i7,i8)%a(2,1)+rm
     & ass(id3)*(l3_12(i1,i2)%c(2,1)*u312_78(i7,i8)%a(1,1)+l3_12
     & (i1,i2)%a(2,2)*u312_78(i7,i8)%b(2,1))
      u3_1278(i1,i2,i7,i8)%b(2,1)=u3_1278(i1,i2,i7,i8)%b(2,1)+l3
     & _12(i1,i2)%b(2,1)*u312_78(i7,i8)%a(1,1)+l3_12(i1,i2)%d(2,
     & 2)*p312q*u312_78(i7,i8)%b(2,1)
      u3_1278(i1,i2,i7,i8)%c(2,1)=u3_1278(i1,i2,i7,i8)%c(2,1)+l3
     & _12(i1,i2)%c(2,1)*p312q*u312_78(i7,i8)%d(1,1)+l3_12(i1,i2
     & )%a(2,2)*u312_78(i7,i8)%c(2,1)
      u3_1278(i1,i2,i7,i8)%d(2,1)=u3_1278(i1,i2,i7,i8)%d(2,1)+rm
     & ass(id3)*(l3_12(i1,i2)%b(2,1)*u312_78(i7,i8)%d(1,1)+l3_12
     & (i1,i2)%d(2,2)*u312_78(i7,i8)%c(2,1))
      u3_1278(i1,i2,i7,i8)%a(2,2)=u3_1278(i1,i2,i7,i8)%a(2,2)+l3
     & _12(i1,i2)%c(2,1)*p312q*u312_78(i7,i8)%b(1,2)+l3_12(i1,i2
     & )%a(2,2)*u312_78(i7,i8)%a(2,2)
      u3_1278(i1,i2,i7,i8)%b(2,2)=u3_1278(i1,i2,i7,i8)%b(2,2)+rm
     & ass(id3)*(l3_12(i1,i2)%b(2,1)*u312_78(i7,i8)%b(1,2)+l3_12
     & (i1,i2)%d(2,2)*u312_78(i7,i8)%a(2,2))
      u3_1278(i1,i2,i7,i8)%c(2,2)=u3_1278(i1,i2,i7,i8)%c(2,2)+rm
     & ass(id3)*(l3_12(i1,i2)%c(2,1)*u312_78(i7,i8)%c(1,2)+l3_12
     & (i1,i2)%a(2,2)*u312_78(i7,i8)%d(2,2))
      u3_1278(i1,i2,i7,i8)%d(2,2)=u3_1278(i1,i2,i7,i8)%d(2,2)+l3
     & _12(i1,i2)%b(2,1)*u312_78(i7,i8)%c(1,2)+l3_12(i1,i2)%d(2,
     & 2)*p312q*u312_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id3.eq.5.and.id1.eq.5.and.id7.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=u3_1278(i1,i2,i7,i8)%a,bb=u3_1278(i1,i2,i7,i8)%b,cc=u3_1278
* (i1,i2,i7,i8)%c,dd=u3_1278(i1,i2,i7,i8)%d,a1=l3_12(i1,i2)%a,b1=l3_12(i
* 1,i2)%b,c1=l3_12(i1,i2)%c,d1=l3_12(i1,i2)%d,a2=u312_78(i7,i8)%a,b2=u31
* 2_78(i7,i8)%b,c2=u312_78(i7,i8)%c,d2=u312_78(i7,i8)%d,prq=p312q,m=rmas
* s(id3),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u312_78(i7,i8)%a(1,jut)+rmass(id3)*u312_78(i7,i8)%b(1,
     & jut)
      cx2=u312_78(i7,i8)%a(2,jut)+rmass(id3)*u312_78(i7,i8)%b(2,
     & jut)
      cy1=p312q*u312_78(i7,i8)%b(1,jut)+rmass(id3)*u312_78(i7,i8
     & )%a(1,jut)
      cy2=p312q*u312_78(i7,i8)%b(2,jut)+rmass(id3)*u312_78(i7,i8
     & )%a(2,jut)
      u3_1278(i1,i2,i7,i8)%a(iut,jut)=u3_1278(i1,i2,i7,i8)%a(iut
     & ,jut)+l3_12(i1,i2)%a(iut,1)*cx1+l3_12(i1,i2)%c(iut,1)*cy1
     & +l3_12(i1,i2)%a(iut,2)*cx2+l3_12(i1,i2)%c(iut,2)*cy2
      u3_1278(i1,i2,i7,i8)%b(iut,jut)=u3_1278(i1,i2,i7,i8)%b(iut
     & ,jut)+l3_12(i1,i2)%b(iut,1)*cx1+l3_12(i1,i2)%d(iut,1)*cy1
     & +l3_12(i1,i2)%b(iut,2)*cx2+l3_12(i1,i2)%d(iut,2)*cy2
      cw1=u312_78(i7,i8)%c(1,jut)+rmass(id3)*u312_78(i7,i8)%d(1,
     & jut)
      cw2=u312_78(i7,i8)%c(2,jut)+rmass(id3)*u312_78(i7,i8)%d(2,
     & jut)
      cz1=p312q*u312_78(i7,i8)%d(1,jut)+rmass(id3)*u312_78(i7,i8
     & )%c(1,jut)
      cz2=p312q*u312_78(i7,i8)%d(2,jut)+rmass(id3)*u312_78(i7,i8
     & )%c(2,jut)
      u3_1278(i1,i2,i7,i8)%c(iut,jut)=u3_1278(i1,i2,i7,i8)%c(iut
     & ,jut)+l3_12(i1,i2)%a(iut,1)*cw1+l3_12(i1,i2)%c(iut,1)*cz1
     & +l3_12(i1,i2)%a(iut,2)*cw2+l3_12(i1,i2)%c(iut,2)*cz2
      u3_1278(i1,i2,i7,i8)%d(iut,jut)=u3_1278(i1,i2,i7,i8)%d(iut
     & ,jut)+l3_12(i1,i2)%b(iut,1)*cw1+l3_12(i1,i2)%d(iut,1)*cz1
     & +l3_12(i1,i2)%b(iut,2)*cw2+l3_12(i1,i2)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id3.eq.5.and.id1.eq.5.and.id7.ne.5)then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=u3_1278(i1,i2,i7,i8)%a,bb=u3_1278(i1,i2,i7,i8)%b,cc=u3_1278(
* i1,i2,i7,i8)%c,dd=u3_1278(i1,i2,i7,i8)%d,a1=l3_12(i1,i2)%a,b1=l3_12(i1
* ,i2)%b,c1=l3_12(i1,i2)%c,d1=l3_12(i1,i2)%d,a2=u312_78(i7,i8)%a,b2=u312
* _78(i7,i8)%b,c2=u312_78(i7,i8)%c,d2=u312_78(i7,i8)%d,prq=p312q,m=rmass
* (id3),nsum=1
      do iut=1,2
      cx1=l3_12(i1,i2)%a(iut,1)+l3_12(i1,i2)%c(iut,1)*rmass(id3)
      cx2=l3_12(i1,i2)%c(iut,2)*p312q+l3_12(i1,i2)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_12(i1,i2)%b(iut,1)+l3_12(i1,i2)%d(iut,1)*rmass(id3)
      cy2=l3_12(i1,i2)%d(iut,2)*p312q+l3_12(i1,i2)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_12(i1,i2)%c(iut,1)*p312q+l3_12(i1,i2)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_12(i1,i2)%a(iut,2)+l3_12(i1,i2)%c(iut,2)*rmass(id3)
      cz1=l3_12(i1,i2)%d(iut,1)*p312q+l3_12(i1,i2)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_12(i1,i2)%b(iut,2)+l3_12(i1,i2)%d(iut,2)*rmass(id3)
      u3_1278(i1,i2,i7,i8)%a(iut,1)=u3_1278(i1,i2,i7,i8)%a(iut,1
     & )+cx1*u312_78(i7,i8)%a(1,1)+cx2*u312_78(i7,i8)%b(2,1)
      u3_1278(i1,i2,i7,i8)%b(iut,1)=u3_1278(i1,i2,i7,i8)%b(iut,1
     & )+cy1*u312_78(i7,i8)%a(1,1)+cy2*u312_78(i7,i8)%b(2,1)
      u3_1278(i1,i2,i7,i8)%c(iut,1)=u3_1278(i1,i2,i7,i8)%c(iut,1
     & )+cw1*u312_78(i7,i8)%d(1,1)+cw2*u312_78(i7,i8)%c(2,1)
      u3_1278(i1,i2,i7,i8)%d(iut,1)=u3_1278(i1,i2,i7,i8)%d(iut,1
     & )+cz1*u312_78(i7,i8)%d(1,1)+cz2*u312_78(i7,i8)%c(2,1)
      u3_1278(i1,i2,i7,i8)%a(iut,2)=u3_1278(i1,i2,i7,i8)%a(iut,2
     & )+cw1*u312_78(i7,i8)%b(1,2)+cw2*u312_78(i7,i8)%a(2,2)
      u3_1278(i1,i2,i7,i8)%b(iut,2)=u3_1278(i1,i2,i7,i8)%b(iut,2
     & )+cz1*u312_78(i7,i8)%b(1,2)+cz2*u312_78(i7,i8)%a(2,2)
      u3_1278(i1,i2,i7,i8)%c(iut,2)=u3_1278(i1,i2,i7,i8)%c(iut,2
     & )+cx1*u312_78(i7,i8)%c(1,2)+cx2*u312_78(i7,i8)%d(2,2)
      u3_1278(i1,i2,i7,i8)%d(iut,2)=u3_1278(i1,i2,i7,i8)%d(iut,2
     & )+cy1*u312_78(i7,i8)%c(1,2)+cy2*u312_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id3.eq.5.and.id1.ne.5.and.id7.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=u3_1278(i1,i2,i7,i8)%a,bb=u3_1278(i1,i2,i7,i8)%b,cc=u3_1278(
* i1,i2,i7,i8)%c,dd=u3_1278(i1,i2,i7,i8)%d,a1=l3_12(i1,i2)%a,b1=l3_12(i1
* ,i2)%b,c1=l3_12(i1,i2)%c,d1=l3_12(i1,i2)%d,a2=u312_78(i7,i8)%a,b2=u312
* _78(i7,i8)%b,c2=u312_78(i7,i8)%c,d2=u312_78(i7,i8)%d,prq=p312q,m=rmass
* (id3),nsum=1
      do jut=1,2
      cx1=u312_78(i7,i8)%a(1,jut)+rmass(id3)*u312_78(i7,i8)%b(1,
     & jut)
      cx2=u312_78(i7,i8)%a(2,jut)+rmass(id3)*u312_78(i7,i8)%b(2,
     & jut)
      cy1=p312q*u312_78(i7,i8)%b(1,jut)+rmass(id3)*u312_78(i7,i8
     & )%a(1,jut)
      cy2=p312q*u312_78(i7,i8)%b(2,jut)+rmass(id3)*u312_78(i7,i8
     & )%a(2,jut)
      cw1=u312_78(i7,i8)%c(1,jut)+rmass(id3)*u312_78(i7,i8)%d(1,
     & jut)
      cw2=u312_78(i7,i8)%c(2,jut)+rmass(id3)*u312_78(i7,i8)%d(2,
     & jut)
      cz1=p312q*u312_78(i7,i8)%d(1,jut)+rmass(id3)*u312_78(i7,i8
     & )%c(1,jut)
      cz2=p312q*u312_78(i7,i8)%d(2,jut)+rmass(id3)*u312_78(i7,i8
     & )%c(2,jut)
      u3_1278(i1,i2,i7,i8)%a(1,jut)=u3_1278(i1,i2,i7,i8)%a(1,jut
     & )+l3_12(i1,i2)%a(1,1)*cx1+l3_12(i1,i2)%c(1,2)*cy2
      u3_1278(i1,i2,i7,i8)%b(1,jut)=u3_1278(i1,i2,i7,i8)%b(1,jut
     & )+l3_12(i1,i2)%d(1,1)*cy1+l3_12(i1,i2)%b(1,2)*cx2
      u3_1278(i1,i2,i7,i8)%c(1,jut)=u3_1278(i1,i2,i7,i8)%c(1,jut
     & )+l3_12(i1,i2)%a(1,1)*cw1+l3_12(i1,i2)%c(1,2)*cz2
      u3_1278(i1,i2,i7,i8)%d(1,jut)=u3_1278(i1,i2,i7,i8)%d(1,jut
     & )+l3_12(i1,i2)%d(1,1)*cz1+l3_12(i1,i2)%b(1,2)*cw2
      u3_1278(i1,i2,i7,i8)%a(2,jut)=u3_1278(i1,i2,i7,i8)%a(2,jut
     & )+l3_12(i1,i2)%c(2,1)*cy1+l3_12(i1,i2)%a(2,2)*cx2
      u3_1278(i1,i2,i7,i8)%b(2,jut)=u3_1278(i1,i2,i7,i8)%b(2,jut
     & )+l3_12(i1,i2)%b(2,1)*cx1+l3_12(i1,i2)%d(2,2)*cy2
      u3_1278(i1,i2,i7,i8)%c(2,jut)=u3_1278(i1,i2,i7,i8)%c(2,jut
     & )+l3_12(i1,i2)%c(2,1)*cz1+l3_12(i1,i2)%a(2,2)*cw2
      u3_1278(i1,i2,i7,i8)%d(2,jut)=u3_1278(i1,i2,i7,i8)%d(2,jut
     & )+l3_12(i1,i2)%b(2,1)*cw1+l3_12(i1,i2)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p378q,p=p378,q=p378,bef=,aft=
      p378q=(p378(0)*p378(0)-p378(1)*p378(1)-p378(2)*p378(2)-p37
     & 8(3)*p378(3))
  
      if(id3.ne.5.or.(id7.ne.5.and.id1.ne.5))then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=u3_1278(i1,i2,i7,i8)%a,bb=u3_1278(i1,i2,i7,i8)%b,cc=u3_1278(i
* 1,i2,i7,i8)%c,dd=u3_1278(i1,i2,i7,i8)%d,a1=l3_78(i7,i8)%a,b1=l3_78(i7,
* i8)%b,c1=l3_78(i7,i8)%c,d1=l3_78(i7,i8)%d,a2=u378_12(i1,i2)%a,b2=u378_
* 12(i1,i2)%b,c2=u378_12(i1,i2)%c,d2=u378_12(i1,i2)%d,prq=p378q,m=rmass(
* id3),nsum=1
      u3_1278(i1,i2,i7,i8)%a(1,1)=u3_1278(i1,i2,i7,i8)%a(1,1)+l3
     & _78(i7,i8)%a(1,1)*u378_12(i1,i2)%a(1,1)+l3_78(i7,i8)%c(1,
     & 2)*p378q*u378_12(i1,i2)%b(2,1)
      u3_1278(i1,i2,i7,i8)%b(1,1)=u3_1278(i1,i2,i7,i8)%b(1,1)+rm
     & ass(id3)*(l3_78(i7,i8)%d(1,1)*u378_12(i1,i2)%a(1,1)+l3_78
     & (i7,i8)%b(1,2)*u378_12(i1,i2)%b(2,1))
      u3_1278(i1,i2,i7,i8)%c(1,1)=u3_1278(i1,i2,i7,i8)%c(1,1)+rm
     & ass(id3)*(l3_78(i7,i8)%a(1,1)*u378_12(i1,i2)%d(1,1)+l3_78
     & (i7,i8)%c(1,2)*u378_12(i1,i2)%c(2,1))
      u3_1278(i1,i2,i7,i8)%d(1,1)=u3_1278(i1,i2,i7,i8)%d(1,1)+l3
     & _78(i7,i8)%d(1,1)*p378q*u378_12(i1,i2)%d(1,1)+l3_78(i7,i8
     & )%b(1,2)*u378_12(i1,i2)%c(2,1)
      u3_1278(i1,i2,i7,i8)%a(1,2)=u3_1278(i1,i2,i7,i8)%a(1,2)+rm
     & ass(id3)*(l3_78(i7,i8)%a(1,1)*u378_12(i1,i2)%b(1,2)+l3_78
     & (i7,i8)%c(1,2)*u378_12(i1,i2)%a(2,2))
      u3_1278(i1,i2,i7,i8)%b(1,2)=u3_1278(i1,i2,i7,i8)%b(1,2)+l3
     & _78(i7,i8)%d(1,1)*p378q*u378_12(i1,i2)%b(1,2)+l3_78(i7,i8
     & )%b(1,2)*u378_12(i1,i2)%a(2,2)
      u3_1278(i1,i2,i7,i8)%c(1,2)=u3_1278(i1,i2,i7,i8)%c(1,2)+l3
     & _78(i7,i8)%a(1,1)*u378_12(i1,i2)%c(1,2)+l3_78(i7,i8)%c(1,
     & 2)*p378q*u378_12(i1,i2)%d(2,2)
      u3_1278(i1,i2,i7,i8)%d(1,2)=u3_1278(i1,i2,i7,i8)%d(1,2)+rm
     & ass(id3)*(l3_78(i7,i8)%d(1,1)*u378_12(i1,i2)%c(1,2)+l3_78
     & (i7,i8)%b(1,2)*u378_12(i1,i2)%d(2,2))
      u3_1278(i1,i2,i7,i8)%a(2,1)=u3_1278(i1,i2,i7,i8)%a(2,1)+rm
     & ass(id3)*(l3_78(i7,i8)%c(2,1)*u378_12(i1,i2)%a(1,1)+l3_78
     & (i7,i8)%a(2,2)*u378_12(i1,i2)%b(2,1))
      u3_1278(i1,i2,i7,i8)%b(2,1)=u3_1278(i1,i2,i7,i8)%b(2,1)+l3
     & _78(i7,i8)%b(2,1)*u378_12(i1,i2)%a(1,1)+l3_78(i7,i8)%d(2,
     & 2)*p378q*u378_12(i1,i2)%b(2,1)
      u3_1278(i1,i2,i7,i8)%c(2,1)=u3_1278(i1,i2,i7,i8)%c(2,1)+l3
     & _78(i7,i8)%c(2,1)*p378q*u378_12(i1,i2)%d(1,1)+l3_78(i7,i8
     & )%a(2,2)*u378_12(i1,i2)%c(2,1)
      u3_1278(i1,i2,i7,i8)%d(2,1)=u3_1278(i1,i2,i7,i8)%d(2,1)+rm
     & ass(id3)*(l3_78(i7,i8)%b(2,1)*u378_12(i1,i2)%d(1,1)+l3_78
     & (i7,i8)%d(2,2)*u378_12(i1,i2)%c(2,1))
      u3_1278(i1,i2,i7,i8)%a(2,2)=u3_1278(i1,i2,i7,i8)%a(2,2)+l3
     & _78(i7,i8)%c(2,1)*p378q*u378_12(i1,i2)%b(1,2)+l3_78(i7,i8
     & )%a(2,2)*u378_12(i1,i2)%a(2,2)
      u3_1278(i1,i2,i7,i8)%b(2,2)=u3_1278(i1,i2,i7,i8)%b(2,2)+rm
     & ass(id3)*(l3_78(i7,i8)%b(2,1)*u378_12(i1,i2)%b(1,2)+l3_78
     & (i7,i8)%d(2,2)*u378_12(i1,i2)%a(2,2))
      u3_1278(i1,i2,i7,i8)%c(2,2)=u3_1278(i1,i2,i7,i8)%c(2,2)+rm
     & ass(id3)*(l3_78(i7,i8)%c(2,1)*u378_12(i1,i2)%c(1,2)+l3_78
     & (i7,i8)%a(2,2)*u378_12(i1,i2)%d(2,2))
      u3_1278(i1,i2,i7,i8)%d(2,2)=u3_1278(i1,i2,i7,i8)%d(2,2)+l3
     & _78(i7,i8)%b(2,1)*u378_12(i1,i2)%c(1,2)+l3_78(i7,i8)%d(2,
     & 2)*p378q*u378_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id3.eq.5.and.id7.eq.5.and.id1.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=u3_1278(i1,i2,i7,i8)%a,bb=u3_1278(i1,i2,i7,i8)%b,cc=u3_1278
* (i1,i2,i7,i8)%c,dd=u3_1278(i1,i2,i7,i8)%d,a1=l3_78(i7,i8)%a,b1=l3_78(i
* 7,i8)%b,c1=l3_78(i7,i8)%c,d1=l3_78(i7,i8)%d,a2=u378_12(i1,i2)%a,b2=u37
* 8_12(i1,i2)%b,c2=u378_12(i1,i2)%c,d2=u378_12(i1,i2)%d,prq=p378q,m=rmas
* s(id3),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u378_12(i1,i2)%a(1,jut)+rmass(id3)*u378_12(i1,i2)%b(1,
     & jut)
      cx2=u378_12(i1,i2)%a(2,jut)+rmass(id3)*u378_12(i1,i2)%b(2,
     & jut)
      cy1=p378q*u378_12(i1,i2)%b(1,jut)+rmass(id3)*u378_12(i1,i2
     & )%a(1,jut)
      cy2=p378q*u378_12(i1,i2)%b(2,jut)+rmass(id3)*u378_12(i1,i2
     & )%a(2,jut)
      u3_1278(i1,i2,i7,i8)%a(iut,jut)=u3_1278(i1,i2,i7,i8)%a(iut
     & ,jut)+l3_78(i7,i8)%a(iut,1)*cx1+l3_78(i7,i8)%c(iut,1)*cy1
     & +l3_78(i7,i8)%a(iut,2)*cx2+l3_78(i7,i8)%c(iut,2)*cy2
      u3_1278(i1,i2,i7,i8)%b(iut,jut)=u3_1278(i1,i2,i7,i8)%b(iut
     & ,jut)+l3_78(i7,i8)%b(iut,1)*cx1+l3_78(i7,i8)%d(iut,1)*cy1
     & +l3_78(i7,i8)%b(iut,2)*cx2+l3_78(i7,i8)%d(iut,2)*cy2
      cw1=u378_12(i1,i2)%c(1,jut)+rmass(id3)*u378_12(i1,i2)%d(1,
     & jut)
      cw2=u378_12(i1,i2)%c(2,jut)+rmass(id3)*u378_12(i1,i2)%d(2,
     & jut)
      cz1=p378q*u378_12(i1,i2)%d(1,jut)+rmass(id3)*u378_12(i1,i2
     & )%c(1,jut)
      cz2=p378q*u378_12(i1,i2)%d(2,jut)+rmass(id3)*u378_12(i1,i2
     & )%c(2,jut)
      u3_1278(i1,i2,i7,i8)%c(iut,jut)=u3_1278(i1,i2,i7,i8)%c(iut
     & ,jut)+l3_78(i7,i8)%a(iut,1)*cw1+l3_78(i7,i8)%c(iut,1)*cz1
     & +l3_78(i7,i8)%a(iut,2)*cw2+l3_78(i7,i8)%c(iut,2)*cz2
      u3_1278(i1,i2,i7,i8)%d(iut,jut)=u3_1278(i1,i2,i7,i8)%d(iut
     & ,jut)+l3_78(i7,i8)%b(iut,1)*cw1+l3_78(i7,i8)%d(iut,1)*cz1
     & +l3_78(i7,i8)%b(iut,2)*cw2+l3_78(i7,i8)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id3.eq.5.and.id7.eq.5.and.id1.ne.5)then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=u3_1278(i1,i2,i7,i8)%a,bb=u3_1278(i1,i2,i7,i8)%b,cc=u3_1278(
* i1,i2,i7,i8)%c,dd=u3_1278(i1,i2,i7,i8)%d,a1=l3_78(i7,i8)%a,b1=l3_78(i7
* ,i8)%b,c1=l3_78(i7,i8)%c,d1=l3_78(i7,i8)%d,a2=u378_12(i1,i2)%a,b2=u378
* _12(i1,i2)%b,c2=u378_12(i1,i2)%c,d2=u378_12(i1,i2)%d,prq=p378q,m=rmass
* (id3),nsum=1
      do iut=1,2
      cx1=l3_78(i7,i8)%a(iut,1)+l3_78(i7,i8)%c(iut,1)*rmass(id3)
      cx2=l3_78(i7,i8)%c(iut,2)*p378q+l3_78(i7,i8)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_78(i7,i8)%b(iut,1)+l3_78(i7,i8)%d(iut,1)*rmass(id3)
      cy2=l3_78(i7,i8)%d(iut,2)*p378q+l3_78(i7,i8)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_78(i7,i8)%c(iut,1)*p378q+l3_78(i7,i8)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_78(i7,i8)%a(iut,2)+l3_78(i7,i8)%c(iut,2)*rmass(id3)
      cz1=l3_78(i7,i8)%d(iut,1)*p378q+l3_78(i7,i8)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_78(i7,i8)%b(iut,2)+l3_78(i7,i8)%d(iut,2)*rmass(id3)
      u3_1278(i1,i2,i7,i8)%a(iut,1)=u3_1278(i1,i2,i7,i8)%a(iut,1
     & )+cx1*u378_12(i1,i2)%a(1,1)+cx2*u378_12(i1,i2)%b(2,1)
      u3_1278(i1,i2,i7,i8)%b(iut,1)=u3_1278(i1,i2,i7,i8)%b(iut,1
     & )+cy1*u378_12(i1,i2)%a(1,1)+cy2*u378_12(i1,i2)%b(2,1)
      u3_1278(i1,i2,i7,i8)%c(iut,1)=u3_1278(i1,i2,i7,i8)%c(iut,1
     & )+cw1*u378_12(i1,i2)%d(1,1)+cw2*u378_12(i1,i2)%c(2,1)
      u3_1278(i1,i2,i7,i8)%d(iut,1)=u3_1278(i1,i2,i7,i8)%d(iut,1
     & )+cz1*u378_12(i1,i2)%d(1,1)+cz2*u378_12(i1,i2)%c(2,1)
      u3_1278(i1,i2,i7,i8)%a(iut,2)=u3_1278(i1,i2,i7,i8)%a(iut,2
     & )+cw1*u378_12(i1,i2)%b(1,2)+cw2*u378_12(i1,i2)%a(2,2)
      u3_1278(i1,i2,i7,i8)%b(iut,2)=u3_1278(i1,i2,i7,i8)%b(iut,2
     & )+cz1*u378_12(i1,i2)%b(1,2)+cz2*u378_12(i1,i2)%a(2,2)
      u3_1278(i1,i2,i7,i8)%c(iut,2)=u3_1278(i1,i2,i7,i8)%c(iut,2
     & )+cx1*u378_12(i1,i2)%c(1,2)+cx2*u378_12(i1,i2)%d(2,2)
      u3_1278(i1,i2,i7,i8)%d(iut,2)=u3_1278(i1,i2,i7,i8)%d(iut,2
     & )+cy1*u378_12(i1,i2)%c(1,2)+cy2*u378_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id3.eq.5.and.id7.ne.5.and.id1.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=u3_1278(i1,i2,i7,i8)%a,bb=u3_1278(i1,i2,i7,i8)%b,cc=u3_1278(
* i1,i2,i7,i8)%c,dd=u3_1278(i1,i2,i7,i8)%d,a1=l3_78(i7,i8)%a,b1=l3_78(i7
* ,i8)%b,c1=l3_78(i7,i8)%c,d1=l3_78(i7,i8)%d,a2=u378_12(i1,i2)%a,b2=u378
* _12(i1,i2)%b,c2=u378_12(i1,i2)%c,d2=u378_12(i1,i2)%d,prq=p378q,m=rmass
* (id3),nsum=1
      do jut=1,2
      cx1=u378_12(i1,i2)%a(1,jut)+rmass(id3)*u378_12(i1,i2)%b(1,
     & jut)
      cx2=u378_12(i1,i2)%a(2,jut)+rmass(id3)*u378_12(i1,i2)%b(2,
     & jut)
      cy1=p378q*u378_12(i1,i2)%b(1,jut)+rmass(id3)*u378_12(i1,i2
     & )%a(1,jut)
      cy2=p378q*u378_12(i1,i2)%b(2,jut)+rmass(id3)*u378_12(i1,i2
     & )%a(2,jut)
      cw1=u378_12(i1,i2)%c(1,jut)+rmass(id3)*u378_12(i1,i2)%d(1,
     & jut)
      cw2=u378_12(i1,i2)%c(2,jut)+rmass(id3)*u378_12(i1,i2)%d(2,
     & jut)
      cz1=p378q*u378_12(i1,i2)%d(1,jut)+rmass(id3)*u378_12(i1,i2
     & )%c(1,jut)
      cz2=p378q*u378_12(i1,i2)%d(2,jut)+rmass(id3)*u378_12(i1,i2
     & )%c(2,jut)
      u3_1278(i1,i2,i7,i8)%a(1,jut)=u3_1278(i1,i2,i7,i8)%a(1,jut
     & )+l3_78(i7,i8)%a(1,1)*cx1+l3_78(i7,i8)%c(1,2)*cy2
      u3_1278(i1,i2,i7,i8)%b(1,jut)=u3_1278(i1,i2,i7,i8)%b(1,jut
     & )+l3_78(i7,i8)%d(1,1)*cy1+l3_78(i7,i8)%b(1,2)*cx2
      u3_1278(i1,i2,i7,i8)%c(1,jut)=u3_1278(i1,i2,i7,i8)%c(1,jut
     & )+l3_78(i7,i8)%a(1,1)*cw1+l3_78(i7,i8)%c(1,2)*cz2
      u3_1278(i1,i2,i7,i8)%d(1,jut)=u3_1278(i1,i2,i7,i8)%d(1,jut
     & )+l3_78(i7,i8)%d(1,1)*cz1+l3_78(i7,i8)%b(1,2)*cw2
      u3_1278(i1,i2,i7,i8)%a(2,jut)=u3_1278(i1,i2,i7,i8)%a(2,jut
     & )+l3_78(i7,i8)%c(2,1)*cy1+l3_78(i7,i8)%a(2,2)*cx2
      u3_1278(i1,i2,i7,i8)%b(2,jut)=u3_1278(i1,i2,i7,i8)%b(2,jut
     & )+l3_78(i7,i8)%b(2,1)*cx1+l3_78(i7,i8)%d(2,2)*cy2
      u3_1278(i1,i2,i7,i8)%c(2,jut)=u3_1278(i1,i2,i7,i8)%c(2,jut
     & )+l3_78(i7,i8)%c(2,1)*cz1+l3_78(i7,i8)%a(2,2)*cw2
      u3_1278(i1,i2,i7,i8)%d(2,jut)=u3_1278(i1,i2,i7,i8)%d(2,jut
     & )+l3_78(i7,i8)%b(2,1)*cw1+l3_78(i7,i8)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p356q,p=p356,q=p356,bef=,aft=
      p356q=(p356(0)*p356(0)-p356(1)*p356(1)-p356(2)*p356(2)-p35
     & 6(3)*p356(3))
  
      if(id3.ne.5.or.(id5.ne.5.and.id7.ne.5))then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=u3_5678(i5,i6,i7,i8)%a,bb=u3_5678(i5,i6,i7,i8)%b,cc=u3_5678(i
* 5,i6,i7,i8)%c,dd=u3_5678(i5,i6,i7,i8)%d,a1=l3_56(i5,i6)%a,b1=l3_56(i5,
* i6)%b,c1=l3_56(i5,i6)%c,d1=l3_56(i5,i6)%d,a2=u356_78(i7,i8)%a,b2=u356_
* 78(i7,i8)%b,c2=u356_78(i7,i8)%c,d2=u356_78(i7,i8)%d,prq=p356q,m=rmass(
* id3),nsum=1
      u3_5678(i5,i6,i7,i8)%a(1,1)=u3_5678(i5,i6,i7,i8)%a(1,1)+l3
     & _56(i5,i6)%a(1,1)*u356_78(i7,i8)%a(1,1)+l3_56(i5,i6)%c(1,
     & 2)*p356q*u356_78(i7,i8)%b(2,1)
      u3_5678(i5,i6,i7,i8)%b(1,1)=u3_5678(i5,i6,i7,i8)%b(1,1)+rm
     & ass(id3)*(l3_56(i5,i6)%d(1,1)*u356_78(i7,i8)%a(1,1)+l3_56
     & (i5,i6)%b(1,2)*u356_78(i7,i8)%b(2,1))
      u3_5678(i5,i6,i7,i8)%c(1,1)=u3_5678(i5,i6,i7,i8)%c(1,1)+rm
     & ass(id3)*(l3_56(i5,i6)%a(1,1)*u356_78(i7,i8)%d(1,1)+l3_56
     & (i5,i6)%c(1,2)*u356_78(i7,i8)%c(2,1))
      u3_5678(i5,i6,i7,i8)%d(1,1)=u3_5678(i5,i6,i7,i8)%d(1,1)+l3
     & _56(i5,i6)%d(1,1)*p356q*u356_78(i7,i8)%d(1,1)+l3_56(i5,i6
     & )%b(1,2)*u356_78(i7,i8)%c(2,1)
      u3_5678(i5,i6,i7,i8)%a(1,2)=u3_5678(i5,i6,i7,i8)%a(1,2)+rm
     & ass(id3)*(l3_56(i5,i6)%a(1,1)*u356_78(i7,i8)%b(1,2)+l3_56
     & (i5,i6)%c(1,2)*u356_78(i7,i8)%a(2,2))
      u3_5678(i5,i6,i7,i8)%b(1,2)=u3_5678(i5,i6,i7,i8)%b(1,2)+l3
     & _56(i5,i6)%d(1,1)*p356q*u356_78(i7,i8)%b(1,2)+l3_56(i5,i6
     & )%b(1,2)*u356_78(i7,i8)%a(2,2)
      u3_5678(i5,i6,i7,i8)%c(1,2)=u3_5678(i5,i6,i7,i8)%c(1,2)+l3
     & _56(i5,i6)%a(1,1)*u356_78(i7,i8)%c(1,2)+l3_56(i5,i6)%c(1,
     & 2)*p356q*u356_78(i7,i8)%d(2,2)
      u3_5678(i5,i6,i7,i8)%d(1,2)=u3_5678(i5,i6,i7,i8)%d(1,2)+rm
     & ass(id3)*(l3_56(i5,i6)%d(1,1)*u356_78(i7,i8)%c(1,2)+l3_56
     & (i5,i6)%b(1,2)*u356_78(i7,i8)%d(2,2))
      u3_5678(i5,i6,i7,i8)%a(2,1)=u3_5678(i5,i6,i7,i8)%a(2,1)+rm
     & ass(id3)*(l3_56(i5,i6)%c(2,1)*u356_78(i7,i8)%a(1,1)+l3_56
     & (i5,i6)%a(2,2)*u356_78(i7,i8)%b(2,1))
      u3_5678(i5,i6,i7,i8)%b(2,1)=u3_5678(i5,i6,i7,i8)%b(2,1)+l3
     & _56(i5,i6)%b(2,1)*u356_78(i7,i8)%a(1,1)+l3_56(i5,i6)%d(2,
     & 2)*p356q*u356_78(i7,i8)%b(2,1)
      u3_5678(i5,i6,i7,i8)%c(2,1)=u3_5678(i5,i6,i7,i8)%c(2,1)+l3
     & _56(i5,i6)%c(2,1)*p356q*u356_78(i7,i8)%d(1,1)+l3_56(i5,i6
     & )%a(2,2)*u356_78(i7,i8)%c(2,1)
      u3_5678(i5,i6,i7,i8)%d(2,1)=u3_5678(i5,i6,i7,i8)%d(2,1)+rm
     & ass(id3)*(l3_56(i5,i6)%b(2,1)*u356_78(i7,i8)%d(1,1)+l3_56
     & (i5,i6)%d(2,2)*u356_78(i7,i8)%c(2,1))
      u3_5678(i5,i6,i7,i8)%a(2,2)=u3_5678(i5,i6,i7,i8)%a(2,2)+l3
     & _56(i5,i6)%c(2,1)*p356q*u356_78(i7,i8)%b(1,2)+l3_56(i5,i6
     & )%a(2,2)*u356_78(i7,i8)%a(2,2)
      u3_5678(i5,i6,i7,i8)%b(2,2)=u3_5678(i5,i6,i7,i8)%b(2,2)+rm
     & ass(id3)*(l3_56(i5,i6)%b(2,1)*u356_78(i7,i8)%b(1,2)+l3_56
     & (i5,i6)%d(2,2)*u356_78(i7,i8)%a(2,2))
      u3_5678(i5,i6,i7,i8)%c(2,2)=u3_5678(i5,i6,i7,i8)%c(2,2)+rm
     & ass(id3)*(l3_56(i5,i6)%c(2,1)*u356_78(i7,i8)%c(1,2)+l3_56
     & (i5,i6)%a(2,2)*u356_78(i7,i8)%d(2,2))
      u3_5678(i5,i6,i7,i8)%d(2,2)=u3_5678(i5,i6,i7,i8)%d(2,2)+l3
     & _56(i5,i6)%b(2,1)*u356_78(i7,i8)%c(1,2)+l3_56(i5,i6)%d(2,
     & 2)*p356q*u356_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id3.eq.5.and.id5.eq.5.and.id7.eq.5)then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=u3_5678(i5,i6,i7,i8)%a,bb=u3_5678(i5,i6,i7,i8)%b,cc=u3_5678
* (i5,i6,i7,i8)%c,dd=u3_5678(i5,i6,i7,i8)%d,a1=l3_56(i5,i6)%a,b1=l3_56(i
* 5,i6)%b,c1=l3_56(i5,i6)%c,d1=l3_56(i5,i6)%d,a2=u356_78(i7,i8)%a,b2=u35
* 6_78(i7,i8)%b,c2=u356_78(i7,i8)%c,d2=u356_78(i7,i8)%d,prq=p356q,m=rmas
* s(id3),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u356_78(i7,i8)%a(1,jut)+rmass(id3)*u356_78(i7,i8)%b(1,
     & jut)
      cx2=u356_78(i7,i8)%a(2,jut)+rmass(id3)*u356_78(i7,i8)%b(2,
     & jut)
      cy1=p356q*u356_78(i7,i8)%b(1,jut)+rmass(id3)*u356_78(i7,i8
     & )%a(1,jut)
      cy2=p356q*u356_78(i7,i8)%b(2,jut)+rmass(id3)*u356_78(i7,i8
     & )%a(2,jut)
      u3_5678(i5,i6,i7,i8)%a(iut,jut)=u3_5678(i5,i6,i7,i8)%a(iut
     & ,jut)+l3_56(i5,i6)%a(iut,1)*cx1+l3_56(i5,i6)%c(iut,1)*cy1
     & +l3_56(i5,i6)%a(iut,2)*cx2+l3_56(i5,i6)%c(iut,2)*cy2
      u3_5678(i5,i6,i7,i8)%b(iut,jut)=u3_5678(i5,i6,i7,i8)%b(iut
     & ,jut)+l3_56(i5,i6)%b(iut,1)*cx1+l3_56(i5,i6)%d(iut,1)*cy1
     & +l3_56(i5,i6)%b(iut,2)*cx2+l3_56(i5,i6)%d(iut,2)*cy2
      cw1=u356_78(i7,i8)%c(1,jut)+rmass(id3)*u356_78(i7,i8)%d(1,
     & jut)
      cw2=u356_78(i7,i8)%c(2,jut)+rmass(id3)*u356_78(i7,i8)%d(2,
     & jut)
      cz1=p356q*u356_78(i7,i8)%d(1,jut)+rmass(id3)*u356_78(i7,i8
     & )%c(1,jut)
      cz2=p356q*u356_78(i7,i8)%d(2,jut)+rmass(id3)*u356_78(i7,i8
     & )%c(2,jut)
      u3_5678(i5,i6,i7,i8)%c(iut,jut)=u3_5678(i5,i6,i7,i8)%c(iut
     & ,jut)+l3_56(i5,i6)%a(iut,1)*cw1+l3_56(i5,i6)%c(iut,1)*cz1
     & +l3_56(i5,i6)%a(iut,2)*cw2+l3_56(i5,i6)%c(iut,2)*cz2
      u3_5678(i5,i6,i7,i8)%d(iut,jut)=u3_5678(i5,i6,i7,i8)%d(iut
     & ,jut)+l3_56(i5,i6)%b(iut,1)*cw1+l3_56(i5,i6)%d(iut,1)*cz1
     & +l3_56(i5,i6)%b(iut,2)*cw2+l3_56(i5,i6)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id3.eq.5.and.id5.eq.5.and.id7.ne.5)then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=u3_5678(i5,i6,i7,i8)%a,bb=u3_5678(i5,i6,i7,i8)%b,cc=u3_5678(
* i5,i6,i7,i8)%c,dd=u3_5678(i5,i6,i7,i8)%d,a1=l3_56(i5,i6)%a,b1=l3_56(i5
* ,i6)%b,c1=l3_56(i5,i6)%c,d1=l3_56(i5,i6)%d,a2=u356_78(i7,i8)%a,b2=u356
* _78(i7,i8)%b,c2=u356_78(i7,i8)%c,d2=u356_78(i7,i8)%d,prq=p356q,m=rmass
* (id3),nsum=1
      do iut=1,2
      cx1=l3_56(i5,i6)%a(iut,1)+l3_56(i5,i6)%c(iut,1)*rmass(id3)
      cx2=l3_56(i5,i6)%c(iut,2)*p356q+l3_56(i5,i6)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_56(i5,i6)%b(iut,1)+l3_56(i5,i6)%d(iut,1)*rmass(id3)
      cy2=l3_56(i5,i6)%d(iut,2)*p356q+l3_56(i5,i6)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_56(i5,i6)%c(iut,1)*p356q+l3_56(i5,i6)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_56(i5,i6)%a(iut,2)+l3_56(i5,i6)%c(iut,2)*rmass(id3)
      cz1=l3_56(i5,i6)%d(iut,1)*p356q+l3_56(i5,i6)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_56(i5,i6)%b(iut,2)+l3_56(i5,i6)%d(iut,2)*rmass(id3)
      u3_5678(i5,i6,i7,i8)%a(iut,1)=u3_5678(i5,i6,i7,i8)%a(iut,1
     & )+cx1*u356_78(i7,i8)%a(1,1)+cx2*u356_78(i7,i8)%b(2,1)
      u3_5678(i5,i6,i7,i8)%b(iut,1)=u3_5678(i5,i6,i7,i8)%b(iut,1
     & )+cy1*u356_78(i7,i8)%a(1,1)+cy2*u356_78(i7,i8)%b(2,1)
      u3_5678(i5,i6,i7,i8)%c(iut,1)=u3_5678(i5,i6,i7,i8)%c(iut,1
     & )+cw1*u356_78(i7,i8)%d(1,1)+cw2*u356_78(i7,i8)%c(2,1)
      u3_5678(i5,i6,i7,i8)%d(iut,1)=u3_5678(i5,i6,i7,i8)%d(iut,1
     & )+cz1*u356_78(i7,i8)%d(1,1)+cz2*u356_78(i7,i8)%c(2,1)
      u3_5678(i5,i6,i7,i8)%a(iut,2)=u3_5678(i5,i6,i7,i8)%a(iut,2
     & )+cw1*u356_78(i7,i8)%b(1,2)+cw2*u356_78(i7,i8)%a(2,2)
      u3_5678(i5,i6,i7,i8)%b(iut,2)=u3_5678(i5,i6,i7,i8)%b(iut,2
     & )+cz1*u356_78(i7,i8)%b(1,2)+cz2*u356_78(i7,i8)%a(2,2)
      u3_5678(i5,i6,i7,i8)%c(iut,2)=u3_5678(i5,i6,i7,i8)%c(iut,2
     & )+cx1*u356_78(i7,i8)%c(1,2)+cx2*u356_78(i7,i8)%d(2,2)
      u3_5678(i5,i6,i7,i8)%d(iut,2)=u3_5678(i5,i6,i7,i8)%d(iut,2
     & )+cy1*u356_78(i7,i8)%c(1,2)+cy2*u356_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id3.eq.5.and.id5.ne.5.and.id7.eq.5)then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=u3_5678(i5,i6,i7,i8)%a,bb=u3_5678(i5,i6,i7,i8)%b,cc=u3_5678(
* i5,i6,i7,i8)%c,dd=u3_5678(i5,i6,i7,i8)%d,a1=l3_56(i5,i6)%a,b1=l3_56(i5
* ,i6)%b,c1=l3_56(i5,i6)%c,d1=l3_56(i5,i6)%d,a2=u356_78(i7,i8)%a,b2=u356
* _78(i7,i8)%b,c2=u356_78(i7,i8)%c,d2=u356_78(i7,i8)%d,prq=p356q,m=rmass
* (id3),nsum=1
      do jut=1,2
      cx1=u356_78(i7,i8)%a(1,jut)+rmass(id3)*u356_78(i7,i8)%b(1,
     & jut)
      cx2=u356_78(i7,i8)%a(2,jut)+rmass(id3)*u356_78(i7,i8)%b(2,
     & jut)
      cy1=p356q*u356_78(i7,i8)%b(1,jut)+rmass(id3)*u356_78(i7,i8
     & )%a(1,jut)
      cy2=p356q*u356_78(i7,i8)%b(2,jut)+rmass(id3)*u356_78(i7,i8
     & )%a(2,jut)
      cw1=u356_78(i7,i8)%c(1,jut)+rmass(id3)*u356_78(i7,i8)%d(1,
     & jut)
      cw2=u356_78(i7,i8)%c(2,jut)+rmass(id3)*u356_78(i7,i8)%d(2,
     & jut)
      cz1=p356q*u356_78(i7,i8)%d(1,jut)+rmass(id3)*u356_78(i7,i8
     & )%c(1,jut)
      cz2=p356q*u356_78(i7,i8)%d(2,jut)+rmass(id3)*u356_78(i7,i8
     & )%c(2,jut)
      u3_5678(i5,i6,i7,i8)%a(1,jut)=u3_5678(i5,i6,i7,i8)%a(1,jut
     & )+l3_56(i5,i6)%a(1,1)*cx1+l3_56(i5,i6)%c(1,2)*cy2
      u3_5678(i5,i6,i7,i8)%b(1,jut)=u3_5678(i5,i6,i7,i8)%b(1,jut
     & )+l3_56(i5,i6)%d(1,1)*cy1+l3_56(i5,i6)%b(1,2)*cx2
      u3_5678(i5,i6,i7,i8)%c(1,jut)=u3_5678(i5,i6,i7,i8)%c(1,jut
     & )+l3_56(i5,i6)%a(1,1)*cw1+l3_56(i5,i6)%c(1,2)*cz2
      u3_5678(i5,i6,i7,i8)%d(1,jut)=u3_5678(i5,i6,i7,i8)%d(1,jut
     & )+l3_56(i5,i6)%d(1,1)*cz1+l3_56(i5,i6)%b(1,2)*cw2
      u3_5678(i5,i6,i7,i8)%a(2,jut)=u3_5678(i5,i6,i7,i8)%a(2,jut
     & )+l3_56(i5,i6)%c(2,1)*cy1+l3_56(i5,i6)%a(2,2)*cx2
      u3_5678(i5,i6,i7,i8)%b(2,jut)=u3_5678(i5,i6,i7,i8)%b(2,jut
     & )+l3_56(i5,i6)%b(2,1)*cx1+l3_56(i5,i6)%d(2,2)*cy2
      u3_5678(i5,i6,i7,i8)%c(2,jut)=u3_5678(i5,i6,i7,i8)%c(2,jut
     & )+l3_56(i5,i6)%c(2,1)*cz1+l3_56(i5,i6)%a(2,2)*cw2
      u3_5678(i5,i6,i7,i8)%d(2,jut)=u3_5678(i5,i6,i7,i8)%d(2,jut
     & )+l3_56(i5,i6)%b(2,1)*cw1+l3_56(i5,i6)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p378q,p=p378,q=p378,bef=,aft=
      p378q=(p378(0)*p378(0)-p378(1)*p378(1)-p378(2)*p378(2)-p37
     & 8(3)*p378(3))
  
      if(id3.ne.5.or.(id7.ne.5.and.id5.ne.5))then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=u3_5678(i5,i6,i7,i8)%a,bb=u3_5678(i5,i6,i7,i8)%b,cc=u3_5678(i
* 5,i6,i7,i8)%c,dd=u3_5678(i5,i6,i7,i8)%d,a1=l3_78(i7,i8)%a,b1=l3_78(i7,
* i8)%b,c1=l3_78(i7,i8)%c,d1=l3_78(i7,i8)%d,a2=u378_56(i5,i6)%a,b2=u378_
* 56(i5,i6)%b,c2=u378_56(i5,i6)%c,d2=u378_56(i5,i6)%d,prq=p378q,m=rmass(
* id3),nsum=1
      u3_5678(i5,i6,i7,i8)%a(1,1)=u3_5678(i5,i6,i7,i8)%a(1,1)+l3
     & _78(i7,i8)%a(1,1)*u378_56(i5,i6)%a(1,1)+l3_78(i7,i8)%c(1,
     & 2)*p378q*u378_56(i5,i6)%b(2,1)
      u3_5678(i5,i6,i7,i8)%b(1,1)=u3_5678(i5,i6,i7,i8)%b(1,1)+rm
     & ass(id3)*(l3_78(i7,i8)%d(1,1)*u378_56(i5,i6)%a(1,1)+l3_78
     & (i7,i8)%b(1,2)*u378_56(i5,i6)%b(2,1))
      u3_5678(i5,i6,i7,i8)%c(1,1)=u3_5678(i5,i6,i7,i8)%c(1,1)+rm
     & ass(id3)*(l3_78(i7,i8)%a(1,1)*u378_56(i5,i6)%d(1,1)+l3_78
     & (i7,i8)%c(1,2)*u378_56(i5,i6)%c(2,1))
      u3_5678(i5,i6,i7,i8)%d(1,1)=u3_5678(i5,i6,i7,i8)%d(1,1)+l3
     & _78(i7,i8)%d(1,1)*p378q*u378_56(i5,i6)%d(1,1)+l3_78(i7,i8
     & )%b(1,2)*u378_56(i5,i6)%c(2,1)
      u3_5678(i5,i6,i7,i8)%a(1,2)=u3_5678(i5,i6,i7,i8)%a(1,2)+rm
     & ass(id3)*(l3_78(i7,i8)%a(1,1)*u378_56(i5,i6)%b(1,2)+l3_78
     & (i7,i8)%c(1,2)*u378_56(i5,i6)%a(2,2))
      u3_5678(i5,i6,i7,i8)%b(1,2)=u3_5678(i5,i6,i7,i8)%b(1,2)+l3
     & _78(i7,i8)%d(1,1)*p378q*u378_56(i5,i6)%b(1,2)+l3_78(i7,i8
     & )%b(1,2)*u378_56(i5,i6)%a(2,2)
      u3_5678(i5,i6,i7,i8)%c(1,2)=u3_5678(i5,i6,i7,i8)%c(1,2)+l3
     & _78(i7,i8)%a(1,1)*u378_56(i5,i6)%c(1,2)+l3_78(i7,i8)%c(1,
     & 2)*p378q*u378_56(i5,i6)%d(2,2)
      u3_5678(i5,i6,i7,i8)%d(1,2)=u3_5678(i5,i6,i7,i8)%d(1,2)+rm
     & ass(id3)*(l3_78(i7,i8)%d(1,1)*u378_56(i5,i6)%c(1,2)+l3_78
     & (i7,i8)%b(1,2)*u378_56(i5,i6)%d(2,2))
      u3_5678(i5,i6,i7,i8)%a(2,1)=u3_5678(i5,i6,i7,i8)%a(2,1)+rm
     & ass(id3)*(l3_78(i7,i8)%c(2,1)*u378_56(i5,i6)%a(1,1)+l3_78
     & (i7,i8)%a(2,2)*u378_56(i5,i6)%b(2,1))
      u3_5678(i5,i6,i7,i8)%b(2,1)=u3_5678(i5,i6,i7,i8)%b(2,1)+l3
     & _78(i7,i8)%b(2,1)*u378_56(i5,i6)%a(1,1)+l3_78(i7,i8)%d(2,
     & 2)*p378q*u378_56(i5,i6)%b(2,1)
      u3_5678(i5,i6,i7,i8)%c(2,1)=u3_5678(i5,i6,i7,i8)%c(2,1)+l3
     & _78(i7,i8)%c(2,1)*p378q*u378_56(i5,i6)%d(1,1)+l3_78(i7,i8
     & )%a(2,2)*u378_56(i5,i6)%c(2,1)
      u3_5678(i5,i6,i7,i8)%d(2,1)=u3_5678(i5,i6,i7,i8)%d(2,1)+rm
     & ass(id3)*(l3_78(i7,i8)%b(2,1)*u378_56(i5,i6)%d(1,1)+l3_78
     & (i7,i8)%d(2,2)*u378_56(i5,i6)%c(2,1))
      u3_5678(i5,i6,i7,i8)%a(2,2)=u3_5678(i5,i6,i7,i8)%a(2,2)+l3
     & _78(i7,i8)%c(2,1)*p378q*u378_56(i5,i6)%b(1,2)+l3_78(i7,i8
     & )%a(2,2)*u378_56(i5,i6)%a(2,2)
      u3_5678(i5,i6,i7,i8)%b(2,2)=u3_5678(i5,i6,i7,i8)%b(2,2)+rm
     & ass(id3)*(l3_78(i7,i8)%b(2,1)*u378_56(i5,i6)%b(1,2)+l3_78
     & (i7,i8)%d(2,2)*u378_56(i5,i6)%a(2,2))
      u3_5678(i5,i6,i7,i8)%c(2,2)=u3_5678(i5,i6,i7,i8)%c(2,2)+rm
     & ass(id3)*(l3_78(i7,i8)%c(2,1)*u378_56(i5,i6)%c(1,2)+l3_78
     & (i7,i8)%a(2,2)*u378_56(i5,i6)%d(2,2))
      u3_5678(i5,i6,i7,i8)%d(2,2)=u3_5678(i5,i6,i7,i8)%d(2,2)+l3
     & _78(i7,i8)%b(2,1)*u378_56(i5,i6)%c(1,2)+l3_78(i7,i8)%d(2,
     & 2)*p378q*u378_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id3.eq.5.and.id7.eq.5.and.id5.eq.5)then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=u3_5678(i5,i6,i7,i8)%a,bb=u3_5678(i5,i6,i7,i8)%b,cc=u3_5678
* (i5,i6,i7,i8)%c,dd=u3_5678(i5,i6,i7,i8)%d,a1=l3_78(i7,i8)%a,b1=l3_78(i
* 7,i8)%b,c1=l3_78(i7,i8)%c,d1=l3_78(i7,i8)%d,a2=u378_56(i5,i6)%a,b2=u37
* 8_56(i5,i6)%b,c2=u378_56(i5,i6)%c,d2=u378_56(i5,i6)%d,prq=p378q,m=rmas
* s(id3),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u378_56(i5,i6)%a(1,jut)+rmass(id3)*u378_56(i5,i6)%b(1,
     & jut)
      cx2=u378_56(i5,i6)%a(2,jut)+rmass(id3)*u378_56(i5,i6)%b(2,
     & jut)
      cy1=p378q*u378_56(i5,i6)%b(1,jut)+rmass(id3)*u378_56(i5,i6
     & )%a(1,jut)
      cy2=p378q*u378_56(i5,i6)%b(2,jut)+rmass(id3)*u378_56(i5,i6
     & )%a(2,jut)
      u3_5678(i5,i6,i7,i8)%a(iut,jut)=u3_5678(i5,i6,i7,i8)%a(iut
     & ,jut)+l3_78(i7,i8)%a(iut,1)*cx1+l3_78(i7,i8)%c(iut,1)*cy1
     & +l3_78(i7,i8)%a(iut,2)*cx2+l3_78(i7,i8)%c(iut,2)*cy2
      u3_5678(i5,i6,i7,i8)%b(iut,jut)=u3_5678(i5,i6,i7,i8)%b(iut
     & ,jut)+l3_78(i7,i8)%b(iut,1)*cx1+l3_78(i7,i8)%d(iut,1)*cy1
     & +l3_78(i7,i8)%b(iut,2)*cx2+l3_78(i7,i8)%d(iut,2)*cy2
      cw1=u378_56(i5,i6)%c(1,jut)+rmass(id3)*u378_56(i5,i6)%d(1,
     & jut)
      cw2=u378_56(i5,i6)%c(2,jut)+rmass(id3)*u378_56(i5,i6)%d(2,
     & jut)
      cz1=p378q*u378_56(i5,i6)%d(1,jut)+rmass(id3)*u378_56(i5,i6
     & )%c(1,jut)
      cz2=p378q*u378_56(i5,i6)%d(2,jut)+rmass(id3)*u378_56(i5,i6
     & )%c(2,jut)
      u3_5678(i5,i6,i7,i8)%c(iut,jut)=u3_5678(i5,i6,i7,i8)%c(iut
     & ,jut)+l3_78(i7,i8)%a(iut,1)*cw1+l3_78(i7,i8)%c(iut,1)*cz1
     & +l3_78(i7,i8)%a(iut,2)*cw2+l3_78(i7,i8)%c(iut,2)*cz2
      u3_5678(i5,i6,i7,i8)%d(iut,jut)=u3_5678(i5,i6,i7,i8)%d(iut
     & ,jut)+l3_78(i7,i8)%b(iut,1)*cw1+l3_78(i7,i8)%d(iut,1)*cz1
     & +l3_78(i7,i8)%b(iut,2)*cw2+l3_78(i7,i8)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id3.eq.5.and.id7.eq.5.and.id5.ne.5)then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=u3_5678(i5,i6,i7,i8)%a,bb=u3_5678(i5,i6,i7,i8)%b,cc=u3_5678(
* i5,i6,i7,i8)%c,dd=u3_5678(i5,i6,i7,i8)%d,a1=l3_78(i7,i8)%a,b1=l3_78(i7
* ,i8)%b,c1=l3_78(i7,i8)%c,d1=l3_78(i7,i8)%d,a2=u378_56(i5,i6)%a,b2=u378
* _56(i5,i6)%b,c2=u378_56(i5,i6)%c,d2=u378_56(i5,i6)%d,prq=p378q,m=rmass
* (id3),nsum=1
      do iut=1,2
      cx1=l3_78(i7,i8)%a(iut,1)+l3_78(i7,i8)%c(iut,1)*rmass(id3)
      cx2=l3_78(i7,i8)%c(iut,2)*p378q+l3_78(i7,i8)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_78(i7,i8)%b(iut,1)+l3_78(i7,i8)%d(iut,1)*rmass(id3)
      cy2=l3_78(i7,i8)%d(iut,2)*p378q+l3_78(i7,i8)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_78(i7,i8)%c(iut,1)*p378q+l3_78(i7,i8)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_78(i7,i8)%a(iut,2)+l3_78(i7,i8)%c(iut,2)*rmass(id3)
      cz1=l3_78(i7,i8)%d(iut,1)*p378q+l3_78(i7,i8)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_78(i7,i8)%b(iut,2)+l3_78(i7,i8)%d(iut,2)*rmass(id3)
      u3_5678(i5,i6,i7,i8)%a(iut,1)=u3_5678(i5,i6,i7,i8)%a(iut,1
     & )+cx1*u378_56(i5,i6)%a(1,1)+cx2*u378_56(i5,i6)%b(2,1)
      u3_5678(i5,i6,i7,i8)%b(iut,1)=u3_5678(i5,i6,i7,i8)%b(iut,1
     & )+cy1*u378_56(i5,i6)%a(1,1)+cy2*u378_56(i5,i6)%b(2,1)
      u3_5678(i5,i6,i7,i8)%c(iut,1)=u3_5678(i5,i6,i7,i8)%c(iut,1
     & )+cw1*u378_56(i5,i6)%d(1,1)+cw2*u378_56(i5,i6)%c(2,1)
      u3_5678(i5,i6,i7,i8)%d(iut,1)=u3_5678(i5,i6,i7,i8)%d(iut,1
     & )+cz1*u378_56(i5,i6)%d(1,1)+cz2*u378_56(i5,i6)%c(2,1)
      u3_5678(i5,i6,i7,i8)%a(iut,2)=u3_5678(i5,i6,i7,i8)%a(iut,2
     & )+cw1*u378_56(i5,i6)%b(1,2)+cw2*u378_56(i5,i6)%a(2,2)
      u3_5678(i5,i6,i7,i8)%b(iut,2)=u3_5678(i5,i6,i7,i8)%b(iut,2
     & )+cz1*u378_56(i5,i6)%b(1,2)+cz2*u378_56(i5,i6)%a(2,2)
      u3_5678(i5,i6,i7,i8)%c(iut,2)=u3_5678(i5,i6,i7,i8)%c(iut,2
     & )+cx1*u378_56(i5,i6)%c(1,2)+cx2*u378_56(i5,i6)%d(2,2)
      u3_5678(i5,i6,i7,i8)%d(iut,2)=u3_5678(i5,i6,i7,i8)%d(iut,2
     & )+cy1*u378_56(i5,i6)%c(1,2)+cy2*u378_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id3.eq.5.and.id7.ne.5.and.id5.eq.5)then
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=u3_5678(i5,i6,i7,i8)%a,bb=u3_5678(i5,i6,i7,i8)%b,cc=u3_5678(
* i5,i6,i7,i8)%c,dd=u3_5678(i5,i6,i7,i8)%d,a1=l3_78(i7,i8)%a,b1=l3_78(i7
* ,i8)%b,c1=l3_78(i7,i8)%c,d1=l3_78(i7,i8)%d,a2=u378_56(i5,i6)%a,b2=u378
* _56(i5,i6)%b,c2=u378_56(i5,i6)%c,d2=u378_56(i5,i6)%d,prq=p378q,m=rmass
* (id3),nsum=1
      do jut=1,2
      cx1=u378_56(i5,i6)%a(1,jut)+rmass(id3)*u378_56(i5,i6)%b(1,
     & jut)
      cx2=u378_56(i5,i6)%a(2,jut)+rmass(id3)*u378_56(i5,i6)%b(2,
     & jut)
      cy1=p378q*u378_56(i5,i6)%b(1,jut)+rmass(id3)*u378_56(i5,i6
     & )%a(1,jut)
      cy2=p378q*u378_56(i5,i6)%b(2,jut)+rmass(id3)*u378_56(i5,i6
     & )%a(2,jut)
      cw1=u378_56(i5,i6)%c(1,jut)+rmass(id3)*u378_56(i5,i6)%d(1,
     & jut)
      cw2=u378_56(i5,i6)%c(2,jut)+rmass(id3)*u378_56(i5,i6)%d(2,
     & jut)
      cz1=p378q*u378_56(i5,i6)%d(1,jut)+rmass(id3)*u378_56(i5,i6
     & )%c(1,jut)
      cz2=p378q*u378_56(i5,i6)%d(2,jut)+rmass(id3)*u378_56(i5,i6
     & )%c(2,jut)
      u3_5678(i5,i6,i7,i8)%a(1,jut)=u3_5678(i5,i6,i7,i8)%a(1,jut
     & )+l3_78(i7,i8)%a(1,1)*cx1+l3_78(i7,i8)%c(1,2)*cy2
      u3_5678(i5,i6,i7,i8)%b(1,jut)=u3_5678(i5,i6,i7,i8)%b(1,jut
     & )+l3_78(i7,i8)%d(1,1)*cy1+l3_78(i7,i8)%b(1,2)*cx2
      u3_5678(i5,i6,i7,i8)%c(1,jut)=u3_5678(i5,i6,i7,i8)%c(1,jut
     & )+l3_78(i7,i8)%a(1,1)*cw1+l3_78(i7,i8)%c(1,2)*cz2
      u3_5678(i5,i6,i7,i8)%d(1,jut)=u3_5678(i5,i6,i7,i8)%d(1,jut
     & )+l3_78(i7,i8)%d(1,1)*cz1+l3_78(i7,i8)%b(1,2)*cw2
      u3_5678(i5,i6,i7,i8)%a(2,jut)=u3_5678(i5,i6,i7,i8)%a(2,jut
     & )+l3_78(i7,i8)%c(2,1)*cy1+l3_78(i7,i8)%a(2,2)*cx2
      u3_5678(i5,i6,i7,i8)%b(2,jut)=u3_5678(i5,i6,i7,i8)%b(2,jut
     & )+l3_78(i7,i8)%b(2,1)*cx1+l3_78(i7,i8)%d(2,2)*cy2
      u3_5678(i5,i6,i7,i8)%c(2,jut)=u3_5678(i5,i6,i7,i8)%c(2,jut
     & )+l3_78(i7,i8)%c(2,1)*cz1+l3_78(i7,i8)%a(2,2)*cw2
      u3_5678(i5,i6,i7,i8)%d(2,jut)=u3_5678(i5,i6,i7,i8)%d(2,jut
     & )+l3_78(i7,i8)%b(2,1)*cw1+l3_78(i7,i8)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p512q,p=p512,q=p512,bef=,aft=
      p512q=(p512(0)*p512(0)-p512(1)*p512(1)-p512(2)*p512(2)-p51
     & 2(3)*p512(3))
  
      if(id5.ne.5.or.(id1.ne.5.and.id3.ne.5))then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=u5_1234(i1,i2,i3,i4)%a,bb=u5_1234(i1,i2,i3,i4)%b,cc=u5_1234(i
* 1,i2,i3,i4)%c,dd=u5_1234(i1,i2,i3,i4)%d,a1=l5_12(i1,i2)%a,b1=l5_12(i1,
* i2)%b,c1=l5_12(i1,i2)%c,d1=l5_12(i1,i2)%d,a2=u512_34(i3,i4)%a,b2=u512_
* 34(i3,i4)%b,c2=u512_34(i3,i4)%c,d2=u512_34(i3,i4)%d,prq=p512q,m=rmass(
* id5),nsum=1
      u5_1234(i1,i2,i3,i4)%a(1,1)=u5_1234(i1,i2,i3,i4)%a(1,1)+l5
     & _12(i1,i2)%a(1,1)*u512_34(i3,i4)%a(1,1)+l5_12(i1,i2)%c(1,
     & 2)*p512q*u512_34(i3,i4)%b(2,1)
      u5_1234(i1,i2,i3,i4)%b(1,1)=u5_1234(i1,i2,i3,i4)%b(1,1)+rm
     & ass(id5)*(l5_12(i1,i2)%d(1,1)*u512_34(i3,i4)%a(1,1)+l5_12
     & (i1,i2)%b(1,2)*u512_34(i3,i4)%b(2,1))
      u5_1234(i1,i2,i3,i4)%c(1,1)=u5_1234(i1,i2,i3,i4)%c(1,1)+rm
     & ass(id5)*(l5_12(i1,i2)%a(1,1)*u512_34(i3,i4)%d(1,1)+l5_12
     & (i1,i2)%c(1,2)*u512_34(i3,i4)%c(2,1))
      u5_1234(i1,i2,i3,i4)%d(1,1)=u5_1234(i1,i2,i3,i4)%d(1,1)+l5
     & _12(i1,i2)%d(1,1)*p512q*u512_34(i3,i4)%d(1,1)+l5_12(i1,i2
     & )%b(1,2)*u512_34(i3,i4)%c(2,1)
      u5_1234(i1,i2,i3,i4)%a(1,2)=u5_1234(i1,i2,i3,i4)%a(1,2)+rm
     & ass(id5)*(l5_12(i1,i2)%a(1,1)*u512_34(i3,i4)%b(1,2)+l5_12
     & (i1,i2)%c(1,2)*u512_34(i3,i4)%a(2,2))
      u5_1234(i1,i2,i3,i4)%b(1,2)=u5_1234(i1,i2,i3,i4)%b(1,2)+l5
     & _12(i1,i2)%d(1,1)*p512q*u512_34(i3,i4)%b(1,2)+l5_12(i1,i2
     & )%b(1,2)*u512_34(i3,i4)%a(2,2)
      u5_1234(i1,i2,i3,i4)%c(1,2)=u5_1234(i1,i2,i3,i4)%c(1,2)+l5
     & _12(i1,i2)%a(1,1)*u512_34(i3,i4)%c(1,2)+l5_12(i1,i2)%c(1,
     & 2)*p512q*u512_34(i3,i4)%d(2,2)
      u5_1234(i1,i2,i3,i4)%d(1,2)=u5_1234(i1,i2,i3,i4)%d(1,2)+rm
     & ass(id5)*(l5_12(i1,i2)%d(1,1)*u512_34(i3,i4)%c(1,2)+l5_12
     & (i1,i2)%b(1,2)*u512_34(i3,i4)%d(2,2))
      u5_1234(i1,i2,i3,i4)%a(2,1)=u5_1234(i1,i2,i3,i4)%a(2,1)+rm
     & ass(id5)*(l5_12(i1,i2)%c(2,1)*u512_34(i3,i4)%a(1,1)+l5_12
     & (i1,i2)%a(2,2)*u512_34(i3,i4)%b(2,1))
      u5_1234(i1,i2,i3,i4)%b(2,1)=u5_1234(i1,i2,i3,i4)%b(2,1)+l5
     & _12(i1,i2)%b(2,1)*u512_34(i3,i4)%a(1,1)+l5_12(i1,i2)%d(2,
     & 2)*p512q*u512_34(i3,i4)%b(2,1)
      u5_1234(i1,i2,i3,i4)%c(2,1)=u5_1234(i1,i2,i3,i4)%c(2,1)+l5
     & _12(i1,i2)%c(2,1)*p512q*u512_34(i3,i4)%d(1,1)+l5_12(i1,i2
     & )%a(2,2)*u512_34(i3,i4)%c(2,1)
      u5_1234(i1,i2,i3,i4)%d(2,1)=u5_1234(i1,i2,i3,i4)%d(2,1)+rm
     & ass(id5)*(l5_12(i1,i2)%b(2,1)*u512_34(i3,i4)%d(1,1)+l5_12
     & (i1,i2)%d(2,2)*u512_34(i3,i4)%c(2,1))
      u5_1234(i1,i2,i3,i4)%a(2,2)=u5_1234(i1,i2,i3,i4)%a(2,2)+l5
     & _12(i1,i2)%c(2,1)*p512q*u512_34(i3,i4)%b(1,2)+l5_12(i1,i2
     & )%a(2,2)*u512_34(i3,i4)%a(2,2)
      u5_1234(i1,i2,i3,i4)%b(2,2)=u5_1234(i1,i2,i3,i4)%b(2,2)+rm
     & ass(id5)*(l5_12(i1,i2)%b(2,1)*u512_34(i3,i4)%b(1,2)+l5_12
     & (i1,i2)%d(2,2)*u512_34(i3,i4)%a(2,2))
      u5_1234(i1,i2,i3,i4)%c(2,2)=u5_1234(i1,i2,i3,i4)%c(2,2)+rm
     & ass(id5)*(l5_12(i1,i2)%c(2,1)*u512_34(i3,i4)%c(1,2)+l5_12
     & (i1,i2)%a(2,2)*u512_34(i3,i4)%d(2,2))
      u5_1234(i1,i2,i3,i4)%d(2,2)=u5_1234(i1,i2,i3,i4)%d(2,2)+l5
     & _12(i1,i2)%b(2,1)*u512_34(i3,i4)%c(1,2)+l5_12(i1,i2)%d(2,
     & 2)*p512q*u512_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id5.eq.5.and.id1.eq.5.and.id3.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TsTs -- aa=u5_1234(i1,i2,i3,i4)%a,bb=u5_1234(i1,i2,i3,i4)%b,cc=u5_1234
* (i1,i2,i3,i4)%c,dd=u5_1234(i1,i2,i3,i4)%d,a1=l5_12(i1,i2)%a,b1=l5_12(i
* 1,i2)%b,c1=l5_12(i1,i2)%c,d1=l5_12(i1,i2)%d,a2=u512_34(i3,i4)%a,b2=u51
* 2_34(i3,i4)%b,c2=u512_34(i3,i4)%c,d2=u512_34(i3,i4)%d,prq=p512q,m=rmas
* s(id5),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u512_34(i3,i4)%a(1,jut)+rmass(id5)*u512_34(i3,i4)%b(1,
     & jut)
      cx2=u512_34(i3,i4)%a(2,jut)+rmass(id5)*u512_34(i3,i4)%b(2,
     & jut)
      cy1=p512q*u512_34(i3,i4)%b(1,jut)+rmass(id5)*u512_34(i3,i4
     & )%a(1,jut)
      cy2=p512q*u512_34(i3,i4)%b(2,jut)+rmass(id5)*u512_34(i3,i4
     & )%a(2,jut)
      u5_1234(i1,i2,i3,i4)%a(iut,jut)=u5_1234(i1,i2,i3,i4)%a(iut
     & ,jut)+l5_12(i1,i2)%a(iut,1)*cx1+l5_12(i1,i2)%c(iut,1)*cy1
     & +l5_12(i1,i2)%a(iut,2)*cx2+l5_12(i1,i2)%c(iut,2)*cy2
      u5_1234(i1,i2,i3,i4)%b(iut,jut)=u5_1234(i1,i2,i3,i4)%b(iut
     & ,jut)+l5_12(i1,i2)%b(iut,1)*cx1+l5_12(i1,i2)%d(iut,1)*cy1
     & +l5_12(i1,i2)%b(iut,2)*cx2+l5_12(i1,i2)%d(iut,2)*cy2
      cw1=u512_34(i3,i4)%c(1,jut)+rmass(id5)*u512_34(i3,i4)%d(1,
     & jut)
      cw2=u512_34(i3,i4)%c(2,jut)+rmass(id5)*u512_34(i3,i4)%d(2,
     & jut)
      cz1=p512q*u512_34(i3,i4)%d(1,jut)+rmass(id5)*u512_34(i3,i4
     & )%c(1,jut)
      cz2=p512q*u512_34(i3,i4)%d(2,jut)+rmass(id5)*u512_34(i3,i4
     & )%c(2,jut)
      u5_1234(i1,i2,i3,i4)%c(iut,jut)=u5_1234(i1,i2,i3,i4)%c(iut
     & ,jut)+l5_12(i1,i2)%a(iut,1)*cw1+l5_12(i1,i2)%c(iut,1)*cz1
     & +l5_12(i1,i2)%a(iut,2)*cw2+l5_12(i1,i2)%c(iut,2)*cz2
      u5_1234(i1,i2,i3,i4)%d(iut,jut)=u5_1234(i1,i2,i3,i4)%d(iut
     & ,jut)+l5_12(i1,i2)%b(iut,1)*cw1+l5_12(i1,i2)%d(iut,1)*cz1
     & +l5_12(i1,i2)%b(iut,2)*cw2+l5_12(i1,i2)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id5.eq.5.and.id1.eq.5.and.id3.ne.5)then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=u5_1234(i1,i2,i3,i4)%a,bb=u5_1234(i1,i2,i3,i4)%b,cc=u5_1234(
* i1,i2,i3,i4)%c,dd=u5_1234(i1,i2,i3,i4)%d,a1=l5_12(i1,i2)%a,b1=l5_12(i1
* ,i2)%b,c1=l5_12(i1,i2)%c,d1=l5_12(i1,i2)%d,a2=u512_34(i3,i4)%a,b2=u512
* _34(i3,i4)%b,c2=u512_34(i3,i4)%c,d2=u512_34(i3,i4)%d,prq=p512q,m=rmass
* (id5),nsum=1
      do iut=1,2
      cx1=l5_12(i1,i2)%a(iut,1)+l5_12(i1,i2)%c(iut,1)*rmass(id5)
      cx2=l5_12(i1,i2)%c(iut,2)*p512q+l5_12(i1,i2)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_12(i1,i2)%b(iut,1)+l5_12(i1,i2)%d(iut,1)*rmass(id5)
      cy2=l5_12(i1,i2)%d(iut,2)*p512q+l5_12(i1,i2)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_12(i1,i2)%c(iut,1)*p512q+l5_12(i1,i2)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_12(i1,i2)%a(iut,2)+l5_12(i1,i2)%c(iut,2)*rmass(id5)
      cz1=l5_12(i1,i2)%d(iut,1)*p512q+l5_12(i1,i2)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_12(i1,i2)%b(iut,2)+l5_12(i1,i2)%d(iut,2)*rmass(id5)
      u5_1234(i1,i2,i3,i4)%a(iut,1)=u5_1234(i1,i2,i3,i4)%a(iut,1
     & )+cx1*u512_34(i3,i4)%a(1,1)+cx2*u512_34(i3,i4)%b(2,1)
      u5_1234(i1,i2,i3,i4)%b(iut,1)=u5_1234(i1,i2,i3,i4)%b(iut,1
     & )+cy1*u512_34(i3,i4)%a(1,1)+cy2*u512_34(i3,i4)%b(2,1)
      u5_1234(i1,i2,i3,i4)%c(iut,1)=u5_1234(i1,i2,i3,i4)%c(iut,1
     & )+cw1*u512_34(i3,i4)%d(1,1)+cw2*u512_34(i3,i4)%c(2,1)
      u5_1234(i1,i2,i3,i4)%d(iut,1)=u5_1234(i1,i2,i3,i4)%d(iut,1
     & )+cz1*u512_34(i3,i4)%d(1,1)+cz2*u512_34(i3,i4)%c(2,1)
      u5_1234(i1,i2,i3,i4)%a(iut,2)=u5_1234(i1,i2,i3,i4)%a(iut,2
     & )+cw1*u512_34(i3,i4)%b(1,2)+cw2*u512_34(i3,i4)%a(2,2)
      u5_1234(i1,i2,i3,i4)%b(iut,2)=u5_1234(i1,i2,i3,i4)%b(iut,2
     & )+cz1*u512_34(i3,i4)%b(1,2)+cz2*u512_34(i3,i4)%a(2,2)
      u5_1234(i1,i2,i3,i4)%c(iut,2)=u5_1234(i1,i2,i3,i4)%c(iut,2
     & )+cx1*u512_34(i3,i4)%c(1,2)+cx2*u512_34(i3,i4)%d(2,2)
      u5_1234(i1,i2,i3,i4)%d(iut,2)=u5_1234(i1,i2,i3,i4)%d(iut,2
     & )+cy1*u512_34(i3,i4)%c(1,2)+cy2*u512_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id5.eq.5.and.id1.ne.5.and.id3.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TTs -- aa=u5_1234(i1,i2,i3,i4)%a,bb=u5_1234(i1,i2,i3,i4)%b,cc=u5_1234(
* i1,i2,i3,i4)%c,dd=u5_1234(i1,i2,i3,i4)%d,a1=l5_12(i1,i2)%a,b1=l5_12(i1
* ,i2)%b,c1=l5_12(i1,i2)%c,d1=l5_12(i1,i2)%d,a2=u512_34(i3,i4)%a,b2=u512
* _34(i3,i4)%b,c2=u512_34(i3,i4)%c,d2=u512_34(i3,i4)%d,prq=p512q,m=rmass
* (id5),nsum=1
      do jut=1,2
      cx1=u512_34(i3,i4)%a(1,jut)+rmass(id5)*u512_34(i3,i4)%b(1,
     & jut)
      cx2=u512_34(i3,i4)%a(2,jut)+rmass(id5)*u512_34(i3,i4)%b(2,
     & jut)
      cy1=p512q*u512_34(i3,i4)%b(1,jut)+rmass(id5)*u512_34(i3,i4
     & )%a(1,jut)
      cy2=p512q*u512_34(i3,i4)%b(2,jut)+rmass(id5)*u512_34(i3,i4
     & )%a(2,jut)
      cw1=u512_34(i3,i4)%c(1,jut)+rmass(id5)*u512_34(i3,i4)%d(1,
     & jut)
      cw2=u512_34(i3,i4)%c(2,jut)+rmass(id5)*u512_34(i3,i4)%d(2,
     & jut)
      cz1=p512q*u512_34(i3,i4)%d(1,jut)+rmass(id5)*u512_34(i3,i4
     & )%c(1,jut)
      cz2=p512q*u512_34(i3,i4)%d(2,jut)+rmass(id5)*u512_34(i3,i4
     & )%c(2,jut)
      u5_1234(i1,i2,i3,i4)%a(1,jut)=u5_1234(i1,i2,i3,i4)%a(1,jut
     & )+l5_12(i1,i2)%a(1,1)*cx1+l5_12(i1,i2)%c(1,2)*cy2
      u5_1234(i1,i2,i3,i4)%b(1,jut)=u5_1234(i1,i2,i3,i4)%b(1,jut
     & )+l5_12(i1,i2)%d(1,1)*cy1+l5_12(i1,i2)%b(1,2)*cx2
      u5_1234(i1,i2,i3,i4)%c(1,jut)=u5_1234(i1,i2,i3,i4)%c(1,jut
     & )+l5_12(i1,i2)%a(1,1)*cw1+l5_12(i1,i2)%c(1,2)*cz2
      u5_1234(i1,i2,i3,i4)%d(1,jut)=u5_1234(i1,i2,i3,i4)%d(1,jut
     & )+l5_12(i1,i2)%d(1,1)*cz1+l5_12(i1,i2)%b(1,2)*cw2
      u5_1234(i1,i2,i3,i4)%a(2,jut)=u5_1234(i1,i2,i3,i4)%a(2,jut
     & )+l5_12(i1,i2)%c(2,1)*cy1+l5_12(i1,i2)%a(2,2)*cx2
      u5_1234(i1,i2,i3,i4)%b(2,jut)=u5_1234(i1,i2,i3,i4)%b(2,jut
     & )+l5_12(i1,i2)%b(2,1)*cx1+l5_12(i1,i2)%d(2,2)*cy2
      u5_1234(i1,i2,i3,i4)%c(2,jut)=u5_1234(i1,i2,i3,i4)%c(2,jut
     & )+l5_12(i1,i2)%c(2,1)*cz1+l5_12(i1,i2)%a(2,2)*cw2
      u5_1234(i1,i2,i3,i4)%d(2,jut)=u5_1234(i1,i2,i3,i4)%d(2,jut
     & )+l5_12(i1,i2)%b(2,1)*cw1+l5_12(i1,i2)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p534q,p=p534,q=p534,bef=,aft=
      p534q=(p534(0)*p534(0)-p534(1)*p534(1)-p534(2)*p534(2)-p53
     & 4(3)*p534(3))
  
      if(id5.ne.5.or.(id3.ne.5.and.id1.ne.5))then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=u5_1234(i1,i2,i3,i4)%a,bb=u5_1234(i1,i2,i3,i4)%b,cc=u5_1234(i
* 1,i2,i3,i4)%c,dd=u5_1234(i1,i2,i3,i4)%d,a1=l5_34(i3,i4)%a,b1=l5_34(i3,
* i4)%b,c1=l5_34(i3,i4)%c,d1=l5_34(i3,i4)%d,a2=u534_12(i1,i2)%a,b2=u534_
* 12(i1,i2)%b,c2=u534_12(i1,i2)%c,d2=u534_12(i1,i2)%d,prq=p534q,m=rmass(
* id5),nsum=1
      u5_1234(i1,i2,i3,i4)%a(1,1)=u5_1234(i1,i2,i3,i4)%a(1,1)+l5
     & _34(i3,i4)%a(1,1)*u534_12(i1,i2)%a(1,1)+l5_34(i3,i4)%c(1,
     & 2)*p534q*u534_12(i1,i2)%b(2,1)
      u5_1234(i1,i2,i3,i4)%b(1,1)=u5_1234(i1,i2,i3,i4)%b(1,1)+rm
     & ass(id5)*(l5_34(i3,i4)%d(1,1)*u534_12(i1,i2)%a(1,1)+l5_34
     & (i3,i4)%b(1,2)*u534_12(i1,i2)%b(2,1))
      u5_1234(i1,i2,i3,i4)%c(1,1)=u5_1234(i1,i2,i3,i4)%c(1,1)+rm
     & ass(id5)*(l5_34(i3,i4)%a(1,1)*u534_12(i1,i2)%d(1,1)+l5_34
     & (i3,i4)%c(1,2)*u534_12(i1,i2)%c(2,1))
      u5_1234(i1,i2,i3,i4)%d(1,1)=u5_1234(i1,i2,i3,i4)%d(1,1)+l5
     & _34(i3,i4)%d(1,1)*p534q*u534_12(i1,i2)%d(1,1)+l5_34(i3,i4
     & )%b(1,2)*u534_12(i1,i2)%c(2,1)
      u5_1234(i1,i2,i3,i4)%a(1,2)=u5_1234(i1,i2,i3,i4)%a(1,2)+rm
     & ass(id5)*(l5_34(i3,i4)%a(1,1)*u534_12(i1,i2)%b(1,2)+l5_34
     & (i3,i4)%c(1,2)*u534_12(i1,i2)%a(2,2))
      u5_1234(i1,i2,i3,i4)%b(1,2)=u5_1234(i1,i2,i3,i4)%b(1,2)+l5
     & _34(i3,i4)%d(1,1)*p534q*u534_12(i1,i2)%b(1,2)+l5_34(i3,i4
     & )%b(1,2)*u534_12(i1,i2)%a(2,2)
      u5_1234(i1,i2,i3,i4)%c(1,2)=u5_1234(i1,i2,i3,i4)%c(1,2)+l5
     & _34(i3,i4)%a(1,1)*u534_12(i1,i2)%c(1,2)+l5_34(i3,i4)%c(1,
     & 2)*p534q*u534_12(i1,i2)%d(2,2)
      u5_1234(i1,i2,i3,i4)%d(1,2)=u5_1234(i1,i2,i3,i4)%d(1,2)+rm
     & ass(id5)*(l5_34(i3,i4)%d(1,1)*u534_12(i1,i2)%c(1,2)+l5_34
     & (i3,i4)%b(1,2)*u534_12(i1,i2)%d(2,2))
      u5_1234(i1,i2,i3,i4)%a(2,1)=u5_1234(i1,i2,i3,i4)%a(2,1)+rm
     & ass(id5)*(l5_34(i3,i4)%c(2,1)*u534_12(i1,i2)%a(1,1)+l5_34
     & (i3,i4)%a(2,2)*u534_12(i1,i2)%b(2,1))
      u5_1234(i1,i2,i3,i4)%b(2,1)=u5_1234(i1,i2,i3,i4)%b(2,1)+l5
     & _34(i3,i4)%b(2,1)*u534_12(i1,i2)%a(1,1)+l5_34(i3,i4)%d(2,
     & 2)*p534q*u534_12(i1,i2)%b(2,1)
      u5_1234(i1,i2,i3,i4)%c(2,1)=u5_1234(i1,i2,i3,i4)%c(2,1)+l5
     & _34(i3,i4)%c(2,1)*p534q*u534_12(i1,i2)%d(1,1)+l5_34(i3,i4
     & )%a(2,2)*u534_12(i1,i2)%c(2,1)
      u5_1234(i1,i2,i3,i4)%d(2,1)=u5_1234(i1,i2,i3,i4)%d(2,1)+rm
     & ass(id5)*(l5_34(i3,i4)%b(2,1)*u534_12(i1,i2)%d(1,1)+l5_34
     & (i3,i4)%d(2,2)*u534_12(i1,i2)%c(2,1))
      u5_1234(i1,i2,i3,i4)%a(2,2)=u5_1234(i1,i2,i3,i4)%a(2,2)+l5
     & _34(i3,i4)%c(2,1)*p534q*u534_12(i1,i2)%b(1,2)+l5_34(i3,i4
     & )%a(2,2)*u534_12(i1,i2)%a(2,2)
      u5_1234(i1,i2,i3,i4)%b(2,2)=u5_1234(i1,i2,i3,i4)%b(2,2)+rm
     & ass(id5)*(l5_34(i3,i4)%b(2,1)*u534_12(i1,i2)%b(1,2)+l5_34
     & (i3,i4)%d(2,2)*u534_12(i1,i2)%a(2,2))
      u5_1234(i1,i2,i3,i4)%c(2,2)=u5_1234(i1,i2,i3,i4)%c(2,2)+rm
     & ass(id5)*(l5_34(i3,i4)%c(2,1)*u534_12(i1,i2)%c(1,2)+l5_34
     & (i3,i4)%a(2,2)*u534_12(i1,i2)%d(2,2))
      u5_1234(i1,i2,i3,i4)%d(2,2)=u5_1234(i1,i2,i3,i4)%d(2,2)+l5
     & _34(i3,i4)%b(2,1)*u534_12(i1,i2)%c(1,2)+l5_34(i3,i4)%d(2,
     & 2)*p534q*u534_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id5.eq.5.and.id3.eq.5.and.id1.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TsTs -- aa=u5_1234(i1,i2,i3,i4)%a,bb=u5_1234(i1,i2,i3,i4)%b,cc=u5_1234
* (i1,i2,i3,i4)%c,dd=u5_1234(i1,i2,i3,i4)%d,a1=l5_34(i3,i4)%a,b1=l5_34(i
* 3,i4)%b,c1=l5_34(i3,i4)%c,d1=l5_34(i3,i4)%d,a2=u534_12(i1,i2)%a,b2=u53
* 4_12(i1,i2)%b,c2=u534_12(i1,i2)%c,d2=u534_12(i1,i2)%d,prq=p534q,m=rmas
* s(id5),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u534_12(i1,i2)%a(1,jut)+rmass(id5)*u534_12(i1,i2)%b(1,
     & jut)
      cx2=u534_12(i1,i2)%a(2,jut)+rmass(id5)*u534_12(i1,i2)%b(2,
     & jut)
      cy1=p534q*u534_12(i1,i2)%b(1,jut)+rmass(id5)*u534_12(i1,i2
     & )%a(1,jut)
      cy2=p534q*u534_12(i1,i2)%b(2,jut)+rmass(id5)*u534_12(i1,i2
     & )%a(2,jut)
      u5_1234(i1,i2,i3,i4)%a(iut,jut)=u5_1234(i1,i2,i3,i4)%a(iut
     & ,jut)+l5_34(i3,i4)%a(iut,1)*cx1+l5_34(i3,i4)%c(iut,1)*cy1
     & +l5_34(i3,i4)%a(iut,2)*cx2+l5_34(i3,i4)%c(iut,2)*cy2
      u5_1234(i1,i2,i3,i4)%b(iut,jut)=u5_1234(i1,i2,i3,i4)%b(iut
     & ,jut)+l5_34(i3,i4)%b(iut,1)*cx1+l5_34(i3,i4)%d(iut,1)*cy1
     & +l5_34(i3,i4)%b(iut,2)*cx2+l5_34(i3,i4)%d(iut,2)*cy2
      cw1=u534_12(i1,i2)%c(1,jut)+rmass(id5)*u534_12(i1,i2)%d(1,
     & jut)
      cw2=u534_12(i1,i2)%c(2,jut)+rmass(id5)*u534_12(i1,i2)%d(2,
     & jut)
      cz1=p534q*u534_12(i1,i2)%d(1,jut)+rmass(id5)*u534_12(i1,i2
     & )%c(1,jut)
      cz2=p534q*u534_12(i1,i2)%d(2,jut)+rmass(id5)*u534_12(i1,i2
     & )%c(2,jut)
      u5_1234(i1,i2,i3,i4)%c(iut,jut)=u5_1234(i1,i2,i3,i4)%c(iut
     & ,jut)+l5_34(i3,i4)%a(iut,1)*cw1+l5_34(i3,i4)%c(iut,1)*cz1
     & +l5_34(i3,i4)%a(iut,2)*cw2+l5_34(i3,i4)%c(iut,2)*cz2
      u5_1234(i1,i2,i3,i4)%d(iut,jut)=u5_1234(i1,i2,i3,i4)%d(iut
     & ,jut)+l5_34(i3,i4)%b(iut,1)*cw1+l5_34(i3,i4)%d(iut,1)*cz1
     & +l5_34(i3,i4)%b(iut,2)*cw2+l5_34(i3,i4)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id5.eq.5.and.id3.eq.5.and.id1.ne.5)then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=u5_1234(i1,i2,i3,i4)%a,bb=u5_1234(i1,i2,i3,i4)%b,cc=u5_1234(
* i1,i2,i3,i4)%c,dd=u5_1234(i1,i2,i3,i4)%d,a1=l5_34(i3,i4)%a,b1=l5_34(i3
* ,i4)%b,c1=l5_34(i3,i4)%c,d1=l5_34(i3,i4)%d,a2=u534_12(i1,i2)%a,b2=u534
* _12(i1,i2)%b,c2=u534_12(i1,i2)%c,d2=u534_12(i1,i2)%d,prq=p534q,m=rmass
* (id5),nsum=1
      do iut=1,2
      cx1=l5_34(i3,i4)%a(iut,1)+l5_34(i3,i4)%c(iut,1)*rmass(id5)
      cx2=l5_34(i3,i4)%c(iut,2)*p534q+l5_34(i3,i4)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_34(i3,i4)%b(iut,1)+l5_34(i3,i4)%d(iut,1)*rmass(id5)
      cy2=l5_34(i3,i4)%d(iut,2)*p534q+l5_34(i3,i4)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_34(i3,i4)%c(iut,1)*p534q+l5_34(i3,i4)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_34(i3,i4)%a(iut,2)+l5_34(i3,i4)%c(iut,2)*rmass(id5)
      cz1=l5_34(i3,i4)%d(iut,1)*p534q+l5_34(i3,i4)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_34(i3,i4)%b(iut,2)+l5_34(i3,i4)%d(iut,2)*rmass(id5)
      u5_1234(i1,i2,i3,i4)%a(iut,1)=u5_1234(i1,i2,i3,i4)%a(iut,1
     & )+cx1*u534_12(i1,i2)%a(1,1)+cx2*u534_12(i1,i2)%b(2,1)
      u5_1234(i1,i2,i3,i4)%b(iut,1)=u5_1234(i1,i2,i3,i4)%b(iut,1
     & )+cy1*u534_12(i1,i2)%a(1,1)+cy2*u534_12(i1,i2)%b(2,1)
      u5_1234(i1,i2,i3,i4)%c(iut,1)=u5_1234(i1,i2,i3,i4)%c(iut,1
     & )+cw1*u534_12(i1,i2)%d(1,1)+cw2*u534_12(i1,i2)%c(2,1)
      u5_1234(i1,i2,i3,i4)%d(iut,1)=u5_1234(i1,i2,i3,i4)%d(iut,1
     & )+cz1*u534_12(i1,i2)%d(1,1)+cz2*u534_12(i1,i2)%c(2,1)
      u5_1234(i1,i2,i3,i4)%a(iut,2)=u5_1234(i1,i2,i3,i4)%a(iut,2
     & )+cw1*u534_12(i1,i2)%b(1,2)+cw2*u534_12(i1,i2)%a(2,2)
      u5_1234(i1,i2,i3,i4)%b(iut,2)=u5_1234(i1,i2,i3,i4)%b(iut,2
     & )+cz1*u534_12(i1,i2)%b(1,2)+cz2*u534_12(i1,i2)%a(2,2)
      u5_1234(i1,i2,i3,i4)%c(iut,2)=u5_1234(i1,i2,i3,i4)%c(iut,2
     & )+cx1*u534_12(i1,i2)%c(1,2)+cx2*u534_12(i1,i2)%d(2,2)
      u5_1234(i1,i2,i3,i4)%d(iut,2)=u5_1234(i1,i2,i3,i4)%d(iut,2
     & )+cy1*u534_12(i1,i2)%c(1,2)+cy2*u534_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id5.eq.5.and.id3.ne.5.and.id1.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TTs -- aa=u5_1234(i1,i2,i3,i4)%a,bb=u5_1234(i1,i2,i3,i4)%b,cc=u5_1234(
* i1,i2,i3,i4)%c,dd=u5_1234(i1,i2,i3,i4)%d,a1=l5_34(i3,i4)%a,b1=l5_34(i3
* ,i4)%b,c1=l5_34(i3,i4)%c,d1=l5_34(i3,i4)%d,a2=u534_12(i1,i2)%a,b2=u534
* _12(i1,i2)%b,c2=u534_12(i1,i2)%c,d2=u534_12(i1,i2)%d,prq=p534q,m=rmass
* (id5),nsum=1
      do jut=1,2
      cx1=u534_12(i1,i2)%a(1,jut)+rmass(id5)*u534_12(i1,i2)%b(1,
     & jut)
      cx2=u534_12(i1,i2)%a(2,jut)+rmass(id5)*u534_12(i1,i2)%b(2,
     & jut)
      cy1=p534q*u534_12(i1,i2)%b(1,jut)+rmass(id5)*u534_12(i1,i2
     & )%a(1,jut)
      cy2=p534q*u534_12(i1,i2)%b(2,jut)+rmass(id5)*u534_12(i1,i2
     & )%a(2,jut)
      cw1=u534_12(i1,i2)%c(1,jut)+rmass(id5)*u534_12(i1,i2)%d(1,
     & jut)
      cw2=u534_12(i1,i2)%c(2,jut)+rmass(id5)*u534_12(i1,i2)%d(2,
     & jut)
      cz1=p534q*u534_12(i1,i2)%d(1,jut)+rmass(id5)*u534_12(i1,i2
     & )%c(1,jut)
      cz2=p534q*u534_12(i1,i2)%d(2,jut)+rmass(id5)*u534_12(i1,i2
     & )%c(2,jut)
      u5_1234(i1,i2,i3,i4)%a(1,jut)=u5_1234(i1,i2,i3,i4)%a(1,jut
     & )+l5_34(i3,i4)%a(1,1)*cx1+l5_34(i3,i4)%c(1,2)*cy2
      u5_1234(i1,i2,i3,i4)%b(1,jut)=u5_1234(i1,i2,i3,i4)%b(1,jut
     & )+l5_34(i3,i4)%d(1,1)*cy1+l5_34(i3,i4)%b(1,2)*cx2
      u5_1234(i1,i2,i3,i4)%c(1,jut)=u5_1234(i1,i2,i3,i4)%c(1,jut
     & )+l5_34(i3,i4)%a(1,1)*cw1+l5_34(i3,i4)%c(1,2)*cz2
      u5_1234(i1,i2,i3,i4)%d(1,jut)=u5_1234(i1,i2,i3,i4)%d(1,jut
     & )+l5_34(i3,i4)%d(1,1)*cz1+l5_34(i3,i4)%b(1,2)*cw2
      u5_1234(i1,i2,i3,i4)%a(2,jut)=u5_1234(i1,i2,i3,i4)%a(2,jut
     & )+l5_34(i3,i4)%c(2,1)*cy1+l5_34(i3,i4)%a(2,2)*cx2
      u5_1234(i1,i2,i3,i4)%b(2,jut)=u5_1234(i1,i2,i3,i4)%b(2,jut
     & )+l5_34(i3,i4)%b(2,1)*cx1+l5_34(i3,i4)%d(2,2)*cy2
      u5_1234(i1,i2,i3,i4)%c(2,jut)=u5_1234(i1,i2,i3,i4)%c(2,jut
     & )+l5_34(i3,i4)%c(2,1)*cz1+l5_34(i3,i4)%a(2,2)*cw2
      u5_1234(i1,i2,i3,i4)%d(2,jut)=u5_1234(i1,i2,i3,i4)%d(2,jut
     & )+l5_34(i3,i4)%b(2,1)*cw1+l5_34(i3,i4)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p512q,p=p512,q=p512,bef=,aft=
      p512q=(p512(0)*p512(0)-p512(1)*p512(1)-p512(2)*p512(2)-p51
     & 2(3)*p512(3))
  
      if(id5.ne.5.or.(id1.ne.5.and.id7.ne.5))then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=u5_1278(i1,i2,i7,i8)%a,bb=u5_1278(i1,i2,i7,i8)%b,cc=u5_1278(i
* 1,i2,i7,i8)%c,dd=u5_1278(i1,i2,i7,i8)%d,a1=l5_12(i1,i2)%a,b1=l5_12(i1,
* i2)%b,c1=l5_12(i1,i2)%c,d1=l5_12(i1,i2)%d,a2=u512_78(i7,i8)%a,b2=u512_
* 78(i7,i8)%b,c2=u512_78(i7,i8)%c,d2=u512_78(i7,i8)%d,prq=p512q,m=rmass(
* id5),nsum=1
      u5_1278(i1,i2,i7,i8)%a(1,1)=u5_1278(i1,i2,i7,i8)%a(1,1)+l5
     & _12(i1,i2)%a(1,1)*u512_78(i7,i8)%a(1,1)+l5_12(i1,i2)%c(1,
     & 2)*p512q*u512_78(i7,i8)%b(2,1)
      u5_1278(i1,i2,i7,i8)%b(1,1)=u5_1278(i1,i2,i7,i8)%b(1,1)+rm
     & ass(id5)*(l5_12(i1,i2)%d(1,1)*u512_78(i7,i8)%a(1,1)+l5_12
     & (i1,i2)%b(1,2)*u512_78(i7,i8)%b(2,1))
      u5_1278(i1,i2,i7,i8)%c(1,1)=u5_1278(i1,i2,i7,i8)%c(1,1)+rm
     & ass(id5)*(l5_12(i1,i2)%a(1,1)*u512_78(i7,i8)%d(1,1)+l5_12
     & (i1,i2)%c(1,2)*u512_78(i7,i8)%c(2,1))
      u5_1278(i1,i2,i7,i8)%d(1,1)=u5_1278(i1,i2,i7,i8)%d(1,1)+l5
     & _12(i1,i2)%d(1,1)*p512q*u512_78(i7,i8)%d(1,1)+l5_12(i1,i2
     & )%b(1,2)*u512_78(i7,i8)%c(2,1)
      u5_1278(i1,i2,i7,i8)%a(1,2)=u5_1278(i1,i2,i7,i8)%a(1,2)+rm
     & ass(id5)*(l5_12(i1,i2)%a(1,1)*u512_78(i7,i8)%b(1,2)+l5_12
     & (i1,i2)%c(1,2)*u512_78(i7,i8)%a(2,2))
      u5_1278(i1,i2,i7,i8)%b(1,2)=u5_1278(i1,i2,i7,i8)%b(1,2)+l5
     & _12(i1,i2)%d(1,1)*p512q*u512_78(i7,i8)%b(1,2)+l5_12(i1,i2
     & )%b(1,2)*u512_78(i7,i8)%a(2,2)
      u5_1278(i1,i2,i7,i8)%c(1,2)=u5_1278(i1,i2,i7,i8)%c(1,2)+l5
     & _12(i1,i2)%a(1,1)*u512_78(i7,i8)%c(1,2)+l5_12(i1,i2)%c(1,
     & 2)*p512q*u512_78(i7,i8)%d(2,2)
      u5_1278(i1,i2,i7,i8)%d(1,2)=u5_1278(i1,i2,i7,i8)%d(1,2)+rm
     & ass(id5)*(l5_12(i1,i2)%d(1,1)*u512_78(i7,i8)%c(1,2)+l5_12
     & (i1,i2)%b(1,2)*u512_78(i7,i8)%d(2,2))
      u5_1278(i1,i2,i7,i8)%a(2,1)=u5_1278(i1,i2,i7,i8)%a(2,1)+rm
     & ass(id5)*(l5_12(i1,i2)%c(2,1)*u512_78(i7,i8)%a(1,1)+l5_12
     & (i1,i2)%a(2,2)*u512_78(i7,i8)%b(2,1))
      u5_1278(i1,i2,i7,i8)%b(2,1)=u5_1278(i1,i2,i7,i8)%b(2,1)+l5
     & _12(i1,i2)%b(2,1)*u512_78(i7,i8)%a(1,1)+l5_12(i1,i2)%d(2,
     & 2)*p512q*u512_78(i7,i8)%b(2,1)
      u5_1278(i1,i2,i7,i8)%c(2,1)=u5_1278(i1,i2,i7,i8)%c(2,1)+l5
     & _12(i1,i2)%c(2,1)*p512q*u512_78(i7,i8)%d(1,1)+l5_12(i1,i2
     & )%a(2,2)*u512_78(i7,i8)%c(2,1)
      u5_1278(i1,i2,i7,i8)%d(2,1)=u5_1278(i1,i2,i7,i8)%d(2,1)+rm
     & ass(id5)*(l5_12(i1,i2)%b(2,1)*u512_78(i7,i8)%d(1,1)+l5_12
     & (i1,i2)%d(2,2)*u512_78(i7,i8)%c(2,1))
      u5_1278(i1,i2,i7,i8)%a(2,2)=u5_1278(i1,i2,i7,i8)%a(2,2)+l5
     & _12(i1,i2)%c(2,1)*p512q*u512_78(i7,i8)%b(1,2)+l5_12(i1,i2
     & )%a(2,2)*u512_78(i7,i8)%a(2,2)
      u5_1278(i1,i2,i7,i8)%b(2,2)=u5_1278(i1,i2,i7,i8)%b(2,2)+rm
     & ass(id5)*(l5_12(i1,i2)%b(2,1)*u512_78(i7,i8)%b(1,2)+l5_12
     & (i1,i2)%d(2,2)*u512_78(i7,i8)%a(2,2))
      u5_1278(i1,i2,i7,i8)%c(2,2)=u5_1278(i1,i2,i7,i8)%c(2,2)+rm
     & ass(id5)*(l5_12(i1,i2)%c(2,1)*u512_78(i7,i8)%c(1,2)+l5_12
     & (i1,i2)%a(2,2)*u512_78(i7,i8)%d(2,2))
      u5_1278(i1,i2,i7,i8)%d(2,2)=u5_1278(i1,i2,i7,i8)%d(2,2)+l5
     & _12(i1,i2)%b(2,1)*u512_78(i7,i8)%c(1,2)+l5_12(i1,i2)%d(2,
     & 2)*p512q*u512_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id5.eq.5.and.id1.eq.5.and.id7.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=u5_1278(i1,i2,i7,i8)%a,bb=u5_1278(i1,i2,i7,i8)%b,cc=u5_1278
* (i1,i2,i7,i8)%c,dd=u5_1278(i1,i2,i7,i8)%d,a1=l5_12(i1,i2)%a,b1=l5_12(i
* 1,i2)%b,c1=l5_12(i1,i2)%c,d1=l5_12(i1,i2)%d,a2=u512_78(i7,i8)%a,b2=u51
* 2_78(i7,i8)%b,c2=u512_78(i7,i8)%c,d2=u512_78(i7,i8)%d,prq=p512q,m=rmas
* s(id5),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u512_78(i7,i8)%a(1,jut)+rmass(id5)*u512_78(i7,i8)%b(1,
     & jut)
      cx2=u512_78(i7,i8)%a(2,jut)+rmass(id5)*u512_78(i7,i8)%b(2,
     & jut)
      cy1=p512q*u512_78(i7,i8)%b(1,jut)+rmass(id5)*u512_78(i7,i8
     & )%a(1,jut)
      cy2=p512q*u512_78(i7,i8)%b(2,jut)+rmass(id5)*u512_78(i7,i8
     & )%a(2,jut)
      u5_1278(i1,i2,i7,i8)%a(iut,jut)=u5_1278(i1,i2,i7,i8)%a(iut
     & ,jut)+l5_12(i1,i2)%a(iut,1)*cx1+l5_12(i1,i2)%c(iut,1)*cy1
     & +l5_12(i1,i2)%a(iut,2)*cx2+l5_12(i1,i2)%c(iut,2)*cy2
      u5_1278(i1,i2,i7,i8)%b(iut,jut)=u5_1278(i1,i2,i7,i8)%b(iut
     & ,jut)+l5_12(i1,i2)%b(iut,1)*cx1+l5_12(i1,i2)%d(iut,1)*cy1
     & +l5_12(i1,i2)%b(iut,2)*cx2+l5_12(i1,i2)%d(iut,2)*cy2
      cw1=u512_78(i7,i8)%c(1,jut)+rmass(id5)*u512_78(i7,i8)%d(1,
     & jut)
      cw2=u512_78(i7,i8)%c(2,jut)+rmass(id5)*u512_78(i7,i8)%d(2,
     & jut)
      cz1=p512q*u512_78(i7,i8)%d(1,jut)+rmass(id5)*u512_78(i7,i8
     & )%c(1,jut)
      cz2=p512q*u512_78(i7,i8)%d(2,jut)+rmass(id5)*u512_78(i7,i8
     & )%c(2,jut)
      u5_1278(i1,i2,i7,i8)%c(iut,jut)=u5_1278(i1,i2,i7,i8)%c(iut
     & ,jut)+l5_12(i1,i2)%a(iut,1)*cw1+l5_12(i1,i2)%c(iut,1)*cz1
     & +l5_12(i1,i2)%a(iut,2)*cw2+l5_12(i1,i2)%c(iut,2)*cz2
      u5_1278(i1,i2,i7,i8)%d(iut,jut)=u5_1278(i1,i2,i7,i8)%d(iut
     & ,jut)+l5_12(i1,i2)%b(iut,1)*cw1+l5_12(i1,i2)%d(iut,1)*cz1
     & +l5_12(i1,i2)%b(iut,2)*cw2+l5_12(i1,i2)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id5.eq.5.and.id1.eq.5.and.id7.ne.5)then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=u5_1278(i1,i2,i7,i8)%a,bb=u5_1278(i1,i2,i7,i8)%b,cc=u5_1278(
* i1,i2,i7,i8)%c,dd=u5_1278(i1,i2,i7,i8)%d,a1=l5_12(i1,i2)%a,b1=l5_12(i1
* ,i2)%b,c1=l5_12(i1,i2)%c,d1=l5_12(i1,i2)%d,a2=u512_78(i7,i8)%a,b2=u512
* _78(i7,i8)%b,c2=u512_78(i7,i8)%c,d2=u512_78(i7,i8)%d,prq=p512q,m=rmass
* (id5),nsum=1
      do iut=1,2
      cx1=l5_12(i1,i2)%a(iut,1)+l5_12(i1,i2)%c(iut,1)*rmass(id5)
      cx2=l5_12(i1,i2)%c(iut,2)*p512q+l5_12(i1,i2)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_12(i1,i2)%b(iut,1)+l5_12(i1,i2)%d(iut,1)*rmass(id5)
      cy2=l5_12(i1,i2)%d(iut,2)*p512q+l5_12(i1,i2)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_12(i1,i2)%c(iut,1)*p512q+l5_12(i1,i2)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_12(i1,i2)%a(iut,2)+l5_12(i1,i2)%c(iut,2)*rmass(id5)
      cz1=l5_12(i1,i2)%d(iut,1)*p512q+l5_12(i1,i2)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_12(i1,i2)%b(iut,2)+l5_12(i1,i2)%d(iut,2)*rmass(id5)
      u5_1278(i1,i2,i7,i8)%a(iut,1)=u5_1278(i1,i2,i7,i8)%a(iut,1
     & )+cx1*u512_78(i7,i8)%a(1,1)+cx2*u512_78(i7,i8)%b(2,1)
      u5_1278(i1,i2,i7,i8)%b(iut,1)=u5_1278(i1,i2,i7,i8)%b(iut,1
     & )+cy1*u512_78(i7,i8)%a(1,1)+cy2*u512_78(i7,i8)%b(2,1)
      u5_1278(i1,i2,i7,i8)%c(iut,1)=u5_1278(i1,i2,i7,i8)%c(iut,1
     & )+cw1*u512_78(i7,i8)%d(1,1)+cw2*u512_78(i7,i8)%c(2,1)
      u5_1278(i1,i2,i7,i8)%d(iut,1)=u5_1278(i1,i2,i7,i8)%d(iut,1
     & )+cz1*u512_78(i7,i8)%d(1,1)+cz2*u512_78(i7,i8)%c(2,1)
      u5_1278(i1,i2,i7,i8)%a(iut,2)=u5_1278(i1,i2,i7,i8)%a(iut,2
     & )+cw1*u512_78(i7,i8)%b(1,2)+cw2*u512_78(i7,i8)%a(2,2)
      u5_1278(i1,i2,i7,i8)%b(iut,2)=u5_1278(i1,i2,i7,i8)%b(iut,2
     & )+cz1*u512_78(i7,i8)%b(1,2)+cz2*u512_78(i7,i8)%a(2,2)
      u5_1278(i1,i2,i7,i8)%c(iut,2)=u5_1278(i1,i2,i7,i8)%c(iut,2
     & )+cx1*u512_78(i7,i8)%c(1,2)+cx2*u512_78(i7,i8)%d(2,2)
      u5_1278(i1,i2,i7,i8)%d(iut,2)=u5_1278(i1,i2,i7,i8)%d(iut,2
     & )+cy1*u512_78(i7,i8)%c(1,2)+cy2*u512_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id5.eq.5.and.id1.ne.5.and.id7.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=u5_1278(i1,i2,i7,i8)%a,bb=u5_1278(i1,i2,i7,i8)%b,cc=u5_1278(
* i1,i2,i7,i8)%c,dd=u5_1278(i1,i2,i7,i8)%d,a1=l5_12(i1,i2)%a,b1=l5_12(i1
* ,i2)%b,c1=l5_12(i1,i2)%c,d1=l5_12(i1,i2)%d,a2=u512_78(i7,i8)%a,b2=u512
* _78(i7,i8)%b,c2=u512_78(i7,i8)%c,d2=u512_78(i7,i8)%d,prq=p512q,m=rmass
* (id5),nsum=1
      do jut=1,2
      cx1=u512_78(i7,i8)%a(1,jut)+rmass(id5)*u512_78(i7,i8)%b(1,
     & jut)
      cx2=u512_78(i7,i8)%a(2,jut)+rmass(id5)*u512_78(i7,i8)%b(2,
     & jut)
      cy1=p512q*u512_78(i7,i8)%b(1,jut)+rmass(id5)*u512_78(i7,i8
     & )%a(1,jut)
      cy2=p512q*u512_78(i7,i8)%b(2,jut)+rmass(id5)*u512_78(i7,i8
     & )%a(2,jut)
      cw1=u512_78(i7,i8)%c(1,jut)+rmass(id5)*u512_78(i7,i8)%d(1,
     & jut)
      cw2=u512_78(i7,i8)%c(2,jut)+rmass(id5)*u512_78(i7,i8)%d(2,
     & jut)
      cz1=p512q*u512_78(i7,i8)%d(1,jut)+rmass(id5)*u512_78(i7,i8
     & )%c(1,jut)
      cz2=p512q*u512_78(i7,i8)%d(2,jut)+rmass(id5)*u512_78(i7,i8
     & )%c(2,jut)
      u5_1278(i1,i2,i7,i8)%a(1,jut)=u5_1278(i1,i2,i7,i8)%a(1,jut
     & )+l5_12(i1,i2)%a(1,1)*cx1+l5_12(i1,i2)%c(1,2)*cy2
      u5_1278(i1,i2,i7,i8)%b(1,jut)=u5_1278(i1,i2,i7,i8)%b(1,jut
     & )+l5_12(i1,i2)%d(1,1)*cy1+l5_12(i1,i2)%b(1,2)*cx2
      u5_1278(i1,i2,i7,i8)%c(1,jut)=u5_1278(i1,i2,i7,i8)%c(1,jut
     & )+l5_12(i1,i2)%a(1,1)*cw1+l5_12(i1,i2)%c(1,2)*cz2
      u5_1278(i1,i2,i7,i8)%d(1,jut)=u5_1278(i1,i2,i7,i8)%d(1,jut
     & )+l5_12(i1,i2)%d(1,1)*cz1+l5_12(i1,i2)%b(1,2)*cw2
      u5_1278(i1,i2,i7,i8)%a(2,jut)=u5_1278(i1,i2,i7,i8)%a(2,jut
     & )+l5_12(i1,i2)%c(2,1)*cy1+l5_12(i1,i2)%a(2,2)*cx2
      u5_1278(i1,i2,i7,i8)%b(2,jut)=u5_1278(i1,i2,i7,i8)%b(2,jut
     & )+l5_12(i1,i2)%b(2,1)*cx1+l5_12(i1,i2)%d(2,2)*cy2
      u5_1278(i1,i2,i7,i8)%c(2,jut)=u5_1278(i1,i2,i7,i8)%c(2,jut
     & )+l5_12(i1,i2)%c(2,1)*cz1+l5_12(i1,i2)%a(2,2)*cw2
      u5_1278(i1,i2,i7,i8)%d(2,jut)=u5_1278(i1,i2,i7,i8)%d(2,jut
     & )+l5_12(i1,i2)%b(2,1)*cw1+l5_12(i1,i2)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p578q,p=p578,q=p578,bef=,aft=
      p578q=(p578(0)*p578(0)-p578(1)*p578(1)-p578(2)*p578(2)-p57
     & 8(3)*p578(3))
  
      if(id5.ne.5.or.(id7.ne.5.and.id1.ne.5))then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=u5_1278(i1,i2,i7,i8)%a,bb=u5_1278(i1,i2,i7,i8)%b,cc=u5_1278(i
* 1,i2,i7,i8)%c,dd=u5_1278(i1,i2,i7,i8)%d,a1=l5_78(i7,i8)%a,b1=l5_78(i7,
* i8)%b,c1=l5_78(i7,i8)%c,d1=l5_78(i7,i8)%d,a2=u578_12(i1,i2)%a,b2=u578_
* 12(i1,i2)%b,c2=u578_12(i1,i2)%c,d2=u578_12(i1,i2)%d,prq=p578q,m=rmass(
* id5),nsum=1
      u5_1278(i1,i2,i7,i8)%a(1,1)=u5_1278(i1,i2,i7,i8)%a(1,1)+l5
     & _78(i7,i8)%a(1,1)*u578_12(i1,i2)%a(1,1)+l5_78(i7,i8)%c(1,
     & 2)*p578q*u578_12(i1,i2)%b(2,1)
      u5_1278(i1,i2,i7,i8)%b(1,1)=u5_1278(i1,i2,i7,i8)%b(1,1)+rm
     & ass(id5)*(l5_78(i7,i8)%d(1,1)*u578_12(i1,i2)%a(1,1)+l5_78
     & (i7,i8)%b(1,2)*u578_12(i1,i2)%b(2,1))
      u5_1278(i1,i2,i7,i8)%c(1,1)=u5_1278(i1,i2,i7,i8)%c(1,1)+rm
     & ass(id5)*(l5_78(i7,i8)%a(1,1)*u578_12(i1,i2)%d(1,1)+l5_78
     & (i7,i8)%c(1,2)*u578_12(i1,i2)%c(2,1))
      u5_1278(i1,i2,i7,i8)%d(1,1)=u5_1278(i1,i2,i7,i8)%d(1,1)+l5
     & _78(i7,i8)%d(1,1)*p578q*u578_12(i1,i2)%d(1,1)+l5_78(i7,i8
     & )%b(1,2)*u578_12(i1,i2)%c(2,1)
      u5_1278(i1,i2,i7,i8)%a(1,2)=u5_1278(i1,i2,i7,i8)%a(1,2)+rm
     & ass(id5)*(l5_78(i7,i8)%a(1,1)*u578_12(i1,i2)%b(1,2)+l5_78
     & (i7,i8)%c(1,2)*u578_12(i1,i2)%a(2,2))
      u5_1278(i1,i2,i7,i8)%b(1,2)=u5_1278(i1,i2,i7,i8)%b(1,2)+l5
     & _78(i7,i8)%d(1,1)*p578q*u578_12(i1,i2)%b(1,2)+l5_78(i7,i8
     & )%b(1,2)*u578_12(i1,i2)%a(2,2)
      u5_1278(i1,i2,i7,i8)%c(1,2)=u5_1278(i1,i2,i7,i8)%c(1,2)+l5
     & _78(i7,i8)%a(1,1)*u578_12(i1,i2)%c(1,2)+l5_78(i7,i8)%c(1,
     & 2)*p578q*u578_12(i1,i2)%d(2,2)
      u5_1278(i1,i2,i7,i8)%d(1,2)=u5_1278(i1,i2,i7,i8)%d(1,2)+rm
     & ass(id5)*(l5_78(i7,i8)%d(1,1)*u578_12(i1,i2)%c(1,2)+l5_78
     & (i7,i8)%b(1,2)*u578_12(i1,i2)%d(2,2))
      u5_1278(i1,i2,i7,i8)%a(2,1)=u5_1278(i1,i2,i7,i8)%a(2,1)+rm
     & ass(id5)*(l5_78(i7,i8)%c(2,1)*u578_12(i1,i2)%a(1,1)+l5_78
     & (i7,i8)%a(2,2)*u578_12(i1,i2)%b(2,1))
      u5_1278(i1,i2,i7,i8)%b(2,1)=u5_1278(i1,i2,i7,i8)%b(2,1)+l5
     & _78(i7,i8)%b(2,1)*u578_12(i1,i2)%a(1,1)+l5_78(i7,i8)%d(2,
     & 2)*p578q*u578_12(i1,i2)%b(2,1)
      u5_1278(i1,i2,i7,i8)%c(2,1)=u5_1278(i1,i2,i7,i8)%c(2,1)+l5
     & _78(i7,i8)%c(2,1)*p578q*u578_12(i1,i2)%d(1,1)+l5_78(i7,i8
     & )%a(2,2)*u578_12(i1,i2)%c(2,1)
      u5_1278(i1,i2,i7,i8)%d(2,1)=u5_1278(i1,i2,i7,i8)%d(2,1)+rm
     & ass(id5)*(l5_78(i7,i8)%b(2,1)*u578_12(i1,i2)%d(1,1)+l5_78
     & (i7,i8)%d(2,2)*u578_12(i1,i2)%c(2,1))
      u5_1278(i1,i2,i7,i8)%a(2,2)=u5_1278(i1,i2,i7,i8)%a(2,2)+l5
     & _78(i7,i8)%c(2,1)*p578q*u578_12(i1,i2)%b(1,2)+l5_78(i7,i8
     & )%a(2,2)*u578_12(i1,i2)%a(2,2)
      u5_1278(i1,i2,i7,i8)%b(2,2)=u5_1278(i1,i2,i7,i8)%b(2,2)+rm
     & ass(id5)*(l5_78(i7,i8)%b(2,1)*u578_12(i1,i2)%b(1,2)+l5_78
     & (i7,i8)%d(2,2)*u578_12(i1,i2)%a(2,2))
      u5_1278(i1,i2,i7,i8)%c(2,2)=u5_1278(i1,i2,i7,i8)%c(2,2)+rm
     & ass(id5)*(l5_78(i7,i8)%c(2,1)*u578_12(i1,i2)%c(1,2)+l5_78
     & (i7,i8)%a(2,2)*u578_12(i1,i2)%d(2,2))
      u5_1278(i1,i2,i7,i8)%d(2,2)=u5_1278(i1,i2,i7,i8)%d(2,2)+l5
     & _78(i7,i8)%b(2,1)*u578_12(i1,i2)%c(1,2)+l5_78(i7,i8)%d(2,
     & 2)*p578q*u578_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id5.eq.5.and.id7.eq.5.and.id1.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=u5_1278(i1,i2,i7,i8)%a,bb=u5_1278(i1,i2,i7,i8)%b,cc=u5_1278
* (i1,i2,i7,i8)%c,dd=u5_1278(i1,i2,i7,i8)%d,a1=l5_78(i7,i8)%a,b1=l5_78(i
* 7,i8)%b,c1=l5_78(i7,i8)%c,d1=l5_78(i7,i8)%d,a2=u578_12(i1,i2)%a,b2=u57
* 8_12(i1,i2)%b,c2=u578_12(i1,i2)%c,d2=u578_12(i1,i2)%d,prq=p578q,m=rmas
* s(id5),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u578_12(i1,i2)%a(1,jut)+rmass(id5)*u578_12(i1,i2)%b(1,
     & jut)
      cx2=u578_12(i1,i2)%a(2,jut)+rmass(id5)*u578_12(i1,i2)%b(2,
     & jut)
      cy1=p578q*u578_12(i1,i2)%b(1,jut)+rmass(id5)*u578_12(i1,i2
     & )%a(1,jut)
      cy2=p578q*u578_12(i1,i2)%b(2,jut)+rmass(id5)*u578_12(i1,i2
     & )%a(2,jut)
      u5_1278(i1,i2,i7,i8)%a(iut,jut)=u5_1278(i1,i2,i7,i8)%a(iut
     & ,jut)+l5_78(i7,i8)%a(iut,1)*cx1+l5_78(i7,i8)%c(iut,1)*cy1
     & +l5_78(i7,i8)%a(iut,2)*cx2+l5_78(i7,i8)%c(iut,2)*cy2
      u5_1278(i1,i2,i7,i8)%b(iut,jut)=u5_1278(i1,i2,i7,i8)%b(iut
     & ,jut)+l5_78(i7,i8)%b(iut,1)*cx1+l5_78(i7,i8)%d(iut,1)*cy1
     & +l5_78(i7,i8)%b(iut,2)*cx2+l5_78(i7,i8)%d(iut,2)*cy2
      cw1=u578_12(i1,i2)%c(1,jut)+rmass(id5)*u578_12(i1,i2)%d(1,
     & jut)
      cw2=u578_12(i1,i2)%c(2,jut)+rmass(id5)*u578_12(i1,i2)%d(2,
     & jut)
      cz1=p578q*u578_12(i1,i2)%d(1,jut)+rmass(id5)*u578_12(i1,i2
     & )%c(1,jut)
      cz2=p578q*u578_12(i1,i2)%d(2,jut)+rmass(id5)*u578_12(i1,i2
     & )%c(2,jut)
      u5_1278(i1,i2,i7,i8)%c(iut,jut)=u5_1278(i1,i2,i7,i8)%c(iut
     & ,jut)+l5_78(i7,i8)%a(iut,1)*cw1+l5_78(i7,i8)%c(iut,1)*cz1
     & +l5_78(i7,i8)%a(iut,2)*cw2+l5_78(i7,i8)%c(iut,2)*cz2
      u5_1278(i1,i2,i7,i8)%d(iut,jut)=u5_1278(i1,i2,i7,i8)%d(iut
     & ,jut)+l5_78(i7,i8)%b(iut,1)*cw1+l5_78(i7,i8)%d(iut,1)*cz1
     & +l5_78(i7,i8)%b(iut,2)*cw2+l5_78(i7,i8)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id5.eq.5.and.id7.eq.5.and.id1.ne.5)then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=u5_1278(i1,i2,i7,i8)%a,bb=u5_1278(i1,i2,i7,i8)%b,cc=u5_1278(
* i1,i2,i7,i8)%c,dd=u5_1278(i1,i2,i7,i8)%d,a1=l5_78(i7,i8)%a,b1=l5_78(i7
* ,i8)%b,c1=l5_78(i7,i8)%c,d1=l5_78(i7,i8)%d,a2=u578_12(i1,i2)%a,b2=u578
* _12(i1,i2)%b,c2=u578_12(i1,i2)%c,d2=u578_12(i1,i2)%d,prq=p578q,m=rmass
* (id5),nsum=1
      do iut=1,2
      cx1=l5_78(i7,i8)%a(iut,1)+l5_78(i7,i8)%c(iut,1)*rmass(id5)
      cx2=l5_78(i7,i8)%c(iut,2)*p578q+l5_78(i7,i8)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_78(i7,i8)%b(iut,1)+l5_78(i7,i8)%d(iut,1)*rmass(id5)
      cy2=l5_78(i7,i8)%d(iut,2)*p578q+l5_78(i7,i8)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_78(i7,i8)%c(iut,1)*p578q+l5_78(i7,i8)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_78(i7,i8)%a(iut,2)+l5_78(i7,i8)%c(iut,2)*rmass(id5)
      cz1=l5_78(i7,i8)%d(iut,1)*p578q+l5_78(i7,i8)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_78(i7,i8)%b(iut,2)+l5_78(i7,i8)%d(iut,2)*rmass(id5)
      u5_1278(i1,i2,i7,i8)%a(iut,1)=u5_1278(i1,i2,i7,i8)%a(iut,1
     & )+cx1*u578_12(i1,i2)%a(1,1)+cx2*u578_12(i1,i2)%b(2,1)
      u5_1278(i1,i2,i7,i8)%b(iut,1)=u5_1278(i1,i2,i7,i8)%b(iut,1
     & )+cy1*u578_12(i1,i2)%a(1,1)+cy2*u578_12(i1,i2)%b(2,1)
      u5_1278(i1,i2,i7,i8)%c(iut,1)=u5_1278(i1,i2,i7,i8)%c(iut,1
     & )+cw1*u578_12(i1,i2)%d(1,1)+cw2*u578_12(i1,i2)%c(2,1)
      u5_1278(i1,i2,i7,i8)%d(iut,1)=u5_1278(i1,i2,i7,i8)%d(iut,1
     & )+cz1*u578_12(i1,i2)%d(1,1)+cz2*u578_12(i1,i2)%c(2,1)
      u5_1278(i1,i2,i7,i8)%a(iut,2)=u5_1278(i1,i2,i7,i8)%a(iut,2
     & )+cw1*u578_12(i1,i2)%b(1,2)+cw2*u578_12(i1,i2)%a(2,2)
      u5_1278(i1,i2,i7,i8)%b(iut,2)=u5_1278(i1,i2,i7,i8)%b(iut,2
     & )+cz1*u578_12(i1,i2)%b(1,2)+cz2*u578_12(i1,i2)%a(2,2)
      u5_1278(i1,i2,i7,i8)%c(iut,2)=u5_1278(i1,i2,i7,i8)%c(iut,2
     & )+cx1*u578_12(i1,i2)%c(1,2)+cx2*u578_12(i1,i2)%d(2,2)
      u5_1278(i1,i2,i7,i8)%d(iut,2)=u5_1278(i1,i2,i7,i8)%d(iut,2
     & )+cy1*u578_12(i1,i2)%c(1,2)+cy2*u578_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id5.eq.5.and.id7.ne.5.and.id1.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=u5_1278(i1,i2,i7,i8)%a,bb=u5_1278(i1,i2,i7,i8)%b,cc=u5_1278(
* i1,i2,i7,i8)%c,dd=u5_1278(i1,i2,i7,i8)%d,a1=l5_78(i7,i8)%a,b1=l5_78(i7
* ,i8)%b,c1=l5_78(i7,i8)%c,d1=l5_78(i7,i8)%d,a2=u578_12(i1,i2)%a,b2=u578
* _12(i1,i2)%b,c2=u578_12(i1,i2)%c,d2=u578_12(i1,i2)%d,prq=p578q,m=rmass
* (id5),nsum=1
      do jut=1,2
      cx1=u578_12(i1,i2)%a(1,jut)+rmass(id5)*u578_12(i1,i2)%b(1,
     & jut)
      cx2=u578_12(i1,i2)%a(2,jut)+rmass(id5)*u578_12(i1,i2)%b(2,
     & jut)
      cy1=p578q*u578_12(i1,i2)%b(1,jut)+rmass(id5)*u578_12(i1,i2
     & )%a(1,jut)
      cy2=p578q*u578_12(i1,i2)%b(2,jut)+rmass(id5)*u578_12(i1,i2
     & )%a(2,jut)
      cw1=u578_12(i1,i2)%c(1,jut)+rmass(id5)*u578_12(i1,i2)%d(1,
     & jut)
      cw2=u578_12(i1,i2)%c(2,jut)+rmass(id5)*u578_12(i1,i2)%d(2,
     & jut)
      cz1=p578q*u578_12(i1,i2)%d(1,jut)+rmass(id5)*u578_12(i1,i2
     & )%c(1,jut)
      cz2=p578q*u578_12(i1,i2)%d(2,jut)+rmass(id5)*u578_12(i1,i2
     & )%c(2,jut)
      u5_1278(i1,i2,i7,i8)%a(1,jut)=u5_1278(i1,i2,i7,i8)%a(1,jut
     & )+l5_78(i7,i8)%a(1,1)*cx1+l5_78(i7,i8)%c(1,2)*cy2
      u5_1278(i1,i2,i7,i8)%b(1,jut)=u5_1278(i1,i2,i7,i8)%b(1,jut
     & )+l5_78(i7,i8)%d(1,1)*cy1+l5_78(i7,i8)%b(1,2)*cx2
      u5_1278(i1,i2,i7,i8)%c(1,jut)=u5_1278(i1,i2,i7,i8)%c(1,jut
     & )+l5_78(i7,i8)%a(1,1)*cw1+l5_78(i7,i8)%c(1,2)*cz2
      u5_1278(i1,i2,i7,i8)%d(1,jut)=u5_1278(i1,i2,i7,i8)%d(1,jut
     & )+l5_78(i7,i8)%d(1,1)*cz1+l5_78(i7,i8)%b(1,2)*cw2
      u5_1278(i1,i2,i7,i8)%a(2,jut)=u5_1278(i1,i2,i7,i8)%a(2,jut
     & )+l5_78(i7,i8)%c(2,1)*cy1+l5_78(i7,i8)%a(2,2)*cx2
      u5_1278(i1,i2,i7,i8)%b(2,jut)=u5_1278(i1,i2,i7,i8)%b(2,jut
     & )+l5_78(i7,i8)%b(2,1)*cx1+l5_78(i7,i8)%d(2,2)*cy2
      u5_1278(i1,i2,i7,i8)%c(2,jut)=u5_1278(i1,i2,i7,i8)%c(2,jut
     & )+l5_78(i7,i8)%c(2,1)*cz1+l5_78(i7,i8)%a(2,2)*cw2
      u5_1278(i1,i2,i7,i8)%d(2,jut)=u5_1278(i1,i2,i7,i8)%d(2,jut
     & )+l5_78(i7,i8)%b(2,1)*cw1+l5_78(i7,i8)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p534q,p=p534,q=p534,bef=,aft=
      p534q=(p534(0)*p534(0)-p534(1)*p534(1)-p534(2)*p534(2)-p53
     & 4(3)*p534(3))
  
      if(id5.ne.5.or.(id3.ne.5.and.id7.ne.5))then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=u5_3478(i3,i4,i7,i8)%a,bb=u5_3478(i3,i4,i7,i8)%b,cc=u5_3478(i
* 3,i4,i7,i8)%c,dd=u5_3478(i3,i4,i7,i8)%d,a1=l5_34(i3,i4)%a,b1=l5_34(i3,
* i4)%b,c1=l5_34(i3,i4)%c,d1=l5_34(i3,i4)%d,a2=u534_78(i7,i8)%a,b2=u534_
* 78(i7,i8)%b,c2=u534_78(i7,i8)%c,d2=u534_78(i7,i8)%d,prq=p534q,m=rmass(
* id5),nsum=1
      u5_3478(i3,i4,i7,i8)%a(1,1)=u5_3478(i3,i4,i7,i8)%a(1,1)+l5
     & _34(i3,i4)%a(1,1)*u534_78(i7,i8)%a(1,1)+l5_34(i3,i4)%c(1,
     & 2)*p534q*u534_78(i7,i8)%b(2,1)
      u5_3478(i3,i4,i7,i8)%b(1,1)=u5_3478(i3,i4,i7,i8)%b(1,1)+rm
     & ass(id5)*(l5_34(i3,i4)%d(1,1)*u534_78(i7,i8)%a(1,1)+l5_34
     & (i3,i4)%b(1,2)*u534_78(i7,i8)%b(2,1))
      u5_3478(i3,i4,i7,i8)%c(1,1)=u5_3478(i3,i4,i7,i8)%c(1,1)+rm
     & ass(id5)*(l5_34(i3,i4)%a(1,1)*u534_78(i7,i8)%d(1,1)+l5_34
     & (i3,i4)%c(1,2)*u534_78(i7,i8)%c(2,1))
      u5_3478(i3,i4,i7,i8)%d(1,1)=u5_3478(i3,i4,i7,i8)%d(1,1)+l5
     & _34(i3,i4)%d(1,1)*p534q*u534_78(i7,i8)%d(1,1)+l5_34(i3,i4
     & )%b(1,2)*u534_78(i7,i8)%c(2,1)
      u5_3478(i3,i4,i7,i8)%a(1,2)=u5_3478(i3,i4,i7,i8)%a(1,2)+rm
     & ass(id5)*(l5_34(i3,i4)%a(1,1)*u534_78(i7,i8)%b(1,2)+l5_34
     & (i3,i4)%c(1,2)*u534_78(i7,i8)%a(2,2))
      u5_3478(i3,i4,i7,i8)%b(1,2)=u5_3478(i3,i4,i7,i8)%b(1,2)+l5
     & _34(i3,i4)%d(1,1)*p534q*u534_78(i7,i8)%b(1,2)+l5_34(i3,i4
     & )%b(1,2)*u534_78(i7,i8)%a(2,2)
      u5_3478(i3,i4,i7,i8)%c(1,2)=u5_3478(i3,i4,i7,i8)%c(1,2)+l5
     & _34(i3,i4)%a(1,1)*u534_78(i7,i8)%c(1,2)+l5_34(i3,i4)%c(1,
     & 2)*p534q*u534_78(i7,i8)%d(2,2)
      u5_3478(i3,i4,i7,i8)%d(1,2)=u5_3478(i3,i4,i7,i8)%d(1,2)+rm
     & ass(id5)*(l5_34(i3,i4)%d(1,1)*u534_78(i7,i8)%c(1,2)+l5_34
     & (i3,i4)%b(1,2)*u534_78(i7,i8)%d(2,2))
      u5_3478(i3,i4,i7,i8)%a(2,1)=u5_3478(i3,i4,i7,i8)%a(2,1)+rm
     & ass(id5)*(l5_34(i3,i4)%c(2,1)*u534_78(i7,i8)%a(1,1)+l5_34
     & (i3,i4)%a(2,2)*u534_78(i7,i8)%b(2,1))
      u5_3478(i3,i4,i7,i8)%b(2,1)=u5_3478(i3,i4,i7,i8)%b(2,1)+l5
     & _34(i3,i4)%b(2,1)*u534_78(i7,i8)%a(1,1)+l5_34(i3,i4)%d(2,
     & 2)*p534q*u534_78(i7,i8)%b(2,1)
      u5_3478(i3,i4,i7,i8)%c(2,1)=u5_3478(i3,i4,i7,i8)%c(2,1)+l5
     & _34(i3,i4)%c(2,1)*p534q*u534_78(i7,i8)%d(1,1)+l5_34(i3,i4
     & )%a(2,2)*u534_78(i7,i8)%c(2,1)
      u5_3478(i3,i4,i7,i8)%d(2,1)=u5_3478(i3,i4,i7,i8)%d(2,1)+rm
     & ass(id5)*(l5_34(i3,i4)%b(2,1)*u534_78(i7,i8)%d(1,1)+l5_34
     & (i3,i4)%d(2,2)*u534_78(i7,i8)%c(2,1))
      u5_3478(i3,i4,i7,i8)%a(2,2)=u5_3478(i3,i4,i7,i8)%a(2,2)+l5
     & _34(i3,i4)%c(2,1)*p534q*u534_78(i7,i8)%b(1,2)+l5_34(i3,i4
     & )%a(2,2)*u534_78(i7,i8)%a(2,2)
      u5_3478(i3,i4,i7,i8)%b(2,2)=u5_3478(i3,i4,i7,i8)%b(2,2)+rm
     & ass(id5)*(l5_34(i3,i4)%b(2,1)*u534_78(i7,i8)%b(1,2)+l5_34
     & (i3,i4)%d(2,2)*u534_78(i7,i8)%a(2,2))
      u5_3478(i3,i4,i7,i8)%c(2,2)=u5_3478(i3,i4,i7,i8)%c(2,2)+rm
     & ass(id5)*(l5_34(i3,i4)%c(2,1)*u534_78(i7,i8)%c(1,2)+l5_34
     & (i3,i4)%a(2,2)*u534_78(i7,i8)%d(2,2))
      u5_3478(i3,i4,i7,i8)%d(2,2)=u5_3478(i3,i4,i7,i8)%d(2,2)+l5
     & _34(i3,i4)%b(2,1)*u534_78(i7,i8)%c(1,2)+l5_34(i3,i4)%d(2,
     & 2)*p534q*u534_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id5.eq.5.and.id3.eq.5.and.id7.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=u5_3478(i3,i4,i7,i8)%a,bb=u5_3478(i3,i4,i7,i8)%b,cc=u5_3478
* (i3,i4,i7,i8)%c,dd=u5_3478(i3,i4,i7,i8)%d,a1=l5_34(i3,i4)%a,b1=l5_34(i
* 3,i4)%b,c1=l5_34(i3,i4)%c,d1=l5_34(i3,i4)%d,a2=u534_78(i7,i8)%a,b2=u53
* 4_78(i7,i8)%b,c2=u534_78(i7,i8)%c,d2=u534_78(i7,i8)%d,prq=p534q,m=rmas
* s(id5),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u534_78(i7,i8)%a(1,jut)+rmass(id5)*u534_78(i7,i8)%b(1,
     & jut)
      cx2=u534_78(i7,i8)%a(2,jut)+rmass(id5)*u534_78(i7,i8)%b(2,
     & jut)
      cy1=p534q*u534_78(i7,i8)%b(1,jut)+rmass(id5)*u534_78(i7,i8
     & )%a(1,jut)
      cy2=p534q*u534_78(i7,i8)%b(2,jut)+rmass(id5)*u534_78(i7,i8
     & )%a(2,jut)
      u5_3478(i3,i4,i7,i8)%a(iut,jut)=u5_3478(i3,i4,i7,i8)%a(iut
     & ,jut)+l5_34(i3,i4)%a(iut,1)*cx1+l5_34(i3,i4)%c(iut,1)*cy1
     & +l5_34(i3,i4)%a(iut,2)*cx2+l5_34(i3,i4)%c(iut,2)*cy2
      u5_3478(i3,i4,i7,i8)%b(iut,jut)=u5_3478(i3,i4,i7,i8)%b(iut
     & ,jut)+l5_34(i3,i4)%b(iut,1)*cx1+l5_34(i3,i4)%d(iut,1)*cy1
     & +l5_34(i3,i4)%b(iut,2)*cx2+l5_34(i3,i4)%d(iut,2)*cy2
      cw1=u534_78(i7,i8)%c(1,jut)+rmass(id5)*u534_78(i7,i8)%d(1,
     & jut)
      cw2=u534_78(i7,i8)%c(2,jut)+rmass(id5)*u534_78(i7,i8)%d(2,
     & jut)
      cz1=p534q*u534_78(i7,i8)%d(1,jut)+rmass(id5)*u534_78(i7,i8
     & )%c(1,jut)
      cz2=p534q*u534_78(i7,i8)%d(2,jut)+rmass(id5)*u534_78(i7,i8
     & )%c(2,jut)
      u5_3478(i3,i4,i7,i8)%c(iut,jut)=u5_3478(i3,i4,i7,i8)%c(iut
     & ,jut)+l5_34(i3,i4)%a(iut,1)*cw1+l5_34(i3,i4)%c(iut,1)*cz1
     & +l5_34(i3,i4)%a(iut,2)*cw2+l5_34(i3,i4)%c(iut,2)*cz2
      u5_3478(i3,i4,i7,i8)%d(iut,jut)=u5_3478(i3,i4,i7,i8)%d(iut
     & ,jut)+l5_34(i3,i4)%b(iut,1)*cw1+l5_34(i3,i4)%d(iut,1)*cz1
     & +l5_34(i3,i4)%b(iut,2)*cw2+l5_34(i3,i4)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id5.eq.5.and.id3.eq.5.and.id7.ne.5)then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=u5_3478(i3,i4,i7,i8)%a,bb=u5_3478(i3,i4,i7,i8)%b,cc=u5_3478(
* i3,i4,i7,i8)%c,dd=u5_3478(i3,i4,i7,i8)%d,a1=l5_34(i3,i4)%a,b1=l5_34(i3
* ,i4)%b,c1=l5_34(i3,i4)%c,d1=l5_34(i3,i4)%d,a2=u534_78(i7,i8)%a,b2=u534
* _78(i7,i8)%b,c2=u534_78(i7,i8)%c,d2=u534_78(i7,i8)%d,prq=p534q,m=rmass
* (id5),nsum=1
      do iut=1,2
      cx1=l5_34(i3,i4)%a(iut,1)+l5_34(i3,i4)%c(iut,1)*rmass(id5)
      cx2=l5_34(i3,i4)%c(iut,2)*p534q+l5_34(i3,i4)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_34(i3,i4)%b(iut,1)+l5_34(i3,i4)%d(iut,1)*rmass(id5)
      cy2=l5_34(i3,i4)%d(iut,2)*p534q+l5_34(i3,i4)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_34(i3,i4)%c(iut,1)*p534q+l5_34(i3,i4)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_34(i3,i4)%a(iut,2)+l5_34(i3,i4)%c(iut,2)*rmass(id5)
      cz1=l5_34(i3,i4)%d(iut,1)*p534q+l5_34(i3,i4)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_34(i3,i4)%b(iut,2)+l5_34(i3,i4)%d(iut,2)*rmass(id5)
      u5_3478(i3,i4,i7,i8)%a(iut,1)=u5_3478(i3,i4,i7,i8)%a(iut,1
     & )+cx1*u534_78(i7,i8)%a(1,1)+cx2*u534_78(i7,i8)%b(2,1)
      u5_3478(i3,i4,i7,i8)%b(iut,1)=u5_3478(i3,i4,i7,i8)%b(iut,1
     & )+cy1*u534_78(i7,i8)%a(1,1)+cy2*u534_78(i7,i8)%b(2,1)
      u5_3478(i3,i4,i7,i8)%c(iut,1)=u5_3478(i3,i4,i7,i8)%c(iut,1
     & )+cw1*u534_78(i7,i8)%d(1,1)+cw2*u534_78(i7,i8)%c(2,1)
      u5_3478(i3,i4,i7,i8)%d(iut,1)=u5_3478(i3,i4,i7,i8)%d(iut,1
     & )+cz1*u534_78(i7,i8)%d(1,1)+cz2*u534_78(i7,i8)%c(2,1)
      u5_3478(i3,i4,i7,i8)%a(iut,2)=u5_3478(i3,i4,i7,i8)%a(iut,2
     & )+cw1*u534_78(i7,i8)%b(1,2)+cw2*u534_78(i7,i8)%a(2,2)
      u5_3478(i3,i4,i7,i8)%b(iut,2)=u5_3478(i3,i4,i7,i8)%b(iut,2
     & )+cz1*u534_78(i7,i8)%b(1,2)+cz2*u534_78(i7,i8)%a(2,2)
      u5_3478(i3,i4,i7,i8)%c(iut,2)=u5_3478(i3,i4,i7,i8)%c(iut,2
     & )+cx1*u534_78(i7,i8)%c(1,2)+cx2*u534_78(i7,i8)%d(2,2)
      u5_3478(i3,i4,i7,i8)%d(iut,2)=u5_3478(i3,i4,i7,i8)%d(iut,2
     & )+cy1*u534_78(i7,i8)%c(1,2)+cy2*u534_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id5.eq.5.and.id3.ne.5.and.id7.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=u5_3478(i3,i4,i7,i8)%a,bb=u5_3478(i3,i4,i7,i8)%b,cc=u5_3478(
* i3,i4,i7,i8)%c,dd=u5_3478(i3,i4,i7,i8)%d,a1=l5_34(i3,i4)%a,b1=l5_34(i3
* ,i4)%b,c1=l5_34(i3,i4)%c,d1=l5_34(i3,i4)%d,a2=u534_78(i7,i8)%a,b2=u534
* _78(i7,i8)%b,c2=u534_78(i7,i8)%c,d2=u534_78(i7,i8)%d,prq=p534q,m=rmass
* (id5),nsum=1
      do jut=1,2
      cx1=u534_78(i7,i8)%a(1,jut)+rmass(id5)*u534_78(i7,i8)%b(1,
     & jut)
      cx2=u534_78(i7,i8)%a(2,jut)+rmass(id5)*u534_78(i7,i8)%b(2,
     & jut)
      cy1=p534q*u534_78(i7,i8)%b(1,jut)+rmass(id5)*u534_78(i7,i8
     & )%a(1,jut)
      cy2=p534q*u534_78(i7,i8)%b(2,jut)+rmass(id5)*u534_78(i7,i8
     & )%a(2,jut)
      cw1=u534_78(i7,i8)%c(1,jut)+rmass(id5)*u534_78(i7,i8)%d(1,
     & jut)
      cw2=u534_78(i7,i8)%c(2,jut)+rmass(id5)*u534_78(i7,i8)%d(2,
     & jut)
      cz1=p534q*u534_78(i7,i8)%d(1,jut)+rmass(id5)*u534_78(i7,i8
     & )%c(1,jut)
      cz2=p534q*u534_78(i7,i8)%d(2,jut)+rmass(id5)*u534_78(i7,i8
     & )%c(2,jut)
      u5_3478(i3,i4,i7,i8)%a(1,jut)=u5_3478(i3,i4,i7,i8)%a(1,jut
     & )+l5_34(i3,i4)%a(1,1)*cx1+l5_34(i3,i4)%c(1,2)*cy2
      u5_3478(i3,i4,i7,i8)%b(1,jut)=u5_3478(i3,i4,i7,i8)%b(1,jut
     & )+l5_34(i3,i4)%d(1,1)*cy1+l5_34(i3,i4)%b(1,2)*cx2
      u5_3478(i3,i4,i7,i8)%c(1,jut)=u5_3478(i3,i4,i7,i8)%c(1,jut
     & )+l5_34(i3,i4)%a(1,1)*cw1+l5_34(i3,i4)%c(1,2)*cz2
      u5_3478(i3,i4,i7,i8)%d(1,jut)=u5_3478(i3,i4,i7,i8)%d(1,jut
     & )+l5_34(i3,i4)%d(1,1)*cz1+l5_34(i3,i4)%b(1,2)*cw2
      u5_3478(i3,i4,i7,i8)%a(2,jut)=u5_3478(i3,i4,i7,i8)%a(2,jut
     & )+l5_34(i3,i4)%c(2,1)*cy1+l5_34(i3,i4)%a(2,2)*cx2
      u5_3478(i3,i4,i7,i8)%b(2,jut)=u5_3478(i3,i4,i7,i8)%b(2,jut
     & )+l5_34(i3,i4)%b(2,1)*cx1+l5_34(i3,i4)%d(2,2)*cy2
      u5_3478(i3,i4,i7,i8)%c(2,jut)=u5_3478(i3,i4,i7,i8)%c(2,jut
     & )+l5_34(i3,i4)%c(2,1)*cz1+l5_34(i3,i4)%a(2,2)*cw2
      u5_3478(i3,i4,i7,i8)%d(2,jut)=u5_3478(i3,i4,i7,i8)%d(2,jut
     & )+l5_34(i3,i4)%b(2,1)*cw1+l5_34(i3,i4)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p578q,p=p578,q=p578,bef=,aft=
      p578q=(p578(0)*p578(0)-p578(1)*p578(1)-p578(2)*p578(2)-p57
     & 8(3)*p578(3))
  
      if(id5.ne.5.or.(id7.ne.5.and.id3.ne.5))then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=u5_3478(i3,i4,i7,i8)%a,bb=u5_3478(i3,i4,i7,i8)%b,cc=u5_3478(i
* 3,i4,i7,i8)%c,dd=u5_3478(i3,i4,i7,i8)%d,a1=l5_78(i7,i8)%a,b1=l5_78(i7,
* i8)%b,c1=l5_78(i7,i8)%c,d1=l5_78(i7,i8)%d,a2=u578_34(i3,i4)%a,b2=u578_
* 34(i3,i4)%b,c2=u578_34(i3,i4)%c,d2=u578_34(i3,i4)%d,prq=p578q,m=rmass(
* id5),nsum=1
      u5_3478(i3,i4,i7,i8)%a(1,1)=u5_3478(i3,i4,i7,i8)%a(1,1)+l5
     & _78(i7,i8)%a(1,1)*u578_34(i3,i4)%a(1,1)+l5_78(i7,i8)%c(1,
     & 2)*p578q*u578_34(i3,i4)%b(2,1)
      u5_3478(i3,i4,i7,i8)%b(1,1)=u5_3478(i3,i4,i7,i8)%b(1,1)+rm
     & ass(id5)*(l5_78(i7,i8)%d(1,1)*u578_34(i3,i4)%a(1,1)+l5_78
     & (i7,i8)%b(1,2)*u578_34(i3,i4)%b(2,1))
      u5_3478(i3,i4,i7,i8)%c(1,1)=u5_3478(i3,i4,i7,i8)%c(1,1)+rm
     & ass(id5)*(l5_78(i7,i8)%a(1,1)*u578_34(i3,i4)%d(1,1)+l5_78
     & (i7,i8)%c(1,2)*u578_34(i3,i4)%c(2,1))
      u5_3478(i3,i4,i7,i8)%d(1,1)=u5_3478(i3,i4,i7,i8)%d(1,1)+l5
     & _78(i7,i8)%d(1,1)*p578q*u578_34(i3,i4)%d(1,1)+l5_78(i7,i8
     & )%b(1,2)*u578_34(i3,i4)%c(2,1)
      u5_3478(i3,i4,i7,i8)%a(1,2)=u5_3478(i3,i4,i7,i8)%a(1,2)+rm
     & ass(id5)*(l5_78(i7,i8)%a(1,1)*u578_34(i3,i4)%b(1,2)+l5_78
     & (i7,i8)%c(1,2)*u578_34(i3,i4)%a(2,2))
      u5_3478(i3,i4,i7,i8)%b(1,2)=u5_3478(i3,i4,i7,i8)%b(1,2)+l5
     & _78(i7,i8)%d(1,1)*p578q*u578_34(i3,i4)%b(1,2)+l5_78(i7,i8
     & )%b(1,2)*u578_34(i3,i4)%a(2,2)
      u5_3478(i3,i4,i7,i8)%c(1,2)=u5_3478(i3,i4,i7,i8)%c(1,2)+l5
     & _78(i7,i8)%a(1,1)*u578_34(i3,i4)%c(1,2)+l5_78(i7,i8)%c(1,
     & 2)*p578q*u578_34(i3,i4)%d(2,2)
      u5_3478(i3,i4,i7,i8)%d(1,2)=u5_3478(i3,i4,i7,i8)%d(1,2)+rm
     & ass(id5)*(l5_78(i7,i8)%d(1,1)*u578_34(i3,i4)%c(1,2)+l5_78
     & (i7,i8)%b(1,2)*u578_34(i3,i4)%d(2,2))
      u5_3478(i3,i4,i7,i8)%a(2,1)=u5_3478(i3,i4,i7,i8)%a(2,1)+rm
     & ass(id5)*(l5_78(i7,i8)%c(2,1)*u578_34(i3,i4)%a(1,1)+l5_78
     & (i7,i8)%a(2,2)*u578_34(i3,i4)%b(2,1))
      u5_3478(i3,i4,i7,i8)%b(2,1)=u5_3478(i3,i4,i7,i8)%b(2,1)+l5
     & _78(i7,i8)%b(2,1)*u578_34(i3,i4)%a(1,1)+l5_78(i7,i8)%d(2,
     & 2)*p578q*u578_34(i3,i4)%b(2,1)
      u5_3478(i3,i4,i7,i8)%c(2,1)=u5_3478(i3,i4,i7,i8)%c(2,1)+l5
     & _78(i7,i8)%c(2,1)*p578q*u578_34(i3,i4)%d(1,1)+l5_78(i7,i8
     & )%a(2,2)*u578_34(i3,i4)%c(2,1)
      u5_3478(i3,i4,i7,i8)%d(2,1)=u5_3478(i3,i4,i7,i8)%d(2,1)+rm
     & ass(id5)*(l5_78(i7,i8)%b(2,1)*u578_34(i3,i4)%d(1,1)+l5_78
     & (i7,i8)%d(2,2)*u578_34(i3,i4)%c(2,1))
      u5_3478(i3,i4,i7,i8)%a(2,2)=u5_3478(i3,i4,i7,i8)%a(2,2)+l5
     & _78(i7,i8)%c(2,1)*p578q*u578_34(i3,i4)%b(1,2)+l5_78(i7,i8
     & )%a(2,2)*u578_34(i3,i4)%a(2,2)
      u5_3478(i3,i4,i7,i8)%b(2,2)=u5_3478(i3,i4,i7,i8)%b(2,2)+rm
     & ass(id5)*(l5_78(i7,i8)%b(2,1)*u578_34(i3,i4)%b(1,2)+l5_78
     & (i7,i8)%d(2,2)*u578_34(i3,i4)%a(2,2))
      u5_3478(i3,i4,i7,i8)%c(2,2)=u5_3478(i3,i4,i7,i8)%c(2,2)+rm
     & ass(id5)*(l5_78(i7,i8)%c(2,1)*u578_34(i3,i4)%c(1,2)+l5_78
     & (i7,i8)%a(2,2)*u578_34(i3,i4)%d(2,2))
      u5_3478(i3,i4,i7,i8)%d(2,2)=u5_3478(i3,i4,i7,i8)%d(2,2)+l5
     & _78(i7,i8)%b(2,1)*u578_34(i3,i4)%c(1,2)+l5_78(i7,i8)%d(2,
     & 2)*p578q*u578_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id5.eq.5.and.id7.eq.5.and.id3.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=u5_3478(i3,i4,i7,i8)%a,bb=u5_3478(i3,i4,i7,i8)%b,cc=u5_3478
* (i3,i4,i7,i8)%c,dd=u5_3478(i3,i4,i7,i8)%d,a1=l5_78(i7,i8)%a,b1=l5_78(i
* 7,i8)%b,c1=l5_78(i7,i8)%c,d1=l5_78(i7,i8)%d,a2=u578_34(i3,i4)%a,b2=u57
* 8_34(i3,i4)%b,c2=u578_34(i3,i4)%c,d2=u578_34(i3,i4)%d,prq=p578q,m=rmas
* s(id5),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u578_34(i3,i4)%a(1,jut)+rmass(id5)*u578_34(i3,i4)%b(1,
     & jut)
      cx2=u578_34(i3,i4)%a(2,jut)+rmass(id5)*u578_34(i3,i4)%b(2,
     & jut)
      cy1=p578q*u578_34(i3,i4)%b(1,jut)+rmass(id5)*u578_34(i3,i4
     & )%a(1,jut)
      cy2=p578q*u578_34(i3,i4)%b(2,jut)+rmass(id5)*u578_34(i3,i4
     & )%a(2,jut)
      u5_3478(i3,i4,i7,i8)%a(iut,jut)=u5_3478(i3,i4,i7,i8)%a(iut
     & ,jut)+l5_78(i7,i8)%a(iut,1)*cx1+l5_78(i7,i8)%c(iut,1)*cy1
     & +l5_78(i7,i8)%a(iut,2)*cx2+l5_78(i7,i8)%c(iut,2)*cy2
      u5_3478(i3,i4,i7,i8)%b(iut,jut)=u5_3478(i3,i4,i7,i8)%b(iut
     & ,jut)+l5_78(i7,i8)%b(iut,1)*cx1+l5_78(i7,i8)%d(iut,1)*cy1
     & +l5_78(i7,i8)%b(iut,2)*cx2+l5_78(i7,i8)%d(iut,2)*cy2
      cw1=u578_34(i3,i4)%c(1,jut)+rmass(id5)*u578_34(i3,i4)%d(1,
     & jut)
      cw2=u578_34(i3,i4)%c(2,jut)+rmass(id5)*u578_34(i3,i4)%d(2,
     & jut)
      cz1=p578q*u578_34(i3,i4)%d(1,jut)+rmass(id5)*u578_34(i3,i4
     & )%c(1,jut)
      cz2=p578q*u578_34(i3,i4)%d(2,jut)+rmass(id5)*u578_34(i3,i4
     & )%c(2,jut)
      u5_3478(i3,i4,i7,i8)%c(iut,jut)=u5_3478(i3,i4,i7,i8)%c(iut
     & ,jut)+l5_78(i7,i8)%a(iut,1)*cw1+l5_78(i7,i8)%c(iut,1)*cz1
     & +l5_78(i7,i8)%a(iut,2)*cw2+l5_78(i7,i8)%c(iut,2)*cz2
      u5_3478(i3,i4,i7,i8)%d(iut,jut)=u5_3478(i3,i4,i7,i8)%d(iut
     & ,jut)+l5_78(i7,i8)%b(iut,1)*cw1+l5_78(i7,i8)%d(iut,1)*cz1
     & +l5_78(i7,i8)%b(iut,2)*cw2+l5_78(i7,i8)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id5.eq.5.and.id7.eq.5.and.id3.ne.5)then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=u5_3478(i3,i4,i7,i8)%a,bb=u5_3478(i3,i4,i7,i8)%b,cc=u5_3478(
* i3,i4,i7,i8)%c,dd=u5_3478(i3,i4,i7,i8)%d,a1=l5_78(i7,i8)%a,b1=l5_78(i7
* ,i8)%b,c1=l5_78(i7,i8)%c,d1=l5_78(i7,i8)%d,a2=u578_34(i3,i4)%a,b2=u578
* _34(i3,i4)%b,c2=u578_34(i3,i4)%c,d2=u578_34(i3,i4)%d,prq=p578q,m=rmass
* (id5),nsum=1
      do iut=1,2
      cx1=l5_78(i7,i8)%a(iut,1)+l5_78(i7,i8)%c(iut,1)*rmass(id5)
      cx2=l5_78(i7,i8)%c(iut,2)*p578q+l5_78(i7,i8)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_78(i7,i8)%b(iut,1)+l5_78(i7,i8)%d(iut,1)*rmass(id5)
      cy2=l5_78(i7,i8)%d(iut,2)*p578q+l5_78(i7,i8)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_78(i7,i8)%c(iut,1)*p578q+l5_78(i7,i8)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_78(i7,i8)%a(iut,2)+l5_78(i7,i8)%c(iut,2)*rmass(id5)
      cz1=l5_78(i7,i8)%d(iut,1)*p578q+l5_78(i7,i8)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_78(i7,i8)%b(iut,2)+l5_78(i7,i8)%d(iut,2)*rmass(id5)
      u5_3478(i3,i4,i7,i8)%a(iut,1)=u5_3478(i3,i4,i7,i8)%a(iut,1
     & )+cx1*u578_34(i3,i4)%a(1,1)+cx2*u578_34(i3,i4)%b(2,1)
      u5_3478(i3,i4,i7,i8)%b(iut,1)=u5_3478(i3,i4,i7,i8)%b(iut,1
     & )+cy1*u578_34(i3,i4)%a(1,1)+cy2*u578_34(i3,i4)%b(2,1)
      u5_3478(i3,i4,i7,i8)%c(iut,1)=u5_3478(i3,i4,i7,i8)%c(iut,1
     & )+cw1*u578_34(i3,i4)%d(1,1)+cw2*u578_34(i3,i4)%c(2,1)
      u5_3478(i3,i4,i7,i8)%d(iut,1)=u5_3478(i3,i4,i7,i8)%d(iut,1
     & )+cz1*u578_34(i3,i4)%d(1,1)+cz2*u578_34(i3,i4)%c(2,1)
      u5_3478(i3,i4,i7,i8)%a(iut,2)=u5_3478(i3,i4,i7,i8)%a(iut,2
     & )+cw1*u578_34(i3,i4)%b(1,2)+cw2*u578_34(i3,i4)%a(2,2)
      u5_3478(i3,i4,i7,i8)%b(iut,2)=u5_3478(i3,i4,i7,i8)%b(iut,2
     & )+cz1*u578_34(i3,i4)%b(1,2)+cz2*u578_34(i3,i4)%a(2,2)
      u5_3478(i3,i4,i7,i8)%c(iut,2)=u5_3478(i3,i4,i7,i8)%c(iut,2
     & )+cx1*u578_34(i3,i4)%c(1,2)+cx2*u578_34(i3,i4)%d(2,2)
      u5_3478(i3,i4,i7,i8)%d(iut,2)=u5_3478(i3,i4,i7,i8)%d(iut,2
     & )+cy1*u578_34(i3,i4)%c(1,2)+cy2*u578_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id5.eq.5.and.id7.ne.5.and.id3.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=u5_3478(i3,i4,i7,i8)%a,bb=u5_3478(i3,i4,i7,i8)%b,cc=u5_3478(
* i3,i4,i7,i8)%c,dd=u5_3478(i3,i4,i7,i8)%d,a1=l5_78(i7,i8)%a,b1=l5_78(i7
* ,i8)%b,c1=l5_78(i7,i8)%c,d1=l5_78(i7,i8)%d,a2=u578_34(i3,i4)%a,b2=u578
* _34(i3,i4)%b,c2=u578_34(i3,i4)%c,d2=u578_34(i3,i4)%d,prq=p578q,m=rmass
* (id5),nsum=1
      do jut=1,2
      cx1=u578_34(i3,i4)%a(1,jut)+rmass(id5)*u578_34(i3,i4)%b(1,
     & jut)
      cx2=u578_34(i3,i4)%a(2,jut)+rmass(id5)*u578_34(i3,i4)%b(2,
     & jut)
      cy1=p578q*u578_34(i3,i4)%b(1,jut)+rmass(id5)*u578_34(i3,i4
     & )%a(1,jut)
      cy2=p578q*u578_34(i3,i4)%b(2,jut)+rmass(id5)*u578_34(i3,i4
     & )%a(2,jut)
      cw1=u578_34(i3,i4)%c(1,jut)+rmass(id5)*u578_34(i3,i4)%d(1,
     & jut)
      cw2=u578_34(i3,i4)%c(2,jut)+rmass(id5)*u578_34(i3,i4)%d(2,
     & jut)
      cz1=p578q*u578_34(i3,i4)%d(1,jut)+rmass(id5)*u578_34(i3,i4
     & )%c(1,jut)
      cz2=p578q*u578_34(i3,i4)%d(2,jut)+rmass(id5)*u578_34(i3,i4
     & )%c(2,jut)
      u5_3478(i3,i4,i7,i8)%a(1,jut)=u5_3478(i3,i4,i7,i8)%a(1,jut
     & )+l5_78(i7,i8)%a(1,1)*cx1+l5_78(i7,i8)%c(1,2)*cy2
      u5_3478(i3,i4,i7,i8)%b(1,jut)=u5_3478(i3,i4,i7,i8)%b(1,jut
     & )+l5_78(i7,i8)%d(1,1)*cy1+l5_78(i7,i8)%b(1,2)*cx2
      u5_3478(i3,i4,i7,i8)%c(1,jut)=u5_3478(i3,i4,i7,i8)%c(1,jut
     & )+l5_78(i7,i8)%a(1,1)*cw1+l5_78(i7,i8)%c(1,2)*cz2
      u5_3478(i3,i4,i7,i8)%d(1,jut)=u5_3478(i3,i4,i7,i8)%d(1,jut
     & )+l5_78(i7,i8)%d(1,1)*cz1+l5_78(i7,i8)%b(1,2)*cw2
      u5_3478(i3,i4,i7,i8)%a(2,jut)=u5_3478(i3,i4,i7,i8)%a(2,jut
     & )+l5_78(i7,i8)%c(2,1)*cy1+l5_78(i7,i8)%a(2,2)*cx2
      u5_3478(i3,i4,i7,i8)%b(2,jut)=u5_3478(i3,i4,i7,i8)%b(2,jut
     & )+l5_78(i7,i8)%b(2,1)*cx1+l5_78(i7,i8)%d(2,2)*cy2
      u5_3478(i3,i4,i7,i8)%c(2,jut)=u5_3478(i3,i4,i7,i8)%c(2,jut
     & )+l5_78(i7,i8)%c(2,1)*cz1+l5_78(i7,i8)%a(2,2)*cw2
      u5_3478(i3,i4,i7,i8)%d(2,jut)=u5_3478(i3,i4,i7,i8)%d(2,jut
     & )+l5_78(i7,i8)%b(2,1)*cw1+l5_78(i7,i8)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p712q,p=p712,q=p712,bef=,aft=
      p712q=(p712(0)*p712(0)-p712(1)*p712(1)-p712(2)*p712(2)-p71
     & 2(3)*p712(3))
  
      if(id7.ne.5.or.(id1.ne.5.and.id3.ne.5))then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=u7_1234(i1,i2,i3,i4)%a,bb=u7_1234(i1,i2,i3,i4)%b,cc=u7_1234(i
* 1,i2,i3,i4)%c,dd=u7_1234(i1,i2,i3,i4)%d,a1=l7_12(i1,i2)%a,b1=l7_12(i1,
* i2)%b,c1=l7_12(i1,i2)%c,d1=l7_12(i1,i2)%d,a2=u712_34(i3,i4)%a,b2=u712_
* 34(i3,i4)%b,c2=u712_34(i3,i4)%c,d2=u712_34(i3,i4)%d,prq=p712q,m=rmass(
* id7),nsum=1
      u7_1234(i1,i2,i3,i4)%a(1,1)=u7_1234(i1,i2,i3,i4)%a(1,1)+l7
     & _12(i1,i2)%a(1,1)*u712_34(i3,i4)%a(1,1)+l7_12(i1,i2)%c(1,
     & 2)*p712q*u712_34(i3,i4)%b(2,1)
      u7_1234(i1,i2,i3,i4)%b(1,1)=u7_1234(i1,i2,i3,i4)%b(1,1)+rm
     & ass(id7)*(l7_12(i1,i2)%d(1,1)*u712_34(i3,i4)%a(1,1)+l7_12
     & (i1,i2)%b(1,2)*u712_34(i3,i4)%b(2,1))
      u7_1234(i1,i2,i3,i4)%c(1,1)=u7_1234(i1,i2,i3,i4)%c(1,1)+rm
     & ass(id7)*(l7_12(i1,i2)%a(1,1)*u712_34(i3,i4)%d(1,1)+l7_12
     & (i1,i2)%c(1,2)*u712_34(i3,i4)%c(2,1))
      u7_1234(i1,i2,i3,i4)%d(1,1)=u7_1234(i1,i2,i3,i4)%d(1,1)+l7
     & _12(i1,i2)%d(1,1)*p712q*u712_34(i3,i4)%d(1,1)+l7_12(i1,i2
     & )%b(1,2)*u712_34(i3,i4)%c(2,1)
      u7_1234(i1,i2,i3,i4)%a(1,2)=u7_1234(i1,i2,i3,i4)%a(1,2)+rm
     & ass(id7)*(l7_12(i1,i2)%a(1,1)*u712_34(i3,i4)%b(1,2)+l7_12
     & (i1,i2)%c(1,2)*u712_34(i3,i4)%a(2,2))
      u7_1234(i1,i2,i3,i4)%b(1,2)=u7_1234(i1,i2,i3,i4)%b(1,2)+l7
     & _12(i1,i2)%d(1,1)*p712q*u712_34(i3,i4)%b(1,2)+l7_12(i1,i2
     & )%b(1,2)*u712_34(i3,i4)%a(2,2)
      u7_1234(i1,i2,i3,i4)%c(1,2)=u7_1234(i1,i2,i3,i4)%c(1,2)+l7
     & _12(i1,i2)%a(1,1)*u712_34(i3,i4)%c(1,2)+l7_12(i1,i2)%c(1,
     & 2)*p712q*u712_34(i3,i4)%d(2,2)
      u7_1234(i1,i2,i3,i4)%d(1,2)=u7_1234(i1,i2,i3,i4)%d(1,2)+rm
     & ass(id7)*(l7_12(i1,i2)%d(1,1)*u712_34(i3,i4)%c(1,2)+l7_12
     & (i1,i2)%b(1,2)*u712_34(i3,i4)%d(2,2))
      u7_1234(i1,i2,i3,i4)%a(2,1)=u7_1234(i1,i2,i3,i4)%a(2,1)+rm
     & ass(id7)*(l7_12(i1,i2)%c(2,1)*u712_34(i3,i4)%a(1,1)+l7_12
     & (i1,i2)%a(2,2)*u712_34(i3,i4)%b(2,1))
      u7_1234(i1,i2,i3,i4)%b(2,1)=u7_1234(i1,i2,i3,i4)%b(2,1)+l7
     & _12(i1,i2)%b(2,1)*u712_34(i3,i4)%a(1,1)+l7_12(i1,i2)%d(2,
     & 2)*p712q*u712_34(i3,i4)%b(2,1)
      u7_1234(i1,i2,i3,i4)%c(2,1)=u7_1234(i1,i2,i3,i4)%c(2,1)+l7
     & _12(i1,i2)%c(2,1)*p712q*u712_34(i3,i4)%d(1,1)+l7_12(i1,i2
     & )%a(2,2)*u712_34(i3,i4)%c(2,1)
      u7_1234(i1,i2,i3,i4)%d(2,1)=u7_1234(i1,i2,i3,i4)%d(2,1)+rm
     & ass(id7)*(l7_12(i1,i2)%b(2,1)*u712_34(i3,i4)%d(1,1)+l7_12
     & (i1,i2)%d(2,2)*u712_34(i3,i4)%c(2,1))
      u7_1234(i1,i2,i3,i4)%a(2,2)=u7_1234(i1,i2,i3,i4)%a(2,2)+l7
     & _12(i1,i2)%c(2,1)*p712q*u712_34(i3,i4)%b(1,2)+l7_12(i1,i2
     & )%a(2,2)*u712_34(i3,i4)%a(2,2)
      u7_1234(i1,i2,i3,i4)%b(2,2)=u7_1234(i1,i2,i3,i4)%b(2,2)+rm
     & ass(id7)*(l7_12(i1,i2)%b(2,1)*u712_34(i3,i4)%b(1,2)+l7_12
     & (i1,i2)%d(2,2)*u712_34(i3,i4)%a(2,2))
      u7_1234(i1,i2,i3,i4)%c(2,2)=u7_1234(i1,i2,i3,i4)%c(2,2)+rm
     & ass(id7)*(l7_12(i1,i2)%c(2,1)*u712_34(i3,i4)%c(1,2)+l7_12
     & (i1,i2)%a(2,2)*u712_34(i3,i4)%d(2,2))
      u7_1234(i1,i2,i3,i4)%d(2,2)=u7_1234(i1,i2,i3,i4)%d(2,2)+l7
     & _12(i1,i2)%b(2,1)*u712_34(i3,i4)%c(1,2)+l7_12(i1,i2)%d(2,
     & 2)*p712q*u712_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id7.eq.5.and.id1.eq.5.and.id3.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TsTs -- aa=u7_1234(i1,i2,i3,i4)%a,bb=u7_1234(i1,i2,i3,i4)%b,cc=u7_1234
* (i1,i2,i3,i4)%c,dd=u7_1234(i1,i2,i3,i4)%d,a1=l7_12(i1,i2)%a,b1=l7_12(i
* 1,i2)%b,c1=l7_12(i1,i2)%c,d1=l7_12(i1,i2)%d,a2=u712_34(i3,i4)%a,b2=u71
* 2_34(i3,i4)%b,c2=u712_34(i3,i4)%c,d2=u712_34(i3,i4)%d,prq=p712q,m=rmas
* s(id7),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u712_34(i3,i4)%a(1,jut)+rmass(id7)*u712_34(i3,i4)%b(1,
     & jut)
      cx2=u712_34(i3,i4)%a(2,jut)+rmass(id7)*u712_34(i3,i4)%b(2,
     & jut)
      cy1=p712q*u712_34(i3,i4)%b(1,jut)+rmass(id7)*u712_34(i3,i4
     & )%a(1,jut)
      cy2=p712q*u712_34(i3,i4)%b(2,jut)+rmass(id7)*u712_34(i3,i4
     & )%a(2,jut)
      u7_1234(i1,i2,i3,i4)%a(iut,jut)=u7_1234(i1,i2,i3,i4)%a(iut
     & ,jut)+l7_12(i1,i2)%a(iut,1)*cx1+l7_12(i1,i2)%c(iut,1)*cy1
     & +l7_12(i1,i2)%a(iut,2)*cx2+l7_12(i1,i2)%c(iut,2)*cy2
      u7_1234(i1,i2,i3,i4)%b(iut,jut)=u7_1234(i1,i2,i3,i4)%b(iut
     & ,jut)+l7_12(i1,i2)%b(iut,1)*cx1+l7_12(i1,i2)%d(iut,1)*cy1
     & +l7_12(i1,i2)%b(iut,2)*cx2+l7_12(i1,i2)%d(iut,2)*cy2
      cw1=u712_34(i3,i4)%c(1,jut)+rmass(id7)*u712_34(i3,i4)%d(1,
     & jut)
      cw2=u712_34(i3,i4)%c(2,jut)+rmass(id7)*u712_34(i3,i4)%d(2,
     & jut)
      cz1=p712q*u712_34(i3,i4)%d(1,jut)+rmass(id7)*u712_34(i3,i4
     & )%c(1,jut)
      cz2=p712q*u712_34(i3,i4)%d(2,jut)+rmass(id7)*u712_34(i3,i4
     & )%c(2,jut)
      u7_1234(i1,i2,i3,i4)%c(iut,jut)=u7_1234(i1,i2,i3,i4)%c(iut
     & ,jut)+l7_12(i1,i2)%a(iut,1)*cw1+l7_12(i1,i2)%c(iut,1)*cz1
     & +l7_12(i1,i2)%a(iut,2)*cw2+l7_12(i1,i2)%c(iut,2)*cz2
      u7_1234(i1,i2,i3,i4)%d(iut,jut)=u7_1234(i1,i2,i3,i4)%d(iut
     & ,jut)+l7_12(i1,i2)%b(iut,1)*cw1+l7_12(i1,i2)%d(iut,1)*cz1
     & +l7_12(i1,i2)%b(iut,2)*cw2+l7_12(i1,i2)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id7.eq.5.and.id1.eq.5.and.id3.ne.5)then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=u7_1234(i1,i2,i3,i4)%a,bb=u7_1234(i1,i2,i3,i4)%b,cc=u7_1234(
* i1,i2,i3,i4)%c,dd=u7_1234(i1,i2,i3,i4)%d,a1=l7_12(i1,i2)%a,b1=l7_12(i1
* ,i2)%b,c1=l7_12(i1,i2)%c,d1=l7_12(i1,i2)%d,a2=u712_34(i3,i4)%a,b2=u712
* _34(i3,i4)%b,c2=u712_34(i3,i4)%c,d2=u712_34(i3,i4)%d,prq=p712q,m=rmass
* (id7),nsum=1
      do iut=1,2
      cx1=l7_12(i1,i2)%a(iut,1)+l7_12(i1,i2)%c(iut,1)*rmass(id7)
      cx2=l7_12(i1,i2)%c(iut,2)*p712q+l7_12(i1,i2)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_12(i1,i2)%b(iut,1)+l7_12(i1,i2)%d(iut,1)*rmass(id7)
      cy2=l7_12(i1,i2)%d(iut,2)*p712q+l7_12(i1,i2)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_12(i1,i2)%c(iut,1)*p712q+l7_12(i1,i2)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_12(i1,i2)%a(iut,2)+l7_12(i1,i2)%c(iut,2)*rmass(id7)
      cz1=l7_12(i1,i2)%d(iut,1)*p712q+l7_12(i1,i2)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_12(i1,i2)%b(iut,2)+l7_12(i1,i2)%d(iut,2)*rmass(id7)
      u7_1234(i1,i2,i3,i4)%a(iut,1)=u7_1234(i1,i2,i3,i4)%a(iut,1
     & )+cx1*u712_34(i3,i4)%a(1,1)+cx2*u712_34(i3,i4)%b(2,1)
      u7_1234(i1,i2,i3,i4)%b(iut,1)=u7_1234(i1,i2,i3,i4)%b(iut,1
     & )+cy1*u712_34(i3,i4)%a(1,1)+cy2*u712_34(i3,i4)%b(2,1)
      u7_1234(i1,i2,i3,i4)%c(iut,1)=u7_1234(i1,i2,i3,i4)%c(iut,1
     & )+cw1*u712_34(i3,i4)%d(1,1)+cw2*u712_34(i3,i4)%c(2,1)
      u7_1234(i1,i2,i3,i4)%d(iut,1)=u7_1234(i1,i2,i3,i4)%d(iut,1
     & )+cz1*u712_34(i3,i4)%d(1,1)+cz2*u712_34(i3,i4)%c(2,1)
      u7_1234(i1,i2,i3,i4)%a(iut,2)=u7_1234(i1,i2,i3,i4)%a(iut,2
     & )+cw1*u712_34(i3,i4)%b(1,2)+cw2*u712_34(i3,i4)%a(2,2)
      u7_1234(i1,i2,i3,i4)%b(iut,2)=u7_1234(i1,i2,i3,i4)%b(iut,2
     & )+cz1*u712_34(i3,i4)%b(1,2)+cz2*u712_34(i3,i4)%a(2,2)
      u7_1234(i1,i2,i3,i4)%c(iut,2)=u7_1234(i1,i2,i3,i4)%c(iut,2
     & )+cx1*u712_34(i3,i4)%c(1,2)+cx2*u712_34(i3,i4)%d(2,2)
      u7_1234(i1,i2,i3,i4)%d(iut,2)=u7_1234(i1,i2,i3,i4)%d(iut,2
     & )+cy1*u712_34(i3,i4)%c(1,2)+cy2*u712_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id7.eq.5.and.id1.ne.5.and.id3.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TTs -- aa=u7_1234(i1,i2,i3,i4)%a,bb=u7_1234(i1,i2,i3,i4)%b,cc=u7_1234(
* i1,i2,i3,i4)%c,dd=u7_1234(i1,i2,i3,i4)%d,a1=l7_12(i1,i2)%a,b1=l7_12(i1
* ,i2)%b,c1=l7_12(i1,i2)%c,d1=l7_12(i1,i2)%d,a2=u712_34(i3,i4)%a,b2=u712
* _34(i3,i4)%b,c2=u712_34(i3,i4)%c,d2=u712_34(i3,i4)%d,prq=p712q,m=rmass
* (id7),nsum=1
      do jut=1,2
      cx1=u712_34(i3,i4)%a(1,jut)+rmass(id7)*u712_34(i3,i4)%b(1,
     & jut)
      cx2=u712_34(i3,i4)%a(2,jut)+rmass(id7)*u712_34(i3,i4)%b(2,
     & jut)
      cy1=p712q*u712_34(i3,i4)%b(1,jut)+rmass(id7)*u712_34(i3,i4
     & )%a(1,jut)
      cy2=p712q*u712_34(i3,i4)%b(2,jut)+rmass(id7)*u712_34(i3,i4
     & )%a(2,jut)
      cw1=u712_34(i3,i4)%c(1,jut)+rmass(id7)*u712_34(i3,i4)%d(1,
     & jut)
      cw2=u712_34(i3,i4)%c(2,jut)+rmass(id7)*u712_34(i3,i4)%d(2,
     & jut)
      cz1=p712q*u712_34(i3,i4)%d(1,jut)+rmass(id7)*u712_34(i3,i4
     & )%c(1,jut)
      cz2=p712q*u712_34(i3,i4)%d(2,jut)+rmass(id7)*u712_34(i3,i4
     & )%c(2,jut)
      u7_1234(i1,i2,i3,i4)%a(1,jut)=u7_1234(i1,i2,i3,i4)%a(1,jut
     & )+l7_12(i1,i2)%a(1,1)*cx1+l7_12(i1,i2)%c(1,2)*cy2
      u7_1234(i1,i2,i3,i4)%b(1,jut)=u7_1234(i1,i2,i3,i4)%b(1,jut
     & )+l7_12(i1,i2)%d(1,1)*cy1+l7_12(i1,i2)%b(1,2)*cx2
      u7_1234(i1,i2,i3,i4)%c(1,jut)=u7_1234(i1,i2,i3,i4)%c(1,jut
     & )+l7_12(i1,i2)%a(1,1)*cw1+l7_12(i1,i2)%c(1,2)*cz2
      u7_1234(i1,i2,i3,i4)%d(1,jut)=u7_1234(i1,i2,i3,i4)%d(1,jut
     & )+l7_12(i1,i2)%d(1,1)*cz1+l7_12(i1,i2)%b(1,2)*cw2
      u7_1234(i1,i2,i3,i4)%a(2,jut)=u7_1234(i1,i2,i3,i4)%a(2,jut
     & )+l7_12(i1,i2)%c(2,1)*cy1+l7_12(i1,i2)%a(2,2)*cx2
      u7_1234(i1,i2,i3,i4)%b(2,jut)=u7_1234(i1,i2,i3,i4)%b(2,jut
     & )+l7_12(i1,i2)%b(2,1)*cx1+l7_12(i1,i2)%d(2,2)*cy2
      u7_1234(i1,i2,i3,i4)%c(2,jut)=u7_1234(i1,i2,i3,i4)%c(2,jut
     & )+l7_12(i1,i2)%c(2,1)*cz1+l7_12(i1,i2)%a(2,2)*cw2
      u7_1234(i1,i2,i3,i4)%d(2,jut)=u7_1234(i1,i2,i3,i4)%d(2,jut
     & )+l7_12(i1,i2)%b(2,1)*cw1+l7_12(i1,i2)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p734q,p=p734,q=p734,bef=,aft=
      p734q=(p734(0)*p734(0)-p734(1)*p734(1)-p734(2)*p734(2)-p73
     & 4(3)*p734(3))
  
      if(id7.ne.5.or.(id3.ne.5.and.id1.ne.5))then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=u7_1234(i1,i2,i3,i4)%a,bb=u7_1234(i1,i2,i3,i4)%b,cc=u7_1234(i
* 1,i2,i3,i4)%c,dd=u7_1234(i1,i2,i3,i4)%d,a1=l7_34(i3,i4)%a,b1=l7_34(i3,
* i4)%b,c1=l7_34(i3,i4)%c,d1=l7_34(i3,i4)%d,a2=u734_12(i1,i2)%a,b2=u734_
* 12(i1,i2)%b,c2=u734_12(i1,i2)%c,d2=u734_12(i1,i2)%d,prq=p734q,m=rmass(
* id7),nsum=1
      u7_1234(i1,i2,i3,i4)%a(1,1)=u7_1234(i1,i2,i3,i4)%a(1,1)+l7
     & _34(i3,i4)%a(1,1)*u734_12(i1,i2)%a(1,1)+l7_34(i3,i4)%c(1,
     & 2)*p734q*u734_12(i1,i2)%b(2,1)
      u7_1234(i1,i2,i3,i4)%b(1,1)=u7_1234(i1,i2,i3,i4)%b(1,1)+rm
     & ass(id7)*(l7_34(i3,i4)%d(1,1)*u734_12(i1,i2)%a(1,1)+l7_34
     & (i3,i4)%b(1,2)*u734_12(i1,i2)%b(2,1))
      u7_1234(i1,i2,i3,i4)%c(1,1)=u7_1234(i1,i2,i3,i4)%c(1,1)+rm
     & ass(id7)*(l7_34(i3,i4)%a(1,1)*u734_12(i1,i2)%d(1,1)+l7_34
     & (i3,i4)%c(1,2)*u734_12(i1,i2)%c(2,1))
      u7_1234(i1,i2,i3,i4)%d(1,1)=u7_1234(i1,i2,i3,i4)%d(1,1)+l7
     & _34(i3,i4)%d(1,1)*p734q*u734_12(i1,i2)%d(1,1)+l7_34(i3,i4
     & )%b(1,2)*u734_12(i1,i2)%c(2,1)
      u7_1234(i1,i2,i3,i4)%a(1,2)=u7_1234(i1,i2,i3,i4)%a(1,2)+rm
     & ass(id7)*(l7_34(i3,i4)%a(1,1)*u734_12(i1,i2)%b(1,2)+l7_34
     & (i3,i4)%c(1,2)*u734_12(i1,i2)%a(2,2))
      u7_1234(i1,i2,i3,i4)%b(1,2)=u7_1234(i1,i2,i3,i4)%b(1,2)+l7
     & _34(i3,i4)%d(1,1)*p734q*u734_12(i1,i2)%b(1,2)+l7_34(i3,i4
     & )%b(1,2)*u734_12(i1,i2)%a(2,2)
      u7_1234(i1,i2,i3,i4)%c(1,2)=u7_1234(i1,i2,i3,i4)%c(1,2)+l7
     & _34(i3,i4)%a(1,1)*u734_12(i1,i2)%c(1,2)+l7_34(i3,i4)%c(1,
     & 2)*p734q*u734_12(i1,i2)%d(2,2)
      u7_1234(i1,i2,i3,i4)%d(1,2)=u7_1234(i1,i2,i3,i4)%d(1,2)+rm
     & ass(id7)*(l7_34(i3,i4)%d(1,1)*u734_12(i1,i2)%c(1,2)+l7_34
     & (i3,i4)%b(1,2)*u734_12(i1,i2)%d(2,2))
      u7_1234(i1,i2,i3,i4)%a(2,1)=u7_1234(i1,i2,i3,i4)%a(2,1)+rm
     & ass(id7)*(l7_34(i3,i4)%c(2,1)*u734_12(i1,i2)%a(1,1)+l7_34
     & (i3,i4)%a(2,2)*u734_12(i1,i2)%b(2,1))
      u7_1234(i1,i2,i3,i4)%b(2,1)=u7_1234(i1,i2,i3,i4)%b(2,1)+l7
     & _34(i3,i4)%b(2,1)*u734_12(i1,i2)%a(1,1)+l7_34(i3,i4)%d(2,
     & 2)*p734q*u734_12(i1,i2)%b(2,1)
      u7_1234(i1,i2,i3,i4)%c(2,1)=u7_1234(i1,i2,i3,i4)%c(2,1)+l7
     & _34(i3,i4)%c(2,1)*p734q*u734_12(i1,i2)%d(1,1)+l7_34(i3,i4
     & )%a(2,2)*u734_12(i1,i2)%c(2,1)
      u7_1234(i1,i2,i3,i4)%d(2,1)=u7_1234(i1,i2,i3,i4)%d(2,1)+rm
     & ass(id7)*(l7_34(i3,i4)%b(2,1)*u734_12(i1,i2)%d(1,1)+l7_34
     & (i3,i4)%d(2,2)*u734_12(i1,i2)%c(2,1))
      u7_1234(i1,i2,i3,i4)%a(2,2)=u7_1234(i1,i2,i3,i4)%a(2,2)+l7
     & _34(i3,i4)%c(2,1)*p734q*u734_12(i1,i2)%b(1,2)+l7_34(i3,i4
     & )%a(2,2)*u734_12(i1,i2)%a(2,2)
      u7_1234(i1,i2,i3,i4)%b(2,2)=u7_1234(i1,i2,i3,i4)%b(2,2)+rm
     & ass(id7)*(l7_34(i3,i4)%b(2,1)*u734_12(i1,i2)%b(1,2)+l7_34
     & (i3,i4)%d(2,2)*u734_12(i1,i2)%a(2,2))
      u7_1234(i1,i2,i3,i4)%c(2,2)=u7_1234(i1,i2,i3,i4)%c(2,2)+rm
     & ass(id7)*(l7_34(i3,i4)%c(2,1)*u734_12(i1,i2)%c(1,2)+l7_34
     & (i3,i4)%a(2,2)*u734_12(i1,i2)%d(2,2))
      u7_1234(i1,i2,i3,i4)%d(2,2)=u7_1234(i1,i2,i3,i4)%d(2,2)+l7
     & _34(i3,i4)%b(2,1)*u734_12(i1,i2)%c(1,2)+l7_34(i3,i4)%d(2,
     & 2)*p734q*u734_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id7.eq.5.and.id3.eq.5.and.id1.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TsTs -- aa=u7_1234(i1,i2,i3,i4)%a,bb=u7_1234(i1,i2,i3,i4)%b,cc=u7_1234
* (i1,i2,i3,i4)%c,dd=u7_1234(i1,i2,i3,i4)%d,a1=l7_34(i3,i4)%a,b1=l7_34(i
* 3,i4)%b,c1=l7_34(i3,i4)%c,d1=l7_34(i3,i4)%d,a2=u734_12(i1,i2)%a,b2=u73
* 4_12(i1,i2)%b,c2=u734_12(i1,i2)%c,d2=u734_12(i1,i2)%d,prq=p734q,m=rmas
* s(id7),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u734_12(i1,i2)%a(1,jut)+rmass(id7)*u734_12(i1,i2)%b(1,
     & jut)
      cx2=u734_12(i1,i2)%a(2,jut)+rmass(id7)*u734_12(i1,i2)%b(2,
     & jut)
      cy1=p734q*u734_12(i1,i2)%b(1,jut)+rmass(id7)*u734_12(i1,i2
     & )%a(1,jut)
      cy2=p734q*u734_12(i1,i2)%b(2,jut)+rmass(id7)*u734_12(i1,i2
     & )%a(2,jut)
      u7_1234(i1,i2,i3,i4)%a(iut,jut)=u7_1234(i1,i2,i3,i4)%a(iut
     & ,jut)+l7_34(i3,i4)%a(iut,1)*cx1+l7_34(i3,i4)%c(iut,1)*cy1
     & +l7_34(i3,i4)%a(iut,2)*cx2+l7_34(i3,i4)%c(iut,2)*cy2
      u7_1234(i1,i2,i3,i4)%b(iut,jut)=u7_1234(i1,i2,i3,i4)%b(iut
     & ,jut)+l7_34(i3,i4)%b(iut,1)*cx1+l7_34(i3,i4)%d(iut,1)*cy1
     & +l7_34(i3,i4)%b(iut,2)*cx2+l7_34(i3,i4)%d(iut,2)*cy2
      cw1=u734_12(i1,i2)%c(1,jut)+rmass(id7)*u734_12(i1,i2)%d(1,
     & jut)
      cw2=u734_12(i1,i2)%c(2,jut)+rmass(id7)*u734_12(i1,i2)%d(2,
     & jut)
      cz1=p734q*u734_12(i1,i2)%d(1,jut)+rmass(id7)*u734_12(i1,i2
     & )%c(1,jut)
      cz2=p734q*u734_12(i1,i2)%d(2,jut)+rmass(id7)*u734_12(i1,i2
     & )%c(2,jut)
      u7_1234(i1,i2,i3,i4)%c(iut,jut)=u7_1234(i1,i2,i3,i4)%c(iut
     & ,jut)+l7_34(i3,i4)%a(iut,1)*cw1+l7_34(i3,i4)%c(iut,1)*cz1
     & +l7_34(i3,i4)%a(iut,2)*cw2+l7_34(i3,i4)%c(iut,2)*cz2
      u7_1234(i1,i2,i3,i4)%d(iut,jut)=u7_1234(i1,i2,i3,i4)%d(iut
     & ,jut)+l7_34(i3,i4)%b(iut,1)*cw1+l7_34(i3,i4)%d(iut,1)*cz1
     & +l7_34(i3,i4)%b(iut,2)*cw2+l7_34(i3,i4)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id7.eq.5.and.id3.eq.5.and.id1.ne.5)then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=u7_1234(i1,i2,i3,i4)%a,bb=u7_1234(i1,i2,i3,i4)%b,cc=u7_1234(
* i1,i2,i3,i4)%c,dd=u7_1234(i1,i2,i3,i4)%d,a1=l7_34(i3,i4)%a,b1=l7_34(i3
* ,i4)%b,c1=l7_34(i3,i4)%c,d1=l7_34(i3,i4)%d,a2=u734_12(i1,i2)%a,b2=u734
* _12(i1,i2)%b,c2=u734_12(i1,i2)%c,d2=u734_12(i1,i2)%d,prq=p734q,m=rmass
* (id7),nsum=1
      do iut=1,2
      cx1=l7_34(i3,i4)%a(iut,1)+l7_34(i3,i4)%c(iut,1)*rmass(id7)
      cx2=l7_34(i3,i4)%c(iut,2)*p734q+l7_34(i3,i4)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_34(i3,i4)%b(iut,1)+l7_34(i3,i4)%d(iut,1)*rmass(id7)
      cy2=l7_34(i3,i4)%d(iut,2)*p734q+l7_34(i3,i4)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_34(i3,i4)%c(iut,1)*p734q+l7_34(i3,i4)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_34(i3,i4)%a(iut,2)+l7_34(i3,i4)%c(iut,2)*rmass(id7)
      cz1=l7_34(i3,i4)%d(iut,1)*p734q+l7_34(i3,i4)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_34(i3,i4)%b(iut,2)+l7_34(i3,i4)%d(iut,2)*rmass(id7)
      u7_1234(i1,i2,i3,i4)%a(iut,1)=u7_1234(i1,i2,i3,i4)%a(iut,1
     & )+cx1*u734_12(i1,i2)%a(1,1)+cx2*u734_12(i1,i2)%b(2,1)
      u7_1234(i1,i2,i3,i4)%b(iut,1)=u7_1234(i1,i2,i3,i4)%b(iut,1
     & )+cy1*u734_12(i1,i2)%a(1,1)+cy2*u734_12(i1,i2)%b(2,1)
      u7_1234(i1,i2,i3,i4)%c(iut,1)=u7_1234(i1,i2,i3,i4)%c(iut,1
     & )+cw1*u734_12(i1,i2)%d(1,1)+cw2*u734_12(i1,i2)%c(2,1)
      u7_1234(i1,i2,i3,i4)%d(iut,1)=u7_1234(i1,i2,i3,i4)%d(iut,1
     & )+cz1*u734_12(i1,i2)%d(1,1)+cz2*u734_12(i1,i2)%c(2,1)
      u7_1234(i1,i2,i3,i4)%a(iut,2)=u7_1234(i1,i2,i3,i4)%a(iut,2
     & )+cw1*u734_12(i1,i2)%b(1,2)+cw2*u734_12(i1,i2)%a(2,2)
      u7_1234(i1,i2,i3,i4)%b(iut,2)=u7_1234(i1,i2,i3,i4)%b(iut,2
     & )+cz1*u734_12(i1,i2)%b(1,2)+cz2*u734_12(i1,i2)%a(2,2)
      u7_1234(i1,i2,i3,i4)%c(iut,2)=u7_1234(i1,i2,i3,i4)%c(iut,2
     & )+cx1*u734_12(i1,i2)%c(1,2)+cx2*u734_12(i1,i2)%d(2,2)
      u7_1234(i1,i2,i3,i4)%d(iut,2)=u7_1234(i1,i2,i3,i4)%d(iut,2
     & )+cy1*u734_12(i1,i2)%c(1,2)+cy2*u734_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id7.eq.5.and.id3.ne.5.and.id1.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TTs -- aa=u7_1234(i1,i2,i3,i4)%a,bb=u7_1234(i1,i2,i3,i4)%b,cc=u7_1234(
* i1,i2,i3,i4)%c,dd=u7_1234(i1,i2,i3,i4)%d,a1=l7_34(i3,i4)%a,b1=l7_34(i3
* ,i4)%b,c1=l7_34(i3,i4)%c,d1=l7_34(i3,i4)%d,a2=u734_12(i1,i2)%a,b2=u734
* _12(i1,i2)%b,c2=u734_12(i1,i2)%c,d2=u734_12(i1,i2)%d,prq=p734q,m=rmass
* (id7),nsum=1
      do jut=1,2
      cx1=u734_12(i1,i2)%a(1,jut)+rmass(id7)*u734_12(i1,i2)%b(1,
     & jut)
      cx2=u734_12(i1,i2)%a(2,jut)+rmass(id7)*u734_12(i1,i2)%b(2,
     & jut)
      cy1=p734q*u734_12(i1,i2)%b(1,jut)+rmass(id7)*u734_12(i1,i2
     & )%a(1,jut)
      cy2=p734q*u734_12(i1,i2)%b(2,jut)+rmass(id7)*u734_12(i1,i2
     & )%a(2,jut)
      cw1=u734_12(i1,i2)%c(1,jut)+rmass(id7)*u734_12(i1,i2)%d(1,
     & jut)
      cw2=u734_12(i1,i2)%c(2,jut)+rmass(id7)*u734_12(i1,i2)%d(2,
     & jut)
      cz1=p734q*u734_12(i1,i2)%d(1,jut)+rmass(id7)*u734_12(i1,i2
     & )%c(1,jut)
      cz2=p734q*u734_12(i1,i2)%d(2,jut)+rmass(id7)*u734_12(i1,i2
     & )%c(2,jut)
      u7_1234(i1,i2,i3,i4)%a(1,jut)=u7_1234(i1,i2,i3,i4)%a(1,jut
     & )+l7_34(i3,i4)%a(1,1)*cx1+l7_34(i3,i4)%c(1,2)*cy2
      u7_1234(i1,i2,i3,i4)%b(1,jut)=u7_1234(i1,i2,i3,i4)%b(1,jut
     & )+l7_34(i3,i4)%d(1,1)*cy1+l7_34(i3,i4)%b(1,2)*cx2
      u7_1234(i1,i2,i3,i4)%c(1,jut)=u7_1234(i1,i2,i3,i4)%c(1,jut
     & )+l7_34(i3,i4)%a(1,1)*cw1+l7_34(i3,i4)%c(1,2)*cz2
      u7_1234(i1,i2,i3,i4)%d(1,jut)=u7_1234(i1,i2,i3,i4)%d(1,jut
     & )+l7_34(i3,i4)%d(1,1)*cz1+l7_34(i3,i4)%b(1,2)*cw2
      u7_1234(i1,i2,i3,i4)%a(2,jut)=u7_1234(i1,i2,i3,i4)%a(2,jut
     & )+l7_34(i3,i4)%c(2,1)*cy1+l7_34(i3,i4)%a(2,2)*cx2
      u7_1234(i1,i2,i3,i4)%b(2,jut)=u7_1234(i1,i2,i3,i4)%b(2,jut
     & )+l7_34(i3,i4)%b(2,1)*cx1+l7_34(i3,i4)%d(2,2)*cy2
      u7_1234(i1,i2,i3,i4)%c(2,jut)=u7_1234(i1,i2,i3,i4)%c(2,jut
     & )+l7_34(i3,i4)%c(2,1)*cz1+l7_34(i3,i4)%a(2,2)*cw2
      u7_1234(i1,i2,i3,i4)%d(2,jut)=u7_1234(i1,i2,i3,i4)%d(2,jut
     & )+l7_34(i3,i4)%b(2,1)*cw1+l7_34(i3,i4)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p712q,p=p712,q=p712,bef=,aft=
      p712q=(p712(0)*p712(0)-p712(1)*p712(1)-p712(2)*p712(2)-p71
     & 2(3)*p712(3))
  
      if(id7.ne.5.or.(id1.ne.5.and.id5.ne.5))then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=u7_1256(i1,i2,i5,i6)%a,bb=u7_1256(i1,i2,i5,i6)%b,cc=u7_1256(i
* 1,i2,i5,i6)%c,dd=u7_1256(i1,i2,i5,i6)%d,a1=l7_12(i1,i2)%a,b1=l7_12(i1,
* i2)%b,c1=l7_12(i1,i2)%c,d1=l7_12(i1,i2)%d,a2=u712_56(i5,i6)%a,b2=u712_
* 56(i5,i6)%b,c2=u712_56(i5,i6)%c,d2=u712_56(i5,i6)%d,prq=p712q,m=rmass(
* id7),nsum=1
      u7_1256(i1,i2,i5,i6)%a(1,1)=u7_1256(i1,i2,i5,i6)%a(1,1)+l7
     & _12(i1,i2)%a(1,1)*u712_56(i5,i6)%a(1,1)+l7_12(i1,i2)%c(1,
     & 2)*p712q*u712_56(i5,i6)%b(2,1)
      u7_1256(i1,i2,i5,i6)%b(1,1)=u7_1256(i1,i2,i5,i6)%b(1,1)+rm
     & ass(id7)*(l7_12(i1,i2)%d(1,1)*u712_56(i5,i6)%a(1,1)+l7_12
     & (i1,i2)%b(1,2)*u712_56(i5,i6)%b(2,1))
      u7_1256(i1,i2,i5,i6)%c(1,1)=u7_1256(i1,i2,i5,i6)%c(1,1)+rm
     & ass(id7)*(l7_12(i1,i2)%a(1,1)*u712_56(i5,i6)%d(1,1)+l7_12
     & (i1,i2)%c(1,2)*u712_56(i5,i6)%c(2,1))
      u7_1256(i1,i2,i5,i6)%d(1,1)=u7_1256(i1,i2,i5,i6)%d(1,1)+l7
     & _12(i1,i2)%d(1,1)*p712q*u712_56(i5,i6)%d(1,1)+l7_12(i1,i2
     & )%b(1,2)*u712_56(i5,i6)%c(2,1)
      u7_1256(i1,i2,i5,i6)%a(1,2)=u7_1256(i1,i2,i5,i6)%a(1,2)+rm
     & ass(id7)*(l7_12(i1,i2)%a(1,1)*u712_56(i5,i6)%b(1,2)+l7_12
     & (i1,i2)%c(1,2)*u712_56(i5,i6)%a(2,2))
      u7_1256(i1,i2,i5,i6)%b(1,2)=u7_1256(i1,i2,i5,i6)%b(1,2)+l7
     & _12(i1,i2)%d(1,1)*p712q*u712_56(i5,i6)%b(1,2)+l7_12(i1,i2
     & )%b(1,2)*u712_56(i5,i6)%a(2,2)
      u7_1256(i1,i2,i5,i6)%c(1,2)=u7_1256(i1,i2,i5,i6)%c(1,2)+l7
     & _12(i1,i2)%a(1,1)*u712_56(i5,i6)%c(1,2)+l7_12(i1,i2)%c(1,
     & 2)*p712q*u712_56(i5,i6)%d(2,2)
      u7_1256(i1,i2,i5,i6)%d(1,2)=u7_1256(i1,i2,i5,i6)%d(1,2)+rm
     & ass(id7)*(l7_12(i1,i2)%d(1,1)*u712_56(i5,i6)%c(1,2)+l7_12
     & (i1,i2)%b(1,2)*u712_56(i5,i6)%d(2,2))
      u7_1256(i1,i2,i5,i6)%a(2,1)=u7_1256(i1,i2,i5,i6)%a(2,1)+rm
     & ass(id7)*(l7_12(i1,i2)%c(2,1)*u712_56(i5,i6)%a(1,1)+l7_12
     & (i1,i2)%a(2,2)*u712_56(i5,i6)%b(2,1))
      u7_1256(i1,i2,i5,i6)%b(2,1)=u7_1256(i1,i2,i5,i6)%b(2,1)+l7
     & _12(i1,i2)%b(2,1)*u712_56(i5,i6)%a(1,1)+l7_12(i1,i2)%d(2,
     & 2)*p712q*u712_56(i5,i6)%b(2,1)
      u7_1256(i1,i2,i5,i6)%c(2,1)=u7_1256(i1,i2,i5,i6)%c(2,1)+l7
     & _12(i1,i2)%c(2,1)*p712q*u712_56(i5,i6)%d(1,1)+l7_12(i1,i2
     & )%a(2,2)*u712_56(i5,i6)%c(2,1)
      u7_1256(i1,i2,i5,i6)%d(2,1)=u7_1256(i1,i2,i5,i6)%d(2,1)+rm
     & ass(id7)*(l7_12(i1,i2)%b(2,1)*u712_56(i5,i6)%d(1,1)+l7_12
     & (i1,i2)%d(2,2)*u712_56(i5,i6)%c(2,1))
      u7_1256(i1,i2,i5,i6)%a(2,2)=u7_1256(i1,i2,i5,i6)%a(2,2)+l7
     & _12(i1,i2)%c(2,1)*p712q*u712_56(i5,i6)%b(1,2)+l7_12(i1,i2
     & )%a(2,2)*u712_56(i5,i6)%a(2,2)
      u7_1256(i1,i2,i5,i6)%b(2,2)=u7_1256(i1,i2,i5,i6)%b(2,2)+rm
     & ass(id7)*(l7_12(i1,i2)%b(2,1)*u712_56(i5,i6)%b(1,2)+l7_12
     & (i1,i2)%d(2,2)*u712_56(i5,i6)%a(2,2))
      u7_1256(i1,i2,i5,i6)%c(2,2)=u7_1256(i1,i2,i5,i6)%c(2,2)+rm
     & ass(id7)*(l7_12(i1,i2)%c(2,1)*u712_56(i5,i6)%c(1,2)+l7_12
     & (i1,i2)%a(2,2)*u712_56(i5,i6)%d(2,2))
      u7_1256(i1,i2,i5,i6)%d(2,2)=u7_1256(i1,i2,i5,i6)%d(2,2)+l7
     & _12(i1,i2)%b(2,1)*u712_56(i5,i6)%c(1,2)+l7_12(i1,i2)%d(2,
     & 2)*p712q*u712_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id7.eq.5.and.id1.eq.5.and.id5.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=u7_1256(i1,i2,i5,i6)%a,bb=u7_1256(i1,i2,i5,i6)%b,cc=u7_1256
* (i1,i2,i5,i6)%c,dd=u7_1256(i1,i2,i5,i6)%d,a1=l7_12(i1,i2)%a,b1=l7_12(i
* 1,i2)%b,c1=l7_12(i1,i2)%c,d1=l7_12(i1,i2)%d,a2=u712_56(i5,i6)%a,b2=u71
* 2_56(i5,i6)%b,c2=u712_56(i5,i6)%c,d2=u712_56(i5,i6)%d,prq=p712q,m=rmas
* s(id7),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u712_56(i5,i6)%a(1,jut)+rmass(id7)*u712_56(i5,i6)%b(1,
     & jut)
      cx2=u712_56(i5,i6)%a(2,jut)+rmass(id7)*u712_56(i5,i6)%b(2,
     & jut)
      cy1=p712q*u712_56(i5,i6)%b(1,jut)+rmass(id7)*u712_56(i5,i6
     & )%a(1,jut)
      cy2=p712q*u712_56(i5,i6)%b(2,jut)+rmass(id7)*u712_56(i5,i6
     & )%a(2,jut)
      u7_1256(i1,i2,i5,i6)%a(iut,jut)=u7_1256(i1,i2,i5,i6)%a(iut
     & ,jut)+l7_12(i1,i2)%a(iut,1)*cx1+l7_12(i1,i2)%c(iut,1)*cy1
     & +l7_12(i1,i2)%a(iut,2)*cx2+l7_12(i1,i2)%c(iut,2)*cy2
      u7_1256(i1,i2,i5,i6)%b(iut,jut)=u7_1256(i1,i2,i5,i6)%b(iut
     & ,jut)+l7_12(i1,i2)%b(iut,1)*cx1+l7_12(i1,i2)%d(iut,1)*cy1
     & +l7_12(i1,i2)%b(iut,2)*cx2+l7_12(i1,i2)%d(iut,2)*cy2
      cw1=u712_56(i5,i6)%c(1,jut)+rmass(id7)*u712_56(i5,i6)%d(1,
     & jut)
      cw2=u712_56(i5,i6)%c(2,jut)+rmass(id7)*u712_56(i5,i6)%d(2,
     & jut)
      cz1=p712q*u712_56(i5,i6)%d(1,jut)+rmass(id7)*u712_56(i5,i6
     & )%c(1,jut)
      cz2=p712q*u712_56(i5,i6)%d(2,jut)+rmass(id7)*u712_56(i5,i6
     & )%c(2,jut)
      u7_1256(i1,i2,i5,i6)%c(iut,jut)=u7_1256(i1,i2,i5,i6)%c(iut
     & ,jut)+l7_12(i1,i2)%a(iut,1)*cw1+l7_12(i1,i2)%c(iut,1)*cz1
     & +l7_12(i1,i2)%a(iut,2)*cw2+l7_12(i1,i2)%c(iut,2)*cz2
      u7_1256(i1,i2,i5,i6)%d(iut,jut)=u7_1256(i1,i2,i5,i6)%d(iut
     & ,jut)+l7_12(i1,i2)%b(iut,1)*cw1+l7_12(i1,i2)%d(iut,1)*cz1
     & +l7_12(i1,i2)%b(iut,2)*cw2+l7_12(i1,i2)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id7.eq.5.and.id1.eq.5.and.id5.ne.5)then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=u7_1256(i1,i2,i5,i6)%a,bb=u7_1256(i1,i2,i5,i6)%b,cc=u7_1256(
* i1,i2,i5,i6)%c,dd=u7_1256(i1,i2,i5,i6)%d,a1=l7_12(i1,i2)%a,b1=l7_12(i1
* ,i2)%b,c1=l7_12(i1,i2)%c,d1=l7_12(i1,i2)%d,a2=u712_56(i5,i6)%a,b2=u712
* _56(i5,i6)%b,c2=u712_56(i5,i6)%c,d2=u712_56(i5,i6)%d,prq=p712q,m=rmass
* (id7),nsum=1
      do iut=1,2
      cx1=l7_12(i1,i2)%a(iut,1)+l7_12(i1,i2)%c(iut,1)*rmass(id7)
      cx2=l7_12(i1,i2)%c(iut,2)*p712q+l7_12(i1,i2)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_12(i1,i2)%b(iut,1)+l7_12(i1,i2)%d(iut,1)*rmass(id7)
      cy2=l7_12(i1,i2)%d(iut,2)*p712q+l7_12(i1,i2)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_12(i1,i2)%c(iut,1)*p712q+l7_12(i1,i2)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_12(i1,i2)%a(iut,2)+l7_12(i1,i2)%c(iut,2)*rmass(id7)
      cz1=l7_12(i1,i2)%d(iut,1)*p712q+l7_12(i1,i2)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_12(i1,i2)%b(iut,2)+l7_12(i1,i2)%d(iut,2)*rmass(id7)
      u7_1256(i1,i2,i5,i6)%a(iut,1)=u7_1256(i1,i2,i5,i6)%a(iut,1
     & )+cx1*u712_56(i5,i6)%a(1,1)+cx2*u712_56(i5,i6)%b(2,1)
      u7_1256(i1,i2,i5,i6)%b(iut,1)=u7_1256(i1,i2,i5,i6)%b(iut,1
     & )+cy1*u712_56(i5,i6)%a(1,1)+cy2*u712_56(i5,i6)%b(2,1)
      u7_1256(i1,i2,i5,i6)%c(iut,1)=u7_1256(i1,i2,i5,i6)%c(iut,1
     & )+cw1*u712_56(i5,i6)%d(1,1)+cw2*u712_56(i5,i6)%c(2,1)
      u7_1256(i1,i2,i5,i6)%d(iut,1)=u7_1256(i1,i2,i5,i6)%d(iut,1
     & )+cz1*u712_56(i5,i6)%d(1,1)+cz2*u712_56(i5,i6)%c(2,1)
      u7_1256(i1,i2,i5,i6)%a(iut,2)=u7_1256(i1,i2,i5,i6)%a(iut,2
     & )+cw1*u712_56(i5,i6)%b(1,2)+cw2*u712_56(i5,i6)%a(2,2)
      u7_1256(i1,i2,i5,i6)%b(iut,2)=u7_1256(i1,i2,i5,i6)%b(iut,2
     & )+cz1*u712_56(i5,i6)%b(1,2)+cz2*u712_56(i5,i6)%a(2,2)
      u7_1256(i1,i2,i5,i6)%c(iut,2)=u7_1256(i1,i2,i5,i6)%c(iut,2
     & )+cx1*u712_56(i5,i6)%c(1,2)+cx2*u712_56(i5,i6)%d(2,2)
      u7_1256(i1,i2,i5,i6)%d(iut,2)=u7_1256(i1,i2,i5,i6)%d(iut,2
     & )+cy1*u712_56(i5,i6)%c(1,2)+cy2*u712_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id7.eq.5.and.id1.ne.5.and.id5.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TTs -- aa=u7_1256(i1,i2,i5,i6)%a,bb=u7_1256(i1,i2,i5,i6)%b,cc=u7_1256(
* i1,i2,i5,i6)%c,dd=u7_1256(i1,i2,i5,i6)%d,a1=l7_12(i1,i2)%a,b1=l7_12(i1
* ,i2)%b,c1=l7_12(i1,i2)%c,d1=l7_12(i1,i2)%d,a2=u712_56(i5,i6)%a,b2=u712
* _56(i5,i6)%b,c2=u712_56(i5,i6)%c,d2=u712_56(i5,i6)%d,prq=p712q,m=rmass
* (id7),nsum=1
      do jut=1,2
      cx1=u712_56(i5,i6)%a(1,jut)+rmass(id7)*u712_56(i5,i6)%b(1,
     & jut)
      cx2=u712_56(i5,i6)%a(2,jut)+rmass(id7)*u712_56(i5,i6)%b(2,
     & jut)
      cy1=p712q*u712_56(i5,i6)%b(1,jut)+rmass(id7)*u712_56(i5,i6
     & )%a(1,jut)
      cy2=p712q*u712_56(i5,i6)%b(2,jut)+rmass(id7)*u712_56(i5,i6
     & )%a(2,jut)
      cw1=u712_56(i5,i6)%c(1,jut)+rmass(id7)*u712_56(i5,i6)%d(1,
     & jut)
      cw2=u712_56(i5,i6)%c(2,jut)+rmass(id7)*u712_56(i5,i6)%d(2,
     & jut)
      cz1=p712q*u712_56(i5,i6)%d(1,jut)+rmass(id7)*u712_56(i5,i6
     & )%c(1,jut)
      cz2=p712q*u712_56(i5,i6)%d(2,jut)+rmass(id7)*u712_56(i5,i6
     & )%c(2,jut)
      u7_1256(i1,i2,i5,i6)%a(1,jut)=u7_1256(i1,i2,i5,i6)%a(1,jut
     & )+l7_12(i1,i2)%a(1,1)*cx1+l7_12(i1,i2)%c(1,2)*cy2
      u7_1256(i1,i2,i5,i6)%b(1,jut)=u7_1256(i1,i2,i5,i6)%b(1,jut
     & )+l7_12(i1,i2)%d(1,1)*cy1+l7_12(i1,i2)%b(1,2)*cx2
      u7_1256(i1,i2,i5,i6)%c(1,jut)=u7_1256(i1,i2,i5,i6)%c(1,jut
     & )+l7_12(i1,i2)%a(1,1)*cw1+l7_12(i1,i2)%c(1,2)*cz2
      u7_1256(i1,i2,i5,i6)%d(1,jut)=u7_1256(i1,i2,i5,i6)%d(1,jut
     & )+l7_12(i1,i2)%d(1,1)*cz1+l7_12(i1,i2)%b(1,2)*cw2
      u7_1256(i1,i2,i5,i6)%a(2,jut)=u7_1256(i1,i2,i5,i6)%a(2,jut
     & )+l7_12(i1,i2)%c(2,1)*cy1+l7_12(i1,i2)%a(2,2)*cx2
      u7_1256(i1,i2,i5,i6)%b(2,jut)=u7_1256(i1,i2,i5,i6)%b(2,jut
     & )+l7_12(i1,i2)%b(2,1)*cx1+l7_12(i1,i2)%d(2,2)*cy2
      u7_1256(i1,i2,i5,i6)%c(2,jut)=u7_1256(i1,i2,i5,i6)%c(2,jut
     & )+l7_12(i1,i2)%c(2,1)*cz1+l7_12(i1,i2)%a(2,2)*cw2
      u7_1256(i1,i2,i5,i6)%d(2,jut)=u7_1256(i1,i2,i5,i6)%d(2,jut
     & )+l7_12(i1,i2)%b(2,1)*cw1+l7_12(i1,i2)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p756q,p=p756,q=p756,bef=,aft=
      p756q=(p756(0)*p756(0)-p756(1)*p756(1)-p756(2)*p756(2)-p75
     & 6(3)*p756(3))
  
      if(id7.ne.5.or.(id5.ne.5.and.id1.ne.5))then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=u7_1256(i1,i2,i5,i6)%a,bb=u7_1256(i1,i2,i5,i6)%b,cc=u7_1256(i
* 1,i2,i5,i6)%c,dd=u7_1256(i1,i2,i5,i6)%d,a1=l7_56(i5,i6)%a,b1=l7_56(i5,
* i6)%b,c1=l7_56(i5,i6)%c,d1=l7_56(i5,i6)%d,a2=u756_12(i1,i2)%a,b2=u756_
* 12(i1,i2)%b,c2=u756_12(i1,i2)%c,d2=u756_12(i1,i2)%d,prq=p756q,m=rmass(
* id7),nsum=1
      u7_1256(i1,i2,i5,i6)%a(1,1)=u7_1256(i1,i2,i5,i6)%a(1,1)+l7
     & _56(i5,i6)%a(1,1)*u756_12(i1,i2)%a(1,1)+l7_56(i5,i6)%c(1,
     & 2)*p756q*u756_12(i1,i2)%b(2,1)
      u7_1256(i1,i2,i5,i6)%b(1,1)=u7_1256(i1,i2,i5,i6)%b(1,1)+rm
     & ass(id7)*(l7_56(i5,i6)%d(1,1)*u756_12(i1,i2)%a(1,1)+l7_56
     & (i5,i6)%b(1,2)*u756_12(i1,i2)%b(2,1))
      u7_1256(i1,i2,i5,i6)%c(1,1)=u7_1256(i1,i2,i5,i6)%c(1,1)+rm
     & ass(id7)*(l7_56(i5,i6)%a(1,1)*u756_12(i1,i2)%d(1,1)+l7_56
     & (i5,i6)%c(1,2)*u756_12(i1,i2)%c(2,1))
      u7_1256(i1,i2,i5,i6)%d(1,1)=u7_1256(i1,i2,i5,i6)%d(1,1)+l7
     & _56(i5,i6)%d(1,1)*p756q*u756_12(i1,i2)%d(1,1)+l7_56(i5,i6
     & )%b(1,2)*u756_12(i1,i2)%c(2,1)
      u7_1256(i1,i2,i5,i6)%a(1,2)=u7_1256(i1,i2,i5,i6)%a(1,2)+rm
     & ass(id7)*(l7_56(i5,i6)%a(1,1)*u756_12(i1,i2)%b(1,2)+l7_56
     & (i5,i6)%c(1,2)*u756_12(i1,i2)%a(2,2))
      u7_1256(i1,i2,i5,i6)%b(1,2)=u7_1256(i1,i2,i5,i6)%b(1,2)+l7
     & _56(i5,i6)%d(1,1)*p756q*u756_12(i1,i2)%b(1,2)+l7_56(i5,i6
     & )%b(1,2)*u756_12(i1,i2)%a(2,2)
      u7_1256(i1,i2,i5,i6)%c(1,2)=u7_1256(i1,i2,i5,i6)%c(1,2)+l7
     & _56(i5,i6)%a(1,1)*u756_12(i1,i2)%c(1,2)+l7_56(i5,i6)%c(1,
     & 2)*p756q*u756_12(i1,i2)%d(2,2)
      u7_1256(i1,i2,i5,i6)%d(1,2)=u7_1256(i1,i2,i5,i6)%d(1,2)+rm
     & ass(id7)*(l7_56(i5,i6)%d(1,1)*u756_12(i1,i2)%c(1,2)+l7_56
     & (i5,i6)%b(1,2)*u756_12(i1,i2)%d(2,2))
      u7_1256(i1,i2,i5,i6)%a(2,1)=u7_1256(i1,i2,i5,i6)%a(2,1)+rm
     & ass(id7)*(l7_56(i5,i6)%c(2,1)*u756_12(i1,i2)%a(1,1)+l7_56
     & (i5,i6)%a(2,2)*u756_12(i1,i2)%b(2,1))
      u7_1256(i1,i2,i5,i6)%b(2,1)=u7_1256(i1,i2,i5,i6)%b(2,1)+l7
     & _56(i5,i6)%b(2,1)*u756_12(i1,i2)%a(1,1)+l7_56(i5,i6)%d(2,
     & 2)*p756q*u756_12(i1,i2)%b(2,1)
      u7_1256(i1,i2,i5,i6)%c(2,1)=u7_1256(i1,i2,i5,i6)%c(2,1)+l7
     & _56(i5,i6)%c(2,1)*p756q*u756_12(i1,i2)%d(1,1)+l7_56(i5,i6
     & )%a(2,2)*u756_12(i1,i2)%c(2,1)
      u7_1256(i1,i2,i5,i6)%d(2,1)=u7_1256(i1,i2,i5,i6)%d(2,1)+rm
     & ass(id7)*(l7_56(i5,i6)%b(2,1)*u756_12(i1,i2)%d(1,1)+l7_56
     & (i5,i6)%d(2,2)*u756_12(i1,i2)%c(2,1))
      u7_1256(i1,i2,i5,i6)%a(2,2)=u7_1256(i1,i2,i5,i6)%a(2,2)+l7
     & _56(i5,i6)%c(2,1)*p756q*u756_12(i1,i2)%b(1,2)+l7_56(i5,i6
     & )%a(2,2)*u756_12(i1,i2)%a(2,2)
      u7_1256(i1,i2,i5,i6)%b(2,2)=u7_1256(i1,i2,i5,i6)%b(2,2)+rm
     & ass(id7)*(l7_56(i5,i6)%b(2,1)*u756_12(i1,i2)%b(1,2)+l7_56
     & (i5,i6)%d(2,2)*u756_12(i1,i2)%a(2,2))
      u7_1256(i1,i2,i5,i6)%c(2,2)=u7_1256(i1,i2,i5,i6)%c(2,2)+rm
     & ass(id7)*(l7_56(i5,i6)%c(2,1)*u756_12(i1,i2)%c(1,2)+l7_56
     & (i5,i6)%a(2,2)*u756_12(i1,i2)%d(2,2))
      u7_1256(i1,i2,i5,i6)%d(2,2)=u7_1256(i1,i2,i5,i6)%d(2,2)+l7
     & _56(i5,i6)%b(2,1)*u756_12(i1,i2)%c(1,2)+l7_56(i5,i6)%d(2,
     & 2)*p756q*u756_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id7.eq.5.and.id5.eq.5.and.id1.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=u7_1256(i1,i2,i5,i6)%a,bb=u7_1256(i1,i2,i5,i6)%b,cc=u7_1256
* (i1,i2,i5,i6)%c,dd=u7_1256(i1,i2,i5,i6)%d,a1=l7_56(i5,i6)%a,b1=l7_56(i
* 5,i6)%b,c1=l7_56(i5,i6)%c,d1=l7_56(i5,i6)%d,a2=u756_12(i1,i2)%a,b2=u75
* 6_12(i1,i2)%b,c2=u756_12(i1,i2)%c,d2=u756_12(i1,i2)%d,prq=p756q,m=rmas
* s(id7),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u756_12(i1,i2)%a(1,jut)+rmass(id7)*u756_12(i1,i2)%b(1,
     & jut)
      cx2=u756_12(i1,i2)%a(2,jut)+rmass(id7)*u756_12(i1,i2)%b(2,
     & jut)
      cy1=p756q*u756_12(i1,i2)%b(1,jut)+rmass(id7)*u756_12(i1,i2
     & )%a(1,jut)
      cy2=p756q*u756_12(i1,i2)%b(2,jut)+rmass(id7)*u756_12(i1,i2
     & )%a(2,jut)
      u7_1256(i1,i2,i5,i6)%a(iut,jut)=u7_1256(i1,i2,i5,i6)%a(iut
     & ,jut)+l7_56(i5,i6)%a(iut,1)*cx1+l7_56(i5,i6)%c(iut,1)*cy1
     & +l7_56(i5,i6)%a(iut,2)*cx2+l7_56(i5,i6)%c(iut,2)*cy2
      u7_1256(i1,i2,i5,i6)%b(iut,jut)=u7_1256(i1,i2,i5,i6)%b(iut
     & ,jut)+l7_56(i5,i6)%b(iut,1)*cx1+l7_56(i5,i6)%d(iut,1)*cy1
     & +l7_56(i5,i6)%b(iut,2)*cx2+l7_56(i5,i6)%d(iut,2)*cy2
      cw1=u756_12(i1,i2)%c(1,jut)+rmass(id7)*u756_12(i1,i2)%d(1,
     & jut)
      cw2=u756_12(i1,i2)%c(2,jut)+rmass(id7)*u756_12(i1,i2)%d(2,
     & jut)
      cz1=p756q*u756_12(i1,i2)%d(1,jut)+rmass(id7)*u756_12(i1,i2
     & )%c(1,jut)
      cz2=p756q*u756_12(i1,i2)%d(2,jut)+rmass(id7)*u756_12(i1,i2
     & )%c(2,jut)
      u7_1256(i1,i2,i5,i6)%c(iut,jut)=u7_1256(i1,i2,i5,i6)%c(iut
     & ,jut)+l7_56(i5,i6)%a(iut,1)*cw1+l7_56(i5,i6)%c(iut,1)*cz1
     & +l7_56(i5,i6)%a(iut,2)*cw2+l7_56(i5,i6)%c(iut,2)*cz2
      u7_1256(i1,i2,i5,i6)%d(iut,jut)=u7_1256(i1,i2,i5,i6)%d(iut
     & ,jut)+l7_56(i5,i6)%b(iut,1)*cw1+l7_56(i5,i6)%d(iut,1)*cz1
     & +l7_56(i5,i6)%b(iut,2)*cw2+l7_56(i5,i6)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id7.eq.5.and.id5.eq.5.and.id1.ne.5)then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=u7_1256(i1,i2,i5,i6)%a,bb=u7_1256(i1,i2,i5,i6)%b,cc=u7_1256(
* i1,i2,i5,i6)%c,dd=u7_1256(i1,i2,i5,i6)%d,a1=l7_56(i5,i6)%a,b1=l7_56(i5
* ,i6)%b,c1=l7_56(i5,i6)%c,d1=l7_56(i5,i6)%d,a2=u756_12(i1,i2)%a,b2=u756
* _12(i1,i2)%b,c2=u756_12(i1,i2)%c,d2=u756_12(i1,i2)%d,prq=p756q,m=rmass
* (id7),nsum=1
      do iut=1,2
      cx1=l7_56(i5,i6)%a(iut,1)+l7_56(i5,i6)%c(iut,1)*rmass(id7)
      cx2=l7_56(i5,i6)%c(iut,2)*p756q+l7_56(i5,i6)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_56(i5,i6)%b(iut,1)+l7_56(i5,i6)%d(iut,1)*rmass(id7)
      cy2=l7_56(i5,i6)%d(iut,2)*p756q+l7_56(i5,i6)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_56(i5,i6)%c(iut,1)*p756q+l7_56(i5,i6)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_56(i5,i6)%a(iut,2)+l7_56(i5,i6)%c(iut,2)*rmass(id7)
      cz1=l7_56(i5,i6)%d(iut,1)*p756q+l7_56(i5,i6)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_56(i5,i6)%b(iut,2)+l7_56(i5,i6)%d(iut,2)*rmass(id7)
      u7_1256(i1,i2,i5,i6)%a(iut,1)=u7_1256(i1,i2,i5,i6)%a(iut,1
     & )+cx1*u756_12(i1,i2)%a(1,1)+cx2*u756_12(i1,i2)%b(2,1)
      u7_1256(i1,i2,i5,i6)%b(iut,1)=u7_1256(i1,i2,i5,i6)%b(iut,1
     & )+cy1*u756_12(i1,i2)%a(1,1)+cy2*u756_12(i1,i2)%b(2,1)
      u7_1256(i1,i2,i5,i6)%c(iut,1)=u7_1256(i1,i2,i5,i6)%c(iut,1
     & )+cw1*u756_12(i1,i2)%d(1,1)+cw2*u756_12(i1,i2)%c(2,1)
      u7_1256(i1,i2,i5,i6)%d(iut,1)=u7_1256(i1,i2,i5,i6)%d(iut,1
     & )+cz1*u756_12(i1,i2)%d(1,1)+cz2*u756_12(i1,i2)%c(2,1)
      u7_1256(i1,i2,i5,i6)%a(iut,2)=u7_1256(i1,i2,i5,i6)%a(iut,2
     & )+cw1*u756_12(i1,i2)%b(1,2)+cw2*u756_12(i1,i2)%a(2,2)
      u7_1256(i1,i2,i5,i6)%b(iut,2)=u7_1256(i1,i2,i5,i6)%b(iut,2
     & )+cz1*u756_12(i1,i2)%b(1,2)+cz2*u756_12(i1,i2)%a(2,2)
      u7_1256(i1,i2,i5,i6)%c(iut,2)=u7_1256(i1,i2,i5,i6)%c(iut,2
     & )+cx1*u756_12(i1,i2)%c(1,2)+cx2*u756_12(i1,i2)%d(2,2)
      u7_1256(i1,i2,i5,i6)%d(iut,2)=u7_1256(i1,i2,i5,i6)%d(iut,2
     & )+cy1*u756_12(i1,i2)%c(1,2)+cy2*u756_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id7.eq.5.and.id5.ne.5.and.id1.eq.5)then
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TTs -- aa=u7_1256(i1,i2,i5,i6)%a,bb=u7_1256(i1,i2,i5,i6)%b,cc=u7_1256(
* i1,i2,i5,i6)%c,dd=u7_1256(i1,i2,i5,i6)%d,a1=l7_56(i5,i6)%a,b1=l7_56(i5
* ,i6)%b,c1=l7_56(i5,i6)%c,d1=l7_56(i5,i6)%d,a2=u756_12(i1,i2)%a,b2=u756
* _12(i1,i2)%b,c2=u756_12(i1,i2)%c,d2=u756_12(i1,i2)%d,prq=p756q,m=rmass
* (id7),nsum=1
      do jut=1,2
      cx1=u756_12(i1,i2)%a(1,jut)+rmass(id7)*u756_12(i1,i2)%b(1,
     & jut)
      cx2=u756_12(i1,i2)%a(2,jut)+rmass(id7)*u756_12(i1,i2)%b(2,
     & jut)
      cy1=p756q*u756_12(i1,i2)%b(1,jut)+rmass(id7)*u756_12(i1,i2
     & )%a(1,jut)
      cy2=p756q*u756_12(i1,i2)%b(2,jut)+rmass(id7)*u756_12(i1,i2
     & )%a(2,jut)
      cw1=u756_12(i1,i2)%c(1,jut)+rmass(id7)*u756_12(i1,i2)%d(1,
     & jut)
      cw2=u756_12(i1,i2)%c(2,jut)+rmass(id7)*u756_12(i1,i2)%d(2,
     & jut)
      cz1=p756q*u756_12(i1,i2)%d(1,jut)+rmass(id7)*u756_12(i1,i2
     & )%c(1,jut)
      cz2=p756q*u756_12(i1,i2)%d(2,jut)+rmass(id7)*u756_12(i1,i2
     & )%c(2,jut)
      u7_1256(i1,i2,i5,i6)%a(1,jut)=u7_1256(i1,i2,i5,i6)%a(1,jut
     & )+l7_56(i5,i6)%a(1,1)*cx1+l7_56(i5,i6)%c(1,2)*cy2
      u7_1256(i1,i2,i5,i6)%b(1,jut)=u7_1256(i1,i2,i5,i6)%b(1,jut
     & )+l7_56(i5,i6)%d(1,1)*cy1+l7_56(i5,i6)%b(1,2)*cx2
      u7_1256(i1,i2,i5,i6)%c(1,jut)=u7_1256(i1,i2,i5,i6)%c(1,jut
     & )+l7_56(i5,i6)%a(1,1)*cw1+l7_56(i5,i6)%c(1,2)*cz2
      u7_1256(i1,i2,i5,i6)%d(1,jut)=u7_1256(i1,i2,i5,i6)%d(1,jut
     & )+l7_56(i5,i6)%d(1,1)*cz1+l7_56(i5,i6)%b(1,2)*cw2
      u7_1256(i1,i2,i5,i6)%a(2,jut)=u7_1256(i1,i2,i5,i6)%a(2,jut
     & )+l7_56(i5,i6)%c(2,1)*cy1+l7_56(i5,i6)%a(2,2)*cx2
      u7_1256(i1,i2,i5,i6)%b(2,jut)=u7_1256(i1,i2,i5,i6)%b(2,jut
     & )+l7_56(i5,i6)%b(2,1)*cx1+l7_56(i5,i6)%d(2,2)*cy2
      u7_1256(i1,i2,i5,i6)%c(2,jut)=u7_1256(i1,i2,i5,i6)%c(2,jut
     & )+l7_56(i5,i6)%c(2,1)*cz1+l7_56(i5,i6)%a(2,2)*cw2
      u7_1256(i1,i2,i5,i6)%d(2,jut)=u7_1256(i1,i2,i5,i6)%d(2,jut
     & )+l7_56(i5,i6)%b(2,1)*cw1+l7_56(i5,i6)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p734q,p=p734,q=p734,bef=,aft=
      p734q=(p734(0)*p734(0)-p734(1)*p734(1)-p734(2)*p734(2)-p73
     & 4(3)*p734(3))
  
      if(id7.ne.5.or.(id3.ne.5.and.id5.ne.5))then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=u7_3456(i3,i4,i5,i6)%a,bb=u7_3456(i3,i4,i5,i6)%b,cc=u7_3456(i
* 3,i4,i5,i6)%c,dd=u7_3456(i3,i4,i5,i6)%d,a1=l7_34(i3,i4)%a,b1=l7_34(i3,
* i4)%b,c1=l7_34(i3,i4)%c,d1=l7_34(i3,i4)%d,a2=u734_56(i5,i6)%a,b2=u734_
* 56(i5,i6)%b,c2=u734_56(i5,i6)%c,d2=u734_56(i5,i6)%d,prq=p734q,m=rmass(
* id7),nsum=1
      u7_3456(i3,i4,i5,i6)%a(1,1)=u7_3456(i3,i4,i5,i6)%a(1,1)+l7
     & _34(i3,i4)%a(1,1)*u734_56(i5,i6)%a(1,1)+l7_34(i3,i4)%c(1,
     & 2)*p734q*u734_56(i5,i6)%b(2,1)
      u7_3456(i3,i4,i5,i6)%b(1,1)=u7_3456(i3,i4,i5,i6)%b(1,1)+rm
     & ass(id7)*(l7_34(i3,i4)%d(1,1)*u734_56(i5,i6)%a(1,1)+l7_34
     & (i3,i4)%b(1,2)*u734_56(i5,i6)%b(2,1))
      u7_3456(i3,i4,i5,i6)%c(1,1)=u7_3456(i3,i4,i5,i6)%c(1,1)+rm
     & ass(id7)*(l7_34(i3,i4)%a(1,1)*u734_56(i5,i6)%d(1,1)+l7_34
     & (i3,i4)%c(1,2)*u734_56(i5,i6)%c(2,1))
      u7_3456(i3,i4,i5,i6)%d(1,1)=u7_3456(i3,i4,i5,i6)%d(1,1)+l7
     & _34(i3,i4)%d(1,1)*p734q*u734_56(i5,i6)%d(1,1)+l7_34(i3,i4
     & )%b(1,2)*u734_56(i5,i6)%c(2,1)
      u7_3456(i3,i4,i5,i6)%a(1,2)=u7_3456(i3,i4,i5,i6)%a(1,2)+rm
     & ass(id7)*(l7_34(i3,i4)%a(1,1)*u734_56(i5,i6)%b(1,2)+l7_34
     & (i3,i4)%c(1,2)*u734_56(i5,i6)%a(2,2))
      u7_3456(i3,i4,i5,i6)%b(1,2)=u7_3456(i3,i4,i5,i6)%b(1,2)+l7
     & _34(i3,i4)%d(1,1)*p734q*u734_56(i5,i6)%b(1,2)+l7_34(i3,i4
     & )%b(1,2)*u734_56(i5,i6)%a(2,2)
      u7_3456(i3,i4,i5,i6)%c(1,2)=u7_3456(i3,i4,i5,i6)%c(1,2)+l7
     & _34(i3,i4)%a(1,1)*u734_56(i5,i6)%c(1,2)+l7_34(i3,i4)%c(1,
     & 2)*p734q*u734_56(i5,i6)%d(2,2)
      u7_3456(i3,i4,i5,i6)%d(1,2)=u7_3456(i3,i4,i5,i6)%d(1,2)+rm
     & ass(id7)*(l7_34(i3,i4)%d(1,1)*u734_56(i5,i6)%c(1,2)+l7_34
     & (i3,i4)%b(1,2)*u734_56(i5,i6)%d(2,2))
      u7_3456(i3,i4,i5,i6)%a(2,1)=u7_3456(i3,i4,i5,i6)%a(2,1)+rm
     & ass(id7)*(l7_34(i3,i4)%c(2,1)*u734_56(i5,i6)%a(1,1)+l7_34
     & (i3,i4)%a(2,2)*u734_56(i5,i6)%b(2,1))
      u7_3456(i3,i4,i5,i6)%b(2,1)=u7_3456(i3,i4,i5,i6)%b(2,1)+l7
     & _34(i3,i4)%b(2,1)*u734_56(i5,i6)%a(1,1)+l7_34(i3,i4)%d(2,
     & 2)*p734q*u734_56(i5,i6)%b(2,1)
      u7_3456(i3,i4,i5,i6)%c(2,1)=u7_3456(i3,i4,i5,i6)%c(2,1)+l7
     & _34(i3,i4)%c(2,1)*p734q*u734_56(i5,i6)%d(1,1)+l7_34(i3,i4
     & )%a(2,2)*u734_56(i5,i6)%c(2,1)
      u7_3456(i3,i4,i5,i6)%d(2,1)=u7_3456(i3,i4,i5,i6)%d(2,1)+rm
     & ass(id7)*(l7_34(i3,i4)%b(2,1)*u734_56(i5,i6)%d(1,1)+l7_34
     & (i3,i4)%d(2,2)*u734_56(i5,i6)%c(2,1))
      u7_3456(i3,i4,i5,i6)%a(2,2)=u7_3456(i3,i4,i5,i6)%a(2,2)+l7
     & _34(i3,i4)%c(2,1)*p734q*u734_56(i5,i6)%b(1,2)+l7_34(i3,i4
     & )%a(2,2)*u734_56(i5,i6)%a(2,2)
      u7_3456(i3,i4,i5,i6)%b(2,2)=u7_3456(i3,i4,i5,i6)%b(2,2)+rm
     & ass(id7)*(l7_34(i3,i4)%b(2,1)*u734_56(i5,i6)%b(1,2)+l7_34
     & (i3,i4)%d(2,2)*u734_56(i5,i6)%a(2,2))
      u7_3456(i3,i4,i5,i6)%c(2,2)=u7_3456(i3,i4,i5,i6)%c(2,2)+rm
     & ass(id7)*(l7_34(i3,i4)%c(2,1)*u734_56(i5,i6)%c(1,2)+l7_34
     & (i3,i4)%a(2,2)*u734_56(i5,i6)%d(2,2))
      u7_3456(i3,i4,i5,i6)%d(2,2)=u7_3456(i3,i4,i5,i6)%d(2,2)+l7
     & _34(i3,i4)%b(2,1)*u734_56(i5,i6)%c(1,2)+l7_34(i3,i4)%d(2,
     & 2)*p734q*u734_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id7.eq.5.and.id3.eq.5.and.id5.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=u7_3456(i3,i4,i5,i6)%a,bb=u7_3456(i3,i4,i5,i6)%b,cc=u7_3456
* (i3,i4,i5,i6)%c,dd=u7_3456(i3,i4,i5,i6)%d,a1=l7_34(i3,i4)%a,b1=l7_34(i
* 3,i4)%b,c1=l7_34(i3,i4)%c,d1=l7_34(i3,i4)%d,a2=u734_56(i5,i6)%a,b2=u73
* 4_56(i5,i6)%b,c2=u734_56(i5,i6)%c,d2=u734_56(i5,i6)%d,prq=p734q,m=rmas
* s(id7),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u734_56(i5,i6)%a(1,jut)+rmass(id7)*u734_56(i5,i6)%b(1,
     & jut)
      cx2=u734_56(i5,i6)%a(2,jut)+rmass(id7)*u734_56(i5,i6)%b(2,
     & jut)
      cy1=p734q*u734_56(i5,i6)%b(1,jut)+rmass(id7)*u734_56(i5,i6
     & )%a(1,jut)
      cy2=p734q*u734_56(i5,i6)%b(2,jut)+rmass(id7)*u734_56(i5,i6
     & )%a(2,jut)
      u7_3456(i3,i4,i5,i6)%a(iut,jut)=u7_3456(i3,i4,i5,i6)%a(iut
     & ,jut)+l7_34(i3,i4)%a(iut,1)*cx1+l7_34(i3,i4)%c(iut,1)*cy1
     & +l7_34(i3,i4)%a(iut,2)*cx2+l7_34(i3,i4)%c(iut,2)*cy2
      u7_3456(i3,i4,i5,i6)%b(iut,jut)=u7_3456(i3,i4,i5,i6)%b(iut
     & ,jut)+l7_34(i3,i4)%b(iut,1)*cx1+l7_34(i3,i4)%d(iut,1)*cy1
     & +l7_34(i3,i4)%b(iut,2)*cx2+l7_34(i3,i4)%d(iut,2)*cy2
      cw1=u734_56(i5,i6)%c(1,jut)+rmass(id7)*u734_56(i5,i6)%d(1,
     & jut)
      cw2=u734_56(i5,i6)%c(2,jut)+rmass(id7)*u734_56(i5,i6)%d(2,
     & jut)
      cz1=p734q*u734_56(i5,i6)%d(1,jut)+rmass(id7)*u734_56(i5,i6
     & )%c(1,jut)
      cz2=p734q*u734_56(i5,i6)%d(2,jut)+rmass(id7)*u734_56(i5,i6
     & )%c(2,jut)
      u7_3456(i3,i4,i5,i6)%c(iut,jut)=u7_3456(i3,i4,i5,i6)%c(iut
     & ,jut)+l7_34(i3,i4)%a(iut,1)*cw1+l7_34(i3,i4)%c(iut,1)*cz1
     & +l7_34(i3,i4)%a(iut,2)*cw2+l7_34(i3,i4)%c(iut,2)*cz2
      u7_3456(i3,i4,i5,i6)%d(iut,jut)=u7_3456(i3,i4,i5,i6)%d(iut
     & ,jut)+l7_34(i3,i4)%b(iut,1)*cw1+l7_34(i3,i4)%d(iut,1)*cz1
     & +l7_34(i3,i4)%b(iut,2)*cw2+l7_34(i3,i4)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id7.eq.5.and.id3.eq.5.and.id5.ne.5)then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=u7_3456(i3,i4,i5,i6)%a,bb=u7_3456(i3,i4,i5,i6)%b,cc=u7_3456(
* i3,i4,i5,i6)%c,dd=u7_3456(i3,i4,i5,i6)%d,a1=l7_34(i3,i4)%a,b1=l7_34(i3
* ,i4)%b,c1=l7_34(i3,i4)%c,d1=l7_34(i3,i4)%d,a2=u734_56(i5,i6)%a,b2=u734
* _56(i5,i6)%b,c2=u734_56(i5,i6)%c,d2=u734_56(i5,i6)%d,prq=p734q,m=rmass
* (id7),nsum=1
      do iut=1,2
      cx1=l7_34(i3,i4)%a(iut,1)+l7_34(i3,i4)%c(iut,1)*rmass(id7)
      cx2=l7_34(i3,i4)%c(iut,2)*p734q+l7_34(i3,i4)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_34(i3,i4)%b(iut,1)+l7_34(i3,i4)%d(iut,1)*rmass(id7)
      cy2=l7_34(i3,i4)%d(iut,2)*p734q+l7_34(i3,i4)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_34(i3,i4)%c(iut,1)*p734q+l7_34(i3,i4)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_34(i3,i4)%a(iut,2)+l7_34(i3,i4)%c(iut,2)*rmass(id7)
      cz1=l7_34(i3,i4)%d(iut,1)*p734q+l7_34(i3,i4)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_34(i3,i4)%b(iut,2)+l7_34(i3,i4)%d(iut,2)*rmass(id7)
      u7_3456(i3,i4,i5,i6)%a(iut,1)=u7_3456(i3,i4,i5,i6)%a(iut,1
     & )+cx1*u734_56(i5,i6)%a(1,1)+cx2*u734_56(i5,i6)%b(2,1)
      u7_3456(i3,i4,i5,i6)%b(iut,1)=u7_3456(i3,i4,i5,i6)%b(iut,1
     & )+cy1*u734_56(i5,i6)%a(1,1)+cy2*u734_56(i5,i6)%b(2,1)
      u7_3456(i3,i4,i5,i6)%c(iut,1)=u7_3456(i3,i4,i5,i6)%c(iut,1
     & )+cw1*u734_56(i5,i6)%d(1,1)+cw2*u734_56(i5,i6)%c(2,1)
      u7_3456(i3,i4,i5,i6)%d(iut,1)=u7_3456(i3,i4,i5,i6)%d(iut,1
     & )+cz1*u734_56(i5,i6)%d(1,1)+cz2*u734_56(i5,i6)%c(2,1)
      u7_3456(i3,i4,i5,i6)%a(iut,2)=u7_3456(i3,i4,i5,i6)%a(iut,2
     & )+cw1*u734_56(i5,i6)%b(1,2)+cw2*u734_56(i5,i6)%a(2,2)
      u7_3456(i3,i4,i5,i6)%b(iut,2)=u7_3456(i3,i4,i5,i6)%b(iut,2
     & )+cz1*u734_56(i5,i6)%b(1,2)+cz2*u734_56(i5,i6)%a(2,2)
      u7_3456(i3,i4,i5,i6)%c(iut,2)=u7_3456(i3,i4,i5,i6)%c(iut,2
     & )+cx1*u734_56(i5,i6)%c(1,2)+cx2*u734_56(i5,i6)%d(2,2)
      u7_3456(i3,i4,i5,i6)%d(iut,2)=u7_3456(i3,i4,i5,i6)%d(iut,2
     & )+cy1*u734_56(i5,i6)%c(1,2)+cy2*u734_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id7.eq.5.and.id3.ne.5.and.id5.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TTs -- aa=u7_3456(i3,i4,i5,i6)%a,bb=u7_3456(i3,i4,i5,i6)%b,cc=u7_3456(
* i3,i4,i5,i6)%c,dd=u7_3456(i3,i4,i5,i6)%d,a1=l7_34(i3,i4)%a,b1=l7_34(i3
* ,i4)%b,c1=l7_34(i3,i4)%c,d1=l7_34(i3,i4)%d,a2=u734_56(i5,i6)%a,b2=u734
* _56(i5,i6)%b,c2=u734_56(i5,i6)%c,d2=u734_56(i5,i6)%d,prq=p734q,m=rmass
* (id7),nsum=1
      do jut=1,2
      cx1=u734_56(i5,i6)%a(1,jut)+rmass(id7)*u734_56(i5,i6)%b(1,
     & jut)
      cx2=u734_56(i5,i6)%a(2,jut)+rmass(id7)*u734_56(i5,i6)%b(2,
     & jut)
      cy1=p734q*u734_56(i5,i6)%b(1,jut)+rmass(id7)*u734_56(i5,i6
     & )%a(1,jut)
      cy2=p734q*u734_56(i5,i6)%b(2,jut)+rmass(id7)*u734_56(i5,i6
     & )%a(2,jut)
      cw1=u734_56(i5,i6)%c(1,jut)+rmass(id7)*u734_56(i5,i6)%d(1,
     & jut)
      cw2=u734_56(i5,i6)%c(2,jut)+rmass(id7)*u734_56(i5,i6)%d(2,
     & jut)
      cz1=p734q*u734_56(i5,i6)%d(1,jut)+rmass(id7)*u734_56(i5,i6
     & )%c(1,jut)
      cz2=p734q*u734_56(i5,i6)%d(2,jut)+rmass(id7)*u734_56(i5,i6
     & )%c(2,jut)
      u7_3456(i3,i4,i5,i6)%a(1,jut)=u7_3456(i3,i4,i5,i6)%a(1,jut
     & )+l7_34(i3,i4)%a(1,1)*cx1+l7_34(i3,i4)%c(1,2)*cy2
      u7_3456(i3,i4,i5,i6)%b(1,jut)=u7_3456(i3,i4,i5,i6)%b(1,jut
     & )+l7_34(i3,i4)%d(1,1)*cy1+l7_34(i3,i4)%b(1,2)*cx2
      u7_3456(i3,i4,i5,i6)%c(1,jut)=u7_3456(i3,i4,i5,i6)%c(1,jut
     & )+l7_34(i3,i4)%a(1,1)*cw1+l7_34(i3,i4)%c(1,2)*cz2
      u7_3456(i3,i4,i5,i6)%d(1,jut)=u7_3456(i3,i4,i5,i6)%d(1,jut
     & )+l7_34(i3,i4)%d(1,1)*cz1+l7_34(i3,i4)%b(1,2)*cw2
      u7_3456(i3,i4,i5,i6)%a(2,jut)=u7_3456(i3,i4,i5,i6)%a(2,jut
     & )+l7_34(i3,i4)%c(2,1)*cy1+l7_34(i3,i4)%a(2,2)*cx2
      u7_3456(i3,i4,i5,i6)%b(2,jut)=u7_3456(i3,i4,i5,i6)%b(2,jut
     & )+l7_34(i3,i4)%b(2,1)*cx1+l7_34(i3,i4)%d(2,2)*cy2
      u7_3456(i3,i4,i5,i6)%c(2,jut)=u7_3456(i3,i4,i5,i6)%c(2,jut
     & )+l7_34(i3,i4)%c(2,1)*cz1+l7_34(i3,i4)%a(2,2)*cw2
      u7_3456(i3,i4,i5,i6)%d(2,jut)=u7_3456(i3,i4,i5,i6)%d(2,jut
     & )+l7_34(i3,i4)%b(2,1)*cw1+l7_34(i3,i4)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
* p.q -- p.q=p756q,p=p756,q=p756,bef=,aft=
      p756q=(p756(0)*p756(0)-p756(1)*p756(1)-p756(2)*p756(2)-p75
     & 6(3)*p756(3))
  
      if(id7.ne.5.or.(id5.ne.5.and.id3.ne.5))then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=u7_3456(i3,i4,i5,i6)%a,bb=u7_3456(i3,i4,i5,i6)%b,cc=u7_3456(i
* 3,i4,i5,i6)%c,dd=u7_3456(i3,i4,i5,i6)%d,a1=l7_56(i5,i6)%a,b1=l7_56(i5,
* i6)%b,c1=l7_56(i5,i6)%c,d1=l7_56(i5,i6)%d,a2=u756_34(i3,i4)%a,b2=u756_
* 34(i3,i4)%b,c2=u756_34(i3,i4)%c,d2=u756_34(i3,i4)%d,prq=p756q,m=rmass(
* id7),nsum=1
      u7_3456(i3,i4,i5,i6)%a(1,1)=u7_3456(i3,i4,i5,i6)%a(1,1)+l7
     & _56(i5,i6)%a(1,1)*u756_34(i3,i4)%a(1,1)+l7_56(i5,i6)%c(1,
     & 2)*p756q*u756_34(i3,i4)%b(2,1)
      u7_3456(i3,i4,i5,i6)%b(1,1)=u7_3456(i3,i4,i5,i6)%b(1,1)+rm
     & ass(id7)*(l7_56(i5,i6)%d(1,1)*u756_34(i3,i4)%a(1,1)+l7_56
     & (i5,i6)%b(1,2)*u756_34(i3,i4)%b(2,1))
      u7_3456(i3,i4,i5,i6)%c(1,1)=u7_3456(i3,i4,i5,i6)%c(1,1)+rm
     & ass(id7)*(l7_56(i5,i6)%a(1,1)*u756_34(i3,i4)%d(1,1)+l7_56
     & (i5,i6)%c(1,2)*u756_34(i3,i4)%c(2,1))
      u7_3456(i3,i4,i5,i6)%d(1,1)=u7_3456(i3,i4,i5,i6)%d(1,1)+l7
     & _56(i5,i6)%d(1,1)*p756q*u756_34(i3,i4)%d(1,1)+l7_56(i5,i6
     & )%b(1,2)*u756_34(i3,i4)%c(2,1)
      u7_3456(i3,i4,i5,i6)%a(1,2)=u7_3456(i3,i4,i5,i6)%a(1,2)+rm
     & ass(id7)*(l7_56(i5,i6)%a(1,1)*u756_34(i3,i4)%b(1,2)+l7_56
     & (i5,i6)%c(1,2)*u756_34(i3,i4)%a(2,2))
      u7_3456(i3,i4,i5,i6)%b(1,2)=u7_3456(i3,i4,i5,i6)%b(1,2)+l7
     & _56(i5,i6)%d(1,1)*p756q*u756_34(i3,i4)%b(1,2)+l7_56(i5,i6
     & )%b(1,2)*u756_34(i3,i4)%a(2,2)
      u7_3456(i3,i4,i5,i6)%c(1,2)=u7_3456(i3,i4,i5,i6)%c(1,2)+l7
     & _56(i5,i6)%a(1,1)*u756_34(i3,i4)%c(1,2)+l7_56(i5,i6)%c(1,
     & 2)*p756q*u756_34(i3,i4)%d(2,2)
      u7_3456(i3,i4,i5,i6)%d(1,2)=u7_3456(i3,i4,i5,i6)%d(1,2)+rm
     & ass(id7)*(l7_56(i5,i6)%d(1,1)*u756_34(i3,i4)%c(1,2)+l7_56
     & (i5,i6)%b(1,2)*u756_34(i3,i4)%d(2,2))
      u7_3456(i3,i4,i5,i6)%a(2,1)=u7_3456(i3,i4,i5,i6)%a(2,1)+rm
     & ass(id7)*(l7_56(i5,i6)%c(2,1)*u756_34(i3,i4)%a(1,1)+l7_56
     & (i5,i6)%a(2,2)*u756_34(i3,i4)%b(2,1))
      u7_3456(i3,i4,i5,i6)%b(2,1)=u7_3456(i3,i4,i5,i6)%b(2,1)+l7
     & _56(i5,i6)%b(2,1)*u756_34(i3,i4)%a(1,1)+l7_56(i5,i6)%d(2,
     & 2)*p756q*u756_34(i3,i4)%b(2,1)
      u7_3456(i3,i4,i5,i6)%c(2,1)=u7_3456(i3,i4,i5,i6)%c(2,1)+l7
     & _56(i5,i6)%c(2,1)*p756q*u756_34(i3,i4)%d(1,1)+l7_56(i5,i6
     & )%a(2,2)*u756_34(i3,i4)%c(2,1)
      u7_3456(i3,i4,i5,i6)%d(2,1)=u7_3456(i3,i4,i5,i6)%d(2,1)+rm
     & ass(id7)*(l7_56(i5,i6)%b(2,1)*u756_34(i3,i4)%d(1,1)+l7_56
     & (i5,i6)%d(2,2)*u756_34(i3,i4)%c(2,1))
      u7_3456(i3,i4,i5,i6)%a(2,2)=u7_3456(i3,i4,i5,i6)%a(2,2)+l7
     & _56(i5,i6)%c(2,1)*p756q*u756_34(i3,i4)%b(1,2)+l7_56(i5,i6
     & )%a(2,2)*u756_34(i3,i4)%a(2,2)
      u7_3456(i3,i4,i5,i6)%b(2,2)=u7_3456(i3,i4,i5,i6)%b(2,2)+rm
     & ass(id7)*(l7_56(i5,i6)%b(2,1)*u756_34(i3,i4)%b(1,2)+l7_56
     & (i5,i6)%d(2,2)*u756_34(i3,i4)%a(2,2))
      u7_3456(i3,i4,i5,i6)%c(2,2)=u7_3456(i3,i4,i5,i6)%c(2,2)+rm
     & ass(id7)*(l7_56(i5,i6)%c(2,1)*u756_34(i3,i4)%c(1,2)+l7_56
     & (i5,i6)%a(2,2)*u756_34(i3,i4)%d(2,2))
      u7_3456(i3,i4,i5,i6)%d(2,2)=u7_3456(i3,i4,i5,i6)%d(2,2)+l7
     & _56(i5,i6)%b(2,1)*u756_34(i3,i4)%c(1,2)+l7_56(i5,i6)%d(2,
     & 2)*p756q*u756_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
  
      else
  
       if(id7.eq.5.and.id5.eq.5.and.id3.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=u7_3456(i3,i4,i5,i6)%a,bb=u7_3456(i3,i4,i5,i6)%b,cc=u7_3456
* (i3,i4,i5,i6)%c,dd=u7_3456(i3,i4,i5,i6)%d,a1=l7_56(i5,i6)%a,b1=l7_56(i
* 5,i6)%b,c1=l7_56(i5,i6)%c,d1=l7_56(i5,i6)%d,a2=u756_34(i3,i4)%a,b2=u75
* 6_34(i3,i4)%b,c2=u756_34(i3,i4)%c,d2=u756_34(i3,i4)%d,prq=p756q,m=rmas
* s(id7),nsum=1
      do iut=1,2
      do jut=1,2
      cx1=u756_34(i3,i4)%a(1,jut)+rmass(id7)*u756_34(i3,i4)%b(1,
     & jut)
      cx2=u756_34(i3,i4)%a(2,jut)+rmass(id7)*u756_34(i3,i4)%b(2,
     & jut)
      cy1=p756q*u756_34(i3,i4)%b(1,jut)+rmass(id7)*u756_34(i3,i4
     & )%a(1,jut)
      cy2=p756q*u756_34(i3,i4)%b(2,jut)+rmass(id7)*u756_34(i3,i4
     & )%a(2,jut)
      u7_3456(i3,i4,i5,i6)%a(iut,jut)=u7_3456(i3,i4,i5,i6)%a(iut
     & ,jut)+l7_56(i5,i6)%a(iut,1)*cx1+l7_56(i5,i6)%c(iut,1)*cy1
     & +l7_56(i5,i6)%a(iut,2)*cx2+l7_56(i5,i6)%c(iut,2)*cy2
      u7_3456(i3,i4,i5,i6)%b(iut,jut)=u7_3456(i3,i4,i5,i6)%b(iut
     & ,jut)+l7_56(i5,i6)%b(iut,1)*cx1+l7_56(i5,i6)%d(iut,1)*cy1
     & +l7_56(i5,i6)%b(iut,2)*cx2+l7_56(i5,i6)%d(iut,2)*cy2
      cw1=u756_34(i3,i4)%c(1,jut)+rmass(id7)*u756_34(i3,i4)%d(1,
     & jut)
      cw2=u756_34(i3,i4)%c(2,jut)+rmass(id7)*u756_34(i3,i4)%d(2,
     & jut)
      cz1=p756q*u756_34(i3,i4)%d(1,jut)+rmass(id7)*u756_34(i3,i4
     & )%c(1,jut)
      cz2=p756q*u756_34(i3,i4)%d(2,jut)+rmass(id7)*u756_34(i3,i4
     & )%c(2,jut)
      u7_3456(i3,i4,i5,i6)%c(iut,jut)=u7_3456(i3,i4,i5,i6)%c(iut
     & ,jut)+l7_56(i5,i6)%a(iut,1)*cw1+l7_56(i5,i6)%c(iut,1)*cz1
     & +l7_56(i5,i6)%a(iut,2)*cw2+l7_56(i5,i6)%c(iut,2)*cz2
      u7_3456(i3,i4,i5,i6)%d(iut,jut)=u7_3456(i3,i4,i5,i6)%d(iut
     & ,jut)+l7_56(i5,i6)%b(iut,1)*cw1+l7_56(i5,i6)%d(iut,1)*cz1
     & +l7_56(i5,i6)%b(iut,2)*cw2+l7_56(i5,i6)%d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id7.eq.5.and.id5.eq.5.and.id3.ne.5)then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=u7_3456(i3,i4,i5,i6)%a,bb=u7_3456(i3,i4,i5,i6)%b,cc=u7_3456(
* i3,i4,i5,i6)%c,dd=u7_3456(i3,i4,i5,i6)%d,a1=l7_56(i5,i6)%a,b1=l7_56(i5
* ,i6)%b,c1=l7_56(i5,i6)%c,d1=l7_56(i5,i6)%d,a2=u756_34(i3,i4)%a,b2=u756
* _34(i3,i4)%b,c2=u756_34(i3,i4)%c,d2=u756_34(i3,i4)%d,prq=p756q,m=rmass
* (id7),nsum=1
      do iut=1,2
      cx1=l7_56(i5,i6)%a(iut,1)+l7_56(i5,i6)%c(iut,1)*rmass(id7)
      cx2=l7_56(i5,i6)%c(iut,2)*p756q+l7_56(i5,i6)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_56(i5,i6)%b(iut,1)+l7_56(i5,i6)%d(iut,1)*rmass(id7)
      cy2=l7_56(i5,i6)%d(iut,2)*p756q+l7_56(i5,i6)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_56(i5,i6)%c(iut,1)*p756q+l7_56(i5,i6)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_56(i5,i6)%a(iut,2)+l7_56(i5,i6)%c(iut,2)*rmass(id7)
      cz1=l7_56(i5,i6)%d(iut,1)*p756q+l7_56(i5,i6)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_56(i5,i6)%b(iut,2)+l7_56(i5,i6)%d(iut,2)*rmass(id7)
      u7_3456(i3,i4,i5,i6)%a(iut,1)=u7_3456(i3,i4,i5,i6)%a(iut,1
     & )+cx1*u756_34(i3,i4)%a(1,1)+cx2*u756_34(i3,i4)%b(2,1)
      u7_3456(i3,i4,i5,i6)%b(iut,1)=u7_3456(i3,i4,i5,i6)%b(iut,1
     & )+cy1*u756_34(i3,i4)%a(1,1)+cy2*u756_34(i3,i4)%b(2,1)
      u7_3456(i3,i4,i5,i6)%c(iut,1)=u7_3456(i3,i4,i5,i6)%c(iut,1
     & )+cw1*u756_34(i3,i4)%d(1,1)+cw2*u756_34(i3,i4)%c(2,1)
      u7_3456(i3,i4,i5,i6)%d(iut,1)=u7_3456(i3,i4,i5,i6)%d(iut,1
     & )+cz1*u756_34(i3,i4)%d(1,1)+cz2*u756_34(i3,i4)%c(2,1)
      u7_3456(i3,i4,i5,i6)%a(iut,2)=u7_3456(i3,i4,i5,i6)%a(iut,2
     & )+cw1*u756_34(i3,i4)%b(1,2)+cw2*u756_34(i3,i4)%a(2,2)
      u7_3456(i3,i4,i5,i6)%b(iut,2)=u7_3456(i3,i4,i5,i6)%b(iut,2
     & )+cz1*u756_34(i3,i4)%b(1,2)+cz2*u756_34(i3,i4)%a(2,2)
      u7_3456(i3,i4,i5,i6)%c(iut,2)=u7_3456(i3,i4,i5,i6)%c(iut,2
     & )+cx1*u756_34(i3,i4)%c(1,2)+cx2*u756_34(i3,i4)%d(2,2)
      u7_3456(i3,i4,i5,i6)%d(iut,2)=u7_3456(i3,i4,i5,i6)%d(iut,2
     & )+cy1*u756_34(i3,i4)%c(1,2)+cy2*u756_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
  
        if(id7.eq.5.and.id5.ne.5.and.id3.eq.5)then
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TTs -- aa=u7_3456(i3,i4,i5,i6)%a,bb=u7_3456(i3,i4,i5,i6)%b,cc=u7_3456(
* i3,i4,i5,i6)%c,dd=u7_3456(i3,i4,i5,i6)%d,a1=l7_56(i5,i6)%a,b1=l7_56(i5
* ,i6)%b,c1=l7_56(i5,i6)%c,d1=l7_56(i5,i6)%d,a2=u756_34(i3,i4)%a,b2=u756
* _34(i3,i4)%b,c2=u756_34(i3,i4)%c,d2=u756_34(i3,i4)%d,prq=p756q,m=rmass
* (id7),nsum=1
      do jut=1,2
      cx1=u756_34(i3,i4)%a(1,jut)+rmass(id7)*u756_34(i3,i4)%b(1,
     & jut)
      cx2=u756_34(i3,i4)%a(2,jut)+rmass(id7)*u756_34(i3,i4)%b(2,
     & jut)
      cy1=p756q*u756_34(i3,i4)%b(1,jut)+rmass(id7)*u756_34(i3,i4
     & )%a(1,jut)
      cy2=p756q*u756_34(i3,i4)%b(2,jut)+rmass(id7)*u756_34(i3,i4
     & )%a(2,jut)
      cw1=u756_34(i3,i4)%c(1,jut)+rmass(id7)*u756_34(i3,i4)%d(1,
     & jut)
      cw2=u756_34(i3,i4)%c(2,jut)+rmass(id7)*u756_34(i3,i4)%d(2,
     & jut)
      cz1=p756q*u756_34(i3,i4)%d(1,jut)+rmass(id7)*u756_34(i3,i4
     & )%c(1,jut)
      cz2=p756q*u756_34(i3,i4)%d(2,jut)+rmass(id7)*u756_34(i3,i4
     & )%c(2,jut)
      u7_3456(i3,i4,i5,i6)%a(1,jut)=u7_3456(i3,i4,i5,i6)%a(1,jut
     & )+l7_56(i5,i6)%a(1,1)*cx1+l7_56(i5,i6)%c(1,2)*cy2
      u7_3456(i3,i4,i5,i6)%b(1,jut)=u7_3456(i3,i4,i5,i6)%b(1,jut
     & )+l7_56(i5,i6)%d(1,1)*cy1+l7_56(i5,i6)%b(1,2)*cx2
      u7_3456(i3,i4,i5,i6)%c(1,jut)=u7_3456(i3,i4,i5,i6)%c(1,jut
     & )+l7_56(i5,i6)%a(1,1)*cw1+l7_56(i5,i6)%c(1,2)*cz2
      u7_3456(i3,i4,i5,i6)%d(1,jut)=u7_3456(i3,i4,i5,i6)%d(1,jut
     & )+l7_56(i5,i6)%d(1,1)*cz1+l7_56(i5,i6)%b(1,2)*cw2
      u7_3456(i3,i4,i5,i6)%a(2,jut)=u7_3456(i3,i4,i5,i6)%a(2,jut
     & )+l7_56(i5,i6)%c(2,1)*cy1+l7_56(i5,i6)%a(2,2)*cx2
      u7_3456(i3,i4,i5,i6)%b(2,jut)=u7_3456(i3,i4,i5,i6)%b(2,jut
     & )+l7_56(i5,i6)%b(2,1)*cx1+l7_56(i5,i6)%d(2,2)*cy2
      u7_3456(i3,i4,i5,i6)%c(2,jut)=u7_3456(i3,i4,i5,i6)%c(2,jut
     & )+l7_56(i5,i6)%c(2,1)*cz1+l7_56(i5,i6)%a(2,2)*cw2
      u7_3456(i3,i4,i5,i6)%d(2,jut)=u7_3456(i3,i4,i5,i6)%d(2,jut
     & )+l7_56(i5,i6)%b(2,1)*cw1+l7_56(i5,i6)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
        endif
  
      endif
  
  
**QCD                                                                   
  
  
      if(ilept(id1).ne.1 .and. ilept(id3).ne.1)then
        if(id1.ne.5 .or. id5.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=ug1_3456(i3,i4,i5,i6)%a,bb=ug1_3456(i3,i4,i5,i6)%b,cc=ug1_345
* 6(i3,i4,i5,i6)%c,dd=ug1_3456(i3,i4,i5,i6)%d,a1=lg1_34(i3,i4)%a,b1=lg1_
* 34(i3,i4)%b,c1=lg1_34(i3,i4)%c,d1=lg1_34(i3,i4)%d,a2=u134_56(i5,i6)%a,
* b2=u134_56(i5,i6)%b,c2=u134_56(i5,i6)%c,d2=u134_56(i5,i6)%d,prq=p134q,
* m=rmass(id1),nsum=0
      ug1_3456(i3,i4,i5,i6)%a(1,1)=lg1_34(i3,i4)%a(1,1)*u134_56(
     & i5,i6)%a(1,1)+lg1_34(i3,i4)%c(1,2)*p134q*u134_56(i5,i6)%b
     & (2,1)
      ug1_3456(i3,i4,i5,i6)%b(1,1)=rmass(id1)*(lg1_34(i3,i4)%d(1
     & ,1)*u134_56(i5,i6)%a(1,1)+lg1_34(i3,i4)%b(1,2)*u134_56(i5
     & ,i6)%b(2,1))
      ug1_3456(i3,i4,i5,i6)%c(1,1)=rmass(id1)*(lg1_34(i3,i4)%a(1
     & ,1)*u134_56(i5,i6)%d(1,1)+lg1_34(i3,i4)%c(1,2)*u134_56(i5
     & ,i6)%c(2,1))
      ug1_3456(i3,i4,i5,i6)%d(1,1)=lg1_34(i3,i4)%d(1,1)*p134q*u1
     & 34_56(i5,i6)%d(1,1)+lg1_34(i3,i4)%b(1,2)*u134_56(i5,i6)%c
     & (2,1)
      ug1_3456(i3,i4,i5,i6)%a(1,2)=rmass(id1)*(lg1_34(i3,i4)%a(1
     & ,1)*u134_56(i5,i6)%b(1,2)+lg1_34(i3,i4)%c(1,2)*u134_56(i5
     & ,i6)%a(2,2))
      ug1_3456(i3,i4,i5,i6)%b(1,2)=lg1_34(i3,i4)%d(1,1)*p134q*u1
     & 34_56(i5,i6)%b(1,2)+lg1_34(i3,i4)%b(1,2)*u134_56(i5,i6)%a
     & (2,2)
      ug1_3456(i3,i4,i5,i6)%c(1,2)=lg1_34(i3,i4)%a(1,1)*u134_56(
     & i5,i6)%c(1,2)+lg1_34(i3,i4)%c(1,2)*p134q*u134_56(i5,i6)%d
     & (2,2)
      ug1_3456(i3,i4,i5,i6)%d(1,2)=rmass(id1)*(lg1_34(i3,i4)%d(1
     & ,1)*u134_56(i5,i6)%c(1,2)+lg1_34(i3,i4)%b(1,2)*u134_56(i5
     & ,i6)%d(2,2))
      ug1_3456(i3,i4,i5,i6)%a(2,1)=rmass(id1)*(lg1_34(i3,i4)%c(2
     & ,1)*u134_56(i5,i6)%a(1,1)+lg1_34(i3,i4)%a(2,2)*u134_56(i5
     & ,i6)%b(2,1))
      ug1_3456(i3,i4,i5,i6)%b(2,1)=lg1_34(i3,i4)%b(2,1)*u134_56(
     & i5,i6)%a(1,1)+lg1_34(i3,i4)%d(2,2)*p134q*u134_56(i5,i6)%b
     & (2,1)
      ug1_3456(i3,i4,i5,i6)%c(2,1)=lg1_34(i3,i4)%c(2,1)*p134q*u1
     & 34_56(i5,i6)%d(1,1)+lg1_34(i3,i4)%a(2,2)*u134_56(i5,i6)%c
     & (2,1)
      ug1_3456(i3,i4,i5,i6)%d(2,1)=rmass(id1)*(lg1_34(i3,i4)%b(2
     & ,1)*u134_56(i5,i6)%d(1,1)+lg1_34(i3,i4)%d(2,2)*u134_56(i5
     & ,i6)%c(2,1))
      ug1_3456(i3,i4,i5,i6)%a(2,2)=lg1_34(i3,i4)%c(2,1)*p134q*u1
     & 34_56(i5,i6)%b(1,2)+lg1_34(i3,i4)%a(2,2)*u134_56(i5,i6)%a
     & (2,2)
      ug1_3456(i3,i4,i5,i6)%b(2,2)=rmass(id1)*(lg1_34(i3,i4)%b(2
     & ,1)*u134_56(i5,i6)%b(1,2)+lg1_34(i3,i4)%d(2,2)*u134_56(i5
     & ,i6)%a(2,2))
      ug1_3456(i3,i4,i5,i6)%c(2,2)=rmass(id1)*(lg1_34(i3,i4)%c(2
     & ,1)*u134_56(i5,i6)%c(1,2)+lg1_34(i3,i4)%a(2,2)*u134_56(i5
     & ,i6)%d(2,2))
      ug1_3456(i3,i4,i5,i6)%d(2,2)=lg1_34(i3,i4)%b(2,1)*u134_56(
     & i5,i6)%c(1,2)+lg1_34(i3,i4)%d(2,2)*p134q*u134_56(i5,i6)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=ug1_3456(i3,i4,i5,i6)%a,bb=ug1_3456(i3,i4,i5,i6)%b,cc=ug1_345
* 6(i3,i4,i5,i6)%c,dd=ug1_3456(i3,i4,i5,i6)%d,a1=l1_56(i5,i6)%a,b1=l1_56
* (i5,i6)%b,c1=l1_56(i5,i6)%c,d1=l1_56(i5,i6)%d,a2=ug156_34(i3,i4)%a,b2=
* ug156_34(i3,i4)%b,c2=ug156_34(i3,i4)%c,d2=ug156_34(i3,i4)%d,prq=p156q,
* m=rmass(id1),nsum=1
      ug1_3456(i3,i4,i5,i6)%a(1,1)=ug1_3456(i3,i4,i5,i6)%a(1,1)+
     & l1_56(i5,i6)%a(1,1)*ug156_34(i3,i4)%a(1,1)+l1_56(i5,i6)%c
     & (1,2)*p156q*ug156_34(i3,i4)%b(2,1)
      ug1_3456(i3,i4,i5,i6)%b(1,1)=ug1_3456(i3,i4,i5,i6)%b(1,1)+
     & rmass(id1)*(l1_56(i5,i6)%d(1,1)*ug156_34(i3,i4)%a(1,1)+l1
     & _56(i5,i6)%b(1,2)*ug156_34(i3,i4)%b(2,1))
      ug1_3456(i3,i4,i5,i6)%c(1,1)=ug1_3456(i3,i4,i5,i6)%c(1,1)+
     & rmass(id1)*(l1_56(i5,i6)%a(1,1)*ug156_34(i3,i4)%d(1,1)+l1
     & _56(i5,i6)%c(1,2)*ug156_34(i3,i4)%c(2,1))
      ug1_3456(i3,i4,i5,i6)%d(1,1)=ug1_3456(i3,i4,i5,i6)%d(1,1)+
     & l1_56(i5,i6)%d(1,1)*p156q*ug156_34(i3,i4)%d(1,1)+l1_56(i5
     & ,i6)%b(1,2)*ug156_34(i3,i4)%c(2,1)
      ug1_3456(i3,i4,i5,i6)%a(1,2)=ug1_3456(i3,i4,i5,i6)%a(1,2)+
     & rmass(id1)*(l1_56(i5,i6)%a(1,1)*ug156_34(i3,i4)%b(1,2)+l1
     & _56(i5,i6)%c(1,2)*ug156_34(i3,i4)%a(2,2))
      ug1_3456(i3,i4,i5,i6)%b(1,2)=ug1_3456(i3,i4,i5,i6)%b(1,2)+
     & l1_56(i5,i6)%d(1,1)*p156q*ug156_34(i3,i4)%b(1,2)+l1_56(i5
     & ,i6)%b(1,2)*ug156_34(i3,i4)%a(2,2)
      ug1_3456(i3,i4,i5,i6)%c(1,2)=ug1_3456(i3,i4,i5,i6)%c(1,2)+
     & l1_56(i5,i6)%a(1,1)*ug156_34(i3,i4)%c(1,2)+l1_56(i5,i6)%c
     & (1,2)*p156q*ug156_34(i3,i4)%d(2,2)
      ug1_3456(i3,i4,i5,i6)%d(1,2)=ug1_3456(i3,i4,i5,i6)%d(1,2)+
     & rmass(id1)*(l1_56(i5,i6)%d(1,1)*ug156_34(i3,i4)%c(1,2)+l1
     & _56(i5,i6)%b(1,2)*ug156_34(i3,i4)%d(2,2))
      ug1_3456(i3,i4,i5,i6)%a(2,1)=ug1_3456(i3,i4,i5,i6)%a(2,1)+
     & rmass(id1)*(l1_56(i5,i6)%c(2,1)*ug156_34(i3,i4)%a(1,1)+l1
     & _56(i5,i6)%a(2,2)*ug156_34(i3,i4)%b(2,1))
      ug1_3456(i3,i4,i5,i6)%b(2,1)=ug1_3456(i3,i4,i5,i6)%b(2,1)+
     & l1_56(i5,i6)%b(2,1)*ug156_34(i3,i4)%a(1,1)+l1_56(i5,i6)%d
     & (2,2)*p156q*ug156_34(i3,i4)%b(2,1)
      ug1_3456(i3,i4,i5,i6)%c(2,1)=ug1_3456(i3,i4,i5,i6)%c(2,1)+
     & l1_56(i5,i6)%c(2,1)*p156q*ug156_34(i3,i4)%d(1,1)+l1_56(i5
     & ,i6)%a(2,2)*ug156_34(i3,i4)%c(2,1)
      ug1_3456(i3,i4,i5,i6)%d(2,1)=ug1_3456(i3,i4,i5,i6)%d(2,1)+
     & rmass(id1)*(l1_56(i5,i6)%b(2,1)*ug156_34(i3,i4)%d(1,1)+l1
     & _56(i5,i6)%d(2,2)*ug156_34(i3,i4)%c(2,1))
      ug1_3456(i3,i4,i5,i6)%a(2,2)=ug1_3456(i3,i4,i5,i6)%a(2,2)+
     & l1_56(i5,i6)%c(2,1)*p156q*ug156_34(i3,i4)%b(1,2)+l1_56(i5
     & ,i6)%a(2,2)*ug156_34(i3,i4)%a(2,2)
      ug1_3456(i3,i4,i5,i6)%b(2,2)=ug1_3456(i3,i4,i5,i6)%b(2,2)+
     & rmass(id1)*(l1_56(i5,i6)%b(2,1)*ug156_34(i3,i4)%b(1,2)+l1
     & _56(i5,i6)%d(2,2)*ug156_34(i3,i4)%a(2,2))
      ug1_3456(i3,i4,i5,i6)%c(2,2)=ug1_3456(i3,i4,i5,i6)%c(2,2)+
     & rmass(id1)*(l1_56(i5,i6)%c(2,1)*ug156_34(i3,i4)%c(1,2)+l1
     & _56(i5,i6)%a(2,2)*ug156_34(i3,i4)%d(2,2))
      ug1_3456(i3,i4,i5,i6)%d(2,2)=ug1_3456(i3,i4,i5,i6)%d(2,2)+
     & l1_56(i5,i6)%b(2,1)*ug156_34(i3,i4)%c(1,2)+l1_56(i5,i6)%d
     & (2,2)*p156q*ug156_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TTs -- aa=ug1_3456(i3,i4,i5,i6)%a,bb=ug1_3456(i3,i4,i5,i6)%b,cc=ug1_34
* 56(i3,i4,i5,i6)%c,dd=ug1_3456(i3,i4,i5,i6)%d,a1=lg1_34(i3,i4)%a,b1=lg1
* _34(i3,i4)%b,c1=lg1_34(i3,i4)%c,d1=lg1_34(i3,i4)%d,a2=u134_56(i5,i6)%a
* ,b2=u134_56(i5,i6)%b,c2=u134_56(i5,i6)%c,d2=u134_56(i5,i6)%d,prq=p134q
* ,m=rmass(id1),nsum=0
      do jut=1,2
      cx1=u134_56(i5,i6)%a(1,jut)+rmass(id1)*u134_56(i5,i6)%b(1,
     & jut)
      cx2=u134_56(i5,i6)%a(2,jut)+rmass(id1)*u134_56(i5,i6)%b(2,
     & jut)
      cy1=p134q*u134_56(i5,i6)%b(1,jut)+rmass(id1)*u134_56(i5,i6
     & )%a(1,jut)
      cy2=p134q*u134_56(i5,i6)%b(2,jut)+rmass(id1)*u134_56(i5,i6
     & )%a(2,jut)
      cw1=u134_56(i5,i6)%c(1,jut)+rmass(id1)*u134_56(i5,i6)%d(1,
     & jut)
      cw2=u134_56(i5,i6)%c(2,jut)+rmass(id1)*u134_56(i5,i6)%d(2,
     & jut)
      cz1=p134q*u134_56(i5,i6)%d(1,jut)+rmass(id1)*u134_56(i5,i6
     & )%c(1,jut)
      cz2=p134q*u134_56(i5,i6)%d(2,jut)+rmass(id1)*u134_56(i5,i6
     & )%c(2,jut)
      ug1_3456(i3,i4,i5,i6)%a(1,jut)=lg1_34(i3,i4)%a(1,1)*cx1+lg
     & 1_34(i3,i4)%c(1,2)*cy2
      ug1_3456(i3,i4,i5,i6)%b(1,jut)=lg1_34(i3,i4)%d(1,1)*cy1+lg
     & 1_34(i3,i4)%b(1,2)*cx2
      ug1_3456(i3,i4,i5,i6)%c(1,jut)=lg1_34(i3,i4)%a(1,1)*cw1+lg
     & 1_34(i3,i4)%c(1,2)*cz2
      ug1_3456(i3,i4,i5,i6)%d(1,jut)=lg1_34(i3,i4)%d(1,1)*cz1+lg
     & 1_34(i3,i4)%b(1,2)*cw2
      ug1_3456(i3,i4,i5,i6)%a(2,jut)=lg1_34(i3,i4)%c(2,1)*cy1+lg
     & 1_34(i3,i4)%a(2,2)*cx2
      ug1_3456(i3,i4,i5,i6)%b(2,jut)=lg1_34(i3,i4)%b(2,1)*cx1+lg
     & 1_34(i3,i4)%d(2,2)*cy2
      ug1_3456(i3,i4,i5,i6)%c(2,jut)=lg1_34(i3,i4)%c(2,1)*cz1+lg
     & 1_34(i3,i4)%a(2,2)*cw2
      ug1_3456(i3,i4,i5,i6)%d(2,jut)=lg1_34(i3,i4)%b(2,1)*cw1+lg
     & 1_34(i3,i4)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=ug1_3456(i3,i4,i5,i6)%a,bb=ug1_3456(i3,i4,i5,i6)%b,cc=ug1_34
* 56(i3,i4,i5,i6)%c,dd=ug1_3456(i3,i4,i5,i6)%d,a1=l1_56(i5,i6)%a,b1=l1_5
* 6(i5,i6)%b,c1=l1_56(i5,i6)%c,d1=l1_56(i5,i6)%d,a2=ug156_34(i3,i4)%a,b2
* =ug156_34(i3,i4)%b,c2=ug156_34(i3,i4)%c,d2=ug156_34(i3,i4)%d,prq=p156q
* ,m=rmass(id1),nsum=1
      do iut=1,2
      cx1=l1_56(i5,i6)%a(iut,1)+l1_56(i5,i6)%c(iut,1)*rmass(id1)
      cx2=l1_56(i5,i6)%c(iut,2)*p156q+l1_56(i5,i6)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_56(i5,i6)%b(iut,1)+l1_56(i5,i6)%d(iut,1)*rmass(id1)
      cy2=l1_56(i5,i6)%d(iut,2)*p156q+l1_56(i5,i6)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_56(i5,i6)%c(iut,1)*p156q+l1_56(i5,i6)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_56(i5,i6)%a(iut,2)+l1_56(i5,i6)%c(iut,2)*rmass(id1)
      cz1=l1_56(i5,i6)%d(iut,1)*p156q+l1_56(i5,i6)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_56(i5,i6)%b(iut,2)+l1_56(i5,i6)%d(iut,2)*rmass(id1)
      ug1_3456(i3,i4,i5,i6)%a(iut,1)=ug1_3456(i3,i4,i5,i6)%a(iut
     & ,1)+cx1*ug156_34(i3,i4)%a(1,1)+cx2*ug156_34(i3,i4)%b(2,1)
      ug1_3456(i3,i4,i5,i6)%b(iut,1)=ug1_3456(i3,i4,i5,i6)%b(iut
     & ,1)+cy1*ug156_34(i3,i4)%a(1,1)+cy2*ug156_34(i3,i4)%b(2,1)
      ug1_3456(i3,i4,i5,i6)%c(iut,1)=ug1_3456(i3,i4,i5,i6)%c(iut
     & ,1)+cw1*ug156_34(i3,i4)%d(1,1)+cw2*ug156_34(i3,i4)%c(2,1)
      ug1_3456(i3,i4,i5,i6)%d(iut,1)=ug1_3456(i3,i4,i5,i6)%d(iut
     & ,1)+cz1*ug156_34(i3,i4)%d(1,1)+cz2*ug156_34(i3,i4)%c(2,1)
      ug1_3456(i3,i4,i5,i6)%a(iut,2)=ug1_3456(i3,i4,i5,i6)%a(iut
     & ,2)+cw1*ug156_34(i3,i4)%b(1,2)+cw2*ug156_34(i3,i4)%a(2,2)
      ug1_3456(i3,i4,i5,i6)%b(iut,2)=ug1_3456(i3,i4,i5,i6)%b(iut
     & ,2)+cz1*ug156_34(i3,i4)%b(1,2)+cz2*ug156_34(i3,i4)%a(2,2)
      ug1_3456(i3,i4,i5,i6)%c(iut,2)=ug1_3456(i3,i4,i5,i6)%c(iut
     & ,2)+cx1*ug156_34(i3,i4)%c(1,2)+cx2*ug156_34(i3,i4)%d(2,2)
      ug1_3456(i3,i4,i5,i6)%d(iut,2)=ug1_3456(i3,i4,i5,i6)%d(iut
     & ,2)+cy1*ug156_34(i3,i4)%c(1,2)+cy2*ug156_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id1).ne.1 .and. ilept(id5).ne.1)then
        if(id1.ne.5 .or. id3.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=ug1_5634(i5,i6,i3,i4)%a,bb=ug1_5634(i5,i6,i3,i4)%b,cc=ug1_563
* 4(i5,i6,i3,i4)%c,dd=ug1_5634(i5,i6,i3,i4)%d,a1=lg1_56(i5,i6)%a,b1=lg1_
* 56(i5,i6)%b,c1=lg1_56(i5,i6)%c,d1=lg1_56(i5,i6)%d,a2=u156_34(i3,i4)%a,
* b2=u156_34(i3,i4)%b,c2=u156_34(i3,i4)%c,d2=u156_34(i3,i4)%d,prq=p156q,
* m=rmass(id1),nsum=0
      ug1_5634(i5,i6,i3,i4)%a(1,1)=lg1_56(i5,i6)%a(1,1)*u156_34(
     & i3,i4)%a(1,1)+lg1_56(i5,i6)%c(1,2)*p156q*u156_34(i3,i4)%b
     & (2,1)
      ug1_5634(i5,i6,i3,i4)%b(1,1)=rmass(id1)*(lg1_56(i5,i6)%d(1
     & ,1)*u156_34(i3,i4)%a(1,1)+lg1_56(i5,i6)%b(1,2)*u156_34(i3
     & ,i4)%b(2,1))
      ug1_5634(i5,i6,i3,i4)%c(1,1)=rmass(id1)*(lg1_56(i5,i6)%a(1
     & ,1)*u156_34(i3,i4)%d(1,1)+lg1_56(i5,i6)%c(1,2)*u156_34(i3
     & ,i4)%c(2,1))
      ug1_5634(i5,i6,i3,i4)%d(1,1)=lg1_56(i5,i6)%d(1,1)*p156q*u1
     & 56_34(i3,i4)%d(1,1)+lg1_56(i5,i6)%b(1,2)*u156_34(i3,i4)%c
     & (2,1)
      ug1_5634(i5,i6,i3,i4)%a(1,2)=rmass(id1)*(lg1_56(i5,i6)%a(1
     & ,1)*u156_34(i3,i4)%b(1,2)+lg1_56(i5,i6)%c(1,2)*u156_34(i3
     & ,i4)%a(2,2))
      ug1_5634(i5,i6,i3,i4)%b(1,2)=lg1_56(i5,i6)%d(1,1)*p156q*u1
     & 56_34(i3,i4)%b(1,2)+lg1_56(i5,i6)%b(1,2)*u156_34(i3,i4)%a
     & (2,2)
      ug1_5634(i5,i6,i3,i4)%c(1,2)=lg1_56(i5,i6)%a(1,1)*u156_34(
     & i3,i4)%c(1,2)+lg1_56(i5,i6)%c(1,2)*p156q*u156_34(i3,i4)%d
     & (2,2)
      ug1_5634(i5,i6,i3,i4)%d(1,2)=rmass(id1)*(lg1_56(i5,i6)%d(1
     & ,1)*u156_34(i3,i4)%c(1,2)+lg1_56(i5,i6)%b(1,2)*u156_34(i3
     & ,i4)%d(2,2))
      ug1_5634(i5,i6,i3,i4)%a(2,1)=rmass(id1)*(lg1_56(i5,i6)%c(2
     & ,1)*u156_34(i3,i4)%a(1,1)+lg1_56(i5,i6)%a(2,2)*u156_34(i3
     & ,i4)%b(2,1))
      ug1_5634(i5,i6,i3,i4)%b(2,1)=lg1_56(i5,i6)%b(2,1)*u156_34(
     & i3,i4)%a(1,1)+lg1_56(i5,i6)%d(2,2)*p156q*u156_34(i3,i4)%b
     & (2,1)
      ug1_5634(i5,i6,i3,i4)%c(2,1)=lg1_56(i5,i6)%c(2,1)*p156q*u1
     & 56_34(i3,i4)%d(1,1)+lg1_56(i5,i6)%a(2,2)*u156_34(i3,i4)%c
     & (2,1)
      ug1_5634(i5,i6,i3,i4)%d(2,1)=rmass(id1)*(lg1_56(i5,i6)%b(2
     & ,1)*u156_34(i3,i4)%d(1,1)+lg1_56(i5,i6)%d(2,2)*u156_34(i3
     & ,i4)%c(2,1))
      ug1_5634(i5,i6,i3,i4)%a(2,2)=lg1_56(i5,i6)%c(2,1)*p156q*u1
     & 56_34(i3,i4)%b(1,2)+lg1_56(i5,i6)%a(2,2)*u156_34(i3,i4)%a
     & (2,2)
      ug1_5634(i5,i6,i3,i4)%b(2,2)=rmass(id1)*(lg1_56(i5,i6)%b(2
     & ,1)*u156_34(i3,i4)%b(1,2)+lg1_56(i5,i6)%d(2,2)*u156_34(i3
     & ,i4)%a(2,2))
      ug1_5634(i5,i6,i3,i4)%c(2,2)=rmass(id1)*(lg1_56(i5,i6)%c(2
     & ,1)*u156_34(i3,i4)%c(1,2)+lg1_56(i5,i6)%a(2,2)*u156_34(i3
     & ,i4)%d(2,2))
      ug1_5634(i5,i6,i3,i4)%d(2,2)=lg1_56(i5,i6)%b(2,1)*u156_34(
     & i3,i4)%c(1,2)+lg1_56(i5,i6)%d(2,2)*p156q*u156_34(i3,i4)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=ug1_5634(i5,i6,i3,i4)%a,bb=ug1_5634(i5,i6,i3,i4)%b,cc=ug1_563
* 4(i5,i6,i3,i4)%c,dd=ug1_5634(i5,i6,i3,i4)%d,a1=l1_34(i3,i4)%a,b1=l1_34
* (i3,i4)%b,c1=l1_34(i3,i4)%c,d1=l1_34(i3,i4)%d,a2=ug134_56(i5,i6)%a,b2=
* ug134_56(i5,i6)%b,c2=ug134_56(i5,i6)%c,d2=ug134_56(i5,i6)%d,prq=p134q,
* m=rmass(id1),nsum=1
      ug1_5634(i5,i6,i3,i4)%a(1,1)=ug1_5634(i5,i6,i3,i4)%a(1,1)+
     & l1_34(i3,i4)%a(1,1)*ug134_56(i5,i6)%a(1,1)+l1_34(i3,i4)%c
     & (1,2)*p134q*ug134_56(i5,i6)%b(2,1)
      ug1_5634(i5,i6,i3,i4)%b(1,1)=ug1_5634(i5,i6,i3,i4)%b(1,1)+
     & rmass(id1)*(l1_34(i3,i4)%d(1,1)*ug134_56(i5,i6)%a(1,1)+l1
     & _34(i3,i4)%b(1,2)*ug134_56(i5,i6)%b(2,1))
      ug1_5634(i5,i6,i3,i4)%c(1,1)=ug1_5634(i5,i6,i3,i4)%c(1,1)+
     & rmass(id1)*(l1_34(i3,i4)%a(1,1)*ug134_56(i5,i6)%d(1,1)+l1
     & _34(i3,i4)%c(1,2)*ug134_56(i5,i6)%c(2,1))
      ug1_5634(i5,i6,i3,i4)%d(1,1)=ug1_5634(i5,i6,i3,i4)%d(1,1)+
     & l1_34(i3,i4)%d(1,1)*p134q*ug134_56(i5,i6)%d(1,1)+l1_34(i3
     & ,i4)%b(1,2)*ug134_56(i5,i6)%c(2,1)
      ug1_5634(i5,i6,i3,i4)%a(1,2)=ug1_5634(i5,i6,i3,i4)%a(1,2)+
     & rmass(id1)*(l1_34(i3,i4)%a(1,1)*ug134_56(i5,i6)%b(1,2)+l1
     & _34(i3,i4)%c(1,2)*ug134_56(i5,i6)%a(2,2))
      ug1_5634(i5,i6,i3,i4)%b(1,2)=ug1_5634(i5,i6,i3,i4)%b(1,2)+
     & l1_34(i3,i4)%d(1,1)*p134q*ug134_56(i5,i6)%b(1,2)+l1_34(i3
     & ,i4)%b(1,2)*ug134_56(i5,i6)%a(2,2)
      ug1_5634(i5,i6,i3,i4)%c(1,2)=ug1_5634(i5,i6,i3,i4)%c(1,2)+
     & l1_34(i3,i4)%a(1,1)*ug134_56(i5,i6)%c(1,2)+l1_34(i3,i4)%c
     & (1,2)*p134q*ug134_56(i5,i6)%d(2,2)
      ug1_5634(i5,i6,i3,i4)%d(1,2)=ug1_5634(i5,i6,i3,i4)%d(1,2)+
     & rmass(id1)*(l1_34(i3,i4)%d(1,1)*ug134_56(i5,i6)%c(1,2)+l1
     & _34(i3,i4)%b(1,2)*ug134_56(i5,i6)%d(2,2))
      ug1_5634(i5,i6,i3,i4)%a(2,1)=ug1_5634(i5,i6,i3,i4)%a(2,1)+
     & rmass(id1)*(l1_34(i3,i4)%c(2,1)*ug134_56(i5,i6)%a(1,1)+l1
     & _34(i3,i4)%a(2,2)*ug134_56(i5,i6)%b(2,1))
      ug1_5634(i5,i6,i3,i4)%b(2,1)=ug1_5634(i5,i6,i3,i4)%b(2,1)+
     & l1_34(i3,i4)%b(2,1)*ug134_56(i5,i6)%a(1,1)+l1_34(i3,i4)%d
     & (2,2)*p134q*ug134_56(i5,i6)%b(2,1)
      ug1_5634(i5,i6,i3,i4)%c(2,1)=ug1_5634(i5,i6,i3,i4)%c(2,1)+
     & l1_34(i3,i4)%c(2,1)*p134q*ug134_56(i5,i6)%d(1,1)+l1_34(i3
     & ,i4)%a(2,2)*ug134_56(i5,i6)%c(2,1)
      ug1_5634(i5,i6,i3,i4)%d(2,1)=ug1_5634(i5,i6,i3,i4)%d(2,1)+
     & rmass(id1)*(l1_34(i3,i4)%b(2,1)*ug134_56(i5,i6)%d(1,1)+l1
     & _34(i3,i4)%d(2,2)*ug134_56(i5,i6)%c(2,1))
      ug1_5634(i5,i6,i3,i4)%a(2,2)=ug1_5634(i5,i6,i3,i4)%a(2,2)+
     & l1_34(i3,i4)%c(2,1)*p134q*ug134_56(i5,i6)%b(1,2)+l1_34(i3
     & ,i4)%a(2,2)*ug134_56(i5,i6)%a(2,2)
      ug1_5634(i5,i6,i3,i4)%b(2,2)=ug1_5634(i5,i6,i3,i4)%b(2,2)+
     & rmass(id1)*(l1_34(i3,i4)%b(2,1)*ug134_56(i5,i6)%b(1,2)+l1
     & _34(i3,i4)%d(2,2)*ug134_56(i5,i6)%a(2,2))
      ug1_5634(i5,i6,i3,i4)%c(2,2)=ug1_5634(i5,i6,i3,i4)%c(2,2)+
     & rmass(id1)*(l1_34(i3,i4)%c(2,1)*ug134_56(i5,i6)%c(1,2)+l1
     & _34(i3,i4)%a(2,2)*ug134_56(i5,i6)%d(2,2))
      ug1_5634(i5,i6,i3,i4)%d(2,2)=ug1_5634(i5,i6,i3,i4)%d(2,2)+
     & l1_34(i3,i4)%b(2,1)*ug134_56(i5,i6)%c(1,2)+l1_34(i3,i4)%d
     & (2,2)*p134q*ug134_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* TTs -- aa=ug1_5634(i5,i6,i3,i4)%a,bb=ug1_5634(i5,i6,i3,i4)%b,cc=ug1_56
* 34(i5,i6,i3,i4)%c,dd=ug1_5634(i5,i6,i3,i4)%d,a1=lg1_56(i5,i6)%a,b1=lg1
* _56(i5,i6)%b,c1=lg1_56(i5,i6)%c,d1=lg1_56(i5,i6)%d,a2=u156_34(i3,i4)%a
* ,b2=u156_34(i3,i4)%b,c2=u156_34(i3,i4)%c,d2=u156_34(i3,i4)%d,prq=p156q
* ,m=rmass(id1),nsum=0
      do jut=1,2
      cx1=u156_34(i3,i4)%a(1,jut)+rmass(id1)*u156_34(i3,i4)%b(1,
     & jut)
      cx2=u156_34(i3,i4)%a(2,jut)+rmass(id1)*u156_34(i3,i4)%b(2,
     & jut)
      cy1=p156q*u156_34(i3,i4)%b(1,jut)+rmass(id1)*u156_34(i3,i4
     & )%a(1,jut)
      cy2=p156q*u156_34(i3,i4)%b(2,jut)+rmass(id1)*u156_34(i3,i4
     & )%a(2,jut)
      cw1=u156_34(i3,i4)%c(1,jut)+rmass(id1)*u156_34(i3,i4)%d(1,
     & jut)
      cw2=u156_34(i3,i4)%c(2,jut)+rmass(id1)*u156_34(i3,i4)%d(2,
     & jut)
      cz1=p156q*u156_34(i3,i4)%d(1,jut)+rmass(id1)*u156_34(i3,i4
     & )%c(1,jut)
      cz2=p156q*u156_34(i3,i4)%d(2,jut)+rmass(id1)*u156_34(i3,i4
     & )%c(2,jut)
      ug1_5634(i5,i6,i3,i4)%a(1,jut)=lg1_56(i5,i6)%a(1,1)*cx1+lg
     & 1_56(i5,i6)%c(1,2)*cy2
      ug1_5634(i5,i6,i3,i4)%b(1,jut)=lg1_56(i5,i6)%d(1,1)*cy1+lg
     & 1_56(i5,i6)%b(1,2)*cx2
      ug1_5634(i5,i6,i3,i4)%c(1,jut)=lg1_56(i5,i6)%a(1,1)*cw1+lg
     & 1_56(i5,i6)%c(1,2)*cz2
      ug1_5634(i5,i6,i3,i4)%d(1,jut)=lg1_56(i5,i6)%d(1,1)*cz1+lg
     & 1_56(i5,i6)%b(1,2)*cw2
      ug1_5634(i5,i6,i3,i4)%a(2,jut)=lg1_56(i5,i6)%c(2,1)*cy1+lg
     & 1_56(i5,i6)%a(2,2)*cx2
      ug1_5634(i5,i6,i3,i4)%b(2,jut)=lg1_56(i5,i6)%b(2,1)*cx1+lg
     & 1_56(i5,i6)%d(2,2)*cy2
      ug1_5634(i5,i6,i3,i4)%c(2,jut)=lg1_56(i5,i6)%c(2,1)*cz1+lg
     & 1_56(i5,i6)%a(2,2)*cw2
      ug1_5634(i5,i6,i3,i4)%d(2,jut)=lg1_56(i5,i6)%b(2,1)*cw1+lg
     & 1_56(i5,i6)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=ug1_5634(i5,i6,i3,i4)%a,bb=ug1_5634(i5,i6,i3,i4)%b,cc=ug1_56
* 34(i5,i6,i3,i4)%c,dd=ug1_5634(i5,i6,i3,i4)%d,a1=l1_34(i3,i4)%a,b1=l1_3
* 4(i3,i4)%b,c1=l1_34(i3,i4)%c,d1=l1_34(i3,i4)%d,a2=ug134_56(i5,i6)%a,b2
* =ug134_56(i5,i6)%b,c2=ug134_56(i5,i6)%c,d2=ug134_56(i5,i6)%d,prq=p134q
* ,m=rmass(id1),nsum=1
      do iut=1,2
      cx1=l1_34(i3,i4)%a(iut,1)+l1_34(i3,i4)%c(iut,1)*rmass(id1)
      cx2=l1_34(i3,i4)%c(iut,2)*p134q+l1_34(i3,i4)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_34(i3,i4)%b(iut,1)+l1_34(i3,i4)%d(iut,1)*rmass(id1)
      cy2=l1_34(i3,i4)%d(iut,2)*p134q+l1_34(i3,i4)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_34(i3,i4)%c(iut,1)*p134q+l1_34(i3,i4)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_34(i3,i4)%a(iut,2)+l1_34(i3,i4)%c(iut,2)*rmass(id1)
      cz1=l1_34(i3,i4)%d(iut,1)*p134q+l1_34(i3,i4)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_34(i3,i4)%b(iut,2)+l1_34(i3,i4)%d(iut,2)*rmass(id1)
      ug1_5634(i5,i6,i3,i4)%a(iut,1)=ug1_5634(i5,i6,i3,i4)%a(iut
     & ,1)+cx1*ug134_56(i5,i6)%a(1,1)+cx2*ug134_56(i5,i6)%b(2,1)
      ug1_5634(i5,i6,i3,i4)%b(iut,1)=ug1_5634(i5,i6,i3,i4)%b(iut
     & ,1)+cy1*ug134_56(i5,i6)%a(1,1)+cy2*ug134_56(i5,i6)%b(2,1)
      ug1_5634(i5,i6,i3,i4)%c(iut,1)=ug1_5634(i5,i6,i3,i4)%c(iut
     & ,1)+cw1*ug134_56(i5,i6)%d(1,1)+cw2*ug134_56(i5,i6)%c(2,1)
      ug1_5634(i5,i6,i3,i4)%d(iut,1)=ug1_5634(i5,i6,i3,i4)%d(iut
     & ,1)+cz1*ug134_56(i5,i6)%d(1,1)+cz2*ug134_56(i5,i6)%c(2,1)
      ug1_5634(i5,i6,i3,i4)%a(iut,2)=ug1_5634(i5,i6,i3,i4)%a(iut
     & ,2)+cw1*ug134_56(i5,i6)%b(1,2)+cw2*ug134_56(i5,i6)%a(2,2)
      ug1_5634(i5,i6,i3,i4)%b(iut,2)=ug1_5634(i5,i6,i3,i4)%b(iut
     & ,2)+cz1*ug134_56(i5,i6)%b(1,2)+cz2*ug134_56(i5,i6)%a(2,2)
      ug1_5634(i5,i6,i3,i4)%c(iut,2)=ug1_5634(i5,i6,i3,i4)%c(iut
     & ,2)+cx1*ug134_56(i5,i6)%c(1,2)+cx2*ug134_56(i5,i6)%d(2,2)
      ug1_5634(i5,i6,i3,i4)%d(iut,2)=ug1_5634(i5,i6,i3,i4)%d(iut
     & ,2)+cy1*ug134_56(i5,i6)%c(1,2)+cy2*ug134_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id1).ne.1 .and. ilept(id3).ne.1)then
        if(id1.ne.5 .or. id7.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=ug1_3478(i3,i4,i7,i8)%a,bb=ug1_3478(i3,i4,i7,i8)%b,cc=ug1_347
* 8(i3,i4,i7,i8)%c,dd=ug1_3478(i3,i4,i7,i8)%d,a1=lg1_34(i3,i4)%a,b1=lg1_
* 34(i3,i4)%b,c1=lg1_34(i3,i4)%c,d1=lg1_34(i3,i4)%d,a2=u134_78(i7,i8)%a,
* b2=u134_78(i7,i8)%b,c2=u134_78(i7,i8)%c,d2=u134_78(i7,i8)%d,prq=p134q,
* m=rmass(id1),nsum=0
      ug1_3478(i3,i4,i7,i8)%a(1,1)=lg1_34(i3,i4)%a(1,1)*u134_78(
     & i7,i8)%a(1,1)+lg1_34(i3,i4)%c(1,2)*p134q*u134_78(i7,i8)%b
     & (2,1)
      ug1_3478(i3,i4,i7,i8)%b(1,1)=rmass(id1)*(lg1_34(i3,i4)%d(1
     & ,1)*u134_78(i7,i8)%a(1,1)+lg1_34(i3,i4)%b(1,2)*u134_78(i7
     & ,i8)%b(2,1))
      ug1_3478(i3,i4,i7,i8)%c(1,1)=rmass(id1)*(lg1_34(i3,i4)%a(1
     & ,1)*u134_78(i7,i8)%d(1,1)+lg1_34(i3,i4)%c(1,2)*u134_78(i7
     & ,i8)%c(2,1))
      ug1_3478(i3,i4,i7,i8)%d(1,1)=lg1_34(i3,i4)%d(1,1)*p134q*u1
     & 34_78(i7,i8)%d(1,1)+lg1_34(i3,i4)%b(1,2)*u134_78(i7,i8)%c
     & (2,1)
      ug1_3478(i3,i4,i7,i8)%a(1,2)=rmass(id1)*(lg1_34(i3,i4)%a(1
     & ,1)*u134_78(i7,i8)%b(1,2)+lg1_34(i3,i4)%c(1,2)*u134_78(i7
     & ,i8)%a(2,2))
      ug1_3478(i3,i4,i7,i8)%b(1,2)=lg1_34(i3,i4)%d(1,1)*p134q*u1
     & 34_78(i7,i8)%b(1,2)+lg1_34(i3,i4)%b(1,2)*u134_78(i7,i8)%a
     & (2,2)
      ug1_3478(i3,i4,i7,i8)%c(1,2)=lg1_34(i3,i4)%a(1,1)*u134_78(
     & i7,i8)%c(1,2)+lg1_34(i3,i4)%c(1,2)*p134q*u134_78(i7,i8)%d
     & (2,2)
      ug1_3478(i3,i4,i7,i8)%d(1,2)=rmass(id1)*(lg1_34(i3,i4)%d(1
     & ,1)*u134_78(i7,i8)%c(1,2)+lg1_34(i3,i4)%b(1,2)*u134_78(i7
     & ,i8)%d(2,2))
      ug1_3478(i3,i4,i7,i8)%a(2,1)=rmass(id1)*(lg1_34(i3,i4)%c(2
     & ,1)*u134_78(i7,i8)%a(1,1)+lg1_34(i3,i4)%a(2,2)*u134_78(i7
     & ,i8)%b(2,1))
      ug1_3478(i3,i4,i7,i8)%b(2,1)=lg1_34(i3,i4)%b(2,1)*u134_78(
     & i7,i8)%a(1,1)+lg1_34(i3,i4)%d(2,2)*p134q*u134_78(i7,i8)%b
     & (2,1)
      ug1_3478(i3,i4,i7,i8)%c(2,1)=lg1_34(i3,i4)%c(2,1)*p134q*u1
     & 34_78(i7,i8)%d(1,1)+lg1_34(i3,i4)%a(2,2)*u134_78(i7,i8)%c
     & (2,1)
      ug1_3478(i3,i4,i7,i8)%d(2,1)=rmass(id1)*(lg1_34(i3,i4)%b(2
     & ,1)*u134_78(i7,i8)%d(1,1)+lg1_34(i3,i4)%d(2,2)*u134_78(i7
     & ,i8)%c(2,1))
      ug1_3478(i3,i4,i7,i8)%a(2,2)=lg1_34(i3,i4)%c(2,1)*p134q*u1
     & 34_78(i7,i8)%b(1,2)+lg1_34(i3,i4)%a(2,2)*u134_78(i7,i8)%a
     & (2,2)
      ug1_3478(i3,i4,i7,i8)%b(2,2)=rmass(id1)*(lg1_34(i3,i4)%b(2
     & ,1)*u134_78(i7,i8)%b(1,2)+lg1_34(i3,i4)%d(2,2)*u134_78(i7
     & ,i8)%a(2,2))
      ug1_3478(i3,i4,i7,i8)%c(2,2)=rmass(id1)*(lg1_34(i3,i4)%c(2
     & ,1)*u134_78(i7,i8)%c(1,2)+lg1_34(i3,i4)%a(2,2)*u134_78(i7
     & ,i8)%d(2,2))
      ug1_3478(i3,i4,i7,i8)%d(2,2)=lg1_34(i3,i4)%b(2,1)*u134_78(
     & i7,i8)%c(1,2)+lg1_34(i3,i4)%d(2,2)*p134q*u134_78(i7,i8)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=ug1_3478(i3,i4,i7,i8)%a,bb=ug1_3478(i3,i4,i7,i8)%b,cc=ug1_347
* 8(i3,i4,i7,i8)%c,dd=ug1_3478(i3,i4,i7,i8)%d,a1=l1_78(i7,i8)%a,b1=l1_78
* (i7,i8)%b,c1=l1_78(i7,i8)%c,d1=l1_78(i7,i8)%d,a2=ug178_34(i3,i4)%a,b2=
* ug178_34(i3,i4)%b,c2=ug178_34(i3,i4)%c,d2=ug178_34(i3,i4)%d,prq=p178q,
* m=rmass(id1),nsum=1
      ug1_3478(i3,i4,i7,i8)%a(1,1)=ug1_3478(i3,i4,i7,i8)%a(1,1)+
     & l1_78(i7,i8)%a(1,1)*ug178_34(i3,i4)%a(1,1)+l1_78(i7,i8)%c
     & (1,2)*p178q*ug178_34(i3,i4)%b(2,1)
      ug1_3478(i3,i4,i7,i8)%b(1,1)=ug1_3478(i3,i4,i7,i8)%b(1,1)+
     & rmass(id1)*(l1_78(i7,i8)%d(1,1)*ug178_34(i3,i4)%a(1,1)+l1
     & _78(i7,i8)%b(1,2)*ug178_34(i3,i4)%b(2,1))
      ug1_3478(i3,i4,i7,i8)%c(1,1)=ug1_3478(i3,i4,i7,i8)%c(1,1)+
     & rmass(id1)*(l1_78(i7,i8)%a(1,1)*ug178_34(i3,i4)%d(1,1)+l1
     & _78(i7,i8)%c(1,2)*ug178_34(i3,i4)%c(2,1))
      ug1_3478(i3,i4,i7,i8)%d(1,1)=ug1_3478(i3,i4,i7,i8)%d(1,1)+
     & l1_78(i7,i8)%d(1,1)*p178q*ug178_34(i3,i4)%d(1,1)+l1_78(i7
     & ,i8)%b(1,2)*ug178_34(i3,i4)%c(2,1)
      ug1_3478(i3,i4,i7,i8)%a(1,2)=ug1_3478(i3,i4,i7,i8)%a(1,2)+
     & rmass(id1)*(l1_78(i7,i8)%a(1,1)*ug178_34(i3,i4)%b(1,2)+l1
     & _78(i7,i8)%c(1,2)*ug178_34(i3,i4)%a(2,2))
      ug1_3478(i3,i4,i7,i8)%b(1,2)=ug1_3478(i3,i4,i7,i8)%b(1,2)+
     & l1_78(i7,i8)%d(1,1)*p178q*ug178_34(i3,i4)%b(1,2)+l1_78(i7
     & ,i8)%b(1,2)*ug178_34(i3,i4)%a(2,2)
      ug1_3478(i3,i4,i7,i8)%c(1,2)=ug1_3478(i3,i4,i7,i8)%c(1,2)+
     & l1_78(i7,i8)%a(1,1)*ug178_34(i3,i4)%c(1,2)+l1_78(i7,i8)%c
     & (1,2)*p178q*ug178_34(i3,i4)%d(2,2)
      ug1_3478(i3,i4,i7,i8)%d(1,2)=ug1_3478(i3,i4,i7,i8)%d(1,2)+
     & rmass(id1)*(l1_78(i7,i8)%d(1,1)*ug178_34(i3,i4)%c(1,2)+l1
     & _78(i7,i8)%b(1,2)*ug178_34(i3,i4)%d(2,2))
      ug1_3478(i3,i4,i7,i8)%a(2,1)=ug1_3478(i3,i4,i7,i8)%a(2,1)+
     & rmass(id1)*(l1_78(i7,i8)%c(2,1)*ug178_34(i3,i4)%a(1,1)+l1
     & _78(i7,i8)%a(2,2)*ug178_34(i3,i4)%b(2,1))
      ug1_3478(i3,i4,i7,i8)%b(2,1)=ug1_3478(i3,i4,i7,i8)%b(2,1)+
     & l1_78(i7,i8)%b(2,1)*ug178_34(i3,i4)%a(1,1)+l1_78(i7,i8)%d
     & (2,2)*p178q*ug178_34(i3,i4)%b(2,1)
      ug1_3478(i3,i4,i7,i8)%c(2,1)=ug1_3478(i3,i4,i7,i8)%c(2,1)+
     & l1_78(i7,i8)%c(2,1)*p178q*ug178_34(i3,i4)%d(1,1)+l1_78(i7
     & ,i8)%a(2,2)*ug178_34(i3,i4)%c(2,1)
      ug1_3478(i3,i4,i7,i8)%d(2,1)=ug1_3478(i3,i4,i7,i8)%d(2,1)+
     & rmass(id1)*(l1_78(i7,i8)%b(2,1)*ug178_34(i3,i4)%d(1,1)+l1
     & _78(i7,i8)%d(2,2)*ug178_34(i3,i4)%c(2,1))
      ug1_3478(i3,i4,i7,i8)%a(2,2)=ug1_3478(i3,i4,i7,i8)%a(2,2)+
     & l1_78(i7,i8)%c(2,1)*p178q*ug178_34(i3,i4)%b(1,2)+l1_78(i7
     & ,i8)%a(2,2)*ug178_34(i3,i4)%a(2,2)
      ug1_3478(i3,i4,i7,i8)%b(2,2)=ug1_3478(i3,i4,i7,i8)%b(2,2)+
     & rmass(id1)*(l1_78(i7,i8)%b(2,1)*ug178_34(i3,i4)%b(1,2)+l1
     & _78(i7,i8)%d(2,2)*ug178_34(i3,i4)%a(2,2))
      ug1_3478(i3,i4,i7,i8)%c(2,2)=ug1_3478(i3,i4,i7,i8)%c(2,2)+
     & rmass(id1)*(l1_78(i7,i8)%c(2,1)*ug178_34(i3,i4)%c(1,2)+l1
     & _78(i7,i8)%a(2,2)*ug178_34(i3,i4)%d(2,2))
      ug1_3478(i3,i4,i7,i8)%d(2,2)=ug1_3478(i3,i4,i7,i8)%d(2,2)+
     & l1_78(i7,i8)%b(2,1)*ug178_34(i3,i4)%c(1,2)+l1_78(i7,i8)%d
     & (2,2)*p178q*ug178_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=ug1_3478(i3,i4,i7,i8)%a,bb=ug1_3478(i3,i4,i7,i8)%b,cc=ug1_34
* 78(i3,i4,i7,i8)%c,dd=ug1_3478(i3,i4,i7,i8)%d,a1=lg1_34(i3,i4)%a,b1=lg1
* _34(i3,i4)%b,c1=lg1_34(i3,i4)%c,d1=lg1_34(i3,i4)%d,a2=u134_78(i7,i8)%a
* ,b2=u134_78(i7,i8)%b,c2=u134_78(i7,i8)%c,d2=u134_78(i7,i8)%d,prq=p134q
* ,m=rmass(id1),nsum=0
      do jut=1,2
      cx1=u134_78(i7,i8)%a(1,jut)+rmass(id1)*u134_78(i7,i8)%b(1,
     & jut)
      cx2=u134_78(i7,i8)%a(2,jut)+rmass(id1)*u134_78(i7,i8)%b(2,
     & jut)
      cy1=p134q*u134_78(i7,i8)%b(1,jut)+rmass(id1)*u134_78(i7,i8
     & )%a(1,jut)
      cy2=p134q*u134_78(i7,i8)%b(2,jut)+rmass(id1)*u134_78(i7,i8
     & )%a(2,jut)
      cw1=u134_78(i7,i8)%c(1,jut)+rmass(id1)*u134_78(i7,i8)%d(1,
     & jut)
      cw2=u134_78(i7,i8)%c(2,jut)+rmass(id1)*u134_78(i7,i8)%d(2,
     & jut)
      cz1=p134q*u134_78(i7,i8)%d(1,jut)+rmass(id1)*u134_78(i7,i8
     & )%c(1,jut)
      cz2=p134q*u134_78(i7,i8)%d(2,jut)+rmass(id1)*u134_78(i7,i8
     & )%c(2,jut)
      ug1_3478(i3,i4,i7,i8)%a(1,jut)=lg1_34(i3,i4)%a(1,1)*cx1+lg
     & 1_34(i3,i4)%c(1,2)*cy2
      ug1_3478(i3,i4,i7,i8)%b(1,jut)=lg1_34(i3,i4)%d(1,1)*cy1+lg
     & 1_34(i3,i4)%b(1,2)*cx2
      ug1_3478(i3,i4,i7,i8)%c(1,jut)=lg1_34(i3,i4)%a(1,1)*cw1+lg
     & 1_34(i3,i4)%c(1,2)*cz2
      ug1_3478(i3,i4,i7,i8)%d(1,jut)=lg1_34(i3,i4)%d(1,1)*cz1+lg
     & 1_34(i3,i4)%b(1,2)*cw2
      ug1_3478(i3,i4,i7,i8)%a(2,jut)=lg1_34(i3,i4)%c(2,1)*cy1+lg
     & 1_34(i3,i4)%a(2,2)*cx2
      ug1_3478(i3,i4,i7,i8)%b(2,jut)=lg1_34(i3,i4)%b(2,1)*cx1+lg
     & 1_34(i3,i4)%d(2,2)*cy2
      ug1_3478(i3,i4,i7,i8)%c(2,jut)=lg1_34(i3,i4)%c(2,1)*cz1+lg
     & 1_34(i3,i4)%a(2,2)*cw2
      ug1_3478(i3,i4,i7,i8)%d(2,jut)=lg1_34(i3,i4)%b(2,1)*cw1+lg
     & 1_34(i3,i4)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=ug1_3478(i3,i4,i7,i8)%a,bb=ug1_3478(i3,i4,i7,i8)%b,cc=ug1_34
* 78(i3,i4,i7,i8)%c,dd=ug1_3478(i3,i4,i7,i8)%d,a1=l1_78(i7,i8)%a,b1=l1_7
* 8(i7,i8)%b,c1=l1_78(i7,i8)%c,d1=l1_78(i7,i8)%d,a2=ug178_34(i3,i4)%a,b2
* =ug178_34(i3,i4)%b,c2=ug178_34(i3,i4)%c,d2=ug178_34(i3,i4)%d,prq=p178q
* ,m=rmass(id1),nsum=1
      do iut=1,2
      cx1=l1_78(i7,i8)%a(iut,1)+l1_78(i7,i8)%c(iut,1)*rmass(id1)
      cx2=l1_78(i7,i8)%c(iut,2)*p178q+l1_78(i7,i8)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_78(i7,i8)%b(iut,1)+l1_78(i7,i8)%d(iut,1)*rmass(id1)
      cy2=l1_78(i7,i8)%d(iut,2)*p178q+l1_78(i7,i8)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_78(i7,i8)%c(iut,1)*p178q+l1_78(i7,i8)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_78(i7,i8)%a(iut,2)+l1_78(i7,i8)%c(iut,2)*rmass(id1)
      cz1=l1_78(i7,i8)%d(iut,1)*p178q+l1_78(i7,i8)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_78(i7,i8)%b(iut,2)+l1_78(i7,i8)%d(iut,2)*rmass(id1)
      ug1_3478(i3,i4,i7,i8)%a(iut,1)=ug1_3478(i3,i4,i7,i8)%a(iut
     & ,1)+cx1*ug178_34(i3,i4)%a(1,1)+cx2*ug178_34(i3,i4)%b(2,1)
      ug1_3478(i3,i4,i7,i8)%b(iut,1)=ug1_3478(i3,i4,i7,i8)%b(iut
     & ,1)+cy1*ug178_34(i3,i4)%a(1,1)+cy2*ug178_34(i3,i4)%b(2,1)
      ug1_3478(i3,i4,i7,i8)%c(iut,1)=ug1_3478(i3,i4,i7,i8)%c(iut
     & ,1)+cw1*ug178_34(i3,i4)%d(1,1)+cw2*ug178_34(i3,i4)%c(2,1)
      ug1_3478(i3,i4,i7,i8)%d(iut,1)=ug1_3478(i3,i4,i7,i8)%d(iut
     & ,1)+cz1*ug178_34(i3,i4)%d(1,1)+cz2*ug178_34(i3,i4)%c(2,1)
      ug1_3478(i3,i4,i7,i8)%a(iut,2)=ug1_3478(i3,i4,i7,i8)%a(iut
     & ,2)+cw1*ug178_34(i3,i4)%b(1,2)+cw2*ug178_34(i3,i4)%a(2,2)
      ug1_3478(i3,i4,i7,i8)%b(iut,2)=ug1_3478(i3,i4,i7,i8)%b(iut
     & ,2)+cz1*ug178_34(i3,i4)%b(1,2)+cz2*ug178_34(i3,i4)%a(2,2)
      ug1_3478(i3,i4,i7,i8)%c(iut,2)=ug1_3478(i3,i4,i7,i8)%c(iut
     & ,2)+cx1*ug178_34(i3,i4)%c(1,2)+cx2*ug178_34(i3,i4)%d(2,2)
      ug1_3478(i3,i4,i7,i8)%d(iut,2)=ug1_3478(i3,i4,i7,i8)%d(iut
     & ,2)+cy1*ug178_34(i3,i4)%c(1,2)+cy2*ug178_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id1).ne.1 .and. ilept(id7).ne.1)then
        if(id1.ne.5 .or. id3.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=ug1_7834(i7,i8,i3,i4)%a,bb=ug1_7834(i7,i8,i3,i4)%b,cc=ug1_783
* 4(i7,i8,i3,i4)%c,dd=ug1_7834(i7,i8,i3,i4)%d,a1=lg1_78(i7,i8)%a,b1=lg1_
* 78(i7,i8)%b,c1=lg1_78(i7,i8)%c,d1=lg1_78(i7,i8)%d,a2=u178_34(i3,i4)%a,
* b2=u178_34(i3,i4)%b,c2=u178_34(i3,i4)%c,d2=u178_34(i3,i4)%d,prq=p178q,
* m=rmass(id1),nsum=0
      ug1_7834(i7,i8,i3,i4)%a(1,1)=lg1_78(i7,i8)%a(1,1)*u178_34(
     & i3,i4)%a(1,1)+lg1_78(i7,i8)%c(1,2)*p178q*u178_34(i3,i4)%b
     & (2,1)
      ug1_7834(i7,i8,i3,i4)%b(1,1)=rmass(id1)*(lg1_78(i7,i8)%d(1
     & ,1)*u178_34(i3,i4)%a(1,1)+lg1_78(i7,i8)%b(1,2)*u178_34(i3
     & ,i4)%b(2,1))
      ug1_7834(i7,i8,i3,i4)%c(1,1)=rmass(id1)*(lg1_78(i7,i8)%a(1
     & ,1)*u178_34(i3,i4)%d(1,1)+lg1_78(i7,i8)%c(1,2)*u178_34(i3
     & ,i4)%c(2,1))
      ug1_7834(i7,i8,i3,i4)%d(1,1)=lg1_78(i7,i8)%d(1,1)*p178q*u1
     & 78_34(i3,i4)%d(1,1)+lg1_78(i7,i8)%b(1,2)*u178_34(i3,i4)%c
     & (2,1)
      ug1_7834(i7,i8,i3,i4)%a(1,2)=rmass(id1)*(lg1_78(i7,i8)%a(1
     & ,1)*u178_34(i3,i4)%b(1,2)+lg1_78(i7,i8)%c(1,2)*u178_34(i3
     & ,i4)%a(2,2))
      ug1_7834(i7,i8,i3,i4)%b(1,2)=lg1_78(i7,i8)%d(1,1)*p178q*u1
     & 78_34(i3,i4)%b(1,2)+lg1_78(i7,i8)%b(1,2)*u178_34(i3,i4)%a
     & (2,2)
      ug1_7834(i7,i8,i3,i4)%c(1,2)=lg1_78(i7,i8)%a(1,1)*u178_34(
     & i3,i4)%c(1,2)+lg1_78(i7,i8)%c(1,2)*p178q*u178_34(i3,i4)%d
     & (2,2)
      ug1_7834(i7,i8,i3,i4)%d(1,2)=rmass(id1)*(lg1_78(i7,i8)%d(1
     & ,1)*u178_34(i3,i4)%c(1,2)+lg1_78(i7,i8)%b(1,2)*u178_34(i3
     & ,i4)%d(2,2))
      ug1_7834(i7,i8,i3,i4)%a(2,1)=rmass(id1)*(lg1_78(i7,i8)%c(2
     & ,1)*u178_34(i3,i4)%a(1,1)+lg1_78(i7,i8)%a(2,2)*u178_34(i3
     & ,i4)%b(2,1))
      ug1_7834(i7,i8,i3,i4)%b(2,1)=lg1_78(i7,i8)%b(2,1)*u178_34(
     & i3,i4)%a(1,1)+lg1_78(i7,i8)%d(2,2)*p178q*u178_34(i3,i4)%b
     & (2,1)
      ug1_7834(i7,i8,i3,i4)%c(2,1)=lg1_78(i7,i8)%c(2,1)*p178q*u1
     & 78_34(i3,i4)%d(1,1)+lg1_78(i7,i8)%a(2,2)*u178_34(i3,i4)%c
     & (2,1)
      ug1_7834(i7,i8,i3,i4)%d(2,1)=rmass(id1)*(lg1_78(i7,i8)%b(2
     & ,1)*u178_34(i3,i4)%d(1,1)+lg1_78(i7,i8)%d(2,2)*u178_34(i3
     & ,i4)%c(2,1))
      ug1_7834(i7,i8,i3,i4)%a(2,2)=lg1_78(i7,i8)%c(2,1)*p178q*u1
     & 78_34(i3,i4)%b(1,2)+lg1_78(i7,i8)%a(2,2)*u178_34(i3,i4)%a
     & (2,2)
      ug1_7834(i7,i8,i3,i4)%b(2,2)=rmass(id1)*(lg1_78(i7,i8)%b(2
     & ,1)*u178_34(i3,i4)%b(1,2)+lg1_78(i7,i8)%d(2,2)*u178_34(i3
     & ,i4)%a(2,2))
      ug1_7834(i7,i8,i3,i4)%c(2,2)=rmass(id1)*(lg1_78(i7,i8)%c(2
     & ,1)*u178_34(i3,i4)%c(1,2)+lg1_78(i7,i8)%a(2,2)*u178_34(i3
     & ,i4)%d(2,2))
      ug1_7834(i7,i8,i3,i4)%d(2,2)=lg1_78(i7,i8)%b(2,1)*u178_34(
     & i3,i4)%c(1,2)+lg1_78(i7,i8)%d(2,2)*p178q*u178_34(i3,i4)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=ug1_7834(i7,i8,i3,i4)%a,bb=ug1_7834(i7,i8,i3,i4)%b,cc=ug1_783
* 4(i7,i8,i3,i4)%c,dd=ug1_7834(i7,i8,i3,i4)%d,a1=l1_34(i3,i4)%a,b1=l1_34
* (i3,i4)%b,c1=l1_34(i3,i4)%c,d1=l1_34(i3,i4)%d,a2=ug134_78(i7,i8)%a,b2=
* ug134_78(i7,i8)%b,c2=ug134_78(i7,i8)%c,d2=ug134_78(i7,i8)%d,prq=p134q,
* m=rmass(id1),nsum=1
      ug1_7834(i7,i8,i3,i4)%a(1,1)=ug1_7834(i7,i8,i3,i4)%a(1,1)+
     & l1_34(i3,i4)%a(1,1)*ug134_78(i7,i8)%a(1,1)+l1_34(i3,i4)%c
     & (1,2)*p134q*ug134_78(i7,i8)%b(2,1)
      ug1_7834(i7,i8,i3,i4)%b(1,1)=ug1_7834(i7,i8,i3,i4)%b(1,1)+
     & rmass(id1)*(l1_34(i3,i4)%d(1,1)*ug134_78(i7,i8)%a(1,1)+l1
     & _34(i3,i4)%b(1,2)*ug134_78(i7,i8)%b(2,1))
      ug1_7834(i7,i8,i3,i4)%c(1,1)=ug1_7834(i7,i8,i3,i4)%c(1,1)+
     & rmass(id1)*(l1_34(i3,i4)%a(1,1)*ug134_78(i7,i8)%d(1,1)+l1
     & _34(i3,i4)%c(1,2)*ug134_78(i7,i8)%c(2,1))
      ug1_7834(i7,i8,i3,i4)%d(1,1)=ug1_7834(i7,i8,i3,i4)%d(1,1)+
     & l1_34(i3,i4)%d(1,1)*p134q*ug134_78(i7,i8)%d(1,1)+l1_34(i3
     & ,i4)%b(1,2)*ug134_78(i7,i8)%c(2,1)
      ug1_7834(i7,i8,i3,i4)%a(1,2)=ug1_7834(i7,i8,i3,i4)%a(1,2)+
     & rmass(id1)*(l1_34(i3,i4)%a(1,1)*ug134_78(i7,i8)%b(1,2)+l1
     & _34(i3,i4)%c(1,2)*ug134_78(i7,i8)%a(2,2))
      ug1_7834(i7,i8,i3,i4)%b(1,2)=ug1_7834(i7,i8,i3,i4)%b(1,2)+
     & l1_34(i3,i4)%d(1,1)*p134q*ug134_78(i7,i8)%b(1,2)+l1_34(i3
     & ,i4)%b(1,2)*ug134_78(i7,i8)%a(2,2)
      ug1_7834(i7,i8,i3,i4)%c(1,2)=ug1_7834(i7,i8,i3,i4)%c(1,2)+
     & l1_34(i3,i4)%a(1,1)*ug134_78(i7,i8)%c(1,2)+l1_34(i3,i4)%c
     & (1,2)*p134q*ug134_78(i7,i8)%d(2,2)
      ug1_7834(i7,i8,i3,i4)%d(1,2)=ug1_7834(i7,i8,i3,i4)%d(1,2)+
     & rmass(id1)*(l1_34(i3,i4)%d(1,1)*ug134_78(i7,i8)%c(1,2)+l1
     & _34(i3,i4)%b(1,2)*ug134_78(i7,i8)%d(2,2))
      ug1_7834(i7,i8,i3,i4)%a(2,1)=ug1_7834(i7,i8,i3,i4)%a(2,1)+
     & rmass(id1)*(l1_34(i3,i4)%c(2,1)*ug134_78(i7,i8)%a(1,1)+l1
     & _34(i3,i4)%a(2,2)*ug134_78(i7,i8)%b(2,1))
      ug1_7834(i7,i8,i3,i4)%b(2,1)=ug1_7834(i7,i8,i3,i4)%b(2,1)+
     & l1_34(i3,i4)%b(2,1)*ug134_78(i7,i8)%a(1,1)+l1_34(i3,i4)%d
     & (2,2)*p134q*ug134_78(i7,i8)%b(2,1)
      ug1_7834(i7,i8,i3,i4)%c(2,1)=ug1_7834(i7,i8,i3,i4)%c(2,1)+
     & l1_34(i3,i4)%c(2,1)*p134q*ug134_78(i7,i8)%d(1,1)+l1_34(i3
     & ,i4)%a(2,2)*ug134_78(i7,i8)%c(2,1)
      ug1_7834(i7,i8,i3,i4)%d(2,1)=ug1_7834(i7,i8,i3,i4)%d(2,1)+
     & rmass(id1)*(l1_34(i3,i4)%b(2,1)*ug134_78(i7,i8)%d(1,1)+l1
     & _34(i3,i4)%d(2,2)*ug134_78(i7,i8)%c(2,1))
      ug1_7834(i7,i8,i3,i4)%a(2,2)=ug1_7834(i7,i8,i3,i4)%a(2,2)+
     & l1_34(i3,i4)%c(2,1)*p134q*ug134_78(i7,i8)%b(1,2)+l1_34(i3
     & ,i4)%a(2,2)*ug134_78(i7,i8)%a(2,2)
      ug1_7834(i7,i8,i3,i4)%b(2,2)=ug1_7834(i7,i8,i3,i4)%b(2,2)+
     & rmass(id1)*(l1_34(i3,i4)%b(2,1)*ug134_78(i7,i8)%b(1,2)+l1
     & _34(i3,i4)%d(2,2)*ug134_78(i7,i8)%a(2,2))
      ug1_7834(i7,i8,i3,i4)%c(2,2)=ug1_7834(i7,i8,i3,i4)%c(2,2)+
     & rmass(id1)*(l1_34(i3,i4)%c(2,1)*ug134_78(i7,i8)%c(1,2)+l1
     & _34(i3,i4)%a(2,2)*ug134_78(i7,i8)%d(2,2))
      ug1_7834(i7,i8,i3,i4)%d(2,2)=ug1_7834(i7,i8,i3,i4)%d(2,2)+
     & l1_34(i3,i4)%b(2,1)*ug134_78(i7,i8)%c(1,2)+l1_34(i3,i4)%d
     & (2,2)*p134q*ug134_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TTs -- aa=ug1_7834(i7,i8,i3,i4)%a,bb=ug1_7834(i7,i8,i3,i4)%b,cc=ug1_78
* 34(i7,i8,i3,i4)%c,dd=ug1_7834(i7,i8,i3,i4)%d,a1=lg1_78(i7,i8)%a,b1=lg1
* _78(i7,i8)%b,c1=lg1_78(i7,i8)%c,d1=lg1_78(i7,i8)%d,a2=u178_34(i3,i4)%a
* ,b2=u178_34(i3,i4)%b,c2=u178_34(i3,i4)%c,d2=u178_34(i3,i4)%d,prq=p178q
* ,m=rmass(id1),nsum=0
      do jut=1,2
      cx1=u178_34(i3,i4)%a(1,jut)+rmass(id1)*u178_34(i3,i4)%b(1,
     & jut)
      cx2=u178_34(i3,i4)%a(2,jut)+rmass(id1)*u178_34(i3,i4)%b(2,
     & jut)
      cy1=p178q*u178_34(i3,i4)%b(1,jut)+rmass(id1)*u178_34(i3,i4
     & )%a(1,jut)
      cy2=p178q*u178_34(i3,i4)%b(2,jut)+rmass(id1)*u178_34(i3,i4
     & )%a(2,jut)
      cw1=u178_34(i3,i4)%c(1,jut)+rmass(id1)*u178_34(i3,i4)%d(1,
     & jut)
      cw2=u178_34(i3,i4)%c(2,jut)+rmass(id1)*u178_34(i3,i4)%d(2,
     & jut)
      cz1=p178q*u178_34(i3,i4)%d(1,jut)+rmass(id1)*u178_34(i3,i4
     & )%c(1,jut)
      cz2=p178q*u178_34(i3,i4)%d(2,jut)+rmass(id1)*u178_34(i3,i4
     & )%c(2,jut)
      ug1_7834(i7,i8,i3,i4)%a(1,jut)=lg1_78(i7,i8)%a(1,1)*cx1+lg
     & 1_78(i7,i8)%c(1,2)*cy2
      ug1_7834(i7,i8,i3,i4)%b(1,jut)=lg1_78(i7,i8)%d(1,1)*cy1+lg
     & 1_78(i7,i8)%b(1,2)*cx2
      ug1_7834(i7,i8,i3,i4)%c(1,jut)=lg1_78(i7,i8)%a(1,1)*cw1+lg
     & 1_78(i7,i8)%c(1,2)*cz2
      ug1_7834(i7,i8,i3,i4)%d(1,jut)=lg1_78(i7,i8)%d(1,1)*cz1+lg
     & 1_78(i7,i8)%b(1,2)*cw2
      ug1_7834(i7,i8,i3,i4)%a(2,jut)=lg1_78(i7,i8)%c(2,1)*cy1+lg
     & 1_78(i7,i8)%a(2,2)*cx2
      ug1_7834(i7,i8,i3,i4)%b(2,jut)=lg1_78(i7,i8)%b(2,1)*cx1+lg
     & 1_78(i7,i8)%d(2,2)*cy2
      ug1_7834(i7,i8,i3,i4)%c(2,jut)=lg1_78(i7,i8)%c(2,1)*cz1+lg
     & 1_78(i7,i8)%a(2,2)*cw2
      ug1_7834(i7,i8,i3,i4)%d(2,jut)=lg1_78(i7,i8)%b(2,1)*cw1+lg
     & 1_78(i7,i8)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=ug1_7834(i7,i8,i3,i4)%a,bb=ug1_7834(i7,i8,i3,i4)%b,cc=ug1_78
* 34(i7,i8,i3,i4)%c,dd=ug1_7834(i7,i8,i3,i4)%d,a1=l1_34(i3,i4)%a,b1=l1_3
* 4(i3,i4)%b,c1=l1_34(i3,i4)%c,d1=l1_34(i3,i4)%d,a2=ug134_78(i7,i8)%a,b2
* =ug134_78(i7,i8)%b,c2=ug134_78(i7,i8)%c,d2=ug134_78(i7,i8)%d,prq=p134q
* ,m=rmass(id1),nsum=1
      do iut=1,2
      cx1=l1_34(i3,i4)%a(iut,1)+l1_34(i3,i4)%c(iut,1)*rmass(id1)
      cx2=l1_34(i3,i4)%c(iut,2)*p134q+l1_34(i3,i4)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_34(i3,i4)%b(iut,1)+l1_34(i3,i4)%d(iut,1)*rmass(id1)
      cy2=l1_34(i3,i4)%d(iut,2)*p134q+l1_34(i3,i4)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_34(i3,i4)%c(iut,1)*p134q+l1_34(i3,i4)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_34(i3,i4)%a(iut,2)+l1_34(i3,i4)%c(iut,2)*rmass(id1)
      cz1=l1_34(i3,i4)%d(iut,1)*p134q+l1_34(i3,i4)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_34(i3,i4)%b(iut,2)+l1_34(i3,i4)%d(iut,2)*rmass(id1)
      ug1_7834(i7,i8,i3,i4)%a(iut,1)=ug1_7834(i7,i8,i3,i4)%a(iut
     & ,1)+cx1*ug134_78(i7,i8)%a(1,1)+cx2*ug134_78(i7,i8)%b(2,1)
      ug1_7834(i7,i8,i3,i4)%b(iut,1)=ug1_7834(i7,i8,i3,i4)%b(iut
     & ,1)+cy1*ug134_78(i7,i8)%a(1,1)+cy2*ug134_78(i7,i8)%b(2,1)
      ug1_7834(i7,i8,i3,i4)%c(iut,1)=ug1_7834(i7,i8,i3,i4)%c(iut
     & ,1)+cw1*ug134_78(i7,i8)%d(1,1)+cw2*ug134_78(i7,i8)%c(2,1)
      ug1_7834(i7,i8,i3,i4)%d(iut,1)=ug1_7834(i7,i8,i3,i4)%d(iut
     & ,1)+cz1*ug134_78(i7,i8)%d(1,1)+cz2*ug134_78(i7,i8)%c(2,1)
      ug1_7834(i7,i8,i3,i4)%a(iut,2)=ug1_7834(i7,i8,i3,i4)%a(iut
     & ,2)+cw1*ug134_78(i7,i8)%b(1,2)+cw2*ug134_78(i7,i8)%a(2,2)
      ug1_7834(i7,i8,i3,i4)%b(iut,2)=ug1_7834(i7,i8,i3,i4)%b(iut
     & ,2)+cz1*ug134_78(i7,i8)%b(1,2)+cz2*ug134_78(i7,i8)%a(2,2)
      ug1_7834(i7,i8,i3,i4)%c(iut,2)=ug1_7834(i7,i8,i3,i4)%c(iut
     & ,2)+cx1*ug134_78(i7,i8)%c(1,2)+cx2*ug134_78(i7,i8)%d(2,2)
      ug1_7834(i7,i8,i3,i4)%d(iut,2)=ug1_7834(i7,i8,i3,i4)%d(iut
     & ,2)+cy1*ug134_78(i7,i8)%c(1,2)+cy2*ug134_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id1).ne.1 .and. ilept(id5).ne.1)then
        if(id1.ne.5 .or. id7.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=ug1_5678(i5,i6,i7,i8)%a,bb=ug1_5678(i5,i6,i7,i8)%b,cc=ug1_567
* 8(i5,i6,i7,i8)%c,dd=ug1_5678(i5,i6,i7,i8)%d,a1=lg1_56(i5,i6)%a,b1=lg1_
* 56(i5,i6)%b,c1=lg1_56(i5,i6)%c,d1=lg1_56(i5,i6)%d,a2=u156_78(i7,i8)%a,
* b2=u156_78(i7,i8)%b,c2=u156_78(i7,i8)%c,d2=u156_78(i7,i8)%d,prq=p156q,
* m=rmass(id1),nsum=0
      ug1_5678(i5,i6,i7,i8)%a(1,1)=lg1_56(i5,i6)%a(1,1)*u156_78(
     & i7,i8)%a(1,1)+lg1_56(i5,i6)%c(1,2)*p156q*u156_78(i7,i8)%b
     & (2,1)
      ug1_5678(i5,i6,i7,i8)%b(1,1)=rmass(id1)*(lg1_56(i5,i6)%d(1
     & ,1)*u156_78(i7,i8)%a(1,1)+lg1_56(i5,i6)%b(1,2)*u156_78(i7
     & ,i8)%b(2,1))
      ug1_5678(i5,i6,i7,i8)%c(1,1)=rmass(id1)*(lg1_56(i5,i6)%a(1
     & ,1)*u156_78(i7,i8)%d(1,1)+lg1_56(i5,i6)%c(1,2)*u156_78(i7
     & ,i8)%c(2,1))
      ug1_5678(i5,i6,i7,i8)%d(1,1)=lg1_56(i5,i6)%d(1,1)*p156q*u1
     & 56_78(i7,i8)%d(1,1)+lg1_56(i5,i6)%b(1,2)*u156_78(i7,i8)%c
     & (2,1)
      ug1_5678(i5,i6,i7,i8)%a(1,2)=rmass(id1)*(lg1_56(i5,i6)%a(1
     & ,1)*u156_78(i7,i8)%b(1,2)+lg1_56(i5,i6)%c(1,2)*u156_78(i7
     & ,i8)%a(2,2))
      ug1_5678(i5,i6,i7,i8)%b(1,2)=lg1_56(i5,i6)%d(1,1)*p156q*u1
     & 56_78(i7,i8)%b(1,2)+lg1_56(i5,i6)%b(1,2)*u156_78(i7,i8)%a
     & (2,2)
      ug1_5678(i5,i6,i7,i8)%c(1,2)=lg1_56(i5,i6)%a(1,1)*u156_78(
     & i7,i8)%c(1,2)+lg1_56(i5,i6)%c(1,2)*p156q*u156_78(i7,i8)%d
     & (2,2)
      ug1_5678(i5,i6,i7,i8)%d(1,2)=rmass(id1)*(lg1_56(i5,i6)%d(1
     & ,1)*u156_78(i7,i8)%c(1,2)+lg1_56(i5,i6)%b(1,2)*u156_78(i7
     & ,i8)%d(2,2))
      ug1_5678(i5,i6,i7,i8)%a(2,1)=rmass(id1)*(lg1_56(i5,i6)%c(2
     & ,1)*u156_78(i7,i8)%a(1,1)+lg1_56(i5,i6)%a(2,2)*u156_78(i7
     & ,i8)%b(2,1))
      ug1_5678(i5,i6,i7,i8)%b(2,1)=lg1_56(i5,i6)%b(2,1)*u156_78(
     & i7,i8)%a(1,1)+lg1_56(i5,i6)%d(2,2)*p156q*u156_78(i7,i8)%b
     & (2,1)
      ug1_5678(i5,i6,i7,i8)%c(2,1)=lg1_56(i5,i6)%c(2,1)*p156q*u1
     & 56_78(i7,i8)%d(1,1)+lg1_56(i5,i6)%a(2,2)*u156_78(i7,i8)%c
     & (2,1)
      ug1_5678(i5,i6,i7,i8)%d(2,1)=rmass(id1)*(lg1_56(i5,i6)%b(2
     & ,1)*u156_78(i7,i8)%d(1,1)+lg1_56(i5,i6)%d(2,2)*u156_78(i7
     & ,i8)%c(2,1))
      ug1_5678(i5,i6,i7,i8)%a(2,2)=lg1_56(i5,i6)%c(2,1)*p156q*u1
     & 56_78(i7,i8)%b(1,2)+lg1_56(i5,i6)%a(2,2)*u156_78(i7,i8)%a
     & (2,2)
      ug1_5678(i5,i6,i7,i8)%b(2,2)=rmass(id1)*(lg1_56(i5,i6)%b(2
     & ,1)*u156_78(i7,i8)%b(1,2)+lg1_56(i5,i6)%d(2,2)*u156_78(i7
     & ,i8)%a(2,2))
      ug1_5678(i5,i6,i7,i8)%c(2,2)=rmass(id1)*(lg1_56(i5,i6)%c(2
     & ,1)*u156_78(i7,i8)%c(1,2)+lg1_56(i5,i6)%a(2,2)*u156_78(i7
     & ,i8)%d(2,2))
      ug1_5678(i5,i6,i7,i8)%d(2,2)=lg1_56(i5,i6)%b(2,1)*u156_78(
     & i7,i8)%c(1,2)+lg1_56(i5,i6)%d(2,2)*p156q*u156_78(i7,i8)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=ug1_5678(i5,i6,i7,i8)%a,bb=ug1_5678(i5,i6,i7,i8)%b,cc=ug1_567
* 8(i5,i6,i7,i8)%c,dd=ug1_5678(i5,i6,i7,i8)%d,a1=l1_78(i7,i8)%a,b1=l1_78
* (i7,i8)%b,c1=l1_78(i7,i8)%c,d1=l1_78(i7,i8)%d,a2=ug178_56(i5,i6)%a,b2=
* ug178_56(i5,i6)%b,c2=ug178_56(i5,i6)%c,d2=ug178_56(i5,i6)%d,prq=p178q,
* m=rmass(id1),nsum=1
      ug1_5678(i5,i6,i7,i8)%a(1,1)=ug1_5678(i5,i6,i7,i8)%a(1,1)+
     & l1_78(i7,i8)%a(1,1)*ug178_56(i5,i6)%a(1,1)+l1_78(i7,i8)%c
     & (1,2)*p178q*ug178_56(i5,i6)%b(2,1)
      ug1_5678(i5,i6,i7,i8)%b(1,1)=ug1_5678(i5,i6,i7,i8)%b(1,1)+
     & rmass(id1)*(l1_78(i7,i8)%d(1,1)*ug178_56(i5,i6)%a(1,1)+l1
     & _78(i7,i8)%b(1,2)*ug178_56(i5,i6)%b(2,1))
      ug1_5678(i5,i6,i7,i8)%c(1,1)=ug1_5678(i5,i6,i7,i8)%c(1,1)+
     & rmass(id1)*(l1_78(i7,i8)%a(1,1)*ug178_56(i5,i6)%d(1,1)+l1
     & _78(i7,i8)%c(1,2)*ug178_56(i5,i6)%c(2,1))
      ug1_5678(i5,i6,i7,i8)%d(1,1)=ug1_5678(i5,i6,i7,i8)%d(1,1)+
     & l1_78(i7,i8)%d(1,1)*p178q*ug178_56(i5,i6)%d(1,1)+l1_78(i7
     & ,i8)%b(1,2)*ug178_56(i5,i6)%c(2,1)
      ug1_5678(i5,i6,i7,i8)%a(1,2)=ug1_5678(i5,i6,i7,i8)%a(1,2)+
     & rmass(id1)*(l1_78(i7,i8)%a(1,1)*ug178_56(i5,i6)%b(1,2)+l1
     & _78(i7,i8)%c(1,2)*ug178_56(i5,i6)%a(2,2))
      ug1_5678(i5,i6,i7,i8)%b(1,2)=ug1_5678(i5,i6,i7,i8)%b(1,2)+
     & l1_78(i7,i8)%d(1,1)*p178q*ug178_56(i5,i6)%b(1,2)+l1_78(i7
     & ,i8)%b(1,2)*ug178_56(i5,i6)%a(2,2)
      ug1_5678(i5,i6,i7,i8)%c(1,2)=ug1_5678(i5,i6,i7,i8)%c(1,2)+
     & l1_78(i7,i8)%a(1,1)*ug178_56(i5,i6)%c(1,2)+l1_78(i7,i8)%c
     & (1,2)*p178q*ug178_56(i5,i6)%d(2,2)
      ug1_5678(i5,i6,i7,i8)%d(1,2)=ug1_5678(i5,i6,i7,i8)%d(1,2)+
     & rmass(id1)*(l1_78(i7,i8)%d(1,1)*ug178_56(i5,i6)%c(1,2)+l1
     & _78(i7,i8)%b(1,2)*ug178_56(i5,i6)%d(2,2))
      ug1_5678(i5,i6,i7,i8)%a(2,1)=ug1_5678(i5,i6,i7,i8)%a(2,1)+
     & rmass(id1)*(l1_78(i7,i8)%c(2,1)*ug178_56(i5,i6)%a(1,1)+l1
     & _78(i7,i8)%a(2,2)*ug178_56(i5,i6)%b(2,1))
      ug1_5678(i5,i6,i7,i8)%b(2,1)=ug1_5678(i5,i6,i7,i8)%b(2,1)+
     & l1_78(i7,i8)%b(2,1)*ug178_56(i5,i6)%a(1,1)+l1_78(i7,i8)%d
     & (2,2)*p178q*ug178_56(i5,i6)%b(2,1)
      ug1_5678(i5,i6,i7,i8)%c(2,1)=ug1_5678(i5,i6,i7,i8)%c(2,1)+
     & l1_78(i7,i8)%c(2,1)*p178q*ug178_56(i5,i6)%d(1,1)+l1_78(i7
     & ,i8)%a(2,2)*ug178_56(i5,i6)%c(2,1)
      ug1_5678(i5,i6,i7,i8)%d(2,1)=ug1_5678(i5,i6,i7,i8)%d(2,1)+
     & rmass(id1)*(l1_78(i7,i8)%b(2,1)*ug178_56(i5,i6)%d(1,1)+l1
     & _78(i7,i8)%d(2,2)*ug178_56(i5,i6)%c(2,1))
      ug1_5678(i5,i6,i7,i8)%a(2,2)=ug1_5678(i5,i6,i7,i8)%a(2,2)+
     & l1_78(i7,i8)%c(2,1)*p178q*ug178_56(i5,i6)%b(1,2)+l1_78(i7
     & ,i8)%a(2,2)*ug178_56(i5,i6)%a(2,2)
      ug1_5678(i5,i6,i7,i8)%b(2,2)=ug1_5678(i5,i6,i7,i8)%b(2,2)+
     & rmass(id1)*(l1_78(i7,i8)%b(2,1)*ug178_56(i5,i6)%b(1,2)+l1
     & _78(i7,i8)%d(2,2)*ug178_56(i5,i6)%a(2,2))
      ug1_5678(i5,i6,i7,i8)%c(2,2)=ug1_5678(i5,i6,i7,i8)%c(2,2)+
     & rmass(id1)*(l1_78(i7,i8)%c(2,1)*ug178_56(i5,i6)%c(1,2)+l1
     & _78(i7,i8)%a(2,2)*ug178_56(i5,i6)%d(2,2))
      ug1_5678(i5,i6,i7,i8)%d(2,2)=ug1_5678(i5,i6,i7,i8)%d(2,2)+
     & l1_78(i7,i8)%b(2,1)*ug178_56(i5,i6)%c(1,2)+l1_78(i7,i8)%d
     & (2,2)*p178q*ug178_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=ug1_5678(i5,i6,i7,i8)%a,bb=ug1_5678(i5,i6,i7,i8)%b,cc=ug1_56
* 78(i5,i6,i7,i8)%c,dd=ug1_5678(i5,i6,i7,i8)%d,a1=lg1_56(i5,i6)%a,b1=lg1
* _56(i5,i6)%b,c1=lg1_56(i5,i6)%c,d1=lg1_56(i5,i6)%d,a2=u156_78(i7,i8)%a
* ,b2=u156_78(i7,i8)%b,c2=u156_78(i7,i8)%c,d2=u156_78(i7,i8)%d,prq=p156q
* ,m=rmass(id1),nsum=0
      do jut=1,2
      cx1=u156_78(i7,i8)%a(1,jut)+rmass(id1)*u156_78(i7,i8)%b(1,
     & jut)
      cx2=u156_78(i7,i8)%a(2,jut)+rmass(id1)*u156_78(i7,i8)%b(2,
     & jut)
      cy1=p156q*u156_78(i7,i8)%b(1,jut)+rmass(id1)*u156_78(i7,i8
     & )%a(1,jut)
      cy2=p156q*u156_78(i7,i8)%b(2,jut)+rmass(id1)*u156_78(i7,i8
     & )%a(2,jut)
      cw1=u156_78(i7,i8)%c(1,jut)+rmass(id1)*u156_78(i7,i8)%d(1,
     & jut)
      cw2=u156_78(i7,i8)%c(2,jut)+rmass(id1)*u156_78(i7,i8)%d(2,
     & jut)
      cz1=p156q*u156_78(i7,i8)%d(1,jut)+rmass(id1)*u156_78(i7,i8
     & )%c(1,jut)
      cz2=p156q*u156_78(i7,i8)%d(2,jut)+rmass(id1)*u156_78(i7,i8
     & )%c(2,jut)
      ug1_5678(i5,i6,i7,i8)%a(1,jut)=lg1_56(i5,i6)%a(1,1)*cx1+lg
     & 1_56(i5,i6)%c(1,2)*cy2
      ug1_5678(i5,i6,i7,i8)%b(1,jut)=lg1_56(i5,i6)%d(1,1)*cy1+lg
     & 1_56(i5,i6)%b(1,2)*cx2
      ug1_5678(i5,i6,i7,i8)%c(1,jut)=lg1_56(i5,i6)%a(1,1)*cw1+lg
     & 1_56(i5,i6)%c(1,2)*cz2
      ug1_5678(i5,i6,i7,i8)%d(1,jut)=lg1_56(i5,i6)%d(1,1)*cz1+lg
     & 1_56(i5,i6)%b(1,2)*cw2
      ug1_5678(i5,i6,i7,i8)%a(2,jut)=lg1_56(i5,i6)%c(2,1)*cy1+lg
     & 1_56(i5,i6)%a(2,2)*cx2
      ug1_5678(i5,i6,i7,i8)%b(2,jut)=lg1_56(i5,i6)%b(2,1)*cx1+lg
     & 1_56(i5,i6)%d(2,2)*cy2
      ug1_5678(i5,i6,i7,i8)%c(2,jut)=lg1_56(i5,i6)%c(2,1)*cz1+lg
     & 1_56(i5,i6)%a(2,2)*cw2
      ug1_5678(i5,i6,i7,i8)%d(2,jut)=lg1_56(i5,i6)%b(2,1)*cw1+lg
     & 1_56(i5,i6)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=ug1_5678(i5,i6,i7,i8)%a,bb=ug1_5678(i5,i6,i7,i8)%b,cc=ug1_56
* 78(i5,i6,i7,i8)%c,dd=ug1_5678(i5,i6,i7,i8)%d,a1=l1_78(i7,i8)%a,b1=l1_7
* 8(i7,i8)%b,c1=l1_78(i7,i8)%c,d1=l1_78(i7,i8)%d,a2=ug178_56(i5,i6)%a,b2
* =ug178_56(i5,i6)%b,c2=ug178_56(i5,i6)%c,d2=ug178_56(i5,i6)%d,prq=p178q
* ,m=rmass(id1),nsum=1
      do iut=1,2
      cx1=l1_78(i7,i8)%a(iut,1)+l1_78(i7,i8)%c(iut,1)*rmass(id1)
      cx2=l1_78(i7,i8)%c(iut,2)*p178q+l1_78(i7,i8)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_78(i7,i8)%b(iut,1)+l1_78(i7,i8)%d(iut,1)*rmass(id1)
      cy2=l1_78(i7,i8)%d(iut,2)*p178q+l1_78(i7,i8)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_78(i7,i8)%c(iut,1)*p178q+l1_78(i7,i8)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_78(i7,i8)%a(iut,2)+l1_78(i7,i8)%c(iut,2)*rmass(id1)
      cz1=l1_78(i7,i8)%d(iut,1)*p178q+l1_78(i7,i8)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_78(i7,i8)%b(iut,2)+l1_78(i7,i8)%d(iut,2)*rmass(id1)
      ug1_5678(i5,i6,i7,i8)%a(iut,1)=ug1_5678(i5,i6,i7,i8)%a(iut
     & ,1)+cx1*ug178_56(i5,i6)%a(1,1)+cx2*ug178_56(i5,i6)%b(2,1)
      ug1_5678(i5,i6,i7,i8)%b(iut,1)=ug1_5678(i5,i6,i7,i8)%b(iut
     & ,1)+cy1*ug178_56(i5,i6)%a(1,1)+cy2*ug178_56(i5,i6)%b(2,1)
      ug1_5678(i5,i6,i7,i8)%c(iut,1)=ug1_5678(i5,i6,i7,i8)%c(iut
     & ,1)+cw1*ug178_56(i5,i6)%d(1,1)+cw2*ug178_56(i5,i6)%c(2,1)
      ug1_5678(i5,i6,i7,i8)%d(iut,1)=ug1_5678(i5,i6,i7,i8)%d(iut
     & ,1)+cz1*ug178_56(i5,i6)%d(1,1)+cz2*ug178_56(i5,i6)%c(2,1)
      ug1_5678(i5,i6,i7,i8)%a(iut,2)=ug1_5678(i5,i6,i7,i8)%a(iut
     & ,2)+cw1*ug178_56(i5,i6)%b(1,2)+cw2*ug178_56(i5,i6)%a(2,2)
      ug1_5678(i5,i6,i7,i8)%b(iut,2)=ug1_5678(i5,i6,i7,i8)%b(iut
     & ,2)+cz1*ug178_56(i5,i6)%b(1,2)+cz2*ug178_56(i5,i6)%a(2,2)
      ug1_5678(i5,i6,i7,i8)%c(iut,2)=ug1_5678(i5,i6,i7,i8)%c(iut
     & ,2)+cx1*ug178_56(i5,i6)%c(1,2)+cx2*ug178_56(i5,i6)%d(2,2)
      ug1_5678(i5,i6,i7,i8)%d(iut,2)=ug1_5678(i5,i6,i7,i8)%d(iut
     & ,2)+cy1*ug178_56(i5,i6)%c(1,2)+cy2*ug178_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id1).ne.1 .and. ilept(id7).ne.1)then
        if(id1.ne.5 .or. id5.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=ug1_7856(i7,i8,i5,i6)%a,bb=ug1_7856(i7,i8,i5,i6)%b,cc=ug1_785
* 6(i7,i8,i5,i6)%c,dd=ug1_7856(i7,i8,i5,i6)%d,a1=lg1_78(i7,i8)%a,b1=lg1_
* 78(i7,i8)%b,c1=lg1_78(i7,i8)%c,d1=lg1_78(i7,i8)%d,a2=u178_56(i5,i6)%a,
* b2=u178_56(i5,i6)%b,c2=u178_56(i5,i6)%c,d2=u178_56(i5,i6)%d,prq=p178q,
* m=rmass(id1),nsum=0
      ug1_7856(i7,i8,i5,i6)%a(1,1)=lg1_78(i7,i8)%a(1,1)*u178_56(
     & i5,i6)%a(1,1)+lg1_78(i7,i8)%c(1,2)*p178q*u178_56(i5,i6)%b
     & (2,1)
      ug1_7856(i7,i8,i5,i6)%b(1,1)=rmass(id1)*(lg1_78(i7,i8)%d(1
     & ,1)*u178_56(i5,i6)%a(1,1)+lg1_78(i7,i8)%b(1,2)*u178_56(i5
     & ,i6)%b(2,1))
      ug1_7856(i7,i8,i5,i6)%c(1,1)=rmass(id1)*(lg1_78(i7,i8)%a(1
     & ,1)*u178_56(i5,i6)%d(1,1)+lg1_78(i7,i8)%c(1,2)*u178_56(i5
     & ,i6)%c(2,1))
      ug1_7856(i7,i8,i5,i6)%d(1,1)=lg1_78(i7,i8)%d(1,1)*p178q*u1
     & 78_56(i5,i6)%d(1,1)+lg1_78(i7,i8)%b(1,2)*u178_56(i5,i6)%c
     & (2,1)
      ug1_7856(i7,i8,i5,i6)%a(1,2)=rmass(id1)*(lg1_78(i7,i8)%a(1
     & ,1)*u178_56(i5,i6)%b(1,2)+lg1_78(i7,i8)%c(1,2)*u178_56(i5
     & ,i6)%a(2,2))
      ug1_7856(i7,i8,i5,i6)%b(1,2)=lg1_78(i7,i8)%d(1,1)*p178q*u1
     & 78_56(i5,i6)%b(1,2)+lg1_78(i7,i8)%b(1,2)*u178_56(i5,i6)%a
     & (2,2)
      ug1_7856(i7,i8,i5,i6)%c(1,2)=lg1_78(i7,i8)%a(1,1)*u178_56(
     & i5,i6)%c(1,2)+lg1_78(i7,i8)%c(1,2)*p178q*u178_56(i5,i6)%d
     & (2,2)
      ug1_7856(i7,i8,i5,i6)%d(1,2)=rmass(id1)*(lg1_78(i7,i8)%d(1
     & ,1)*u178_56(i5,i6)%c(1,2)+lg1_78(i7,i8)%b(1,2)*u178_56(i5
     & ,i6)%d(2,2))
      ug1_7856(i7,i8,i5,i6)%a(2,1)=rmass(id1)*(lg1_78(i7,i8)%c(2
     & ,1)*u178_56(i5,i6)%a(1,1)+lg1_78(i7,i8)%a(2,2)*u178_56(i5
     & ,i6)%b(2,1))
      ug1_7856(i7,i8,i5,i6)%b(2,1)=lg1_78(i7,i8)%b(2,1)*u178_56(
     & i5,i6)%a(1,1)+lg1_78(i7,i8)%d(2,2)*p178q*u178_56(i5,i6)%b
     & (2,1)
      ug1_7856(i7,i8,i5,i6)%c(2,1)=lg1_78(i7,i8)%c(2,1)*p178q*u1
     & 78_56(i5,i6)%d(1,1)+lg1_78(i7,i8)%a(2,2)*u178_56(i5,i6)%c
     & (2,1)
      ug1_7856(i7,i8,i5,i6)%d(2,1)=rmass(id1)*(lg1_78(i7,i8)%b(2
     & ,1)*u178_56(i5,i6)%d(1,1)+lg1_78(i7,i8)%d(2,2)*u178_56(i5
     & ,i6)%c(2,1))
      ug1_7856(i7,i8,i5,i6)%a(2,2)=lg1_78(i7,i8)%c(2,1)*p178q*u1
     & 78_56(i5,i6)%b(1,2)+lg1_78(i7,i8)%a(2,2)*u178_56(i5,i6)%a
     & (2,2)
      ug1_7856(i7,i8,i5,i6)%b(2,2)=rmass(id1)*(lg1_78(i7,i8)%b(2
     & ,1)*u178_56(i5,i6)%b(1,2)+lg1_78(i7,i8)%d(2,2)*u178_56(i5
     & ,i6)%a(2,2))
      ug1_7856(i7,i8,i5,i6)%c(2,2)=rmass(id1)*(lg1_78(i7,i8)%c(2
     & ,1)*u178_56(i5,i6)%c(1,2)+lg1_78(i7,i8)%a(2,2)*u178_56(i5
     & ,i6)%d(2,2))
      ug1_7856(i7,i8,i5,i6)%d(2,2)=lg1_78(i7,i8)%b(2,1)*u178_56(
     & i5,i6)%c(1,2)+lg1_78(i7,i8)%d(2,2)*p178q*u178_56(i5,i6)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=ug1_7856(i7,i8,i5,i6)%a,bb=ug1_7856(i7,i8,i5,i6)%b,cc=ug1_785
* 6(i7,i8,i5,i6)%c,dd=ug1_7856(i7,i8,i5,i6)%d,a1=l1_56(i5,i6)%a,b1=l1_56
* (i5,i6)%b,c1=l1_56(i5,i6)%c,d1=l1_56(i5,i6)%d,a2=ug156_78(i7,i8)%a,b2=
* ug156_78(i7,i8)%b,c2=ug156_78(i7,i8)%c,d2=ug156_78(i7,i8)%d,prq=p156q,
* m=rmass(id1),nsum=1
      ug1_7856(i7,i8,i5,i6)%a(1,1)=ug1_7856(i7,i8,i5,i6)%a(1,1)+
     & l1_56(i5,i6)%a(1,1)*ug156_78(i7,i8)%a(1,1)+l1_56(i5,i6)%c
     & (1,2)*p156q*ug156_78(i7,i8)%b(2,1)
      ug1_7856(i7,i8,i5,i6)%b(1,1)=ug1_7856(i7,i8,i5,i6)%b(1,1)+
     & rmass(id1)*(l1_56(i5,i6)%d(1,1)*ug156_78(i7,i8)%a(1,1)+l1
     & _56(i5,i6)%b(1,2)*ug156_78(i7,i8)%b(2,1))
      ug1_7856(i7,i8,i5,i6)%c(1,1)=ug1_7856(i7,i8,i5,i6)%c(1,1)+
     & rmass(id1)*(l1_56(i5,i6)%a(1,1)*ug156_78(i7,i8)%d(1,1)+l1
     & _56(i5,i6)%c(1,2)*ug156_78(i7,i8)%c(2,1))
      ug1_7856(i7,i8,i5,i6)%d(1,1)=ug1_7856(i7,i8,i5,i6)%d(1,1)+
     & l1_56(i5,i6)%d(1,1)*p156q*ug156_78(i7,i8)%d(1,1)+l1_56(i5
     & ,i6)%b(1,2)*ug156_78(i7,i8)%c(2,1)
      ug1_7856(i7,i8,i5,i6)%a(1,2)=ug1_7856(i7,i8,i5,i6)%a(1,2)+
     & rmass(id1)*(l1_56(i5,i6)%a(1,1)*ug156_78(i7,i8)%b(1,2)+l1
     & _56(i5,i6)%c(1,2)*ug156_78(i7,i8)%a(2,2))
      ug1_7856(i7,i8,i5,i6)%b(1,2)=ug1_7856(i7,i8,i5,i6)%b(1,2)+
     & l1_56(i5,i6)%d(1,1)*p156q*ug156_78(i7,i8)%b(1,2)+l1_56(i5
     & ,i6)%b(1,2)*ug156_78(i7,i8)%a(2,2)
      ug1_7856(i7,i8,i5,i6)%c(1,2)=ug1_7856(i7,i8,i5,i6)%c(1,2)+
     & l1_56(i5,i6)%a(1,1)*ug156_78(i7,i8)%c(1,2)+l1_56(i5,i6)%c
     & (1,2)*p156q*ug156_78(i7,i8)%d(2,2)
      ug1_7856(i7,i8,i5,i6)%d(1,2)=ug1_7856(i7,i8,i5,i6)%d(1,2)+
     & rmass(id1)*(l1_56(i5,i6)%d(1,1)*ug156_78(i7,i8)%c(1,2)+l1
     & _56(i5,i6)%b(1,2)*ug156_78(i7,i8)%d(2,2))
      ug1_7856(i7,i8,i5,i6)%a(2,1)=ug1_7856(i7,i8,i5,i6)%a(2,1)+
     & rmass(id1)*(l1_56(i5,i6)%c(2,1)*ug156_78(i7,i8)%a(1,1)+l1
     & _56(i5,i6)%a(2,2)*ug156_78(i7,i8)%b(2,1))
      ug1_7856(i7,i8,i5,i6)%b(2,1)=ug1_7856(i7,i8,i5,i6)%b(2,1)+
     & l1_56(i5,i6)%b(2,1)*ug156_78(i7,i8)%a(1,1)+l1_56(i5,i6)%d
     & (2,2)*p156q*ug156_78(i7,i8)%b(2,1)
      ug1_7856(i7,i8,i5,i6)%c(2,1)=ug1_7856(i7,i8,i5,i6)%c(2,1)+
     & l1_56(i5,i6)%c(2,1)*p156q*ug156_78(i7,i8)%d(1,1)+l1_56(i5
     & ,i6)%a(2,2)*ug156_78(i7,i8)%c(2,1)
      ug1_7856(i7,i8,i5,i6)%d(2,1)=ug1_7856(i7,i8,i5,i6)%d(2,1)+
     & rmass(id1)*(l1_56(i5,i6)%b(2,1)*ug156_78(i7,i8)%d(1,1)+l1
     & _56(i5,i6)%d(2,2)*ug156_78(i7,i8)%c(2,1))
      ug1_7856(i7,i8,i5,i6)%a(2,2)=ug1_7856(i7,i8,i5,i6)%a(2,2)+
     & l1_56(i5,i6)%c(2,1)*p156q*ug156_78(i7,i8)%b(1,2)+l1_56(i5
     & ,i6)%a(2,2)*ug156_78(i7,i8)%a(2,2)
      ug1_7856(i7,i8,i5,i6)%b(2,2)=ug1_7856(i7,i8,i5,i6)%b(2,2)+
     & rmass(id1)*(l1_56(i5,i6)%b(2,1)*ug156_78(i7,i8)%b(1,2)+l1
     & _56(i5,i6)%d(2,2)*ug156_78(i7,i8)%a(2,2))
      ug1_7856(i7,i8,i5,i6)%c(2,2)=ug1_7856(i7,i8,i5,i6)%c(2,2)+
     & rmass(id1)*(l1_56(i5,i6)%c(2,1)*ug156_78(i7,i8)%c(1,2)+l1
     & _56(i5,i6)%a(2,2)*ug156_78(i7,i8)%d(2,2))
      ug1_7856(i7,i8,i5,i6)%d(2,2)=ug1_7856(i7,i8,i5,i6)%d(2,2)+
     & l1_56(i5,i6)%b(2,1)*ug156_78(i7,i8)%c(1,2)+l1_56(i5,i6)%d
     & (2,2)*p156q*ug156_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TTs -- aa=ug1_7856(i7,i8,i5,i6)%a,bb=ug1_7856(i7,i8,i5,i6)%b,cc=ug1_78
* 56(i7,i8,i5,i6)%c,dd=ug1_7856(i7,i8,i5,i6)%d,a1=lg1_78(i7,i8)%a,b1=lg1
* _78(i7,i8)%b,c1=lg1_78(i7,i8)%c,d1=lg1_78(i7,i8)%d,a2=u178_56(i5,i6)%a
* ,b2=u178_56(i5,i6)%b,c2=u178_56(i5,i6)%c,d2=u178_56(i5,i6)%d,prq=p178q
* ,m=rmass(id1),nsum=0
      do jut=1,2
      cx1=u178_56(i5,i6)%a(1,jut)+rmass(id1)*u178_56(i5,i6)%b(1,
     & jut)
      cx2=u178_56(i5,i6)%a(2,jut)+rmass(id1)*u178_56(i5,i6)%b(2,
     & jut)
      cy1=p178q*u178_56(i5,i6)%b(1,jut)+rmass(id1)*u178_56(i5,i6
     & )%a(1,jut)
      cy2=p178q*u178_56(i5,i6)%b(2,jut)+rmass(id1)*u178_56(i5,i6
     & )%a(2,jut)
      cw1=u178_56(i5,i6)%c(1,jut)+rmass(id1)*u178_56(i5,i6)%d(1,
     & jut)
      cw2=u178_56(i5,i6)%c(2,jut)+rmass(id1)*u178_56(i5,i6)%d(2,
     & jut)
      cz1=p178q*u178_56(i5,i6)%d(1,jut)+rmass(id1)*u178_56(i5,i6
     & )%c(1,jut)
      cz2=p178q*u178_56(i5,i6)%d(2,jut)+rmass(id1)*u178_56(i5,i6
     & )%c(2,jut)
      ug1_7856(i7,i8,i5,i6)%a(1,jut)=lg1_78(i7,i8)%a(1,1)*cx1+lg
     & 1_78(i7,i8)%c(1,2)*cy2
      ug1_7856(i7,i8,i5,i6)%b(1,jut)=lg1_78(i7,i8)%d(1,1)*cy1+lg
     & 1_78(i7,i8)%b(1,2)*cx2
      ug1_7856(i7,i8,i5,i6)%c(1,jut)=lg1_78(i7,i8)%a(1,1)*cw1+lg
     & 1_78(i7,i8)%c(1,2)*cz2
      ug1_7856(i7,i8,i5,i6)%d(1,jut)=lg1_78(i7,i8)%d(1,1)*cz1+lg
     & 1_78(i7,i8)%b(1,2)*cw2
      ug1_7856(i7,i8,i5,i6)%a(2,jut)=lg1_78(i7,i8)%c(2,1)*cy1+lg
     & 1_78(i7,i8)%a(2,2)*cx2
      ug1_7856(i7,i8,i5,i6)%b(2,jut)=lg1_78(i7,i8)%b(2,1)*cx1+lg
     & 1_78(i7,i8)%d(2,2)*cy2
      ug1_7856(i7,i8,i5,i6)%c(2,jut)=lg1_78(i7,i8)%c(2,1)*cz1+lg
     & 1_78(i7,i8)%a(2,2)*cw2
      ug1_7856(i7,i8,i5,i6)%d(2,jut)=lg1_78(i7,i8)%b(2,1)*cw1+lg
     & 1_78(i7,i8)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=ug1_7856(i7,i8,i5,i6)%a,bb=ug1_7856(i7,i8,i5,i6)%b,cc=ug1_78
* 56(i7,i8,i5,i6)%c,dd=ug1_7856(i7,i8,i5,i6)%d,a1=l1_56(i5,i6)%a,b1=l1_5
* 6(i5,i6)%b,c1=l1_56(i5,i6)%c,d1=l1_56(i5,i6)%d,a2=ug156_78(i7,i8)%a,b2
* =ug156_78(i7,i8)%b,c2=ug156_78(i7,i8)%c,d2=ug156_78(i7,i8)%d,prq=p156q
* ,m=rmass(id1),nsum=1
      do iut=1,2
      cx1=l1_56(i5,i6)%a(iut,1)+l1_56(i5,i6)%c(iut,1)*rmass(id1)
      cx2=l1_56(i5,i6)%c(iut,2)*p156q+l1_56(i5,i6)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_56(i5,i6)%b(iut,1)+l1_56(i5,i6)%d(iut,1)*rmass(id1)
      cy2=l1_56(i5,i6)%d(iut,2)*p156q+l1_56(i5,i6)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_56(i5,i6)%c(iut,1)*p156q+l1_56(i5,i6)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_56(i5,i6)%a(iut,2)+l1_56(i5,i6)%c(iut,2)*rmass(id1)
      cz1=l1_56(i5,i6)%d(iut,1)*p156q+l1_56(i5,i6)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_56(i5,i6)%b(iut,2)+l1_56(i5,i6)%d(iut,2)*rmass(id1)
      ug1_7856(i7,i8,i5,i6)%a(iut,1)=ug1_7856(i7,i8,i5,i6)%a(iut
     & ,1)+cx1*ug156_78(i7,i8)%a(1,1)+cx2*ug156_78(i7,i8)%b(2,1)
      ug1_7856(i7,i8,i5,i6)%b(iut,1)=ug1_7856(i7,i8,i5,i6)%b(iut
     & ,1)+cy1*ug156_78(i7,i8)%a(1,1)+cy2*ug156_78(i7,i8)%b(2,1)
      ug1_7856(i7,i8,i5,i6)%c(iut,1)=ug1_7856(i7,i8,i5,i6)%c(iut
     & ,1)+cw1*ug156_78(i7,i8)%d(1,1)+cw2*ug156_78(i7,i8)%c(2,1)
      ug1_7856(i7,i8,i5,i6)%d(iut,1)=ug1_7856(i7,i8,i5,i6)%d(iut
     & ,1)+cz1*ug156_78(i7,i8)%d(1,1)+cz2*ug156_78(i7,i8)%c(2,1)
      ug1_7856(i7,i8,i5,i6)%a(iut,2)=ug1_7856(i7,i8,i5,i6)%a(iut
     & ,2)+cw1*ug156_78(i7,i8)%b(1,2)+cw2*ug156_78(i7,i8)%a(2,2)
      ug1_7856(i7,i8,i5,i6)%b(iut,2)=ug1_7856(i7,i8,i5,i6)%b(iut
     & ,2)+cz1*ug156_78(i7,i8)%b(1,2)+cz2*ug156_78(i7,i8)%a(2,2)
      ug1_7856(i7,i8,i5,i6)%c(iut,2)=ug1_7856(i7,i8,i5,i6)%c(iut
     & ,2)+cx1*ug156_78(i7,i8)%c(1,2)+cx2*ug156_78(i7,i8)%d(2,2)
      ug1_7856(i7,i8,i5,i6)%d(iut,2)=ug1_7856(i7,i8,i5,i6)%d(iut
     & ,2)+cy1*ug156_78(i7,i8)%c(1,2)+cy2*ug156_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id3).ne.1 .and. ilept(id1).ne.1)then
        if(id3.ne.5 .or. id5.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=ug3_1256(i1,i2,i5,i6)%a,bb=ug3_1256(i1,i2,i5,i6)%b,cc=ug3_125
* 6(i1,i2,i5,i6)%c,dd=ug3_1256(i1,i2,i5,i6)%d,a1=lg3_12(i1,i2)%a,b1=lg3_
* 12(i1,i2)%b,c1=lg3_12(i1,i2)%c,d1=lg3_12(i1,i2)%d,a2=u312_56(i5,i6)%a,
* b2=u312_56(i5,i6)%b,c2=u312_56(i5,i6)%c,d2=u312_56(i5,i6)%d,prq=p312q,
* m=rmass(id3),nsum=0
      ug3_1256(i1,i2,i5,i6)%a(1,1)=lg3_12(i1,i2)%a(1,1)*u312_56(
     & i5,i6)%a(1,1)+lg3_12(i1,i2)%c(1,2)*p312q*u312_56(i5,i6)%b
     & (2,1)
      ug3_1256(i1,i2,i5,i6)%b(1,1)=rmass(id3)*(lg3_12(i1,i2)%d(1
     & ,1)*u312_56(i5,i6)%a(1,1)+lg3_12(i1,i2)%b(1,2)*u312_56(i5
     & ,i6)%b(2,1))
      ug3_1256(i1,i2,i5,i6)%c(1,1)=rmass(id3)*(lg3_12(i1,i2)%a(1
     & ,1)*u312_56(i5,i6)%d(1,1)+lg3_12(i1,i2)%c(1,2)*u312_56(i5
     & ,i6)%c(2,1))
      ug3_1256(i1,i2,i5,i6)%d(1,1)=lg3_12(i1,i2)%d(1,1)*p312q*u3
     & 12_56(i5,i6)%d(1,1)+lg3_12(i1,i2)%b(1,2)*u312_56(i5,i6)%c
     & (2,1)
      ug3_1256(i1,i2,i5,i6)%a(1,2)=rmass(id3)*(lg3_12(i1,i2)%a(1
     & ,1)*u312_56(i5,i6)%b(1,2)+lg3_12(i1,i2)%c(1,2)*u312_56(i5
     & ,i6)%a(2,2))
      ug3_1256(i1,i2,i5,i6)%b(1,2)=lg3_12(i1,i2)%d(1,1)*p312q*u3
     & 12_56(i5,i6)%b(1,2)+lg3_12(i1,i2)%b(1,2)*u312_56(i5,i6)%a
     & (2,2)
      ug3_1256(i1,i2,i5,i6)%c(1,2)=lg3_12(i1,i2)%a(1,1)*u312_56(
     & i5,i6)%c(1,2)+lg3_12(i1,i2)%c(1,2)*p312q*u312_56(i5,i6)%d
     & (2,2)
      ug3_1256(i1,i2,i5,i6)%d(1,2)=rmass(id3)*(lg3_12(i1,i2)%d(1
     & ,1)*u312_56(i5,i6)%c(1,2)+lg3_12(i1,i2)%b(1,2)*u312_56(i5
     & ,i6)%d(2,2))
      ug3_1256(i1,i2,i5,i6)%a(2,1)=rmass(id3)*(lg3_12(i1,i2)%c(2
     & ,1)*u312_56(i5,i6)%a(1,1)+lg3_12(i1,i2)%a(2,2)*u312_56(i5
     & ,i6)%b(2,1))
      ug3_1256(i1,i2,i5,i6)%b(2,1)=lg3_12(i1,i2)%b(2,1)*u312_56(
     & i5,i6)%a(1,1)+lg3_12(i1,i2)%d(2,2)*p312q*u312_56(i5,i6)%b
     & (2,1)
      ug3_1256(i1,i2,i5,i6)%c(2,1)=lg3_12(i1,i2)%c(2,1)*p312q*u3
     & 12_56(i5,i6)%d(1,1)+lg3_12(i1,i2)%a(2,2)*u312_56(i5,i6)%c
     & (2,1)
      ug3_1256(i1,i2,i5,i6)%d(2,1)=rmass(id3)*(lg3_12(i1,i2)%b(2
     & ,1)*u312_56(i5,i6)%d(1,1)+lg3_12(i1,i2)%d(2,2)*u312_56(i5
     & ,i6)%c(2,1))
      ug3_1256(i1,i2,i5,i6)%a(2,2)=lg3_12(i1,i2)%c(2,1)*p312q*u3
     & 12_56(i5,i6)%b(1,2)+lg3_12(i1,i2)%a(2,2)*u312_56(i5,i6)%a
     & (2,2)
      ug3_1256(i1,i2,i5,i6)%b(2,2)=rmass(id3)*(lg3_12(i1,i2)%b(2
     & ,1)*u312_56(i5,i6)%b(1,2)+lg3_12(i1,i2)%d(2,2)*u312_56(i5
     & ,i6)%a(2,2))
      ug3_1256(i1,i2,i5,i6)%c(2,2)=rmass(id3)*(lg3_12(i1,i2)%c(2
     & ,1)*u312_56(i5,i6)%c(1,2)+lg3_12(i1,i2)%a(2,2)*u312_56(i5
     & ,i6)%d(2,2))
      ug3_1256(i1,i2,i5,i6)%d(2,2)=lg3_12(i1,i2)%b(2,1)*u312_56(
     & i5,i6)%c(1,2)+lg3_12(i1,i2)%d(2,2)*p312q*u312_56(i5,i6)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=ug3_1256(i1,i2,i5,i6)%a,bb=ug3_1256(i1,i2,i5,i6)%b,cc=ug3_125
* 6(i1,i2,i5,i6)%c,dd=ug3_1256(i1,i2,i5,i6)%d,a1=l3_56(i5,i6)%a,b1=l3_56
* (i5,i6)%b,c1=l3_56(i5,i6)%c,d1=l3_56(i5,i6)%d,a2=ug356_12(i1,i2)%a,b2=
* ug356_12(i1,i2)%b,c2=ug356_12(i1,i2)%c,d2=ug356_12(i1,i2)%d,prq=p356q,
* m=rmass(id3),nsum=1
      ug3_1256(i1,i2,i5,i6)%a(1,1)=ug3_1256(i1,i2,i5,i6)%a(1,1)+
     & l3_56(i5,i6)%a(1,1)*ug356_12(i1,i2)%a(1,1)+l3_56(i5,i6)%c
     & (1,2)*p356q*ug356_12(i1,i2)%b(2,1)
      ug3_1256(i1,i2,i5,i6)%b(1,1)=ug3_1256(i1,i2,i5,i6)%b(1,1)+
     & rmass(id3)*(l3_56(i5,i6)%d(1,1)*ug356_12(i1,i2)%a(1,1)+l3
     & _56(i5,i6)%b(1,2)*ug356_12(i1,i2)%b(2,1))
      ug3_1256(i1,i2,i5,i6)%c(1,1)=ug3_1256(i1,i2,i5,i6)%c(1,1)+
     & rmass(id3)*(l3_56(i5,i6)%a(1,1)*ug356_12(i1,i2)%d(1,1)+l3
     & _56(i5,i6)%c(1,2)*ug356_12(i1,i2)%c(2,1))
      ug3_1256(i1,i2,i5,i6)%d(1,1)=ug3_1256(i1,i2,i5,i6)%d(1,1)+
     & l3_56(i5,i6)%d(1,1)*p356q*ug356_12(i1,i2)%d(1,1)+l3_56(i5
     & ,i6)%b(1,2)*ug356_12(i1,i2)%c(2,1)
      ug3_1256(i1,i2,i5,i6)%a(1,2)=ug3_1256(i1,i2,i5,i6)%a(1,2)+
     & rmass(id3)*(l3_56(i5,i6)%a(1,1)*ug356_12(i1,i2)%b(1,2)+l3
     & _56(i5,i6)%c(1,2)*ug356_12(i1,i2)%a(2,2))
      ug3_1256(i1,i2,i5,i6)%b(1,2)=ug3_1256(i1,i2,i5,i6)%b(1,2)+
     & l3_56(i5,i6)%d(1,1)*p356q*ug356_12(i1,i2)%b(1,2)+l3_56(i5
     & ,i6)%b(1,2)*ug356_12(i1,i2)%a(2,2)
      ug3_1256(i1,i2,i5,i6)%c(1,2)=ug3_1256(i1,i2,i5,i6)%c(1,2)+
     & l3_56(i5,i6)%a(1,1)*ug356_12(i1,i2)%c(1,2)+l3_56(i5,i6)%c
     & (1,2)*p356q*ug356_12(i1,i2)%d(2,2)
      ug3_1256(i1,i2,i5,i6)%d(1,2)=ug3_1256(i1,i2,i5,i6)%d(1,2)+
     & rmass(id3)*(l3_56(i5,i6)%d(1,1)*ug356_12(i1,i2)%c(1,2)+l3
     & _56(i5,i6)%b(1,2)*ug356_12(i1,i2)%d(2,2))
      ug3_1256(i1,i2,i5,i6)%a(2,1)=ug3_1256(i1,i2,i5,i6)%a(2,1)+
     & rmass(id3)*(l3_56(i5,i6)%c(2,1)*ug356_12(i1,i2)%a(1,1)+l3
     & _56(i5,i6)%a(2,2)*ug356_12(i1,i2)%b(2,1))
      ug3_1256(i1,i2,i5,i6)%b(2,1)=ug3_1256(i1,i2,i5,i6)%b(2,1)+
     & l3_56(i5,i6)%b(2,1)*ug356_12(i1,i2)%a(1,1)+l3_56(i5,i6)%d
     & (2,2)*p356q*ug356_12(i1,i2)%b(2,1)
      ug3_1256(i1,i2,i5,i6)%c(2,1)=ug3_1256(i1,i2,i5,i6)%c(2,1)+
     & l3_56(i5,i6)%c(2,1)*p356q*ug356_12(i1,i2)%d(1,1)+l3_56(i5
     & ,i6)%a(2,2)*ug356_12(i1,i2)%c(2,1)
      ug3_1256(i1,i2,i5,i6)%d(2,1)=ug3_1256(i1,i2,i5,i6)%d(2,1)+
     & rmass(id3)*(l3_56(i5,i6)%b(2,1)*ug356_12(i1,i2)%d(1,1)+l3
     & _56(i5,i6)%d(2,2)*ug356_12(i1,i2)%c(2,1))
      ug3_1256(i1,i2,i5,i6)%a(2,2)=ug3_1256(i1,i2,i5,i6)%a(2,2)+
     & l3_56(i5,i6)%c(2,1)*p356q*ug356_12(i1,i2)%b(1,2)+l3_56(i5
     & ,i6)%a(2,2)*ug356_12(i1,i2)%a(2,2)
      ug3_1256(i1,i2,i5,i6)%b(2,2)=ug3_1256(i1,i2,i5,i6)%b(2,2)+
     & rmass(id3)*(l3_56(i5,i6)%b(2,1)*ug356_12(i1,i2)%b(1,2)+l3
     & _56(i5,i6)%d(2,2)*ug356_12(i1,i2)%a(2,2))
      ug3_1256(i1,i2,i5,i6)%c(2,2)=ug3_1256(i1,i2,i5,i6)%c(2,2)+
     & rmass(id3)*(l3_56(i5,i6)%c(2,1)*ug356_12(i1,i2)%c(1,2)+l3
     & _56(i5,i6)%a(2,2)*ug356_12(i1,i2)%d(2,2))
      ug3_1256(i1,i2,i5,i6)%d(2,2)=ug3_1256(i1,i2,i5,i6)%d(2,2)+
     & l3_56(i5,i6)%b(2,1)*ug356_12(i1,i2)%c(1,2)+l3_56(i5,i6)%d
     & (2,2)*p356q*ug356_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TTs -- aa=ug3_1256(i1,i2,i5,i6)%a,bb=ug3_1256(i1,i2,i5,i6)%b,cc=ug3_12
* 56(i1,i2,i5,i6)%c,dd=ug3_1256(i1,i2,i5,i6)%d,a1=lg3_12(i1,i2)%a,b1=lg3
* _12(i1,i2)%b,c1=lg3_12(i1,i2)%c,d1=lg3_12(i1,i2)%d,a2=u312_56(i5,i6)%a
* ,b2=u312_56(i5,i6)%b,c2=u312_56(i5,i6)%c,d2=u312_56(i5,i6)%d,prq=p312q
* ,m=rmass(id3),nsum=0
      do jut=1,2
      cx1=u312_56(i5,i6)%a(1,jut)+rmass(id3)*u312_56(i5,i6)%b(1,
     & jut)
      cx2=u312_56(i5,i6)%a(2,jut)+rmass(id3)*u312_56(i5,i6)%b(2,
     & jut)
      cy1=p312q*u312_56(i5,i6)%b(1,jut)+rmass(id3)*u312_56(i5,i6
     & )%a(1,jut)
      cy2=p312q*u312_56(i5,i6)%b(2,jut)+rmass(id3)*u312_56(i5,i6
     & )%a(2,jut)
      cw1=u312_56(i5,i6)%c(1,jut)+rmass(id3)*u312_56(i5,i6)%d(1,
     & jut)
      cw2=u312_56(i5,i6)%c(2,jut)+rmass(id3)*u312_56(i5,i6)%d(2,
     & jut)
      cz1=p312q*u312_56(i5,i6)%d(1,jut)+rmass(id3)*u312_56(i5,i6
     & )%c(1,jut)
      cz2=p312q*u312_56(i5,i6)%d(2,jut)+rmass(id3)*u312_56(i5,i6
     & )%c(2,jut)
      ug3_1256(i1,i2,i5,i6)%a(1,jut)=lg3_12(i1,i2)%a(1,1)*cx1+lg
     & 3_12(i1,i2)%c(1,2)*cy2
      ug3_1256(i1,i2,i5,i6)%b(1,jut)=lg3_12(i1,i2)%d(1,1)*cy1+lg
     & 3_12(i1,i2)%b(1,2)*cx2
      ug3_1256(i1,i2,i5,i6)%c(1,jut)=lg3_12(i1,i2)%a(1,1)*cw1+lg
     & 3_12(i1,i2)%c(1,2)*cz2
      ug3_1256(i1,i2,i5,i6)%d(1,jut)=lg3_12(i1,i2)%d(1,1)*cz1+lg
     & 3_12(i1,i2)%b(1,2)*cw2
      ug3_1256(i1,i2,i5,i6)%a(2,jut)=lg3_12(i1,i2)%c(2,1)*cy1+lg
     & 3_12(i1,i2)%a(2,2)*cx2
      ug3_1256(i1,i2,i5,i6)%b(2,jut)=lg3_12(i1,i2)%b(2,1)*cx1+lg
     & 3_12(i1,i2)%d(2,2)*cy2
      ug3_1256(i1,i2,i5,i6)%c(2,jut)=lg3_12(i1,i2)%c(2,1)*cz1+lg
     & 3_12(i1,i2)%a(2,2)*cw2
      ug3_1256(i1,i2,i5,i6)%d(2,jut)=lg3_12(i1,i2)%b(2,1)*cw1+lg
     & 3_12(i1,i2)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=ug3_1256(i1,i2,i5,i6)%a,bb=ug3_1256(i1,i2,i5,i6)%b,cc=ug3_12
* 56(i1,i2,i5,i6)%c,dd=ug3_1256(i1,i2,i5,i6)%d,a1=l3_56(i5,i6)%a,b1=l3_5
* 6(i5,i6)%b,c1=l3_56(i5,i6)%c,d1=l3_56(i5,i6)%d,a2=ug356_12(i1,i2)%a,b2
* =ug356_12(i1,i2)%b,c2=ug356_12(i1,i2)%c,d2=ug356_12(i1,i2)%d,prq=p356q
* ,m=rmass(id3),nsum=1
      do iut=1,2
      cx1=l3_56(i5,i6)%a(iut,1)+l3_56(i5,i6)%c(iut,1)*rmass(id3)
      cx2=l3_56(i5,i6)%c(iut,2)*p356q+l3_56(i5,i6)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_56(i5,i6)%b(iut,1)+l3_56(i5,i6)%d(iut,1)*rmass(id3)
      cy2=l3_56(i5,i6)%d(iut,2)*p356q+l3_56(i5,i6)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_56(i5,i6)%c(iut,1)*p356q+l3_56(i5,i6)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_56(i5,i6)%a(iut,2)+l3_56(i5,i6)%c(iut,2)*rmass(id3)
      cz1=l3_56(i5,i6)%d(iut,1)*p356q+l3_56(i5,i6)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_56(i5,i6)%b(iut,2)+l3_56(i5,i6)%d(iut,2)*rmass(id3)
      ug3_1256(i1,i2,i5,i6)%a(iut,1)=ug3_1256(i1,i2,i5,i6)%a(iut
     & ,1)+cx1*ug356_12(i1,i2)%a(1,1)+cx2*ug356_12(i1,i2)%b(2,1)
      ug3_1256(i1,i2,i5,i6)%b(iut,1)=ug3_1256(i1,i2,i5,i6)%b(iut
     & ,1)+cy1*ug356_12(i1,i2)%a(1,1)+cy2*ug356_12(i1,i2)%b(2,1)
      ug3_1256(i1,i2,i5,i6)%c(iut,1)=ug3_1256(i1,i2,i5,i6)%c(iut
     & ,1)+cw1*ug356_12(i1,i2)%d(1,1)+cw2*ug356_12(i1,i2)%c(2,1)
      ug3_1256(i1,i2,i5,i6)%d(iut,1)=ug3_1256(i1,i2,i5,i6)%d(iut
     & ,1)+cz1*ug356_12(i1,i2)%d(1,1)+cz2*ug356_12(i1,i2)%c(2,1)
      ug3_1256(i1,i2,i5,i6)%a(iut,2)=ug3_1256(i1,i2,i5,i6)%a(iut
     & ,2)+cw1*ug356_12(i1,i2)%b(1,2)+cw2*ug356_12(i1,i2)%a(2,2)
      ug3_1256(i1,i2,i5,i6)%b(iut,2)=ug3_1256(i1,i2,i5,i6)%b(iut
     & ,2)+cz1*ug356_12(i1,i2)%b(1,2)+cz2*ug356_12(i1,i2)%a(2,2)
      ug3_1256(i1,i2,i5,i6)%c(iut,2)=ug3_1256(i1,i2,i5,i6)%c(iut
     & ,2)+cx1*ug356_12(i1,i2)%c(1,2)+cx2*ug356_12(i1,i2)%d(2,2)
      ug3_1256(i1,i2,i5,i6)%d(iut,2)=ug3_1256(i1,i2,i5,i6)%d(iut
     & ,2)+cy1*ug356_12(i1,i2)%c(1,2)+cy2*ug356_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id3).ne.1 .and. ilept(id5).ne.1)then
        if(id3.ne.5 .or. id1.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* TT -- aa=ug3_5612(i5,i6,i1,i2)%a,bb=ug3_5612(i5,i6,i1,i2)%b,cc=ug3_561
* 2(i5,i6,i1,i2)%c,dd=ug3_5612(i5,i6,i1,i2)%d,a1=lg3_56(i5,i6)%a,b1=lg3_
* 56(i5,i6)%b,c1=lg3_56(i5,i6)%c,d1=lg3_56(i5,i6)%d,a2=u356_12(i1,i2)%a,
* b2=u356_12(i1,i2)%b,c2=u356_12(i1,i2)%c,d2=u356_12(i1,i2)%d,prq=p356q,
* m=rmass(id3),nsum=0
      ug3_5612(i5,i6,i1,i2)%a(1,1)=lg3_56(i5,i6)%a(1,1)*u356_12(
     & i1,i2)%a(1,1)+lg3_56(i5,i6)%c(1,2)*p356q*u356_12(i1,i2)%b
     & (2,1)
      ug3_5612(i5,i6,i1,i2)%b(1,1)=rmass(id3)*(lg3_56(i5,i6)%d(1
     & ,1)*u356_12(i1,i2)%a(1,1)+lg3_56(i5,i6)%b(1,2)*u356_12(i1
     & ,i2)%b(2,1))
      ug3_5612(i5,i6,i1,i2)%c(1,1)=rmass(id3)*(lg3_56(i5,i6)%a(1
     & ,1)*u356_12(i1,i2)%d(1,1)+lg3_56(i5,i6)%c(1,2)*u356_12(i1
     & ,i2)%c(2,1))
      ug3_5612(i5,i6,i1,i2)%d(1,1)=lg3_56(i5,i6)%d(1,1)*p356q*u3
     & 56_12(i1,i2)%d(1,1)+lg3_56(i5,i6)%b(1,2)*u356_12(i1,i2)%c
     & (2,1)
      ug3_5612(i5,i6,i1,i2)%a(1,2)=rmass(id3)*(lg3_56(i5,i6)%a(1
     & ,1)*u356_12(i1,i2)%b(1,2)+lg3_56(i5,i6)%c(1,2)*u356_12(i1
     & ,i2)%a(2,2))
      ug3_5612(i5,i6,i1,i2)%b(1,2)=lg3_56(i5,i6)%d(1,1)*p356q*u3
     & 56_12(i1,i2)%b(1,2)+lg3_56(i5,i6)%b(1,2)*u356_12(i1,i2)%a
     & (2,2)
      ug3_5612(i5,i6,i1,i2)%c(1,2)=lg3_56(i5,i6)%a(1,1)*u356_12(
     & i1,i2)%c(1,2)+lg3_56(i5,i6)%c(1,2)*p356q*u356_12(i1,i2)%d
     & (2,2)
      ug3_5612(i5,i6,i1,i2)%d(1,2)=rmass(id3)*(lg3_56(i5,i6)%d(1
     & ,1)*u356_12(i1,i2)%c(1,2)+lg3_56(i5,i6)%b(1,2)*u356_12(i1
     & ,i2)%d(2,2))
      ug3_5612(i5,i6,i1,i2)%a(2,1)=rmass(id3)*(lg3_56(i5,i6)%c(2
     & ,1)*u356_12(i1,i2)%a(1,1)+lg3_56(i5,i6)%a(2,2)*u356_12(i1
     & ,i2)%b(2,1))
      ug3_5612(i5,i6,i1,i2)%b(2,1)=lg3_56(i5,i6)%b(2,1)*u356_12(
     & i1,i2)%a(1,1)+lg3_56(i5,i6)%d(2,2)*p356q*u356_12(i1,i2)%b
     & (2,1)
      ug3_5612(i5,i6,i1,i2)%c(2,1)=lg3_56(i5,i6)%c(2,1)*p356q*u3
     & 56_12(i1,i2)%d(1,1)+lg3_56(i5,i6)%a(2,2)*u356_12(i1,i2)%c
     & (2,1)
      ug3_5612(i5,i6,i1,i2)%d(2,1)=rmass(id3)*(lg3_56(i5,i6)%b(2
     & ,1)*u356_12(i1,i2)%d(1,1)+lg3_56(i5,i6)%d(2,2)*u356_12(i1
     & ,i2)%c(2,1))
      ug3_5612(i5,i6,i1,i2)%a(2,2)=lg3_56(i5,i6)%c(2,1)*p356q*u3
     & 56_12(i1,i2)%b(1,2)+lg3_56(i5,i6)%a(2,2)*u356_12(i1,i2)%a
     & (2,2)
      ug3_5612(i5,i6,i1,i2)%b(2,2)=rmass(id3)*(lg3_56(i5,i6)%b(2
     & ,1)*u356_12(i1,i2)%b(1,2)+lg3_56(i5,i6)%d(2,2)*u356_12(i1
     & ,i2)%a(2,2))
      ug3_5612(i5,i6,i1,i2)%c(2,2)=rmass(id3)*(lg3_56(i5,i6)%c(2
     & ,1)*u356_12(i1,i2)%c(1,2)+lg3_56(i5,i6)%a(2,2)*u356_12(i1
     & ,i2)%d(2,2))
      ug3_5612(i5,i6,i1,i2)%d(2,2)=lg3_56(i5,i6)%b(2,1)*u356_12(
     & i1,i2)%c(1,2)+lg3_56(i5,i6)%d(2,2)*p356q*u356_12(i1,i2)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* TT -- aa=ug3_5612(i5,i6,i1,i2)%a,bb=ug3_5612(i5,i6,i1,i2)%b,cc=ug3_561
* 2(i5,i6,i1,i2)%c,dd=ug3_5612(i5,i6,i1,i2)%d,a1=l3_12(i1,i2)%a,b1=l3_12
* (i1,i2)%b,c1=l3_12(i1,i2)%c,d1=l3_12(i1,i2)%d,a2=ug312_56(i5,i6)%a,b2=
* ug312_56(i5,i6)%b,c2=ug312_56(i5,i6)%c,d2=ug312_56(i5,i6)%d,prq=p312q,
* m=rmass(id3),nsum=1
      ug3_5612(i5,i6,i1,i2)%a(1,1)=ug3_5612(i5,i6,i1,i2)%a(1,1)+
     & l3_12(i1,i2)%a(1,1)*ug312_56(i5,i6)%a(1,1)+l3_12(i1,i2)%c
     & (1,2)*p312q*ug312_56(i5,i6)%b(2,1)
      ug3_5612(i5,i6,i1,i2)%b(1,1)=ug3_5612(i5,i6,i1,i2)%b(1,1)+
     & rmass(id3)*(l3_12(i1,i2)%d(1,1)*ug312_56(i5,i6)%a(1,1)+l3
     & _12(i1,i2)%b(1,2)*ug312_56(i5,i6)%b(2,1))
      ug3_5612(i5,i6,i1,i2)%c(1,1)=ug3_5612(i5,i6,i1,i2)%c(1,1)+
     & rmass(id3)*(l3_12(i1,i2)%a(1,1)*ug312_56(i5,i6)%d(1,1)+l3
     & _12(i1,i2)%c(1,2)*ug312_56(i5,i6)%c(2,1))
      ug3_5612(i5,i6,i1,i2)%d(1,1)=ug3_5612(i5,i6,i1,i2)%d(1,1)+
     & l3_12(i1,i2)%d(1,1)*p312q*ug312_56(i5,i6)%d(1,1)+l3_12(i1
     & ,i2)%b(1,2)*ug312_56(i5,i6)%c(2,1)
      ug3_5612(i5,i6,i1,i2)%a(1,2)=ug3_5612(i5,i6,i1,i2)%a(1,2)+
     & rmass(id3)*(l3_12(i1,i2)%a(1,1)*ug312_56(i5,i6)%b(1,2)+l3
     & _12(i1,i2)%c(1,2)*ug312_56(i5,i6)%a(2,2))
      ug3_5612(i5,i6,i1,i2)%b(1,2)=ug3_5612(i5,i6,i1,i2)%b(1,2)+
     & l3_12(i1,i2)%d(1,1)*p312q*ug312_56(i5,i6)%b(1,2)+l3_12(i1
     & ,i2)%b(1,2)*ug312_56(i5,i6)%a(2,2)
      ug3_5612(i5,i6,i1,i2)%c(1,2)=ug3_5612(i5,i6,i1,i2)%c(1,2)+
     & l3_12(i1,i2)%a(1,1)*ug312_56(i5,i6)%c(1,2)+l3_12(i1,i2)%c
     & (1,2)*p312q*ug312_56(i5,i6)%d(2,2)
      ug3_5612(i5,i6,i1,i2)%d(1,2)=ug3_5612(i5,i6,i1,i2)%d(1,2)+
     & rmass(id3)*(l3_12(i1,i2)%d(1,1)*ug312_56(i5,i6)%c(1,2)+l3
     & _12(i1,i2)%b(1,2)*ug312_56(i5,i6)%d(2,2))
      ug3_5612(i5,i6,i1,i2)%a(2,1)=ug3_5612(i5,i6,i1,i2)%a(2,1)+
     & rmass(id3)*(l3_12(i1,i2)%c(2,1)*ug312_56(i5,i6)%a(1,1)+l3
     & _12(i1,i2)%a(2,2)*ug312_56(i5,i6)%b(2,1))
      ug3_5612(i5,i6,i1,i2)%b(2,1)=ug3_5612(i5,i6,i1,i2)%b(2,1)+
     & l3_12(i1,i2)%b(2,1)*ug312_56(i5,i6)%a(1,1)+l3_12(i1,i2)%d
     & (2,2)*p312q*ug312_56(i5,i6)%b(2,1)
      ug3_5612(i5,i6,i1,i2)%c(2,1)=ug3_5612(i5,i6,i1,i2)%c(2,1)+
     & l3_12(i1,i2)%c(2,1)*p312q*ug312_56(i5,i6)%d(1,1)+l3_12(i1
     & ,i2)%a(2,2)*ug312_56(i5,i6)%c(2,1)
      ug3_5612(i5,i6,i1,i2)%d(2,1)=ug3_5612(i5,i6,i1,i2)%d(2,1)+
     & rmass(id3)*(l3_12(i1,i2)%b(2,1)*ug312_56(i5,i6)%d(1,1)+l3
     & _12(i1,i2)%d(2,2)*ug312_56(i5,i6)%c(2,1))
      ug3_5612(i5,i6,i1,i2)%a(2,2)=ug3_5612(i5,i6,i1,i2)%a(2,2)+
     & l3_12(i1,i2)%c(2,1)*p312q*ug312_56(i5,i6)%b(1,2)+l3_12(i1
     & ,i2)%a(2,2)*ug312_56(i5,i6)%a(2,2)
      ug3_5612(i5,i6,i1,i2)%b(2,2)=ug3_5612(i5,i6,i1,i2)%b(2,2)+
     & rmass(id3)*(l3_12(i1,i2)%b(2,1)*ug312_56(i5,i6)%b(1,2)+l3
     & _12(i1,i2)%d(2,2)*ug312_56(i5,i6)%a(2,2))
      ug3_5612(i5,i6,i1,i2)%c(2,2)=ug3_5612(i5,i6,i1,i2)%c(2,2)+
     & rmass(id3)*(l3_12(i1,i2)%c(2,1)*ug312_56(i5,i6)%c(1,2)+l3
     & _12(i1,i2)%a(2,2)*ug312_56(i5,i6)%d(2,2))
      ug3_5612(i5,i6,i1,i2)%d(2,2)=ug3_5612(i5,i6,i1,i2)%d(2,2)+
     & l3_12(i1,i2)%b(2,1)*ug312_56(i5,i6)%c(1,2)+l3_12(i1,i2)%d
     & (2,2)*p312q*ug312_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* TTs -- aa=ug3_5612(i5,i6,i1,i2)%a,bb=ug3_5612(i5,i6,i1,i2)%b,cc=ug3_56
* 12(i5,i6,i1,i2)%c,dd=ug3_5612(i5,i6,i1,i2)%d,a1=lg3_56(i5,i6)%a,b1=lg3
* _56(i5,i6)%b,c1=lg3_56(i5,i6)%c,d1=lg3_56(i5,i6)%d,a2=u356_12(i1,i2)%a
* ,b2=u356_12(i1,i2)%b,c2=u356_12(i1,i2)%c,d2=u356_12(i1,i2)%d,prq=p356q
* ,m=rmass(id3),nsum=0
      do jut=1,2
      cx1=u356_12(i1,i2)%a(1,jut)+rmass(id3)*u356_12(i1,i2)%b(1,
     & jut)
      cx2=u356_12(i1,i2)%a(2,jut)+rmass(id3)*u356_12(i1,i2)%b(2,
     & jut)
      cy1=p356q*u356_12(i1,i2)%b(1,jut)+rmass(id3)*u356_12(i1,i2
     & )%a(1,jut)
      cy2=p356q*u356_12(i1,i2)%b(2,jut)+rmass(id3)*u356_12(i1,i2
     & )%a(2,jut)
      cw1=u356_12(i1,i2)%c(1,jut)+rmass(id3)*u356_12(i1,i2)%d(1,
     & jut)
      cw2=u356_12(i1,i2)%c(2,jut)+rmass(id3)*u356_12(i1,i2)%d(2,
     & jut)
      cz1=p356q*u356_12(i1,i2)%d(1,jut)+rmass(id3)*u356_12(i1,i2
     & )%c(1,jut)
      cz2=p356q*u356_12(i1,i2)%d(2,jut)+rmass(id3)*u356_12(i1,i2
     & )%c(2,jut)
      ug3_5612(i5,i6,i1,i2)%a(1,jut)=lg3_56(i5,i6)%a(1,1)*cx1+lg
     & 3_56(i5,i6)%c(1,2)*cy2
      ug3_5612(i5,i6,i1,i2)%b(1,jut)=lg3_56(i5,i6)%d(1,1)*cy1+lg
     & 3_56(i5,i6)%b(1,2)*cx2
      ug3_5612(i5,i6,i1,i2)%c(1,jut)=lg3_56(i5,i6)%a(1,1)*cw1+lg
     & 3_56(i5,i6)%c(1,2)*cz2
      ug3_5612(i5,i6,i1,i2)%d(1,jut)=lg3_56(i5,i6)%d(1,1)*cz1+lg
     & 3_56(i5,i6)%b(1,2)*cw2
      ug3_5612(i5,i6,i1,i2)%a(2,jut)=lg3_56(i5,i6)%c(2,1)*cy1+lg
     & 3_56(i5,i6)%a(2,2)*cx2
      ug3_5612(i5,i6,i1,i2)%b(2,jut)=lg3_56(i5,i6)%b(2,1)*cx1+lg
     & 3_56(i5,i6)%d(2,2)*cy2
      ug3_5612(i5,i6,i1,i2)%c(2,jut)=lg3_56(i5,i6)%c(2,1)*cz1+lg
     & 3_56(i5,i6)%a(2,2)*cw2
      ug3_5612(i5,i6,i1,i2)%d(2,jut)=lg3_56(i5,i6)%b(2,1)*cw1+lg
     & 3_56(i5,i6)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=ug3_5612(i5,i6,i1,i2)%a,bb=ug3_5612(i5,i6,i1,i2)%b,cc=ug3_56
* 12(i5,i6,i1,i2)%c,dd=ug3_5612(i5,i6,i1,i2)%d,a1=l3_12(i1,i2)%a,b1=l3_1
* 2(i1,i2)%b,c1=l3_12(i1,i2)%c,d1=l3_12(i1,i2)%d,a2=ug312_56(i5,i6)%a,b2
* =ug312_56(i5,i6)%b,c2=ug312_56(i5,i6)%c,d2=ug312_56(i5,i6)%d,prq=p312q
* ,m=rmass(id3),nsum=1
      do iut=1,2
      cx1=l3_12(i1,i2)%a(iut,1)+l3_12(i1,i2)%c(iut,1)*rmass(id3)
      cx2=l3_12(i1,i2)%c(iut,2)*p312q+l3_12(i1,i2)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_12(i1,i2)%b(iut,1)+l3_12(i1,i2)%d(iut,1)*rmass(id3)
      cy2=l3_12(i1,i2)%d(iut,2)*p312q+l3_12(i1,i2)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_12(i1,i2)%c(iut,1)*p312q+l3_12(i1,i2)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_12(i1,i2)%a(iut,2)+l3_12(i1,i2)%c(iut,2)*rmass(id3)
      cz1=l3_12(i1,i2)%d(iut,1)*p312q+l3_12(i1,i2)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_12(i1,i2)%b(iut,2)+l3_12(i1,i2)%d(iut,2)*rmass(id3)
      ug3_5612(i5,i6,i1,i2)%a(iut,1)=ug3_5612(i5,i6,i1,i2)%a(iut
     & ,1)+cx1*ug312_56(i5,i6)%a(1,1)+cx2*ug312_56(i5,i6)%b(2,1)
      ug3_5612(i5,i6,i1,i2)%b(iut,1)=ug3_5612(i5,i6,i1,i2)%b(iut
     & ,1)+cy1*ug312_56(i5,i6)%a(1,1)+cy2*ug312_56(i5,i6)%b(2,1)
      ug3_5612(i5,i6,i1,i2)%c(iut,1)=ug3_5612(i5,i6,i1,i2)%c(iut
     & ,1)+cw1*ug312_56(i5,i6)%d(1,1)+cw2*ug312_56(i5,i6)%c(2,1)
      ug3_5612(i5,i6,i1,i2)%d(iut,1)=ug3_5612(i5,i6,i1,i2)%d(iut
     & ,1)+cz1*ug312_56(i5,i6)%d(1,1)+cz2*ug312_56(i5,i6)%c(2,1)
      ug3_5612(i5,i6,i1,i2)%a(iut,2)=ug3_5612(i5,i6,i1,i2)%a(iut
     & ,2)+cw1*ug312_56(i5,i6)%b(1,2)+cw2*ug312_56(i5,i6)%a(2,2)
      ug3_5612(i5,i6,i1,i2)%b(iut,2)=ug3_5612(i5,i6,i1,i2)%b(iut
     & ,2)+cz1*ug312_56(i5,i6)%b(1,2)+cz2*ug312_56(i5,i6)%a(2,2)
      ug3_5612(i5,i6,i1,i2)%c(iut,2)=ug3_5612(i5,i6,i1,i2)%c(iut
     & ,2)+cx1*ug312_56(i5,i6)%c(1,2)+cx2*ug312_56(i5,i6)%d(2,2)
      ug3_5612(i5,i6,i1,i2)%d(iut,2)=ug3_5612(i5,i6,i1,i2)%d(iut
     & ,2)+cy1*ug312_56(i5,i6)%c(1,2)+cy2*ug312_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id3).ne.1 .and. ilept(id1).ne.1)then
        if(id3.ne.5 .or. id7.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=ug3_1278(i1,i2,i7,i8)%a,bb=ug3_1278(i1,i2,i7,i8)%b,cc=ug3_127
* 8(i1,i2,i7,i8)%c,dd=ug3_1278(i1,i2,i7,i8)%d,a1=lg3_12(i1,i2)%a,b1=lg3_
* 12(i1,i2)%b,c1=lg3_12(i1,i2)%c,d1=lg3_12(i1,i2)%d,a2=u312_78(i7,i8)%a,
* b2=u312_78(i7,i8)%b,c2=u312_78(i7,i8)%c,d2=u312_78(i7,i8)%d,prq=p312q,
* m=rmass(id3),nsum=0
      ug3_1278(i1,i2,i7,i8)%a(1,1)=lg3_12(i1,i2)%a(1,1)*u312_78(
     & i7,i8)%a(1,1)+lg3_12(i1,i2)%c(1,2)*p312q*u312_78(i7,i8)%b
     & (2,1)
      ug3_1278(i1,i2,i7,i8)%b(1,1)=rmass(id3)*(lg3_12(i1,i2)%d(1
     & ,1)*u312_78(i7,i8)%a(1,1)+lg3_12(i1,i2)%b(1,2)*u312_78(i7
     & ,i8)%b(2,1))
      ug3_1278(i1,i2,i7,i8)%c(1,1)=rmass(id3)*(lg3_12(i1,i2)%a(1
     & ,1)*u312_78(i7,i8)%d(1,1)+lg3_12(i1,i2)%c(1,2)*u312_78(i7
     & ,i8)%c(2,1))
      ug3_1278(i1,i2,i7,i8)%d(1,1)=lg3_12(i1,i2)%d(1,1)*p312q*u3
     & 12_78(i7,i8)%d(1,1)+lg3_12(i1,i2)%b(1,2)*u312_78(i7,i8)%c
     & (2,1)
      ug3_1278(i1,i2,i7,i8)%a(1,2)=rmass(id3)*(lg3_12(i1,i2)%a(1
     & ,1)*u312_78(i7,i8)%b(1,2)+lg3_12(i1,i2)%c(1,2)*u312_78(i7
     & ,i8)%a(2,2))
      ug3_1278(i1,i2,i7,i8)%b(1,2)=lg3_12(i1,i2)%d(1,1)*p312q*u3
     & 12_78(i7,i8)%b(1,2)+lg3_12(i1,i2)%b(1,2)*u312_78(i7,i8)%a
     & (2,2)
      ug3_1278(i1,i2,i7,i8)%c(1,2)=lg3_12(i1,i2)%a(1,1)*u312_78(
     & i7,i8)%c(1,2)+lg3_12(i1,i2)%c(1,2)*p312q*u312_78(i7,i8)%d
     & (2,2)
      ug3_1278(i1,i2,i7,i8)%d(1,2)=rmass(id3)*(lg3_12(i1,i2)%d(1
     & ,1)*u312_78(i7,i8)%c(1,2)+lg3_12(i1,i2)%b(1,2)*u312_78(i7
     & ,i8)%d(2,2))
      ug3_1278(i1,i2,i7,i8)%a(2,1)=rmass(id3)*(lg3_12(i1,i2)%c(2
     & ,1)*u312_78(i7,i8)%a(1,1)+lg3_12(i1,i2)%a(2,2)*u312_78(i7
     & ,i8)%b(2,1))
      ug3_1278(i1,i2,i7,i8)%b(2,1)=lg3_12(i1,i2)%b(2,1)*u312_78(
     & i7,i8)%a(1,1)+lg3_12(i1,i2)%d(2,2)*p312q*u312_78(i7,i8)%b
     & (2,1)
      ug3_1278(i1,i2,i7,i8)%c(2,1)=lg3_12(i1,i2)%c(2,1)*p312q*u3
     & 12_78(i7,i8)%d(1,1)+lg3_12(i1,i2)%a(2,2)*u312_78(i7,i8)%c
     & (2,1)
      ug3_1278(i1,i2,i7,i8)%d(2,1)=rmass(id3)*(lg3_12(i1,i2)%b(2
     & ,1)*u312_78(i7,i8)%d(1,1)+lg3_12(i1,i2)%d(2,2)*u312_78(i7
     & ,i8)%c(2,1))
      ug3_1278(i1,i2,i7,i8)%a(2,2)=lg3_12(i1,i2)%c(2,1)*p312q*u3
     & 12_78(i7,i8)%b(1,2)+lg3_12(i1,i2)%a(2,2)*u312_78(i7,i8)%a
     & (2,2)
      ug3_1278(i1,i2,i7,i8)%b(2,2)=rmass(id3)*(lg3_12(i1,i2)%b(2
     & ,1)*u312_78(i7,i8)%b(1,2)+lg3_12(i1,i2)%d(2,2)*u312_78(i7
     & ,i8)%a(2,2))
      ug3_1278(i1,i2,i7,i8)%c(2,2)=rmass(id3)*(lg3_12(i1,i2)%c(2
     & ,1)*u312_78(i7,i8)%c(1,2)+lg3_12(i1,i2)%a(2,2)*u312_78(i7
     & ,i8)%d(2,2))
      ug3_1278(i1,i2,i7,i8)%d(2,2)=lg3_12(i1,i2)%b(2,1)*u312_78(
     & i7,i8)%c(1,2)+lg3_12(i1,i2)%d(2,2)*p312q*u312_78(i7,i8)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=ug3_1278(i1,i2,i7,i8)%a,bb=ug3_1278(i1,i2,i7,i8)%b,cc=ug3_127
* 8(i1,i2,i7,i8)%c,dd=ug3_1278(i1,i2,i7,i8)%d,a1=l3_78(i7,i8)%a,b1=l3_78
* (i7,i8)%b,c1=l3_78(i7,i8)%c,d1=l3_78(i7,i8)%d,a2=ug378_12(i1,i2)%a,b2=
* ug378_12(i1,i2)%b,c2=ug378_12(i1,i2)%c,d2=ug378_12(i1,i2)%d,prq=p378q,
* m=rmass(id3),nsum=1
      ug3_1278(i1,i2,i7,i8)%a(1,1)=ug3_1278(i1,i2,i7,i8)%a(1,1)+
     & l3_78(i7,i8)%a(1,1)*ug378_12(i1,i2)%a(1,1)+l3_78(i7,i8)%c
     & (1,2)*p378q*ug378_12(i1,i2)%b(2,1)
      ug3_1278(i1,i2,i7,i8)%b(1,1)=ug3_1278(i1,i2,i7,i8)%b(1,1)+
     & rmass(id3)*(l3_78(i7,i8)%d(1,1)*ug378_12(i1,i2)%a(1,1)+l3
     & _78(i7,i8)%b(1,2)*ug378_12(i1,i2)%b(2,1))
      ug3_1278(i1,i2,i7,i8)%c(1,1)=ug3_1278(i1,i2,i7,i8)%c(1,1)+
     & rmass(id3)*(l3_78(i7,i8)%a(1,1)*ug378_12(i1,i2)%d(1,1)+l3
     & _78(i7,i8)%c(1,2)*ug378_12(i1,i2)%c(2,1))
      ug3_1278(i1,i2,i7,i8)%d(1,1)=ug3_1278(i1,i2,i7,i8)%d(1,1)+
     & l3_78(i7,i8)%d(1,1)*p378q*ug378_12(i1,i2)%d(1,1)+l3_78(i7
     & ,i8)%b(1,2)*ug378_12(i1,i2)%c(2,1)
      ug3_1278(i1,i2,i7,i8)%a(1,2)=ug3_1278(i1,i2,i7,i8)%a(1,2)+
     & rmass(id3)*(l3_78(i7,i8)%a(1,1)*ug378_12(i1,i2)%b(1,2)+l3
     & _78(i7,i8)%c(1,2)*ug378_12(i1,i2)%a(2,2))
      ug3_1278(i1,i2,i7,i8)%b(1,2)=ug3_1278(i1,i2,i7,i8)%b(1,2)+
     & l3_78(i7,i8)%d(1,1)*p378q*ug378_12(i1,i2)%b(1,2)+l3_78(i7
     & ,i8)%b(1,2)*ug378_12(i1,i2)%a(2,2)
      ug3_1278(i1,i2,i7,i8)%c(1,2)=ug3_1278(i1,i2,i7,i8)%c(1,2)+
     & l3_78(i7,i8)%a(1,1)*ug378_12(i1,i2)%c(1,2)+l3_78(i7,i8)%c
     & (1,2)*p378q*ug378_12(i1,i2)%d(2,2)
      ug3_1278(i1,i2,i7,i8)%d(1,2)=ug3_1278(i1,i2,i7,i8)%d(1,2)+
     & rmass(id3)*(l3_78(i7,i8)%d(1,1)*ug378_12(i1,i2)%c(1,2)+l3
     & _78(i7,i8)%b(1,2)*ug378_12(i1,i2)%d(2,2))
      ug3_1278(i1,i2,i7,i8)%a(2,1)=ug3_1278(i1,i2,i7,i8)%a(2,1)+
     & rmass(id3)*(l3_78(i7,i8)%c(2,1)*ug378_12(i1,i2)%a(1,1)+l3
     & _78(i7,i8)%a(2,2)*ug378_12(i1,i2)%b(2,1))
      ug3_1278(i1,i2,i7,i8)%b(2,1)=ug3_1278(i1,i2,i7,i8)%b(2,1)+
     & l3_78(i7,i8)%b(2,1)*ug378_12(i1,i2)%a(1,1)+l3_78(i7,i8)%d
     & (2,2)*p378q*ug378_12(i1,i2)%b(2,1)
      ug3_1278(i1,i2,i7,i8)%c(2,1)=ug3_1278(i1,i2,i7,i8)%c(2,1)+
     & l3_78(i7,i8)%c(2,1)*p378q*ug378_12(i1,i2)%d(1,1)+l3_78(i7
     & ,i8)%a(2,2)*ug378_12(i1,i2)%c(2,1)
      ug3_1278(i1,i2,i7,i8)%d(2,1)=ug3_1278(i1,i2,i7,i8)%d(2,1)+
     & rmass(id3)*(l3_78(i7,i8)%b(2,1)*ug378_12(i1,i2)%d(1,1)+l3
     & _78(i7,i8)%d(2,2)*ug378_12(i1,i2)%c(2,1))
      ug3_1278(i1,i2,i7,i8)%a(2,2)=ug3_1278(i1,i2,i7,i8)%a(2,2)+
     & l3_78(i7,i8)%c(2,1)*p378q*ug378_12(i1,i2)%b(1,2)+l3_78(i7
     & ,i8)%a(2,2)*ug378_12(i1,i2)%a(2,2)
      ug3_1278(i1,i2,i7,i8)%b(2,2)=ug3_1278(i1,i2,i7,i8)%b(2,2)+
     & rmass(id3)*(l3_78(i7,i8)%b(2,1)*ug378_12(i1,i2)%b(1,2)+l3
     & _78(i7,i8)%d(2,2)*ug378_12(i1,i2)%a(2,2))
      ug3_1278(i1,i2,i7,i8)%c(2,2)=ug3_1278(i1,i2,i7,i8)%c(2,2)+
     & rmass(id3)*(l3_78(i7,i8)%c(2,1)*ug378_12(i1,i2)%c(1,2)+l3
     & _78(i7,i8)%a(2,2)*ug378_12(i1,i2)%d(2,2))
      ug3_1278(i1,i2,i7,i8)%d(2,2)=ug3_1278(i1,i2,i7,i8)%d(2,2)+
     & l3_78(i7,i8)%b(2,1)*ug378_12(i1,i2)%c(1,2)+l3_78(i7,i8)%d
     & (2,2)*p378q*ug378_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=ug3_1278(i1,i2,i7,i8)%a,bb=ug3_1278(i1,i2,i7,i8)%b,cc=ug3_12
* 78(i1,i2,i7,i8)%c,dd=ug3_1278(i1,i2,i7,i8)%d,a1=lg3_12(i1,i2)%a,b1=lg3
* _12(i1,i2)%b,c1=lg3_12(i1,i2)%c,d1=lg3_12(i1,i2)%d,a2=u312_78(i7,i8)%a
* ,b2=u312_78(i7,i8)%b,c2=u312_78(i7,i8)%c,d2=u312_78(i7,i8)%d,prq=p312q
* ,m=rmass(id3),nsum=0
      do jut=1,2
      cx1=u312_78(i7,i8)%a(1,jut)+rmass(id3)*u312_78(i7,i8)%b(1,
     & jut)
      cx2=u312_78(i7,i8)%a(2,jut)+rmass(id3)*u312_78(i7,i8)%b(2,
     & jut)
      cy1=p312q*u312_78(i7,i8)%b(1,jut)+rmass(id3)*u312_78(i7,i8
     & )%a(1,jut)
      cy2=p312q*u312_78(i7,i8)%b(2,jut)+rmass(id3)*u312_78(i7,i8
     & )%a(2,jut)
      cw1=u312_78(i7,i8)%c(1,jut)+rmass(id3)*u312_78(i7,i8)%d(1,
     & jut)
      cw2=u312_78(i7,i8)%c(2,jut)+rmass(id3)*u312_78(i7,i8)%d(2,
     & jut)
      cz1=p312q*u312_78(i7,i8)%d(1,jut)+rmass(id3)*u312_78(i7,i8
     & )%c(1,jut)
      cz2=p312q*u312_78(i7,i8)%d(2,jut)+rmass(id3)*u312_78(i7,i8
     & )%c(2,jut)
      ug3_1278(i1,i2,i7,i8)%a(1,jut)=lg3_12(i1,i2)%a(1,1)*cx1+lg
     & 3_12(i1,i2)%c(1,2)*cy2
      ug3_1278(i1,i2,i7,i8)%b(1,jut)=lg3_12(i1,i2)%d(1,1)*cy1+lg
     & 3_12(i1,i2)%b(1,2)*cx2
      ug3_1278(i1,i2,i7,i8)%c(1,jut)=lg3_12(i1,i2)%a(1,1)*cw1+lg
     & 3_12(i1,i2)%c(1,2)*cz2
      ug3_1278(i1,i2,i7,i8)%d(1,jut)=lg3_12(i1,i2)%d(1,1)*cz1+lg
     & 3_12(i1,i2)%b(1,2)*cw2
      ug3_1278(i1,i2,i7,i8)%a(2,jut)=lg3_12(i1,i2)%c(2,1)*cy1+lg
     & 3_12(i1,i2)%a(2,2)*cx2
      ug3_1278(i1,i2,i7,i8)%b(2,jut)=lg3_12(i1,i2)%b(2,1)*cx1+lg
     & 3_12(i1,i2)%d(2,2)*cy2
      ug3_1278(i1,i2,i7,i8)%c(2,jut)=lg3_12(i1,i2)%c(2,1)*cz1+lg
     & 3_12(i1,i2)%a(2,2)*cw2
      ug3_1278(i1,i2,i7,i8)%d(2,jut)=lg3_12(i1,i2)%b(2,1)*cw1+lg
     & 3_12(i1,i2)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=ug3_1278(i1,i2,i7,i8)%a,bb=ug3_1278(i1,i2,i7,i8)%b,cc=ug3_12
* 78(i1,i2,i7,i8)%c,dd=ug3_1278(i1,i2,i7,i8)%d,a1=l3_78(i7,i8)%a,b1=l3_7
* 8(i7,i8)%b,c1=l3_78(i7,i8)%c,d1=l3_78(i7,i8)%d,a2=ug378_12(i1,i2)%a,b2
* =ug378_12(i1,i2)%b,c2=ug378_12(i1,i2)%c,d2=ug378_12(i1,i2)%d,prq=p378q
* ,m=rmass(id3),nsum=1
      do iut=1,2
      cx1=l3_78(i7,i8)%a(iut,1)+l3_78(i7,i8)%c(iut,1)*rmass(id3)
      cx2=l3_78(i7,i8)%c(iut,2)*p378q+l3_78(i7,i8)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_78(i7,i8)%b(iut,1)+l3_78(i7,i8)%d(iut,1)*rmass(id3)
      cy2=l3_78(i7,i8)%d(iut,2)*p378q+l3_78(i7,i8)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_78(i7,i8)%c(iut,1)*p378q+l3_78(i7,i8)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_78(i7,i8)%a(iut,2)+l3_78(i7,i8)%c(iut,2)*rmass(id3)
      cz1=l3_78(i7,i8)%d(iut,1)*p378q+l3_78(i7,i8)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_78(i7,i8)%b(iut,2)+l3_78(i7,i8)%d(iut,2)*rmass(id3)
      ug3_1278(i1,i2,i7,i8)%a(iut,1)=ug3_1278(i1,i2,i7,i8)%a(iut
     & ,1)+cx1*ug378_12(i1,i2)%a(1,1)+cx2*ug378_12(i1,i2)%b(2,1)
      ug3_1278(i1,i2,i7,i8)%b(iut,1)=ug3_1278(i1,i2,i7,i8)%b(iut
     & ,1)+cy1*ug378_12(i1,i2)%a(1,1)+cy2*ug378_12(i1,i2)%b(2,1)
      ug3_1278(i1,i2,i7,i8)%c(iut,1)=ug3_1278(i1,i2,i7,i8)%c(iut
     & ,1)+cw1*ug378_12(i1,i2)%d(1,1)+cw2*ug378_12(i1,i2)%c(2,1)
      ug3_1278(i1,i2,i7,i8)%d(iut,1)=ug3_1278(i1,i2,i7,i8)%d(iut
     & ,1)+cz1*ug378_12(i1,i2)%d(1,1)+cz2*ug378_12(i1,i2)%c(2,1)
      ug3_1278(i1,i2,i7,i8)%a(iut,2)=ug3_1278(i1,i2,i7,i8)%a(iut
     & ,2)+cw1*ug378_12(i1,i2)%b(1,2)+cw2*ug378_12(i1,i2)%a(2,2)
      ug3_1278(i1,i2,i7,i8)%b(iut,2)=ug3_1278(i1,i2,i7,i8)%b(iut
     & ,2)+cz1*ug378_12(i1,i2)%b(1,2)+cz2*ug378_12(i1,i2)%a(2,2)
      ug3_1278(i1,i2,i7,i8)%c(iut,2)=ug3_1278(i1,i2,i7,i8)%c(iut
     & ,2)+cx1*ug378_12(i1,i2)%c(1,2)+cx2*ug378_12(i1,i2)%d(2,2)
      ug3_1278(i1,i2,i7,i8)%d(iut,2)=ug3_1278(i1,i2,i7,i8)%d(iut
     & ,2)+cy1*ug378_12(i1,i2)%c(1,2)+cy2*ug378_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id3).ne.1 .and. ilept(id7).ne.1)then
        if(id3.ne.5 .or. id1.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TT -- aa=ug3_7812(i7,i8,i1,i2)%a,bb=ug3_7812(i7,i8,i1,i2)%b,cc=ug3_781
* 2(i7,i8,i1,i2)%c,dd=ug3_7812(i7,i8,i1,i2)%d,a1=lg3_78(i7,i8)%a,b1=lg3_
* 78(i7,i8)%b,c1=lg3_78(i7,i8)%c,d1=lg3_78(i7,i8)%d,a2=u378_12(i1,i2)%a,
* b2=u378_12(i1,i2)%b,c2=u378_12(i1,i2)%c,d2=u378_12(i1,i2)%d,prq=p378q,
* m=rmass(id3),nsum=0
      ug3_7812(i7,i8,i1,i2)%a(1,1)=lg3_78(i7,i8)%a(1,1)*u378_12(
     & i1,i2)%a(1,1)+lg3_78(i7,i8)%c(1,2)*p378q*u378_12(i1,i2)%b
     & (2,1)
      ug3_7812(i7,i8,i1,i2)%b(1,1)=rmass(id3)*(lg3_78(i7,i8)%d(1
     & ,1)*u378_12(i1,i2)%a(1,1)+lg3_78(i7,i8)%b(1,2)*u378_12(i1
     & ,i2)%b(2,1))
      ug3_7812(i7,i8,i1,i2)%c(1,1)=rmass(id3)*(lg3_78(i7,i8)%a(1
     & ,1)*u378_12(i1,i2)%d(1,1)+lg3_78(i7,i8)%c(1,2)*u378_12(i1
     & ,i2)%c(2,1))
      ug3_7812(i7,i8,i1,i2)%d(1,1)=lg3_78(i7,i8)%d(1,1)*p378q*u3
     & 78_12(i1,i2)%d(1,1)+lg3_78(i7,i8)%b(1,2)*u378_12(i1,i2)%c
     & (2,1)
      ug3_7812(i7,i8,i1,i2)%a(1,2)=rmass(id3)*(lg3_78(i7,i8)%a(1
     & ,1)*u378_12(i1,i2)%b(1,2)+lg3_78(i7,i8)%c(1,2)*u378_12(i1
     & ,i2)%a(2,2))
      ug3_7812(i7,i8,i1,i2)%b(1,2)=lg3_78(i7,i8)%d(1,1)*p378q*u3
     & 78_12(i1,i2)%b(1,2)+lg3_78(i7,i8)%b(1,2)*u378_12(i1,i2)%a
     & (2,2)
      ug3_7812(i7,i8,i1,i2)%c(1,2)=lg3_78(i7,i8)%a(1,1)*u378_12(
     & i1,i2)%c(1,2)+lg3_78(i7,i8)%c(1,2)*p378q*u378_12(i1,i2)%d
     & (2,2)
      ug3_7812(i7,i8,i1,i2)%d(1,2)=rmass(id3)*(lg3_78(i7,i8)%d(1
     & ,1)*u378_12(i1,i2)%c(1,2)+lg3_78(i7,i8)%b(1,2)*u378_12(i1
     & ,i2)%d(2,2))
      ug3_7812(i7,i8,i1,i2)%a(2,1)=rmass(id3)*(lg3_78(i7,i8)%c(2
     & ,1)*u378_12(i1,i2)%a(1,1)+lg3_78(i7,i8)%a(2,2)*u378_12(i1
     & ,i2)%b(2,1))
      ug3_7812(i7,i8,i1,i2)%b(2,1)=lg3_78(i7,i8)%b(2,1)*u378_12(
     & i1,i2)%a(1,1)+lg3_78(i7,i8)%d(2,2)*p378q*u378_12(i1,i2)%b
     & (2,1)
      ug3_7812(i7,i8,i1,i2)%c(2,1)=lg3_78(i7,i8)%c(2,1)*p378q*u3
     & 78_12(i1,i2)%d(1,1)+lg3_78(i7,i8)%a(2,2)*u378_12(i1,i2)%c
     & (2,1)
      ug3_7812(i7,i8,i1,i2)%d(2,1)=rmass(id3)*(lg3_78(i7,i8)%b(2
     & ,1)*u378_12(i1,i2)%d(1,1)+lg3_78(i7,i8)%d(2,2)*u378_12(i1
     & ,i2)%c(2,1))
      ug3_7812(i7,i8,i1,i2)%a(2,2)=lg3_78(i7,i8)%c(2,1)*p378q*u3
     & 78_12(i1,i2)%b(1,2)+lg3_78(i7,i8)%a(2,2)*u378_12(i1,i2)%a
     & (2,2)
      ug3_7812(i7,i8,i1,i2)%b(2,2)=rmass(id3)*(lg3_78(i7,i8)%b(2
     & ,1)*u378_12(i1,i2)%b(1,2)+lg3_78(i7,i8)%d(2,2)*u378_12(i1
     & ,i2)%a(2,2))
      ug3_7812(i7,i8,i1,i2)%c(2,2)=rmass(id3)*(lg3_78(i7,i8)%c(2
     & ,1)*u378_12(i1,i2)%c(1,2)+lg3_78(i7,i8)%a(2,2)*u378_12(i1
     & ,i2)%d(2,2))
      ug3_7812(i7,i8,i1,i2)%d(2,2)=lg3_78(i7,i8)%b(2,1)*u378_12(
     & i1,i2)%c(1,2)+lg3_78(i7,i8)%d(2,2)*p378q*u378_12(i1,i2)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TT -- aa=ug3_7812(i7,i8,i1,i2)%a,bb=ug3_7812(i7,i8,i1,i2)%b,cc=ug3_781
* 2(i7,i8,i1,i2)%c,dd=ug3_7812(i7,i8,i1,i2)%d,a1=l3_12(i1,i2)%a,b1=l3_12
* (i1,i2)%b,c1=l3_12(i1,i2)%c,d1=l3_12(i1,i2)%d,a2=ug312_78(i7,i8)%a,b2=
* ug312_78(i7,i8)%b,c2=ug312_78(i7,i8)%c,d2=ug312_78(i7,i8)%d,prq=p312q,
* m=rmass(id3),nsum=1
      ug3_7812(i7,i8,i1,i2)%a(1,1)=ug3_7812(i7,i8,i1,i2)%a(1,1)+
     & l3_12(i1,i2)%a(1,1)*ug312_78(i7,i8)%a(1,1)+l3_12(i1,i2)%c
     & (1,2)*p312q*ug312_78(i7,i8)%b(2,1)
      ug3_7812(i7,i8,i1,i2)%b(1,1)=ug3_7812(i7,i8,i1,i2)%b(1,1)+
     & rmass(id3)*(l3_12(i1,i2)%d(1,1)*ug312_78(i7,i8)%a(1,1)+l3
     & _12(i1,i2)%b(1,2)*ug312_78(i7,i8)%b(2,1))
      ug3_7812(i7,i8,i1,i2)%c(1,1)=ug3_7812(i7,i8,i1,i2)%c(1,1)+
     & rmass(id3)*(l3_12(i1,i2)%a(1,1)*ug312_78(i7,i8)%d(1,1)+l3
     & _12(i1,i2)%c(1,2)*ug312_78(i7,i8)%c(2,1))
      ug3_7812(i7,i8,i1,i2)%d(1,1)=ug3_7812(i7,i8,i1,i2)%d(1,1)+
     & l3_12(i1,i2)%d(1,1)*p312q*ug312_78(i7,i8)%d(1,1)+l3_12(i1
     & ,i2)%b(1,2)*ug312_78(i7,i8)%c(2,1)
      ug3_7812(i7,i8,i1,i2)%a(1,2)=ug3_7812(i7,i8,i1,i2)%a(1,2)+
     & rmass(id3)*(l3_12(i1,i2)%a(1,1)*ug312_78(i7,i8)%b(1,2)+l3
     & _12(i1,i2)%c(1,2)*ug312_78(i7,i8)%a(2,2))
      ug3_7812(i7,i8,i1,i2)%b(1,2)=ug3_7812(i7,i8,i1,i2)%b(1,2)+
     & l3_12(i1,i2)%d(1,1)*p312q*ug312_78(i7,i8)%b(1,2)+l3_12(i1
     & ,i2)%b(1,2)*ug312_78(i7,i8)%a(2,2)
      ug3_7812(i7,i8,i1,i2)%c(1,2)=ug3_7812(i7,i8,i1,i2)%c(1,2)+
     & l3_12(i1,i2)%a(1,1)*ug312_78(i7,i8)%c(1,2)+l3_12(i1,i2)%c
     & (1,2)*p312q*ug312_78(i7,i8)%d(2,2)
      ug3_7812(i7,i8,i1,i2)%d(1,2)=ug3_7812(i7,i8,i1,i2)%d(1,2)+
     & rmass(id3)*(l3_12(i1,i2)%d(1,1)*ug312_78(i7,i8)%c(1,2)+l3
     & _12(i1,i2)%b(1,2)*ug312_78(i7,i8)%d(2,2))
      ug3_7812(i7,i8,i1,i2)%a(2,1)=ug3_7812(i7,i8,i1,i2)%a(2,1)+
     & rmass(id3)*(l3_12(i1,i2)%c(2,1)*ug312_78(i7,i8)%a(1,1)+l3
     & _12(i1,i2)%a(2,2)*ug312_78(i7,i8)%b(2,1))
      ug3_7812(i7,i8,i1,i2)%b(2,1)=ug3_7812(i7,i8,i1,i2)%b(2,1)+
     & l3_12(i1,i2)%b(2,1)*ug312_78(i7,i8)%a(1,1)+l3_12(i1,i2)%d
     & (2,2)*p312q*ug312_78(i7,i8)%b(2,1)
      ug3_7812(i7,i8,i1,i2)%c(2,1)=ug3_7812(i7,i8,i1,i2)%c(2,1)+
     & l3_12(i1,i2)%c(2,1)*p312q*ug312_78(i7,i8)%d(1,1)+l3_12(i1
     & ,i2)%a(2,2)*ug312_78(i7,i8)%c(2,1)
      ug3_7812(i7,i8,i1,i2)%d(2,1)=ug3_7812(i7,i8,i1,i2)%d(2,1)+
     & rmass(id3)*(l3_12(i1,i2)%b(2,1)*ug312_78(i7,i8)%d(1,1)+l3
     & _12(i1,i2)%d(2,2)*ug312_78(i7,i8)%c(2,1))
      ug3_7812(i7,i8,i1,i2)%a(2,2)=ug3_7812(i7,i8,i1,i2)%a(2,2)+
     & l3_12(i1,i2)%c(2,1)*p312q*ug312_78(i7,i8)%b(1,2)+l3_12(i1
     & ,i2)%a(2,2)*ug312_78(i7,i8)%a(2,2)
      ug3_7812(i7,i8,i1,i2)%b(2,2)=ug3_7812(i7,i8,i1,i2)%b(2,2)+
     & rmass(id3)*(l3_12(i1,i2)%b(2,1)*ug312_78(i7,i8)%b(1,2)+l3
     & _12(i1,i2)%d(2,2)*ug312_78(i7,i8)%a(2,2))
      ug3_7812(i7,i8,i1,i2)%c(2,2)=ug3_7812(i7,i8,i1,i2)%c(2,2)+
     & rmass(id3)*(l3_12(i1,i2)%c(2,1)*ug312_78(i7,i8)%c(1,2)+l3
     & _12(i1,i2)%a(2,2)*ug312_78(i7,i8)%d(2,2))
      ug3_7812(i7,i8,i1,i2)%d(2,2)=ug3_7812(i7,i8,i1,i2)%d(2,2)+
     & l3_12(i1,i2)%b(2,1)*ug312_78(i7,i8)%c(1,2)+l3_12(i1,i2)%d
     & (2,2)*p312q*ug312_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TTs -- aa=ug3_7812(i7,i8,i1,i2)%a,bb=ug3_7812(i7,i8,i1,i2)%b,cc=ug3_78
* 12(i7,i8,i1,i2)%c,dd=ug3_7812(i7,i8,i1,i2)%d,a1=lg3_78(i7,i8)%a,b1=lg3
* _78(i7,i8)%b,c1=lg3_78(i7,i8)%c,d1=lg3_78(i7,i8)%d,a2=u378_12(i1,i2)%a
* ,b2=u378_12(i1,i2)%b,c2=u378_12(i1,i2)%c,d2=u378_12(i1,i2)%d,prq=p378q
* ,m=rmass(id3),nsum=0
      do jut=1,2
      cx1=u378_12(i1,i2)%a(1,jut)+rmass(id3)*u378_12(i1,i2)%b(1,
     & jut)
      cx2=u378_12(i1,i2)%a(2,jut)+rmass(id3)*u378_12(i1,i2)%b(2,
     & jut)
      cy1=p378q*u378_12(i1,i2)%b(1,jut)+rmass(id3)*u378_12(i1,i2
     & )%a(1,jut)
      cy2=p378q*u378_12(i1,i2)%b(2,jut)+rmass(id3)*u378_12(i1,i2
     & )%a(2,jut)
      cw1=u378_12(i1,i2)%c(1,jut)+rmass(id3)*u378_12(i1,i2)%d(1,
     & jut)
      cw2=u378_12(i1,i2)%c(2,jut)+rmass(id3)*u378_12(i1,i2)%d(2,
     & jut)
      cz1=p378q*u378_12(i1,i2)%d(1,jut)+rmass(id3)*u378_12(i1,i2
     & )%c(1,jut)
      cz2=p378q*u378_12(i1,i2)%d(2,jut)+rmass(id3)*u378_12(i1,i2
     & )%c(2,jut)
      ug3_7812(i7,i8,i1,i2)%a(1,jut)=lg3_78(i7,i8)%a(1,1)*cx1+lg
     & 3_78(i7,i8)%c(1,2)*cy2
      ug3_7812(i7,i8,i1,i2)%b(1,jut)=lg3_78(i7,i8)%d(1,1)*cy1+lg
     & 3_78(i7,i8)%b(1,2)*cx2
      ug3_7812(i7,i8,i1,i2)%c(1,jut)=lg3_78(i7,i8)%a(1,1)*cw1+lg
     & 3_78(i7,i8)%c(1,2)*cz2
      ug3_7812(i7,i8,i1,i2)%d(1,jut)=lg3_78(i7,i8)%d(1,1)*cz1+lg
     & 3_78(i7,i8)%b(1,2)*cw2
      ug3_7812(i7,i8,i1,i2)%a(2,jut)=lg3_78(i7,i8)%c(2,1)*cy1+lg
     & 3_78(i7,i8)%a(2,2)*cx2
      ug3_7812(i7,i8,i1,i2)%b(2,jut)=lg3_78(i7,i8)%b(2,1)*cx1+lg
     & 3_78(i7,i8)%d(2,2)*cy2
      ug3_7812(i7,i8,i1,i2)%c(2,jut)=lg3_78(i7,i8)%c(2,1)*cz1+lg
     & 3_78(i7,i8)%a(2,2)*cw2
      ug3_7812(i7,i8,i1,i2)%d(2,jut)=lg3_78(i7,i8)%b(2,1)*cw1+lg
     & 3_78(i7,i8)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=ug3_7812(i7,i8,i1,i2)%a,bb=ug3_7812(i7,i8,i1,i2)%b,cc=ug3_78
* 12(i7,i8,i1,i2)%c,dd=ug3_7812(i7,i8,i1,i2)%d,a1=l3_12(i1,i2)%a,b1=l3_1
* 2(i1,i2)%b,c1=l3_12(i1,i2)%c,d1=l3_12(i1,i2)%d,a2=ug312_78(i7,i8)%a,b2
* =ug312_78(i7,i8)%b,c2=ug312_78(i7,i8)%c,d2=ug312_78(i7,i8)%d,prq=p312q
* ,m=rmass(id3),nsum=1
      do iut=1,2
      cx1=l3_12(i1,i2)%a(iut,1)+l3_12(i1,i2)%c(iut,1)*rmass(id3)
      cx2=l3_12(i1,i2)%c(iut,2)*p312q+l3_12(i1,i2)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_12(i1,i2)%b(iut,1)+l3_12(i1,i2)%d(iut,1)*rmass(id3)
      cy2=l3_12(i1,i2)%d(iut,2)*p312q+l3_12(i1,i2)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_12(i1,i2)%c(iut,1)*p312q+l3_12(i1,i2)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_12(i1,i2)%a(iut,2)+l3_12(i1,i2)%c(iut,2)*rmass(id3)
      cz1=l3_12(i1,i2)%d(iut,1)*p312q+l3_12(i1,i2)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_12(i1,i2)%b(iut,2)+l3_12(i1,i2)%d(iut,2)*rmass(id3)
      ug3_7812(i7,i8,i1,i2)%a(iut,1)=ug3_7812(i7,i8,i1,i2)%a(iut
     & ,1)+cx1*ug312_78(i7,i8)%a(1,1)+cx2*ug312_78(i7,i8)%b(2,1)
      ug3_7812(i7,i8,i1,i2)%b(iut,1)=ug3_7812(i7,i8,i1,i2)%b(iut
     & ,1)+cy1*ug312_78(i7,i8)%a(1,1)+cy2*ug312_78(i7,i8)%b(2,1)
      ug3_7812(i7,i8,i1,i2)%c(iut,1)=ug3_7812(i7,i8,i1,i2)%c(iut
     & ,1)+cw1*ug312_78(i7,i8)%d(1,1)+cw2*ug312_78(i7,i8)%c(2,1)
      ug3_7812(i7,i8,i1,i2)%d(iut,1)=ug3_7812(i7,i8,i1,i2)%d(iut
     & ,1)+cz1*ug312_78(i7,i8)%d(1,1)+cz2*ug312_78(i7,i8)%c(2,1)
      ug3_7812(i7,i8,i1,i2)%a(iut,2)=ug3_7812(i7,i8,i1,i2)%a(iut
     & ,2)+cw1*ug312_78(i7,i8)%b(1,2)+cw2*ug312_78(i7,i8)%a(2,2)
      ug3_7812(i7,i8,i1,i2)%b(iut,2)=ug3_7812(i7,i8,i1,i2)%b(iut
     & ,2)+cz1*ug312_78(i7,i8)%b(1,2)+cz2*ug312_78(i7,i8)%a(2,2)
      ug3_7812(i7,i8,i1,i2)%c(iut,2)=ug3_7812(i7,i8,i1,i2)%c(iut
     & ,2)+cx1*ug312_78(i7,i8)%c(1,2)+cx2*ug312_78(i7,i8)%d(2,2)
      ug3_7812(i7,i8,i1,i2)%d(iut,2)=ug3_7812(i7,i8,i1,i2)%d(iut
     & ,2)+cy1*ug312_78(i7,i8)%c(1,2)+cy2*ug312_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id3).ne.1 .and. ilept(id5).ne.1)then
        if(id3.ne.5 .or. id7.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=ug3_5678(i5,i6,i7,i8)%a,bb=ug3_5678(i5,i6,i7,i8)%b,cc=ug3_567
* 8(i5,i6,i7,i8)%c,dd=ug3_5678(i5,i6,i7,i8)%d,a1=lg3_56(i5,i6)%a,b1=lg3_
* 56(i5,i6)%b,c1=lg3_56(i5,i6)%c,d1=lg3_56(i5,i6)%d,a2=u356_78(i7,i8)%a,
* b2=u356_78(i7,i8)%b,c2=u356_78(i7,i8)%c,d2=u356_78(i7,i8)%d,prq=p356q,
* m=rmass(id3),nsum=0
      ug3_5678(i5,i6,i7,i8)%a(1,1)=lg3_56(i5,i6)%a(1,1)*u356_78(
     & i7,i8)%a(1,1)+lg3_56(i5,i6)%c(1,2)*p356q*u356_78(i7,i8)%b
     & (2,1)
      ug3_5678(i5,i6,i7,i8)%b(1,1)=rmass(id3)*(lg3_56(i5,i6)%d(1
     & ,1)*u356_78(i7,i8)%a(1,1)+lg3_56(i5,i6)%b(1,2)*u356_78(i7
     & ,i8)%b(2,1))
      ug3_5678(i5,i6,i7,i8)%c(1,1)=rmass(id3)*(lg3_56(i5,i6)%a(1
     & ,1)*u356_78(i7,i8)%d(1,1)+lg3_56(i5,i6)%c(1,2)*u356_78(i7
     & ,i8)%c(2,1))
      ug3_5678(i5,i6,i7,i8)%d(1,1)=lg3_56(i5,i6)%d(1,1)*p356q*u3
     & 56_78(i7,i8)%d(1,1)+lg3_56(i5,i6)%b(1,2)*u356_78(i7,i8)%c
     & (2,1)
      ug3_5678(i5,i6,i7,i8)%a(1,2)=rmass(id3)*(lg3_56(i5,i6)%a(1
     & ,1)*u356_78(i7,i8)%b(1,2)+lg3_56(i5,i6)%c(1,2)*u356_78(i7
     & ,i8)%a(2,2))
      ug3_5678(i5,i6,i7,i8)%b(1,2)=lg3_56(i5,i6)%d(1,1)*p356q*u3
     & 56_78(i7,i8)%b(1,2)+lg3_56(i5,i6)%b(1,2)*u356_78(i7,i8)%a
     & (2,2)
      ug3_5678(i5,i6,i7,i8)%c(1,2)=lg3_56(i5,i6)%a(1,1)*u356_78(
     & i7,i8)%c(1,2)+lg3_56(i5,i6)%c(1,2)*p356q*u356_78(i7,i8)%d
     & (2,2)
      ug3_5678(i5,i6,i7,i8)%d(1,2)=rmass(id3)*(lg3_56(i5,i6)%d(1
     & ,1)*u356_78(i7,i8)%c(1,2)+lg3_56(i5,i6)%b(1,2)*u356_78(i7
     & ,i8)%d(2,2))
      ug3_5678(i5,i6,i7,i8)%a(2,1)=rmass(id3)*(lg3_56(i5,i6)%c(2
     & ,1)*u356_78(i7,i8)%a(1,1)+lg3_56(i5,i6)%a(2,2)*u356_78(i7
     & ,i8)%b(2,1))
      ug3_5678(i5,i6,i7,i8)%b(2,1)=lg3_56(i5,i6)%b(2,1)*u356_78(
     & i7,i8)%a(1,1)+lg3_56(i5,i6)%d(2,2)*p356q*u356_78(i7,i8)%b
     & (2,1)
      ug3_5678(i5,i6,i7,i8)%c(2,1)=lg3_56(i5,i6)%c(2,1)*p356q*u3
     & 56_78(i7,i8)%d(1,1)+lg3_56(i5,i6)%a(2,2)*u356_78(i7,i8)%c
     & (2,1)
      ug3_5678(i5,i6,i7,i8)%d(2,1)=rmass(id3)*(lg3_56(i5,i6)%b(2
     & ,1)*u356_78(i7,i8)%d(1,1)+lg3_56(i5,i6)%d(2,2)*u356_78(i7
     & ,i8)%c(2,1))
      ug3_5678(i5,i6,i7,i8)%a(2,2)=lg3_56(i5,i6)%c(2,1)*p356q*u3
     & 56_78(i7,i8)%b(1,2)+lg3_56(i5,i6)%a(2,2)*u356_78(i7,i8)%a
     & (2,2)
      ug3_5678(i5,i6,i7,i8)%b(2,2)=rmass(id3)*(lg3_56(i5,i6)%b(2
     & ,1)*u356_78(i7,i8)%b(1,2)+lg3_56(i5,i6)%d(2,2)*u356_78(i7
     & ,i8)%a(2,2))
      ug3_5678(i5,i6,i7,i8)%c(2,2)=rmass(id3)*(lg3_56(i5,i6)%c(2
     & ,1)*u356_78(i7,i8)%c(1,2)+lg3_56(i5,i6)%a(2,2)*u356_78(i7
     & ,i8)%d(2,2))
      ug3_5678(i5,i6,i7,i8)%d(2,2)=lg3_56(i5,i6)%b(2,1)*u356_78(
     & i7,i8)%c(1,2)+lg3_56(i5,i6)%d(2,2)*p356q*u356_78(i7,i8)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=ug3_5678(i5,i6,i7,i8)%a,bb=ug3_5678(i5,i6,i7,i8)%b,cc=ug3_567
* 8(i5,i6,i7,i8)%c,dd=ug3_5678(i5,i6,i7,i8)%d,a1=l3_78(i7,i8)%a,b1=l3_78
* (i7,i8)%b,c1=l3_78(i7,i8)%c,d1=l3_78(i7,i8)%d,a2=ug378_56(i5,i6)%a,b2=
* ug378_56(i5,i6)%b,c2=ug378_56(i5,i6)%c,d2=ug378_56(i5,i6)%d,prq=p378q,
* m=rmass(id3),nsum=1
      ug3_5678(i5,i6,i7,i8)%a(1,1)=ug3_5678(i5,i6,i7,i8)%a(1,1)+
     & l3_78(i7,i8)%a(1,1)*ug378_56(i5,i6)%a(1,1)+l3_78(i7,i8)%c
     & (1,2)*p378q*ug378_56(i5,i6)%b(2,1)
      ug3_5678(i5,i6,i7,i8)%b(1,1)=ug3_5678(i5,i6,i7,i8)%b(1,1)+
     & rmass(id3)*(l3_78(i7,i8)%d(1,1)*ug378_56(i5,i6)%a(1,1)+l3
     & _78(i7,i8)%b(1,2)*ug378_56(i5,i6)%b(2,1))
      ug3_5678(i5,i6,i7,i8)%c(1,1)=ug3_5678(i5,i6,i7,i8)%c(1,1)+
     & rmass(id3)*(l3_78(i7,i8)%a(1,1)*ug378_56(i5,i6)%d(1,1)+l3
     & _78(i7,i8)%c(1,2)*ug378_56(i5,i6)%c(2,1))
      ug3_5678(i5,i6,i7,i8)%d(1,1)=ug3_5678(i5,i6,i7,i8)%d(1,1)+
     & l3_78(i7,i8)%d(1,1)*p378q*ug378_56(i5,i6)%d(1,1)+l3_78(i7
     & ,i8)%b(1,2)*ug378_56(i5,i6)%c(2,1)
      ug3_5678(i5,i6,i7,i8)%a(1,2)=ug3_5678(i5,i6,i7,i8)%a(1,2)+
     & rmass(id3)*(l3_78(i7,i8)%a(1,1)*ug378_56(i5,i6)%b(1,2)+l3
     & _78(i7,i8)%c(1,2)*ug378_56(i5,i6)%a(2,2))
      ug3_5678(i5,i6,i7,i8)%b(1,2)=ug3_5678(i5,i6,i7,i8)%b(1,2)+
     & l3_78(i7,i8)%d(1,1)*p378q*ug378_56(i5,i6)%b(1,2)+l3_78(i7
     & ,i8)%b(1,2)*ug378_56(i5,i6)%a(2,2)
      ug3_5678(i5,i6,i7,i8)%c(1,2)=ug3_5678(i5,i6,i7,i8)%c(1,2)+
     & l3_78(i7,i8)%a(1,1)*ug378_56(i5,i6)%c(1,2)+l3_78(i7,i8)%c
     & (1,2)*p378q*ug378_56(i5,i6)%d(2,2)
      ug3_5678(i5,i6,i7,i8)%d(1,2)=ug3_5678(i5,i6,i7,i8)%d(1,2)+
     & rmass(id3)*(l3_78(i7,i8)%d(1,1)*ug378_56(i5,i6)%c(1,2)+l3
     & _78(i7,i8)%b(1,2)*ug378_56(i5,i6)%d(2,2))
      ug3_5678(i5,i6,i7,i8)%a(2,1)=ug3_5678(i5,i6,i7,i8)%a(2,1)+
     & rmass(id3)*(l3_78(i7,i8)%c(2,1)*ug378_56(i5,i6)%a(1,1)+l3
     & _78(i7,i8)%a(2,2)*ug378_56(i5,i6)%b(2,1))
      ug3_5678(i5,i6,i7,i8)%b(2,1)=ug3_5678(i5,i6,i7,i8)%b(2,1)+
     & l3_78(i7,i8)%b(2,1)*ug378_56(i5,i6)%a(1,1)+l3_78(i7,i8)%d
     & (2,2)*p378q*ug378_56(i5,i6)%b(2,1)
      ug3_5678(i5,i6,i7,i8)%c(2,1)=ug3_5678(i5,i6,i7,i8)%c(2,1)+
     & l3_78(i7,i8)%c(2,1)*p378q*ug378_56(i5,i6)%d(1,1)+l3_78(i7
     & ,i8)%a(2,2)*ug378_56(i5,i6)%c(2,1)
      ug3_5678(i5,i6,i7,i8)%d(2,1)=ug3_5678(i5,i6,i7,i8)%d(2,1)+
     & rmass(id3)*(l3_78(i7,i8)%b(2,1)*ug378_56(i5,i6)%d(1,1)+l3
     & _78(i7,i8)%d(2,2)*ug378_56(i5,i6)%c(2,1))
      ug3_5678(i5,i6,i7,i8)%a(2,2)=ug3_5678(i5,i6,i7,i8)%a(2,2)+
     & l3_78(i7,i8)%c(2,1)*p378q*ug378_56(i5,i6)%b(1,2)+l3_78(i7
     & ,i8)%a(2,2)*ug378_56(i5,i6)%a(2,2)
      ug3_5678(i5,i6,i7,i8)%b(2,2)=ug3_5678(i5,i6,i7,i8)%b(2,2)+
     & rmass(id3)*(l3_78(i7,i8)%b(2,1)*ug378_56(i5,i6)%b(1,2)+l3
     & _78(i7,i8)%d(2,2)*ug378_56(i5,i6)%a(2,2))
      ug3_5678(i5,i6,i7,i8)%c(2,2)=ug3_5678(i5,i6,i7,i8)%c(2,2)+
     & rmass(id3)*(l3_78(i7,i8)%c(2,1)*ug378_56(i5,i6)%c(1,2)+l3
     & _78(i7,i8)%a(2,2)*ug378_56(i5,i6)%d(2,2))
      ug3_5678(i5,i6,i7,i8)%d(2,2)=ug3_5678(i5,i6,i7,i8)%d(2,2)+
     & l3_78(i7,i8)%b(2,1)*ug378_56(i5,i6)%c(1,2)+l3_78(i7,i8)%d
     & (2,2)*p378q*ug378_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=ug3_5678(i5,i6,i7,i8)%a,bb=ug3_5678(i5,i6,i7,i8)%b,cc=ug3_56
* 78(i5,i6,i7,i8)%c,dd=ug3_5678(i5,i6,i7,i8)%d,a1=lg3_56(i5,i6)%a,b1=lg3
* _56(i5,i6)%b,c1=lg3_56(i5,i6)%c,d1=lg3_56(i5,i6)%d,a2=u356_78(i7,i8)%a
* ,b2=u356_78(i7,i8)%b,c2=u356_78(i7,i8)%c,d2=u356_78(i7,i8)%d,prq=p356q
* ,m=rmass(id3),nsum=0
      do jut=1,2
      cx1=u356_78(i7,i8)%a(1,jut)+rmass(id3)*u356_78(i7,i8)%b(1,
     & jut)
      cx2=u356_78(i7,i8)%a(2,jut)+rmass(id3)*u356_78(i7,i8)%b(2,
     & jut)
      cy1=p356q*u356_78(i7,i8)%b(1,jut)+rmass(id3)*u356_78(i7,i8
     & )%a(1,jut)
      cy2=p356q*u356_78(i7,i8)%b(2,jut)+rmass(id3)*u356_78(i7,i8
     & )%a(2,jut)
      cw1=u356_78(i7,i8)%c(1,jut)+rmass(id3)*u356_78(i7,i8)%d(1,
     & jut)
      cw2=u356_78(i7,i8)%c(2,jut)+rmass(id3)*u356_78(i7,i8)%d(2,
     & jut)
      cz1=p356q*u356_78(i7,i8)%d(1,jut)+rmass(id3)*u356_78(i7,i8
     & )%c(1,jut)
      cz2=p356q*u356_78(i7,i8)%d(2,jut)+rmass(id3)*u356_78(i7,i8
     & )%c(2,jut)
      ug3_5678(i5,i6,i7,i8)%a(1,jut)=lg3_56(i5,i6)%a(1,1)*cx1+lg
     & 3_56(i5,i6)%c(1,2)*cy2
      ug3_5678(i5,i6,i7,i8)%b(1,jut)=lg3_56(i5,i6)%d(1,1)*cy1+lg
     & 3_56(i5,i6)%b(1,2)*cx2
      ug3_5678(i5,i6,i7,i8)%c(1,jut)=lg3_56(i5,i6)%a(1,1)*cw1+lg
     & 3_56(i5,i6)%c(1,2)*cz2
      ug3_5678(i5,i6,i7,i8)%d(1,jut)=lg3_56(i5,i6)%d(1,1)*cz1+lg
     & 3_56(i5,i6)%b(1,2)*cw2
      ug3_5678(i5,i6,i7,i8)%a(2,jut)=lg3_56(i5,i6)%c(2,1)*cy1+lg
     & 3_56(i5,i6)%a(2,2)*cx2
      ug3_5678(i5,i6,i7,i8)%b(2,jut)=lg3_56(i5,i6)%b(2,1)*cx1+lg
     & 3_56(i5,i6)%d(2,2)*cy2
      ug3_5678(i5,i6,i7,i8)%c(2,jut)=lg3_56(i5,i6)%c(2,1)*cz1+lg
     & 3_56(i5,i6)%a(2,2)*cw2
      ug3_5678(i5,i6,i7,i8)%d(2,jut)=lg3_56(i5,i6)%b(2,1)*cw1+lg
     & 3_56(i5,i6)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=ug3_5678(i5,i6,i7,i8)%a,bb=ug3_5678(i5,i6,i7,i8)%b,cc=ug3_56
* 78(i5,i6,i7,i8)%c,dd=ug3_5678(i5,i6,i7,i8)%d,a1=l3_78(i7,i8)%a,b1=l3_7
* 8(i7,i8)%b,c1=l3_78(i7,i8)%c,d1=l3_78(i7,i8)%d,a2=ug378_56(i5,i6)%a,b2
* =ug378_56(i5,i6)%b,c2=ug378_56(i5,i6)%c,d2=ug378_56(i5,i6)%d,prq=p378q
* ,m=rmass(id3),nsum=1
      do iut=1,2
      cx1=l3_78(i7,i8)%a(iut,1)+l3_78(i7,i8)%c(iut,1)*rmass(id3)
      cx2=l3_78(i7,i8)%c(iut,2)*p378q+l3_78(i7,i8)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_78(i7,i8)%b(iut,1)+l3_78(i7,i8)%d(iut,1)*rmass(id3)
      cy2=l3_78(i7,i8)%d(iut,2)*p378q+l3_78(i7,i8)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_78(i7,i8)%c(iut,1)*p378q+l3_78(i7,i8)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_78(i7,i8)%a(iut,2)+l3_78(i7,i8)%c(iut,2)*rmass(id3)
      cz1=l3_78(i7,i8)%d(iut,1)*p378q+l3_78(i7,i8)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_78(i7,i8)%b(iut,2)+l3_78(i7,i8)%d(iut,2)*rmass(id3)
      ug3_5678(i5,i6,i7,i8)%a(iut,1)=ug3_5678(i5,i6,i7,i8)%a(iut
     & ,1)+cx1*ug378_56(i5,i6)%a(1,1)+cx2*ug378_56(i5,i6)%b(2,1)
      ug3_5678(i5,i6,i7,i8)%b(iut,1)=ug3_5678(i5,i6,i7,i8)%b(iut
     & ,1)+cy1*ug378_56(i5,i6)%a(1,1)+cy2*ug378_56(i5,i6)%b(2,1)
      ug3_5678(i5,i6,i7,i8)%c(iut,1)=ug3_5678(i5,i6,i7,i8)%c(iut
     & ,1)+cw1*ug378_56(i5,i6)%d(1,1)+cw2*ug378_56(i5,i6)%c(2,1)
      ug3_5678(i5,i6,i7,i8)%d(iut,1)=ug3_5678(i5,i6,i7,i8)%d(iut
     & ,1)+cz1*ug378_56(i5,i6)%d(1,1)+cz2*ug378_56(i5,i6)%c(2,1)
      ug3_5678(i5,i6,i7,i8)%a(iut,2)=ug3_5678(i5,i6,i7,i8)%a(iut
     & ,2)+cw1*ug378_56(i5,i6)%b(1,2)+cw2*ug378_56(i5,i6)%a(2,2)
      ug3_5678(i5,i6,i7,i8)%b(iut,2)=ug3_5678(i5,i6,i7,i8)%b(iut
     & ,2)+cz1*ug378_56(i5,i6)%b(1,2)+cz2*ug378_56(i5,i6)%a(2,2)
      ug3_5678(i5,i6,i7,i8)%c(iut,2)=ug3_5678(i5,i6,i7,i8)%c(iut
     & ,2)+cx1*ug378_56(i5,i6)%c(1,2)+cx2*ug378_56(i5,i6)%d(2,2)
      ug3_5678(i5,i6,i7,i8)%d(iut,2)=ug3_5678(i5,i6,i7,i8)%d(iut
     & ,2)+cy1*ug378_56(i5,i6)%c(1,2)+cy2*ug378_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id3).ne.1 .and. ilept(id7).ne.1)then
        if(id3.ne.5 .or. id5.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=ug3_7856(i7,i8,i5,i6)%a,bb=ug3_7856(i7,i8,i5,i6)%b,cc=ug3_785
* 6(i7,i8,i5,i6)%c,dd=ug3_7856(i7,i8,i5,i6)%d,a1=lg3_78(i7,i8)%a,b1=lg3_
* 78(i7,i8)%b,c1=lg3_78(i7,i8)%c,d1=lg3_78(i7,i8)%d,a2=u378_56(i5,i6)%a,
* b2=u378_56(i5,i6)%b,c2=u378_56(i5,i6)%c,d2=u378_56(i5,i6)%d,prq=p378q,
* m=rmass(id3),nsum=0
      ug3_7856(i7,i8,i5,i6)%a(1,1)=lg3_78(i7,i8)%a(1,1)*u378_56(
     & i5,i6)%a(1,1)+lg3_78(i7,i8)%c(1,2)*p378q*u378_56(i5,i6)%b
     & (2,1)
      ug3_7856(i7,i8,i5,i6)%b(1,1)=rmass(id3)*(lg3_78(i7,i8)%d(1
     & ,1)*u378_56(i5,i6)%a(1,1)+lg3_78(i7,i8)%b(1,2)*u378_56(i5
     & ,i6)%b(2,1))
      ug3_7856(i7,i8,i5,i6)%c(1,1)=rmass(id3)*(lg3_78(i7,i8)%a(1
     & ,1)*u378_56(i5,i6)%d(1,1)+lg3_78(i7,i8)%c(1,2)*u378_56(i5
     & ,i6)%c(2,1))
      ug3_7856(i7,i8,i5,i6)%d(1,1)=lg3_78(i7,i8)%d(1,1)*p378q*u3
     & 78_56(i5,i6)%d(1,1)+lg3_78(i7,i8)%b(1,2)*u378_56(i5,i6)%c
     & (2,1)
      ug3_7856(i7,i8,i5,i6)%a(1,2)=rmass(id3)*(lg3_78(i7,i8)%a(1
     & ,1)*u378_56(i5,i6)%b(1,2)+lg3_78(i7,i8)%c(1,2)*u378_56(i5
     & ,i6)%a(2,2))
      ug3_7856(i7,i8,i5,i6)%b(1,2)=lg3_78(i7,i8)%d(1,1)*p378q*u3
     & 78_56(i5,i6)%b(1,2)+lg3_78(i7,i8)%b(1,2)*u378_56(i5,i6)%a
     & (2,2)
      ug3_7856(i7,i8,i5,i6)%c(1,2)=lg3_78(i7,i8)%a(1,1)*u378_56(
     & i5,i6)%c(1,2)+lg3_78(i7,i8)%c(1,2)*p378q*u378_56(i5,i6)%d
     & (2,2)
      ug3_7856(i7,i8,i5,i6)%d(1,2)=rmass(id3)*(lg3_78(i7,i8)%d(1
     & ,1)*u378_56(i5,i6)%c(1,2)+lg3_78(i7,i8)%b(1,2)*u378_56(i5
     & ,i6)%d(2,2))
      ug3_7856(i7,i8,i5,i6)%a(2,1)=rmass(id3)*(lg3_78(i7,i8)%c(2
     & ,1)*u378_56(i5,i6)%a(1,1)+lg3_78(i7,i8)%a(2,2)*u378_56(i5
     & ,i6)%b(2,1))
      ug3_7856(i7,i8,i5,i6)%b(2,1)=lg3_78(i7,i8)%b(2,1)*u378_56(
     & i5,i6)%a(1,1)+lg3_78(i7,i8)%d(2,2)*p378q*u378_56(i5,i6)%b
     & (2,1)
      ug3_7856(i7,i8,i5,i6)%c(2,1)=lg3_78(i7,i8)%c(2,1)*p378q*u3
     & 78_56(i5,i6)%d(1,1)+lg3_78(i7,i8)%a(2,2)*u378_56(i5,i6)%c
     & (2,1)
      ug3_7856(i7,i8,i5,i6)%d(2,1)=rmass(id3)*(lg3_78(i7,i8)%b(2
     & ,1)*u378_56(i5,i6)%d(1,1)+lg3_78(i7,i8)%d(2,2)*u378_56(i5
     & ,i6)%c(2,1))
      ug3_7856(i7,i8,i5,i6)%a(2,2)=lg3_78(i7,i8)%c(2,1)*p378q*u3
     & 78_56(i5,i6)%b(1,2)+lg3_78(i7,i8)%a(2,2)*u378_56(i5,i6)%a
     & (2,2)
      ug3_7856(i7,i8,i5,i6)%b(2,2)=rmass(id3)*(lg3_78(i7,i8)%b(2
     & ,1)*u378_56(i5,i6)%b(1,2)+lg3_78(i7,i8)%d(2,2)*u378_56(i5
     & ,i6)%a(2,2))
      ug3_7856(i7,i8,i5,i6)%c(2,2)=rmass(id3)*(lg3_78(i7,i8)%c(2
     & ,1)*u378_56(i5,i6)%c(1,2)+lg3_78(i7,i8)%a(2,2)*u378_56(i5
     & ,i6)%d(2,2))
      ug3_7856(i7,i8,i5,i6)%d(2,2)=lg3_78(i7,i8)%b(2,1)*u378_56(
     & i5,i6)%c(1,2)+lg3_78(i7,i8)%d(2,2)*p378q*u378_56(i5,i6)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=ug3_7856(i7,i8,i5,i6)%a,bb=ug3_7856(i7,i8,i5,i6)%b,cc=ug3_785
* 6(i7,i8,i5,i6)%c,dd=ug3_7856(i7,i8,i5,i6)%d,a1=l3_56(i5,i6)%a,b1=l3_56
* (i5,i6)%b,c1=l3_56(i5,i6)%c,d1=l3_56(i5,i6)%d,a2=ug356_78(i7,i8)%a,b2=
* ug356_78(i7,i8)%b,c2=ug356_78(i7,i8)%c,d2=ug356_78(i7,i8)%d,prq=p356q,
* m=rmass(id3),nsum=1
      ug3_7856(i7,i8,i5,i6)%a(1,1)=ug3_7856(i7,i8,i5,i6)%a(1,1)+
     & l3_56(i5,i6)%a(1,1)*ug356_78(i7,i8)%a(1,1)+l3_56(i5,i6)%c
     & (1,2)*p356q*ug356_78(i7,i8)%b(2,1)
      ug3_7856(i7,i8,i5,i6)%b(1,1)=ug3_7856(i7,i8,i5,i6)%b(1,1)+
     & rmass(id3)*(l3_56(i5,i6)%d(1,1)*ug356_78(i7,i8)%a(1,1)+l3
     & _56(i5,i6)%b(1,2)*ug356_78(i7,i8)%b(2,1))
      ug3_7856(i7,i8,i5,i6)%c(1,1)=ug3_7856(i7,i8,i5,i6)%c(1,1)+
     & rmass(id3)*(l3_56(i5,i6)%a(1,1)*ug356_78(i7,i8)%d(1,1)+l3
     & _56(i5,i6)%c(1,2)*ug356_78(i7,i8)%c(2,1))
      ug3_7856(i7,i8,i5,i6)%d(1,1)=ug3_7856(i7,i8,i5,i6)%d(1,1)+
     & l3_56(i5,i6)%d(1,1)*p356q*ug356_78(i7,i8)%d(1,1)+l3_56(i5
     & ,i6)%b(1,2)*ug356_78(i7,i8)%c(2,1)
      ug3_7856(i7,i8,i5,i6)%a(1,2)=ug3_7856(i7,i8,i5,i6)%a(1,2)+
     & rmass(id3)*(l3_56(i5,i6)%a(1,1)*ug356_78(i7,i8)%b(1,2)+l3
     & _56(i5,i6)%c(1,2)*ug356_78(i7,i8)%a(2,2))
      ug3_7856(i7,i8,i5,i6)%b(1,2)=ug3_7856(i7,i8,i5,i6)%b(1,2)+
     & l3_56(i5,i6)%d(1,1)*p356q*ug356_78(i7,i8)%b(1,2)+l3_56(i5
     & ,i6)%b(1,2)*ug356_78(i7,i8)%a(2,2)
      ug3_7856(i7,i8,i5,i6)%c(1,2)=ug3_7856(i7,i8,i5,i6)%c(1,2)+
     & l3_56(i5,i6)%a(1,1)*ug356_78(i7,i8)%c(1,2)+l3_56(i5,i6)%c
     & (1,2)*p356q*ug356_78(i7,i8)%d(2,2)
      ug3_7856(i7,i8,i5,i6)%d(1,2)=ug3_7856(i7,i8,i5,i6)%d(1,2)+
     & rmass(id3)*(l3_56(i5,i6)%d(1,1)*ug356_78(i7,i8)%c(1,2)+l3
     & _56(i5,i6)%b(1,2)*ug356_78(i7,i8)%d(2,2))
      ug3_7856(i7,i8,i5,i6)%a(2,1)=ug3_7856(i7,i8,i5,i6)%a(2,1)+
     & rmass(id3)*(l3_56(i5,i6)%c(2,1)*ug356_78(i7,i8)%a(1,1)+l3
     & _56(i5,i6)%a(2,2)*ug356_78(i7,i8)%b(2,1))
      ug3_7856(i7,i8,i5,i6)%b(2,1)=ug3_7856(i7,i8,i5,i6)%b(2,1)+
     & l3_56(i5,i6)%b(2,1)*ug356_78(i7,i8)%a(1,1)+l3_56(i5,i6)%d
     & (2,2)*p356q*ug356_78(i7,i8)%b(2,1)
      ug3_7856(i7,i8,i5,i6)%c(2,1)=ug3_7856(i7,i8,i5,i6)%c(2,1)+
     & l3_56(i5,i6)%c(2,1)*p356q*ug356_78(i7,i8)%d(1,1)+l3_56(i5
     & ,i6)%a(2,2)*ug356_78(i7,i8)%c(2,1)
      ug3_7856(i7,i8,i5,i6)%d(2,1)=ug3_7856(i7,i8,i5,i6)%d(2,1)+
     & rmass(id3)*(l3_56(i5,i6)%b(2,1)*ug356_78(i7,i8)%d(1,1)+l3
     & _56(i5,i6)%d(2,2)*ug356_78(i7,i8)%c(2,1))
      ug3_7856(i7,i8,i5,i6)%a(2,2)=ug3_7856(i7,i8,i5,i6)%a(2,2)+
     & l3_56(i5,i6)%c(2,1)*p356q*ug356_78(i7,i8)%b(1,2)+l3_56(i5
     & ,i6)%a(2,2)*ug356_78(i7,i8)%a(2,2)
      ug3_7856(i7,i8,i5,i6)%b(2,2)=ug3_7856(i7,i8,i5,i6)%b(2,2)+
     & rmass(id3)*(l3_56(i5,i6)%b(2,1)*ug356_78(i7,i8)%b(1,2)+l3
     & _56(i5,i6)%d(2,2)*ug356_78(i7,i8)%a(2,2))
      ug3_7856(i7,i8,i5,i6)%c(2,2)=ug3_7856(i7,i8,i5,i6)%c(2,2)+
     & rmass(id3)*(l3_56(i5,i6)%c(2,1)*ug356_78(i7,i8)%c(1,2)+l3
     & _56(i5,i6)%a(2,2)*ug356_78(i7,i8)%d(2,2))
      ug3_7856(i7,i8,i5,i6)%d(2,2)=ug3_7856(i7,i8,i5,i6)%d(2,2)+
     & l3_56(i5,i6)%b(2,1)*ug356_78(i7,i8)%c(1,2)+l3_56(i5,i6)%d
     & (2,2)*p356q*ug356_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TTs -- aa=ug3_7856(i7,i8,i5,i6)%a,bb=ug3_7856(i7,i8,i5,i6)%b,cc=ug3_78
* 56(i7,i8,i5,i6)%c,dd=ug3_7856(i7,i8,i5,i6)%d,a1=lg3_78(i7,i8)%a,b1=lg3
* _78(i7,i8)%b,c1=lg3_78(i7,i8)%c,d1=lg3_78(i7,i8)%d,a2=u378_56(i5,i6)%a
* ,b2=u378_56(i5,i6)%b,c2=u378_56(i5,i6)%c,d2=u378_56(i5,i6)%d,prq=p378q
* ,m=rmass(id3),nsum=0
      do jut=1,2
      cx1=u378_56(i5,i6)%a(1,jut)+rmass(id3)*u378_56(i5,i6)%b(1,
     & jut)
      cx2=u378_56(i5,i6)%a(2,jut)+rmass(id3)*u378_56(i5,i6)%b(2,
     & jut)
      cy1=p378q*u378_56(i5,i6)%b(1,jut)+rmass(id3)*u378_56(i5,i6
     & )%a(1,jut)
      cy2=p378q*u378_56(i5,i6)%b(2,jut)+rmass(id3)*u378_56(i5,i6
     & )%a(2,jut)
      cw1=u378_56(i5,i6)%c(1,jut)+rmass(id3)*u378_56(i5,i6)%d(1,
     & jut)
      cw2=u378_56(i5,i6)%c(2,jut)+rmass(id3)*u378_56(i5,i6)%d(2,
     & jut)
      cz1=p378q*u378_56(i5,i6)%d(1,jut)+rmass(id3)*u378_56(i5,i6
     & )%c(1,jut)
      cz2=p378q*u378_56(i5,i6)%d(2,jut)+rmass(id3)*u378_56(i5,i6
     & )%c(2,jut)
      ug3_7856(i7,i8,i5,i6)%a(1,jut)=lg3_78(i7,i8)%a(1,1)*cx1+lg
     & 3_78(i7,i8)%c(1,2)*cy2
      ug3_7856(i7,i8,i5,i6)%b(1,jut)=lg3_78(i7,i8)%d(1,1)*cy1+lg
     & 3_78(i7,i8)%b(1,2)*cx2
      ug3_7856(i7,i8,i5,i6)%c(1,jut)=lg3_78(i7,i8)%a(1,1)*cw1+lg
     & 3_78(i7,i8)%c(1,2)*cz2
      ug3_7856(i7,i8,i5,i6)%d(1,jut)=lg3_78(i7,i8)%d(1,1)*cz1+lg
     & 3_78(i7,i8)%b(1,2)*cw2
      ug3_7856(i7,i8,i5,i6)%a(2,jut)=lg3_78(i7,i8)%c(2,1)*cy1+lg
     & 3_78(i7,i8)%a(2,2)*cx2
      ug3_7856(i7,i8,i5,i6)%b(2,jut)=lg3_78(i7,i8)%b(2,1)*cx1+lg
     & 3_78(i7,i8)%d(2,2)*cy2
      ug3_7856(i7,i8,i5,i6)%c(2,jut)=lg3_78(i7,i8)%c(2,1)*cz1+lg
     & 3_78(i7,i8)%a(2,2)*cw2
      ug3_7856(i7,i8,i5,i6)%d(2,jut)=lg3_78(i7,i8)%b(2,1)*cw1+lg
     & 3_78(i7,i8)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=ug3_7856(i7,i8,i5,i6)%a,bb=ug3_7856(i7,i8,i5,i6)%b,cc=ug3_78
* 56(i7,i8,i5,i6)%c,dd=ug3_7856(i7,i8,i5,i6)%d,a1=l3_56(i5,i6)%a,b1=l3_5
* 6(i5,i6)%b,c1=l3_56(i5,i6)%c,d1=l3_56(i5,i6)%d,a2=ug356_78(i7,i8)%a,b2
* =ug356_78(i7,i8)%b,c2=ug356_78(i7,i8)%c,d2=ug356_78(i7,i8)%d,prq=p356q
* ,m=rmass(id3),nsum=1
      do iut=1,2
      cx1=l3_56(i5,i6)%a(iut,1)+l3_56(i5,i6)%c(iut,1)*rmass(id3)
      cx2=l3_56(i5,i6)%c(iut,2)*p356q+l3_56(i5,i6)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_56(i5,i6)%b(iut,1)+l3_56(i5,i6)%d(iut,1)*rmass(id3)
      cy2=l3_56(i5,i6)%d(iut,2)*p356q+l3_56(i5,i6)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_56(i5,i6)%c(iut,1)*p356q+l3_56(i5,i6)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_56(i5,i6)%a(iut,2)+l3_56(i5,i6)%c(iut,2)*rmass(id3)
      cz1=l3_56(i5,i6)%d(iut,1)*p356q+l3_56(i5,i6)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_56(i5,i6)%b(iut,2)+l3_56(i5,i6)%d(iut,2)*rmass(id3)
      ug3_7856(i7,i8,i5,i6)%a(iut,1)=ug3_7856(i7,i8,i5,i6)%a(iut
     & ,1)+cx1*ug356_78(i7,i8)%a(1,1)+cx2*ug356_78(i7,i8)%b(2,1)
      ug3_7856(i7,i8,i5,i6)%b(iut,1)=ug3_7856(i7,i8,i5,i6)%b(iut
     & ,1)+cy1*ug356_78(i7,i8)%a(1,1)+cy2*ug356_78(i7,i8)%b(2,1)
      ug3_7856(i7,i8,i5,i6)%c(iut,1)=ug3_7856(i7,i8,i5,i6)%c(iut
     & ,1)+cw1*ug356_78(i7,i8)%d(1,1)+cw2*ug356_78(i7,i8)%c(2,1)
      ug3_7856(i7,i8,i5,i6)%d(iut,1)=ug3_7856(i7,i8,i5,i6)%d(iut
     & ,1)+cz1*ug356_78(i7,i8)%d(1,1)+cz2*ug356_78(i7,i8)%c(2,1)
      ug3_7856(i7,i8,i5,i6)%a(iut,2)=ug3_7856(i7,i8,i5,i6)%a(iut
     & ,2)+cw1*ug356_78(i7,i8)%b(1,2)+cw2*ug356_78(i7,i8)%a(2,2)
      ug3_7856(i7,i8,i5,i6)%b(iut,2)=ug3_7856(i7,i8,i5,i6)%b(iut
     & ,2)+cz1*ug356_78(i7,i8)%b(1,2)+cz2*ug356_78(i7,i8)%a(2,2)
      ug3_7856(i7,i8,i5,i6)%c(iut,2)=ug3_7856(i7,i8,i5,i6)%c(iut
     & ,2)+cx1*ug356_78(i7,i8)%c(1,2)+cx2*ug356_78(i7,i8)%d(2,2)
      ug3_7856(i7,i8,i5,i6)%d(iut,2)=ug3_7856(i7,i8,i5,i6)%d(iut
     & ,2)+cy1*ug356_78(i7,i8)%c(1,2)+cy2*ug356_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id5).ne.1 .and. ilept(id1).ne.1)then
        if(id5.ne.5 .or. id3.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=ug5_1234(i1,i2,i3,i4)%a,bb=ug5_1234(i1,i2,i3,i4)%b,cc=ug5_123
* 4(i1,i2,i3,i4)%c,dd=ug5_1234(i1,i2,i3,i4)%d,a1=lg5_12(i1,i2)%a,b1=lg5_
* 12(i1,i2)%b,c1=lg5_12(i1,i2)%c,d1=lg5_12(i1,i2)%d,a2=u512_34(i3,i4)%a,
* b2=u512_34(i3,i4)%b,c2=u512_34(i3,i4)%c,d2=u512_34(i3,i4)%d,prq=p512q,
* m=rmass(id5),nsum=0
      ug5_1234(i1,i2,i3,i4)%a(1,1)=lg5_12(i1,i2)%a(1,1)*u512_34(
     & i3,i4)%a(1,1)+lg5_12(i1,i2)%c(1,2)*p512q*u512_34(i3,i4)%b
     & (2,1)
      ug5_1234(i1,i2,i3,i4)%b(1,1)=rmass(id5)*(lg5_12(i1,i2)%d(1
     & ,1)*u512_34(i3,i4)%a(1,1)+lg5_12(i1,i2)%b(1,2)*u512_34(i3
     & ,i4)%b(2,1))
      ug5_1234(i1,i2,i3,i4)%c(1,1)=rmass(id5)*(lg5_12(i1,i2)%a(1
     & ,1)*u512_34(i3,i4)%d(1,1)+lg5_12(i1,i2)%c(1,2)*u512_34(i3
     & ,i4)%c(2,1))
      ug5_1234(i1,i2,i3,i4)%d(1,1)=lg5_12(i1,i2)%d(1,1)*p512q*u5
     & 12_34(i3,i4)%d(1,1)+lg5_12(i1,i2)%b(1,2)*u512_34(i3,i4)%c
     & (2,1)
      ug5_1234(i1,i2,i3,i4)%a(1,2)=rmass(id5)*(lg5_12(i1,i2)%a(1
     & ,1)*u512_34(i3,i4)%b(1,2)+lg5_12(i1,i2)%c(1,2)*u512_34(i3
     & ,i4)%a(2,2))
      ug5_1234(i1,i2,i3,i4)%b(1,2)=lg5_12(i1,i2)%d(1,1)*p512q*u5
     & 12_34(i3,i4)%b(1,2)+lg5_12(i1,i2)%b(1,2)*u512_34(i3,i4)%a
     & (2,2)
      ug5_1234(i1,i2,i3,i4)%c(1,2)=lg5_12(i1,i2)%a(1,1)*u512_34(
     & i3,i4)%c(1,2)+lg5_12(i1,i2)%c(1,2)*p512q*u512_34(i3,i4)%d
     & (2,2)
      ug5_1234(i1,i2,i3,i4)%d(1,2)=rmass(id5)*(lg5_12(i1,i2)%d(1
     & ,1)*u512_34(i3,i4)%c(1,2)+lg5_12(i1,i2)%b(1,2)*u512_34(i3
     & ,i4)%d(2,2))
      ug5_1234(i1,i2,i3,i4)%a(2,1)=rmass(id5)*(lg5_12(i1,i2)%c(2
     & ,1)*u512_34(i3,i4)%a(1,1)+lg5_12(i1,i2)%a(2,2)*u512_34(i3
     & ,i4)%b(2,1))
      ug5_1234(i1,i2,i3,i4)%b(2,1)=lg5_12(i1,i2)%b(2,1)*u512_34(
     & i3,i4)%a(1,1)+lg5_12(i1,i2)%d(2,2)*p512q*u512_34(i3,i4)%b
     & (2,1)
      ug5_1234(i1,i2,i3,i4)%c(2,1)=lg5_12(i1,i2)%c(2,1)*p512q*u5
     & 12_34(i3,i4)%d(1,1)+lg5_12(i1,i2)%a(2,2)*u512_34(i3,i4)%c
     & (2,1)
      ug5_1234(i1,i2,i3,i4)%d(2,1)=rmass(id5)*(lg5_12(i1,i2)%b(2
     & ,1)*u512_34(i3,i4)%d(1,1)+lg5_12(i1,i2)%d(2,2)*u512_34(i3
     & ,i4)%c(2,1))
      ug5_1234(i1,i2,i3,i4)%a(2,2)=lg5_12(i1,i2)%c(2,1)*p512q*u5
     & 12_34(i3,i4)%b(1,2)+lg5_12(i1,i2)%a(2,2)*u512_34(i3,i4)%a
     & (2,2)
      ug5_1234(i1,i2,i3,i4)%b(2,2)=rmass(id5)*(lg5_12(i1,i2)%b(2
     & ,1)*u512_34(i3,i4)%b(1,2)+lg5_12(i1,i2)%d(2,2)*u512_34(i3
     & ,i4)%a(2,2))
      ug5_1234(i1,i2,i3,i4)%c(2,2)=rmass(id5)*(lg5_12(i1,i2)%c(2
     & ,1)*u512_34(i3,i4)%c(1,2)+lg5_12(i1,i2)%a(2,2)*u512_34(i3
     & ,i4)%d(2,2))
      ug5_1234(i1,i2,i3,i4)%d(2,2)=lg5_12(i1,i2)%b(2,1)*u512_34(
     & i3,i4)%c(1,2)+lg5_12(i1,i2)%d(2,2)*p512q*u512_34(i3,i4)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=ug5_1234(i1,i2,i3,i4)%a,bb=ug5_1234(i1,i2,i3,i4)%b,cc=ug5_123
* 4(i1,i2,i3,i4)%c,dd=ug5_1234(i1,i2,i3,i4)%d,a1=l5_34(i3,i4)%a,b1=l5_34
* (i3,i4)%b,c1=l5_34(i3,i4)%c,d1=l5_34(i3,i4)%d,a2=ug534_12(i1,i2)%a,b2=
* ug534_12(i1,i2)%b,c2=ug534_12(i1,i2)%c,d2=ug534_12(i1,i2)%d,prq=p534q,
* m=rmass(id5),nsum=1
      ug5_1234(i1,i2,i3,i4)%a(1,1)=ug5_1234(i1,i2,i3,i4)%a(1,1)+
     & l5_34(i3,i4)%a(1,1)*ug534_12(i1,i2)%a(1,1)+l5_34(i3,i4)%c
     & (1,2)*p534q*ug534_12(i1,i2)%b(2,1)
      ug5_1234(i1,i2,i3,i4)%b(1,1)=ug5_1234(i1,i2,i3,i4)%b(1,1)+
     & rmass(id5)*(l5_34(i3,i4)%d(1,1)*ug534_12(i1,i2)%a(1,1)+l5
     & _34(i3,i4)%b(1,2)*ug534_12(i1,i2)%b(2,1))
      ug5_1234(i1,i2,i3,i4)%c(1,1)=ug5_1234(i1,i2,i3,i4)%c(1,1)+
     & rmass(id5)*(l5_34(i3,i4)%a(1,1)*ug534_12(i1,i2)%d(1,1)+l5
     & _34(i3,i4)%c(1,2)*ug534_12(i1,i2)%c(2,1))
      ug5_1234(i1,i2,i3,i4)%d(1,1)=ug5_1234(i1,i2,i3,i4)%d(1,1)+
     & l5_34(i3,i4)%d(1,1)*p534q*ug534_12(i1,i2)%d(1,1)+l5_34(i3
     & ,i4)%b(1,2)*ug534_12(i1,i2)%c(2,1)
      ug5_1234(i1,i2,i3,i4)%a(1,2)=ug5_1234(i1,i2,i3,i4)%a(1,2)+
     & rmass(id5)*(l5_34(i3,i4)%a(1,1)*ug534_12(i1,i2)%b(1,2)+l5
     & _34(i3,i4)%c(1,2)*ug534_12(i1,i2)%a(2,2))
      ug5_1234(i1,i2,i3,i4)%b(1,2)=ug5_1234(i1,i2,i3,i4)%b(1,2)+
     & l5_34(i3,i4)%d(1,1)*p534q*ug534_12(i1,i2)%b(1,2)+l5_34(i3
     & ,i4)%b(1,2)*ug534_12(i1,i2)%a(2,2)
      ug5_1234(i1,i2,i3,i4)%c(1,2)=ug5_1234(i1,i2,i3,i4)%c(1,2)+
     & l5_34(i3,i4)%a(1,1)*ug534_12(i1,i2)%c(1,2)+l5_34(i3,i4)%c
     & (1,2)*p534q*ug534_12(i1,i2)%d(2,2)
      ug5_1234(i1,i2,i3,i4)%d(1,2)=ug5_1234(i1,i2,i3,i4)%d(1,2)+
     & rmass(id5)*(l5_34(i3,i4)%d(1,1)*ug534_12(i1,i2)%c(1,2)+l5
     & _34(i3,i4)%b(1,2)*ug534_12(i1,i2)%d(2,2))
      ug5_1234(i1,i2,i3,i4)%a(2,1)=ug5_1234(i1,i2,i3,i4)%a(2,1)+
     & rmass(id5)*(l5_34(i3,i4)%c(2,1)*ug534_12(i1,i2)%a(1,1)+l5
     & _34(i3,i4)%a(2,2)*ug534_12(i1,i2)%b(2,1))
      ug5_1234(i1,i2,i3,i4)%b(2,1)=ug5_1234(i1,i2,i3,i4)%b(2,1)+
     & l5_34(i3,i4)%b(2,1)*ug534_12(i1,i2)%a(1,1)+l5_34(i3,i4)%d
     & (2,2)*p534q*ug534_12(i1,i2)%b(2,1)
      ug5_1234(i1,i2,i3,i4)%c(2,1)=ug5_1234(i1,i2,i3,i4)%c(2,1)+
     & l5_34(i3,i4)%c(2,1)*p534q*ug534_12(i1,i2)%d(1,1)+l5_34(i3
     & ,i4)%a(2,2)*ug534_12(i1,i2)%c(2,1)
      ug5_1234(i1,i2,i3,i4)%d(2,1)=ug5_1234(i1,i2,i3,i4)%d(2,1)+
     & rmass(id5)*(l5_34(i3,i4)%b(2,1)*ug534_12(i1,i2)%d(1,1)+l5
     & _34(i3,i4)%d(2,2)*ug534_12(i1,i2)%c(2,1))
      ug5_1234(i1,i2,i3,i4)%a(2,2)=ug5_1234(i1,i2,i3,i4)%a(2,2)+
     & l5_34(i3,i4)%c(2,1)*p534q*ug534_12(i1,i2)%b(1,2)+l5_34(i3
     & ,i4)%a(2,2)*ug534_12(i1,i2)%a(2,2)
      ug5_1234(i1,i2,i3,i4)%b(2,2)=ug5_1234(i1,i2,i3,i4)%b(2,2)+
     & rmass(id5)*(l5_34(i3,i4)%b(2,1)*ug534_12(i1,i2)%b(1,2)+l5
     & _34(i3,i4)%d(2,2)*ug534_12(i1,i2)%a(2,2))
      ug5_1234(i1,i2,i3,i4)%c(2,2)=ug5_1234(i1,i2,i3,i4)%c(2,2)+
     & rmass(id5)*(l5_34(i3,i4)%c(2,1)*ug534_12(i1,i2)%c(1,2)+l5
     & _34(i3,i4)%a(2,2)*ug534_12(i1,i2)%d(2,2))
      ug5_1234(i1,i2,i3,i4)%d(2,2)=ug5_1234(i1,i2,i3,i4)%d(2,2)+
     & l5_34(i3,i4)%b(2,1)*ug534_12(i1,i2)%c(1,2)+l5_34(i3,i4)%d
     & (2,2)*p534q*ug534_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TTs -- aa=ug5_1234(i1,i2,i3,i4)%a,bb=ug5_1234(i1,i2,i3,i4)%b,cc=ug5_12
* 34(i1,i2,i3,i4)%c,dd=ug5_1234(i1,i2,i3,i4)%d,a1=lg5_12(i1,i2)%a,b1=lg5
* _12(i1,i2)%b,c1=lg5_12(i1,i2)%c,d1=lg5_12(i1,i2)%d,a2=u512_34(i3,i4)%a
* ,b2=u512_34(i3,i4)%b,c2=u512_34(i3,i4)%c,d2=u512_34(i3,i4)%d,prq=p512q
* ,m=rmass(id5),nsum=0
      do jut=1,2
      cx1=u512_34(i3,i4)%a(1,jut)+rmass(id5)*u512_34(i3,i4)%b(1,
     & jut)
      cx2=u512_34(i3,i4)%a(2,jut)+rmass(id5)*u512_34(i3,i4)%b(2,
     & jut)
      cy1=p512q*u512_34(i3,i4)%b(1,jut)+rmass(id5)*u512_34(i3,i4
     & )%a(1,jut)
      cy2=p512q*u512_34(i3,i4)%b(2,jut)+rmass(id5)*u512_34(i3,i4
     & )%a(2,jut)
      cw1=u512_34(i3,i4)%c(1,jut)+rmass(id5)*u512_34(i3,i4)%d(1,
     & jut)
      cw2=u512_34(i3,i4)%c(2,jut)+rmass(id5)*u512_34(i3,i4)%d(2,
     & jut)
      cz1=p512q*u512_34(i3,i4)%d(1,jut)+rmass(id5)*u512_34(i3,i4
     & )%c(1,jut)
      cz2=p512q*u512_34(i3,i4)%d(2,jut)+rmass(id5)*u512_34(i3,i4
     & )%c(2,jut)
      ug5_1234(i1,i2,i3,i4)%a(1,jut)=lg5_12(i1,i2)%a(1,1)*cx1+lg
     & 5_12(i1,i2)%c(1,2)*cy2
      ug5_1234(i1,i2,i3,i4)%b(1,jut)=lg5_12(i1,i2)%d(1,1)*cy1+lg
     & 5_12(i1,i2)%b(1,2)*cx2
      ug5_1234(i1,i2,i3,i4)%c(1,jut)=lg5_12(i1,i2)%a(1,1)*cw1+lg
     & 5_12(i1,i2)%c(1,2)*cz2
      ug5_1234(i1,i2,i3,i4)%d(1,jut)=lg5_12(i1,i2)%d(1,1)*cz1+lg
     & 5_12(i1,i2)%b(1,2)*cw2
      ug5_1234(i1,i2,i3,i4)%a(2,jut)=lg5_12(i1,i2)%c(2,1)*cy1+lg
     & 5_12(i1,i2)%a(2,2)*cx2
      ug5_1234(i1,i2,i3,i4)%b(2,jut)=lg5_12(i1,i2)%b(2,1)*cx1+lg
     & 5_12(i1,i2)%d(2,2)*cy2
      ug5_1234(i1,i2,i3,i4)%c(2,jut)=lg5_12(i1,i2)%c(2,1)*cz1+lg
     & 5_12(i1,i2)%a(2,2)*cw2
      ug5_1234(i1,i2,i3,i4)%d(2,jut)=lg5_12(i1,i2)%b(2,1)*cw1+lg
     & 5_12(i1,i2)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=ug5_1234(i1,i2,i3,i4)%a,bb=ug5_1234(i1,i2,i3,i4)%b,cc=ug5_12
* 34(i1,i2,i3,i4)%c,dd=ug5_1234(i1,i2,i3,i4)%d,a1=l5_34(i3,i4)%a,b1=l5_3
* 4(i3,i4)%b,c1=l5_34(i3,i4)%c,d1=l5_34(i3,i4)%d,a2=ug534_12(i1,i2)%a,b2
* =ug534_12(i1,i2)%b,c2=ug534_12(i1,i2)%c,d2=ug534_12(i1,i2)%d,prq=p534q
* ,m=rmass(id5),nsum=1
      do iut=1,2
      cx1=l5_34(i3,i4)%a(iut,1)+l5_34(i3,i4)%c(iut,1)*rmass(id5)
      cx2=l5_34(i3,i4)%c(iut,2)*p534q+l5_34(i3,i4)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_34(i3,i4)%b(iut,1)+l5_34(i3,i4)%d(iut,1)*rmass(id5)
      cy2=l5_34(i3,i4)%d(iut,2)*p534q+l5_34(i3,i4)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_34(i3,i4)%c(iut,1)*p534q+l5_34(i3,i4)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_34(i3,i4)%a(iut,2)+l5_34(i3,i4)%c(iut,2)*rmass(id5)
      cz1=l5_34(i3,i4)%d(iut,1)*p534q+l5_34(i3,i4)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_34(i3,i4)%b(iut,2)+l5_34(i3,i4)%d(iut,2)*rmass(id5)
      ug5_1234(i1,i2,i3,i4)%a(iut,1)=ug5_1234(i1,i2,i3,i4)%a(iut
     & ,1)+cx1*ug534_12(i1,i2)%a(1,1)+cx2*ug534_12(i1,i2)%b(2,1)
      ug5_1234(i1,i2,i3,i4)%b(iut,1)=ug5_1234(i1,i2,i3,i4)%b(iut
     & ,1)+cy1*ug534_12(i1,i2)%a(1,1)+cy2*ug534_12(i1,i2)%b(2,1)
      ug5_1234(i1,i2,i3,i4)%c(iut,1)=ug5_1234(i1,i2,i3,i4)%c(iut
     & ,1)+cw1*ug534_12(i1,i2)%d(1,1)+cw2*ug534_12(i1,i2)%c(2,1)
      ug5_1234(i1,i2,i3,i4)%d(iut,1)=ug5_1234(i1,i2,i3,i4)%d(iut
     & ,1)+cz1*ug534_12(i1,i2)%d(1,1)+cz2*ug534_12(i1,i2)%c(2,1)
      ug5_1234(i1,i2,i3,i4)%a(iut,2)=ug5_1234(i1,i2,i3,i4)%a(iut
     & ,2)+cw1*ug534_12(i1,i2)%b(1,2)+cw2*ug534_12(i1,i2)%a(2,2)
      ug5_1234(i1,i2,i3,i4)%b(iut,2)=ug5_1234(i1,i2,i3,i4)%b(iut
     & ,2)+cz1*ug534_12(i1,i2)%b(1,2)+cz2*ug534_12(i1,i2)%a(2,2)
      ug5_1234(i1,i2,i3,i4)%c(iut,2)=ug5_1234(i1,i2,i3,i4)%c(iut
     & ,2)+cx1*ug534_12(i1,i2)%c(1,2)+cx2*ug534_12(i1,i2)%d(2,2)
      ug5_1234(i1,i2,i3,i4)%d(iut,2)=ug5_1234(i1,i2,i3,i4)%d(iut
     & ,2)+cy1*ug534_12(i1,i2)%c(1,2)+cy2*ug534_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id5).ne.1 .and. ilept(id3).ne.1)then
        if(id5.ne.5 .or. id1.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
* TT -- aa=ug5_3412(i3,i4,i1,i2)%a,bb=ug5_3412(i3,i4,i1,i2)%b,cc=ug5_341
* 2(i3,i4,i1,i2)%c,dd=ug5_3412(i3,i4,i1,i2)%d,a1=lg5_34(i3,i4)%a,b1=lg5_
* 34(i3,i4)%b,c1=lg5_34(i3,i4)%c,d1=lg5_34(i3,i4)%d,a2=u534_12(i1,i2)%a,
* b2=u534_12(i1,i2)%b,c2=u534_12(i1,i2)%c,d2=u534_12(i1,i2)%d,prq=p534q,
* m=rmass(id5),nsum=0
      ug5_3412(i3,i4,i1,i2)%a(1,1)=lg5_34(i3,i4)%a(1,1)*u534_12(
     & i1,i2)%a(1,1)+lg5_34(i3,i4)%c(1,2)*p534q*u534_12(i1,i2)%b
     & (2,1)
      ug5_3412(i3,i4,i1,i2)%b(1,1)=rmass(id5)*(lg5_34(i3,i4)%d(1
     & ,1)*u534_12(i1,i2)%a(1,1)+lg5_34(i3,i4)%b(1,2)*u534_12(i1
     & ,i2)%b(2,1))
      ug5_3412(i3,i4,i1,i2)%c(1,1)=rmass(id5)*(lg5_34(i3,i4)%a(1
     & ,1)*u534_12(i1,i2)%d(1,1)+lg5_34(i3,i4)%c(1,2)*u534_12(i1
     & ,i2)%c(2,1))
      ug5_3412(i3,i4,i1,i2)%d(1,1)=lg5_34(i3,i4)%d(1,1)*p534q*u5
     & 34_12(i1,i2)%d(1,1)+lg5_34(i3,i4)%b(1,2)*u534_12(i1,i2)%c
     & (2,1)
      ug5_3412(i3,i4,i1,i2)%a(1,2)=rmass(id5)*(lg5_34(i3,i4)%a(1
     & ,1)*u534_12(i1,i2)%b(1,2)+lg5_34(i3,i4)%c(1,2)*u534_12(i1
     & ,i2)%a(2,2))
      ug5_3412(i3,i4,i1,i2)%b(1,2)=lg5_34(i3,i4)%d(1,1)*p534q*u5
     & 34_12(i1,i2)%b(1,2)+lg5_34(i3,i4)%b(1,2)*u534_12(i1,i2)%a
     & (2,2)
      ug5_3412(i3,i4,i1,i2)%c(1,2)=lg5_34(i3,i4)%a(1,1)*u534_12(
     & i1,i2)%c(1,2)+lg5_34(i3,i4)%c(1,2)*p534q*u534_12(i1,i2)%d
     & (2,2)
      ug5_3412(i3,i4,i1,i2)%d(1,2)=rmass(id5)*(lg5_34(i3,i4)%d(1
     & ,1)*u534_12(i1,i2)%c(1,2)+lg5_34(i3,i4)%b(1,2)*u534_12(i1
     & ,i2)%d(2,2))
      ug5_3412(i3,i4,i1,i2)%a(2,1)=rmass(id5)*(lg5_34(i3,i4)%c(2
     & ,1)*u534_12(i1,i2)%a(1,1)+lg5_34(i3,i4)%a(2,2)*u534_12(i1
     & ,i2)%b(2,1))
      ug5_3412(i3,i4,i1,i2)%b(2,1)=lg5_34(i3,i4)%b(2,1)*u534_12(
     & i1,i2)%a(1,1)+lg5_34(i3,i4)%d(2,2)*p534q*u534_12(i1,i2)%b
     & (2,1)
      ug5_3412(i3,i4,i1,i2)%c(2,1)=lg5_34(i3,i4)%c(2,1)*p534q*u5
     & 34_12(i1,i2)%d(1,1)+lg5_34(i3,i4)%a(2,2)*u534_12(i1,i2)%c
     & (2,1)
      ug5_3412(i3,i4,i1,i2)%d(2,1)=rmass(id5)*(lg5_34(i3,i4)%b(2
     & ,1)*u534_12(i1,i2)%d(1,1)+lg5_34(i3,i4)%d(2,2)*u534_12(i1
     & ,i2)%c(2,1))
      ug5_3412(i3,i4,i1,i2)%a(2,2)=lg5_34(i3,i4)%c(2,1)*p534q*u5
     & 34_12(i1,i2)%b(1,2)+lg5_34(i3,i4)%a(2,2)*u534_12(i1,i2)%a
     & (2,2)
      ug5_3412(i3,i4,i1,i2)%b(2,2)=rmass(id5)*(lg5_34(i3,i4)%b(2
     & ,1)*u534_12(i1,i2)%b(1,2)+lg5_34(i3,i4)%d(2,2)*u534_12(i1
     & ,i2)%a(2,2))
      ug5_3412(i3,i4,i1,i2)%c(2,2)=rmass(id5)*(lg5_34(i3,i4)%c(2
     & ,1)*u534_12(i1,i2)%c(1,2)+lg5_34(i3,i4)%a(2,2)*u534_12(i1
     & ,i2)%d(2,2))
      ug5_3412(i3,i4,i1,i2)%d(2,2)=lg5_34(i3,i4)%b(2,1)*u534_12(
     & i1,i2)%c(1,2)+lg5_34(i3,i4)%d(2,2)*p534q*u534_12(i1,i2)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
* TT -- aa=ug5_3412(i3,i4,i1,i2)%a,bb=ug5_3412(i3,i4,i1,i2)%b,cc=ug5_341
* 2(i3,i4,i1,i2)%c,dd=ug5_3412(i3,i4,i1,i2)%d,a1=l5_12(i1,i2)%a,b1=l5_12
* (i1,i2)%b,c1=l5_12(i1,i2)%c,d1=l5_12(i1,i2)%d,a2=ug512_34(i3,i4)%a,b2=
* ug512_34(i3,i4)%b,c2=ug512_34(i3,i4)%c,d2=ug512_34(i3,i4)%d,prq=p512q,
* m=rmass(id5),nsum=1
      ug5_3412(i3,i4,i1,i2)%a(1,1)=ug5_3412(i3,i4,i1,i2)%a(1,1)+
     & l5_12(i1,i2)%a(1,1)*ug512_34(i3,i4)%a(1,1)+l5_12(i1,i2)%c
     & (1,2)*p512q*ug512_34(i3,i4)%b(2,1)
      ug5_3412(i3,i4,i1,i2)%b(1,1)=ug5_3412(i3,i4,i1,i2)%b(1,1)+
     & rmass(id5)*(l5_12(i1,i2)%d(1,1)*ug512_34(i3,i4)%a(1,1)+l5
     & _12(i1,i2)%b(1,2)*ug512_34(i3,i4)%b(2,1))
      ug5_3412(i3,i4,i1,i2)%c(1,1)=ug5_3412(i3,i4,i1,i2)%c(1,1)+
     & rmass(id5)*(l5_12(i1,i2)%a(1,1)*ug512_34(i3,i4)%d(1,1)+l5
     & _12(i1,i2)%c(1,2)*ug512_34(i3,i4)%c(2,1))
      ug5_3412(i3,i4,i1,i2)%d(1,1)=ug5_3412(i3,i4,i1,i2)%d(1,1)+
     & l5_12(i1,i2)%d(1,1)*p512q*ug512_34(i3,i4)%d(1,1)+l5_12(i1
     & ,i2)%b(1,2)*ug512_34(i3,i4)%c(2,1)
      ug5_3412(i3,i4,i1,i2)%a(1,2)=ug5_3412(i3,i4,i1,i2)%a(1,2)+
     & rmass(id5)*(l5_12(i1,i2)%a(1,1)*ug512_34(i3,i4)%b(1,2)+l5
     & _12(i1,i2)%c(1,2)*ug512_34(i3,i4)%a(2,2))
      ug5_3412(i3,i4,i1,i2)%b(1,2)=ug5_3412(i3,i4,i1,i2)%b(1,2)+
     & l5_12(i1,i2)%d(1,1)*p512q*ug512_34(i3,i4)%b(1,2)+l5_12(i1
     & ,i2)%b(1,2)*ug512_34(i3,i4)%a(2,2)
      ug5_3412(i3,i4,i1,i2)%c(1,2)=ug5_3412(i3,i4,i1,i2)%c(1,2)+
     & l5_12(i1,i2)%a(1,1)*ug512_34(i3,i4)%c(1,2)+l5_12(i1,i2)%c
     & (1,2)*p512q*ug512_34(i3,i4)%d(2,2)
      ug5_3412(i3,i4,i1,i2)%d(1,2)=ug5_3412(i3,i4,i1,i2)%d(1,2)+
     & rmass(id5)*(l5_12(i1,i2)%d(1,1)*ug512_34(i3,i4)%c(1,2)+l5
     & _12(i1,i2)%b(1,2)*ug512_34(i3,i4)%d(2,2))
      ug5_3412(i3,i4,i1,i2)%a(2,1)=ug5_3412(i3,i4,i1,i2)%a(2,1)+
     & rmass(id5)*(l5_12(i1,i2)%c(2,1)*ug512_34(i3,i4)%a(1,1)+l5
     & _12(i1,i2)%a(2,2)*ug512_34(i3,i4)%b(2,1))
      ug5_3412(i3,i4,i1,i2)%b(2,1)=ug5_3412(i3,i4,i1,i2)%b(2,1)+
     & l5_12(i1,i2)%b(2,1)*ug512_34(i3,i4)%a(1,1)+l5_12(i1,i2)%d
     & (2,2)*p512q*ug512_34(i3,i4)%b(2,1)
      ug5_3412(i3,i4,i1,i2)%c(2,1)=ug5_3412(i3,i4,i1,i2)%c(2,1)+
     & l5_12(i1,i2)%c(2,1)*p512q*ug512_34(i3,i4)%d(1,1)+l5_12(i1
     & ,i2)%a(2,2)*ug512_34(i3,i4)%c(2,1)
      ug5_3412(i3,i4,i1,i2)%d(2,1)=ug5_3412(i3,i4,i1,i2)%d(2,1)+
     & rmass(id5)*(l5_12(i1,i2)%b(2,1)*ug512_34(i3,i4)%d(1,1)+l5
     & _12(i1,i2)%d(2,2)*ug512_34(i3,i4)%c(2,1))
      ug5_3412(i3,i4,i1,i2)%a(2,2)=ug5_3412(i3,i4,i1,i2)%a(2,2)+
     & l5_12(i1,i2)%c(2,1)*p512q*ug512_34(i3,i4)%b(1,2)+l5_12(i1
     & ,i2)%a(2,2)*ug512_34(i3,i4)%a(2,2)
      ug5_3412(i3,i4,i1,i2)%b(2,2)=ug5_3412(i3,i4,i1,i2)%b(2,2)+
     & rmass(id5)*(l5_12(i1,i2)%b(2,1)*ug512_34(i3,i4)%b(1,2)+l5
     & _12(i1,i2)%d(2,2)*ug512_34(i3,i4)%a(2,2))
      ug5_3412(i3,i4,i1,i2)%c(2,2)=ug5_3412(i3,i4,i1,i2)%c(2,2)+
     & rmass(id5)*(l5_12(i1,i2)%c(2,1)*ug512_34(i3,i4)%c(1,2)+l5
     & _12(i1,i2)%a(2,2)*ug512_34(i3,i4)%d(2,2))
      ug5_3412(i3,i4,i1,i2)%d(2,2)=ug5_3412(i3,i4,i1,i2)%d(2,2)+
     & l5_12(i1,i2)%b(2,1)*ug512_34(i3,i4)%c(1,2)+l5_12(i1,i2)%d
     & (2,2)*p512q*ug512_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
* TTs -- aa=ug5_3412(i3,i4,i1,i2)%a,bb=ug5_3412(i3,i4,i1,i2)%b,cc=ug5_34
* 12(i3,i4,i1,i2)%c,dd=ug5_3412(i3,i4,i1,i2)%d,a1=lg5_34(i3,i4)%a,b1=lg5
* _34(i3,i4)%b,c1=lg5_34(i3,i4)%c,d1=lg5_34(i3,i4)%d,a2=u534_12(i1,i2)%a
* ,b2=u534_12(i1,i2)%b,c2=u534_12(i1,i2)%c,d2=u534_12(i1,i2)%d,prq=p534q
* ,m=rmass(id5),nsum=0
      do jut=1,2
      cx1=u534_12(i1,i2)%a(1,jut)+rmass(id5)*u534_12(i1,i2)%b(1,
     & jut)
      cx2=u534_12(i1,i2)%a(2,jut)+rmass(id5)*u534_12(i1,i2)%b(2,
     & jut)
      cy1=p534q*u534_12(i1,i2)%b(1,jut)+rmass(id5)*u534_12(i1,i2
     & )%a(1,jut)
      cy2=p534q*u534_12(i1,i2)%b(2,jut)+rmass(id5)*u534_12(i1,i2
     & )%a(2,jut)
      cw1=u534_12(i1,i2)%c(1,jut)+rmass(id5)*u534_12(i1,i2)%d(1,
     & jut)
      cw2=u534_12(i1,i2)%c(2,jut)+rmass(id5)*u534_12(i1,i2)%d(2,
     & jut)
      cz1=p534q*u534_12(i1,i2)%d(1,jut)+rmass(id5)*u534_12(i1,i2
     & )%c(1,jut)
      cz2=p534q*u534_12(i1,i2)%d(2,jut)+rmass(id5)*u534_12(i1,i2
     & )%c(2,jut)
      ug5_3412(i3,i4,i1,i2)%a(1,jut)=lg5_34(i3,i4)%a(1,1)*cx1+lg
     & 5_34(i3,i4)%c(1,2)*cy2
      ug5_3412(i3,i4,i1,i2)%b(1,jut)=lg5_34(i3,i4)%d(1,1)*cy1+lg
     & 5_34(i3,i4)%b(1,2)*cx2
      ug5_3412(i3,i4,i1,i2)%c(1,jut)=lg5_34(i3,i4)%a(1,1)*cw1+lg
     & 5_34(i3,i4)%c(1,2)*cz2
      ug5_3412(i3,i4,i1,i2)%d(1,jut)=lg5_34(i3,i4)%d(1,1)*cz1+lg
     & 5_34(i3,i4)%b(1,2)*cw2
      ug5_3412(i3,i4,i1,i2)%a(2,jut)=lg5_34(i3,i4)%c(2,1)*cy1+lg
     & 5_34(i3,i4)%a(2,2)*cx2
      ug5_3412(i3,i4,i1,i2)%b(2,jut)=lg5_34(i3,i4)%b(2,1)*cx1+lg
     & 5_34(i3,i4)%d(2,2)*cy2
      ug5_3412(i3,i4,i1,i2)%c(2,jut)=lg5_34(i3,i4)%c(2,1)*cz1+lg
     & 5_34(i3,i4)%a(2,2)*cw2
      ug5_3412(i3,i4,i1,i2)%d(2,jut)=lg5_34(i3,i4)%b(2,1)*cw1+lg
     & 5_34(i3,i4)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=ug5_3412(i3,i4,i1,i2)%a,bb=ug5_3412(i3,i4,i1,i2)%b,cc=ug5_34
* 12(i3,i4,i1,i2)%c,dd=ug5_3412(i3,i4,i1,i2)%d,a1=l5_12(i1,i2)%a,b1=l5_1
* 2(i1,i2)%b,c1=l5_12(i1,i2)%c,d1=l5_12(i1,i2)%d,a2=ug512_34(i3,i4)%a,b2
* =ug512_34(i3,i4)%b,c2=ug512_34(i3,i4)%c,d2=ug512_34(i3,i4)%d,prq=p512q
* ,m=rmass(id5),nsum=1
      do iut=1,2
      cx1=l5_12(i1,i2)%a(iut,1)+l5_12(i1,i2)%c(iut,1)*rmass(id5)
      cx2=l5_12(i1,i2)%c(iut,2)*p512q+l5_12(i1,i2)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_12(i1,i2)%b(iut,1)+l5_12(i1,i2)%d(iut,1)*rmass(id5)
      cy2=l5_12(i1,i2)%d(iut,2)*p512q+l5_12(i1,i2)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_12(i1,i2)%c(iut,1)*p512q+l5_12(i1,i2)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_12(i1,i2)%a(iut,2)+l5_12(i1,i2)%c(iut,2)*rmass(id5)
      cz1=l5_12(i1,i2)%d(iut,1)*p512q+l5_12(i1,i2)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_12(i1,i2)%b(iut,2)+l5_12(i1,i2)%d(iut,2)*rmass(id5)
      ug5_3412(i3,i4,i1,i2)%a(iut,1)=ug5_3412(i3,i4,i1,i2)%a(iut
     & ,1)+cx1*ug512_34(i3,i4)%a(1,1)+cx2*ug512_34(i3,i4)%b(2,1)
      ug5_3412(i3,i4,i1,i2)%b(iut,1)=ug5_3412(i3,i4,i1,i2)%b(iut
     & ,1)+cy1*ug512_34(i3,i4)%a(1,1)+cy2*ug512_34(i3,i4)%b(2,1)
      ug5_3412(i3,i4,i1,i2)%c(iut,1)=ug5_3412(i3,i4,i1,i2)%c(iut
     & ,1)+cw1*ug512_34(i3,i4)%d(1,1)+cw2*ug512_34(i3,i4)%c(2,1)
      ug5_3412(i3,i4,i1,i2)%d(iut,1)=ug5_3412(i3,i4,i1,i2)%d(iut
     & ,1)+cz1*ug512_34(i3,i4)%d(1,1)+cz2*ug512_34(i3,i4)%c(2,1)
      ug5_3412(i3,i4,i1,i2)%a(iut,2)=ug5_3412(i3,i4,i1,i2)%a(iut
     & ,2)+cw1*ug512_34(i3,i4)%b(1,2)+cw2*ug512_34(i3,i4)%a(2,2)
      ug5_3412(i3,i4,i1,i2)%b(iut,2)=ug5_3412(i3,i4,i1,i2)%b(iut
     & ,2)+cz1*ug512_34(i3,i4)%b(1,2)+cz2*ug512_34(i3,i4)%a(2,2)
      ug5_3412(i3,i4,i1,i2)%c(iut,2)=ug5_3412(i3,i4,i1,i2)%c(iut
     & ,2)+cx1*ug512_34(i3,i4)%c(1,2)+cx2*ug512_34(i3,i4)%d(2,2)
      ug5_3412(i3,i4,i1,i2)%d(iut,2)=ug5_3412(i3,i4,i1,i2)%d(iut
     & ,2)+cy1*ug512_34(i3,i4)%c(1,2)+cy2*ug512_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id5).ne.1 .and. ilept(id1).ne.1)then
        if(id5.ne.5 .or. id7.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=ug5_1278(i1,i2,i7,i8)%a,bb=ug5_1278(i1,i2,i7,i8)%b,cc=ug5_127
* 8(i1,i2,i7,i8)%c,dd=ug5_1278(i1,i2,i7,i8)%d,a1=lg5_12(i1,i2)%a,b1=lg5_
* 12(i1,i2)%b,c1=lg5_12(i1,i2)%c,d1=lg5_12(i1,i2)%d,a2=u512_78(i7,i8)%a,
* b2=u512_78(i7,i8)%b,c2=u512_78(i7,i8)%c,d2=u512_78(i7,i8)%d,prq=p512q,
* m=rmass(id5),nsum=0
      ug5_1278(i1,i2,i7,i8)%a(1,1)=lg5_12(i1,i2)%a(1,1)*u512_78(
     & i7,i8)%a(1,1)+lg5_12(i1,i2)%c(1,2)*p512q*u512_78(i7,i8)%b
     & (2,1)
      ug5_1278(i1,i2,i7,i8)%b(1,1)=rmass(id5)*(lg5_12(i1,i2)%d(1
     & ,1)*u512_78(i7,i8)%a(1,1)+lg5_12(i1,i2)%b(1,2)*u512_78(i7
     & ,i8)%b(2,1))
      ug5_1278(i1,i2,i7,i8)%c(1,1)=rmass(id5)*(lg5_12(i1,i2)%a(1
     & ,1)*u512_78(i7,i8)%d(1,1)+lg5_12(i1,i2)%c(1,2)*u512_78(i7
     & ,i8)%c(2,1))
      ug5_1278(i1,i2,i7,i8)%d(1,1)=lg5_12(i1,i2)%d(1,1)*p512q*u5
     & 12_78(i7,i8)%d(1,1)+lg5_12(i1,i2)%b(1,2)*u512_78(i7,i8)%c
     & (2,1)
      ug5_1278(i1,i2,i7,i8)%a(1,2)=rmass(id5)*(lg5_12(i1,i2)%a(1
     & ,1)*u512_78(i7,i8)%b(1,2)+lg5_12(i1,i2)%c(1,2)*u512_78(i7
     & ,i8)%a(2,2))
      ug5_1278(i1,i2,i7,i8)%b(1,2)=lg5_12(i1,i2)%d(1,1)*p512q*u5
     & 12_78(i7,i8)%b(1,2)+lg5_12(i1,i2)%b(1,2)*u512_78(i7,i8)%a
     & (2,2)
      ug5_1278(i1,i2,i7,i8)%c(1,2)=lg5_12(i1,i2)%a(1,1)*u512_78(
     & i7,i8)%c(1,2)+lg5_12(i1,i2)%c(1,2)*p512q*u512_78(i7,i8)%d
     & (2,2)
      ug5_1278(i1,i2,i7,i8)%d(1,2)=rmass(id5)*(lg5_12(i1,i2)%d(1
     & ,1)*u512_78(i7,i8)%c(1,2)+lg5_12(i1,i2)%b(1,2)*u512_78(i7
     & ,i8)%d(2,2))
      ug5_1278(i1,i2,i7,i8)%a(2,1)=rmass(id5)*(lg5_12(i1,i2)%c(2
     & ,1)*u512_78(i7,i8)%a(1,1)+lg5_12(i1,i2)%a(2,2)*u512_78(i7
     & ,i8)%b(2,1))
      ug5_1278(i1,i2,i7,i8)%b(2,1)=lg5_12(i1,i2)%b(2,1)*u512_78(
     & i7,i8)%a(1,1)+lg5_12(i1,i2)%d(2,2)*p512q*u512_78(i7,i8)%b
     & (2,1)
      ug5_1278(i1,i2,i7,i8)%c(2,1)=lg5_12(i1,i2)%c(2,1)*p512q*u5
     & 12_78(i7,i8)%d(1,1)+lg5_12(i1,i2)%a(2,2)*u512_78(i7,i8)%c
     & (2,1)
      ug5_1278(i1,i2,i7,i8)%d(2,1)=rmass(id5)*(lg5_12(i1,i2)%b(2
     & ,1)*u512_78(i7,i8)%d(1,1)+lg5_12(i1,i2)%d(2,2)*u512_78(i7
     & ,i8)%c(2,1))
      ug5_1278(i1,i2,i7,i8)%a(2,2)=lg5_12(i1,i2)%c(2,1)*p512q*u5
     & 12_78(i7,i8)%b(1,2)+lg5_12(i1,i2)%a(2,2)*u512_78(i7,i8)%a
     & (2,2)
      ug5_1278(i1,i2,i7,i8)%b(2,2)=rmass(id5)*(lg5_12(i1,i2)%b(2
     & ,1)*u512_78(i7,i8)%b(1,2)+lg5_12(i1,i2)%d(2,2)*u512_78(i7
     & ,i8)%a(2,2))
      ug5_1278(i1,i2,i7,i8)%c(2,2)=rmass(id5)*(lg5_12(i1,i2)%c(2
     & ,1)*u512_78(i7,i8)%c(1,2)+lg5_12(i1,i2)%a(2,2)*u512_78(i7
     & ,i8)%d(2,2))
      ug5_1278(i1,i2,i7,i8)%d(2,2)=lg5_12(i1,i2)%b(2,1)*u512_78(
     & i7,i8)%c(1,2)+lg5_12(i1,i2)%d(2,2)*p512q*u512_78(i7,i8)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=ug5_1278(i1,i2,i7,i8)%a,bb=ug5_1278(i1,i2,i7,i8)%b,cc=ug5_127
* 8(i1,i2,i7,i8)%c,dd=ug5_1278(i1,i2,i7,i8)%d,a1=l5_78(i7,i8)%a,b1=l5_78
* (i7,i8)%b,c1=l5_78(i7,i8)%c,d1=l5_78(i7,i8)%d,a2=ug578_12(i1,i2)%a,b2=
* ug578_12(i1,i2)%b,c2=ug578_12(i1,i2)%c,d2=ug578_12(i1,i2)%d,prq=p578q,
* m=rmass(id5),nsum=1
      ug5_1278(i1,i2,i7,i8)%a(1,1)=ug5_1278(i1,i2,i7,i8)%a(1,1)+
     & l5_78(i7,i8)%a(1,1)*ug578_12(i1,i2)%a(1,1)+l5_78(i7,i8)%c
     & (1,2)*p578q*ug578_12(i1,i2)%b(2,1)
      ug5_1278(i1,i2,i7,i8)%b(1,1)=ug5_1278(i1,i2,i7,i8)%b(1,1)+
     & rmass(id5)*(l5_78(i7,i8)%d(1,1)*ug578_12(i1,i2)%a(1,1)+l5
     & _78(i7,i8)%b(1,2)*ug578_12(i1,i2)%b(2,1))
      ug5_1278(i1,i2,i7,i8)%c(1,1)=ug5_1278(i1,i2,i7,i8)%c(1,1)+
     & rmass(id5)*(l5_78(i7,i8)%a(1,1)*ug578_12(i1,i2)%d(1,1)+l5
     & _78(i7,i8)%c(1,2)*ug578_12(i1,i2)%c(2,1))
      ug5_1278(i1,i2,i7,i8)%d(1,1)=ug5_1278(i1,i2,i7,i8)%d(1,1)+
     & l5_78(i7,i8)%d(1,1)*p578q*ug578_12(i1,i2)%d(1,1)+l5_78(i7
     & ,i8)%b(1,2)*ug578_12(i1,i2)%c(2,1)
      ug5_1278(i1,i2,i7,i8)%a(1,2)=ug5_1278(i1,i2,i7,i8)%a(1,2)+
     & rmass(id5)*(l5_78(i7,i8)%a(1,1)*ug578_12(i1,i2)%b(1,2)+l5
     & _78(i7,i8)%c(1,2)*ug578_12(i1,i2)%a(2,2))
      ug5_1278(i1,i2,i7,i8)%b(1,2)=ug5_1278(i1,i2,i7,i8)%b(1,2)+
     & l5_78(i7,i8)%d(1,1)*p578q*ug578_12(i1,i2)%b(1,2)+l5_78(i7
     & ,i8)%b(1,2)*ug578_12(i1,i2)%a(2,2)
      ug5_1278(i1,i2,i7,i8)%c(1,2)=ug5_1278(i1,i2,i7,i8)%c(1,2)+
     & l5_78(i7,i8)%a(1,1)*ug578_12(i1,i2)%c(1,2)+l5_78(i7,i8)%c
     & (1,2)*p578q*ug578_12(i1,i2)%d(2,2)
      ug5_1278(i1,i2,i7,i8)%d(1,2)=ug5_1278(i1,i2,i7,i8)%d(1,2)+
     & rmass(id5)*(l5_78(i7,i8)%d(1,1)*ug578_12(i1,i2)%c(1,2)+l5
     & _78(i7,i8)%b(1,2)*ug578_12(i1,i2)%d(2,2))
      ug5_1278(i1,i2,i7,i8)%a(2,1)=ug5_1278(i1,i2,i7,i8)%a(2,1)+
     & rmass(id5)*(l5_78(i7,i8)%c(2,1)*ug578_12(i1,i2)%a(1,1)+l5
     & _78(i7,i8)%a(2,2)*ug578_12(i1,i2)%b(2,1))
      ug5_1278(i1,i2,i7,i8)%b(2,1)=ug5_1278(i1,i2,i7,i8)%b(2,1)+
     & l5_78(i7,i8)%b(2,1)*ug578_12(i1,i2)%a(1,1)+l5_78(i7,i8)%d
     & (2,2)*p578q*ug578_12(i1,i2)%b(2,1)
      ug5_1278(i1,i2,i7,i8)%c(2,1)=ug5_1278(i1,i2,i7,i8)%c(2,1)+
     & l5_78(i7,i8)%c(2,1)*p578q*ug578_12(i1,i2)%d(1,1)+l5_78(i7
     & ,i8)%a(2,2)*ug578_12(i1,i2)%c(2,1)
      ug5_1278(i1,i2,i7,i8)%d(2,1)=ug5_1278(i1,i2,i7,i8)%d(2,1)+
     & rmass(id5)*(l5_78(i7,i8)%b(2,1)*ug578_12(i1,i2)%d(1,1)+l5
     & _78(i7,i8)%d(2,2)*ug578_12(i1,i2)%c(2,1))
      ug5_1278(i1,i2,i7,i8)%a(2,2)=ug5_1278(i1,i2,i7,i8)%a(2,2)+
     & l5_78(i7,i8)%c(2,1)*p578q*ug578_12(i1,i2)%b(1,2)+l5_78(i7
     & ,i8)%a(2,2)*ug578_12(i1,i2)%a(2,2)
      ug5_1278(i1,i2,i7,i8)%b(2,2)=ug5_1278(i1,i2,i7,i8)%b(2,2)+
     & rmass(id5)*(l5_78(i7,i8)%b(2,1)*ug578_12(i1,i2)%b(1,2)+l5
     & _78(i7,i8)%d(2,2)*ug578_12(i1,i2)%a(2,2))
      ug5_1278(i1,i2,i7,i8)%c(2,2)=ug5_1278(i1,i2,i7,i8)%c(2,2)+
     & rmass(id5)*(l5_78(i7,i8)%c(2,1)*ug578_12(i1,i2)%c(1,2)+l5
     & _78(i7,i8)%a(2,2)*ug578_12(i1,i2)%d(2,2))
      ug5_1278(i1,i2,i7,i8)%d(2,2)=ug5_1278(i1,i2,i7,i8)%d(2,2)+
     & l5_78(i7,i8)%b(2,1)*ug578_12(i1,i2)%c(1,2)+l5_78(i7,i8)%d
     & (2,2)*p578q*ug578_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=ug5_1278(i1,i2,i7,i8)%a,bb=ug5_1278(i1,i2,i7,i8)%b,cc=ug5_12
* 78(i1,i2,i7,i8)%c,dd=ug5_1278(i1,i2,i7,i8)%d,a1=lg5_12(i1,i2)%a,b1=lg5
* _12(i1,i2)%b,c1=lg5_12(i1,i2)%c,d1=lg5_12(i1,i2)%d,a2=u512_78(i7,i8)%a
* ,b2=u512_78(i7,i8)%b,c2=u512_78(i7,i8)%c,d2=u512_78(i7,i8)%d,prq=p512q
* ,m=rmass(id5),nsum=0
      do jut=1,2
      cx1=u512_78(i7,i8)%a(1,jut)+rmass(id5)*u512_78(i7,i8)%b(1,
     & jut)
      cx2=u512_78(i7,i8)%a(2,jut)+rmass(id5)*u512_78(i7,i8)%b(2,
     & jut)
      cy1=p512q*u512_78(i7,i8)%b(1,jut)+rmass(id5)*u512_78(i7,i8
     & )%a(1,jut)
      cy2=p512q*u512_78(i7,i8)%b(2,jut)+rmass(id5)*u512_78(i7,i8
     & )%a(2,jut)
      cw1=u512_78(i7,i8)%c(1,jut)+rmass(id5)*u512_78(i7,i8)%d(1,
     & jut)
      cw2=u512_78(i7,i8)%c(2,jut)+rmass(id5)*u512_78(i7,i8)%d(2,
     & jut)
      cz1=p512q*u512_78(i7,i8)%d(1,jut)+rmass(id5)*u512_78(i7,i8
     & )%c(1,jut)
      cz2=p512q*u512_78(i7,i8)%d(2,jut)+rmass(id5)*u512_78(i7,i8
     & )%c(2,jut)
      ug5_1278(i1,i2,i7,i8)%a(1,jut)=lg5_12(i1,i2)%a(1,1)*cx1+lg
     & 5_12(i1,i2)%c(1,2)*cy2
      ug5_1278(i1,i2,i7,i8)%b(1,jut)=lg5_12(i1,i2)%d(1,1)*cy1+lg
     & 5_12(i1,i2)%b(1,2)*cx2
      ug5_1278(i1,i2,i7,i8)%c(1,jut)=lg5_12(i1,i2)%a(1,1)*cw1+lg
     & 5_12(i1,i2)%c(1,2)*cz2
      ug5_1278(i1,i2,i7,i8)%d(1,jut)=lg5_12(i1,i2)%d(1,1)*cz1+lg
     & 5_12(i1,i2)%b(1,2)*cw2
      ug5_1278(i1,i2,i7,i8)%a(2,jut)=lg5_12(i1,i2)%c(2,1)*cy1+lg
     & 5_12(i1,i2)%a(2,2)*cx2
      ug5_1278(i1,i2,i7,i8)%b(2,jut)=lg5_12(i1,i2)%b(2,1)*cx1+lg
     & 5_12(i1,i2)%d(2,2)*cy2
      ug5_1278(i1,i2,i7,i8)%c(2,jut)=lg5_12(i1,i2)%c(2,1)*cz1+lg
     & 5_12(i1,i2)%a(2,2)*cw2
      ug5_1278(i1,i2,i7,i8)%d(2,jut)=lg5_12(i1,i2)%b(2,1)*cw1+lg
     & 5_12(i1,i2)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=ug5_1278(i1,i2,i7,i8)%a,bb=ug5_1278(i1,i2,i7,i8)%b,cc=ug5_12
* 78(i1,i2,i7,i8)%c,dd=ug5_1278(i1,i2,i7,i8)%d,a1=l5_78(i7,i8)%a,b1=l5_7
* 8(i7,i8)%b,c1=l5_78(i7,i8)%c,d1=l5_78(i7,i8)%d,a2=ug578_12(i1,i2)%a,b2
* =ug578_12(i1,i2)%b,c2=ug578_12(i1,i2)%c,d2=ug578_12(i1,i2)%d,prq=p578q
* ,m=rmass(id5),nsum=1
      do iut=1,2
      cx1=l5_78(i7,i8)%a(iut,1)+l5_78(i7,i8)%c(iut,1)*rmass(id5)
      cx2=l5_78(i7,i8)%c(iut,2)*p578q+l5_78(i7,i8)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_78(i7,i8)%b(iut,1)+l5_78(i7,i8)%d(iut,1)*rmass(id5)
      cy2=l5_78(i7,i8)%d(iut,2)*p578q+l5_78(i7,i8)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_78(i7,i8)%c(iut,1)*p578q+l5_78(i7,i8)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_78(i7,i8)%a(iut,2)+l5_78(i7,i8)%c(iut,2)*rmass(id5)
      cz1=l5_78(i7,i8)%d(iut,1)*p578q+l5_78(i7,i8)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_78(i7,i8)%b(iut,2)+l5_78(i7,i8)%d(iut,2)*rmass(id5)
      ug5_1278(i1,i2,i7,i8)%a(iut,1)=ug5_1278(i1,i2,i7,i8)%a(iut
     & ,1)+cx1*ug578_12(i1,i2)%a(1,1)+cx2*ug578_12(i1,i2)%b(2,1)
      ug5_1278(i1,i2,i7,i8)%b(iut,1)=ug5_1278(i1,i2,i7,i8)%b(iut
     & ,1)+cy1*ug578_12(i1,i2)%a(1,1)+cy2*ug578_12(i1,i2)%b(2,1)
      ug5_1278(i1,i2,i7,i8)%c(iut,1)=ug5_1278(i1,i2,i7,i8)%c(iut
     & ,1)+cw1*ug578_12(i1,i2)%d(1,1)+cw2*ug578_12(i1,i2)%c(2,1)
      ug5_1278(i1,i2,i7,i8)%d(iut,1)=ug5_1278(i1,i2,i7,i8)%d(iut
     & ,1)+cz1*ug578_12(i1,i2)%d(1,1)+cz2*ug578_12(i1,i2)%c(2,1)
      ug5_1278(i1,i2,i7,i8)%a(iut,2)=ug5_1278(i1,i2,i7,i8)%a(iut
     & ,2)+cw1*ug578_12(i1,i2)%b(1,2)+cw2*ug578_12(i1,i2)%a(2,2)
      ug5_1278(i1,i2,i7,i8)%b(iut,2)=ug5_1278(i1,i2,i7,i8)%b(iut
     & ,2)+cz1*ug578_12(i1,i2)%b(1,2)+cz2*ug578_12(i1,i2)%a(2,2)
      ug5_1278(i1,i2,i7,i8)%c(iut,2)=ug5_1278(i1,i2,i7,i8)%c(iut
     & ,2)+cx1*ug578_12(i1,i2)%c(1,2)+cx2*ug578_12(i1,i2)%d(2,2)
      ug5_1278(i1,i2,i7,i8)%d(iut,2)=ug5_1278(i1,i2,i7,i8)%d(iut
     & ,2)+cy1*ug578_12(i1,i2)%c(1,2)+cy2*ug578_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id5).ne.1 .and. ilept(id7).ne.1)then
        if(id5.ne.5 .or. id1.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TT -- aa=ug5_7812(i7,i8,i1,i2)%a,bb=ug5_7812(i7,i8,i1,i2)%b,cc=ug5_781
* 2(i7,i8,i1,i2)%c,dd=ug5_7812(i7,i8,i1,i2)%d,a1=lg5_78(i7,i8)%a,b1=lg5_
* 78(i7,i8)%b,c1=lg5_78(i7,i8)%c,d1=lg5_78(i7,i8)%d,a2=u578_12(i1,i2)%a,
* b2=u578_12(i1,i2)%b,c2=u578_12(i1,i2)%c,d2=u578_12(i1,i2)%d,prq=p578q,
* m=rmass(id5),nsum=0
      ug5_7812(i7,i8,i1,i2)%a(1,1)=lg5_78(i7,i8)%a(1,1)*u578_12(
     & i1,i2)%a(1,1)+lg5_78(i7,i8)%c(1,2)*p578q*u578_12(i1,i2)%b
     & (2,1)
      ug5_7812(i7,i8,i1,i2)%b(1,1)=rmass(id5)*(lg5_78(i7,i8)%d(1
     & ,1)*u578_12(i1,i2)%a(1,1)+lg5_78(i7,i8)%b(1,2)*u578_12(i1
     & ,i2)%b(2,1))
      ug5_7812(i7,i8,i1,i2)%c(1,1)=rmass(id5)*(lg5_78(i7,i8)%a(1
     & ,1)*u578_12(i1,i2)%d(1,1)+lg5_78(i7,i8)%c(1,2)*u578_12(i1
     & ,i2)%c(2,1))
      ug5_7812(i7,i8,i1,i2)%d(1,1)=lg5_78(i7,i8)%d(1,1)*p578q*u5
     & 78_12(i1,i2)%d(1,1)+lg5_78(i7,i8)%b(1,2)*u578_12(i1,i2)%c
     & (2,1)
      ug5_7812(i7,i8,i1,i2)%a(1,2)=rmass(id5)*(lg5_78(i7,i8)%a(1
     & ,1)*u578_12(i1,i2)%b(1,2)+lg5_78(i7,i8)%c(1,2)*u578_12(i1
     & ,i2)%a(2,2))
      ug5_7812(i7,i8,i1,i2)%b(1,2)=lg5_78(i7,i8)%d(1,1)*p578q*u5
     & 78_12(i1,i2)%b(1,2)+lg5_78(i7,i8)%b(1,2)*u578_12(i1,i2)%a
     & (2,2)
      ug5_7812(i7,i8,i1,i2)%c(1,2)=lg5_78(i7,i8)%a(1,1)*u578_12(
     & i1,i2)%c(1,2)+lg5_78(i7,i8)%c(1,2)*p578q*u578_12(i1,i2)%d
     & (2,2)
      ug5_7812(i7,i8,i1,i2)%d(1,2)=rmass(id5)*(lg5_78(i7,i8)%d(1
     & ,1)*u578_12(i1,i2)%c(1,2)+lg5_78(i7,i8)%b(1,2)*u578_12(i1
     & ,i2)%d(2,2))
      ug5_7812(i7,i8,i1,i2)%a(2,1)=rmass(id5)*(lg5_78(i7,i8)%c(2
     & ,1)*u578_12(i1,i2)%a(1,1)+lg5_78(i7,i8)%a(2,2)*u578_12(i1
     & ,i2)%b(2,1))
      ug5_7812(i7,i8,i1,i2)%b(2,1)=lg5_78(i7,i8)%b(2,1)*u578_12(
     & i1,i2)%a(1,1)+lg5_78(i7,i8)%d(2,2)*p578q*u578_12(i1,i2)%b
     & (2,1)
      ug5_7812(i7,i8,i1,i2)%c(2,1)=lg5_78(i7,i8)%c(2,1)*p578q*u5
     & 78_12(i1,i2)%d(1,1)+lg5_78(i7,i8)%a(2,2)*u578_12(i1,i2)%c
     & (2,1)
      ug5_7812(i7,i8,i1,i2)%d(2,1)=rmass(id5)*(lg5_78(i7,i8)%b(2
     & ,1)*u578_12(i1,i2)%d(1,1)+lg5_78(i7,i8)%d(2,2)*u578_12(i1
     & ,i2)%c(2,1))
      ug5_7812(i7,i8,i1,i2)%a(2,2)=lg5_78(i7,i8)%c(2,1)*p578q*u5
     & 78_12(i1,i2)%b(1,2)+lg5_78(i7,i8)%a(2,2)*u578_12(i1,i2)%a
     & (2,2)
      ug5_7812(i7,i8,i1,i2)%b(2,2)=rmass(id5)*(lg5_78(i7,i8)%b(2
     & ,1)*u578_12(i1,i2)%b(1,2)+lg5_78(i7,i8)%d(2,2)*u578_12(i1
     & ,i2)%a(2,2))
      ug5_7812(i7,i8,i1,i2)%c(2,2)=rmass(id5)*(lg5_78(i7,i8)%c(2
     & ,1)*u578_12(i1,i2)%c(1,2)+lg5_78(i7,i8)%a(2,2)*u578_12(i1
     & ,i2)%d(2,2))
      ug5_7812(i7,i8,i1,i2)%d(2,2)=lg5_78(i7,i8)%b(2,1)*u578_12(
     & i1,i2)%c(1,2)+lg5_78(i7,i8)%d(2,2)*p578q*u578_12(i1,i2)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TT -- aa=ug5_7812(i7,i8,i1,i2)%a,bb=ug5_7812(i7,i8,i1,i2)%b,cc=ug5_781
* 2(i7,i8,i1,i2)%c,dd=ug5_7812(i7,i8,i1,i2)%d,a1=l5_12(i1,i2)%a,b1=l5_12
* (i1,i2)%b,c1=l5_12(i1,i2)%c,d1=l5_12(i1,i2)%d,a2=ug512_78(i7,i8)%a,b2=
* ug512_78(i7,i8)%b,c2=ug512_78(i7,i8)%c,d2=ug512_78(i7,i8)%d,prq=p512q,
* m=rmass(id5),nsum=1
      ug5_7812(i7,i8,i1,i2)%a(1,1)=ug5_7812(i7,i8,i1,i2)%a(1,1)+
     & l5_12(i1,i2)%a(1,1)*ug512_78(i7,i8)%a(1,1)+l5_12(i1,i2)%c
     & (1,2)*p512q*ug512_78(i7,i8)%b(2,1)
      ug5_7812(i7,i8,i1,i2)%b(1,1)=ug5_7812(i7,i8,i1,i2)%b(1,1)+
     & rmass(id5)*(l5_12(i1,i2)%d(1,1)*ug512_78(i7,i8)%a(1,1)+l5
     & _12(i1,i2)%b(1,2)*ug512_78(i7,i8)%b(2,1))
      ug5_7812(i7,i8,i1,i2)%c(1,1)=ug5_7812(i7,i8,i1,i2)%c(1,1)+
     & rmass(id5)*(l5_12(i1,i2)%a(1,1)*ug512_78(i7,i8)%d(1,1)+l5
     & _12(i1,i2)%c(1,2)*ug512_78(i7,i8)%c(2,1))
      ug5_7812(i7,i8,i1,i2)%d(1,1)=ug5_7812(i7,i8,i1,i2)%d(1,1)+
     & l5_12(i1,i2)%d(1,1)*p512q*ug512_78(i7,i8)%d(1,1)+l5_12(i1
     & ,i2)%b(1,2)*ug512_78(i7,i8)%c(2,1)
      ug5_7812(i7,i8,i1,i2)%a(1,2)=ug5_7812(i7,i8,i1,i2)%a(1,2)+
     & rmass(id5)*(l5_12(i1,i2)%a(1,1)*ug512_78(i7,i8)%b(1,2)+l5
     & _12(i1,i2)%c(1,2)*ug512_78(i7,i8)%a(2,2))
      ug5_7812(i7,i8,i1,i2)%b(1,2)=ug5_7812(i7,i8,i1,i2)%b(1,2)+
     & l5_12(i1,i2)%d(1,1)*p512q*ug512_78(i7,i8)%b(1,2)+l5_12(i1
     & ,i2)%b(1,2)*ug512_78(i7,i8)%a(2,2)
      ug5_7812(i7,i8,i1,i2)%c(1,2)=ug5_7812(i7,i8,i1,i2)%c(1,2)+
     & l5_12(i1,i2)%a(1,1)*ug512_78(i7,i8)%c(1,2)+l5_12(i1,i2)%c
     & (1,2)*p512q*ug512_78(i7,i8)%d(2,2)
      ug5_7812(i7,i8,i1,i2)%d(1,2)=ug5_7812(i7,i8,i1,i2)%d(1,2)+
     & rmass(id5)*(l5_12(i1,i2)%d(1,1)*ug512_78(i7,i8)%c(1,2)+l5
     & _12(i1,i2)%b(1,2)*ug512_78(i7,i8)%d(2,2))
      ug5_7812(i7,i8,i1,i2)%a(2,1)=ug5_7812(i7,i8,i1,i2)%a(2,1)+
     & rmass(id5)*(l5_12(i1,i2)%c(2,1)*ug512_78(i7,i8)%a(1,1)+l5
     & _12(i1,i2)%a(2,2)*ug512_78(i7,i8)%b(2,1))
      ug5_7812(i7,i8,i1,i2)%b(2,1)=ug5_7812(i7,i8,i1,i2)%b(2,1)+
     & l5_12(i1,i2)%b(2,1)*ug512_78(i7,i8)%a(1,1)+l5_12(i1,i2)%d
     & (2,2)*p512q*ug512_78(i7,i8)%b(2,1)
      ug5_7812(i7,i8,i1,i2)%c(2,1)=ug5_7812(i7,i8,i1,i2)%c(2,1)+
     & l5_12(i1,i2)%c(2,1)*p512q*ug512_78(i7,i8)%d(1,1)+l5_12(i1
     & ,i2)%a(2,2)*ug512_78(i7,i8)%c(2,1)
      ug5_7812(i7,i8,i1,i2)%d(2,1)=ug5_7812(i7,i8,i1,i2)%d(2,1)+
     & rmass(id5)*(l5_12(i1,i2)%b(2,1)*ug512_78(i7,i8)%d(1,1)+l5
     & _12(i1,i2)%d(2,2)*ug512_78(i7,i8)%c(2,1))
      ug5_7812(i7,i8,i1,i2)%a(2,2)=ug5_7812(i7,i8,i1,i2)%a(2,2)+
     & l5_12(i1,i2)%c(2,1)*p512q*ug512_78(i7,i8)%b(1,2)+l5_12(i1
     & ,i2)%a(2,2)*ug512_78(i7,i8)%a(2,2)
      ug5_7812(i7,i8,i1,i2)%b(2,2)=ug5_7812(i7,i8,i1,i2)%b(2,2)+
     & rmass(id5)*(l5_12(i1,i2)%b(2,1)*ug512_78(i7,i8)%b(1,2)+l5
     & _12(i1,i2)%d(2,2)*ug512_78(i7,i8)%a(2,2))
      ug5_7812(i7,i8,i1,i2)%c(2,2)=ug5_7812(i7,i8,i1,i2)%c(2,2)+
     & rmass(id5)*(l5_12(i1,i2)%c(2,1)*ug512_78(i7,i8)%c(1,2)+l5
     & _12(i1,i2)%a(2,2)*ug512_78(i7,i8)%d(2,2))
      ug5_7812(i7,i8,i1,i2)%d(2,2)=ug5_7812(i7,i8,i1,i2)%d(2,2)+
     & l5_12(i1,i2)%b(2,1)*ug512_78(i7,i8)%c(1,2)+l5_12(i1,i2)%d
     & (2,2)*p512q*ug512_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TTs -- aa=ug5_7812(i7,i8,i1,i2)%a,bb=ug5_7812(i7,i8,i1,i2)%b,cc=ug5_78
* 12(i7,i8,i1,i2)%c,dd=ug5_7812(i7,i8,i1,i2)%d,a1=lg5_78(i7,i8)%a,b1=lg5
* _78(i7,i8)%b,c1=lg5_78(i7,i8)%c,d1=lg5_78(i7,i8)%d,a2=u578_12(i1,i2)%a
* ,b2=u578_12(i1,i2)%b,c2=u578_12(i1,i2)%c,d2=u578_12(i1,i2)%d,prq=p578q
* ,m=rmass(id5),nsum=0
      do jut=1,2
      cx1=u578_12(i1,i2)%a(1,jut)+rmass(id5)*u578_12(i1,i2)%b(1,
     & jut)
      cx2=u578_12(i1,i2)%a(2,jut)+rmass(id5)*u578_12(i1,i2)%b(2,
     & jut)
      cy1=p578q*u578_12(i1,i2)%b(1,jut)+rmass(id5)*u578_12(i1,i2
     & )%a(1,jut)
      cy2=p578q*u578_12(i1,i2)%b(2,jut)+rmass(id5)*u578_12(i1,i2
     & )%a(2,jut)
      cw1=u578_12(i1,i2)%c(1,jut)+rmass(id5)*u578_12(i1,i2)%d(1,
     & jut)
      cw2=u578_12(i1,i2)%c(2,jut)+rmass(id5)*u578_12(i1,i2)%d(2,
     & jut)
      cz1=p578q*u578_12(i1,i2)%d(1,jut)+rmass(id5)*u578_12(i1,i2
     & )%c(1,jut)
      cz2=p578q*u578_12(i1,i2)%d(2,jut)+rmass(id5)*u578_12(i1,i2
     & )%c(2,jut)
      ug5_7812(i7,i8,i1,i2)%a(1,jut)=lg5_78(i7,i8)%a(1,1)*cx1+lg
     & 5_78(i7,i8)%c(1,2)*cy2
      ug5_7812(i7,i8,i1,i2)%b(1,jut)=lg5_78(i7,i8)%d(1,1)*cy1+lg
     & 5_78(i7,i8)%b(1,2)*cx2
      ug5_7812(i7,i8,i1,i2)%c(1,jut)=lg5_78(i7,i8)%a(1,1)*cw1+lg
     & 5_78(i7,i8)%c(1,2)*cz2
      ug5_7812(i7,i8,i1,i2)%d(1,jut)=lg5_78(i7,i8)%d(1,1)*cz1+lg
     & 5_78(i7,i8)%b(1,2)*cw2
      ug5_7812(i7,i8,i1,i2)%a(2,jut)=lg5_78(i7,i8)%c(2,1)*cy1+lg
     & 5_78(i7,i8)%a(2,2)*cx2
      ug5_7812(i7,i8,i1,i2)%b(2,jut)=lg5_78(i7,i8)%b(2,1)*cx1+lg
     & 5_78(i7,i8)%d(2,2)*cy2
      ug5_7812(i7,i8,i1,i2)%c(2,jut)=lg5_78(i7,i8)%c(2,1)*cz1+lg
     & 5_78(i7,i8)%a(2,2)*cw2
      ug5_7812(i7,i8,i1,i2)%d(2,jut)=lg5_78(i7,i8)%b(2,1)*cw1+lg
     & 5_78(i7,i8)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=ug5_7812(i7,i8,i1,i2)%a,bb=ug5_7812(i7,i8,i1,i2)%b,cc=ug5_78
* 12(i7,i8,i1,i2)%c,dd=ug5_7812(i7,i8,i1,i2)%d,a1=l5_12(i1,i2)%a,b1=l5_1
* 2(i1,i2)%b,c1=l5_12(i1,i2)%c,d1=l5_12(i1,i2)%d,a2=ug512_78(i7,i8)%a,b2
* =ug512_78(i7,i8)%b,c2=ug512_78(i7,i8)%c,d2=ug512_78(i7,i8)%d,prq=p512q
* ,m=rmass(id5),nsum=1
      do iut=1,2
      cx1=l5_12(i1,i2)%a(iut,1)+l5_12(i1,i2)%c(iut,1)*rmass(id5)
      cx2=l5_12(i1,i2)%c(iut,2)*p512q+l5_12(i1,i2)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_12(i1,i2)%b(iut,1)+l5_12(i1,i2)%d(iut,1)*rmass(id5)
      cy2=l5_12(i1,i2)%d(iut,2)*p512q+l5_12(i1,i2)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_12(i1,i2)%c(iut,1)*p512q+l5_12(i1,i2)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_12(i1,i2)%a(iut,2)+l5_12(i1,i2)%c(iut,2)*rmass(id5)
      cz1=l5_12(i1,i2)%d(iut,1)*p512q+l5_12(i1,i2)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_12(i1,i2)%b(iut,2)+l5_12(i1,i2)%d(iut,2)*rmass(id5)
      ug5_7812(i7,i8,i1,i2)%a(iut,1)=ug5_7812(i7,i8,i1,i2)%a(iut
     & ,1)+cx1*ug512_78(i7,i8)%a(1,1)+cx2*ug512_78(i7,i8)%b(2,1)
      ug5_7812(i7,i8,i1,i2)%b(iut,1)=ug5_7812(i7,i8,i1,i2)%b(iut
     & ,1)+cy1*ug512_78(i7,i8)%a(1,1)+cy2*ug512_78(i7,i8)%b(2,1)
      ug5_7812(i7,i8,i1,i2)%c(iut,1)=ug5_7812(i7,i8,i1,i2)%c(iut
     & ,1)+cw1*ug512_78(i7,i8)%d(1,1)+cw2*ug512_78(i7,i8)%c(2,1)
      ug5_7812(i7,i8,i1,i2)%d(iut,1)=ug5_7812(i7,i8,i1,i2)%d(iut
     & ,1)+cz1*ug512_78(i7,i8)%d(1,1)+cz2*ug512_78(i7,i8)%c(2,1)
      ug5_7812(i7,i8,i1,i2)%a(iut,2)=ug5_7812(i7,i8,i1,i2)%a(iut
     & ,2)+cw1*ug512_78(i7,i8)%b(1,2)+cw2*ug512_78(i7,i8)%a(2,2)
      ug5_7812(i7,i8,i1,i2)%b(iut,2)=ug5_7812(i7,i8,i1,i2)%b(iut
     & ,2)+cz1*ug512_78(i7,i8)%b(1,2)+cz2*ug512_78(i7,i8)%a(2,2)
      ug5_7812(i7,i8,i1,i2)%c(iut,2)=ug5_7812(i7,i8,i1,i2)%c(iut
     & ,2)+cx1*ug512_78(i7,i8)%c(1,2)+cx2*ug512_78(i7,i8)%d(2,2)
      ug5_7812(i7,i8,i1,i2)%d(iut,2)=ug5_7812(i7,i8,i1,i2)%d(iut
     & ,2)+cy1*ug512_78(i7,i8)%c(1,2)+cy2*ug512_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id5).ne.1 .and. ilept(id3).ne.1)then
        if(id5.ne.5 .or. id7.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=ug5_3478(i3,i4,i7,i8)%a,bb=ug5_3478(i3,i4,i7,i8)%b,cc=ug5_347
* 8(i3,i4,i7,i8)%c,dd=ug5_3478(i3,i4,i7,i8)%d,a1=lg5_34(i3,i4)%a,b1=lg5_
* 34(i3,i4)%b,c1=lg5_34(i3,i4)%c,d1=lg5_34(i3,i4)%d,a2=u534_78(i7,i8)%a,
* b2=u534_78(i7,i8)%b,c2=u534_78(i7,i8)%c,d2=u534_78(i7,i8)%d,prq=p534q,
* m=rmass(id5),nsum=0
      ug5_3478(i3,i4,i7,i8)%a(1,1)=lg5_34(i3,i4)%a(1,1)*u534_78(
     & i7,i8)%a(1,1)+lg5_34(i3,i4)%c(1,2)*p534q*u534_78(i7,i8)%b
     & (2,1)
      ug5_3478(i3,i4,i7,i8)%b(1,1)=rmass(id5)*(lg5_34(i3,i4)%d(1
     & ,1)*u534_78(i7,i8)%a(1,1)+lg5_34(i3,i4)%b(1,2)*u534_78(i7
     & ,i8)%b(2,1))
      ug5_3478(i3,i4,i7,i8)%c(1,1)=rmass(id5)*(lg5_34(i3,i4)%a(1
     & ,1)*u534_78(i7,i8)%d(1,1)+lg5_34(i3,i4)%c(1,2)*u534_78(i7
     & ,i8)%c(2,1))
      ug5_3478(i3,i4,i7,i8)%d(1,1)=lg5_34(i3,i4)%d(1,1)*p534q*u5
     & 34_78(i7,i8)%d(1,1)+lg5_34(i3,i4)%b(1,2)*u534_78(i7,i8)%c
     & (2,1)
      ug5_3478(i3,i4,i7,i8)%a(1,2)=rmass(id5)*(lg5_34(i3,i4)%a(1
     & ,1)*u534_78(i7,i8)%b(1,2)+lg5_34(i3,i4)%c(1,2)*u534_78(i7
     & ,i8)%a(2,2))
      ug5_3478(i3,i4,i7,i8)%b(1,2)=lg5_34(i3,i4)%d(1,1)*p534q*u5
     & 34_78(i7,i8)%b(1,2)+lg5_34(i3,i4)%b(1,2)*u534_78(i7,i8)%a
     & (2,2)
      ug5_3478(i3,i4,i7,i8)%c(1,2)=lg5_34(i3,i4)%a(1,1)*u534_78(
     & i7,i8)%c(1,2)+lg5_34(i3,i4)%c(1,2)*p534q*u534_78(i7,i8)%d
     & (2,2)
      ug5_3478(i3,i4,i7,i8)%d(1,2)=rmass(id5)*(lg5_34(i3,i4)%d(1
     & ,1)*u534_78(i7,i8)%c(1,2)+lg5_34(i3,i4)%b(1,2)*u534_78(i7
     & ,i8)%d(2,2))
      ug5_3478(i3,i4,i7,i8)%a(2,1)=rmass(id5)*(lg5_34(i3,i4)%c(2
     & ,1)*u534_78(i7,i8)%a(1,1)+lg5_34(i3,i4)%a(2,2)*u534_78(i7
     & ,i8)%b(2,1))
      ug5_3478(i3,i4,i7,i8)%b(2,1)=lg5_34(i3,i4)%b(2,1)*u534_78(
     & i7,i8)%a(1,1)+lg5_34(i3,i4)%d(2,2)*p534q*u534_78(i7,i8)%b
     & (2,1)
      ug5_3478(i3,i4,i7,i8)%c(2,1)=lg5_34(i3,i4)%c(2,1)*p534q*u5
     & 34_78(i7,i8)%d(1,1)+lg5_34(i3,i4)%a(2,2)*u534_78(i7,i8)%c
     & (2,1)
      ug5_3478(i3,i4,i7,i8)%d(2,1)=rmass(id5)*(lg5_34(i3,i4)%b(2
     & ,1)*u534_78(i7,i8)%d(1,1)+lg5_34(i3,i4)%d(2,2)*u534_78(i7
     & ,i8)%c(2,1))
      ug5_3478(i3,i4,i7,i8)%a(2,2)=lg5_34(i3,i4)%c(2,1)*p534q*u5
     & 34_78(i7,i8)%b(1,2)+lg5_34(i3,i4)%a(2,2)*u534_78(i7,i8)%a
     & (2,2)
      ug5_3478(i3,i4,i7,i8)%b(2,2)=rmass(id5)*(lg5_34(i3,i4)%b(2
     & ,1)*u534_78(i7,i8)%b(1,2)+lg5_34(i3,i4)%d(2,2)*u534_78(i7
     & ,i8)%a(2,2))
      ug5_3478(i3,i4,i7,i8)%c(2,2)=rmass(id5)*(lg5_34(i3,i4)%c(2
     & ,1)*u534_78(i7,i8)%c(1,2)+lg5_34(i3,i4)%a(2,2)*u534_78(i7
     & ,i8)%d(2,2))
      ug5_3478(i3,i4,i7,i8)%d(2,2)=lg5_34(i3,i4)%b(2,1)*u534_78(
     & i7,i8)%c(1,2)+lg5_34(i3,i4)%d(2,2)*p534q*u534_78(i7,i8)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TT -- aa=ug5_3478(i3,i4,i7,i8)%a,bb=ug5_3478(i3,i4,i7,i8)%b,cc=ug5_347
* 8(i3,i4,i7,i8)%c,dd=ug5_3478(i3,i4,i7,i8)%d,a1=l5_78(i7,i8)%a,b1=l5_78
* (i7,i8)%b,c1=l5_78(i7,i8)%c,d1=l5_78(i7,i8)%d,a2=ug578_34(i3,i4)%a,b2=
* ug578_34(i3,i4)%b,c2=ug578_34(i3,i4)%c,d2=ug578_34(i3,i4)%d,prq=p578q,
* m=rmass(id5),nsum=1
      ug5_3478(i3,i4,i7,i8)%a(1,1)=ug5_3478(i3,i4,i7,i8)%a(1,1)+
     & l5_78(i7,i8)%a(1,1)*ug578_34(i3,i4)%a(1,1)+l5_78(i7,i8)%c
     & (1,2)*p578q*ug578_34(i3,i4)%b(2,1)
      ug5_3478(i3,i4,i7,i8)%b(1,1)=ug5_3478(i3,i4,i7,i8)%b(1,1)+
     & rmass(id5)*(l5_78(i7,i8)%d(1,1)*ug578_34(i3,i4)%a(1,1)+l5
     & _78(i7,i8)%b(1,2)*ug578_34(i3,i4)%b(2,1))
      ug5_3478(i3,i4,i7,i8)%c(1,1)=ug5_3478(i3,i4,i7,i8)%c(1,1)+
     & rmass(id5)*(l5_78(i7,i8)%a(1,1)*ug578_34(i3,i4)%d(1,1)+l5
     & _78(i7,i8)%c(1,2)*ug578_34(i3,i4)%c(2,1))
      ug5_3478(i3,i4,i7,i8)%d(1,1)=ug5_3478(i3,i4,i7,i8)%d(1,1)+
     & l5_78(i7,i8)%d(1,1)*p578q*ug578_34(i3,i4)%d(1,1)+l5_78(i7
     & ,i8)%b(1,2)*ug578_34(i3,i4)%c(2,1)
      ug5_3478(i3,i4,i7,i8)%a(1,2)=ug5_3478(i3,i4,i7,i8)%a(1,2)+
     & rmass(id5)*(l5_78(i7,i8)%a(1,1)*ug578_34(i3,i4)%b(1,2)+l5
     & _78(i7,i8)%c(1,2)*ug578_34(i3,i4)%a(2,2))
      ug5_3478(i3,i4,i7,i8)%b(1,2)=ug5_3478(i3,i4,i7,i8)%b(1,2)+
     & l5_78(i7,i8)%d(1,1)*p578q*ug578_34(i3,i4)%b(1,2)+l5_78(i7
     & ,i8)%b(1,2)*ug578_34(i3,i4)%a(2,2)
      ug5_3478(i3,i4,i7,i8)%c(1,2)=ug5_3478(i3,i4,i7,i8)%c(1,2)+
     & l5_78(i7,i8)%a(1,1)*ug578_34(i3,i4)%c(1,2)+l5_78(i7,i8)%c
     & (1,2)*p578q*ug578_34(i3,i4)%d(2,2)
      ug5_3478(i3,i4,i7,i8)%d(1,2)=ug5_3478(i3,i4,i7,i8)%d(1,2)+
     & rmass(id5)*(l5_78(i7,i8)%d(1,1)*ug578_34(i3,i4)%c(1,2)+l5
     & _78(i7,i8)%b(1,2)*ug578_34(i3,i4)%d(2,2))
      ug5_3478(i3,i4,i7,i8)%a(2,1)=ug5_3478(i3,i4,i7,i8)%a(2,1)+
     & rmass(id5)*(l5_78(i7,i8)%c(2,1)*ug578_34(i3,i4)%a(1,1)+l5
     & _78(i7,i8)%a(2,2)*ug578_34(i3,i4)%b(2,1))
      ug5_3478(i3,i4,i7,i8)%b(2,1)=ug5_3478(i3,i4,i7,i8)%b(2,1)+
     & l5_78(i7,i8)%b(2,1)*ug578_34(i3,i4)%a(1,1)+l5_78(i7,i8)%d
     & (2,2)*p578q*ug578_34(i3,i4)%b(2,1)
      ug5_3478(i3,i4,i7,i8)%c(2,1)=ug5_3478(i3,i4,i7,i8)%c(2,1)+
     & l5_78(i7,i8)%c(2,1)*p578q*ug578_34(i3,i4)%d(1,1)+l5_78(i7
     & ,i8)%a(2,2)*ug578_34(i3,i4)%c(2,1)
      ug5_3478(i3,i4,i7,i8)%d(2,1)=ug5_3478(i3,i4,i7,i8)%d(2,1)+
     & rmass(id5)*(l5_78(i7,i8)%b(2,1)*ug578_34(i3,i4)%d(1,1)+l5
     & _78(i7,i8)%d(2,2)*ug578_34(i3,i4)%c(2,1))
      ug5_3478(i3,i4,i7,i8)%a(2,2)=ug5_3478(i3,i4,i7,i8)%a(2,2)+
     & l5_78(i7,i8)%c(2,1)*p578q*ug578_34(i3,i4)%b(1,2)+l5_78(i7
     & ,i8)%a(2,2)*ug578_34(i3,i4)%a(2,2)
      ug5_3478(i3,i4,i7,i8)%b(2,2)=ug5_3478(i3,i4,i7,i8)%b(2,2)+
     & rmass(id5)*(l5_78(i7,i8)%b(2,1)*ug578_34(i3,i4)%b(1,2)+l5
     & _78(i7,i8)%d(2,2)*ug578_34(i3,i4)%a(2,2))
      ug5_3478(i3,i4,i7,i8)%c(2,2)=ug5_3478(i3,i4,i7,i8)%c(2,2)+
     & rmass(id5)*(l5_78(i7,i8)%c(2,1)*ug578_34(i3,i4)%c(1,2)+l5
     & _78(i7,i8)%a(2,2)*ug578_34(i3,i4)%d(2,2))
      ug5_3478(i3,i4,i7,i8)%d(2,2)=ug5_3478(i3,i4,i7,i8)%d(2,2)+
     & l5_78(i7,i8)%b(2,1)*ug578_34(i3,i4)%c(1,2)+l5_78(i7,i8)%d
     & (2,2)*p578q*ug578_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TTs -- aa=ug5_3478(i3,i4,i7,i8)%a,bb=ug5_3478(i3,i4,i7,i8)%b,cc=ug5_34
* 78(i3,i4,i7,i8)%c,dd=ug5_3478(i3,i4,i7,i8)%d,a1=lg5_34(i3,i4)%a,b1=lg5
* _34(i3,i4)%b,c1=lg5_34(i3,i4)%c,d1=lg5_34(i3,i4)%d,a2=u534_78(i7,i8)%a
* ,b2=u534_78(i7,i8)%b,c2=u534_78(i7,i8)%c,d2=u534_78(i7,i8)%d,prq=p534q
* ,m=rmass(id5),nsum=0
      do jut=1,2
      cx1=u534_78(i7,i8)%a(1,jut)+rmass(id5)*u534_78(i7,i8)%b(1,
     & jut)
      cx2=u534_78(i7,i8)%a(2,jut)+rmass(id5)*u534_78(i7,i8)%b(2,
     & jut)
      cy1=p534q*u534_78(i7,i8)%b(1,jut)+rmass(id5)*u534_78(i7,i8
     & )%a(1,jut)
      cy2=p534q*u534_78(i7,i8)%b(2,jut)+rmass(id5)*u534_78(i7,i8
     & )%a(2,jut)
      cw1=u534_78(i7,i8)%c(1,jut)+rmass(id5)*u534_78(i7,i8)%d(1,
     & jut)
      cw2=u534_78(i7,i8)%c(2,jut)+rmass(id5)*u534_78(i7,i8)%d(2,
     & jut)
      cz1=p534q*u534_78(i7,i8)%d(1,jut)+rmass(id5)*u534_78(i7,i8
     & )%c(1,jut)
      cz2=p534q*u534_78(i7,i8)%d(2,jut)+rmass(id5)*u534_78(i7,i8
     & )%c(2,jut)
      ug5_3478(i3,i4,i7,i8)%a(1,jut)=lg5_34(i3,i4)%a(1,1)*cx1+lg
     & 5_34(i3,i4)%c(1,2)*cy2
      ug5_3478(i3,i4,i7,i8)%b(1,jut)=lg5_34(i3,i4)%d(1,1)*cy1+lg
     & 5_34(i3,i4)%b(1,2)*cx2
      ug5_3478(i3,i4,i7,i8)%c(1,jut)=lg5_34(i3,i4)%a(1,1)*cw1+lg
     & 5_34(i3,i4)%c(1,2)*cz2
      ug5_3478(i3,i4,i7,i8)%d(1,jut)=lg5_34(i3,i4)%d(1,1)*cz1+lg
     & 5_34(i3,i4)%b(1,2)*cw2
      ug5_3478(i3,i4,i7,i8)%a(2,jut)=lg5_34(i3,i4)%c(2,1)*cy1+lg
     & 5_34(i3,i4)%a(2,2)*cx2
      ug5_3478(i3,i4,i7,i8)%b(2,jut)=lg5_34(i3,i4)%b(2,1)*cx1+lg
     & 5_34(i3,i4)%d(2,2)*cy2
      ug5_3478(i3,i4,i7,i8)%c(2,jut)=lg5_34(i3,i4)%c(2,1)*cz1+lg
     & 5_34(i3,i4)%a(2,2)*cw2
      ug5_3478(i3,i4,i7,i8)%d(2,jut)=lg5_34(i3,i4)%b(2,1)*cw1+lg
     & 5_34(i3,i4)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=ug5_3478(i3,i4,i7,i8)%a,bb=ug5_3478(i3,i4,i7,i8)%b,cc=ug5_34
* 78(i3,i4,i7,i8)%c,dd=ug5_3478(i3,i4,i7,i8)%d,a1=l5_78(i7,i8)%a,b1=l5_7
* 8(i7,i8)%b,c1=l5_78(i7,i8)%c,d1=l5_78(i7,i8)%d,a2=ug578_34(i3,i4)%a,b2
* =ug578_34(i3,i4)%b,c2=ug578_34(i3,i4)%c,d2=ug578_34(i3,i4)%d,prq=p578q
* ,m=rmass(id5),nsum=1
      do iut=1,2
      cx1=l5_78(i7,i8)%a(iut,1)+l5_78(i7,i8)%c(iut,1)*rmass(id5)
      cx2=l5_78(i7,i8)%c(iut,2)*p578q+l5_78(i7,i8)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_78(i7,i8)%b(iut,1)+l5_78(i7,i8)%d(iut,1)*rmass(id5)
      cy2=l5_78(i7,i8)%d(iut,2)*p578q+l5_78(i7,i8)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_78(i7,i8)%c(iut,1)*p578q+l5_78(i7,i8)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_78(i7,i8)%a(iut,2)+l5_78(i7,i8)%c(iut,2)*rmass(id5)
      cz1=l5_78(i7,i8)%d(iut,1)*p578q+l5_78(i7,i8)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_78(i7,i8)%b(iut,2)+l5_78(i7,i8)%d(iut,2)*rmass(id5)
      ug5_3478(i3,i4,i7,i8)%a(iut,1)=ug5_3478(i3,i4,i7,i8)%a(iut
     & ,1)+cx1*ug578_34(i3,i4)%a(1,1)+cx2*ug578_34(i3,i4)%b(2,1)
      ug5_3478(i3,i4,i7,i8)%b(iut,1)=ug5_3478(i3,i4,i7,i8)%b(iut
     & ,1)+cy1*ug578_34(i3,i4)%a(1,1)+cy2*ug578_34(i3,i4)%b(2,1)
      ug5_3478(i3,i4,i7,i8)%c(iut,1)=ug5_3478(i3,i4,i7,i8)%c(iut
     & ,1)+cw1*ug578_34(i3,i4)%d(1,1)+cw2*ug578_34(i3,i4)%c(2,1)
      ug5_3478(i3,i4,i7,i8)%d(iut,1)=ug5_3478(i3,i4,i7,i8)%d(iut
     & ,1)+cz1*ug578_34(i3,i4)%d(1,1)+cz2*ug578_34(i3,i4)%c(2,1)
      ug5_3478(i3,i4,i7,i8)%a(iut,2)=ug5_3478(i3,i4,i7,i8)%a(iut
     & ,2)+cw1*ug578_34(i3,i4)%b(1,2)+cw2*ug578_34(i3,i4)%a(2,2)
      ug5_3478(i3,i4,i7,i8)%b(iut,2)=ug5_3478(i3,i4,i7,i8)%b(iut
     & ,2)+cz1*ug578_34(i3,i4)%b(1,2)+cz2*ug578_34(i3,i4)%a(2,2)
      ug5_3478(i3,i4,i7,i8)%c(iut,2)=ug5_3478(i3,i4,i7,i8)%c(iut
     & ,2)+cx1*ug578_34(i3,i4)%c(1,2)+cx2*ug578_34(i3,i4)%d(2,2)
      ug5_3478(i3,i4,i7,i8)%d(iut,2)=ug5_3478(i3,i4,i7,i8)%d(iut
     & ,2)+cy1*ug578_34(i3,i4)%c(1,2)+cy2*ug578_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id5).ne.1 .and. ilept(id7).ne.1)then
        if(id5.ne.5 .or. id3.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=ug5_7834(i7,i8,i3,i4)%a,bb=ug5_7834(i7,i8,i3,i4)%b,cc=ug5_783
* 4(i7,i8,i3,i4)%c,dd=ug5_7834(i7,i8,i3,i4)%d,a1=lg5_78(i7,i8)%a,b1=lg5_
* 78(i7,i8)%b,c1=lg5_78(i7,i8)%c,d1=lg5_78(i7,i8)%d,a2=u578_34(i3,i4)%a,
* b2=u578_34(i3,i4)%b,c2=u578_34(i3,i4)%c,d2=u578_34(i3,i4)%d,prq=p578q,
* m=rmass(id5),nsum=0
      ug5_7834(i7,i8,i3,i4)%a(1,1)=lg5_78(i7,i8)%a(1,1)*u578_34(
     & i3,i4)%a(1,1)+lg5_78(i7,i8)%c(1,2)*p578q*u578_34(i3,i4)%b
     & (2,1)
      ug5_7834(i7,i8,i3,i4)%b(1,1)=rmass(id5)*(lg5_78(i7,i8)%d(1
     & ,1)*u578_34(i3,i4)%a(1,1)+lg5_78(i7,i8)%b(1,2)*u578_34(i3
     & ,i4)%b(2,1))
      ug5_7834(i7,i8,i3,i4)%c(1,1)=rmass(id5)*(lg5_78(i7,i8)%a(1
     & ,1)*u578_34(i3,i4)%d(1,1)+lg5_78(i7,i8)%c(1,2)*u578_34(i3
     & ,i4)%c(2,1))
      ug5_7834(i7,i8,i3,i4)%d(1,1)=lg5_78(i7,i8)%d(1,1)*p578q*u5
     & 78_34(i3,i4)%d(1,1)+lg5_78(i7,i8)%b(1,2)*u578_34(i3,i4)%c
     & (2,1)
      ug5_7834(i7,i8,i3,i4)%a(1,2)=rmass(id5)*(lg5_78(i7,i8)%a(1
     & ,1)*u578_34(i3,i4)%b(1,2)+lg5_78(i7,i8)%c(1,2)*u578_34(i3
     & ,i4)%a(2,2))
      ug5_7834(i7,i8,i3,i4)%b(1,2)=lg5_78(i7,i8)%d(1,1)*p578q*u5
     & 78_34(i3,i4)%b(1,2)+lg5_78(i7,i8)%b(1,2)*u578_34(i3,i4)%a
     & (2,2)
      ug5_7834(i7,i8,i3,i4)%c(1,2)=lg5_78(i7,i8)%a(1,1)*u578_34(
     & i3,i4)%c(1,2)+lg5_78(i7,i8)%c(1,2)*p578q*u578_34(i3,i4)%d
     & (2,2)
      ug5_7834(i7,i8,i3,i4)%d(1,2)=rmass(id5)*(lg5_78(i7,i8)%d(1
     & ,1)*u578_34(i3,i4)%c(1,2)+lg5_78(i7,i8)%b(1,2)*u578_34(i3
     & ,i4)%d(2,2))
      ug5_7834(i7,i8,i3,i4)%a(2,1)=rmass(id5)*(lg5_78(i7,i8)%c(2
     & ,1)*u578_34(i3,i4)%a(1,1)+lg5_78(i7,i8)%a(2,2)*u578_34(i3
     & ,i4)%b(2,1))
      ug5_7834(i7,i8,i3,i4)%b(2,1)=lg5_78(i7,i8)%b(2,1)*u578_34(
     & i3,i4)%a(1,1)+lg5_78(i7,i8)%d(2,2)*p578q*u578_34(i3,i4)%b
     & (2,1)
      ug5_7834(i7,i8,i3,i4)%c(2,1)=lg5_78(i7,i8)%c(2,1)*p578q*u5
     & 78_34(i3,i4)%d(1,1)+lg5_78(i7,i8)%a(2,2)*u578_34(i3,i4)%c
     & (2,1)
      ug5_7834(i7,i8,i3,i4)%d(2,1)=rmass(id5)*(lg5_78(i7,i8)%b(2
     & ,1)*u578_34(i3,i4)%d(1,1)+lg5_78(i7,i8)%d(2,2)*u578_34(i3
     & ,i4)%c(2,1))
      ug5_7834(i7,i8,i3,i4)%a(2,2)=lg5_78(i7,i8)%c(2,1)*p578q*u5
     & 78_34(i3,i4)%b(1,2)+lg5_78(i7,i8)%a(2,2)*u578_34(i3,i4)%a
     & (2,2)
      ug5_7834(i7,i8,i3,i4)%b(2,2)=rmass(id5)*(lg5_78(i7,i8)%b(2
     & ,1)*u578_34(i3,i4)%b(1,2)+lg5_78(i7,i8)%d(2,2)*u578_34(i3
     & ,i4)%a(2,2))
      ug5_7834(i7,i8,i3,i4)%c(2,2)=rmass(id5)*(lg5_78(i7,i8)%c(2
     & ,1)*u578_34(i3,i4)%c(1,2)+lg5_78(i7,i8)%a(2,2)*u578_34(i3
     & ,i4)%d(2,2))
      ug5_7834(i7,i8,i3,i4)%d(2,2)=lg5_78(i7,i8)%b(2,1)*u578_34(
     & i3,i4)%c(1,2)+lg5_78(i7,i8)%d(2,2)*p578q*u578_34(i3,i4)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=ug5_7834(i7,i8,i3,i4)%a,bb=ug5_7834(i7,i8,i3,i4)%b,cc=ug5_783
* 4(i7,i8,i3,i4)%c,dd=ug5_7834(i7,i8,i3,i4)%d,a1=l5_34(i3,i4)%a,b1=l5_34
* (i3,i4)%b,c1=l5_34(i3,i4)%c,d1=l5_34(i3,i4)%d,a2=ug534_78(i7,i8)%a,b2=
* ug534_78(i7,i8)%b,c2=ug534_78(i7,i8)%c,d2=ug534_78(i7,i8)%d,prq=p534q,
* m=rmass(id5),nsum=1
      ug5_7834(i7,i8,i3,i4)%a(1,1)=ug5_7834(i7,i8,i3,i4)%a(1,1)+
     & l5_34(i3,i4)%a(1,1)*ug534_78(i7,i8)%a(1,1)+l5_34(i3,i4)%c
     & (1,2)*p534q*ug534_78(i7,i8)%b(2,1)
      ug5_7834(i7,i8,i3,i4)%b(1,1)=ug5_7834(i7,i8,i3,i4)%b(1,1)+
     & rmass(id5)*(l5_34(i3,i4)%d(1,1)*ug534_78(i7,i8)%a(1,1)+l5
     & _34(i3,i4)%b(1,2)*ug534_78(i7,i8)%b(2,1))
      ug5_7834(i7,i8,i3,i4)%c(1,1)=ug5_7834(i7,i8,i3,i4)%c(1,1)+
     & rmass(id5)*(l5_34(i3,i4)%a(1,1)*ug534_78(i7,i8)%d(1,1)+l5
     & _34(i3,i4)%c(1,2)*ug534_78(i7,i8)%c(2,1))
      ug5_7834(i7,i8,i3,i4)%d(1,1)=ug5_7834(i7,i8,i3,i4)%d(1,1)+
     & l5_34(i3,i4)%d(1,1)*p534q*ug534_78(i7,i8)%d(1,1)+l5_34(i3
     & ,i4)%b(1,2)*ug534_78(i7,i8)%c(2,1)
      ug5_7834(i7,i8,i3,i4)%a(1,2)=ug5_7834(i7,i8,i3,i4)%a(1,2)+
     & rmass(id5)*(l5_34(i3,i4)%a(1,1)*ug534_78(i7,i8)%b(1,2)+l5
     & _34(i3,i4)%c(1,2)*ug534_78(i7,i8)%a(2,2))
      ug5_7834(i7,i8,i3,i4)%b(1,2)=ug5_7834(i7,i8,i3,i4)%b(1,2)+
     & l5_34(i3,i4)%d(1,1)*p534q*ug534_78(i7,i8)%b(1,2)+l5_34(i3
     & ,i4)%b(1,2)*ug534_78(i7,i8)%a(2,2)
      ug5_7834(i7,i8,i3,i4)%c(1,2)=ug5_7834(i7,i8,i3,i4)%c(1,2)+
     & l5_34(i3,i4)%a(1,1)*ug534_78(i7,i8)%c(1,2)+l5_34(i3,i4)%c
     & (1,2)*p534q*ug534_78(i7,i8)%d(2,2)
      ug5_7834(i7,i8,i3,i4)%d(1,2)=ug5_7834(i7,i8,i3,i4)%d(1,2)+
     & rmass(id5)*(l5_34(i3,i4)%d(1,1)*ug534_78(i7,i8)%c(1,2)+l5
     & _34(i3,i4)%b(1,2)*ug534_78(i7,i8)%d(2,2))
      ug5_7834(i7,i8,i3,i4)%a(2,1)=ug5_7834(i7,i8,i3,i4)%a(2,1)+
     & rmass(id5)*(l5_34(i3,i4)%c(2,1)*ug534_78(i7,i8)%a(1,1)+l5
     & _34(i3,i4)%a(2,2)*ug534_78(i7,i8)%b(2,1))
      ug5_7834(i7,i8,i3,i4)%b(2,1)=ug5_7834(i7,i8,i3,i4)%b(2,1)+
     & l5_34(i3,i4)%b(2,1)*ug534_78(i7,i8)%a(1,1)+l5_34(i3,i4)%d
     & (2,2)*p534q*ug534_78(i7,i8)%b(2,1)
      ug5_7834(i7,i8,i3,i4)%c(2,1)=ug5_7834(i7,i8,i3,i4)%c(2,1)+
     & l5_34(i3,i4)%c(2,1)*p534q*ug534_78(i7,i8)%d(1,1)+l5_34(i3
     & ,i4)%a(2,2)*ug534_78(i7,i8)%c(2,1)
      ug5_7834(i7,i8,i3,i4)%d(2,1)=ug5_7834(i7,i8,i3,i4)%d(2,1)+
     & rmass(id5)*(l5_34(i3,i4)%b(2,1)*ug534_78(i7,i8)%d(1,1)+l5
     & _34(i3,i4)%d(2,2)*ug534_78(i7,i8)%c(2,1))
      ug5_7834(i7,i8,i3,i4)%a(2,2)=ug5_7834(i7,i8,i3,i4)%a(2,2)+
     & l5_34(i3,i4)%c(2,1)*p534q*ug534_78(i7,i8)%b(1,2)+l5_34(i3
     & ,i4)%a(2,2)*ug534_78(i7,i8)%a(2,2)
      ug5_7834(i7,i8,i3,i4)%b(2,2)=ug5_7834(i7,i8,i3,i4)%b(2,2)+
     & rmass(id5)*(l5_34(i3,i4)%b(2,1)*ug534_78(i7,i8)%b(1,2)+l5
     & _34(i3,i4)%d(2,2)*ug534_78(i7,i8)%a(2,2))
      ug5_7834(i7,i8,i3,i4)%c(2,2)=ug5_7834(i7,i8,i3,i4)%c(2,2)+
     & rmass(id5)*(l5_34(i3,i4)%c(2,1)*ug534_78(i7,i8)%c(1,2)+l5
     & _34(i3,i4)%a(2,2)*ug534_78(i7,i8)%d(2,2))
      ug5_7834(i7,i8,i3,i4)%d(2,2)=ug5_7834(i7,i8,i3,i4)%d(2,2)+
     & l5_34(i3,i4)%b(2,1)*ug534_78(i7,i8)%c(1,2)+l5_34(i3,i4)%d
     & (2,2)*p534q*ug534_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TTs -- aa=ug5_7834(i7,i8,i3,i4)%a,bb=ug5_7834(i7,i8,i3,i4)%b,cc=ug5_78
* 34(i7,i8,i3,i4)%c,dd=ug5_7834(i7,i8,i3,i4)%d,a1=lg5_78(i7,i8)%a,b1=lg5
* _78(i7,i8)%b,c1=lg5_78(i7,i8)%c,d1=lg5_78(i7,i8)%d,a2=u578_34(i3,i4)%a
* ,b2=u578_34(i3,i4)%b,c2=u578_34(i3,i4)%c,d2=u578_34(i3,i4)%d,prq=p578q
* ,m=rmass(id5),nsum=0
      do jut=1,2
      cx1=u578_34(i3,i4)%a(1,jut)+rmass(id5)*u578_34(i3,i4)%b(1,
     & jut)
      cx2=u578_34(i3,i4)%a(2,jut)+rmass(id5)*u578_34(i3,i4)%b(2,
     & jut)
      cy1=p578q*u578_34(i3,i4)%b(1,jut)+rmass(id5)*u578_34(i3,i4
     & )%a(1,jut)
      cy2=p578q*u578_34(i3,i4)%b(2,jut)+rmass(id5)*u578_34(i3,i4
     & )%a(2,jut)
      cw1=u578_34(i3,i4)%c(1,jut)+rmass(id5)*u578_34(i3,i4)%d(1,
     & jut)
      cw2=u578_34(i3,i4)%c(2,jut)+rmass(id5)*u578_34(i3,i4)%d(2,
     & jut)
      cz1=p578q*u578_34(i3,i4)%d(1,jut)+rmass(id5)*u578_34(i3,i4
     & )%c(1,jut)
      cz2=p578q*u578_34(i3,i4)%d(2,jut)+rmass(id5)*u578_34(i3,i4
     & )%c(2,jut)
      ug5_7834(i7,i8,i3,i4)%a(1,jut)=lg5_78(i7,i8)%a(1,1)*cx1+lg
     & 5_78(i7,i8)%c(1,2)*cy2
      ug5_7834(i7,i8,i3,i4)%b(1,jut)=lg5_78(i7,i8)%d(1,1)*cy1+lg
     & 5_78(i7,i8)%b(1,2)*cx2
      ug5_7834(i7,i8,i3,i4)%c(1,jut)=lg5_78(i7,i8)%a(1,1)*cw1+lg
     & 5_78(i7,i8)%c(1,2)*cz2
      ug5_7834(i7,i8,i3,i4)%d(1,jut)=lg5_78(i7,i8)%d(1,1)*cz1+lg
     & 5_78(i7,i8)%b(1,2)*cw2
      ug5_7834(i7,i8,i3,i4)%a(2,jut)=lg5_78(i7,i8)%c(2,1)*cy1+lg
     & 5_78(i7,i8)%a(2,2)*cx2
      ug5_7834(i7,i8,i3,i4)%b(2,jut)=lg5_78(i7,i8)%b(2,1)*cx1+lg
     & 5_78(i7,i8)%d(2,2)*cy2
      ug5_7834(i7,i8,i3,i4)%c(2,jut)=lg5_78(i7,i8)%c(2,1)*cz1+lg
     & 5_78(i7,i8)%a(2,2)*cw2
      ug5_7834(i7,i8,i3,i4)%d(2,jut)=lg5_78(i7,i8)%b(2,1)*cw1+lg
     & 5_78(i7,i8)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=ug5_7834(i7,i8,i3,i4)%a,bb=ug5_7834(i7,i8,i3,i4)%b,cc=ug5_78
* 34(i7,i8,i3,i4)%c,dd=ug5_7834(i7,i8,i3,i4)%d,a1=l5_34(i3,i4)%a,b1=l5_3
* 4(i3,i4)%b,c1=l5_34(i3,i4)%c,d1=l5_34(i3,i4)%d,a2=ug534_78(i7,i8)%a,b2
* =ug534_78(i7,i8)%b,c2=ug534_78(i7,i8)%c,d2=ug534_78(i7,i8)%d,prq=p534q
* ,m=rmass(id5),nsum=1
      do iut=1,2
      cx1=l5_34(i3,i4)%a(iut,1)+l5_34(i3,i4)%c(iut,1)*rmass(id5)
      cx2=l5_34(i3,i4)%c(iut,2)*p534q+l5_34(i3,i4)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_34(i3,i4)%b(iut,1)+l5_34(i3,i4)%d(iut,1)*rmass(id5)
      cy2=l5_34(i3,i4)%d(iut,2)*p534q+l5_34(i3,i4)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_34(i3,i4)%c(iut,1)*p534q+l5_34(i3,i4)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_34(i3,i4)%a(iut,2)+l5_34(i3,i4)%c(iut,2)*rmass(id5)
      cz1=l5_34(i3,i4)%d(iut,1)*p534q+l5_34(i3,i4)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_34(i3,i4)%b(iut,2)+l5_34(i3,i4)%d(iut,2)*rmass(id5)
      ug5_7834(i7,i8,i3,i4)%a(iut,1)=ug5_7834(i7,i8,i3,i4)%a(iut
     & ,1)+cx1*ug534_78(i7,i8)%a(1,1)+cx2*ug534_78(i7,i8)%b(2,1)
      ug5_7834(i7,i8,i3,i4)%b(iut,1)=ug5_7834(i7,i8,i3,i4)%b(iut
     & ,1)+cy1*ug534_78(i7,i8)%a(1,1)+cy2*ug534_78(i7,i8)%b(2,1)
      ug5_7834(i7,i8,i3,i4)%c(iut,1)=ug5_7834(i7,i8,i3,i4)%c(iut
     & ,1)+cw1*ug534_78(i7,i8)%d(1,1)+cw2*ug534_78(i7,i8)%c(2,1)
      ug5_7834(i7,i8,i3,i4)%d(iut,1)=ug5_7834(i7,i8,i3,i4)%d(iut
     & ,1)+cz1*ug534_78(i7,i8)%d(1,1)+cz2*ug534_78(i7,i8)%c(2,1)
      ug5_7834(i7,i8,i3,i4)%a(iut,2)=ug5_7834(i7,i8,i3,i4)%a(iut
     & ,2)+cw1*ug534_78(i7,i8)%b(1,2)+cw2*ug534_78(i7,i8)%a(2,2)
      ug5_7834(i7,i8,i3,i4)%b(iut,2)=ug5_7834(i7,i8,i3,i4)%b(iut
     & ,2)+cz1*ug534_78(i7,i8)%b(1,2)+cz2*ug534_78(i7,i8)%a(2,2)
      ug5_7834(i7,i8,i3,i4)%c(iut,2)=ug5_7834(i7,i8,i3,i4)%c(iut
     & ,2)+cx1*ug534_78(i7,i8)%c(1,2)+cx2*ug534_78(i7,i8)%d(2,2)
      ug5_7834(i7,i8,i3,i4)%d(iut,2)=ug5_7834(i7,i8,i3,i4)%d(iut
     & ,2)+cy1*ug534_78(i7,i8)%c(1,2)+cy2*ug534_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id7).ne.1 .and. ilept(id1).ne.1)then
        if(id7.ne.5 .or. id3.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=ug7_1234(i1,i2,i3,i4)%a,bb=ug7_1234(i1,i2,i3,i4)%b,cc=ug7_123
* 4(i1,i2,i3,i4)%c,dd=ug7_1234(i1,i2,i3,i4)%d,a1=lg7_12(i1,i2)%a,b1=lg7_
* 12(i1,i2)%b,c1=lg7_12(i1,i2)%c,d1=lg7_12(i1,i2)%d,a2=u712_34(i3,i4)%a,
* b2=u712_34(i3,i4)%b,c2=u712_34(i3,i4)%c,d2=u712_34(i3,i4)%d,prq=p712q,
* m=rmass(id7),nsum=0
      ug7_1234(i1,i2,i3,i4)%a(1,1)=lg7_12(i1,i2)%a(1,1)*u712_34(
     & i3,i4)%a(1,1)+lg7_12(i1,i2)%c(1,2)*p712q*u712_34(i3,i4)%b
     & (2,1)
      ug7_1234(i1,i2,i3,i4)%b(1,1)=rmass(id7)*(lg7_12(i1,i2)%d(1
     & ,1)*u712_34(i3,i4)%a(1,1)+lg7_12(i1,i2)%b(1,2)*u712_34(i3
     & ,i4)%b(2,1))
      ug7_1234(i1,i2,i3,i4)%c(1,1)=rmass(id7)*(lg7_12(i1,i2)%a(1
     & ,1)*u712_34(i3,i4)%d(1,1)+lg7_12(i1,i2)%c(1,2)*u712_34(i3
     & ,i4)%c(2,1))
      ug7_1234(i1,i2,i3,i4)%d(1,1)=lg7_12(i1,i2)%d(1,1)*p712q*u7
     & 12_34(i3,i4)%d(1,1)+lg7_12(i1,i2)%b(1,2)*u712_34(i3,i4)%c
     & (2,1)
      ug7_1234(i1,i2,i3,i4)%a(1,2)=rmass(id7)*(lg7_12(i1,i2)%a(1
     & ,1)*u712_34(i3,i4)%b(1,2)+lg7_12(i1,i2)%c(1,2)*u712_34(i3
     & ,i4)%a(2,2))
      ug7_1234(i1,i2,i3,i4)%b(1,2)=lg7_12(i1,i2)%d(1,1)*p712q*u7
     & 12_34(i3,i4)%b(1,2)+lg7_12(i1,i2)%b(1,2)*u712_34(i3,i4)%a
     & (2,2)
      ug7_1234(i1,i2,i3,i4)%c(1,2)=lg7_12(i1,i2)%a(1,1)*u712_34(
     & i3,i4)%c(1,2)+lg7_12(i1,i2)%c(1,2)*p712q*u712_34(i3,i4)%d
     & (2,2)
      ug7_1234(i1,i2,i3,i4)%d(1,2)=rmass(id7)*(lg7_12(i1,i2)%d(1
     & ,1)*u712_34(i3,i4)%c(1,2)+lg7_12(i1,i2)%b(1,2)*u712_34(i3
     & ,i4)%d(2,2))
      ug7_1234(i1,i2,i3,i4)%a(2,1)=rmass(id7)*(lg7_12(i1,i2)%c(2
     & ,1)*u712_34(i3,i4)%a(1,1)+lg7_12(i1,i2)%a(2,2)*u712_34(i3
     & ,i4)%b(2,1))
      ug7_1234(i1,i2,i3,i4)%b(2,1)=lg7_12(i1,i2)%b(2,1)*u712_34(
     & i3,i4)%a(1,1)+lg7_12(i1,i2)%d(2,2)*p712q*u712_34(i3,i4)%b
     & (2,1)
      ug7_1234(i1,i2,i3,i4)%c(2,1)=lg7_12(i1,i2)%c(2,1)*p712q*u7
     & 12_34(i3,i4)%d(1,1)+lg7_12(i1,i2)%a(2,2)*u712_34(i3,i4)%c
     & (2,1)
      ug7_1234(i1,i2,i3,i4)%d(2,1)=rmass(id7)*(lg7_12(i1,i2)%b(2
     & ,1)*u712_34(i3,i4)%d(1,1)+lg7_12(i1,i2)%d(2,2)*u712_34(i3
     & ,i4)%c(2,1))
      ug7_1234(i1,i2,i3,i4)%a(2,2)=lg7_12(i1,i2)%c(2,1)*p712q*u7
     & 12_34(i3,i4)%b(1,2)+lg7_12(i1,i2)%a(2,2)*u712_34(i3,i4)%a
     & (2,2)
      ug7_1234(i1,i2,i3,i4)%b(2,2)=rmass(id7)*(lg7_12(i1,i2)%b(2
     & ,1)*u712_34(i3,i4)%b(1,2)+lg7_12(i1,i2)%d(2,2)*u712_34(i3
     & ,i4)%a(2,2))
      ug7_1234(i1,i2,i3,i4)%c(2,2)=rmass(id7)*(lg7_12(i1,i2)%c(2
     & ,1)*u712_34(i3,i4)%c(1,2)+lg7_12(i1,i2)%a(2,2)*u712_34(i3
     & ,i4)%d(2,2))
      ug7_1234(i1,i2,i3,i4)%d(2,2)=lg7_12(i1,i2)%b(2,1)*u712_34(
     & i3,i4)%c(1,2)+lg7_12(i1,i2)%d(2,2)*p712q*u712_34(i3,i4)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=ug7_1234(i1,i2,i3,i4)%a,bb=ug7_1234(i1,i2,i3,i4)%b,cc=ug7_123
* 4(i1,i2,i3,i4)%c,dd=ug7_1234(i1,i2,i3,i4)%d,a1=l7_34(i3,i4)%a,b1=l7_34
* (i3,i4)%b,c1=l7_34(i3,i4)%c,d1=l7_34(i3,i4)%d,a2=ug734_12(i1,i2)%a,b2=
* ug734_12(i1,i2)%b,c2=ug734_12(i1,i2)%c,d2=ug734_12(i1,i2)%d,prq=p734q,
* m=rmass(id7),nsum=1
      ug7_1234(i1,i2,i3,i4)%a(1,1)=ug7_1234(i1,i2,i3,i4)%a(1,1)+
     & l7_34(i3,i4)%a(1,1)*ug734_12(i1,i2)%a(1,1)+l7_34(i3,i4)%c
     & (1,2)*p734q*ug734_12(i1,i2)%b(2,1)
      ug7_1234(i1,i2,i3,i4)%b(1,1)=ug7_1234(i1,i2,i3,i4)%b(1,1)+
     & rmass(id7)*(l7_34(i3,i4)%d(1,1)*ug734_12(i1,i2)%a(1,1)+l7
     & _34(i3,i4)%b(1,2)*ug734_12(i1,i2)%b(2,1))
      ug7_1234(i1,i2,i3,i4)%c(1,1)=ug7_1234(i1,i2,i3,i4)%c(1,1)+
     & rmass(id7)*(l7_34(i3,i4)%a(1,1)*ug734_12(i1,i2)%d(1,1)+l7
     & _34(i3,i4)%c(1,2)*ug734_12(i1,i2)%c(2,1))
      ug7_1234(i1,i2,i3,i4)%d(1,1)=ug7_1234(i1,i2,i3,i4)%d(1,1)+
     & l7_34(i3,i4)%d(1,1)*p734q*ug734_12(i1,i2)%d(1,1)+l7_34(i3
     & ,i4)%b(1,2)*ug734_12(i1,i2)%c(2,1)
      ug7_1234(i1,i2,i3,i4)%a(1,2)=ug7_1234(i1,i2,i3,i4)%a(1,2)+
     & rmass(id7)*(l7_34(i3,i4)%a(1,1)*ug734_12(i1,i2)%b(1,2)+l7
     & _34(i3,i4)%c(1,2)*ug734_12(i1,i2)%a(2,2))
      ug7_1234(i1,i2,i3,i4)%b(1,2)=ug7_1234(i1,i2,i3,i4)%b(1,2)+
     & l7_34(i3,i4)%d(1,1)*p734q*ug734_12(i1,i2)%b(1,2)+l7_34(i3
     & ,i4)%b(1,2)*ug734_12(i1,i2)%a(2,2)
      ug7_1234(i1,i2,i3,i4)%c(1,2)=ug7_1234(i1,i2,i3,i4)%c(1,2)+
     & l7_34(i3,i4)%a(1,1)*ug734_12(i1,i2)%c(1,2)+l7_34(i3,i4)%c
     & (1,2)*p734q*ug734_12(i1,i2)%d(2,2)
      ug7_1234(i1,i2,i3,i4)%d(1,2)=ug7_1234(i1,i2,i3,i4)%d(1,2)+
     & rmass(id7)*(l7_34(i3,i4)%d(1,1)*ug734_12(i1,i2)%c(1,2)+l7
     & _34(i3,i4)%b(1,2)*ug734_12(i1,i2)%d(2,2))
      ug7_1234(i1,i2,i3,i4)%a(2,1)=ug7_1234(i1,i2,i3,i4)%a(2,1)+
     & rmass(id7)*(l7_34(i3,i4)%c(2,1)*ug734_12(i1,i2)%a(1,1)+l7
     & _34(i3,i4)%a(2,2)*ug734_12(i1,i2)%b(2,1))
      ug7_1234(i1,i2,i3,i4)%b(2,1)=ug7_1234(i1,i2,i3,i4)%b(2,1)+
     & l7_34(i3,i4)%b(2,1)*ug734_12(i1,i2)%a(1,1)+l7_34(i3,i4)%d
     & (2,2)*p734q*ug734_12(i1,i2)%b(2,1)
      ug7_1234(i1,i2,i3,i4)%c(2,1)=ug7_1234(i1,i2,i3,i4)%c(2,1)+
     & l7_34(i3,i4)%c(2,1)*p734q*ug734_12(i1,i2)%d(1,1)+l7_34(i3
     & ,i4)%a(2,2)*ug734_12(i1,i2)%c(2,1)
      ug7_1234(i1,i2,i3,i4)%d(2,1)=ug7_1234(i1,i2,i3,i4)%d(2,1)+
     & rmass(id7)*(l7_34(i3,i4)%b(2,1)*ug734_12(i1,i2)%d(1,1)+l7
     & _34(i3,i4)%d(2,2)*ug734_12(i1,i2)%c(2,1))
      ug7_1234(i1,i2,i3,i4)%a(2,2)=ug7_1234(i1,i2,i3,i4)%a(2,2)+
     & l7_34(i3,i4)%c(2,1)*p734q*ug734_12(i1,i2)%b(1,2)+l7_34(i3
     & ,i4)%a(2,2)*ug734_12(i1,i2)%a(2,2)
      ug7_1234(i1,i2,i3,i4)%b(2,2)=ug7_1234(i1,i2,i3,i4)%b(2,2)+
     & rmass(id7)*(l7_34(i3,i4)%b(2,1)*ug734_12(i1,i2)%b(1,2)+l7
     & _34(i3,i4)%d(2,2)*ug734_12(i1,i2)%a(2,2))
      ug7_1234(i1,i2,i3,i4)%c(2,2)=ug7_1234(i1,i2,i3,i4)%c(2,2)+
     & rmass(id7)*(l7_34(i3,i4)%c(2,1)*ug734_12(i1,i2)%c(1,2)+l7
     & _34(i3,i4)%a(2,2)*ug734_12(i1,i2)%d(2,2))
      ug7_1234(i1,i2,i3,i4)%d(2,2)=ug7_1234(i1,i2,i3,i4)%d(2,2)+
     & l7_34(i3,i4)%b(2,1)*ug734_12(i1,i2)%c(1,2)+l7_34(i3,i4)%d
     & (2,2)*p734q*ug734_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TTs -- aa=ug7_1234(i1,i2,i3,i4)%a,bb=ug7_1234(i1,i2,i3,i4)%b,cc=ug7_12
* 34(i1,i2,i3,i4)%c,dd=ug7_1234(i1,i2,i3,i4)%d,a1=lg7_12(i1,i2)%a,b1=lg7
* _12(i1,i2)%b,c1=lg7_12(i1,i2)%c,d1=lg7_12(i1,i2)%d,a2=u712_34(i3,i4)%a
* ,b2=u712_34(i3,i4)%b,c2=u712_34(i3,i4)%c,d2=u712_34(i3,i4)%d,prq=p712q
* ,m=rmass(id7),nsum=0
      do jut=1,2
      cx1=u712_34(i3,i4)%a(1,jut)+rmass(id7)*u712_34(i3,i4)%b(1,
     & jut)
      cx2=u712_34(i3,i4)%a(2,jut)+rmass(id7)*u712_34(i3,i4)%b(2,
     & jut)
      cy1=p712q*u712_34(i3,i4)%b(1,jut)+rmass(id7)*u712_34(i3,i4
     & )%a(1,jut)
      cy2=p712q*u712_34(i3,i4)%b(2,jut)+rmass(id7)*u712_34(i3,i4
     & )%a(2,jut)
      cw1=u712_34(i3,i4)%c(1,jut)+rmass(id7)*u712_34(i3,i4)%d(1,
     & jut)
      cw2=u712_34(i3,i4)%c(2,jut)+rmass(id7)*u712_34(i3,i4)%d(2,
     & jut)
      cz1=p712q*u712_34(i3,i4)%d(1,jut)+rmass(id7)*u712_34(i3,i4
     & )%c(1,jut)
      cz2=p712q*u712_34(i3,i4)%d(2,jut)+rmass(id7)*u712_34(i3,i4
     & )%c(2,jut)
      ug7_1234(i1,i2,i3,i4)%a(1,jut)=lg7_12(i1,i2)%a(1,1)*cx1+lg
     & 7_12(i1,i2)%c(1,2)*cy2
      ug7_1234(i1,i2,i3,i4)%b(1,jut)=lg7_12(i1,i2)%d(1,1)*cy1+lg
     & 7_12(i1,i2)%b(1,2)*cx2
      ug7_1234(i1,i2,i3,i4)%c(1,jut)=lg7_12(i1,i2)%a(1,1)*cw1+lg
     & 7_12(i1,i2)%c(1,2)*cz2
      ug7_1234(i1,i2,i3,i4)%d(1,jut)=lg7_12(i1,i2)%d(1,1)*cz1+lg
     & 7_12(i1,i2)%b(1,2)*cw2
      ug7_1234(i1,i2,i3,i4)%a(2,jut)=lg7_12(i1,i2)%c(2,1)*cy1+lg
     & 7_12(i1,i2)%a(2,2)*cx2
      ug7_1234(i1,i2,i3,i4)%b(2,jut)=lg7_12(i1,i2)%b(2,1)*cx1+lg
     & 7_12(i1,i2)%d(2,2)*cy2
      ug7_1234(i1,i2,i3,i4)%c(2,jut)=lg7_12(i1,i2)%c(2,1)*cz1+lg
     & 7_12(i1,i2)%a(2,2)*cw2
      ug7_1234(i1,i2,i3,i4)%d(2,jut)=lg7_12(i1,i2)%b(2,1)*cw1+lg
     & 7_12(i1,i2)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=ug7_1234(i1,i2,i3,i4)%a,bb=ug7_1234(i1,i2,i3,i4)%b,cc=ug7_12
* 34(i1,i2,i3,i4)%c,dd=ug7_1234(i1,i2,i3,i4)%d,a1=l7_34(i3,i4)%a,b1=l7_3
* 4(i3,i4)%b,c1=l7_34(i3,i4)%c,d1=l7_34(i3,i4)%d,a2=ug734_12(i1,i2)%a,b2
* =ug734_12(i1,i2)%b,c2=ug734_12(i1,i2)%c,d2=ug734_12(i1,i2)%d,prq=p734q
* ,m=rmass(id7),nsum=1
      do iut=1,2
      cx1=l7_34(i3,i4)%a(iut,1)+l7_34(i3,i4)%c(iut,1)*rmass(id7)
      cx2=l7_34(i3,i4)%c(iut,2)*p734q+l7_34(i3,i4)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_34(i3,i4)%b(iut,1)+l7_34(i3,i4)%d(iut,1)*rmass(id7)
      cy2=l7_34(i3,i4)%d(iut,2)*p734q+l7_34(i3,i4)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_34(i3,i4)%c(iut,1)*p734q+l7_34(i3,i4)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_34(i3,i4)%a(iut,2)+l7_34(i3,i4)%c(iut,2)*rmass(id7)
      cz1=l7_34(i3,i4)%d(iut,1)*p734q+l7_34(i3,i4)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_34(i3,i4)%b(iut,2)+l7_34(i3,i4)%d(iut,2)*rmass(id7)
      ug7_1234(i1,i2,i3,i4)%a(iut,1)=ug7_1234(i1,i2,i3,i4)%a(iut
     & ,1)+cx1*ug734_12(i1,i2)%a(1,1)+cx2*ug734_12(i1,i2)%b(2,1)
      ug7_1234(i1,i2,i3,i4)%b(iut,1)=ug7_1234(i1,i2,i3,i4)%b(iut
     & ,1)+cy1*ug734_12(i1,i2)%a(1,1)+cy2*ug734_12(i1,i2)%b(2,1)
      ug7_1234(i1,i2,i3,i4)%c(iut,1)=ug7_1234(i1,i2,i3,i4)%c(iut
     & ,1)+cw1*ug734_12(i1,i2)%d(1,1)+cw2*ug734_12(i1,i2)%c(2,1)
      ug7_1234(i1,i2,i3,i4)%d(iut,1)=ug7_1234(i1,i2,i3,i4)%d(iut
     & ,1)+cz1*ug734_12(i1,i2)%d(1,1)+cz2*ug734_12(i1,i2)%c(2,1)
      ug7_1234(i1,i2,i3,i4)%a(iut,2)=ug7_1234(i1,i2,i3,i4)%a(iut
     & ,2)+cw1*ug734_12(i1,i2)%b(1,2)+cw2*ug734_12(i1,i2)%a(2,2)
      ug7_1234(i1,i2,i3,i4)%b(iut,2)=ug7_1234(i1,i2,i3,i4)%b(iut
     & ,2)+cz1*ug734_12(i1,i2)%b(1,2)+cz2*ug734_12(i1,i2)%a(2,2)
      ug7_1234(i1,i2,i3,i4)%c(iut,2)=ug7_1234(i1,i2,i3,i4)%c(iut
     & ,2)+cx1*ug734_12(i1,i2)%c(1,2)+cx2*ug734_12(i1,i2)%d(2,2)
      ug7_1234(i1,i2,i3,i4)%d(iut,2)=ug7_1234(i1,i2,i3,i4)%d(iut
     & ,2)+cy1*ug734_12(i1,i2)%c(1,2)+cy2*ug734_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id7).ne.1 .and. ilept(id3).ne.1)then
        if(id7.ne.5 .or. id1.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
* TT -- aa=ug7_3412(i3,i4,i1,i2)%a,bb=ug7_3412(i3,i4,i1,i2)%b,cc=ug7_341
* 2(i3,i4,i1,i2)%c,dd=ug7_3412(i3,i4,i1,i2)%d,a1=lg7_34(i3,i4)%a,b1=lg7_
* 34(i3,i4)%b,c1=lg7_34(i3,i4)%c,d1=lg7_34(i3,i4)%d,a2=u734_12(i1,i2)%a,
* b2=u734_12(i1,i2)%b,c2=u734_12(i1,i2)%c,d2=u734_12(i1,i2)%d,prq=p734q,
* m=rmass(id7),nsum=0
      ug7_3412(i3,i4,i1,i2)%a(1,1)=lg7_34(i3,i4)%a(1,1)*u734_12(
     & i1,i2)%a(1,1)+lg7_34(i3,i4)%c(1,2)*p734q*u734_12(i1,i2)%b
     & (2,1)
      ug7_3412(i3,i4,i1,i2)%b(1,1)=rmass(id7)*(lg7_34(i3,i4)%d(1
     & ,1)*u734_12(i1,i2)%a(1,1)+lg7_34(i3,i4)%b(1,2)*u734_12(i1
     & ,i2)%b(2,1))
      ug7_3412(i3,i4,i1,i2)%c(1,1)=rmass(id7)*(lg7_34(i3,i4)%a(1
     & ,1)*u734_12(i1,i2)%d(1,1)+lg7_34(i3,i4)%c(1,2)*u734_12(i1
     & ,i2)%c(2,1))
      ug7_3412(i3,i4,i1,i2)%d(1,1)=lg7_34(i3,i4)%d(1,1)*p734q*u7
     & 34_12(i1,i2)%d(1,1)+lg7_34(i3,i4)%b(1,2)*u734_12(i1,i2)%c
     & (2,1)
      ug7_3412(i3,i4,i1,i2)%a(1,2)=rmass(id7)*(lg7_34(i3,i4)%a(1
     & ,1)*u734_12(i1,i2)%b(1,2)+lg7_34(i3,i4)%c(1,2)*u734_12(i1
     & ,i2)%a(2,2))
      ug7_3412(i3,i4,i1,i2)%b(1,2)=lg7_34(i3,i4)%d(1,1)*p734q*u7
     & 34_12(i1,i2)%b(1,2)+lg7_34(i3,i4)%b(1,2)*u734_12(i1,i2)%a
     & (2,2)
      ug7_3412(i3,i4,i1,i2)%c(1,2)=lg7_34(i3,i4)%a(1,1)*u734_12(
     & i1,i2)%c(1,2)+lg7_34(i3,i4)%c(1,2)*p734q*u734_12(i1,i2)%d
     & (2,2)
      ug7_3412(i3,i4,i1,i2)%d(1,2)=rmass(id7)*(lg7_34(i3,i4)%d(1
     & ,1)*u734_12(i1,i2)%c(1,2)+lg7_34(i3,i4)%b(1,2)*u734_12(i1
     & ,i2)%d(2,2))
      ug7_3412(i3,i4,i1,i2)%a(2,1)=rmass(id7)*(lg7_34(i3,i4)%c(2
     & ,1)*u734_12(i1,i2)%a(1,1)+lg7_34(i3,i4)%a(2,2)*u734_12(i1
     & ,i2)%b(2,1))
      ug7_3412(i3,i4,i1,i2)%b(2,1)=lg7_34(i3,i4)%b(2,1)*u734_12(
     & i1,i2)%a(1,1)+lg7_34(i3,i4)%d(2,2)*p734q*u734_12(i1,i2)%b
     & (2,1)
      ug7_3412(i3,i4,i1,i2)%c(2,1)=lg7_34(i3,i4)%c(2,1)*p734q*u7
     & 34_12(i1,i2)%d(1,1)+lg7_34(i3,i4)%a(2,2)*u734_12(i1,i2)%c
     & (2,1)
      ug7_3412(i3,i4,i1,i2)%d(2,1)=rmass(id7)*(lg7_34(i3,i4)%b(2
     & ,1)*u734_12(i1,i2)%d(1,1)+lg7_34(i3,i4)%d(2,2)*u734_12(i1
     & ,i2)%c(2,1))
      ug7_3412(i3,i4,i1,i2)%a(2,2)=lg7_34(i3,i4)%c(2,1)*p734q*u7
     & 34_12(i1,i2)%b(1,2)+lg7_34(i3,i4)%a(2,2)*u734_12(i1,i2)%a
     & (2,2)
      ug7_3412(i3,i4,i1,i2)%b(2,2)=rmass(id7)*(lg7_34(i3,i4)%b(2
     & ,1)*u734_12(i1,i2)%b(1,2)+lg7_34(i3,i4)%d(2,2)*u734_12(i1
     & ,i2)%a(2,2))
      ug7_3412(i3,i4,i1,i2)%c(2,2)=rmass(id7)*(lg7_34(i3,i4)%c(2
     & ,1)*u734_12(i1,i2)%c(1,2)+lg7_34(i3,i4)%a(2,2)*u734_12(i1
     & ,i2)%d(2,2))
      ug7_3412(i3,i4,i1,i2)%d(2,2)=lg7_34(i3,i4)%b(2,1)*u734_12(
     & i1,i2)%c(1,2)+lg7_34(i3,i4)%d(2,2)*p734q*u734_12(i1,i2)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
* TT -- aa=ug7_3412(i3,i4,i1,i2)%a,bb=ug7_3412(i3,i4,i1,i2)%b,cc=ug7_341
* 2(i3,i4,i1,i2)%c,dd=ug7_3412(i3,i4,i1,i2)%d,a1=l7_12(i1,i2)%a,b1=l7_12
* (i1,i2)%b,c1=l7_12(i1,i2)%c,d1=l7_12(i1,i2)%d,a2=ug712_34(i3,i4)%a,b2=
* ug712_34(i3,i4)%b,c2=ug712_34(i3,i4)%c,d2=ug712_34(i3,i4)%d,prq=p712q,
* m=rmass(id7),nsum=1
      ug7_3412(i3,i4,i1,i2)%a(1,1)=ug7_3412(i3,i4,i1,i2)%a(1,1)+
     & l7_12(i1,i2)%a(1,1)*ug712_34(i3,i4)%a(1,1)+l7_12(i1,i2)%c
     & (1,2)*p712q*ug712_34(i3,i4)%b(2,1)
      ug7_3412(i3,i4,i1,i2)%b(1,1)=ug7_3412(i3,i4,i1,i2)%b(1,1)+
     & rmass(id7)*(l7_12(i1,i2)%d(1,1)*ug712_34(i3,i4)%a(1,1)+l7
     & _12(i1,i2)%b(1,2)*ug712_34(i3,i4)%b(2,1))
      ug7_3412(i3,i4,i1,i2)%c(1,1)=ug7_3412(i3,i4,i1,i2)%c(1,1)+
     & rmass(id7)*(l7_12(i1,i2)%a(1,1)*ug712_34(i3,i4)%d(1,1)+l7
     & _12(i1,i2)%c(1,2)*ug712_34(i3,i4)%c(2,1))
      ug7_3412(i3,i4,i1,i2)%d(1,1)=ug7_3412(i3,i4,i1,i2)%d(1,1)+
     & l7_12(i1,i2)%d(1,1)*p712q*ug712_34(i3,i4)%d(1,1)+l7_12(i1
     & ,i2)%b(1,2)*ug712_34(i3,i4)%c(2,1)
      ug7_3412(i3,i4,i1,i2)%a(1,2)=ug7_3412(i3,i4,i1,i2)%a(1,2)+
     & rmass(id7)*(l7_12(i1,i2)%a(1,1)*ug712_34(i3,i4)%b(1,2)+l7
     & _12(i1,i2)%c(1,2)*ug712_34(i3,i4)%a(2,2))
      ug7_3412(i3,i4,i1,i2)%b(1,2)=ug7_3412(i3,i4,i1,i2)%b(1,2)+
     & l7_12(i1,i2)%d(1,1)*p712q*ug712_34(i3,i4)%b(1,2)+l7_12(i1
     & ,i2)%b(1,2)*ug712_34(i3,i4)%a(2,2)
      ug7_3412(i3,i4,i1,i2)%c(1,2)=ug7_3412(i3,i4,i1,i2)%c(1,2)+
     & l7_12(i1,i2)%a(1,1)*ug712_34(i3,i4)%c(1,2)+l7_12(i1,i2)%c
     & (1,2)*p712q*ug712_34(i3,i4)%d(2,2)
      ug7_3412(i3,i4,i1,i2)%d(1,2)=ug7_3412(i3,i4,i1,i2)%d(1,2)+
     & rmass(id7)*(l7_12(i1,i2)%d(1,1)*ug712_34(i3,i4)%c(1,2)+l7
     & _12(i1,i2)%b(1,2)*ug712_34(i3,i4)%d(2,2))
      ug7_3412(i3,i4,i1,i2)%a(2,1)=ug7_3412(i3,i4,i1,i2)%a(2,1)+
     & rmass(id7)*(l7_12(i1,i2)%c(2,1)*ug712_34(i3,i4)%a(1,1)+l7
     & _12(i1,i2)%a(2,2)*ug712_34(i3,i4)%b(2,1))
      ug7_3412(i3,i4,i1,i2)%b(2,1)=ug7_3412(i3,i4,i1,i2)%b(2,1)+
     & l7_12(i1,i2)%b(2,1)*ug712_34(i3,i4)%a(1,1)+l7_12(i1,i2)%d
     & (2,2)*p712q*ug712_34(i3,i4)%b(2,1)
      ug7_3412(i3,i4,i1,i2)%c(2,1)=ug7_3412(i3,i4,i1,i2)%c(2,1)+
     & l7_12(i1,i2)%c(2,1)*p712q*ug712_34(i3,i4)%d(1,1)+l7_12(i1
     & ,i2)%a(2,2)*ug712_34(i3,i4)%c(2,1)
      ug7_3412(i3,i4,i1,i2)%d(2,1)=ug7_3412(i3,i4,i1,i2)%d(2,1)+
     & rmass(id7)*(l7_12(i1,i2)%b(2,1)*ug712_34(i3,i4)%d(1,1)+l7
     & _12(i1,i2)%d(2,2)*ug712_34(i3,i4)%c(2,1))
      ug7_3412(i3,i4,i1,i2)%a(2,2)=ug7_3412(i3,i4,i1,i2)%a(2,2)+
     & l7_12(i1,i2)%c(2,1)*p712q*ug712_34(i3,i4)%b(1,2)+l7_12(i1
     & ,i2)%a(2,2)*ug712_34(i3,i4)%a(2,2)
      ug7_3412(i3,i4,i1,i2)%b(2,2)=ug7_3412(i3,i4,i1,i2)%b(2,2)+
     & rmass(id7)*(l7_12(i1,i2)%b(2,1)*ug712_34(i3,i4)%b(1,2)+l7
     & _12(i1,i2)%d(2,2)*ug712_34(i3,i4)%a(2,2))
      ug7_3412(i3,i4,i1,i2)%c(2,2)=ug7_3412(i3,i4,i1,i2)%c(2,2)+
     & rmass(id7)*(l7_12(i1,i2)%c(2,1)*ug712_34(i3,i4)%c(1,2)+l7
     & _12(i1,i2)%a(2,2)*ug712_34(i3,i4)%d(2,2))
      ug7_3412(i3,i4,i1,i2)%d(2,2)=ug7_3412(i3,i4,i1,i2)%d(2,2)+
     & l7_12(i1,i2)%b(2,1)*ug712_34(i3,i4)%c(1,2)+l7_12(i1,i2)%d
     & (2,2)*p712q*ug712_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
* TTs -- aa=ug7_3412(i3,i4,i1,i2)%a,bb=ug7_3412(i3,i4,i1,i2)%b,cc=ug7_34
* 12(i3,i4,i1,i2)%c,dd=ug7_3412(i3,i4,i1,i2)%d,a1=lg7_34(i3,i4)%a,b1=lg7
* _34(i3,i4)%b,c1=lg7_34(i3,i4)%c,d1=lg7_34(i3,i4)%d,a2=u734_12(i1,i2)%a
* ,b2=u734_12(i1,i2)%b,c2=u734_12(i1,i2)%c,d2=u734_12(i1,i2)%d,prq=p734q
* ,m=rmass(id7),nsum=0
      do jut=1,2
      cx1=u734_12(i1,i2)%a(1,jut)+rmass(id7)*u734_12(i1,i2)%b(1,
     & jut)
      cx2=u734_12(i1,i2)%a(2,jut)+rmass(id7)*u734_12(i1,i2)%b(2,
     & jut)
      cy1=p734q*u734_12(i1,i2)%b(1,jut)+rmass(id7)*u734_12(i1,i2
     & )%a(1,jut)
      cy2=p734q*u734_12(i1,i2)%b(2,jut)+rmass(id7)*u734_12(i1,i2
     & )%a(2,jut)
      cw1=u734_12(i1,i2)%c(1,jut)+rmass(id7)*u734_12(i1,i2)%d(1,
     & jut)
      cw2=u734_12(i1,i2)%c(2,jut)+rmass(id7)*u734_12(i1,i2)%d(2,
     & jut)
      cz1=p734q*u734_12(i1,i2)%d(1,jut)+rmass(id7)*u734_12(i1,i2
     & )%c(1,jut)
      cz2=p734q*u734_12(i1,i2)%d(2,jut)+rmass(id7)*u734_12(i1,i2
     & )%c(2,jut)
      ug7_3412(i3,i4,i1,i2)%a(1,jut)=lg7_34(i3,i4)%a(1,1)*cx1+lg
     & 7_34(i3,i4)%c(1,2)*cy2
      ug7_3412(i3,i4,i1,i2)%b(1,jut)=lg7_34(i3,i4)%d(1,1)*cy1+lg
     & 7_34(i3,i4)%b(1,2)*cx2
      ug7_3412(i3,i4,i1,i2)%c(1,jut)=lg7_34(i3,i4)%a(1,1)*cw1+lg
     & 7_34(i3,i4)%c(1,2)*cz2
      ug7_3412(i3,i4,i1,i2)%d(1,jut)=lg7_34(i3,i4)%d(1,1)*cz1+lg
     & 7_34(i3,i4)%b(1,2)*cw2
      ug7_3412(i3,i4,i1,i2)%a(2,jut)=lg7_34(i3,i4)%c(2,1)*cy1+lg
     & 7_34(i3,i4)%a(2,2)*cx2
      ug7_3412(i3,i4,i1,i2)%b(2,jut)=lg7_34(i3,i4)%b(2,1)*cx1+lg
     & 7_34(i3,i4)%d(2,2)*cy2
      ug7_3412(i3,i4,i1,i2)%c(2,jut)=lg7_34(i3,i4)%c(2,1)*cz1+lg
     & 7_34(i3,i4)%a(2,2)*cw2
      ug7_3412(i3,i4,i1,i2)%d(2,jut)=lg7_34(i3,i4)%b(2,1)*cw1+lg
     & 7_34(i3,i4)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=ug7_3412(i3,i4,i1,i2)%a,bb=ug7_3412(i3,i4,i1,i2)%b,cc=ug7_34
* 12(i3,i4,i1,i2)%c,dd=ug7_3412(i3,i4,i1,i2)%d,a1=l7_12(i1,i2)%a,b1=l7_1
* 2(i1,i2)%b,c1=l7_12(i1,i2)%c,d1=l7_12(i1,i2)%d,a2=ug712_34(i3,i4)%a,b2
* =ug712_34(i3,i4)%b,c2=ug712_34(i3,i4)%c,d2=ug712_34(i3,i4)%d,prq=p712q
* ,m=rmass(id7),nsum=1
      do iut=1,2
      cx1=l7_12(i1,i2)%a(iut,1)+l7_12(i1,i2)%c(iut,1)*rmass(id7)
      cx2=l7_12(i1,i2)%c(iut,2)*p712q+l7_12(i1,i2)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_12(i1,i2)%b(iut,1)+l7_12(i1,i2)%d(iut,1)*rmass(id7)
      cy2=l7_12(i1,i2)%d(iut,2)*p712q+l7_12(i1,i2)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_12(i1,i2)%c(iut,1)*p712q+l7_12(i1,i2)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_12(i1,i2)%a(iut,2)+l7_12(i1,i2)%c(iut,2)*rmass(id7)
      cz1=l7_12(i1,i2)%d(iut,1)*p712q+l7_12(i1,i2)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_12(i1,i2)%b(iut,2)+l7_12(i1,i2)%d(iut,2)*rmass(id7)
      ug7_3412(i3,i4,i1,i2)%a(iut,1)=ug7_3412(i3,i4,i1,i2)%a(iut
     & ,1)+cx1*ug712_34(i3,i4)%a(1,1)+cx2*ug712_34(i3,i4)%b(2,1)
      ug7_3412(i3,i4,i1,i2)%b(iut,1)=ug7_3412(i3,i4,i1,i2)%b(iut
     & ,1)+cy1*ug712_34(i3,i4)%a(1,1)+cy2*ug712_34(i3,i4)%b(2,1)
      ug7_3412(i3,i4,i1,i2)%c(iut,1)=ug7_3412(i3,i4,i1,i2)%c(iut
     & ,1)+cw1*ug712_34(i3,i4)%d(1,1)+cw2*ug712_34(i3,i4)%c(2,1)
      ug7_3412(i3,i4,i1,i2)%d(iut,1)=ug7_3412(i3,i4,i1,i2)%d(iut
     & ,1)+cz1*ug712_34(i3,i4)%d(1,1)+cz2*ug712_34(i3,i4)%c(2,1)
      ug7_3412(i3,i4,i1,i2)%a(iut,2)=ug7_3412(i3,i4,i1,i2)%a(iut
     & ,2)+cw1*ug712_34(i3,i4)%b(1,2)+cw2*ug712_34(i3,i4)%a(2,2)
      ug7_3412(i3,i4,i1,i2)%b(iut,2)=ug7_3412(i3,i4,i1,i2)%b(iut
     & ,2)+cz1*ug712_34(i3,i4)%b(1,2)+cz2*ug712_34(i3,i4)%a(2,2)
      ug7_3412(i3,i4,i1,i2)%c(iut,2)=ug7_3412(i3,i4,i1,i2)%c(iut
     & ,2)+cx1*ug712_34(i3,i4)%c(1,2)+cx2*ug712_34(i3,i4)%d(2,2)
      ug7_3412(i3,i4,i1,i2)%d(iut,2)=ug7_3412(i3,i4,i1,i2)%d(iut
     & ,2)+cy1*ug712_34(i3,i4)%c(1,2)+cy2*ug712_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id7).ne.1 .and. ilept(id1).ne.1)then
        if(id7.ne.5 .or. id5.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=ug7_1256(i1,i2,i5,i6)%a,bb=ug7_1256(i1,i2,i5,i6)%b,cc=ug7_125
* 6(i1,i2,i5,i6)%c,dd=ug7_1256(i1,i2,i5,i6)%d,a1=lg7_12(i1,i2)%a,b1=lg7_
* 12(i1,i2)%b,c1=lg7_12(i1,i2)%c,d1=lg7_12(i1,i2)%d,a2=u712_56(i5,i6)%a,
* b2=u712_56(i5,i6)%b,c2=u712_56(i5,i6)%c,d2=u712_56(i5,i6)%d,prq=p712q,
* m=rmass(id7),nsum=0
      ug7_1256(i1,i2,i5,i6)%a(1,1)=lg7_12(i1,i2)%a(1,1)*u712_56(
     & i5,i6)%a(1,1)+lg7_12(i1,i2)%c(1,2)*p712q*u712_56(i5,i6)%b
     & (2,1)
      ug7_1256(i1,i2,i5,i6)%b(1,1)=rmass(id7)*(lg7_12(i1,i2)%d(1
     & ,1)*u712_56(i5,i6)%a(1,1)+lg7_12(i1,i2)%b(1,2)*u712_56(i5
     & ,i6)%b(2,1))
      ug7_1256(i1,i2,i5,i6)%c(1,1)=rmass(id7)*(lg7_12(i1,i2)%a(1
     & ,1)*u712_56(i5,i6)%d(1,1)+lg7_12(i1,i2)%c(1,2)*u712_56(i5
     & ,i6)%c(2,1))
      ug7_1256(i1,i2,i5,i6)%d(1,1)=lg7_12(i1,i2)%d(1,1)*p712q*u7
     & 12_56(i5,i6)%d(1,1)+lg7_12(i1,i2)%b(1,2)*u712_56(i5,i6)%c
     & (2,1)
      ug7_1256(i1,i2,i5,i6)%a(1,2)=rmass(id7)*(lg7_12(i1,i2)%a(1
     & ,1)*u712_56(i5,i6)%b(1,2)+lg7_12(i1,i2)%c(1,2)*u712_56(i5
     & ,i6)%a(2,2))
      ug7_1256(i1,i2,i5,i6)%b(1,2)=lg7_12(i1,i2)%d(1,1)*p712q*u7
     & 12_56(i5,i6)%b(1,2)+lg7_12(i1,i2)%b(1,2)*u712_56(i5,i6)%a
     & (2,2)
      ug7_1256(i1,i2,i5,i6)%c(1,2)=lg7_12(i1,i2)%a(1,1)*u712_56(
     & i5,i6)%c(1,2)+lg7_12(i1,i2)%c(1,2)*p712q*u712_56(i5,i6)%d
     & (2,2)
      ug7_1256(i1,i2,i5,i6)%d(1,2)=rmass(id7)*(lg7_12(i1,i2)%d(1
     & ,1)*u712_56(i5,i6)%c(1,2)+lg7_12(i1,i2)%b(1,2)*u712_56(i5
     & ,i6)%d(2,2))
      ug7_1256(i1,i2,i5,i6)%a(2,1)=rmass(id7)*(lg7_12(i1,i2)%c(2
     & ,1)*u712_56(i5,i6)%a(1,1)+lg7_12(i1,i2)%a(2,2)*u712_56(i5
     & ,i6)%b(2,1))
      ug7_1256(i1,i2,i5,i6)%b(2,1)=lg7_12(i1,i2)%b(2,1)*u712_56(
     & i5,i6)%a(1,1)+lg7_12(i1,i2)%d(2,2)*p712q*u712_56(i5,i6)%b
     & (2,1)
      ug7_1256(i1,i2,i5,i6)%c(2,1)=lg7_12(i1,i2)%c(2,1)*p712q*u7
     & 12_56(i5,i6)%d(1,1)+lg7_12(i1,i2)%a(2,2)*u712_56(i5,i6)%c
     & (2,1)
      ug7_1256(i1,i2,i5,i6)%d(2,1)=rmass(id7)*(lg7_12(i1,i2)%b(2
     & ,1)*u712_56(i5,i6)%d(1,1)+lg7_12(i1,i2)%d(2,2)*u712_56(i5
     & ,i6)%c(2,1))
      ug7_1256(i1,i2,i5,i6)%a(2,2)=lg7_12(i1,i2)%c(2,1)*p712q*u7
     & 12_56(i5,i6)%b(1,2)+lg7_12(i1,i2)%a(2,2)*u712_56(i5,i6)%a
     & (2,2)
      ug7_1256(i1,i2,i5,i6)%b(2,2)=rmass(id7)*(lg7_12(i1,i2)%b(2
     & ,1)*u712_56(i5,i6)%b(1,2)+lg7_12(i1,i2)%d(2,2)*u712_56(i5
     & ,i6)%a(2,2))
      ug7_1256(i1,i2,i5,i6)%c(2,2)=rmass(id7)*(lg7_12(i1,i2)%c(2
     & ,1)*u712_56(i5,i6)%c(1,2)+lg7_12(i1,i2)%a(2,2)*u712_56(i5
     & ,i6)%d(2,2))
      ug7_1256(i1,i2,i5,i6)%d(2,2)=lg7_12(i1,i2)%b(2,1)*u712_56(
     & i5,i6)%c(1,2)+lg7_12(i1,i2)%d(2,2)*p712q*u712_56(i5,i6)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=ug7_1256(i1,i2,i5,i6)%a,bb=ug7_1256(i1,i2,i5,i6)%b,cc=ug7_125
* 6(i1,i2,i5,i6)%c,dd=ug7_1256(i1,i2,i5,i6)%d,a1=l7_56(i5,i6)%a,b1=l7_56
* (i5,i6)%b,c1=l7_56(i5,i6)%c,d1=l7_56(i5,i6)%d,a2=ug756_12(i1,i2)%a,b2=
* ug756_12(i1,i2)%b,c2=ug756_12(i1,i2)%c,d2=ug756_12(i1,i2)%d,prq=p756q,
* m=rmass(id7),nsum=1
      ug7_1256(i1,i2,i5,i6)%a(1,1)=ug7_1256(i1,i2,i5,i6)%a(1,1)+
     & l7_56(i5,i6)%a(1,1)*ug756_12(i1,i2)%a(1,1)+l7_56(i5,i6)%c
     & (1,2)*p756q*ug756_12(i1,i2)%b(2,1)
      ug7_1256(i1,i2,i5,i6)%b(1,1)=ug7_1256(i1,i2,i5,i6)%b(1,1)+
     & rmass(id7)*(l7_56(i5,i6)%d(1,1)*ug756_12(i1,i2)%a(1,1)+l7
     & _56(i5,i6)%b(1,2)*ug756_12(i1,i2)%b(2,1))
      ug7_1256(i1,i2,i5,i6)%c(1,1)=ug7_1256(i1,i2,i5,i6)%c(1,1)+
     & rmass(id7)*(l7_56(i5,i6)%a(1,1)*ug756_12(i1,i2)%d(1,1)+l7
     & _56(i5,i6)%c(1,2)*ug756_12(i1,i2)%c(2,1))
      ug7_1256(i1,i2,i5,i6)%d(1,1)=ug7_1256(i1,i2,i5,i6)%d(1,1)+
     & l7_56(i5,i6)%d(1,1)*p756q*ug756_12(i1,i2)%d(1,1)+l7_56(i5
     & ,i6)%b(1,2)*ug756_12(i1,i2)%c(2,1)
      ug7_1256(i1,i2,i5,i6)%a(1,2)=ug7_1256(i1,i2,i5,i6)%a(1,2)+
     & rmass(id7)*(l7_56(i5,i6)%a(1,1)*ug756_12(i1,i2)%b(1,2)+l7
     & _56(i5,i6)%c(1,2)*ug756_12(i1,i2)%a(2,2))
      ug7_1256(i1,i2,i5,i6)%b(1,2)=ug7_1256(i1,i2,i5,i6)%b(1,2)+
     & l7_56(i5,i6)%d(1,1)*p756q*ug756_12(i1,i2)%b(1,2)+l7_56(i5
     & ,i6)%b(1,2)*ug756_12(i1,i2)%a(2,2)
      ug7_1256(i1,i2,i5,i6)%c(1,2)=ug7_1256(i1,i2,i5,i6)%c(1,2)+
     & l7_56(i5,i6)%a(1,1)*ug756_12(i1,i2)%c(1,2)+l7_56(i5,i6)%c
     & (1,2)*p756q*ug756_12(i1,i2)%d(2,2)
      ug7_1256(i1,i2,i5,i6)%d(1,2)=ug7_1256(i1,i2,i5,i6)%d(1,2)+
     & rmass(id7)*(l7_56(i5,i6)%d(1,1)*ug756_12(i1,i2)%c(1,2)+l7
     & _56(i5,i6)%b(1,2)*ug756_12(i1,i2)%d(2,2))
      ug7_1256(i1,i2,i5,i6)%a(2,1)=ug7_1256(i1,i2,i5,i6)%a(2,1)+
     & rmass(id7)*(l7_56(i5,i6)%c(2,1)*ug756_12(i1,i2)%a(1,1)+l7
     & _56(i5,i6)%a(2,2)*ug756_12(i1,i2)%b(2,1))
      ug7_1256(i1,i2,i5,i6)%b(2,1)=ug7_1256(i1,i2,i5,i6)%b(2,1)+
     & l7_56(i5,i6)%b(2,1)*ug756_12(i1,i2)%a(1,1)+l7_56(i5,i6)%d
     & (2,2)*p756q*ug756_12(i1,i2)%b(2,1)
      ug7_1256(i1,i2,i5,i6)%c(2,1)=ug7_1256(i1,i2,i5,i6)%c(2,1)+
     & l7_56(i5,i6)%c(2,1)*p756q*ug756_12(i1,i2)%d(1,1)+l7_56(i5
     & ,i6)%a(2,2)*ug756_12(i1,i2)%c(2,1)
      ug7_1256(i1,i2,i5,i6)%d(2,1)=ug7_1256(i1,i2,i5,i6)%d(2,1)+
     & rmass(id7)*(l7_56(i5,i6)%b(2,1)*ug756_12(i1,i2)%d(1,1)+l7
     & _56(i5,i6)%d(2,2)*ug756_12(i1,i2)%c(2,1))
      ug7_1256(i1,i2,i5,i6)%a(2,2)=ug7_1256(i1,i2,i5,i6)%a(2,2)+
     & l7_56(i5,i6)%c(2,1)*p756q*ug756_12(i1,i2)%b(1,2)+l7_56(i5
     & ,i6)%a(2,2)*ug756_12(i1,i2)%a(2,2)
      ug7_1256(i1,i2,i5,i6)%b(2,2)=ug7_1256(i1,i2,i5,i6)%b(2,2)+
     & rmass(id7)*(l7_56(i5,i6)%b(2,1)*ug756_12(i1,i2)%b(1,2)+l7
     & _56(i5,i6)%d(2,2)*ug756_12(i1,i2)%a(2,2))
      ug7_1256(i1,i2,i5,i6)%c(2,2)=ug7_1256(i1,i2,i5,i6)%c(2,2)+
     & rmass(id7)*(l7_56(i5,i6)%c(2,1)*ug756_12(i1,i2)%c(1,2)+l7
     & _56(i5,i6)%a(2,2)*ug756_12(i1,i2)%d(2,2))
      ug7_1256(i1,i2,i5,i6)%d(2,2)=ug7_1256(i1,i2,i5,i6)%d(2,2)+
     & l7_56(i5,i6)%b(2,1)*ug756_12(i1,i2)%c(1,2)+l7_56(i5,i6)%d
     & (2,2)*p756q*ug756_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TTs -- aa=ug7_1256(i1,i2,i5,i6)%a,bb=ug7_1256(i1,i2,i5,i6)%b,cc=ug7_12
* 56(i1,i2,i5,i6)%c,dd=ug7_1256(i1,i2,i5,i6)%d,a1=lg7_12(i1,i2)%a,b1=lg7
* _12(i1,i2)%b,c1=lg7_12(i1,i2)%c,d1=lg7_12(i1,i2)%d,a2=u712_56(i5,i6)%a
* ,b2=u712_56(i5,i6)%b,c2=u712_56(i5,i6)%c,d2=u712_56(i5,i6)%d,prq=p712q
* ,m=rmass(id7),nsum=0
      do jut=1,2
      cx1=u712_56(i5,i6)%a(1,jut)+rmass(id7)*u712_56(i5,i6)%b(1,
     & jut)
      cx2=u712_56(i5,i6)%a(2,jut)+rmass(id7)*u712_56(i5,i6)%b(2,
     & jut)
      cy1=p712q*u712_56(i5,i6)%b(1,jut)+rmass(id7)*u712_56(i5,i6
     & )%a(1,jut)
      cy2=p712q*u712_56(i5,i6)%b(2,jut)+rmass(id7)*u712_56(i5,i6
     & )%a(2,jut)
      cw1=u712_56(i5,i6)%c(1,jut)+rmass(id7)*u712_56(i5,i6)%d(1,
     & jut)
      cw2=u712_56(i5,i6)%c(2,jut)+rmass(id7)*u712_56(i5,i6)%d(2,
     & jut)
      cz1=p712q*u712_56(i5,i6)%d(1,jut)+rmass(id7)*u712_56(i5,i6
     & )%c(1,jut)
      cz2=p712q*u712_56(i5,i6)%d(2,jut)+rmass(id7)*u712_56(i5,i6
     & )%c(2,jut)
      ug7_1256(i1,i2,i5,i6)%a(1,jut)=lg7_12(i1,i2)%a(1,1)*cx1+lg
     & 7_12(i1,i2)%c(1,2)*cy2
      ug7_1256(i1,i2,i5,i6)%b(1,jut)=lg7_12(i1,i2)%d(1,1)*cy1+lg
     & 7_12(i1,i2)%b(1,2)*cx2
      ug7_1256(i1,i2,i5,i6)%c(1,jut)=lg7_12(i1,i2)%a(1,1)*cw1+lg
     & 7_12(i1,i2)%c(1,2)*cz2
      ug7_1256(i1,i2,i5,i6)%d(1,jut)=lg7_12(i1,i2)%d(1,1)*cz1+lg
     & 7_12(i1,i2)%b(1,2)*cw2
      ug7_1256(i1,i2,i5,i6)%a(2,jut)=lg7_12(i1,i2)%c(2,1)*cy1+lg
     & 7_12(i1,i2)%a(2,2)*cx2
      ug7_1256(i1,i2,i5,i6)%b(2,jut)=lg7_12(i1,i2)%b(2,1)*cx1+lg
     & 7_12(i1,i2)%d(2,2)*cy2
      ug7_1256(i1,i2,i5,i6)%c(2,jut)=lg7_12(i1,i2)%c(2,1)*cz1+lg
     & 7_12(i1,i2)%a(2,2)*cw2
      ug7_1256(i1,i2,i5,i6)%d(2,jut)=lg7_12(i1,i2)%b(2,1)*cw1+lg
     & 7_12(i1,i2)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=ug7_1256(i1,i2,i5,i6)%a,bb=ug7_1256(i1,i2,i5,i6)%b,cc=ug7_12
* 56(i1,i2,i5,i6)%c,dd=ug7_1256(i1,i2,i5,i6)%d,a1=l7_56(i5,i6)%a,b1=l7_5
* 6(i5,i6)%b,c1=l7_56(i5,i6)%c,d1=l7_56(i5,i6)%d,a2=ug756_12(i1,i2)%a,b2
* =ug756_12(i1,i2)%b,c2=ug756_12(i1,i2)%c,d2=ug756_12(i1,i2)%d,prq=p756q
* ,m=rmass(id7),nsum=1
      do iut=1,2
      cx1=l7_56(i5,i6)%a(iut,1)+l7_56(i5,i6)%c(iut,1)*rmass(id7)
      cx2=l7_56(i5,i6)%c(iut,2)*p756q+l7_56(i5,i6)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_56(i5,i6)%b(iut,1)+l7_56(i5,i6)%d(iut,1)*rmass(id7)
      cy2=l7_56(i5,i6)%d(iut,2)*p756q+l7_56(i5,i6)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_56(i5,i6)%c(iut,1)*p756q+l7_56(i5,i6)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_56(i5,i6)%a(iut,2)+l7_56(i5,i6)%c(iut,2)*rmass(id7)
      cz1=l7_56(i5,i6)%d(iut,1)*p756q+l7_56(i5,i6)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_56(i5,i6)%b(iut,2)+l7_56(i5,i6)%d(iut,2)*rmass(id7)
      ug7_1256(i1,i2,i5,i6)%a(iut,1)=ug7_1256(i1,i2,i5,i6)%a(iut
     & ,1)+cx1*ug756_12(i1,i2)%a(1,1)+cx2*ug756_12(i1,i2)%b(2,1)
      ug7_1256(i1,i2,i5,i6)%b(iut,1)=ug7_1256(i1,i2,i5,i6)%b(iut
     & ,1)+cy1*ug756_12(i1,i2)%a(1,1)+cy2*ug756_12(i1,i2)%b(2,1)
      ug7_1256(i1,i2,i5,i6)%c(iut,1)=ug7_1256(i1,i2,i5,i6)%c(iut
     & ,1)+cw1*ug756_12(i1,i2)%d(1,1)+cw2*ug756_12(i1,i2)%c(2,1)
      ug7_1256(i1,i2,i5,i6)%d(iut,1)=ug7_1256(i1,i2,i5,i6)%d(iut
     & ,1)+cz1*ug756_12(i1,i2)%d(1,1)+cz2*ug756_12(i1,i2)%c(2,1)
      ug7_1256(i1,i2,i5,i6)%a(iut,2)=ug7_1256(i1,i2,i5,i6)%a(iut
     & ,2)+cw1*ug756_12(i1,i2)%b(1,2)+cw2*ug756_12(i1,i2)%a(2,2)
      ug7_1256(i1,i2,i5,i6)%b(iut,2)=ug7_1256(i1,i2,i5,i6)%b(iut
     & ,2)+cz1*ug756_12(i1,i2)%b(1,2)+cz2*ug756_12(i1,i2)%a(2,2)
      ug7_1256(i1,i2,i5,i6)%c(iut,2)=ug7_1256(i1,i2,i5,i6)%c(iut
     & ,2)+cx1*ug756_12(i1,i2)%c(1,2)+cx2*ug756_12(i1,i2)%d(2,2)
      ug7_1256(i1,i2,i5,i6)%d(iut,2)=ug7_1256(i1,i2,i5,i6)%d(iut
     & ,2)+cy1*ug756_12(i1,i2)%c(1,2)+cy2*ug756_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id7).ne.1 .and. ilept(id5).ne.1)then
        if(id7.ne.5 .or. id1.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* TT -- aa=ug7_5612(i5,i6,i1,i2)%a,bb=ug7_5612(i5,i6,i1,i2)%b,cc=ug7_561
* 2(i5,i6,i1,i2)%c,dd=ug7_5612(i5,i6,i1,i2)%d,a1=lg7_56(i5,i6)%a,b1=lg7_
* 56(i5,i6)%b,c1=lg7_56(i5,i6)%c,d1=lg7_56(i5,i6)%d,a2=u756_12(i1,i2)%a,
* b2=u756_12(i1,i2)%b,c2=u756_12(i1,i2)%c,d2=u756_12(i1,i2)%d,prq=p756q,
* m=rmass(id7),nsum=0
      ug7_5612(i5,i6,i1,i2)%a(1,1)=lg7_56(i5,i6)%a(1,1)*u756_12(
     & i1,i2)%a(1,1)+lg7_56(i5,i6)%c(1,2)*p756q*u756_12(i1,i2)%b
     & (2,1)
      ug7_5612(i5,i6,i1,i2)%b(1,1)=rmass(id7)*(lg7_56(i5,i6)%d(1
     & ,1)*u756_12(i1,i2)%a(1,1)+lg7_56(i5,i6)%b(1,2)*u756_12(i1
     & ,i2)%b(2,1))
      ug7_5612(i5,i6,i1,i2)%c(1,1)=rmass(id7)*(lg7_56(i5,i6)%a(1
     & ,1)*u756_12(i1,i2)%d(1,1)+lg7_56(i5,i6)%c(1,2)*u756_12(i1
     & ,i2)%c(2,1))
      ug7_5612(i5,i6,i1,i2)%d(1,1)=lg7_56(i5,i6)%d(1,1)*p756q*u7
     & 56_12(i1,i2)%d(1,1)+lg7_56(i5,i6)%b(1,2)*u756_12(i1,i2)%c
     & (2,1)
      ug7_5612(i5,i6,i1,i2)%a(1,2)=rmass(id7)*(lg7_56(i5,i6)%a(1
     & ,1)*u756_12(i1,i2)%b(1,2)+lg7_56(i5,i6)%c(1,2)*u756_12(i1
     & ,i2)%a(2,2))
      ug7_5612(i5,i6,i1,i2)%b(1,2)=lg7_56(i5,i6)%d(1,1)*p756q*u7
     & 56_12(i1,i2)%b(1,2)+lg7_56(i5,i6)%b(1,2)*u756_12(i1,i2)%a
     & (2,2)
      ug7_5612(i5,i6,i1,i2)%c(1,2)=lg7_56(i5,i6)%a(1,1)*u756_12(
     & i1,i2)%c(1,2)+lg7_56(i5,i6)%c(1,2)*p756q*u756_12(i1,i2)%d
     & (2,2)
      ug7_5612(i5,i6,i1,i2)%d(1,2)=rmass(id7)*(lg7_56(i5,i6)%d(1
     & ,1)*u756_12(i1,i2)%c(1,2)+lg7_56(i5,i6)%b(1,2)*u756_12(i1
     & ,i2)%d(2,2))
      ug7_5612(i5,i6,i1,i2)%a(2,1)=rmass(id7)*(lg7_56(i5,i6)%c(2
     & ,1)*u756_12(i1,i2)%a(1,1)+lg7_56(i5,i6)%a(2,2)*u756_12(i1
     & ,i2)%b(2,1))
      ug7_5612(i5,i6,i1,i2)%b(2,1)=lg7_56(i5,i6)%b(2,1)*u756_12(
     & i1,i2)%a(1,1)+lg7_56(i5,i6)%d(2,2)*p756q*u756_12(i1,i2)%b
     & (2,1)
      ug7_5612(i5,i6,i1,i2)%c(2,1)=lg7_56(i5,i6)%c(2,1)*p756q*u7
     & 56_12(i1,i2)%d(1,1)+lg7_56(i5,i6)%a(2,2)*u756_12(i1,i2)%c
     & (2,1)
      ug7_5612(i5,i6,i1,i2)%d(2,1)=rmass(id7)*(lg7_56(i5,i6)%b(2
     & ,1)*u756_12(i1,i2)%d(1,1)+lg7_56(i5,i6)%d(2,2)*u756_12(i1
     & ,i2)%c(2,1))
      ug7_5612(i5,i6,i1,i2)%a(2,2)=lg7_56(i5,i6)%c(2,1)*p756q*u7
     & 56_12(i1,i2)%b(1,2)+lg7_56(i5,i6)%a(2,2)*u756_12(i1,i2)%a
     & (2,2)
      ug7_5612(i5,i6,i1,i2)%b(2,2)=rmass(id7)*(lg7_56(i5,i6)%b(2
     & ,1)*u756_12(i1,i2)%b(1,2)+lg7_56(i5,i6)%d(2,2)*u756_12(i1
     & ,i2)%a(2,2))
      ug7_5612(i5,i6,i1,i2)%c(2,2)=rmass(id7)*(lg7_56(i5,i6)%c(2
     & ,1)*u756_12(i1,i2)%c(1,2)+lg7_56(i5,i6)%a(2,2)*u756_12(i1
     & ,i2)%d(2,2))
      ug7_5612(i5,i6,i1,i2)%d(2,2)=lg7_56(i5,i6)%b(2,1)*u756_12(
     & i1,i2)%c(1,2)+lg7_56(i5,i6)%d(2,2)*p756q*u756_12(i1,i2)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* TT -- aa=ug7_5612(i5,i6,i1,i2)%a,bb=ug7_5612(i5,i6,i1,i2)%b,cc=ug7_561
* 2(i5,i6,i1,i2)%c,dd=ug7_5612(i5,i6,i1,i2)%d,a1=l7_12(i1,i2)%a,b1=l7_12
* (i1,i2)%b,c1=l7_12(i1,i2)%c,d1=l7_12(i1,i2)%d,a2=ug712_56(i5,i6)%a,b2=
* ug712_56(i5,i6)%b,c2=ug712_56(i5,i6)%c,d2=ug712_56(i5,i6)%d,prq=p712q,
* m=rmass(id7),nsum=1
      ug7_5612(i5,i6,i1,i2)%a(1,1)=ug7_5612(i5,i6,i1,i2)%a(1,1)+
     & l7_12(i1,i2)%a(1,1)*ug712_56(i5,i6)%a(1,1)+l7_12(i1,i2)%c
     & (1,2)*p712q*ug712_56(i5,i6)%b(2,1)
      ug7_5612(i5,i6,i1,i2)%b(1,1)=ug7_5612(i5,i6,i1,i2)%b(1,1)+
     & rmass(id7)*(l7_12(i1,i2)%d(1,1)*ug712_56(i5,i6)%a(1,1)+l7
     & _12(i1,i2)%b(1,2)*ug712_56(i5,i6)%b(2,1))
      ug7_5612(i5,i6,i1,i2)%c(1,1)=ug7_5612(i5,i6,i1,i2)%c(1,1)+
     & rmass(id7)*(l7_12(i1,i2)%a(1,1)*ug712_56(i5,i6)%d(1,1)+l7
     & _12(i1,i2)%c(1,2)*ug712_56(i5,i6)%c(2,1))
      ug7_5612(i5,i6,i1,i2)%d(1,1)=ug7_5612(i5,i6,i1,i2)%d(1,1)+
     & l7_12(i1,i2)%d(1,1)*p712q*ug712_56(i5,i6)%d(1,1)+l7_12(i1
     & ,i2)%b(1,2)*ug712_56(i5,i6)%c(2,1)
      ug7_5612(i5,i6,i1,i2)%a(1,2)=ug7_5612(i5,i6,i1,i2)%a(1,2)+
     & rmass(id7)*(l7_12(i1,i2)%a(1,1)*ug712_56(i5,i6)%b(1,2)+l7
     & _12(i1,i2)%c(1,2)*ug712_56(i5,i6)%a(2,2))
      ug7_5612(i5,i6,i1,i2)%b(1,2)=ug7_5612(i5,i6,i1,i2)%b(1,2)+
     & l7_12(i1,i2)%d(1,1)*p712q*ug712_56(i5,i6)%b(1,2)+l7_12(i1
     & ,i2)%b(1,2)*ug712_56(i5,i6)%a(2,2)
      ug7_5612(i5,i6,i1,i2)%c(1,2)=ug7_5612(i5,i6,i1,i2)%c(1,2)+
     & l7_12(i1,i2)%a(1,1)*ug712_56(i5,i6)%c(1,2)+l7_12(i1,i2)%c
     & (1,2)*p712q*ug712_56(i5,i6)%d(2,2)
      ug7_5612(i5,i6,i1,i2)%d(1,2)=ug7_5612(i5,i6,i1,i2)%d(1,2)+
     & rmass(id7)*(l7_12(i1,i2)%d(1,1)*ug712_56(i5,i6)%c(1,2)+l7
     & _12(i1,i2)%b(1,2)*ug712_56(i5,i6)%d(2,2))
      ug7_5612(i5,i6,i1,i2)%a(2,1)=ug7_5612(i5,i6,i1,i2)%a(2,1)+
     & rmass(id7)*(l7_12(i1,i2)%c(2,1)*ug712_56(i5,i6)%a(1,1)+l7
     & _12(i1,i2)%a(2,2)*ug712_56(i5,i6)%b(2,1))
      ug7_5612(i5,i6,i1,i2)%b(2,1)=ug7_5612(i5,i6,i1,i2)%b(2,1)+
     & l7_12(i1,i2)%b(2,1)*ug712_56(i5,i6)%a(1,1)+l7_12(i1,i2)%d
     & (2,2)*p712q*ug712_56(i5,i6)%b(2,1)
      ug7_5612(i5,i6,i1,i2)%c(2,1)=ug7_5612(i5,i6,i1,i2)%c(2,1)+
     & l7_12(i1,i2)%c(2,1)*p712q*ug712_56(i5,i6)%d(1,1)+l7_12(i1
     & ,i2)%a(2,2)*ug712_56(i5,i6)%c(2,1)
      ug7_5612(i5,i6,i1,i2)%d(2,1)=ug7_5612(i5,i6,i1,i2)%d(2,1)+
     & rmass(id7)*(l7_12(i1,i2)%b(2,1)*ug712_56(i5,i6)%d(1,1)+l7
     & _12(i1,i2)%d(2,2)*ug712_56(i5,i6)%c(2,1))
      ug7_5612(i5,i6,i1,i2)%a(2,2)=ug7_5612(i5,i6,i1,i2)%a(2,2)+
     & l7_12(i1,i2)%c(2,1)*p712q*ug712_56(i5,i6)%b(1,2)+l7_12(i1
     & ,i2)%a(2,2)*ug712_56(i5,i6)%a(2,2)
      ug7_5612(i5,i6,i1,i2)%b(2,2)=ug7_5612(i5,i6,i1,i2)%b(2,2)+
     & rmass(id7)*(l7_12(i1,i2)%b(2,1)*ug712_56(i5,i6)%b(1,2)+l7
     & _12(i1,i2)%d(2,2)*ug712_56(i5,i6)%a(2,2))
      ug7_5612(i5,i6,i1,i2)%c(2,2)=ug7_5612(i5,i6,i1,i2)%c(2,2)+
     & rmass(id7)*(l7_12(i1,i2)%c(2,1)*ug712_56(i5,i6)%c(1,2)+l7
     & _12(i1,i2)%a(2,2)*ug712_56(i5,i6)%d(2,2))
      ug7_5612(i5,i6,i1,i2)%d(2,2)=ug7_5612(i5,i6,i1,i2)%d(2,2)+
     & l7_12(i1,i2)%b(2,1)*ug712_56(i5,i6)%c(1,2)+l7_12(i1,i2)%d
     & (2,2)*p712q*ug712_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* TTs -- aa=ug7_5612(i5,i6,i1,i2)%a,bb=ug7_5612(i5,i6,i1,i2)%b,cc=ug7_56
* 12(i5,i6,i1,i2)%c,dd=ug7_5612(i5,i6,i1,i2)%d,a1=lg7_56(i5,i6)%a,b1=lg7
* _56(i5,i6)%b,c1=lg7_56(i5,i6)%c,d1=lg7_56(i5,i6)%d,a2=u756_12(i1,i2)%a
* ,b2=u756_12(i1,i2)%b,c2=u756_12(i1,i2)%c,d2=u756_12(i1,i2)%d,prq=p756q
* ,m=rmass(id7),nsum=0
      do jut=1,2
      cx1=u756_12(i1,i2)%a(1,jut)+rmass(id7)*u756_12(i1,i2)%b(1,
     & jut)
      cx2=u756_12(i1,i2)%a(2,jut)+rmass(id7)*u756_12(i1,i2)%b(2,
     & jut)
      cy1=p756q*u756_12(i1,i2)%b(1,jut)+rmass(id7)*u756_12(i1,i2
     & )%a(1,jut)
      cy2=p756q*u756_12(i1,i2)%b(2,jut)+rmass(id7)*u756_12(i1,i2
     & )%a(2,jut)
      cw1=u756_12(i1,i2)%c(1,jut)+rmass(id7)*u756_12(i1,i2)%d(1,
     & jut)
      cw2=u756_12(i1,i2)%c(2,jut)+rmass(id7)*u756_12(i1,i2)%d(2,
     & jut)
      cz1=p756q*u756_12(i1,i2)%d(1,jut)+rmass(id7)*u756_12(i1,i2
     & )%c(1,jut)
      cz2=p756q*u756_12(i1,i2)%d(2,jut)+rmass(id7)*u756_12(i1,i2
     & )%c(2,jut)
      ug7_5612(i5,i6,i1,i2)%a(1,jut)=lg7_56(i5,i6)%a(1,1)*cx1+lg
     & 7_56(i5,i6)%c(1,2)*cy2
      ug7_5612(i5,i6,i1,i2)%b(1,jut)=lg7_56(i5,i6)%d(1,1)*cy1+lg
     & 7_56(i5,i6)%b(1,2)*cx2
      ug7_5612(i5,i6,i1,i2)%c(1,jut)=lg7_56(i5,i6)%a(1,1)*cw1+lg
     & 7_56(i5,i6)%c(1,2)*cz2
      ug7_5612(i5,i6,i1,i2)%d(1,jut)=lg7_56(i5,i6)%d(1,1)*cz1+lg
     & 7_56(i5,i6)%b(1,2)*cw2
      ug7_5612(i5,i6,i1,i2)%a(2,jut)=lg7_56(i5,i6)%c(2,1)*cy1+lg
     & 7_56(i5,i6)%a(2,2)*cx2
      ug7_5612(i5,i6,i1,i2)%b(2,jut)=lg7_56(i5,i6)%b(2,1)*cx1+lg
     & 7_56(i5,i6)%d(2,2)*cy2
      ug7_5612(i5,i6,i1,i2)%c(2,jut)=lg7_56(i5,i6)%c(2,1)*cz1+lg
     & 7_56(i5,i6)%a(2,2)*cw2
      ug7_5612(i5,i6,i1,i2)%d(2,jut)=lg7_56(i5,i6)%b(2,1)*cw1+lg
     & 7_56(i5,i6)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=ug7_5612(i5,i6,i1,i2)%a,bb=ug7_5612(i5,i6,i1,i2)%b,cc=ug7_56
* 12(i5,i6,i1,i2)%c,dd=ug7_5612(i5,i6,i1,i2)%d,a1=l7_12(i1,i2)%a,b1=l7_1
* 2(i1,i2)%b,c1=l7_12(i1,i2)%c,d1=l7_12(i1,i2)%d,a2=ug712_56(i5,i6)%a,b2
* =ug712_56(i5,i6)%b,c2=ug712_56(i5,i6)%c,d2=ug712_56(i5,i6)%d,prq=p712q
* ,m=rmass(id7),nsum=1
      do iut=1,2
      cx1=l7_12(i1,i2)%a(iut,1)+l7_12(i1,i2)%c(iut,1)*rmass(id7)
      cx2=l7_12(i1,i2)%c(iut,2)*p712q+l7_12(i1,i2)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_12(i1,i2)%b(iut,1)+l7_12(i1,i2)%d(iut,1)*rmass(id7)
      cy2=l7_12(i1,i2)%d(iut,2)*p712q+l7_12(i1,i2)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_12(i1,i2)%c(iut,1)*p712q+l7_12(i1,i2)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_12(i1,i2)%a(iut,2)+l7_12(i1,i2)%c(iut,2)*rmass(id7)
      cz1=l7_12(i1,i2)%d(iut,1)*p712q+l7_12(i1,i2)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_12(i1,i2)%b(iut,2)+l7_12(i1,i2)%d(iut,2)*rmass(id7)
      ug7_5612(i5,i6,i1,i2)%a(iut,1)=ug7_5612(i5,i6,i1,i2)%a(iut
     & ,1)+cx1*ug712_56(i5,i6)%a(1,1)+cx2*ug712_56(i5,i6)%b(2,1)
      ug7_5612(i5,i6,i1,i2)%b(iut,1)=ug7_5612(i5,i6,i1,i2)%b(iut
     & ,1)+cy1*ug712_56(i5,i6)%a(1,1)+cy2*ug712_56(i5,i6)%b(2,1)
      ug7_5612(i5,i6,i1,i2)%c(iut,1)=ug7_5612(i5,i6,i1,i2)%c(iut
     & ,1)+cw1*ug712_56(i5,i6)%d(1,1)+cw2*ug712_56(i5,i6)%c(2,1)
      ug7_5612(i5,i6,i1,i2)%d(iut,1)=ug7_5612(i5,i6,i1,i2)%d(iut
     & ,1)+cz1*ug712_56(i5,i6)%d(1,1)+cz2*ug712_56(i5,i6)%c(2,1)
      ug7_5612(i5,i6,i1,i2)%a(iut,2)=ug7_5612(i5,i6,i1,i2)%a(iut
     & ,2)+cw1*ug712_56(i5,i6)%b(1,2)+cw2*ug712_56(i5,i6)%a(2,2)
      ug7_5612(i5,i6,i1,i2)%b(iut,2)=ug7_5612(i5,i6,i1,i2)%b(iut
     & ,2)+cz1*ug712_56(i5,i6)%b(1,2)+cz2*ug712_56(i5,i6)%a(2,2)
      ug7_5612(i5,i6,i1,i2)%c(iut,2)=ug7_5612(i5,i6,i1,i2)%c(iut
     & ,2)+cx1*ug712_56(i5,i6)%c(1,2)+cx2*ug712_56(i5,i6)%d(2,2)
      ug7_5612(i5,i6,i1,i2)%d(iut,2)=ug7_5612(i5,i6,i1,i2)%d(iut
     & ,2)+cy1*ug712_56(i5,i6)%c(1,2)+cy2*ug712_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id7).ne.1 .and. ilept(id3).ne.1)then
        if(id7.ne.5 .or. id5.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=ug7_3456(i3,i4,i5,i6)%a,bb=ug7_3456(i3,i4,i5,i6)%b,cc=ug7_345
* 6(i3,i4,i5,i6)%c,dd=ug7_3456(i3,i4,i5,i6)%d,a1=lg7_34(i3,i4)%a,b1=lg7_
* 34(i3,i4)%b,c1=lg7_34(i3,i4)%c,d1=lg7_34(i3,i4)%d,a2=u734_56(i5,i6)%a,
* b2=u734_56(i5,i6)%b,c2=u734_56(i5,i6)%c,d2=u734_56(i5,i6)%d,prq=p734q,
* m=rmass(id7),nsum=0
      ug7_3456(i3,i4,i5,i6)%a(1,1)=lg7_34(i3,i4)%a(1,1)*u734_56(
     & i5,i6)%a(1,1)+lg7_34(i3,i4)%c(1,2)*p734q*u734_56(i5,i6)%b
     & (2,1)
      ug7_3456(i3,i4,i5,i6)%b(1,1)=rmass(id7)*(lg7_34(i3,i4)%d(1
     & ,1)*u734_56(i5,i6)%a(1,1)+lg7_34(i3,i4)%b(1,2)*u734_56(i5
     & ,i6)%b(2,1))
      ug7_3456(i3,i4,i5,i6)%c(1,1)=rmass(id7)*(lg7_34(i3,i4)%a(1
     & ,1)*u734_56(i5,i6)%d(1,1)+lg7_34(i3,i4)%c(1,2)*u734_56(i5
     & ,i6)%c(2,1))
      ug7_3456(i3,i4,i5,i6)%d(1,1)=lg7_34(i3,i4)%d(1,1)*p734q*u7
     & 34_56(i5,i6)%d(1,1)+lg7_34(i3,i4)%b(1,2)*u734_56(i5,i6)%c
     & (2,1)
      ug7_3456(i3,i4,i5,i6)%a(1,2)=rmass(id7)*(lg7_34(i3,i4)%a(1
     & ,1)*u734_56(i5,i6)%b(1,2)+lg7_34(i3,i4)%c(1,2)*u734_56(i5
     & ,i6)%a(2,2))
      ug7_3456(i3,i4,i5,i6)%b(1,2)=lg7_34(i3,i4)%d(1,1)*p734q*u7
     & 34_56(i5,i6)%b(1,2)+lg7_34(i3,i4)%b(1,2)*u734_56(i5,i6)%a
     & (2,2)
      ug7_3456(i3,i4,i5,i6)%c(1,2)=lg7_34(i3,i4)%a(1,1)*u734_56(
     & i5,i6)%c(1,2)+lg7_34(i3,i4)%c(1,2)*p734q*u734_56(i5,i6)%d
     & (2,2)
      ug7_3456(i3,i4,i5,i6)%d(1,2)=rmass(id7)*(lg7_34(i3,i4)%d(1
     & ,1)*u734_56(i5,i6)%c(1,2)+lg7_34(i3,i4)%b(1,2)*u734_56(i5
     & ,i6)%d(2,2))
      ug7_3456(i3,i4,i5,i6)%a(2,1)=rmass(id7)*(lg7_34(i3,i4)%c(2
     & ,1)*u734_56(i5,i6)%a(1,1)+lg7_34(i3,i4)%a(2,2)*u734_56(i5
     & ,i6)%b(2,1))
      ug7_3456(i3,i4,i5,i6)%b(2,1)=lg7_34(i3,i4)%b(2,1)*u734_56(
     & i5,i6)%a(1,1)+lg7_34(i3,i4)%d(2,2)*p734q*u734_56(i5,i6)%b
     & (2,1)
      ug7_3456(i3,i4,i5,i6)%c(2,1)=lg7_34(i3,i4)%c(2,1)*p734q*u7
     & 34_56(i5,i6)%d(1,1)+lg7_34(i3,i4)%a(2,2)*u734_56(i5,i6)%c
     & (2,1)
      ug7_3456(i3,i4,i5,i6)%d(2,1)=rmass(id7)*(lg7_34(i3,i4)%b(2
     & ,1)*u734_56(i5,i6)%d(1,1)+lg7_34(i3,i4)%d(2,2)*u734_56(i5
     & ,i6)%c(2,1))
      ug7_3456(i3,i4,i5,i6)%a(2,2)=lg7_34(i3,i4)%c(2,1)*p734q*u7
     & 34_56(i5,i6)%b(1,2)+lg7_34(i3,i4)%a(2,2)*u734_56(i5,i6)%a
     & (2,2)
      ug7_3456(i3,i4,i5,i6)%b(2,2)=rmass(id7)*(lg7_34(i3,i4)%b(2
     & ,1)*u734_56(i5,i6)%b(1,2)+lg7_34(i3,i4)%d(2,2)*u734_56(i5
     & ,i6)%a(2,2))
      ug7_3456(i3,i4,i5,i6)%c(2,2)=rmass(id7)*(lg7_34(i3,i4)%c(2
     & ,1)*u734_56(i5,i6)%c(1,2)+lg7_34(i3,i4)%a(2,2)*u734_56(i5
     & ,i6)%d(2,2))
      ug7_3456(i3,i4,i5,i6)%d(2,2)=lg7_34(i3,i4)%b(2,1)*u734_56(
     & i5,i6)%c(1,2)+lg7_34(i3,i4)%d(2,2)*p734q*u734_56(i5,i6)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TT -- aa=ug7_3456(i3,i4,i5,i6)%a,bb=ug7_3456(i3,i4,i5,i6)%b,cc=ug7_345
* 6(i3,i4,i5,i6)%c,dd=ug7_3456(i3,i4,i5,i6)%d,a1=l7_56(i5,i6)%a,b1=l7_56
* (i5,i6)%b,c1=l7_56(i5,i6)%c,d1=l7_56(i5,i6)%d,a2=ug756_34(i3,i4)%a,b2=
* ug756_34(i3,i4)%b,c2=ug756_34(i3,i4)%c,d2=ug756_34(i3,i4)%d,prq=p756q,
* m=rmass(id7),nsum=1
      ug7_3456(i3,i4,i5,i6)%a(1,1)=ug7_3456(i3,i4,i5,i6)%a(1,1)+
     & l7_56(i5,i6)%a(1,1)*ug756_34(i3,i4)%a(1,1)+l7_56(i5,i6)%c
     & (1,2)*p756q*ug756_34(i3,i4)%b(2,1)
      ug7_3456(i3,i4,i5,i6)%b(1,1)=ug7_3456(i3,i4,i5,i6)%b(1,1)+
     & rmass(id7)*(l7_56(i5,i6)%d(1,1)*ug756_34(i3,i4)%a(1,1)+l7
     & _56(i5,i6)%b(1,2)*ug756_34(i3,i4)%b(2,1))
      ug7_3456(i3,i4,i5,i6)%c(1,1)=ug7_3456(i3,i4,i5,i6)%c(1,1)+
     & rmass(id7)*(l7_56(i5,i6)%a(1,1)*ug756_34(i3,i4)%d(1,1)+l7
     & _56(i5,i6)%c(1,2)*ug756_34(i3,i4)%c(2,1))
      ug7_3456(i3,i4,i5,i6)%d(1,1)=ug7_3456(i3,i4,i5,i6)%d(1,1)+
     & l7_56(i5,i6)%d(1,1)*p756q*ug756_34(i3,i4)%d(1,1)+l7_56(i5
     & ,i6)%b(1,2)*ug756_34(i3,i4)%c(2,1)
      ug7_3456(i3,i4,i5,i6)%a(1,2)=ug7_3456(i3,i4,i5,i6)%a(1,2)+
     & rmass(id7)*(l7_56(i5,i6)%a(1,1)*ug756_34(i3,i4)%b(1,2)+l7
     & _56(i5,i6)%c(1,2)*ug756_34(i3,i4)%a(2,2))
      ug7_3456(i3,i4,i5,i6)%b(1,2)=ug7_3456(i3,i4,i5,i6)%b(1,2)+
     & l7_56(i5,i6)%d(1,1)*p756q*ug756_34(i3,i4)%b(1,2)+l7_56(i5
     & ,i6)%b(1,2)*ug756_34(i3,i4)%a(2,2)
      ug7_3456(i3,i4,i5,i6)%c(1,2)=ug7_3456(i3,i4,i5,i6)%c(1,2)+
     & l7_56(i5,i6)%a(1,1)*ug756_34(i3,i4)%c(1,2)+l7_56(i5,i6)%c
     & (1,2)*p756q*ug756_34(i3,i4)%d(2,2)
      ug7_3456(i3,i4,i5,i6)%d(1,2)=ug7_3456(i3,i4,i5,i6)%d(1,2)+
     & rmass(id7)*(l7_56(i5,i6)%d(1,1)*ug756_34(i3,i4)%c(1,2)+l7
     & _56(i5,i6)%b(1,2)*ug756_34(i3,i4)%d(2,2))
      ug7_3456(i3,i4,i5,i6)%a(2,1)=ug7_3456(i3,i4,i5,i6)%a(2,1)+
     & rmass(id7)*(l7_56(i5,i6)%c(2,1)*ug756_34(i3,i4)%a(1,1)+l7
     & _56(i5,i6)%a(2,2)*ug756_34(i3,i4)%b(2,1))
      ug7_3456(i3,i4,i5,i6)%b(2,1)=ug7_3456(i3,i4,i5,i6)%b(2,1)+
     & l7_56(i5,i6)%b(2,1)*ug756_34(i3,i4)%a(1,1)+l7_56(i5,i6)%d
     & (2,2)*p756q*ug756_34(i3,i4)%b(2,1)
      ug7_3456(i3,i4,i5,i6)%c(2,1)=ug7_3456(i3,i4,i5,i6)%c(2,1)+
     & l7_56(i5,i6)%c(2,1)*p756q*ug756_34(i3,i4)%d(1,1)+l7_56(i5
     & ,i6)%a(2,2)*ug756_34(i3,i4)%c(2,1)
      ug7_3456(i3,i4,i5,i6)%d(2,1)=ug7_3456(i3,i4,i5,i6)%d(2,1)+
     & rmass(id7)*(l7_56(i5,i6)%b(2,1)*ug756_34(i3,i4)%d(1,1)+l7
     & _56(i5,i6)%d(2,2)*ug756_34(i3,i4)%c(2,1))
      ug7_3456(i3,i4,i5,i6)%a(2,2)=ug7_3456(i3,i4,i5,i6)%a(2,2)+
     & l7_56(i5,i6)%c(2,1)*p756q*ug756_34(i3,i4)%b(1,2)+l7_56(i5
     & ,i6)%a(2,2)*ug756_34(i3,i4)%a(2,2)
      ug7_3456(i3,i4,i5,i6)%b(2,2)=ug7_3456(i3,i4,i5,i6)%b(2,2)+
     & rmass(id7)*(l7_56(i5,i6)%b(2,1)*ug756_34(i3,i4)%b(1,2)+l7
     & _56(i5,i6)%d(2,2)*ug756_34(i3,i4)%a(2,2))
      ug7_3456(i3,i4,i5,i6)%c(2,2)=ug7_3456(i3,i4,i5,i6)%c(2,2)+
     & rmass(id7)*(l7_56(i5,i6)%c(2,1)*ug756_34(i3,i4)%c(1,2)+l7
     & _56(i5,i6)%a(2,2)*ug756_34(i3,i4)%d(2,2))
      ug7_3456(i3,i4,i5,i6)%d(2,2)=ug7_3456(i3,i4,i5,i6)%d(2,2)+
     & l7_56(i5,i6)%b(2,1)*ug756_34(i3,i4)%c(1,2)+l7_56(i5,i6)%d
     & (2,2)*p756q*ug756_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TTs -- aa=ug7_3456(i3,i4,i5,i6)%a,bb=ug7_3456(i3,i4,i5,i6)%b,cc=ug7_34
* 56(i3,i4,i5,i6)%c,dd=ug7_3456(i3,i4,i5,i6)%d,a1=lg7_34(i3,i4)%a,b1=lg7
* _34(i3,i4)%b,c1=lg7_34(i3,i4)%c,d1=lg7_34(i3,i4)%d,a2=u734_56(i5,i6)%a
* ,b2=u734_56(i5,i6)%b,c2=u734_56(i5,i6)%c,d2=u734_56(i5,i6)%d,prq=p734q
* ,m=rmass(id7),nsum=0
      do jut=1,2
      cx1=u734_56(i5,i6)%a(1,jut)+rmass(id7)*u734_56(i5,i6)%b(1,
     & jut)
      cx2=u734_56(i5,i6)%a(2,jut)+rmass(id7)*u734_56(i5,i6)%b(2,
     & jut)
      cy1=p734q*u734_56(i5,i6)%b(1,jut)+rmass(id7)*u734_56(i5,i6
     & )%a(1,jut)
      cy2=p734q*u734_56(i5,i6)%b(2,jut)+rmass(id7)*u734_56(i5,i6
     & )%a(2,jut)
      cw1=u734_56(i5,i6)%c(1,jut)+rmass(id7)*u734_56(i5,i6)%d(1,
     & jut)
      cw2=u734_56(i5,i6)%c(2,jut)+rmass(id7)*u734_56(i5,i6)%d(2,
     & jut)
      cz1=p734q*u734_56(i5,i6)%d(1,jut)+rmass(id7)*u734_56(i5,i6
     & )%c(1,jut)
      cz2=p734q*u734_56(i5,i6)%d(2,jut)+rmass(id7)*u734_56(i5,i6
     & )%c(2,jut)
      ug7_3456(i3,i4,i5,i6)%a(1,jut)=lg7_34(i3,i4)%a(1,1)*cx1+lg
     & 7_34(i3,i4)%c(1,2)*cy2
      ug7_3456(i3,i4,i5,i6)%b(1,jut)=lg7_34(i3,i4)%d(1,1)*cy1+lg
     & 7_34(i3,i4)%b(1,2)*cx2
      ug7_3456(i3,i4,i5,i6)%c(1,jut)=lg7_34(i3,i4)%a(1,1)*cw1+lg
     & 7_34(i3,i4)%c(1,2)*cz2
      ug7_3456(i3,i4,i5,i6)%d(1,jut)=lg7_34(i3,i4)%d(1,1)*cz1+lg
     & 7_34(i3,i4)%b(1,2)*cw2
      ug7_3456(i3,i4,i5,i6)%a(2,jut)=lg7_34(i3,i4)%c(2,1)*cy1+lg
     & 7_34(i3,i4)%a(2,2)*cx2
      ug7_3456(i3,i4,i5,i6)%b(2,jut)=lg7_34(i3,i4)%b(2,1)*cx1+lg
     & 7_34(i3,i4)%d(2,2)*cy2
      ug7_3456(i3,i4,i5,i6)%c(2,jut)=lg7_34(i3,i4)%c(2,1)*cz1+lg
     & 7_34(i3,i4)%a(2,2)*cw2
      ug7_3456(i3,i4,i5,i6)%d(2,jut)=lg7_34(i3,i4)%b(2,1)*cw1+lg
     & 7_34(i3,i4)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=ug7_3456(i3,i4,i5,i6)%a,bb=ug7_3456(i3,i4,i5,i6)%b,cc=ug7_34
* 56(i3,i4,i5,i6)%c,dd=ug7_3456(i3,i4,i5,i6)%d,a1=l7_56(i5,i6)%a,b1=l7_5
* 6(i5,i6)%b,c1=l7_56(i5,i6)%c,d1=l7_56(i5,i6)%d,a2=ug756_34(i3,i4)%a,b2
* =ug756_34(i3,i4)%b,c2=ug756_34(i3,i4)%c,d2=ug756_34(i3,i4)%d,prq=p756q
* ,m=rmass(id7),nsum=1
      do iut=1,2
      cx1=l7_56(i5,i6)%a(iut,1)+l7_56(i5,i6)%c(iut,1)*rmass(id7)
      cx2=l7_56(i5,i6)%c(iut,2)*p756q+l7_56(i5,i6)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_56(i5,i6)%b(iut,1)+l7_56(i5,i6)%d(iut,1)*rmass(id7)
      cy2=l7_56(i5,i6)%d(iut,2)*p756q+l7_56(i5,i6)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_56(i5,i6)%c(iut,1)*p756q+l7_56(i5,i6)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_56(i5,i6)%a(iut,2)+l7_56(i5,i6)%c(iut,2)*rmass(id7)
      cz1=l7_56(i5,i6)%d(iut,1)*p756q+l7_56(i5,i6)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_56(i5,i6)%b(iut,2)+l7_56(i5,i6)%d(iut,2)*rmass(id7)
      ug7_3456(i3,i4,i5,i6)%a(iut,1)=ug7_3456(i3,i4,i5,i6)%a(iut
     & ,1)+cx1*ug756_34(i3,i4)%a(1,1)+cx2*ug756_34(i3,i4)%b(2,1)
      ug7_3456(i3,i4,i5,i6)%b(iut,1)=ug7_3456(i3,i4,i5,i6)%b(iut
     & ,1)+cy1*ug756_34(i3,i4)%a(1,1)+cy2*ug756_34(i3,i4)%b(2,1)
      ug7_3456(i3,i4,i5,i6)%c(iut,1)=ug7_3456(i3,i4,i5,i6)%c(iut
     & ,1)+cw1*ug756_34(i3,i4)%d(1,1)+cw2*ug756_34(i3,i4)%c(2,1)
      ug7_3456(i3,i4,i5,i6)%d(iut,1)=ug7_3456(i3,i4,i5,i6)%d(iut
     & ,1)+cz1*ug756_34(i3,i4)%d(1,1)+cz2*ug756_34(i3,i4)%c(2,1)
      ug7_3456(i3,i4,i5,i6)%a(iut,2)=ug7_3456(i3,i4,i5,i6)%a(iut
     & ,2)+cw1*ug756_34(i3,i4)%b(1,2)+cw2*ug756_34(i3,i4)%a(2,2)
      ug7_3456(i3,i4,i5,i6)%b(iut,2)=ug7_3456(i3,i4,i5,i6)%b(iut
     & ,2)+cz1*ug756_34(i3,i4)%b(1,2)+cz2*ug756_34(i3,i4)%a(2,2)
      ug7_3456(i3,i4,i5,i6)%c(iut,2)=ug7_3456(i3,i4,i5,i6)%c(iut
     & ,2)+cx1*ug756_34(i3,i4)%c(1,2)+cx2*ug756_34(i3,i4)%d(2,2)
      ug7_3456(i3,i4,i5,i6)%d(iut,2)=ug7_3456(i3,i4,i5,i6)%d(iut
     & ,2)+cy1*ug756_34(i3,i4)%c(1,2)+cy2*ug756_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
      if(ilept(id7).ne.1 .and. ilept(id5).ne.1)then
        if(id7.ne.5 .or. id3.ne.5 .or. rmh.lt.0.d0)then
* no higgs insertion => use tt                                          
  
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=ug7_5634(i5,i6,i3,i4)%a,bb=ug7_5634(i5,i6,i3,i4)%b,cc=ug7_563
* 4(i5,i6,i3,i4)%c,dd=ug7_5634(i5,i6,i3,i4)%d,a1=lg7_56(i5,i6)%a,b1=lg7_
* 56(i5,i6)%b,c1=lg7_56(i5,i6)%c,d1=lg7_56(i5,i6)%d,a2=u756_34(i3,i4)%a,
* b2=u756_34(i3,i4)%b,c2=u756_34(i3,i4)%c,d2=u756_34(i3,i4)%d,prq=p756q,
* m=rmass(id7),nsum=0
      ug7_5634(i5,i6,i3,i4)%a(1,1)=lg7_56(i5,i6)%a(1,1)*u756_34(
     & i3,i4)%a(1,1)+lg7_56(i5,i6)%c(1,2)*p756q*u756_34(i3,i4)%b
     & (2,1)
      ug7_5634(i5,i6,i3,i4)%b(1,1)=rmass(id7)*(lg7_56(i5,i6)%d(1
     & ,1)*u756_34(i3,i4)%a(1,1)+lg7_56(i5,i6)%b(1,2)*u756_34(i3
     & ,i4)%b(2,1))
      ug7_5634(i5,i6,i3,i4)%c(1,1)=rmass(id7)*(lg7_56(i5,i6)%a(1
     & ,1)*u756_34(i3,i4)%d(1,1)+lg7_56(i5,i6)%c(1,2)*u756_34(i3
     & ,i4)%c(2,1))
      ug7_5634(i5,i6,i3,i4)%d(1,1)=lg7_56(i5,i6)%d(1,1)*p756q*u7
     & 56_34(i3,i4)%d(1,1)+lg7_56(i5,i6)%b(1,2)*u756_34(i3,i4)%c
     & (2,1)
      ug7_5634(i5,i6,i3,i4)%a(1,2)=rmass(id7)*(lg7_56(i5,i6)%a(1
     & ,1)*u756_34(i3,i4)%b(1,2)+lg7_56(i5,i6)%c(1,2)*u756_34(i3
     & ,i4)%a(2,2))
      ug7_5634(i5,i6,i3,i4)%b(1,2)=lg7_56(i5,i6)%d(1,1)*p756q*u7
     & 56_34(i3,i4)%b(1,2)+lg7_56(i5,i6)%b(1,2)*u756_34(i3,i4)%a
     & (2,2)
      ug7_5634(i5,i6,i3,i4)%c(1,2)=lg7_56(i5,i6)%a(1,1)*u756_34(
     & i3,i4)%c(1,2)+lg7_56(i5,i6)%c(1,2)*p756q*u756_34(i3,i4)%d
     & (2,2)
      ug7_5634(i5,i6,i3,i4)%d(1,2)=rmass(id7)*(lg7_56(i5,i6)%d(1
     & ,1)*u756_34(i3,i4)%c(1,2)+lg7_56(i5,i6)%b(1,2)*u756_34(i3
     & ,i4)%d(2,2))
      ug7_5634(i5,i6,i3,i4)%a(2,1)=rmass(id7)*(lg7_56(i5,i6)%c(2
     & ,1)*u756_34(i3,i4)%a(1,1)+lg7_56(i5,i6)%a(2,2)*u756_34(i3
     & ,i4)%b(2,1))
      ug7_5634(i5,i6,i3,i4)%b(2,1)=lg7_56(i5,i6)%b(2,1)*u756_34(
     & i3,i4)%a(1,1)+lg7_56(i5,i6)%d(2,2)*p756q*u756_34(i3,i4)%b
     & (2,1)
      ug7_5634(i5,i6,i3,i4)%c(2,1)=lg7_56(i5,i6)%c(2,1)*p756q*u7
     & 56_34(i3,i4)%d(1,1)+lg7_56(i5,i6)%a(2,2)*u756_34(i3,i4)%c
     & (2,1)
      ug7_5634(i5,i6,i3,i4)%d(2,1)=rmass(id7)*(lg7_56(i5,i6)%b(2
     & ,1)*u756_34(i3,i4)%d(1,1)+lg7_56(i5,i6)%d(2,2)*u756_34(i3
     & ,i4)%c(2,1))
      ug7_5634(i5,i6,i3,i4)%a(2,2)=lg7_56(i5,i6)%c(2,1)*p756q*u7
     & 56_34(i3,i4)%b(1,2)+lg7_56(i5,i6)%a(2,2)*u756_34(i3,i4)%a
     & (2,2)
      ug7_5634(i5,i6,i3,i4)%b(2,2)=rmass(id7)*(lg7_56(i5,i6)%b(2
     & ,1)*u756_34(i3,i4)%b(1,2)+lg7_56(i5,i6)%d(2,2)*u756_34(i3
     & ,i4)%a(2,2))
      ug7_5634(i5,i6,i3,i4)%c(2,2)=rmass(id7)*(lg7_56(i5,i6)%c(2
     & ,1)*u756_34(i3,i4)%c(1,2)+lg7_56(i5,i6)%a(2,2)*u756_34(i3
     & ,i4)%d(2,2))
      ug7_5634(i5,i6,i3,i4)%d(2,2)=lg7_56(i5,i6)%b(2,1)*u756_34(
     & i3,i4)%c(1,2)+lg7_56(i5,i6)%d(2,2)*p756q*u756_34(i3,i4)%d
     & (2,2)
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* TT -- aa=ug7_5634(i5,i6,i3,i4)%a,bb=ug7_5634(i5,i6,i3,i4)%b,cc=ug7_563
* 4(i5,i6,i3,i4)%c,dd=ug7_5634(i5,i6,i3,i4)%d,a1=l7_34(i3,i4)%a,b1=l7_34
* (i3,i4)%b,c1=l7_34(i3,i4)%c,d1=l7_34(i3,i4)%d,a2=ug734_56(i5,i6)%a,b2=
* ug734_56(i5,i6)%b,c2=ug734_56(i5,i6)%c,d2=ug734_56(i5,i6)%d,prq=p734q,
* m=rmass(id7),nsum=1
      ug7_5634(i5,i6,i3,i4)%a(1,1)=ug7_5634(i5,i6,i3,i4)%a(1,1)+
     & l7_34(i3,i4)%a(1,1)*ug734_56(i5,i6)%a(1,1)+l7_34(i3,i4)%c
     & (1,2)*p734q*ug734_56(i5,i6)%b(2,1)
      ug7_5634(i5,i6,i3,i4)%b(1,1)=ug7_5634(i5,i6,i3,i4)%b(1,1)+
     & rmass(id7)*(l7_34(i3,i4)%d(1,1)*ug734_56(i5,i6)%a(1,1)+l7
     & _34(i3,i4)%b(1,2)*ug734_56(i5,i6)%b(2,1))
      ug7_5634(i5,i6,i3,i4)%c(1,1)=ug7_5634(i5,i6,i3,i4)%c(1,1)+
     & rmass(id7)*(l7_34(i3,i4)%a(1,1)*ug734_56(i5,i6)%d(1,1)+l7
     & _34(i3,i4)%c(1,2)*ug734_56(i5,i6)%c(2,1))
      ug7_5634(i5,i6,i3,i4)%d(1,1)=ug7_5634(i5,i6,i3,i4)%d(1,1)+
     & l7_34(i3,i4)%d(1,1)*p734q*ug734_56(i5,i6)%d(1,1)+l7_34(i3
     & ,i4)%b(1,2)*ug734_56(i5,i6)%c(2,1)
      ug7_5634(i5,i6,i3,i4)%a(1,2)=ug7_5634(i5,i6,i3,i4)%a(1,2)+
     & rmass(id7)*(l7_34(i3,i4)%a(1,1)*ug734_56(i5,i6)%b(1,2)+l7
     & _34(i3,i4)%c(1,2)*ug734_56(i5,i6)%a(2,2))
      ug7_5634(i5,i6,i3,i4)%b(1,2)=ug7_5634(i5,i6,i3,i4)%b(1,2)+
     & l7_34(i3,i4)%d(1,1)*p734q*ug734_56(i5,i6)%b(1,2)+l7_34(i3
     & ,i4)%b(1,2)*ug734_56(i5,i6)%a(2,2)
      ug7_5634(i5,i6,i3,i4)%c(1,2)=ug7_5634(i5,i6,i3,i4)%c(1,2)+
     & l7_34(i3,i4)%a(1,1)*ug734_56(i5,i6)%c(1,2)+l7_34(i3,i4)%c
     & (1,2)*p734q*ug734_56(i5,i6)%d(2,2)
      ug7_5634(i5,i6,i3,i4)%d(1,2)=ug7_5634(i5,i6,i3,i4)%d(1,2)+
     & rmass(id7)*(l7_34(i3,i4)%d(1,1)*ug734_56(i5,i6)%c(1,2)+l7
     & _34(i3,i4)%b(1,2)*ug734_56(i5,i6)%d(2,2))
      ug7_5634(i5,i6,i3,i4)%a(2,1)=ug7_5634(i5,i6,i3,i4)%a(2,1)+
     & rmass(id7)*(l7_34(i3,i4)%c(2,1)*ug734_56(i5,i6)%a(1,1)+l7
     & _34(i3,i4)%a(2,2)*ug734_56(i5,i6)%b(2,1))
      ug7_5634(i5,i6,i3,i4)%b(2,1)=ug7_5634(i5,i6,i3,i4)%b(2,1)+
     & l7_34(i3,i4)%b(2,1)*ug734_56(i5,i6)%a(1,1)+l7_34(i3,i4)%d
     & (2,2)*p734q*ug734_56(i5,i6)%b(2,1)
      ug7_5634(i5,i6,i3,i4)%c(2,1)=ug7_5634(i5,i6,i3,i4)%c(2,1)+
     & l7_34(i3,i4)%c(2,1)*p734q*ug734_56(i5,i6)%d(1,1)+l7_34(i3
     & ,i4)%a(2,2)*ug734_56(i5,i6)%c(2,1)
      ug7_5634(i5,i6,i3,i4)%d(2,1)=ug7_5634(i5,i6,i3,i4)%d(2,1)+
     & rmass(id7)*(l7_34(i3,i4)%b(2,1)*ug734_56(i5,i6)%d(1,1)+l7
     & _34(i3,i4)%d(2,2)*ug734_56(i5,i6)%c(2,1))
      ug7_5634(i5,i6,i3,i4)%a(2,2)=ug7_5634(i5,i6,i3,i4)%a(2,2)+
     & l7_34(i3,i4)%c(2,1)*p734q*ug734_56(i5,i6)%b(1,2)+l7_34(i3
     & ,i4)%a(2,2)*ug734_56(i5,i6)%a(2,2)
      ug7_5634(i5,i6,i3,i4)%b(2,2)=ug7_5634(i5,i6,i3,i4)%b(2,2)+
     & rmass(id7)*(l7_34(i3,i4)%b(2,1)*ug734_56(i5,i6)%b(1,2)+l7
     & _34(i3,i4)%d(2,2)*ug734_56(i5,i6)%a(2,2))
      ug7_5634(i5,i6,i3,i4)%c(2,2)=ug7_5634(i5,i6,i3,i4)%c(2,2)+
     & rmass(id7)*(l7_34(i3,i4)%c(2,1)*ug734_56(i5,i6)%c(1,2)+l7
     & _34(i3,i4)%a(2,2)*ug734_56(i5,i6)%d(2,2))
      ug7_5634(i5,i6,i3,i4)%d(2,2)=ug7_5634(i5,i6,i3,i4)%d(2,2)+
     & l7_34(i3,i4)%b(2,1)*ug734_56(i5,i6)%c(1,2)+l7_34(i3,i4)%d
     & (2,2)*p734q*ug734_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
  
        else
* higgs insertion => use tts or tst                                     
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* TTs -- aa=ug7_5634(i5,i6,i3,i4)%a,bb=ug7_5634(i5,i6,i3,i4)%b,cc=ug7_56
* 34(i5,i6,i3,i4)%c,dd=ug7_5634(i5,i6,i3,i4)%d,a1=lg7_56(i5,i6)%a,b1=lg7
* _56(i5,i6)%b,c1=lg7_56(i5,i6)%c,d1=lg7_56(i5,i6)%d,a2=u756_34(i3,i4)%a
* ,b2=u756_34(i3,i4)%b,c2=u756_34(i3,i4)%c,d2=u756_34(i3,i4)%d,prq=p756q
* ,m=rmass(id7),nsum=0
      do jut=1,2
      cx1=u756_34(i3,i4)%a(1,jut)+rmass(id7)*u756_34(i3,i4)%b(1,
     & jut)
      cx2=u756_34(i3,i4)%a(2,jut)+rmass(id7)*u756_34(i3,i4)%b(2,
     & jut)
      cy1=p756q*u756_34(i3,i4)%b(1,jut)+rmass(id7)*u756_34(i3,i4
     & )%a(1,jut)
      cy2=p756q*u756_34(i3,i4)%b(2,jut)+rmass(id7)*u756_34(i3,i4
     & )%a(2,jut)
      cw1=u756_34(i3,i4)%c(1,jut)+rmass(id7)*u756_34(i3,i4)%d(1,
     & jut)
      cw2=u756_34(i3,i4)%c(2,jut)+rmass(id7)*u756_34(i3,i4)%d(2,
     & jut)
      cz1=p756q*u756_34(i3,i4)%d(1,jut)+rmass(id7)*u756_34(i3,i4
     & )%c(1,jut)
      cz2=p756q*u756_34(i3,i4)%d(2,jut)+rmass(id7)*u756_34(i3,i4
     & )%c(2,jut)
      ug7_5634(i5,i6,i3,i4)%a(1,jut)=lg7_56(i5,i6)%a(1,1)*cx1+lg
     & 7_56(i5,i6)%c(1,2)*cy2
      ug7_5634(i5,i6,i3,i4)%b(1,jut)=lg7_56(i5,i6)%d(1,1)*cy1+lg
     & 7_56(i5,i6)%b(1,2)*cx2
      ug7_5634(i5,i6,i3,i4)%c(1,jut)=lg7_56(i5,i6)%a(1,1)*cw1+lg
     & 7_56(i5,i6)%c(1,2)*cz2
      ug7_5634(i5,i6,i3,i4)%d(1,jut)=lg7_56(i5,i6)%d(1,1)*cz1+lg
     & 7_56(i5,i6)%b(1,2)*cw2
      ug7_5634(i5,i6,i3,i4)%a(2,jut)=lg7_56(i5,i6)%c(2,1)*cy1+lg
     & 7_56(i5,i6)%a(2,2)*cx2
      ug7_5634(i5,i6,i3,i4)%b(2,jut)=lg7_56(i5,i6)%b(2,1)*cx1+lg
     & 7_56(i5,i6)%d(2,2)*cy2
      ug7_5634(i5,i6,i3,i4)%c(2,jut)=lg7_56(i5,i6)%c(2,1)*cz1+lg
     & 7_56(i5,i6)%a(2,2)*cw2
      ug7_5634(i5,i6,i3,i4)%d(2,jut)=lg7_56(i5,i6)%b(2,1)*cw1+lg
     & 7_56(i5,i6)%d(2,2)*cz2
      end do
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=ug7_5634(i5,i6,i3,i4)%a,bb=ug7_5634(i5,i6,i3,i4)%b,cc=ug7_56
* 34(i5,i6,i3,i4)%c,dd=ug7_5634(i5,i6,i3,i4)%d,a1=l7_34(i3,i4)%a,b1=l7_3
* 4(i3,i4)%b,c1=l7_34(i3,i4)%c,d1=l7_34(i3,i4)%d,a2=ug734_56(i5,i6)%a,b2
* =ug734_56(i5,i6)%b,c2=ug734_56(i5,i6)%c,d2=ug734_56(i5,i6)%d,prq=p734q
* ,m=rmass(id7),nsum=1
      do iut=1,2
      cx1=l7_34(i3,i4)%a(iut,1)+l7_34(i3,i4)%c(iut,1)*rmass(id7)
      cx2=l7_34(i3,i4)%c(iut,2)*p734q+l7_34(i3,i4)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_34(i3,i4)%b(iut,1)+l7_34(i3,i4)%d(iut,1)*rmass(id7)
      cy2=l7_34(i3,i4)%d(iut,2)*p734q+l7_34(i3,i4)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_34(i3,i4)%c(iut,1)*p734q+l7_34(i3,i4)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_34(i3,i4)%a(iut,2)+l7_34(i3,i4)%c(iut,2)*rmass(id7)
      cz1=l7_34(i3,i4)%d(iut,1)*p734q+l7_34(i3,i4)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_34(i3,i4)%b(iut,2)+l7_34(i3,i4)%d(iut,2)*rmass(id7)
      ug7_5634(i5,i6,i3,i4)%a(iut,1)=ug7_5634(i5,i6,i3,i4)%a(iut
     & ,1)+cx1*ug734_56(i5,i6)%a(1,1)+cx2*ug734_56(i5,i6)%b(2,1)
      ug7_5634(i5,i6,i3,i4)%b(iut,1)=ug7_5634(i5,i6,i3,i4)%b(iut
     & ,1)+cy1*ug734_56(i5,i6)%a(1,1)+cy2*ug734_56(i5,i6)%b(2,1)
      ug7_5634(i5,i6,i3,i4)%c(iut,1)=ug7_5634(i5,i6,i3,i4)%c(iut
     & ,1)+cw1*ug734_56(i5,i6)%d(1,1)+cw2*ug734_56(i5,i6)%c(2,1)
      ug7_5634(i5,i6,i3,i4)%d(iut,1)=ug7_5634(i5,i6,i3,i4)%d(iut
     & ,1)+cz1*ug734_56(i5,i6)%d(1,1)+cz2*ug734_56(i5,i6)%c(2,1)
      ug7_5634(i5,i6,i3,i4)%a(iut,2)=ug7_5634(i5,i6,i3,i4)%a(iut
     & ,2)+cw1*ug734_56(i5,i6)%b(1,2)+cw2*ug734_56(i5,i6)%a(2,2)
      ug7_5634(i5,i6,i3,i4)%b(iut,2)=ug7_5634(i5,i6,i3,i4)%b(iut
     & ,2)+cz1*ug734_56(i5,i6)%b(1,2)+cz2*ug734_56(i5,i6)%a(2,2)
      ug7_5634(i5,i6,i3,i4)%c(iut,2)=ug7_5634(i5,i6,i3,i4)%c(iut
     & ,2)+cx1*ug734_56(i5,i6)%c(1,2)+cx2*ug734_56(i5,i6)%d(2,2)
      ug7_5634(i5,i6,i3,i4)%d(iut,2)=ug7_5634(i5,i6,i3,i4)%d(iut
     & ,2)+cy1*ug734_56(i5,i6)%c(1,2)+cy2*ug734_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
  
        endif
      endif
  
  
  
  
*  COMPUTE  DIAGRAMS  WITH 3 FORKS ATTACHED TO A ZLINE                  
*               __                                                      
*                 |_Z,f,h_/                                             
*                 |       \                                             
*                 |                                                     
*                 |_Z,f,h_/                                             
*                 |       \                                             
*                 |                                                     
*                 |_Z,f,h_/                                             
*               __|       \                                             
*                                                                       
  
*Initialization of the variables to sum                                 
  
      do i1=1,2
       do i2=1,2
        do i3=1,2
         do i4=1,2
          do i5=1,2
           do i6=1,2
            do i7=1,2
             do i8=1,2
  
  
      cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=czero
  
             enddo
            enddo
           enddo
          enddo
         enddo
        enddo
       enddo
      enddo
  
  
      if(id1.ne.5 .OR. (id1.eq.5.and.id7.ne.5) .OR. rmh.lt.0.d0)then
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=cline_3forks_12(i3,i4,i5,i6,i7,i8)%a,bb=cline_3forks_12(i3,i
* 4,i5,i6,i7,i8)%b,cc=cline_3forks_12(i3,i4,i5,i6,i7,i8)%c,dd=cline_3for
* ks_12(i3,i4,i5,i6,i7,i8)%d,a1=u1_3456(i3,i4,i5,i6)%a,b1=u1_3456(i3,i4,
* i5,i6)%b,c1=u1_3456(i3,i4,i5,i6)%c,d1=u1_3456(i3,i4,i5,i6)%d,a2=r2_78(
* i7,i8)%a,b2=r2_78(i7,i8)%b,c2=r2_78(i7,i8)%c,d2=r2_78(i7,i8)%d,prq=p27
* 8q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=u1_3456(i3,i4,i5,i6)%a(iut,1)+u1_3456(i3,i4,i5,i6)%c(i
     & ut,1)*rmass(id1)
      cx2=u1_3456(i3,i4,i5,i6)%c(iut,2)*p278q+u1_3456(i3,i4,i5,i
     & 6)%a(iut,2)*rmass(id1)
      cy1=u1_3456(i3,i4,i5,i6)%b(iut,1)+u1_3456(i3,i4,i5,i6)%d(i
     & ut,1)*rmass(id1)
      cy2=u1_3456(i3,i4,i5,i6)%d(iut,2)*p278q+u1_3456(i3,i4,i5,i
     & 6)%b(iut,2)*rmass(id1)
      cw1=u1_3456(i3,i4,i5,i6)%c(iut,1)*p278q+u1_3456(i3,i4,i5,i
     & 6)%a(iut,1)*rmass(id1)
      cw2=u1_3456(i3,i4,i5,i6)%a(iut,2)+u1_3456(i3,i4,i5,i6)%c(i
     & ut,2)*rmass(id1)
      cz1=u1_3456(i3,i4,i5,i6)%d(iut,1)*p278q+u1_3456(i3,i4,i5,i
     & 6)%b(iut,1)*rmass(id1)
      cz2=u1_3456(i3,i4,i5,i6)%b(iut,2)+u1_3456(i3,i4,i5,i6)%d(i
     & ut,2)*rmass(id1)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%a(iut,1)=cx1*r2_78(i7,i
     & 8)%a(1,1)+cx2*r2_78(i7,i8)%b(2,1)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%b(iut,1)=cy1*r2_78(i7,i
     & 8)%a(1,1)+cy2*r2_78(i7,i8)%b(2,1)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%c(iut,1)=cw1*r2_78(i7,i
     & 8)%d(1,1)+cw2*r2_78(i7,i8)%c(2,1)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%d(iut,1)=cz1*r2_78(i7,i
     & 8)%d(1,1)+cz2*r2_78(i7,i8)%c(2,1)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%a(iut,2)=cw1*r2_78(i7,i
     & 8)%b(1,2)+cw2*r2_78(i7,i8)%a(2,2)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%b(iut,2)=cz1*r2_78(i7,i
     & 8)%b(1,2)+cz2*r2_78(i7,i8)%a(2,2)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%c(iut,2)=cx1*r2_78(i7,i
     & 8)%c(1,2)+cx2*r2_78(i7,i8)%d(2,2)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%d(iut,2)=cy1*r2_78(i7,i
     & 8)%c(1,2)+cy2*r2_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      else
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=cline_3forks_12(i3,i4,i5,i6,i7,i8)%a,bb=cline_3forks_12(i3,
* i4,i5,i6,i7,i8)%b,cc=cline_3forks_12(i3,i4,i5,i6,i7,i8)%c,dd=cline_3fo
* rks_12(i3,i4,i5,i6,i7,i8)%d,a1=u1_3456(i3,i4,i5,i6)%a,b1=u1_3456(i3,i4
* ,i5,i6)%b,c1=u1_3456(i3,i4,i5,i6)%c,d1=u1_3456(i3,i4,i5,i6)%d,a2=r2_78
* (i7,i8)%a,b2=r2_78(i7,i8)%b,c2=r2_78(i7,i8)%c,d2=r2_78(i7,i8)%d,prq=p2
* 78q,m=rmass(id1),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r2_78(i7,i8)%a(1,jut)+rmass(id1)*r2_78(i7,i8)%b(1,jut)
      cx2=r2_78(i7,i8)%a(2,jut)+rmass(id1)*r2_78(i7,i8)%b(2,jut)
      cy1=p278q*r2_78(i7,i8)%b(1,jut)+rmass(id1)*r2_78(i7,i8)%a(
     & 1,jut)
      cy2=p278q*r2_78(i7,i8)%b(2,jut)+rmass(id1)*r2_78(i7,i8)%a(
     & 2,jut)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%a(iut,jut)=u1_3456(i3,i
     & 4,i5,i6)%a(iut,1)*cx1+u1_3456(i3,i4,i5,i6)%c(iut,1)*cy1+u
     & 1_3456(i3,i4,i5,i6)%a(iut,2)*cx2+u1_3456(i3,i4,i5,i6)%c(i
     & ut,2)*cy2
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%b(iut,jut)=u1_3456(i3,i
     & 4,i5,i6)%b(iut,1)*cx1+u1_3456(i3,i4,i5,i6)%d(iut,1)*cy1+u
     & 1_3456(i3,i4,i5,i6)%b(iut,2)*cx2+u1_3456(i3,i4,i5,i6)%d(i
     & ut,2)*cy2
      cw1=r2_78(i7,i8)%c(1,jut)+rmass(id1)*r2_78(i7,i8)%d(1,jut)
      cw2=r2_78(i7,i8)%c(2,jut)+rmass(id1)*r2_78(i7,i8)%d(2,jut)
      cz1=p278q*r2_78(i7,i8)%d(1,jut)+rmass(id1)*r2_78(i7,i8)%c(
     & 1,jut)
      cz2=p278q*r2_78(i7,i8)%d(2,jut)+rmass(id1)*r2_78(i7,i8)%c(
     & 2,jut)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%c(iut,jut)=u1_3456(i3,i
     & 4,i5,i6)%a(iut,1)*cw1+u1_3456(i3,i4,i5,i6)%c(iut,1)*cz1+u
     & 1_3456(i3,i4,i5,i6)%a(iut,2)*cw2+u1_3456(i3,i4,i5,i6)%c(i
     & ut,2)*cz2
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%d(iut,jut)=u1_3456(i3,i
     & 4,i5,i6)%b(iut,1)*cw1+u1_3456(i3,i4,i5,i6)%d(iut,1)*cz1+u
     & 1_3456(i3,i4,i5,i6)%b(iut,2)*cw2+u1_3456(i3,i4,i5,i6)%d(i
     & ut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      endif
  
  
      rmassl=rmass(id1)
      rmassr=-rmassl
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* mline -- res=cres_3forks_12(i3,i4,i5,i6,i7,i8)%pol(&1,&2),abcd=cline_3
* forks_12(i3,i4,i5,i6,i7,i8)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_12(i3,i4,i5,i6,i7,i8)%pol(iut,jut)=cline_3fork
     & s_12(i3,i4,i5,i6,i7,i8)%a(iut,jut)+rmassl*cline_3forks_12
     & (i3,i4,i5,i6,i7,i8)%b(iut,jut)+rmassr*cline_3forks_12(i3,
     & i4,i5,i6,i7,i8)%c(iut,jut)+rmassl*rmassr*cline_3forks_12(
     & i3,i4,i5,i6,i7,i8)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
       do i2=1,2
        do i3=1,2
         do i4=1,2
          do i5=1,2
           do i6=1,2
            do i7=1,2
             do i8=1,2
  
            cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &      cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &      cres_3forks_12(i3,i4,i5,i6,i7,i8)%pol(i1,i2)
  
             enddo
            enddo
           enddo
          enddo
         enddo
        enddo
       enddo
      enddo
  
  
  
  
      if(id1.ne.5 .OR. (id1.eq.5.and.id5.ne.5) .OR. rmh.lt.0.d0)then
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=cline_3forks_12(i3,i4,i7,i8,i5,i6)%a,bb=cline_3forks_12(i3,i
* 4,i7,i8,i5,i6)%b,cc=cline_3forks_12(i3,i4,i7,i8,i5,i6)%c,dd=cline_3for
* ks_12(i3,i4,i7,i8,i5,i6)%d,a1=u1_3478(i3,i4,i7,i8)%a,b1=u1_3478(i3,i4,
* i7,i8)%b,c1=u1_3478(i3,i4,i7,i8)%c,d1=u1_3478(i3,i4,i7,i8)%d,a2=r2_56(
* i5,i6)%a,b2=r2_56(i5,i6)%b,c2=r2_56(i5,i6)%c,d2=r2_56(i5,i6)%d,prq=p25
* 6q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=u1_3478(i3,i4,i7,i8)%a(iut,1)+u1_3478(i3,i4,i7,i8)%c(i
     & ut,1)*rmass(id1)
      cx2=u1_3478(i3,i4,i7,i8)%c(iut,2)*p256q+u1_3478(i3,i4,i7,i
     & 8)%a(iut,2)*rmass(id1)
      cy1=u1_3478(i3,i4,i7,i8)%b(iut,1)+u1_3478(i3,i4,i7,i8)%d(i
     & ut,1)*rmass(id1)
      cy2=u1_3478(i3,i4,i7,i8)%d(iut,2)*p256q+u1_3478(i3,i4,i7,i
     & 8)%b(iut,2)*rmass(id1)
      cw1=u1_3478(i3,i4,i7,i8)%c(iut,1)*p256q+u1_3478(i3,i4,i7,i
     & 8)%a(iut,1)*rmass(id1)
      cw2=u1_3478(i3,i4,i7,i8)%a(iut,2)+u1_3478(i3,i4,i7,i8)%c(i
     & ut,2)*rmass(id1)
      cz1=u1_3478(i3,i4,i7,i8)%d(iut,1)*p256q+u1_3478(i3,i4,i7,i
     & 8)%b(iut,1)*rmass(id1)
      cz2=u1_3478(i3,i4,i7,i8)%b(iut,2)+u1_3478(i3,i4,i7,i8)%d(i
     & ut,2)*rmass(id1)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%a(iut,1)=cx1*r2_56(i5,i
     & 6)%a(1,1)+cx2*r2_56(i5,i6)%b(2,1)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%b(iut,1)=cy1*r2_56(i5,i
     & 6)%a(1,1)+cy2*r2_56(i5,i6)%b(2,1)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%c(iut,1)=cw1*r2_56(i5,i
     & 6)%d(1,1)+cw2*r2_56(i5,i6)%c(2,1)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%d(iut,1)=cz1*r2_56(i5,i
     & 6)%d(1,1)+cz2*r2_56(i5,i6)%c(2,1)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%a(iut,2)=cw1*r2_56(i5,i
     & 6)%b(1,2)+cw2*r2_56(i5,i6)%a(2,2)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%b(iut,2)=cz1*r2_56(i5,i
     & 6)%b(1,2)+cz2*r2_56(i5,i6)%a(2,2)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%c(iut,2)=cx1*r2_56(i5,i
     & 6)%c(1,2)+cx2*r2_56(i5,i6)%d(2,2)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%d(iut,2)=cy1*r2_56(i5,i
     & 6)%c(1,2)+cy2*r2_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      else
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=cline_3forks_12(i3,i4,i7,i8,i5,i6)%a,bb=cline_3forks_12(i3,
* i4,i7,i8,i5,i6)%b,cc=cline_3forks_12(i3,i4,i7,i8,i5,i6)%c,dd=cline_3fo
* rks_12(i3,i4,i7,i8,i5,i6)%d,a1=u1_3478(i3,i4,i7,i8)%a,b1=u1_3478(i3,i4
* ,i7,i8)%b,c1=u1_3478(i3,i4,i7,i8)%c,d1=u1_3478(i3,i4,i7,i8)%d,a2=r2_56
* (i5,i6)%a,b2=r2_56(i5,i6)%b,c2=r2_56(i5,i6)%c,d2=r2_56(i5,i6)%d,prq=p2
* 56q,m=rmass(id1),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r2_56(i5,i6)%a(1,jut)+rmass(id1)*r2_56(i5,i6)%b(1,jut)
      cx2=r2_56(i5,i6)%a(2,jut)+rmass(id1)*r2_56(i5,i6)%b(2,jut)
      cy1=p256q*r2_56(i5,i6)%b(1,jut)+rmass(id1)*r2_56(i5,i6)%a(
     & 1,jut)
      cy2=p256q*r2_56(i5,i6)%b(2,jut)+rmass(id1)*r2_56(i5,i6)%a(
     & 2,jut)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%a(iut,jut)=u1_3478(i3,i
     & 4,i7,i8)%a(iut,1)*cx1+u1_3478(i3,i4,i7,i8)%c(iut,1)*cy1+u
     & 1_3478(i3,i4,i7,i8)%a(iut,2)*cx2+u1_3478(i3,i4,i7,i8)%c(i
     & ut,2)*cy2
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%b(iut,jut)=u1_3478(i3,i
     & 4,i7,i8)%b(iut,1)*cx1+u1_3478(i3,i4,i7,i8)%d(iut,1)*cy1+u
     & 1_3478(i3,i4,i7,i8)%b(iut,2)*cx2+u1_3478(i3,i4,i7,i8)%d(i
     & ut,2)*cy2
      cw1=r2_56(i5,i6)%c(1,jut)+rmass(id1)*r2_56(i5,i6)%d(1,jut)
      cw2=r2_56(i5,i6)%c(2,jut)+rmass(id1)*r2_56(i5,i6)%d(2,jut)
      cz1=p256q*r2_56(i5,i6)%d(1,jut)+rmass(id1)*r2_56(i5,i6)%c(
     & 1,jut)
      cz2=p256q*r2_56(i5,i6)%d(2,jut)+rmass(id1)*r2_56(i5,i6)%c(
     & 2,jut)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%c(iut,jut)=u1_3478(i3,i
     & 4,i7,i8)%a(iut,1)*cw1+u1_3478(i3,i4,i7,i8)%c(iut,1)*cz1+u
     & 1_3478(i3,i4,i7,i8)%a(iut,2)*cw2+u1_3478(i3,i4,i7,i8)%c(i
     & ut,2)*cz2
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%d(iut,jut)=u1_3478(i3,i
     & 4,i7,i8)%b(iut,1)*cw1+u1_3478(i3,i4,i7,i8)%d(iut,1)*cz1+u
     & 1_3478(i3,i4,i7,i8)%b(iut,2)*cw2+u1_3478(i3,i4,i7,i8)%d(i
     & ut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      endif
  
  
      rmassl=rmass(id1)
      rmassr=-rmassl
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* mline -- res=cres_3forks_12(i3,i4,i7,i8,i5,i6)%pol(&1,&2),abcd=cline_3
* forks_12(i3,i4,i7,i8,i5,i6)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_12(i3,i4,i7,i8,i5,i6)%pol(iut,jut)=cline_3fork
     & s_12(i3,i4,i7,i8,i5,i6)%a(iut,jut)+rmassl*cline_3forks_12
     & (i3,i4,i7,i8,i5,i6)%b(iut,jut)+rmassr*cline_3forks_12(i3,
     & i4,i7,i8,i5,i6)%c(iut,jut)+rmassl*rmassr*cline_3forks_12(
     & i3,i4,i7,i8,i5,i6)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
       do i2=1,2
        do i3=1,2
         do i4=1,2
          do i5=1,2
           do i6=1,2
            do i7=1,2
             do i8=1,2
  
            cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &      cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &      cres_3forks_12(i3,i4,i7,i8,i5,i6)%pol(i1,i2)
  
             enddo
            enddo
           enddo
          enddo
         enddo
        enddo
       enddo
      enddo
  
  
  
  
      if(id1.ne.5 .OR. (id1.eq.5.and.id3.ne.5) .OR. rmh.lt.0.d0)then
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=cline_3forks_12(i5,i6,i7,i8,i3,i4)%a,bb=cline_3forks_12(i5,i
* 6,i7,i8,i3,i4)%b,cc=cline_3forks_12(i5,i6,i7,i8,i3,i4)%c,dd=cline_3for
* ks_12(i5,i6,i7,i8,i3,i4)%d,a1=u1_5678(i5,i6,i7,i8)%a,b1=u1_5678(i5,i6,
* i7,i8)%b,c1=u1_5678(i5,i6,i7,i8)%c,d1=u1_5678(i5,i6,i7,i8)%d,a2=r2_34(
* i3,i4)%a,b2=r2_34(i3,i4)%b,c2=r2_34(i3,i4)%c,d2=r2_34(i3,i4)%d,prq=p23
* 4q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=u1_5678(i5,i6,i7,i8)%a(iut,1)+u1_5678(i5,i6,i7,i8)%c(i
     & ut,1)*rmass(id1)
      cx2=u1_5678(i5,i6,i7,i8)%c(iut,2)*p234q+u1_5678(i5,i6,i7,i
     & 8)%a(iut,2)*rmass(id1)
      cy1=u1_5678(i5,i6,i7,i8)%b(iut,1)+u1_5678(i5,i6,i7,i8)%d(i
     & ut,1)*rmass(id1)
      cy2=u1_5678(i5,i6,i7,i8)%d(iut,2)*p234q+u1_5678(i5,i6,i7,i
     & 8)%b(iut,2)*rmass(id1)
      cw1=u1_5678(i5,i6,i7,i8)%c(iut,1)*p234q+u1_5678(i5,i6,i7,i
     & 8)%a(iut,1)*rmass(id1)
      cw2=u1_5678(i5,i6,i7,i8)%a(iut,2)+u1_5678(i5,i6,i7,i8)%c(i
     & ut,2)*rmass(id1)
      cz1=u1_5678(i5,i6,i7,i8)%d(iut,1)*p234q+u1_5678(i5,i6,i7,i
     & 8)%b(iut,1)*rmass(id1)
      cz2=u1_5678(i5,i6,i7,i8)%b(iut,2)+u1_5678(i5,i6,i7,i8)%d(i
     & ut,2)*rmass(id1)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%a(iut,1)=cx1*r2_34(i3,i
     & 4)%a(1,1)+cx2*r2_34(i3,i4)%b(2,1)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%b(iut,1)=cy1*r2_34(i3,i
     & 4)%a(1,1)+cy2*r2_34(i3,i4)%b(2,1)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%c(iut,1)=cw1*r2_34(i3,i
     & 4)%d(1,1)+cw2*r2_34(i3,i4)%c(2,1)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%d(iut,1)=cz1*r2_34(i3,i
     & 4)%d(1,1)+cz2*r2_34(i3,i4)%c(2,1)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%a(iut,2)=cw1*r2_34(i3,i
     & 4)%b(1,2)+cw2*r2_34(i3,i4)%a(2,2)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%b(iut,2)=cz1*r2_34(i3,i
     & 4)%b(1,2)+cz2*r2_34(i3,i4)%a(2,2)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%c(iut,2)=cx1*r2_34(i3,i
     & 4)%c(1,2)+cx2*r2_34(i3,i4)%d(2,2)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%d(iut,2)=cy1*r2_34(i3,i
     & 4)%c(1,2)+cy2*r2_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      else
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TsTs -- aa=cline_3forks_12(i5,i6,i7,i8,i3,i4)%a,bb=cline_3forks_12(i5,
* i6,i7,i8,i3,i4)%b,cc=cline_3forks_12(i5,i6,i7,i8,i3,i4)%c,dd=cline_3fo
* rks_12(i5,i6,i7,i8,i3,i4)%d,a1=u1_5678(i5,i6,i7,i8)%a,b1=u1_5678(i5,i6
* ,i7,i8)%b,c1=u1_5678(i5,i6,i7,i8)%c,d1=u1_5678(i5,i6,i7,i8)%d,a2=r2_34
* (i3,i4)%a,b2=r2_34(i3,i4)%b,c2=r2_34(i3,i4)%c,d2=r2_34(i3,i4)%d,prq=p2
* 34q,m=rmass(id1),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r2_34(i3,i4)%a(1,jut)+rmass(id1)*r2_34(i3,i4)%b(1,jut)
      cx2=r2_34(i3,i4)%a(2,jut)+rmass(id1)*r2_34(i3,i4)%b(2,jut)
      cy1=p234q*r2_34(i3,i4)%b(1,jut)+rmass(id1)*r2_34(i3,i4)%a(
     & 1,jut)
      cy2=p234q*r2_34(i3,i4)%b(2,jut)+rmass(id1)*r2_34(i3,i4)%a(
     & 2,jut)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%a(iut,jut)=u1_5678(i5,i
     & 6,i7,i8)%a(iut,1)*cx1+u1_5678(i5,i6,i7,i8)%c(iut,1)*cy1+u
     & 1_5678(i5,i6,i7,i8)%a(iut,2)*cx2+u1_5678(i5,i6,i7,i8)%c(i
     & ut,2)*cy2
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%b(iut,jut)=u1_5678(i5,i
     & 6,i7,i8)%b(iut,1)*cx1+u1_5678(i5,i6,i7,i8)%d(iut,1)*cy1+u
     & 1_5678(i5,i6,i7,i8)%b(iut,2)*cx2+u1_5678(i5,i6,i7,i8)%d(i
     & ut,2)*cy2
      cw1=r2_34(i3,i4)%c(1,jut)+rmass(id1)*r2_34(i3,i4)%d(1,jut)
      cw2=r2_34(i3,i4)%c(2,jut)+rmass(id1)*r2_34(i3,i4)%d(2,jut)
      cz1=p234q*r2_34(i3,i4)%d(1,jut)+rmass(id1)*r2_34(i3,i4)%c(
     & 1,jut)
      cz2=p234q*r2_34(i3,i4)%d(2,jut)+rmass(id1)*r2_34(i3,i4)%c(
     & 2,jut)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%c(iut,jut)=u1_5678(i5,i
     & 6,i7,i8)%a(iut,1)*cw1+u1_5678(i5,i6,i7,i8)%c(iut,1)*cz1+u
     & 1_5678(i5,i6,i7,i8)%a(iut,2)*cw2+u1_5678(i5,i6,i7,i8)%c(i
     & ut,2)*cz2
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%d(iut,jut)=u1_5678(i5,i
     & 6,i7,i8)%b(iut,1)*cw1+u1_5678(i5,i6,i7,i8)%d(iut,1)*cz1+u
     & 1_5678(i5,i6,i7,i8)%b(iut,2)*cw2+u1_5678(i5,i6,i7,i8)%d(i
     & ut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      endif
  
  
      rmassl=rmass(id1)
      rmassr=-rmassl
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* mline -- res=cres_3forks_12(i5,i6,i7,i8,i3,i4)%pol(&1,&2),abcd=cline_3
* forks_12(i5,i6,i7,i8,i3,i4)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_12(i5,i6,i7,i8,i3,i4)%pol(iut,jut)=cline_3fork
     & s_12(i5,i6,i7,i8,i3,i4)%a(iut,jut)+rmassl*cline_3forks_12
     & (i5,i6,i7,i8,i3,i4)%b(iut,jut)+rmassr*cline_3forks_12(i5,
     & i6,i7,i8,i3,i4)%c(iut,jut)+rmassl*rmassr*cline_3forks_12(
     & i5,i6,i7,i8,i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
       do i2=1,2
        do i3=1,2
         do i4=1,2
          do i5=1,2
           do i6=1,2
            do i7=1,2
             do i8=1,2
  
            cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &      cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &      cres_3forks_12(i5,i6,i7,i8,i3,i4)%pol(i1,i2)
  
             enddo
            enddo
           enddo
          enddo
         enddo
        enddo
       enddo
      enddo
  
  
  
  
      if(id3.ne.5 .OR. (id3.eq.5.and.id7.ne.5) .OR. rmh.lt.0.d0)then
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=cline_3forks_34(i1,i2,i5,i6,i7,i8)%a,bb=cline_3forks_34(i1,i
* 2,i5,i6,i7,i8)%b,cc=cline_3forks_34(i1,i2,i5,i6,i7,i8)%c,dd=cline_3for
* ks_34(i1,i2,i5,i6,i7,i8)%d,a1=u3_1256(i1,i2,i5,i6)%a,b1=u3_1256(i1,i2,
* i5,i6)%b,c1=u3_1256(i1,i2,i5,i6)%c,d1=u3_1256(i1,i2,i5,i6)%d,a2=r4_78(
* i7,i8)%a,b2=r4_78(i7,i8)%b,c2=r4_78(i7,i8)%c,d2=r4_78(i7,i8)%d,prq=p47
* 8q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=u3_1256(i1,i2,i5,i6)%a(iut,1)+u3_1256(i1,i2,i5,i6)%c(i
     & ut,1)*rmass(id3)
      cx2=u3_1256(i1,i2,i5,i6)%c(iut,2)*p478q+u3_1256(i1,i2,i5,i
     & 6)%a(iut,2)*rmass(id3)
      cy1=u3_1256(i1,i2,i5,i6)%b(iut,1)+u3_1256(i1,i2,i5,i6)%d(i
     & ut,1)*rmass(id3)
      cy2=u3_1256(i1,i2,i5,i6)%d(iut,2)*p478q+u3_1256(i1,i2,i5,i
     & 6)%b(iut,2)*rmass(id3)
      cw1=u3_1256(i1,i2,i5,i6)%c(iut,1)*p478q+u3_1256(i1,i2,i5,i
     & 6)%a(iut,1)*rmass(id3)
      cw2=u3_1256(i1,i2,i5,i6)%a(iut,2)+u3_1256(i1,i2,i5,i6)%c(i
     & ut,2)*rmass(id3)
      cz1=u3_1256(i1,i2,i5,i6)%d(iut,1)*p478q+u3_1256(i1,i2,i5,i
     & 6)%b(iut,1)*rmass(id3)
      cz2=u3_1256(i1,i2,i5,i6)%b(iut,2)+u3_1256(i1,i2,i5,i6)%d(i
     & ut,2)*rmass(id3)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%a(iut,1)=cx1*r4_78(i7,i
     & 8)%a(1,1)+cx2*r4_78(i7,i8)%b(2,1)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%b(iut,1)=cy1*r4_78(i7,i
     & 8)%a(1,1)+cy2*r4_78(i7,i8)%b(2,1)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%c(iut,1)=cw1*r4_78(i7,i
     & 8)%d(1,1)+cw2*r4_78(i7,i8)%c(2,1)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%d(iut,1)=cz1*r4_78(i7,i
     & 8)%d(1,1)+cz2*r4_78(i7,i8)%c(2,1)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%a(iut,2)=cw1*r4_78(i7,i
     & 8)%b(1,2)+cw2*r4_78(i7,i8)%a(2,2)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%b(iut,2)=cz1*r4_78(i7,i
     & 8)%b(1,2)+cz2*r4_78(i7,i8)%a(2,2)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%c(iut,2)=cx1*r4_78(i7,i
     & 8)%c(1,2)+cx2*r4_78(i7,i8)%d(2,2)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%d(iut,2)=cy1*r4_78(i7,i
     & 8)%c(1,2)+cy2*r4_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      else
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=cline_3forks_34(i1,i2,i5,i6,i7,i8)%a,bb=cline_3forks_34(i1,
* i2,i5,i6,i7,i8)%b,cc=cline_3forks_34(i1,i2,i5,i6,i7,i8)%c,dd=cline_3fo
* rks_34(i1,i2,i5,i6,i7,i8)%d,a1=u3_1256(i1,i2,i5,i6)%a,b1=u3_1256(i1,i2
* ,i5,i6)%b,c1=u3_1256(i1,i2,i5,i6)%c,d1=u3_1256(i1,i2,i5,i6)%d,a2=r4_78
* (i7,i8)%a,b2=r4_78(i7,i8)%b,c2=r4_78(i7,i8)%c,d2=r4_78(i7,i8)%d,prq=p4
* 78q,m=rmass(id3),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r4_78(i7,i8)%a(1,jut)+rmass(id3)*r4_78(i7,i8)%b(1,jut)
      cx2=r4_78(i7,i8)%a(2,jut)+rmass(id3)*r4_78(i7,i8)%b(2,jut)
      cy1=p478q*r4_78(i7,i8)%b(1,jut)+rmass(id3)*r4_78(i7,i8)%a(
     & 1,jut)
      cy2=p478q*r4_78(i7,i8)%b(2,jut)+rmass(id3)*r4_78(i7,i8)%a(
     & 2,jut)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%a(iut,jut)=u3_1256(i1,i
     & 2,i5,i6)%a(iut,1)*cx1+u3_1256(i1,i2,i5,i6)%c(iut,1)*cy1+u
     & 3_1256(i1,i2,i5,i6)%a(iut,2)*cx2+u3_1256(i1,i2,i5,i6)%c(i
     & ut,2)*cy2
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%b(iut,jut)=u3_1256(i1,i
     & 2,i5,i6)%b(iut,1)*cx1+u3_1256(i1,i2,i5,i6)%d(iut,1)*cy1+u
     & 3_1256(i1,i2,i5,i6)%b(iut,2)*cx2+u3_1256(i1,i2,i5,i6)%d(i
     & ut,2)*cy2
      cw1=r4_78(i7,i8)%c(1,jut)+rmass(id3)*r4_78(i7,i8)%d(1,jut)
      cw2=r4_78(i7,i8)%c(2,jut)+rmass(id3)*r4_78(i7,i8)%d(2,jut)
      cz1=p478q*r4_78(i7,i8)%d(1,jut)+rmass(id3)*r4_78(i7,i8)%c(
     & 1,jut)
      cz2=p478q*r4_78(i7,i8)%d(2,jut)+rmass(id3)*r4_78(i7,i8)%c(
     & 2,jut)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%c(iut,jut)=u3_1256(i1,i
     & 2,i5,i6)%a(iut,1)*cw1+u3_1256(i1,i2,i5,i6)%c(iut,1)*cz1+u
     & 3_1256(i1,i2,i5,i6)%a(iut,2)*cw2+u3_1256(i1,i2,i5,i6)%c(i
     & ut,2)*cz2
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%d(iut,jut)=u3_1256(i1,i
     & 2,i5,i6)%b(iut,1)*cw1+u3_1256(i1,i2,i5,i6)%d(iut,1)*cz1+u
     & 3_1256(i1,i2,i5,i6)%b(iut,2)*cw2+u3_1256(i1,i2,i5,i6)%d(i
     & ut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      endif
  
  
      rmassl=rmass(id3)
      rmassr=-rmassl
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* mline -- res=cres_3forks_34(i1,i2,i5,i6,i7,i8)%pol(&1,&2),abcd=cline_3
* forks_34(i1,i2,i5,i6,i7,i8)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_34(i1,i2,i5,i6,i7,i8)%pol(iut,jut)=cline_3fork
     & s_34(i1,i2,i5,i6,i7,i8)%a(iut,jut)+rmassl*cline_3forks_34
     & (i1,i2,i5,i6,i7,i8)%b(iut,jut)+rmassr*cline_3forks_34(i1,
     & i2,i5,i6,i7,i8)%c(iut,jut)+rmassl*rmassr*cline_3forks_34(
     & i1,i2,i5,i6,i7,i8)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
       do i2=1,2
        do i3=1,2
         do i4=1,2
          do i5=1,2
           do i6=1,2
            do i7=1,2
             do i8=1,2
  
            cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &      cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &      cres_3forks_34(i1,i2,i5,i6,i7,i8)%pol(i3,i4)
  
             enddo
            enddo
           enddo
          enddo
         enddo
        enddo
       enddo
      enddo
  
  
  
  
      if(id3.ne.5 .OR. (id3.eq.5.and.id1.ne.5) .OR. rmh.lt.0.d0)then
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=cline_3forks_34(i5,i6,i7,i8,i1,i2)%a,bb=cline_3forks_34(i5,i
* 6,i7,i8,i1,i2)%b,cc=cline_3forks_34(i5,i6,i7,i8,i1,i2)%c,dd=cline_3for
* ks_34(i5,i6,i7,i8,i1,i2)%d,a1=u3_5678(i5,i6,i7,i8)%a,b1=u3_5678(i5,i6,
* i7,i8)%b,c1=u3_5678(i5,i6,i7,i8)%c,d1=u3_5678(i5,i6,i7,i8)%d,a2=r4_12(
* i1,i2)%a,b2=r4_12(i1,i2)%b,c2=r4_12(i1,i2)%c,d2=r4_12(i1,i2)%d,prq=p41
* 2q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=u3_5678(i5,i6,i7,i8)%a(iut,1)+u3_5678(i5,i6,i7,i8)%c(i
     & ut,1)*rmass(id3)
      cx2=u3_5678(i5,i6,i7,i8)%c(iut,2)*p412q+u3_5678(i5,i6,i7,i
     & 8)%a(iut,2)*rmass(id3)
      cy1=u3_5678(i5,i6,i7,i8)%b(iut,1)+u3_5678(i5,i6,i7,i8)%d(i
     & ut,1)*rmass(id3)
      cy2=u3_5678(i5,i6,i7,i8)%d(iut,2)*p412q+u3_5678(i5,i6,i7,i
     & 8)%b(iut,2)*rmass(id3)
      cw1=u3_5678(i5,i6,i7,i8)%c(iut,1)*p412q+u3_5678(i5,i6,i7,i
     & 8)%a(iut,1)*rmass(id3)
      cw2=u3_5678(i5,i6,i7,i8)%a(iut,2)+u3_5678(i5,i6,i7,i8)%c(i
     & ut,2)*rmass(id3)
      cz1=u3_5678(i5,i6,i7,i8)%d(iut,1)*p412q+u3_5678(i5,i6,i7,i
     & 8)%b(iut,1)*rmass(id3)
      cz2=u3_5678(i5,i6,i7,i8)%b(iut,2)+u3_5678(i5,i6,i7,i8)%d(i
     & ut,2)*rmass(id3)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%a(iut,1)=cx1*r4_12(i1,i
     & 2)%a(1,1)+cx2*r4_12(i1,i2)%b(2,1)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%b(iut,1)=cy1*r4_12(i1,i
     & 2)%a(1,1)+cy2*r4_12(i1,i2)%b(2,1)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%c(iut,1)=cw1*r4_12(i1,i
     & 2)%d(1,1)+cw2*r4_12(i1,i2)%c(2,1)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%d(iut,1)=cz1*r4_12(i1,i
     & 2)%d(1,1)+cz2*r4_12(i1,i2)%c(2,1)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%a(iut,2)=cw1*r4_12(i1,i
     & 2)%b(1,2)+cw2*r4_12(i1,i2)%a(2,2)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%b(iut,2)=cz1*r4_12(i1,i
     & 2)%b(1,2)+cz2*r4_12(i1,i2)%a(2,2)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%c(iut,2)=cx1*r4_12(i1,i
     & 2)%c(1,2)+cx2*r4_12(i1,i2)%d(2,2)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%d(iut,2)=cy1*r4_12(i1,i
     & 2)%c(1,2)+cy2*r4_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      else
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TsTs -- aa=cline_3forks_34(i5,i6,i7,i8,i1,i2)%a,bb=cline_3forks_34(i5,
* i6,i7,i8,i1,i2)%b,cc=cline_3forks_34(i5,i6,i7,i8,i1,i2)%c,dd=cline_3fo
* rks_34(i5,i6,i7,i8,i1,i2)%d,a1=u3_5678(i5,i6,i7,i8)%a,b1=u3_5678(i5,i6
* ,i7,i8)%b,c1=u3_5678(i5,i6,i7,i8)%c,d1=u3_5678(i5,i6,i7,i8)%d,a2=r4_12
* (i1,i2)%a,b2=r4_12(i1,i2)%b,c2=r4_12(i1,i2)%c,d2=r4_12(i1,i2)%d,prq=p4
* 12q,m=rmass(id3),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r4_12(i1,i2)%a(1,jut)+rmass(id3)*r4_12(i1,i2)%b(1,jut)
      cx2=r4_12(i1,i2)%a(2,jut)+rmass(id3)*r4_12(i1,i2)%b(2,jut)
      cy1=p412q*r4_12(i1,i2)%b(1,jut)+rmass(id3)*r4_12(i1,i2)%a(
     & 1,jut)
      cy2=p412q*r4_12(i1,i2)%b(2,jut)+rmass(id3)*r4_12(i1,i2)%a(
     & 2,jut)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%a(iut,jut)=u3_5678(i5,i
     & 6,i7,i8)%a(iut,1)*cx1+u3_5678(i5,i6,i7,i8)%c(iut,1)*cy1+u
     & 3_5678(i5,i6,i7,i8)%a(iut,2)*cx2+u3_5678(i5,i6,i7,i8)%c(i
     & ut,2)*cy2
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%b(iut,jut)=u3_5678(i5,i
     & 6,i7,i8)%b(iut,1)*cx1+u3_5678(i5,i6,i7,i8)%d(iut,1)*cy1+u
     & 3_5678(i5,i6,i7,i8)%b(iut,2)*cx2+u3_5678(i5,i6,i7,i8)%d(i
     & ut,2)*cy2
      cw1=r4_12(i1,i2)%c(1,jut)+rmass(id3)*r4_12(i1,i2)%d(1,jut)
      cw2=r4_12(i1,i2)%c(2,jut)+rmass(id3)*r4_12(i1,i2)%d(2,jut)
      cz1=p412q*r4_12(i1,i2)%d(1,jut)+rmass(id3)*r4_12(i1,i2)%c(
     & 1,jut)
      cz2=p412q*r4_12(i1,i2)%d(2,jut)+rmass(id3)*r4_12(i1,i2)%c(
     & 2,jut)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%c(iut,jut)=u3_5678(i5,i
     & 6,i7,i8)%a(iut,1)*cw1+u3_5678(i5,i6,i7,i8)%c(iut,1)*cz1+u
     & 3_5678(i5,i6,i7,i8)%a(iut,2)*cw2+u3_5678(i5,i6,i7,i8)%c(i
     & ut,2)*cz2
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%d(iut,jut)=u3_5678(i5,i
     & 6,i7,i8)%b(iut,1)*cw1+u3_5678(i5,i6,i7,i8)%d(iut,1)*cz1+u
     & 3_5678(i5,i6,i7,i8)%b(iut,2)*cw2+u3_5678(i5,i6,i7,i8)%d(i
     & ut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      endif
  
  
      rmassl=rmass(id3)
      rmassr=-rmassl
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* mline -- res=cres_3forks_34(i5,i6,i7,i8,i1,i2)%pol(&1,&2),abcd=cline_3
* forks_34(i5,i6,i7,i8,i1,i2)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_34(i5,i6,i7,i8,i1,i2)%pol(iut,jut)=cline_3fork
     & s_34(i5,i6,i7,i8,i1,i2)%a(iut,jut)+rmassl*cline_3forks_34
     & (i5,i6,i7,i8,i1,i2)%b(iut,jut)+rmassr*cline_3forks_34(i5,
     & i6,i7,i8,i1,i2)%c(iut,jut)+rmassl*rmassr*cline_3forks_34(
     & i5,i6,i7,i8,i1,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
       do i2=1,2
        do i3=1,2
         do i4=1,2
          do i5=1,2
           do i6=1,2
            do i7=1,2
             do i8=1,2
  
            cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &      cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &      cres_3forks_34(i5,i6,i7,i8,i1,i2)%pol(i3,i4)
  
             enddo
            enddo
           enddo
          enddo
         enddo
        enddo
       enddo
      enddo
  
  
  
  
      if(id3.ne.5 .OR. (id3.eq.5.and.id5.ne.5) .OR. rmh.lt.0.d0)then
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=cline_3forks_34(i1,i2,i7,i8,i5,i6)%a,bb=cline_3forks_34(i1,i
* 2,i7,i8,i5,i6)%b,cc=cline_3forks_34(i1,i2,i7,i8,i5,i6)%c,dd=cline_3for
* ks_34(i1,i2,i7,i8,i5,i6)%d,a1=u3_1278(i1,i2,i7,i8)%a,b1=u3_1278(i1,i2,
* i7,i8)%b,c1=u3_1278(i1,i2,i7,i8)%c,d1=u3_1278(i1,i2,i7,i8)%d,a2=r4_56(
* i5,i6)%a,b2=r4_56(i5,i6)%b,c2=r4_56(i5,i6)%c,d2=r4_56(i5,i6)%d,prq=p45
* 6q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=u3_1278(i1,i2,i7,i8)%a(iut,1)+u3_1278(i1,i2,i7,i8)%c(i
     & ut,1)*rmass(id3)
      cx2=u3_1278(i1,i2,i7,i8)%c(iut,2)*p456q+u3_1278(i1,i2,i7,i
     & 8)%a(iut,2)*rmass(id3)
      cy1=u3_1278(i1,i2,i7,i8)%b(iut,1)+u3_1278(i1,i2,i7,i8)%d(i
     & ut,1)*rmass(id3)
      cy2=u3_1278(i1,i2,i7,i8)%d(iut,2)*p456q+u3_1278(i1,i2,i7,i
     & 8)%b(iut,2)*rmass(id3)
      cw1=u3_1278(i1,i2,i7,i8)%c(iut,1)*p456q+u3_1278(i1,i2,i7,i
     & 8)%a(iut,1)*rmass(id3)
      cw2=u3_1278(i1,i2,i7,i8)%a(iut,2)+u3_1278(i1,i2,i7,i8)%c(i
     & ut,2)*rmass(id3)
      cz1=u3_1278(i1,i2,i7,i8)%d(iut,1)*p456q+u3_1278(i1,i2,i7,i
     & 8)%b(iut,1)*rmass(id3)
      cz2=u3_1278(i1,i2,i7,i8)%b(iut,2)+u3_1278(i1,i2,i7,i8)%d(i
     & ut,2)*rmass(id3)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%a(iut,1)=cx1*r4_56(i5,i
     & 6)%a(1,1)+cx2*r4_56(i5,i6)%b(2,1)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%b(iut,1)=cy1*r4_56(i5,i
     & 6)%a(1,1)+cy2*r4_56(i5,i6)%b(2,1)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%c(iut,1)=cw1*r4_56(i5,i
     & 6)%d(1,1)+cw2*r4_56(i5,i6)%c(2,1)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%d(iut,1)=cz1*r4_56(i5,i
     & 6)%d(1,1)+cz2*r4_56(i5,i6)%c(2,1)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%a(iut,2)=cw1*r4_56(i5,i
     & 6)%b(1,2)+cw2*r4_56(i5,i6)%a(2,2)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%b(iut,2)=cz1*r4_56(i5,i
     & 6)%b(1,2)+cz2*r4_56(i5,i6)%a(2,2)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%c(iut,2)=cx1*r4_56(i5,i
     & 6)%c(1,2)+cx2*r4_56(i5,i6)%d(2,2)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%d(iut,2)=cy1*r4_56(i5,i
     & 6)%c(1,2)+cy2*r4_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      else
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=cline_3forks_34(i1,i2,i7,i8,i5,i6)%a,bb=cline_3forks_34(i1,
* i2,i7,i8,i5,i6)%b,cc=cline_3forks_34(i1,i2,i7,i8,i5,i6)%c,dd=cline_3fo
* rks_34(i1,i2,i7,i8,i5,i6)%d,a1=u3_1278(i1,i2,i7,i8)%a,b1=u3_1278(i1,i2
* ,i7,i8)%b,c1=u3_1278(i1,i2,i7,i8)%c,d1=u3_1278(i1,i2,i7,i8)%d,a2=r4_56
* (i5,i6)%a,b2=r4_56(i5,i6)%b,c2=r4_56(i5,i6)%c,d2=r4_56(i5,i6)%d,prq=p4
* 56q,m=rmass(id3),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r4_56(i5,i6)%a(1,jut)+rmass(id3)*r4_56(i5,i6)%b(1,jut)
      cx2=r4_56(i5,i6)%a(2,jut)+rmass(id3)*r4_56(i5,i6)%b(2,jut)
      cy1=p456q*r4_56(i5,i6)%b(1,jut)+rmass(id3)*r4_56(i5,i6)%a(
     & 1,jut)
      cy2=p456q*r4_56(i5,i6)%b(2,jut)+rmass(id3)*r4_56(i5,i6)%a(
     & 2,jut)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%a(iut,jut)=u3_1278(i1,i
     & 2,i7,i8)%a(iut,1)*cx1+u3_1278(i1,i2,i7,i8)%c(iut,1)*cy1+u
     & 3_1278(i1,i2,i7,i8)%a(iut,2)*cx2+u3_1278(i1,i2,i7,i8)%c(i
     & ut,2)*cy2
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%b(iut,jut)=u3_1278(i1,i
     & 2,i7,i8)%b(iut,1)*cx1+u3_1278(i1,i2,i7,i8)%d(iut,1)*cy1+u
     & 3_1278(i1,i2,i7,i8)%b(iut,2)*cx2+u3_1278(i1,i2,i7,i8)%d(i
     & ut,2)*cy2
      cw1=r4_56(i5,i6)%c(1,jut)+rmass(id3)*r4_56(i5,i6)%d(1,jut)
      cw2=r4_56(i5,i6)%c(2,jut)+rmass(id3)*r4_56(i5,i6)%d(2,jut)
      cz1=p456q*r4_56(i5,i6)%d(1,jut)+rmass(id3)*r4_56(i5,i6)%c(
     & 1,jut)
      cz2=p456q*r4_56(i5,i6)%d(2,jut)+rmass(id3)*r4_56(i5,i6)%c(
     & 2,jut)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%c(iut,jut)=u3_1278(i1,i
     & 2,i7,i8)%a(iut,1)*cw1+u3_1278(i1,i2,i7,i8)%c(iut,1)*cz1+u
     & 3_1278(i1,i2,i7,i8)%a(iut,2)*cw2+u3_1278(i1,i2,i7,i8)%c(i
     & ut,2)*cz2
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%d(iut,jut)=u3_1278(i1,i
     & 2,i7,i8)%b(iut,1)*cw1+u3_1278(i1,i2,i7,i8)%d(iut,1)*cz1+u
     & 3_1278(i1,i2,i7,i8)%b(iut,2)*cw2+u3_1278(i1,i2,i7,i8)%d(i
     & ut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      endif
  
  
      rmassl=rmass(id3)
      rmassr=-rmassl
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* mline -- res=cres_3forks_34(i1,i2,i7,i8,i5,i6)%pol(&1,&2),abcd=cline_3
* forks_34(i1,i2,i7,i8,i5,i6)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_34(i1,i2,i7,i8,i5,i6)%pol(iut,jut)=cline_3fork
     & s_34(i1,i2,i7,i8,i5,i6)%a(iut,jut)+rmassl*cline_3forks_34
     & (i1,i2,i7,i8,i5,i6)%b(iut,jut)+rmassr*cline_3forks_34(i1,
     & i2,i7,i8,i5,i6)%c(iut,jut)+rmassl*rmassr*cline_3forks_34(
     & i1,i2,i7,i8,i5,i6)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
       do i2=1,2
        do i3=1,2
         do i4=1,2
          do i5=1,2
           do i6=1,2
            do i7=1,2
             do i8=1,2
  
            cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &      cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &      cres_3forks_34(i1,i2,i7,i8,i5,i6)%pol(i3,i4)
  
             enddo
            enddo
           enddo
          enddo
         enddo
        enddo
       enddo
      enddo
  
  
  
  
      if(id5.ne.5 .OR. (id5.eq.5.and.id7.ne.5) .OR. rmh.lt.0.d0)then
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=cline_3forks_56(i1,i2,i3,i4,i7,i8)%a,bb=cline_3forks_56(i1,i
* 2,i3,i4,i7,i8)%b,cc=cline_3forks_56(i1,i2,i3,i4,i7,i8)%c,dd=cline_3for
* ks_56(i1,i2,i3,i4,i7,i8)%d,a1=u5_1234(i1,i2,i3,i4)%a,b1=u5_1234(i1,i2,
* i3,i4)%b,c1=u5_1234(i1,i2,i3,i4)%c,d1=u5_1234(i1,i2,i3,i4)%d,a2=r6_78(
* i7,i8)%a,b2=r6_78(i7,i8)%b,c2=r6_78(i7,i8)%c,d2=r6_78(i7,i8)%d,prq=p67
* 8q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=u5_1234(i1,i2,i3,i4)%a(iut,1)+u5_1234(i1,i2,i3,i4)%c(i
     & ut,1)*rmass(id5)
      cx2=u5_1234(i1,i2,i3,i4)%c(iut,2)*p678q+u5_1234(i1,i2,i3,i
     & 4)%a(iut,2)*rmass(id5)
      cy1=u5_1234(i1,i2,i3,i4)%b(iut,1)+u5_1234(i1,i2,i3,i4)%d(i
     & ut,1)*rmass(id5)
      cy2=u5_1234(i1,i2,i3,i4)%d(iut,2)*p678q+u5_1234(i1,i2,i3,i
     & 4)%b(iut,2)*rmass(id5)
      cw1=u5_1234(i1,i2,i3,i4)%c(iut,1)*p678q+u5_1234(i1,i2,i3,i
     & 4)%a(iut,1)*rmass(id5)
      cw2=u5_1234(i1,i2,i3,i4)%a(iut,2)+u5_1234(i1,i2,i3,i4)%c(i
     & ut,2)*rmass(id5)
      cz1=u5_1234(i1,i2,i3,i4)%d(iut,1)*p678q+u5_1234(i1,i2,i3,i
     & 4)%b(iut,1)*rmass(id5)
      cz2=u5_1234(i1,i2,i3,i4)%b(iut,2)+u5_1234(i1,i2,i3,i4)%d(i
     & ut,2)*rmass(id5)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%a(iut,1)=cx1*r6_78(i7,i
     & 8)%a(1,1)+cx2*r6_78(i7,i8)%b(2,1)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%b(iut,1)=cy1*r6_78(i7,i
     & 8)%a(1,1)+cy2*r6_78(i7,i8)%b(2,1)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%c(iut,1)=cw1*r6_78(i7,i
     & 8)%d(1,1)+cw2*r6_78(i7,i8)%c(2,1)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%d(iut,1)=cz1*r6_78(i7,i
     & 8)%d(1,1)+cz2*r6_78(i7,i8)%c(2,1)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%a(iut,2)=cw1*r6_78(i7,i
     & 8)%b(1,2)+cw2*r6_78(i7,i8)%a(2,2)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%b(iut,2)=cz1*r6_78(i7,i
     & 8)%b(1,2)+cz2*r6_78(i7,i8)%a(2,2)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%c(iut,2)=cx1*r6_78(i7,i
     & 8)%c(1,2)+cx2*r6_78(i7,i8)%d(2,2)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%d(iut,2)=cy1*r6_78(i7,i
     & 8)%c(1,2)+cy2*r6_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      else
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=cline_3forks_56(i1,i2,i3,i4,i7,i8)%a,bb=cline_3forks_56(i1,
* i2,i3,i4,i7,i8)%b,cc=cline_3forks_56(i1,i2,i3,i4,i7,i8)%c,dd=cline_3fo
* rks_56(i1,i2,i3,i4,i7,i8)%d,a1=u5_1234(i1,i2,i3,i4)%a,b1=u5_1234(i1,i2
* ,i3,i4)%b,c1=u5_1234(i1,i2,i3,i4)%c,d1=u5_1234(i1,i2,i3,i4)%d,a2=r6_78
* (i7,i8)%a,b2=r6_78(i7,i8)%b,c2=r6_78(i7,i8)%c,d2=r6_78(i7,i8)%d,prq=p6
* 78q,m=rmass(id5),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r6_78(i7,i8)%a(1,jut)+rmass(id5)*r6_78(i7,i8)%b(1,jut)
      cx2=r6_78(i7,i8)%a(2,jut)+rmass(id5)*r6_78(i7,i8)%b(2,jut)
      cy1=p678q*r6_78(i7,i8)%b(1,jut)+rmass(id5)*r6_78(i7,i8)%a(
     & 1,jut)
      cy2=p678q*r6_78(i7,i8)%b(2,jut)+rmass(id5)*r6_78(i7,i8)%a(
     & 2,jut)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%a(iut,jut)=u5_1234(i1,i
     & 2,i3,i4)%a(iut,1)*cx1+u5_1234(i1,i2,i3,i4)%c(iut,1)*cy1+u
     & 5_1234(i1,i2,i3,i4)%a(iut,2)*cx2+u5_1234(i1,i2,i3,i4)%c(i
     & ut,2)*cy2
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%b(iut,jut)=u5_1234(i1,i
     & 2,i3,i4)%b(iut,1)*cx1+u5_1234(i1,i2,i3,i4)%d(iut,1)*cy1+u
     & 5_1234(i1,i2,i3,i4)%b(iut,2)*cx2+u5_1234(i1,i2,i3,i4)%d(i
     & ut,2)*cy2
      cw1=r6_78(i7,i8)%c(1,jut)+rmass(id5)*r6_78(i7,i8)%d(1,jut)
      cw2=r6_78(i7,i8)%c(2,jut)+rmass(id5)*r6_78(i7,i8)%d(2,jut)
      cz1=p678q*r6_78(i7,i8)%d(1,jut)+rmass(id5)*r6_78(i7,i8)%c(
     & 1,jut)
      cz2=p678q*r6_78(i7,i8)%d(2,jut)+rmass(id5)*r6_78(i7,i8)%c(
     & 2,jut)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%c(iut,jut)=u5_1234(i1,i
     & 2,i3,i4)%a(iut,1)*cw1+u5_1234(i1,i2,i3,i4)%c(iut,1)*cz1+u
     & 5_1234(i1,i2,i3,i4)%a(iut,2)*cw2+u5_1234(i1,i2,i3,i4)%c(i
     & ut,2)*cz2
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%d(iut,jut)=u5_1234(i1,i
     & 2,i3,i4)%b(iut,1)*cw1+u5_1234(i1,i2,i3,i4)%d(iut,1)*cz1+u
     & 5_1234(i1,i2,i3,i4)%b(iut,2)*cw2+u5_1234(i1,i2,i3,i4)%d(i
     & ut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      endif
  
  
      rmassl=rmass(id5)
      rmassr=-rmassl
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* mline -- res=cres_3forks_56(i1,i2,i3,i4,i7,i8)%pol(&1,&2),abcd=cline_3
* forks_56(i1,i2,i3,i4,i7,i8)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_56(i1,i2,i3,i4,i7,i8)%pol(iut,jut)=cline_3fork
     & s_56(i1,i2,i3,i4,i7,i8)%a(iut,jut)+rmassl*cline_3forks_56
     & (i1,i2,i3,i4,i7,i8)%b(iut,jut)+rmassr*cline_3forks_56(i1,
     & i2,i3,i4,i7,i8)%c(iut,jut)+rmassl*rmassr*cline_3forks_56(
     & i1,i2,i3,i4,i7,i8)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
       do i2=1,2
        do i3=1,2
         do i4=1,2
          do i5=1,2
           do i6=1,2
            do i7=1,2
             do i8=1,2
  
            cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &      cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &      cres_3forks_56(i1,i2,i3,i4,i7,i8)%pol(i5,i6)
  
             enddo
            enddo
           enddo
          enddo
         enddo
        enddo
       enddo
      enddo
  
  
  
  
      if(id5.ne.5 .OR. (id5.eq.5.and.id3.ne.5) .OR. rmh.lt.0.d0)then
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=cline_3forks_56(i1,i2,i7,i8,i3,i4)%a,bb=cline_3forks_56(i1,i
* 2,i7,i8,i3,i4)%b,cc=cline_3forks_56(i1,i2,i7,i8,i3,i4)%c,dd=cline_3for
* ks_56(i1,i2,i7,i8,i3,i4)%d,a1=u5_1278(i1,i2,i7,i8)%a,b1=u5_1278(i1,i2,
* i7,i8)%b,c1=u5_1278(i1,i2,i7,i8)%c,d1=u5_1278(i1,i2,i7,i8)%d,a2=r6_34(
* i3,i4)%a,b2=r6_34(i3,i4)%b,c2=r6_34(i3,i4)%c,d2=r6_34(i3,i4)%d,prq=p63
* 4q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=u5_1278(i1,i2,i7,i8)%a(iut,1)+u5_1278(i1,i2,i7,i8)%c(i
     & ut,1)*rmass(id5)
      cx2=u5_1278(i1,i2,i7,i8)%c(iut,2)*p634q+u5_1278(i1,i2,i7,i
     & 8)%a(iut,2)*rmass(id5)
      cy1=u5_1278(i1,i2,i7,i8)%b(iut,1)+u5_1278(i1,i2,i7,i8)%d(i
     & ut,1)*rmass(id5)
      cy2=u5_1278(i1,i2,i7,i8)%d(iut,2)*p634q+u5_1278(i1,i2,i7,i
     & 8)%b(iut,2)*rmass(id5)
      cw1=u5_1278(i1,i2,i7,i8)%c(iut,1)*p634q+u5_1278(i1,i2,i7,i
     & 8)%a(iut,1)*rmass(id5)
      cw2=u5_1278(i1,i2,i7,i8)%a(iut,2)+u5_1278(i1,i2,i7,i8)%c(i
     & ut,2)*rmass(id5)
      cz1=u5_1278(i1,i2,i7,i8)%d(iut,1)*p634q+u5_1278(i1,i2,i7,i
     & 8)%b(iut,1)*rmass(id5)
      cz2=u5_1278(i1,i2,i7,i8)%b(iut,2)+u5_1278(i1,i2,i7,i8)%d(i
     & ut,2)*rmass(id5)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%a(iut,1)=cx1*r6_34(i3,i
     & 4)%a(1,1)+cx2*r6_34(i3,i4)%b(2,1)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%b(iut,1)=cy1*r6_34(i3,i
     & 4)%a(1,1)+cy2*r6_34(i3,i4)%b(2,1)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%c(iut,1)=cw1*r6_34(i3,i
     & 4)%d(1,1)+cw2*r6_34(i3,i4)%c(2,1)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%d(iut,1)=cz1*r6_34(i3,i
     & 4)%d(1,1)+cz2*r6_34(i3,i4)%c(2,1)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%a(iut,2)=cw1*r6_34(i3,i
     & 4)%b(1,2)+cw2*r6_34(i3,i4)%a(2,2)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%b(iut,2)=cz1*r6_34(i3,i
     & 4)%b(1,2)+cz2*r6_34(i3,i4)%a(2,2)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%c(iut,2)=cx1*r6_34(i3,i
     & 4)%c(1,2)+cx2*r6_34(i3,i4)%d(2,2)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%d(iut,2)=cy1*r6_34(i3,i
     & 4)%c(1,2)+cy2*r6_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      else
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TsTs -- aa=cline_3forks_56(i1,i2,i7,i8,i3,i4)%a,bb=cline_3forks_56(i1,
* i2,i7,i8,i3,i4)%b,cc=cline_3forks_56(i1,i2,i7,i8,i3,i4)%c,dd=cline_3fo
* rks_56(i1,i2,i7,i8,i3,i4)%d,a1=u5_1278(i1,i2,i7,i8)%a,b1=u5_1278(i1,i2
* ,i7,i8)%b,c1=u5_1278(i1,i2,i7,i8)%c,d1=u5_1278(i1,i2,i7,i8)%d,a2=r6_34
* (i3,i4)%a,b2=r6_34(i3,i4)%b,c2=r6_34(i3,i4)%c,d2=r6_34(i3,i4)%d,prq=p6
* 34q,m=rmass(id5),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r6_34(i3,i4)%a(1,jut)+rmass(id5)*r6_34(i3,i4)%b(1,jut)
      cx2=r6_34(i3,i4)%a(2,jut)+rmass(id5)*r6_34(i3,i4)%b(2,jut)
      cy1=p634q*r6_34(i3,i4)%b(1,jut)+rmass(id5)*r6_34(i3,i4)%a(
     & 1,jut)
      cy2=p634q*r6_34(i3,i4)%b(2,jut)+rmass(id5)*r6_34(i3,i4)%a(
     & 2,jut)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%a(iut,jut)=u5_1278(i1,i
     & 2,i7,i8)%a(iut,1)*cx1+u5_1278(i1,i2,i7,i8)%c(iut,1)*cy1+u
     & 5_1278(i1,i2,i7,i8)%a(iut,2)*cx2+u5_1278(i1,i2,i7,i8)%c(i
     & ut,2)*cy2
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%b(iut,jut)=u5_1278(i1,i
     & 2,i7,i8)%b(iut,1)*cx1+u5_1278(i1,i2,i7,i8)%d(iut,1)*cy1+u
     & 5_1278(i1,i2,i7,i8)%b(iut,2)*cx2+u5_1278(i1,i2,i7,i8)%d(i
     & ut,2)*cy2
      cw1=r6_34(i3,i4)%c(1,jut)+rmass(id5)*r6_34(i3,i4)%d(1,jut)
      cw2=r6_34(i3,i4)%c(2,jut)+rmass(id5)*r6_34(i3,i4)%d(2,jut)
      cz1=p634q*r6_34(i3,i4)%d(1,jut)+rmass(id5)*r6_34(i3,i4)%c(
     & 1,jut)
      cz2=p634q*r6_34(i3,i4)%d(2,jut)+rmass(id5)*r6_34(i3,i4)%c(
     & 2,jut)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%c(iut,jut)=u5_1278(i1,i
     & 2,i7,i8)%a(iut,1)*cw1+u5_1278(i1,i2,i7,i8)%c(iut,1)*cz1+u
     & 5_1278(i1,i2,i7,i8)%a(iut,2)*cw2+u5_1278(i1,i2,i7,i8)%c(i
     & ut,2)*cz2
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%d(iut,jut)=u5_1278(i1,i
     & 2,i7,i8)%b(iut,1)*cw1+u5_1278(i1,i2,i7,i8)%d(iut,1)*cz1+u
     & 5_1278(i1,i2,i7,i8)%b(iut,2)*cw2+u5_1278(i1,i2,i7,i8)%d(i
     & ut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      endif
  
  
      rmassl=rmass(id5)
      rmassr=-rmassl
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* mline -- res=cres_3forks_56(i1,i2,i7,i8,i3,i4)%pol(&1,&2),abcd=cline_3
* forks_56(i1,i2,i7,i8,i3,i4)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_56(i1,i2,i7,i8,i3,i4)%pol(iut,jut)=cline_3fork
     & s_56(i1,i2,i7,i8,i3,i4)%a(iut,jut)+rmassl*cline_3forks_56
     & (i1,i2,i7,i8,i3,i4)%b(iut,jut)+rmassr*cline_3forks_56(i1,
     & i2,i7,i8,i3,i4)%c(iut,jut)+rmassl*rmassr*cline_3forks_56(
     & i1,i2,i7,i8,i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
       do i2=1,2
        do i3=1,2
         do i4=1,2
          do i5=1,2
           do i6=1,2
            do i7=1,2
             do i8=1,2
  
            cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &      cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &      cres_3forks_56(i1,i2,i7,i8,i3,i4)%pol(i5,i6)
  
             enddo
            enddo
           enddo
          enddo
         enddo
        enddo
       enddo
      enddo
  
  
  
  
      if(id5.ne.5 .OR. (id5.eq.5.and.id1.ne.5) .OR. rmh.lt.0.d0)then
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=cline_3forks_56(i3,i4,i7,i8,i1,i2)%a,bb=cline_3forks_56(i3,i
* 4,i7,i8,i1,i2)%b,cc=cline_3forks_56(i3,i4,i7,i8,i1,i2)%c,dd=cline_3for
* ks_56(i3,i4,i7,i8,i1,i2)%d,a1=u5_3478(i3,i4,i7,i8)%a,b1=u5_3478(i3,i4,
* i7,i8)%b,c1=u5_3478(i3,i4,i7,i8)%c,d1=u5_3478(i3,i4,i7,i8)%d,a2=r6_12(
* i1,i2)%a,b2=r6_12(i1,i2)%b,c2=r6_12(i1,i2)%c,d2=r6_12(i1,i2)%d,prq=p61
* 2q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=u5_3478(i3,i4,i7,i8)%a(iut,1)+u5_3478(i3,i4,i7,i8)%c(i
     & ut,1)*rmass(id5)
      cx2=u5_3478(i3,i4,i7,i8)%c(iut,2)*p612q+u5_3478(i3,i4,i7,i
     & 8)%a(iut,2)*rmass(id5)
      cy1=u5_3478(i3,i4,i7,i8)%b(iut,1)+u5_3478(i3,i4,i7,i8)%d(i
     & ut,1)*rmass(id5)
      cy2=u5_3478(i3,i4,i7,i8)%d(iut,2)*p612q+u5_3478(i3,i4,i7,i
     & 8)%b(iut,2)*rmass(id5)
      cw1=u5_3478(i3,i4,i7,i8)%c(iut,1)*p612q+u5_3478(i3,i4,i7,i
     & 8)%a(iut,1)*rmass(id5)
      cw2=u5_3478(i3,i4,i7,i8)%a(iut,2)+u5_3478(i3,i4,i7,i8)%c(i
     & ut,2)*rmass(id5)
      cz1=u5_3478(i3,i4,i7,i8)%d(iut,1)*p612q+u5_3478(i3,i4,i7,i
     & 8)%b(iut,1)*rmass(id5)
      cz2=u5_3478(i3,i4,i7,i8)%b(iut,2)+u5_3478(i3,i4,i7,i8)%d(i
     & ut,2)*rmass(id5)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%a(iut,1)=cx1*r6_12(i1,i
     & 2)%a(1,1)+cx2*r6_12(i1,i2)%b(2,1)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%b(iut,1)=cy1*r6_12(i1,i
     & 2)%a(1,1)+cy2*r6_12(i1,i2)%b(2,1)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%c(iut,1)=cw1*r6_12(i1,i
     & 2)%d(1,1)+cw2*r6_12(i1,i2)%c(2,1)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%d(iut,1)=cz1*r6_12(i1,i
     & 2)%d(1,1)+cz2*r6_12(i1,i2)%c(2,1)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%a(iut,2)=cw1*r6_12(i1,i
     & 2)%b(1,2)+cw2*r6_12(i1,i2)%a(2,2)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%b(iut,2)=cz1*r6_12(i1,i
     & 2)%b(1,2)+cz2*r6_12(i1,i2)%a(2,2)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%c(iut,2)=cx1*r6_12(i1,i
     & 2)%c(1,2)+cx2*r6_12(i1,i2)%d(2,2)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%d(iut,2)=cy1*r6_12(i1,i
     & 2)%c(1,2)+cy2*r6_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      else
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TsTs -- aa=cline_3forks_56(i3,i4,i7,i8,i1,i2)%a,bb=cline_3forks_56(i3,
* i4,i7,i8,i1,i2)%b,cc=cline_3forks_56(i3,i4,i7,i8,i1,i2)%c,dd=cline_3fo
* rks_56(i3,i4,i7,i8,i1,i2)%d,a1=u5_3478(i3,i4,i7,i8)%a,b1=u5_3478(i3,i4
* ,i7,i8)%b,c1=u5_3478(i3,i4,i7,i8)%c,d1=u5_3478(i3,i4,i7,i8)%d,a2=r6_12
* (i1,i2)%a,b2=r6_12(i1,i2)%b,c2=r6_12(i1,i2)%c,d2=r6_12(i1,i2)%d,prq=p6
* 12q,m=rmass(id5),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r6_12(i1,i2)%a(1,jut)+rmass(id5)*r6_12(i1,i2)%b(1,jut)
      cx2=r6_12(i1,i2)%a(2,jut)+rmass(id5)*r6_12(i1,i2)%b(2,jut)
      cy1=p612q*r6_12(i1,i2)%b(1,jut)+rmass(id5)*r6_12(i1,i2)%a(
     & 1,jut)
      cy2=p612q*r6_12(i1,i2)%b(2,jut)+rmass(id5)*r6_12(i1,i2)%a(
     & 2,jut)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%a(iut,jut)=u5_3478(i3,i
     & 4,i7,i8)%a(iut,1)*cx1+u5_3478(i3,i4,i7,i8)%c(iut,1)*cy1+u
     & 5_3478(i3,i4,i7,i8)%a(iut,2)*cx2+u5_3478(i3,i4,i7,i8)%c(i
     & ut,2)*cy2
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%b(iut,jut)=u5_3478(i3,i
     & 4,i7,i8)%b(iut,1)*cx1+u5_3478(i3,i4,i7,i8)%d(iut,1)*cy1+u
     & 5_3478(i3,i4,i7,i8)%b(iut,2)*cx2+u5_3478(i3,i4,i7,i8)%d(i
     & ut,2)*cy2
      cw1=r6_12(i1,i2)%c(1,jut)+rmass(id5)*r6_12(i1,i2)%d(1,jut)
      cw2=r6_12(i1,i2)%c(2,jut)+rmass(id5)*r6_12(i1,i2)%d(2,jut)
      cz1=p612q*r6_12(i1,i2)%d(1,jut)+rmass(id5)*r6_12(i1,i2)%c(
     & 1,jut)
      cz2=p612q*r6_12(i1,i2)%d(2,jut)+rmass(id5)*r6_12(i1,i2)%c(
     & 2,jut)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%c(iut,jut)=u5_3478(i3,i
     & 4,i7,i8)%a(iut,1)*cw1+u5_3478(i3,i4,i7,i8)%c(iut,1)*cz1+u
     & 5_3478(i3,i4,i7,i8)%a(iut,2)*cw2+u5_3478(i3,i4,i7,i8)%c(i
     & ut,2)*cz2
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%d(iut,jut)=u5_3478(i3,i
     & 4,i7,i8)%b(iut,1)*cw1+u5_3478(i3,i4,i7,i8)%d(iut,1)*cz1+u
     & 5_3478(i3,i4,i7,i8)%b(iut,2)*cw2+u5_3478(i3,i4,i7,i8)%d(i
     & ut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      endif
  
  
      rmassl=rmass(id5)
      rmassr=-rmassl
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* mline -- res=cres_3forks_56(i3,i4,i7,i8,i1,i2)%pol(&1,&2),abcd=cline_3
* forks_56(i3,i4,i7,i8,i1,i2)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_56(i3,i4,i7,i8,i1,i2)%pol(iut,jut)=cline_3fork
     & s_56(i3,i4,i7,i8,i1,i2)%a(iut,jut)+rmassl*cline_3forks_56
     & (i3,i4,i7,i8,i1,i2)%b(iut,jut)+rmassr*cline_3forks_56(i3,
     & i4,i7,i8,i1,i2)%c(iut,jut)+rmassl*rmassr*cline_3forks_56(
     & i3,i4,i7,i8,i1,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
       do i2=1,2
        do i3=1,2
         do i4=1,2
          do i5=1,2
           do i6=1,2
            do i7=1,2
             do i8=1,2
  
            cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &      cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &      cres_3forks_56(i3,i4,i7,i8,i1,i2)%pol(i5,i6)
  
             enddo
            enddo
           enddo
          enddo
         enddo
        enddo
       enddo
      enddo
  
  
  
  
      if(id7.ne.5 .OR. (id7.eq.5.and.id5.ne.5) .OR. rmh.lt.0.d0)then
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=cline_3forks_78(i1,i2,i3,i4,i5,i6)%a,bb=cline_3forks_78(i1,i
* 2,i3,i4,i5,i6)%b,cc=cline_3forks_78(i1,i2,i3,i4,i5,i6)%c,dd=cline_3for
* ks_78(i1,i2,i3,i4,i5,i6)%d,a1=u7_1234(i1,i2,i3,i4)%a,b1=u7_1234(i1,i2,
* i3,i4)%b,c1=u7_1234(i1,i2,i3,i4)%c,d1=u7_1234(i1,i2,i3,i4)%d,a2=r8_56(
* i5,i6)%a,b2=r8_56(i5,i6)%b,c2=r8_56(i5,i6)%c,d2=r8_56(i5,i6)%d,prq=p85
* 6q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=u7_1234(i1,i2,i3,i4)%a(iut,1)+u7_1234(i1,i2,i3,i4)%c(i
     & ut,1)*rmass(id7)
      cx2=u7_1234(i1,i2,i3,i4)%c(iut,2)*p856q+u7_1234(i1,i2,i3,i
     & 4)%a(iut,2)*rmass(id7)
      cy1=u7_1234(i1,i2,i3,i4)%b(iut,1)+u7_1234(i1,i2,i3,i4)%d(i
     & ut,1)*rmass(id7)
      cy2=u7_1234(i1,i2,i3,i4)%d(iut,2)*p856q+u7_1234(i1,i2,i3,i
     & 4)%b(iut,2)*rmass(id7)
      cw1=u7_1234(i1,i2,i3,i4)%c(iut,1)*p856q+u7_1234(i1,i2,i3,i
     & 4)%a(iut,1)*rmass(id7)
      cw2=u7_1234(i1,i2,i3,i4)%a(iut,2)+u7_1234(i1,i2,i3,i4)%c(i
     & ut,2)*rmass(id7)
      cz1=u7_1234(i1,i2,i3,i4)%d(iut,1)*p856q+u7_1234(i1,i2,i3,i
     & 4)%b(iut,1)*rmass(id7)
      cz2=u7_1234(i1,i2,i3,i4)%b(iut,2)+u7_1234(i1,i2,i3,i4)%d(i
     & ut,2)*rmass(id7)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%a(iut,1)=cx1*r8_56(i5,i
     & 6)%a(1,1)+cx2*r8_56(i5,i6)%b(2,1)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%b(iut,1)=cy1*r8_56(i5,i
     & 6)%a(1,1)+cy2*r8_56(i5,i6)%b(2,1)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%c(iut,1)=cw1*r8_56(i5,i
     & 6)%d(1,1)+cw2*r8_56(i5,i6)%c(2,1)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%d(iut,1)=cz1*r8_56(i5,i
     & 6)%d(1,1)+cz2*r8_56(i5,i6)%c(2,1)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%a(iut,2)=cw1*r8_56(i5,i
     & 6)%b(1,2)+cw2*r8_56(i5,i6)%a(2,2)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%b(iut,2)=cz1*r8_56(i5,i
     & 6)%b(1,2)+cz2*r8_56(i5,i6)%a(2,2)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%c(iut,2)=cx1*r8_56(i5,i
     & 6)%c(1,2)+cx2*r8_56(i5,i6)%d(2,2)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%d(iut,2)=cy1*r8_56(i5,i
     & 6)%c(1,2)+cy2*r8_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      else
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=cline_3forks_78(i1,i2,i3,i4,i5,i6)%a,bb=cline_3forks_78(i1,
* i2,i3,i4,i5,i6)%b,cc=cline_3forks_78(i1,i2,i3,i4,i5,i6)%c,dd=cline_3fo
* rks_78(i1,i2,i3,i4,i5,i6)%d,a1=u7_1234(i1,i2,i3,i4)%a,b1=u7_1234(i1,i2
* ,i3,i4)%b,c1=u7_1234(i1,i2,i3,i4)%c,d1=u7_1234(i1,i2,i3,i4)%d,a2=r8_56
* (i5,i6)%a,b2=r8_56(i5,i6)%b,c2=r8_56(i5,i6)%c,d2=r8_56(i5,i6)%d,prq=p8
* 56q,m=rmass(id7),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r8_56(i5,i6)%a(1,jut)+rmass(id7)*r8_56(i5,i6)%b(1,jut)
      cx2=r8_56(i5,i6)%a(2,jut)+rmass(id7)*r8_56(i5,i6)%b(2,jut)
      cy1=p856q*r8_56(i5,i6)%b(1,jut)+rmass(id7)*r8_56(i5,i6)%a(
     & 1,jut)
      cy2=p856q*r8_56(i5,i6)%b(2,jut)+rmass(id7)*r8_56(i5,i6)%a(
     & 2,jut)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%a(iut,jut)=u7_1234(i1,i
     & 2,i3,i4)%a(iut,1)*cx1+u7_1234(i1,i2,i3,i4)%c(iut,1)*cy1+u
     & 7_1234(i1,i2,i3,i4)%a(iut,2)*cx2+u7_1234(i1,i2,i3,i4)%c(i
     & ut,2)*cy2
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%b(iut,jut)=u7_1234(i1,i
     & 2,i3,i4)%b(iut,1)*cx1+u7_1234(i1,i2,i3,i4)%d(iut,1)*cy1+u
     & 7_1234(i1,i2,i3,i4)%b(iut,2)*cx2+u7_1234(i1,i2,i3,i4)%d(i
     & ut,2)*cy2
      cw1=r8_56(i5,i6)%c(1,jut)+rmass(id7)*r8_56(i5,i6)%d(1,jut)
      cw2=r8_56(i5,i6)%c(2,jut)+rmass(id7)*r8_56(i5,i6)%d(2,jut)
      cz1=p856q*r8_56(i5,i6)%d(1,jut)+rmass(id7)*r8_56(i5,i6)%c(
     & 1,jut)
      cz2=p856q*r8_56(i5,i6)%d(2,jut)+rmass(id7)*r8_56(i5,i6)%c(
     & 2,jut)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%c(iut,jut)=u7_1234(i1,i
     & 2,i3,i4)%a(iut,1)*cw1+u7_1234(i1,i2,i3,i4)%c(iut,1)*cz1+u
     & 7_1234(i1,i2,i3,i4)%a(iut,2)*cw2+u7_1234(i1,i2,i3,i4)%c(i
     & ut,2)*cz2
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%d(iut,jut)=u7_1234(i1,i
     & 2,i3,i4)%b(iut,1)*cw1+u7_1234(i1,i2,i3,i4)%d(iut,1)*cz1+u
     & 7_1234(i1,i2,i3,i4)%b(iut,2)*cw2+u7_1234(i1,i2,i3,i4)%d(i
     & ut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      endif
  
  
      rmassl=rmass(id7)
      rmassr=-rmassl
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* mline -- res=cres_3forks_78(i1,i2,i3,i4,i5,i6)%pol(&1,&2),abcd=cline_3
* forks_78(i1,i2,i3,i4,i5,i6)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_78(i1,i2,i3,i4,i5,i6)%pol(iut,jut)=cline_3fork
     & s_78(i1,i2,i3,i4,i5,i6)%a(iut,jut)+rmassl*cline_3forks_78
     & (i1,i2,i3,i4,i5,i6)%b(iut,jut)+rmassr*cline_3forks_78(i1,
     & i2,i3,i4,i5,i6)%c(iut,jut)+rmassl*rmassr*cline_3forks_78(
     & i1,i2,i3,i4,i5,i6)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
       do i2=1,2
        do i3=1,2
         do i4=1,2
          do i5=1,2
           do i6=1,2
            do i7=1,2
             do i8=1,2
  
            cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &      cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &      cres_3forks_78(i1,i2,i3,i4,i5,i6)%pol(i7,i8)
  
             enddo
            enddo
           enddo
          enddo
         enddo
        enddo
       enddo
      enddo
  
  
  
  
      if(id7.ne.5 .OR. (id7.eq.5.and.id3.ne.5) .OR. rmh.lt.0.d0)then
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=cline_3forks_78(i1,i2,i5,i6,i3,i4)%a,bb=cline_3forks_78(i1,i
* 2,i5,i6,i3,i4)%b,cc=cline_3forks_78(i1,i2,i5,i6,i3,i4)%c,dd=cline_3for
* ks_78(i1,i2,i5,i6,i3,i4)%d,a1=u7_1256(i1,i2,i5,i6)%a,b1=u7_1256(i1,i2,
* i5,i6)%b,c1=u7_1256(i1,i2,i5,i6)%c,d1=u7_1256(i1,i2,i5,i6)%d,a2=r8_34(
* i3,i4)%a,b2=r8_34(i3,i4)%b,c2=r8_34(i3,i4)%c,d2=r8_34(i3,i4)%d,prq=p83
* 4q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=u7_1256(i1,i2,i5,i6)%a(iut,1)+u7_1256(i1,i2,i5,i6)%c(i
     & ut,1)*rmass(id7)
      cx2=u7_1256(i1,i2,i5,i6)%c(iut,2)*p834q+u7_1256(i1,i2,i5,i
     & 6)%a(iut,2)*rmass(id7)
      cy1=u7_1256(i1,i2,i5,i6)%b(iut,1)+u7_1256(i1,i2,i5,i6)%d(i
     & ut,1)*rmass(id7)
      cy2=u7_1256(i1,i2,i5,i6)%d(iut,2)*p834q+u7_1256(i1,i2,i5,i
     & 6)%b(iut,2)*rmass(id7)
      cw1=u7_1256(i1,i2,i5,i6)%c(iut,1)*p834q+u7_1256(i1,i2,i5,i
     & 6)%a(iut,1)*rmass(id7)
      cw2=u7_1256(i1,i2,i5,i6)%a(iut,2)+u7_1256(i1,i2,i5,i6)%c(i
     & ut,2)*rmass(id7)
      cz1=u7_1256(i1,i2,i5,i6)%d(iut,1)*p834q+u7_1256(i1,i2,i5,i
     & 6)%b(iut,1)*rmass(id7)
      cz2=u7_1256(i1,i2,i5,i6)%b(iut,2)+u7_1256(i1,i2,i5,i6)%d(i
     & ut,2)*rmass(id7)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%a(iut,1)=cx1*r8_34(i3,i
     & 4)%a(1,1)+cx2*r8_34(i3,i4)%b(2,1)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%b(iut,1)=cy1*r8_34(i3,i
     & 4)%a(1,1)+cy2*r8_34(i3,i4)%b(2,1)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%c(iut,1)=cw1*r8_34(i3,i
     & 4)%d(1,1)+cw2*r8_34(i3,i4)%c(2,1)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%d(iut,1)=cz1*r8_34(i3,i
     & 4)%d(1,1)+cz2*r8_34(i3,i4)%c(2,1)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%a(iut,2)=cw1*r8_34(i3,i
     & 4)%b(1,2)+cw2*r8_34(i3,i4)%a(2,2)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%b(iut,2)=cz1*r8_34(i3,i
     & 4)%b(1,2)+cz2*r8_34(i3,i4)%a(2,2)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%c(iut,2)=cx1*r8_34(i3,i
     & 4)%c(1,2)+cx2*r8_34(i3,i4)%d(2,2)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%d(iut,2)=cy1*r8_34(i3,i
     & 4)%c(1,2)+cy2*r8_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      else
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* TsTs -- aa=cline_3forks_78(i1,i2,i5,i6,i3,i4)%a,bb=cline_3forks_78(i1,
* i2,i5,i6,i3,i4)%b,cc=cline_3forks_78(i1,i2,i5,i6,i3,i4)%c,dd=cline_3fo
* rks_78(i1,i2,i5,i6,i3,i4)%d,a1=u7_1256(i1,i2,i5,i6)%a,b1=u7_1256(i1,i2
* ,i5,i6)%b,c1=u7_1256(i1,i2,i5,i6)%c,d1=u7_1256(i1,i2,i5,i6)%d,a2=r8_34
* (i3,i4)%a,b2=r8_34(i3,i4)%b,c2=r8_34(i3,i4)%c,d2=r8_34(i3,i4)%d,prq=p8
* 34q,m=rmass(id7),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r8_34(i3,i4)%a(1,jut)+rmass(id7)*r8_34(i3,i4)%b(1,jut)
      cx2=r8_34(i3,i4)%a(2,jut)+rmass(id7)*r8_34(i3,i4)%b(2,jut)
      cy1=p834q*r8_34(i3,i4)%b(1,jut)+rmass(id7)*r8_34(i3,i4)%a(
     & 1,jut)
      cy2=p834q*r8_34(i3,i4)%b(2,jut)+rmass(id7)*r8_34(i3,i4)%a(
     & 2,jut)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%a(iut,jut)=u7_1256(i1,i
     & 2,i5,i6)%a(iut,1)*cx1+u7_1256(i1,i2,i5,i6)%c(iut,1)*cy1+u
     & 7_1256(i1,i2,i5,i6)%a(iut,2)*cx2+u7_1256(i1,i2,i5,i6)%c(i
     & ut,2)*cy2
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%b(iut,jut)=u7_1256(i1,i
     & 2,i5,i6)%b(iut,1)*cx1+u7_1256(i1,i2,i5,i6)%d(iut,1)*cy1+u
     & 7_1256(i1,i2,i5,i6)%b(iut,2)*cx2+u7_1256(i1,i2,i5,i6)%d(i
     & ut,2)*cy2
      cw1=r8_34(i3,i4)%c(1,jut)+rmass(id7)*r8_34(i3,i4)%d(1,jut)
      cw2=r8_34(i3,i4)%c(2,jut)+rmass(id7)*r8_34(i3,i4)%d(2,jut)
      cz1=p834q*r8_34(i3,i4)%d(1,jut)+rmass(id7)*r8_34(i3,i4)%c(
     & 1,jut)
      cz2=p834q*r8_34(i3,i4)%d(2,jut)+rmass(id7)*r8_34(i3,i4)%c(
     & 2,jut)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%c(iut,jut)=u7_1256(i1,i
     & 2,i5,i6)%a(iut,1)*cw1+u7_1256(i1,i2,i5,i6)%c(iut,1)*cz1+u
     & 7_1256(i1,i2,i5,i6)%a(iut,2)*cw2+u7_1256(i1,i2,i5,i6)%c(i
     & ut,2)*cz2
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%d(iut,jut)=u7_1256(i1,i
     & 2,i5,i6)%b(iut,1)*cw1+u7_1256(i1,i2,i5,i6)%d(iut,1)*cz1+u
     & 7_1256(i1,i2,i5,i6)%b(iut,2)*cw2+u7_1256(i1,i2,i5,i6)%d(i
     & ut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      endif
  
  
      rmassl=rmass(id7)
      rmassr=-rmassl
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* mline -- res=cres_3forks_78(i1,i2,i5,i6,i3,i4)%pol(&1,&2),abcd=cline_3
* forks_78(i1,i2,i5,i6,i3,i4)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_78(i1,i2,i5,i6,i3,i4)%pol(iut,jut)=cline_3fork
     & s_78(i1,i2,i5,i6,i3,i4)%a(iut,jut)+rmassl*cline_3forks_78
     & (i1,i2,i5,i6,i3,i4)%b(iut,jut)+rmassr*cline_3forks_78(i1,
     & i2,i5,i6,i3,i4)%c(iut,jut)+rmassl*rmassr*cline_3forks_78(
     & i1,i2,i5,i6,i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
       do i2=1,2
        do i3=1,2
         do i4=1,2
          do i5=1,2
           do i6=1,2
            do i7=1,2
             do i8=1,2
  
            cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &      cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &      cres_3forks_78(i1,i2,i5,i6,i3,i4)%pol(i7,i8)
  
             enddo
            enddo
           enddo
          enddo
         enddo
        enddo
       enddo
      enddo
  
  
  
  
      if(id7.ne.5 .OR. (id7.eq.5.and.id1.ne.5) .OR. rmh.lt.0.d0)then
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=cline_3forks_78(i3,i4,i5,i6,i1,i2)%a,bb=cline_3forks_78(i3,i
* 4,i5,i6,i1,i2)%b,cc=cline_3forks_78(i3,i4,i5,i6,i1,i2)%c,dd=cline_3for
* ks_78(i3,i4,i5,i6,i1,i2)%d,a1=u7_3456(i3,i4,i5,i6)%a,b1=u7_3456(i3,i4,
* i5,i6)%b,c1=u7_3456(i3,i4,i5,i6)%c,d1=u7_3456(i3,i4,i5,i6)%d,a2=r8_12(
* i1,i2)%a,b2=r8_12(i1,i2)%b,c2=r8_12(i1,i2)%c,d2=r8_12(i1,i2)%d,prq=p81
* 2q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=u7_3456(i3,i4,i5,i6)%a(iut,1)+u7_3456(i3,i4,i5,i6)%c(i
     & ut,1)*rmass(id7)
      cx2=u7_3456(i3,i4,i5,i6)%c(iut,2)*p812q+u7_3456(i3,i4,i5,i
     & 6)%a(iut,2)*rmass(id7)
      cy1=u7_3456(i3,i4,i5,i6)%b(iut,1)+u7_3456(i3,i4,i5,i6)%d(i
     & ut,1)*rmass(id7)
      cy2=u7_3456(i3,i4,i5,i6)%d(iut,2)*p812q+u7_3456(i3,i4,i5,i
     & 6)%b(iut,2)*rmass(id7)
      cw1=u7_3456(i3,i4,i5,i6)%c(iut,1)*p812q+u7_3456(i3,i4,i5,i
     & 6)%a(iut,1)*rmass(id7)
      cw2=u7_3456(i3,i4,i5,i6)%a(iut,2)+u7_3456(i3,i4,i5,i6)%c(i
     & ut,2)*rmass(id7)
      cz1=u7_3456(i3,i4,i5,i6)%d(iut,1)*p812q+u7_3456(i3,i4,i5,i
     & 6)%b(iut,1)*rmass(id7)
      cz2=u7_3456(i3,i4,i5,i6)%b(iut,2)+u7_3456(i3,i4,i5,i6)%d(i
     & ut,2)*rmass(id7)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%a(iut,1)=cx1*r8_12(i1,i
     & 2)%a(1,1)+cx2*r8_12(i1,i2)%b(2,1)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%b(iut,1)=cy1*r8_12(i1,i
     & 2)%a(1,1)+cy2*r8_12(i1,i2)%b(2,1)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%c(iut,1)=cw1*r8_12(i1,i
     & 2)%d(1,1)+cw2*r8_12(i1,i2)%c(2,1)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%d(iut,1)=cz1*r8_12(i1,i
     & 2)%d(1,1)+cz2*r8_12(i1,i2)%c(2,1)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%a(iut,2)=cw1*r8_12(i1,i
     & 2)%b(1,2)+cw2*r8_12(i1,i2)%a(2,2)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%b(iut,2)=cz1*r8_12(i1,i
     & 2)%b(1,2)+cz2*r8_12(i1,i2)%a(2,2)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%c(iut,2)=cx1*r8_12(i1,i
     & 2)%c(1,2)+cx2*r8_12(i1,i2)%d(2,2)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%d(iut,2)=cy1*r8_12(i1,i
     & 2)%c(1,2)+cy2*r8_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      else
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* TsTs -- aa=cline_3forks_78(i3,i4,i5,i6,i1,i2)%a,bb=cline_3forks_78(i3,
* i4,i5,i6,i1,i2)%b,cc=cline_3forks_78(i3,i4,i5,i6,i1,i2)%c,dd=cline_3fo
* rks_78(i3,i4,i5,i6,i1,i2)%d,a1=u7_3456(i3,i4,i5,i6)%a,b1=u7_3456(i3,i4
* ,i5,i6)%b,c1=u7_3456(i3,i4,i5,i6)%c,d1=u7_3456(i3,i4,i5,i6)%d,a2=r8_12
* (i1,i2)%a,b2=r8_12(i1,i2)%b,c2=r8_12(i1,i2)%c,d2=r8_12(i1,i2)%d,prq=p8
* 12q,m=rmass(id7),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r8_12(i1,i2)%a(1,jut)+rmass(id7)*r8_12(i1,i2)%b(1,jut)
      cx2=r8_12(i1,i2)%a(2,jut)+rmass(id7)*r8_12(i1,i2)%b(2,jut)
      cy1=p812q*r8_12(i1,i2)%b(1,jut)+rmass(id7)*r8_12(i1,i2)%a(
     & 1,jut)
      cy2=p812q*r8_12(i1,i2)%b(2,jut)+rmass(id7)*r8_12(i1,i2)%a(
     & 2,jut)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%a(iut,jut)=u7_3456(i3,i
     & 4,i5,i6)%a(iut,1)*cx1+u7_3456(i3,i4,i5,i6)%c(iut,1)*cy1+u
     & 7_3456(i3,i4,i5,i6)%a(iut,2)*cx2+u7_3456(i3,i4,i5,i6)%c(i
     & ut,2)*cy2
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%b(iut,jut)=u7_3456(i3,i
     & 4,i5,i6)%b(iut,1)*cx1+u7_3456(i3,i4,i5,i6)%d(iut,1)*cy1+u
     & 7_3456(i3,i4,i5,i6)%b(iut,2)*cx2+u7_3456(i3,i4,i5,i6)%d(i
     & ut,2)*cy2
      cw1=r8_12(i1,i2)%c(1,jut)+rmass(id7)*r8_12(i1,i2)%d(1,jut)
      cw2=r8_12(i1,i2)%c(2,jut)+rmass(id7)*r8_12(i1,i2)%d(2,jut)
      cz1=p812q*r8_12(i1,i2)%d(1,jut)+rmass(id7)*r8_12(i1,i2)%c(
     & 1,jut)
      cz2=p812q*r8_12(i1,i2)%d(2,jut)+rmass(id7)*r8_12(i1,i2)%c(
     & 2,jut)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%c(iut,jut)=u7_3456(i3,i
     & 4,i5,i6)%a(iut,1)*cw1+u7_3456(i3,i4,i5,i6)%c(iut,1)*cz1+u
     & 7_3456(i3,i4,i5,i6)%a(iut,2)*cw2+u7_3456(i3,i4,i5,i6)%c(i
     & ut,2)*cz2
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%d(iut,jut)=u7_3456(i3,i
     & 4,i5,i6)%b(iut,1)*cw1+u7_3456(i3,i4,i5,i6)%d(iut,1)*cz1+u
     & 7_3456(i3,i4,i5,i6)%b(iut,2)*cw2+u7_3456(i3,i4,i5,i6)%d(i
     & ut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      endif
  
  
      rmassl=rmass(id7)
      rmassr=-rmassl
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* mline -- res=cres_3forks_78(i3,i4,i5,i6,i1,i2)%pol(&1,&2),abcd=cline_3
* forks_78(i3,i4,i5,i6,i1,i2)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_78(i3,i4,i5,i6,i1,i2)%pol(iut,jut)=cline_3fork
     & s_78(i3,i4,i5,i6,i1,i2)%a(iut,jut)+rmassl*cline_3forks_78
     & (i3,i4,i5,i6,i1,i2)%b(iut,jut)+rmassr*cline_3forks_78(i3,
     & i4,i5,i6,i1,i2)%c(iut,jut)+rmassl*rmassr*cline_3forks_78(
     & i3,i4,i5,i6,i1,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
       do i2=1,2
        do i3=1,2
         do i4=1,2
          do i5=1,2
           do i6=1,2
            do i7=1,2
             do i8=1,2
  
            cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &      cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &      cres_3forks_78(i3,i4,i5,i6,i1,i2)%pol(i7,i8)
  
             enddo
            enddo
           enddo
          enddo
         enddo
        enddo
       enddo
      enddo
  
  
  
  
  
  
  
  
* COMPUTE ALL SINGLE INSERTIONS OF THE TYPE LZI_ AND LFI_ (I=1,3,5,7)   
*    to a Zline                                                         
*                                                                       
*        i __              i __                                         
*            |_Z__(mu)         |__f__(mu)                               
*            |                 |                                        
  
  
* quqd -- p=p1,q=p234
      quqd=p1(0)*p234(0)-p1(1)*p234(1)-p1(2)*p234(2)-p1(3)*p234(
     & 3)
* T -- qu=p1,qd=p234,v=0,a=lz1_234(0)%a,b=lz1_234(0)%b,c=lz1_234(0)%c,d=
* lz1_234(0)%d,cr=zcr(id1),cl=zcl(id1),nsum=0
      eps_0=-p1(2)*p234(3)+p234(2)*p1(3)
      ceps_0=eps_0*cim
      ceps_1=p1(3)*cim
      ceps_2=p234(3)*cim
      auxa=-quqd+p1k0*p234(0)+p234k0*p1(0)
      lz1_234(0)%a(1,1)=zcr(id1)*(auxa+ceps_0)
      lz1_234(0)%a(2,2)=zcl(id1)*(auxa-ceps_0)
      lz1_234(0)%b(1,2)=-zcl(id1)*(p234(2)+ceps_2)
      lz1_234(0)%b(2,1)=zcr(id1)*(p234(2)-ceps_2)
      lz1_234(0)%c(1,2)=zcr(id1)*(p1(2)+ceps_1)
      lz1_234(0)%c(2,1)=zcl(id1)*(-p1(2)+ceps_1)
      lz1_234(0)%d(1,1)=zcl(id1)
      lz1_234(0)%d(2,2)=zcr(id1)
* T -- qu=p1,qd=p234,v=1,a=lz1_234(1)%a,b=lz1_234(1)%b,c=lz1_234(1)%c,d=
* lz1_234(1)%d,cr=zcr(id1),cl=zcl(id1),nsum=0
      auxa=-quqd+p1k0*p234(1)+p234k0*p1(1)
      lz1_234(1)%a(1,1)=zcr(id1)*(auxa+ceps_0)
      lz1_234(1)%a(2,2)=zcl(id1)*(auxa-ceps_0)
      lz1_234(1)%b(1,2)=-zcl(id1)*(p234(2)+ceps_2)
      lz1_234(1)%b(2,1)=zcr(id1)*(p234(2)-ceps_2)
      lz1_234(1)%c(1,2)=zcr(id1)*(p1(2)+ceps_1)
      lz1_234(1)%c(2,1)=zcl(id1)*(-p1(2)+ceps_1)
      lz1_234(1)%d(1,1)=zcl(id1)
      lz1_234(1)%d(2,2)=zcr(id1)
* T -- qu=p1,qd=p234,v=2,a=lz1_234(2)%a,b=lz1_234(2)%b,c=lz1_234(2)%c,d=
* lz1_234(2)%d,cr=zcr(id1),cl=zcl(id1),nsum=0
      eps_0=-p1k0*p234(3)+p234k0*p1(3)
      ceps_0=eps_0*cim
      auxa=p1k0*p234(2)+p234k0*p1(2)
      lz1_234(2)%a(1,1)=zcr(id1)*(auxa+ceps_0)
      lz1_234(2)%a(2,2)=zcl(id1)*(auxa-ceps_0)
      lz1_234(2)%b(1,2)=-zcl(id1)*p234k0
      lz1_234(2)%b(2,1)=zcr(id1)*p234k0
      lz1_234(2)%c(1,2)=zcr(id1)*p1k0
      lz1_234(2)%c(2,1)=-zcl(id1)*p1k0
* T -- qu=p1,qd=p234,v=3,a=lz1_234(3)%a,b=lz1_234(3)%b,c=lz1_234(3)%c,d=
* lz1_234(3)%d,cr=zcr(id1),cl=zcl(id1),nsum=0
      eps_0=p1k0*p234(2)-p234k0*p1(2)
      ceps_0=eps_0*cim
      ceps_1=p1k0*cim
      ceps_2=p234k0*cim
      auxa=+p1k0*p234(3)+p234k0*p1(3)
      lz1_234(3)%a(1,1)=zcr(id1)*(auxa+ceps_0)
      lz1_234(3)%a(2,2)=zcl(id1)*(auxa-ceps_0)
      lz1_234(3)%b(1,2)=-zcl(id1)*ceps_2
      lz1_234(3)%b(2,1)=-zcr(id1)*ceps_2
      lz1_234(3)%c(1,2)=zcr(id1)*ceps_1
      lz1_234(3)%c(2,1)=zcl(id1)*ceps_1
  
  
      if(ineutri(id1).ne.1) then
* T -- qu=p1,qd=p234,v=0,a=lf1_234(0)%a,b=lf1_234(0)%b,c=lf1_234(0)%c,d=
* lf1_234(0)%d,cr=fcr(id1),cl=fcl(id1),nsum=0
      eps_0=-p1(2)*p234(3)+p234(2)*p1(3)
      ceps_0=eps_0*cim
      ceps_1=p1(3)*cim
      ceps_2=p234(3)*cim
      auxa=-quqd+p1k0*p234(0)+p234k0*p1(0)
      lf1_234(0)%a(1,1)=fcr(id1)*(auxa+ceps_0)
      lf1_234(0)%a(2,2)=fcl(id1)*(auxa-ceps_0)
      lf1_234(0)%b(1,2)=-fcl(id1)*(p234(2)+ceps_2)
      lf1_234(0)%b(2,1)=fcr(id1)*(p234(2)-ceps_2)
      lf1_234(0)%c(1,2)=fcr(id1)*(p1(2)+ceps_1)
      lf1_234(0)%c(2,1)=fcl(id1)*(-p1(2)+ceps_1)
      lf1_234(0)%d(1,1)=fcl(id1)
      lf1_234(0)%d(2,2)=fcr(id1)
* T -- qu=p1,qd=p234,v=1,a=lf1_234(1)%a,b=lf1_234(1)%b,c=lf1_234(1)%c,d=
* lf1_234(1)%d,cr=fcr(id1),cl=fcl(id1),nsum=0
      auxa=-quqd+p1k0*p234(1)+p234k0*p1(1)
      lf1_234(1)%a(1,1)=fcr(id1)*(auxa+ceps_0)
      lf1_234(1)%a(2,2)=fcl(id1)*(auxa-ceps_0)
      lf1_234(1)%b(1,2)=-fcl(id1)*(p234(2)+ceps_2)
      lf1_234(1)%b(2,1)=fcr(id1)*(p234(2)-ceps_2)
      lf1_234(1)%c(1,2)=fcr(id1)*(p1(2)+ceps_1)
      lf1_234(1)%c(2,1)=fcl(id1)*(-p1(2)+ceps_1)
      lf1_234(1)%d(1,1)=fcl(id1)
      lf1_234(1)%d(2,2)=fcr(id1)
* T -- qu=p1,qd=p234,v=2,a=lf1_234(2)%a,b=lf1_234(2)%b,c=lf1_234(2)%c,d=
* lf1_234(2)%d,cr=fcr(id1),cl=fcl(id1),nsum=0
      eps_0=-p1k0*p234(3)+p234k0*p1(3)
      ceps_0=eps_0*cim
      auxa=p1k0*p234(2)+p234k0*p1(2)
      lf1_234(2)%a(1,1)=fcr(id1)*(auxa+ceps_0)
      lf1_234(2)%a(2,2)=fcl(id1)*(auxa-ceps_0)
      lf1_234(2)%b(1,2)=-fcl(id1)*p234k0
      lf1_234(2)%b(2,1)=fcr(id1)*p234k0
      lf1_234(2)%c(1,2)=fcr(id1)*p1k0
      lf1_234(2)%c(2,1)=-fcl(id1)*p1k0
* T -- qu=p1,qd=p234,v=3,a=lf1_234(3)%a,b=lf1_234(3)%b,c=lf1_234(3)%c,d=
* lf1_234(3)%d,cr=fcr(id1),cl=fcl(id1),nsum=0
      eps_0=p1k0*p234(2)-p234k0*p1(2)
      ceps_0=eps_0*cim
      ceps_1=p1k0*cim
      ceps_2=p234k0*cim
      auxa=+p1k0*p234(3)+p234k0*p1(3)
      lf1_234(3)%a(1,1)=fcr(id1)*(auxa+ceps_0)
      lf1_234(3)%a(2,2)=fcl(id1)*(auxa-ceps_0)
      lf1_234(3)%b(1,2)=-fcl(id1)*ceps_2
      lf1_234(3)%b(2,1)=-fcr(id1)*ceps_2
      lf1_234(3)%c(1,2)=fcr(id1)*ceps_1
      lf1_234(3)%c(2,1)=fcl(id1)*ceps_1
  
      else
        do mu=0,3
          lf1_234(mu)%a(1,1) = czero
          lf1_234(mu)%a(2,2) = czero
          lf1_234(mu)%b(1,2) = czero
          lf1_234(mu)%b(2,1) = czero
          lf1_234(mu)%c(1,2) = czero
          lf1_234(mu)%c(2,1) = czero
          lf1_234(mu)%d(1,1) = czero
          lf1_234(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p1,q=p256
      quqd=p1(0)*p256(0)-p1(1)*p256(1)-p1(2)*p256(2)-p1(3)*p256(
     & 3)
* T -- qu=p1,qd=p256,v=0,a=lz1_256(0)%a,b=lz1_256(0)%b,c=lz1_256(0)%c,d=
* lz1_256(0)%d,cr=zcr(id1),cl=zcl(id1),nsum=0
      eps_0=-p1(2)*p256(3)+p256(2)*p1(3)
      ceps_0=eps_0*cim
      ceps_1=p1(3)*cim
      ceps_2=p256(3)*cim
      auxa=-quqd+p1k0*p256(0)+p256k0*p1(0)
      lz1_256(0)%a(1,1)=zcr(id1)*(auxa+ceps_0)
      lz1_256(0)%a(2,2)=zcl(id1)*(auxa-ceps_0)
      lz1_256(0)%b(1,2)=-zcl(id1)*(p256(2)+ceps_2)
      lz1_256(0)%b(2,1)=zcr(id1)*(p256(2)-ceps_2)
      lz1_256(0)%c(1,2)=zcr(id1)*(p1(2)+ceps_1)
      lz1_256(0)%c(2,1)=zcl(id1)*(-p1(2)+ceps_1)
      lz1_256(0)%d(1,1)=zcl(id1)
      lz1_256(0)%d(2,2)=zcr(id1)
* T -- qu=p1,qd=p256,v=1,a=lz1_256(1)%a,b=lz1_256(1)%b,c=lz1_256(1)%c,d=
* lz1_256(1)%d,cr=zcr(id1),cl=zcl(id1),nsum=0
      auxa=-quqd+p1k0*p256(1)+p256k0*p1(1)
      lz1_256(1)%a(1,1)=zcr(id1)*(auxa+ceps_0)
      lz1_256(1)%a(2,2)=zcl(id1)*(auxa-ceps_0)
      lz1_256(1)%b(1,2)=-zcl(id1)*(p256(2)+ceps_2)
      lz1_256(1)%b(2,1)=zcr(id1)*(p256(2)-ceps_2)
      lz1_256(1)%c(1,2)=zcr(id1)*(p1(2)+ceps_1)
      lz1_256(1)%c(2,1)=zcl(id1)*(-p1(2)+ceps_1)
      lz1_256(1)%d(1,1)=zcl(id1)
      lz1_256(1)%d(2,2)=zcr(id1)
* T -- qu=p1,qd=p256,v=2,a=lz1_256(2)%a,b=lz1_256(2)%b,c=lz1_256(2)%c,d=
* lz1_256(2)%d,cr=zcr(id1),cl=zcl(id1),nsum=0
      eps_0=-p1k0*p256(3)+p256k0*p1(3)
      ceps_0=eps_0*cim
      auxa=p1k0*p256(2)+p256k0*p1(2)
      lz1_256(2)%a(1,1)=zcr(id1)*(auxa+ceps_0)
      lz1_256(2)%a(2,2)=zcl(id1)*(auxa-ceps_0)
      lz1_256(2)%b(1,2)=-zcl(id1)*p256k0
      lz1_256(2)%b(2,1)=zcr(id1)*p256k0
      lz1_256(2)%c(1,2)=zcr(id1)*p1k0
      lz1_256(2)%c(2,1)=-zcl(id1)*p1k0
* T -- qu=p1,qd=p256,v=3,a=lz1_256(3)%a,b=lz1_256(3)%b,c=lz1_256(3)%c,d=
* lz1_256(3)%d,cr=zcr(id1),cl=zcl(id1),nsum=0
      eps_0=p1k0*p256(2)-p256k0*p1(2)
      ceps_0=eps_0*cim
      ceps_1=p1k0*cim
      ceps_2=p256k0*cim
      auxa=+p1k0*p256(3)+p256k0*p1(3)
      lz1_256(3)%a(1,1)=zcr(id1)*(auxa+ceps_0)
      lz1_256(3)%a(2,2)=zcl(id1)*(auxa-ceps_0)
      lz1_256(3)%b(1,2)=-zcl(id1)*ceps_2
      lz1_256(3)%b(2,1)=-zcr(id1)*ceps_2
      lz1_256(3)%c(1,2)=zcr(id1)*ceps_1
      lz1_256(3)%c(2,1)=zcl(id1)*ceps_1
  
  
      if(ineutri(id1).ne.1) then
* T -- qu=p1,qd=p256,v=0,a=lf1_256(0)%a,b=lf1_256(0)%b,c=lf1_256(0)%c,d=
* lf1_256(0)%d,cr=fcr(id1),cl=fcl(id1),nsum=0
      eps_0=-p1(2)*p256(3)+p256(2)*p1(3)
      ceps_0=eps_0*cim
      ceps_1=p1(3)*cim
      ceps_2=p256(3)*cim
      auxa=-quqd+p1k0*p256(0)+p256k0*p1(0)
      lf1_256(0)%a(1,1)=fcr(id1)*(auxa+ceps_0)
      lf1_256(0)%a(2,2)=fcl(id1)*(auxa-ceps_0)
      lf1_256(0)%b(1,2)=-fcl(id1)*(p256(2)+ceps_2)
      lf1_256(0)%b(2,1)=fcr(id1)*(p256(2)-ceps_2)
      lf1_256(0)%c(1,2)=fcr(id1)*(p1(2)+ceps_1)
      lf1_256(0)%c(2,1)=fcl(id1)*(-p1(2)+ceps_1)
      lf1_256(0)%d(1,1)=fcl(id1)
      lf1_256(0)%d(2,2)=fcr(id1)
* T -- qu=p1,qd=p256,v=1,a=lf1_256(1)%a,b=lf1_256(1)%b,c=lf1_256(1)%c,d=
* lf1_256(1)%d,cr=fcr(id1),cl=fcl(id1),nsum=0
      auxa=-quqd+p1k0*p256(1)+p256k0*p1(1)
      lf1_256(1)%a(1,1)=fcr(id1)*(auxa+ceps_0)
      lf1_256(1)%a(2,2)=fcl(id1)*(auxa-ceps_0)
      lf1_256(1)%b(1,2)=-fcl(id1)*(p256(2)+ceps_2)
      lf1_256(1)%b(2,1)=fcr(id1)*(p256(2)-ceps_2)
      lf1_256(1)%c(1,2)=fcr(id1)*(p1(2)+ceps_1)
      lf1_256(1)%c(2,1)=fcl(id1)*(-p1(2)+ceps_1)
      lf1_256(1)%d(1,1)=fcl(id1)
      lf1_256(1)%d(2,2)=fcr(id1)
* T -- qu=p1,qd=p256,v=2,a=lf1_256(2)%a,b=lf1_256(2)%b,c=lf1_256(2)%c,d=
* lf1_256(2)%d,cr=fcr(id1),cl=fcl(id1),nsum=0
      eps_0=-p1k0*p256(3)+p256k0*p1(3)
      ceps_0=eps_0*cim
      auxa=p1k0*p256(2)+p256k0*p1(2)
      lf1_256(2)%a(1,1)=fcr(id1)*(auxa+ceps_0)
      lf1_256(2)%a(2,2)=fcl(id1)*(auxa-ceps_0)
      lf1_256(2)%b(1,2)=-fcl(id1)*p256k0
      lf1_256(2)%b(2,1)=fcr(id1)*p256k0
      lf1_256(2)%c(1,2)=fcr(id1)*p1k0
      lf1_256(2)%c(2,1)=-fcl(id1)*p1k0
* T -- qu=p1,qd=p256,v=3,a=lf1_256(3)%a,b=lf1_256(3)%b,c=lf1_256(3)%c,d=
* lf1_256(3)%d,cr=fcr(id1),cl=fcl(id1),nsum=0
      eps_0=p1k0*p256(2)-p256k0*p1(2)
      ceps_0=eps_0*cim
      ceps_1=p1k0*cim
      ceps_2=p256k0*cim
      auxa=+p1k0*p256(3)+p256k0*p1(3)
      lf1_256(3)%a(1,1)=fcr(id1)*(auxa+ceps_0)
      lf1_256(3)%a(2,2)=fcl(id1)*(auxa-ceps_0)
      lf1_256(3)%b(1,2)=-fcl(id1)*ceps_2
      lf1_256(3)%b(2,1)=-fcr(id1)*ceps_2
      lf1_256(3)%c(1,2)=fcr(id1)*ceps_1
      lf1_256(3)%c(2,1)=fcl(id1)*ceps_1
  
      else
        do mu=0,3
          lf1_256(mu)%a(1,1) = czero
          lf1_256(mu)%a(2,2) = czero
          lf1_256(mu)%b(1,2) = czero
          lf1_256(mu)%b(2,1) = czero
          lf1_256(mu)%c(1,2) = czero
          lf1_256(mu)%c(2,1) = czero
          lf1_256(mu)%d(1,1) = czero
          lf1_256(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p1,q=p278
      quqd=p1(0)*p278(0)-p1(1)*p278(1)-p1(2)*p278(2)-p1(3)*p278(
     & 3)
* T -- qu=p1,qd=p278,v=0,a=lz1_278(0)%a,b=lz1_278(0)%b,c=lz1_278(0)%c,d=
* lz1_278(0)%d,cr=zcr(id1),cl=zcl(id1),nsum=0
      eps_0=-p1(2)*p278(3)+p278(2)*p1(3)
      ceps_0=eps_0*cim
      ceps_1=p1(3)*cim
      ceps_2=p278(3)*cim
      auxa=-quqd+p1k0*p278(0)+p278k0*p1(0)
      lz1_278(0)%a(1,1)=zcr(id1)*(auxa+ceps_0)
      lz1_278(0)%a(2,2)=zcl(id1)*(auxa-ceps_0)
      lz1_278(0)%b(1,2)=-zcl(id1)*(p278(2)+ceps_2)
      lz1_278(0)%b(2,1)=zcr(id1)*(p278(2)-ceps_2)
      lz1_278(0)%c(1,2)=zcr(id1)*(p1(2)+ceps_1)
      lz1_278(0)%c(2,1)=zcl(id1)*(-p1(2)+ceps_1)
      lz1_278(0)%d(1,1)=zcl(id1)
      lz1_278(0)%d(2,2)=zcr(id1)
* T -- qu=p1,qd=p278,v=1,a=lz1_278(1)%a,b=lz1_278(1)%b,c=lz1_278(1)%c,d=
* lz1_278(1)%d,cr=zcr(id1),cl=zcl(id1),nsum=0
      auxa=-quqd+p1k0*p278(1)+p278k0*p1(1)
      lz1_278(1)%a(1,1)=zcr(id1)*(auxa+ceps_0)
      lz1_278(1)%a(2,2)=zcl(id1)*(auxa-ceps_0)
      lz1_278(1)%b(1,2)=-zcl(id1)*(p278(2)+ceps_2)
      lz1_278(1)%b(2,1)=zcr(id1)*(p278(2)-ceps_2)
      lz1_278(1)%c(1,2)=zcr(id1)*(p1(2)+ceps_1)
      lz1_278(1)%c(2,1)=zcl(id1)*(-p1(2)+ceps_1)
      lz1_278(1)%d(1,1)=zcl(id1)
      lz1_278(1)%d(2,2)=zcr(id1)
* T -- qu=p1,qd=p278,v=2,a=lz1_278(2)%a,b=lz1_278(2)%b,c=lz1_278(2)%c,d=
* lz1_278(2)%d,cr=zcr(id1),cl=zcl(id1),nsum=0
      eps_0=-p1k0*p278(3)+p278k0*p1(3)
      ceps_0=eps_0*cim
      auxa=p1k0*p278(2)+p278k0*p1(2)
      lz1_278(2)%a(1,1)=zcr(id1)*(auxa+ceps_0)
      lz1_278(2)%a(2,2)=zcl(id1)*(auxa-ceps_0)
      lz1_278(2)%b(1,2)=-zcl(id1)*p278k0
      lz1_278(2)%b(2,1)=zcr(id1)*p278k0
      lz1_278(2)%c(1,2)=zcr(id1)*p1k0
      lz1_278(2)%c(2,1)=-zcl(id1)*p1k0
* T -- qu=p1,qd=p278,v=3,a=lz1_278(3)%a,b=lz1_278(3)%b,c=lz1_278(3)%c,d=
* lz1_278(3)%d,cr=zcr(id1),cl=zcl(id1),nsum=0
      eps_0=p1k0*p278(2)-p278k0*p1(2)
      ceps_0=eps_0*cim
      ceps_1=p1k0*cim
      ceps_2=p278k0*cim
      auxa=+p1k0*p278(3)+p278k0*p1(3)
      lz1_278(3)%a(1,1)=zcr(id1)*(auxa+ceps_0)
      lz1_278(3)%a(2,2)=zcl(id1)*(auxa-ceps_0)
      lz1_278(3)%b(1,2)=-zcl(id1)*ceps_2
      lz1_278(3)%b(2,1)=-zcr(id1)*ceps_2
      lz1_278(3)%c(1,2)=zcr(id1)*ceps_1
      lz1_278(3)%c(2,1)=zcl(id1)*ceps_1
  
  
      if(ineutri(id1).ne.1) then
* T -- qu=p1,qd=p278,v=0,a=lf1_278(0)%a,b=lf1_278(0)%b,c=lf1_278(0)%c,d=
* lf1_278(0)%d,cr=fcr(id1),cl=fcl(id1),nsum=0
      eps_0=-p1(2)*p278(3)+p278(2)*p1(3)
      ceps_0=eps_0*cim
      ceps_1=p1(3)*cim
      ceps_2=p278(3)*cim
      auxa=-quqd+p1k0*p278(0)+p278k0*p1(0)
      lf1_278(0)%a(1,1)=fcr(id1)*(auxa+ceps_0)
      lf1_278(0)%a(2,2)=fcl(id1)*(auxa-ceps_0)
      lf1_278(0)%b(1,2)=-fcl(id1)*(p278(2)+ceps_2)
      lf1_278(0)%b(2,1)=fcr(id1)*(p278(2)-ceps_2)
      lf1_278(0)%c(1,2)=fcr(id1)*(p1(2)+ceps_1)
      lf1_278(0)%c(2,1)=fcl(id1)*(-p1(2)+ceps_1)
      lf1_278(0)%d(1,1)=fcl(id1)
      lf1_278(0)%d(2,2)=fcr(id1)
* T -- qu=p1,qd=p278,v=1,a=lf1_278(1)%a,b=lf1_278(1)%b,c=lf1_278(1)%c,d=
* lf1_278(1)%d,cr=fcr(id1),cl=fcl(id1),nsum=0
      auxa=-quqd+p1k0*p278(1)+p278k0*p1(1)
      lf1_278(1)%a(1,1)=fcr(id1)*(auxa+ceps_0)
      lf1_278(1)%a(2,2)=fcl(id1)*(auxa-ceps_0)
      lf1_278(1)%b(1,2)=-fcl(id1)*(p278(2)+ceps_2)
      lf1_278(1)%b(2,1)=fcr(id1)*(p278(2)-ceps_2)
      lf1_278(1)%c(1,2)=fcr(id1)*(p1(2)+ceps_1)
      lf1_278(1)%c(2,1)=fcl(id1)*(-p1(2)+ceps_1)
      lf1_278(1)%d(1,1)=fcl(id1)
      lf1_278(1)%d(2,2)=fcr(id1)
* T -- qu=p1,qd=p278,v=2,a=lf1_278(2)%a,b=lf1_278(2)%b,c=lf1_278(2)%c,d=
* lf1_278(2)%d,cr=fcr(id1),cl=fcl(id1),nsum=0
      eps_0=-p1k0*p278(3)+p278k0*p1(3)
      ceps_0=eps_0*cim
      auxa=p1k0*p278(2)+p278k0*p1(2)
      lf1_278(2)%a(1,1)=fcr(id1)*(auxa+ceps_0)
      lf1_278(2)%a(2,2)=fcl(id1)*(auxa-ceps_0)
      lf1_278(2)%b(1,2)=-fcl(id1)*p278k0
      lf1_278(2)%b(2,1)=fcr(id1)*p278k0
      lf1_278(2)%c(1,2)=fcr(id1)*p1k0
      lf1_278(2)%c(2,1)=-fcl(id1)*p1k0
* T -- qu=p1,qd=p278,v=3,a=lf1_278(3)%a,b=lf1_278(3)%b,c=lf1_278(3)%c,d=
* lf1_278(3)%d,cr=fcr(id1),cl=fcl(id1),nsum=0
      eps_0=p1k0*p278(2)-p278k0*p1(2)
      ceps_0=eps_0*cim
      ceps_1=p1k0*cim
      ceps_2=p278k0*cim
      auxa=+p1k0*p278(3)+p278k0*p1(3)
      lf1_278(3)%a(1,1)=fcr(id1)*(auxa+ceps_0)
      lf1_278(3)%a(2,2)=fcl(id1)*(auxa-ceps_0)
      lf1_278(3)%b(1,2)=-fcl(id1)*ceps_2
      lf1_278(3)%b(2,1)=-fcr(id1)*ceps_2
      lf1_278(3)%c(1,2)=fcr(id1)*ceps_1
      lf1_278(3)%c(2,1)=fcl(id1)*ceps_1
  
      else
        do mu=0,3
          lf1_278(mu)%a(1,1) = czero
          lf1_278(mu)%a(2,2) = czero
          lf1_278(mu)%b(1,2) = czero
          lf1_278(mu)%b(2,1) = czero
          lf1_278(mu)%c(1,2) = czero
          lf1_278(mu)%c(2,1) = czero
          lf1_278(mu)%d(1,1) = czero
          lf1_278(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p3,q=p412
      quqd=p3(0)*p412(0)-p3(1)*p412(1)-p3(2)*p412(2)-p3(3)*p412(
     & 3)
* T -- qu=p3,qd=p412,v=0,a=lz3_412(0)%a,b=lz3_412(0)%b,c=lz3_412(0)%c,d=
* lz3_412(0)%d,cr=zcr(id3),cl=zcl(id3),nsum=0
      eps_0=-p3(2)*p412(3)+p412(2)*p3(3)
      ceps_0=eps_0*cim
      ceps_1=p3(3)*cim
      ceps_2=p412(3)*cim
      auxa=-quqd+p3k0*p412(0)+p412k0*p3(0)
      lz3_412(0)%a(1,1)=zcr(id3)*(auxa+ceps_0)
      lz3_412(0)%a(2,2)=zcl(id3)*(auxa-ceps_0)
      lz3_412(0)%b(1,2)=-zcl(id3)*(p412(2)+ceps_2)
      lz3_412(0)%b(2,1)=zcr(id3)*(p412(2)-ceps_2)
      lz3_412(0)%c(1,2)=zcr(id3)*(p3(2)+ceps_1)
      lz3_412(0)%c(2,1)=zcl(id3)*(-p3(2)+ceps_1)
      lz3_412(0)%d(1,1)=zcl(id3)
      lz3_412(0)%d(2,2)=zcr(id3)
* T -- qu=p3,qd=p412,v=1,a=lz3_412(1)%a,b=lz3_412(1)%b,c=lz3_412(1)%c,d=
* lz3_412(1)%d,cr=zcr(id3),cl=zcl(id3),nsum=0
      auxa=-quqd+p3k0*p412(1)+p412k0*p3(1)
      lz3_412(1)%a(1,1)=zcr(id3)*(auxa+ceps_0)
      lz3_412(1)%a(2,2)=zcl(id3)*(auxa-ceps_0)
      lz3_412(1)%b(1,2)=-zcl(id3)*(p412(2)+ceps_2)
      lz3_412(1)%b(2,1)=zcr(id3)*(p412(2)-ceps_2)
      lz3_412(1)%c(1,2)=zcr(id3)*(p3(2)+ceps_1)
      lz3_412(1)%c(2,1)=zcl(id3)*(-p3(2)+ceps_1)
      lz3_412(1)%d(1,1)=zcl(id3)
      lz3_412(1)%d(2,2)=zcr(id3)
* T -- qu=p3,qd=p412,v=2,a=lz3_412(2)%a,b=lz3_412(2)%b,c=lz3_412(2)%c,d=
* lz3_412(2)%d,cr=zcr(id3),cl=zcl(id3),nsum=0
      eps_0=-p3k0*p412(3)+p412k0*p3(3)
      ceps_0=eps_0*cim
      auxa=p3k0*p412(2)+p412k0*p3(2)
      lz3_412(2)%a(1,1)=zcr(id3)*(auxa+ceps_0)
      lz3_412(2)%a(2,2)=zcl(id3)*(auxa-ceps_0)
      lz3_412(2)%b(1,2)=-zcl(id3)*p412k0
      lz3_412(2)%b(2,1)=zcr(id3)*p412k0
      lz3_412(2)%c(1,2)=zcr(id3)*p3k0
      lz3_412(2)%c(2,1)=-zcl(id3)*p3k0
* T -- qu=p3,qd=p412,v=3,a=lz3_412(3)%a,b=lz3_412(3)%b,c=lz3_412(3)%c,d=
* lz3_412(3)%d,cr=zcr(id3),cl=zcl(id3),nsum=0
      eps_0=p3k0*p412(2)-p412k0*p3(2)
      ceps_0=eps_0*cim
      ceps_1=p3k0*cim
      ceps_2=p412k0*cim
      auxa=+p3k0*p412(3)+p412k0*p3(3)
      lz3_412(3)%a(1,1)=zcr(id3)*(auxa+ceps_0)
      lz3_412(3)%a(2,2)=zcl(id3)*(auxa-ceps_0)
      lz3_412(3)%b(1,2)=-zcl(id3)*ceps_2
      lz3_412(3)%b(2,1)=-zcr(id3)*ceps_2
      lz3_412(3)%c(1,2)=zcr(id3)*ceps_1
      lz3_412(3)%c(2,1)=zcl(id3)*ceps_1
  
  
      if(ineutri(id3).ne.1) then
* T -- qu=p3,qd=p412,v=0,a=lf3_412(0)%a,b=lf3_412(0)%b,c=lf3_412(0)%c,d=
* lf3_412(0)%d,cr=fcr(id3),cl=fcl(id3),nsum=0
      eps_0=-p3(2)*p412(3)+p412(2)*p3(3)
      ceps_0=eps_0*cim
      ceps_1=p3(3)*cim
      ceps_2=p412(3)*cim
      auxa=-quqd+p3k0*p412(0)+p412k0*p3(0)
      lf3_412(0)%a(1,1)=fcr(id3)*(auxa+ceps_0)
      lf3_412(0)%a(2,2)=fcl(id3)*(auxa-ceps_0)
      lf3_412(0)%b(1,2)=-fcl(id3)*(p412(2)+ceps_2)
      lf3_412(0)%b(2,1)=fcr(id3)*(p412(2)-ceps_2)
      lf3_412(0)%c(1,2)=fcr(id3)*(p3(2)+ceps_1)
      lf3_412(0)%c(2,1)=fcl(id3)*(-p3(2)+ceps_1)
      lf3_412(0)%d(1,1)=fcl(id3)
      lf3_412(0)%d(2,2)=fcr(id3)
* T -- qu=p3,qd=p412,v=1,a=lf3_412(1)%a,b=lf3_412(1)%b,c=lf3_412(1)%c,d=
* lf3_412(1)%d,cr=fcr(id3),cl=fcl(id3),nsum=0
      auxa=-quqd+p3k0*p412(1)+p412k0*p3(1)
      lf3_412(1)%a(1,1)=fcr(id3)*(auxa+ceps_0)
      lf3_412(1)%a(2,2)=fcl(id3)*(auxa-ceps_0)
      lf3_412(1)%b(1,2)=-fcl(id3)*(p412(2)+ceps_2)
      lf3_412(1)%b(2,1)=fcr(id3)*(p412(2)-ceps_2)
      lf3_412(1)%c(1,2)=fcr(id3)*(p3(2)+ceps_1)
      lf3_412(1)%c(2,1)=fcl(id3)*(-p3(2)+ceps_1)
      lf3_412(1)%d(1,1)=fcl(id3)
      lf3_412(1)%d(2,2)=fcr(id3)
* T -- qu=p3,qd=p412,v=2,a=lf3_412(2)%a,b=lf3_412(2)%b,c=lf3_412(2)%c,d=
* lf3_412(2)%d,cr=fcr(id3),cl=fcl(id3),nsum=0
      eps_0=-p3k0*p412(3)+p412k0*p3(3)
      ceps_0=eps_0*cim
      auxa=p3k0*p412(2)+p412k0*p3(2)
      lf3_412(2)%a(1,1)=fcr(id3)*(auxa+ceps_0)
      lf3_412(2)%a(2,2)=fcl(id3)*(auxa-ceps_0)
      lf3_412(2)%b(1,2)=-fcl(id3)*p412k0
      lf3_412(2)%b(2,1)=fcr(id3)*p412k0
      lf3_412(2)%c(1,2)=fcr(id3)*p3k0
      lf3_412(2)%c(2,1)=-fcl(id3)*p3k0
* T -- qu=p3,qd=p412,v=3,a=lf3_412(3)%a,b=lf3_412(3)%b,c=lf3_412(3)%c,d=
* lf3_412(3)%d,cr=fcr(id3),cl=fcl(id3),nsum=0
      eps_0=p3k0*p412(2)-p412k0*p3(2)
      ceps_0=eps_0*cim
      ceps_1=p3k0*cim
      ceps_2=p412k0*cim
      auxa=+p3k0*p412(3)+p412k0*p3(3)
      lf3_412(3)%a(1,1)=fcr(id3)*(auxa+ceps_0)
      lf3_412(3)%a(2,2)=fcl(id3)*(auxa-ceps_0)
      lf3_412(3)%b(1,2)=-fcl(id3)*ceps_2
      lf3_412(3)%b(2,1)=-fcr(id3)*ceps_2
      lf3_412(3)%c(1,2)=fcr(id3)*ceps_1
      lf3_412(3)%c(2,1)=fcl(id3)*ceps_1
  
      else
        do mu=0,3
          lf3_412(mu)%a(1,1) = czero
          lf3_412(mu)%a(2,2) = czero
          lf3_412(mu)%b(1,2) = czero
          lf3_412(mu)%b(2,1) = czero
          lf3_412(mu)%c(1,2) = czero
          lf3_412(mu)%c(2,1) = czero
          lf3_412(mu)%d(1,1) = czero
          lf3_412(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p3,q=p456
      quqd=p3(0)*p456(0)-p3(1)*p456(1)-p3(2)*p456(2)-p3(3)*p456(
     & 3)
* T -- qu=p3,qd=p456,v=0,a=lz3_456(0)%a,b=lz3_456(0)%b,c=lz3_456(0)%c,d=
* lz3_456(0)%d,cr=zcr(id3),cl=zcl(id3),nsum=0
      eps_0=-p3(2)*p456(3)+p456(2)*p3(3)
      ceps_0=eps_0*cim
      ceps_1=p3(3)*cim
      ceps_2=p456(3)*cim
      auxa=-quqd+p3k0*p456(0)+p456k0*p3(0)
      lz3_456(0)%a(1,1)=zcr(id3)*(auxa+ceps_0)
      lz3_456(0)%a(2,2)=zcl(id3)*(auxa-ceps_0)
      lz3_456(0)%b(1,2)=-zcl(id3)*(p456(2)+ceps_2)
      lz3_456(0)%b(2,1)=zcr(id3)*(p456(2)-ceps_2)
      lz3_456(0)%c(1,2)=zcr(id3)*(p3(2)+ceps_1)
      lz3_456(0)%c(2,1)=zcl(id3)*(-p3(2)+ceps_1)
      lz3_456(0)%d(1,1)=zcl(id3)
      lz3_456(0)%d(2,2)=zcr(id3)
* T -- qu=p3,qd=p456,v=1,a=lz3_456(1)%a,b=lz3_456(1)%b,c=lz3_456(1)%c,d=
* lz3_456(1)%d,cr=zcr(id3),cl=zcl(id3),nsum=0
      auxa=-quqd+p3k0*p456(1)+p456k0*p3(1)
      lz3_456(1)%a(1,1)=zcr(id3)*(auxa+ceps_0)
      lz3_456(1)%a(2,2)=zcl(id3)*(auxa-ceps_0)
      lz3_456(1)%b(1,2)=-zcl(id3)*(p456(2)+ceps_2)
      lz3_456(1)%b(2,1)=zcr(id3)*(p456(2)-ceps_2)
      lz3_456(1)%c(1,2)=zcr(id3)*(p3(2)+ceps_1)
      lz3_456(1)%c(2,1)=zcl(id3)*(-p3(2)+ceps_1)
      lz3_456(1)%d(1,1)=zcl(id3)
      lz3_456(1)%d(2,2)=zcr(id3)
* T -- qu=p3,qd=p456,v=2,a=lz3_456(2)%a,b=lz3_456(2)%b,c=lz3_456(2)%c,d=
* lz3_456(2)%d,cr=zcr(id3),cl=zcl(id3),nsum=0
      eps_0=-p3k0*p456(3)+p456k0*p3(3)
      ceps_0=eps_0*cim
      auxa=p3k0*p456(2)+p456k0*p3(2)
      lz3_456(2)%a(1,1)=zcr(id3)*(auxa+ceps_0)
      lz3_456(2)%a(2,2)=zcl(id3)*(auxa-ceps_0)
      lz3_456(2)%b(1,2)=-zcl(id3)*p456k0
      lz3_456(2)%b(2,1)=zcr(id3)*p456k0
      lz3_456(2)%c(1,2)=zcr(id3)*p3k0
      lz3_456(2)%c(2,1)=-zcl(id3)*p3k0
* T -- qu=p3,qd=p456,v=3,a=lz3_456(3)%a,b=lz3_456(3)%b,c=lz3_456(3)%c,d=
* lz3_456(3)%d,cr=zcr(id3),cl=zcl(id3),nsum=0
      eps_0=p3k0*p456(2)-p456k0*p3(2)
      ceps_0=eps_0*cim
      ceps_1=p3k0*cim
      ceps_2=p456k0*cim
      auxa=+p3k0*p456(3)+p456k0*p3(3)
      lz3_456(3)%a(1,1)=zcr(id3)*(auxa+ceps_0)
      lz3_456(3)%a(2,2)=zcl(id3)*(auxa-ceps_0)
      lz3_456(3)%b(1,2)=-zcl(id3)*ceps_2
      lz3_456(3)%b(2,1)=-zcr(id3)*ceps_2
      lz3_456(3)%c(1,2)=zcr(id3)*ceps_1
      lz3_456(3)%c(2,1)=zcl(id3)*ceps_1
  
  
      if(ineutri(id3).ne.1) then
* T -- qu=p3,qd=p456,v=0,a=lf3_456(0)%a,b=lf3_456(0)%b,c=lf3_456(0)%c,d=
* lf3_456(0)%d,cr=fcr(id3),cl=fcl(id3),nsum=0
      eps_0=-p3(2)*p456(3)+p456(2)*p3(3)
      ceps_0=eps_0*cim
      ceps_1=p3(3)*cim
      ceps_2=p456(3)*cim
      auxa=-quqd+p3k0*p456(0)+p456k0*p3(0)
      lf3_456(0)%a(1,1)=fcr(id3)*(auxa+ceps_0)
      lf3_456(0)%a(2,2)=fcl(id3)*(auxa-ceps_0)
      lf3_456(0)%b(1,2)=-fcl(id3)*(p456(2)+ceps_2)
      lf3_456(0)%b(2,1)=fcr(id3)*(p456(2)-ceps_2)
      lf3_456(0)%c(1,2)=fcr(id3)*(p3(2)+ceps_1)
      lf3_456(0)%c(2,1)=fcl(id3)*(-p3(2)+ceps_1)
      lf3_456(0)%d(1,1)=fcl(id3)
      lf3_456(0)%d(2,2)=fcr(id3)
* T -- qu=p3,qd=p456,v=1,a=lf3_456(1)%a,b=lf3_456(1)%b,c=lf3_456(1)%c,d=
* lf3_456(1)%d,cr=fcr(id3),cl=fcl(id3),nsum=0
      auxa=-quqd+p3k0*p456(1)+p456k0*p3(1)
      lf3_456(1)%a(1,1)=fcr(id3)*(auxa+ceps_0)
      lf3_456(1)%a(2,2)=fcl(id3)*(auxa-ceps_0)
      lf3_456(1)%b(1,2)=-fcl(id3)*(p456(2)+ceps_2)
      lf3_456(1)%b(2,1)=fcr(id3)*(p456(2)-ceps_2)
      lf3_456(1)%c(1,2)=fcr(id3)*(p3(2)+ceps_1)
      lf3_456(1)%c(2,1)=fcl(id3)*(-p3(2)+ceps_1)
      lf3_456(1)%d(1,1)=fcl(id3)
      lf3_456(1)%d(2,2)=fcr(id3)
* T -- qu=p3,qd=p456,v=2,a=lf3_456(2)%a,b=lf3_456(2)%b,c=lf3_456(2)%c,d=
* lf3_456(2)%d,cr=fcr(id3),cl=fcl(id3),nsum=0
      eps_0=-p3k0*p456(3)+p456k0*p3(3)
      ceps_0=eps_0*cim
      auxa=p3k0*p456(2)+p456k0*p3(2)
      lf3_456(2)%a(1,1)=fcr(id3)*(auxa+ceps_0)
      lf3_456(2)%a(2,2)=fcl(id3)*(auxa-ceps_0)
      lf3_456(2)%b(1,2)=-fcl(id3)*p456k0
      lf3_456(2)%b(2,1)=fcr(id3)*p456k0
      lf3_456(2)%c(1,2)=fcr(id3)*p3k0
      lf3_456(2)%c(2,1)=-fcl(id3)*p3k0
* T -- qu=p3,qd=p456,v=3,a=lf3_456(3)%a,b=lf3_456(3)%b,c=lf3_456(3)%c,d=
* lf3_456(3)%d,cr=fcr(id3),cl=fcl(id3),nsum=0
      eps_0=p3k0*p456(2)-p456k0*p3(2)
      ceps_0=eps_0*cim
      ceps_1=p3k0*cim
      ceps_2=p456k0*cim
      auxa=+p3k0*p456(3)+p456k0*p3(3)
      lf3_456(3)%a(1,1)=fcr(id3)*(auxa+ceps_0)
      lf3_456(3)%a(2,2)=fcl(id3)*(auxa-ceps_0)
      lf3_456(3)%b(1,2)=-fcl(id3)*ceps_2
      lf3_456(3)%b(2,1)=-fcr(id3)*ceps_2
      lf3_456(3)%c(1,2)=fcr(id3)*ceps_1
      lf3_456(3)%c(2,1)=fcl(id3)*ceps_1
  
      else
        do mu=0,3
          lf3_456(mu)%a(1,1) = czero
          lf3_456(mu)%a(2,2) = czero
          lf3_456(mu)%b(1,2) = czero
          lf3_456(mu)%b(2,1) = czero
          lf3_456(mu)%c(1,2) = czero
          lf3_456(mu)%c(2,1) = czero
          lf3_456(mu)%d(1,1) = czero
          lf3_456(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p3,q=p478
      quqd=p3(0)*p478(0)-p3(1)*p478(1)-p3(2)*p478(2)-p3(3)*p478(
     & 3)
* T -- qu=p3,qd=p478,v=0,a=lz3_478(0)%a,b=lz3_478(0)%b,c=lz3_478(0)%c,d=
* lz3_478(0)%d,cr=zcr(id3),cl=zcl(id3),nsum=0
      eps_0=-p3(2)*p478(3)+p478(2)*p3(3)
      ceps_0=eps_0*cim
      ceps_1=p3(3)*cim
      ceps_2=p478(3)*cim
      auxa=-quqd+p3k0*p478(0)+p478k0*p3(0)
      lz3_478(0)%a(1,1)=zcr(id3)*(auxa+ceps_0)
      lz3_478(0)%a(2,2)=zcl(id3)*(auxa-ceps_0)
      lz3_478(0)%b(1,2)=-zcl(id3)*(p478(2)+ceps_2)
      lz3_478(0)%b(2,1)=zcr(id3)*(p478(2)-ceps_2)
      lz3_478(0)%c(1,2)=zcr(id3)*(p3(2)+ceps_1)
      lz3_478(0)%c(2,1)=zcl(id3)*(-p3(2)+ceps_1)
      lz3_478(0)%d(1,1)=zcl(id3)
      lz3_478(0)%d(2,2)=zcr(id3)
* T -- qu=p3,qd=p478,v=1,a=lz3_478(1)%a,b=lz3_478(1)%b,c=lz3_478(1)%c,d=
* lz3_478(1)%d,cr=zcr(id3),cl=zcl(id3),nsum=0
      auxa=-quqd+p3k0*p478(1)+p478k0*p3(1)
      lz3_478(1)%a(1,1)=zcr(id3)*(auxa+ceps_0)
      lz3_478(1)%a(2,2)=zcl(id3)*(auxa-ceps_0)
      lz3_478(1)%b(1,2)=-zcl(id3)*(p478(2)+ceps_2)
      lz3_478(1)%b(2,1)=zcr(id3)*(p478(2)-ceps_2)
      lz3_478(1)%c(1,2)=zcr(id3)*(p3(2)+ceps_1)
      lz3_478(1)%c(2,1)=zcl(id3)*(-p3(2)+ceps_1)
      lz3_478(1)%d(1,1)=zcl(id3)
      lz3_478(1)%d(2,2)=zcr(id3)
* T -- qu=p3,qd=p478,v=2,a=lz3_478(2)%a,b=lz3_478(2)%b,c=lz3_478(2)%c,d=
* lz3_478(2)%d,cr=zcr(id3),cl=zcl(id3),nsum=0
      eps_0=-p3k0*p478(3)+p478k0*p3(3)
      ceps_0=eps_0*cim
      auxa=p3k0*p478(2)+p478k0*p3(2)
      lz3_478(2)%a(1,1)=zcr(id3)*(auxa+ceps_0)
      lz3_478(2)%a(2,2)=zcl(id3)*(auxa-ceps_0)
      lz3_478(2)%b(1,2)=-zcl(id3)*p478k0
      lz3_478(2)%b(2,1)=zcr(id3)*p478k0
      lz3_478(2)%c(1,2)=zcr(id3)*p3k0
      lz3_478(2)%c(2,1)=-zcl(id3)*p3k0
* T -- qu=p3,qd=p478,v=3,a=lz3_478(3)%a,b=lz3_478(3)%b,c=lz3_478(3)%c,d=
* lz3_478(3)%d,cr=zcr(id3),cl=zcl(id3),nsum=0
      eps_0=p3k0*p478(2)-p478k0*p3(2)
      ceps_0=eps_0*cim
      ceps_1=p3k0*cim
      ceps_2=p478k0*cim
      auxa=+p3k0*p478(3)+p478k0*p3(3)
      lz3_478(3)%a(1,1)=zcr(id3)*(auxa+ceps_0)
      lz3_478(3)%a(2,2)=zcl(id3)*(auxa-ceps_0)
      lz3_478(3)%b(1,2)=-zcl(id3)*ceps_2
      lz3_478(3)%b(2,1)=-zcr(id3)*ceps_2
      lz3_478(3)%c(1,2)=zcr(id3)*ceps_1
      lz3_478(3)%c(2,1)=zcl(id3)*ceps_1
  
  
      if(ineutri(id3).ne.1) then
* T -- qu=p3,qd=p478,v=0,a=lf3_478(0)%a,b=lf3_478(0)%b,c=lf3_478(0)%c,d=
* lf3_478(0)%d,cr=fcr(id3),cl=fcl(id3),nsum=0
      eps_0=-p3(2)*p478(3)+p478(2)*p3(3)
      ceps_0=eps_0*cim
      ceps_1=p3(3)*cim
      ceps_2=p478(3)*cim
      auxa=-quqd+p3k0*p478(0)+p478k0*p3(0)
      lf3_478(0)%a(1,1)=fcr(id3)*(auxa+ceps_0)
      lf3_478(0)%a(2,2)=fcl(id3)*(auxa-ceps_0)
      lf3_478(0)%b(1,2)=-fcl(id3)*(p478(2)+ceps_2)
      lf3_478(0)%b(2,1)=fcr(id3)*(p478(2)-ceps_2)
      lf3_478(0)%c(1,2)=fcr(id3)*(p3(2)+ceps_1)
      lf3_478(0)%c(2,1)=fcl(id3)*(-p3(2)+ceps_1)
      lf3_478(0)%d(1,1)=fcl(id3)
      lf3_478(0)%d(2,2)=fcr(id3)
* T -- qu=p3,qd=p478,v=1,a=lf3_478(1)%a,b=lf3_478(1)%b,c=lf3_478(1)%c,d=
* lf3_478(1)%d,cr=fcr(id3),cl=fcl(id3),nsum=0
      auxa=-quqd+p3k0*p478(1)+p478k0*p3(1)
      lf3_478(1)%a(1,1)=fcr(id3)*(auxa+ceps_0)
      lf3_478(1)%a(2,2)=fcl(id3)*(auxa-ceps_0)
      lf3_478(1)%b(1,2)=-fcl(id3)*(p478(2)+ceps_2)
      lf3_478(1)%b(2,1)=fcr(id3)*(p478(2)-ceps_2)
      lf3_478(1)%c(1,2)=fcr(id3)*(p3(2)+ceps_1)
      lf3_478(1)%c(2,1)=fcl(id3)*(-p3(2)+ceps_1)
      lf3_478(1)%d(1,1)=fcl(id3)
      lf3_478(1)%d(2,2)=fcr(id3)
* T -- qu=p3,qd=p478,v=2,a=lf3_478(2)%a,b=lf3_478(2)%b,c=lf3_478(2)%c,d=
* lf3_478(2)%d,cr=fcr(id3),cl=fcl(id3),nsum=0
      eps_0=-p3k0*p478(3)+p478k0*p3(3)
      ceps_0=eps_0*cim
      auxa=p3k0*p478(2)+p478k0*p3(2)
      lf3_478(2)%a(1,1)=fcr(id3)*(auxa+ceps_0)
      lf3_478(2)%a(2,2)=fcl(id3)*(auxa-ceps_0)
      lf3_478(2)%b(1,2)=-fcl(id3)*p478k0
      lf3_478(2)%b(2,1)=fcr(id3)*p478k0
      lf3_478(2)%c(1,2)=fcr(id3)*p3k0
      lf3_478(2)%c(2,1)=-fcl(id3)*p3k0
* T -- qu=p3,qd=p478,v=3,a=lf3_478(3)%a,b=lf3_478(3)%b,c=lf3_478(3)%c,d=
* lf3_478(3)%d,cr=fcr(id3),cl=fcl(id3),nsum=0
      eps_0=p3k0*p478(2)-p478k0*p3(2)
      ceps_0=eps_0*cim
      ceps_1=p3k0*cim
      ceps_2=p478k0*cim
      auxa=+p3k0*p478(3)+p478k0*p3(3)
      lf3_478(3)%a(1,1)=fcr(id3)*(auxa+ceps_0)
      lf3_478(3)%a(2,2)=fcl(id3)*(auxa-ceps_0)
      lf3_478(3)%b(1,2)=-fcl(id3)*ceps_2
      lf3_478(3)%b(2,1)=-fcr(id3)*ceps_2
      lf3_478(3)%c(1,2)=fcr(id3)*ceps_1
      lf3_478(3)%c(2,1)=fcl(id3)*ceps_1
  
      else
        do mu=0,3
          lf3_478(mu)%a(1,1) = czero
          lf3_478(mu)%a(2,2) = czero
          lf3_478(mu)%b(1,2) = czero
          lf3_478(mu)%b(2,1) = czero
          lf3_478(mu)%c(1,2) = czero
          lf3_478(mu)%c(2,1) = czero
          lf3_478(mu)%d(1,1) = czero
          lf3_478(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p5,q=p612
      quqd=p5(0)*p612(0)-p5(1)*p612(1)-p5(2)*p612(2)-p5(3)*p612(
     & 3)
* T -- qu=p5,qd=p612,v=0,a=lz5_612(0)%a,b=lz5_612(0)%b,c=lz5_612(0)%c,d=
* lz5_612(0)%d,cr=zcr(id5),cl=zcl(id5),nsum=0
      eps_0=-p5(2)*p612(3)+p612(2)*p5(3)
      ceps_0=eps_0*cim
      ceps_1=p5(3)*cim
      ceps_2=p612(3)*cim
      auxa=-quqd+p5k0*p612(0)+p612k0*p5(0)
      lz5_612(0)%a(1,1)=zcr(id5)*(auxa+ceps_0)
      lz5_612(0)%a(2,2)=zcl(id5)*(auxa-ceps_0)
      lz5_612(0)%b(1,2)=-zcl(id5)*(p612(2)+ceps_2)
      lz5_612(0)%b(2,1)=zcr(id5)*(p612(2)-ceps_2)
      lz5_612(0)%c(1,2)=zcr(id5)*(p5(2)+ceps_1)
      lz5_612(0)%c(2,1)=zcl(id5)*(-p5(2)+ceps_1)
      lz5_612(0)%d(1,1)=zcl(id5)
      lz5_612(0)%d(2,2)=zcr(id5)
* T -- qu=p5,qd=p612,v=1,a=lz5_612(1)%a,b=lz5_612(1)%b,c=lz5_612(1)%c,d=
* lz5_612(1)%d,cr=zcr(id5),cl=zcl(id5),nsum=0
      auxa=-quqd+p5k0*p612(1)+p612k0*p5(1)
      lz5_612(1)%a(1,1)=zcr(id5)*(auxa+ceps_0)
      lz5_612(1)%a(2,2)=zcl(id5)*(auxa-ceps_0)
      lz5_612(1)%b(1,2)=-zcl(id5)*(p612(2)+ceps_2)
      lz5_612(1)%b(2,1)=zcr(id5)*(p612(2)-ceps_2)
      lz5_612(1)%c(1,2)=zcr(id5)*(p5(2)+ceps_1)
      lz5_612(1)%c(2,1)=zcl(id5)*(-p5(2)+ceps_1)
      lz5_612(1)%d(1,1)=zcl(id5)
      lz5_612(1)%d(2,2)=zcr(id5)
* T -- qu=p5,qd=p612,v=2,a=lz5_612(2)%a,b=lz5_612(2)%b,c=lz5_612(2)%c,d=
* lz5_612(2)%d,cr=zcr(id5),cl=zcl(id5),nsum=0
      eps_0=-p5k0*p612(3)+p612k0*p5(3)
      ceps_0=eps_0*cim
      auxa=p5k0*p612(2)+p612k0*p5(2)
      lz5_612(2)%a(1,1)=zcr(id5)*(auxa+ceps_0)
      lz5_612(2)%a(2,2)=zcl(id5)*(auxa-ceps_0)
      lz5_612(2)%b(1,2)=-zcl(id5)*p612k0
      lz5_612(2)%b(2,1)=zcr(id5)*p612k0
      lz5_612(2)%c(1,2)=zcr(id5)*p5k0
      lz5_612(2)%c(2,1)=-zcl(id5)*p5k0
* T -- qu=p5,qd=p612,v=3,a=lz5_612(3)%a,b=lz5_612(3)%b,c=lz5_612(3)%c,d=
* lz5_612(3)%d,cr=zcr(id5),cl=zcl(id5),nsum=0
      eps_0=p5k0*p612(2)-p612k0*p5(2)
      ceps_0=eps_0*cim
      ceps_1=p5k0*cim
      ceps_2=p612k0*cim
      auxa=+p5k0*p612(3)+p612k0*p5(3)
      lz5_612(3)%a(1,1)=zcr(id5)*(auxa+ceps_0)
      lz5_612(3)%a(2,2)=zcl(id5)*(auxa-ceps_0)
      lz5_612(3)%b(1,2)=-zcl(id5)*ceps_2
      lz5_612(3)%b(2,1)=-zcr(id5)*ceps_2
      lz5_612(3)%c(1,2)=zcr(id5)*ceps_1
      lz5_612(3)%c(2,1)=zcl(id5)*ceps_1
  
  
      if(ineutri(id5).ne.1) then
* T -- qu=p5,qd=p612,v=0,a=lf5_612(0)%a,b=lf5_612(0)%b,c=lf5_612(0)%c,d=
* lf5_612(0)%d,cr=fcr(id5),cl=fcl(id5),nsum=0
      eps_0=-p5(2)*p612(3)+p612(2)*p5(3)
      ceps_0=eps_0*cim
      ceps_1=p5(3)*cim
      ceps_2=p612(3)*cim
      auxa=-quqd+p5k0*p612(0)+p612k0*p5(0)
      lf5_612(0)%a(1,1)=fcr(id5)*(auxa+ceps_0)
      lf5_612(0)%a(2,2)=fcl(id5)*(auxa-ceps_0)
      lf5_612(0)%b(1,2)=-fcl(id5)*(p612(2)+ceps_2)
      lf5_612(0)%b(2,1)=fcr(id5)*(p612(2)-ceps_2)
      lf5_612(0)%c(1,2)=fcr(id5)*(p5(2)+ceps_1)
      lf5_612(0)%c(2,1)=fcl(id5)*(-p5(2)+ceps_1)
      lf5_612(0)%d(1,1)=fcl(id5)
      lf5_612(0)%d(2,2)=fcr(id5)
* T -- qu=p5,qd=p612,v=1,a=lf5_612(1)%a,b=lf5_612(1)%b,c=lf5_612(1)%c,d=
* lf5_612(1)%d,cr=fcr(id5),cl=fcl(id5),nsum=0
      auxa=-quqd+p5k0*p612(1)+p612k0*p5(1)
      lf5_612(1)%a(1,1)=fcr(id5)*(auxa+ceps_0)
      lf5_612(1)%a(2,2)=fcl(id5)*(auxa-ceps_0)
      lf5_612(1)%b(1,2)=-fcl(id5)*(p612(2)+ceps_2)
      lf5_612(1)%b(2,1)=fcr(id5)*(p612(2)-ceps_2)
      lf5_612(1)%c(1,2)=fcr(id5)*(p5(2)+ceps_1)
      lf5_612(1)%c(2,1)=fcl(id5)*(-p5(2)+ceps_1)
      lf5_612(1)%d(1,1)=fcl(id5)
      lf5_612(1)%d(2,2)=fcr(id5)
* T -- qu=p5,qd=p612,v=2,a=lf5_612(2)%a,b=lf5_612(2)%b,c=lf5_612(2)%c,d=
* lf5_612(2)%d,cr=fcr(id5),cl=fcl(id5),nsum=0
      eps_0=-p5k0*p612(3)+p612k0*p5(3)
      ceps_0=eps_0*cim
      auxa=p5k0*p612(2)+p612k0*p5(2)
      lf5_612(2)%a(1,1)=fcr(id5)*(auxa+ceps_0)
      lf5_612(2)%a(2,2)=fcl(id5)*(auxa-ceps_0)
      lf5_612(2)%b(1,2)=-fcl(id5)*p612k0
      lf5_612(2)%b(2,1)=fcr(id5)*p612k0
      lf5_612(2)%c(1,2)=fcr(id5)*p5k0
      lf5_612(2)%c(2,1)=-fcl(id5)*p5k0
* T -- qu=p5,qd=p612,v=3,a=lf5_612(3)%a,b=lf5_612(3)%b,c=lf5_612(3)%c,d=
* lf5_612(3)%d,cr=fcr(id5),cl=fcl(id5),nsum=0
      eps_0=p5k0*p612(2)-p612k0*p5(2)
      ceps_0=eps_0*cim
      ceps_1=p5k0*cim
      ceps_2=p612k0*cim
      auxa=+p5k0*p612(3)+p612k0*p5(3)
      lf5_612(3)%a(1,1)=fcr(id5)*(auxa+ceps_0)
      lf5_612(3)%a(2,2)=fcl(id5)*(auxa-ceps_0)
      lf5_612(3)%b(1,2)=-fcl(id5)*ceps_2
      lf5_612(3)%b(2,1)=-fcr(id5)*ceps_2
      lf5_612(3)%c(1,2)=fcr(id5)*ceps_1
      lf5_612(3)%c(2,1)=fcl(id5)*ceps_1
  
      else
        do mu=0,3
          lf5_612(mu)%a(1,1) = czero
          lf5_612(mu)%a(2,2) = czero
          lf5_612(mu)%b(1,2) = czero
          lf5_612(mu)%b(2,1) = czero
          lf5_612(mu)%c(1,2) = czero
          lf5_612(mu)%c(2,1) = czero
          lf5_612(mu)%d(1,1) = czero
          lf5_612(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p5,q=p634
      quqd=p5(0)*p634(0)-p5(1)*p634(1)-p5(2)*p634(2)-p5(3)*p634(
     & 3)
* T -- qu=p5,qd=p634,v=0,a=lz5_634(0)%a,b=lz5_634(0)%b,c=lz5_634(0)%c,d=
* lz5_634(0)%d,cr=zcr(id5),cl=zcl(id5),nsum=0
      eps_0=-p5(2)*p634(3)+p634(2)*p5(3)
      ceps_0=eps_0*cim
      ceps_1=p5(3)*cim
      ceps_2=p634(3)*cim
      auxa=-quqd+p5k0*p634(0)+p634k0*p5(0)
      lz5_634(0)%a(1,1)=zcr(id5)*(auxa+ceps_0)
      lz5_634(0)%a(2,2)=zcl(id5)*(auxa-ceps_0)
      lz5_634(0)%b(1,2)=-zcl(id5)*(p634(2)+ceps_2)
      lz5_634(0)%b(2,1)=zcr(id5)*(p634(2)-ceps_2)
      lz5_634(0)%c(1,2)=zcr(id5)*(p5(2)+ceps_1)
      lz5_634(0)%c(2,1)=zcl(id5)*(-p5(2)+ceps_1)
      lz5_634(0)%d(1,1)=zcl(id5)
      lz5_634(0)%d(2,2)=zcr(id5)
* T -- qu=p5,qd=p634,v=1,a=lz5_634(1)%a,b=lz5_634(1)%b,c=lz5_634(1)%c,d=
* lz5_634(1)%d,cr=zcr(id5),cl=zcl(id5),nsum=0
      auxa=-quqd+p5k0*p634(1)+p634k0*p5(1)
      lz5_634(1)%a(1,1)=zcr(id5)*(auxa+ceps_0)
      lz5_634(1)%a(2,2)=zcl(id5)*(auxa-ceps_0)
      lz5_634(1)%b(1,2)=-zcl(id5)*(p634(2)+ceps_2)
      lz5_634(1)%b(2,1)=zcr(id5)*(p634(2)-ceps_2)
      lz5_634(1)%c(1,2)=zcr(id5)*(p5(2)+ceps_1)
      lz5_634(1)%c(2,1)=zcl(id5)*(-p5(2)+ceps_1)
      lz5_634(1)%d(1,1)=zcl(id5)
      lz5_634(1)%d(2,2)=zcr(id5)
* T -- qu=p5,qd=p634,v=2,a=lz5_634(2)%a,b=lz5_634(2)%b,c=lz5_634(2)%c,d=
* lz5_634(2)%d,cr=zcr(id5),cl=zcl(id5),nsum=0
      eps_0=-p5k0*p634(3)+p634k0*p5(3)
      ceps_0=eps_0*cim
      auxa=p5k0*p634(2)+p634k0*p5(2)
      lz5_634(2)%a(1,1)=zcr(id5)*(auxa+ceps_0)
      lz5_634(2)%a(2,2)=zcl(id5)*(auxa-ceps_0)
      lz5_634(2)%b(1,2)=-zcl(id5)*p634k0
      lz5_634(2)%b(2,1)=zcr(id5)*p634k0
      lz5_634(2)%c(1,2)=zcr(id5)*p5k0
      lz5_634(2)%c(2,1)=-zcl(id5)*p5k0
* T -- qu=p5,qd=p634,v=3,a=lz5_634(3)%a,b=lz5_634(3)%b,c=lz5_634(3)%c,d=
* lz5_634(3)%d,cr=zcr(id5),cl=zcl(id5),nsum=0
      eps_0=p5k0*p634(2)-p634k0*p5(2)
      ceps_0=eps_0*cim
      ceps_1=p5k0*cim
      ceps_2=p634k0*cim
      auxa=+p5k0*p634(3)+p634k0*p5(3)
      lz5_634(3)%a(1,1)=zcr(id5)*(auxa+ceps_0)
      lz5_634(3)%a(2,2)=zcl(id5)*(auxa-ceps_0)
      lz5_634(3)%b(1,2)=-zcl(id5)*ceps_2
      lz5_634(3)%b(2,1)=-zcr(id5)*ceps_2
      lz5_634(3)%c(1,2)=zcr(id5)*ceps_1
      lz5_634(3)%c(2,1)=zcl(id5)*ceps_1
  
  
      if(ineutri(id5).ne.1) then
* T -- qu=p5,qd=p634,v=0,a=lf5_634(0)%a,b=lf5_634(0)%b,c=lf5_634(0)%c,d=
* lf5_634(0)%d,cr=fcr(id5),cl=fcl(id5),nsum=0
      eps_0=-p5(2)*p634(3)+p634(2)*p5(3)
      ceps_0=eps_0*cim
      ceps_1=p5(3)*cim
      ceps_2=p634(3)*cim
      auxa=-quqd+p5k0*p634(0)+p634k0*p5(0)
      lf5_634(0)%a(1,1)=fcr(id5)*(auxa+ceps_0)
      lf5_634(0)%a(2,2)=fcl(id5)*(auxa-ceps_0)
      lf5_634(0)%b(1,2)=-fcl(id5)*(p634(2)+ceps_2)
      lf5_634(0)%b(2,1)=fcr(id5)*(p634(2)-ceps_2)
      lf5_634(0)%c(1,2)=fcr(id5)*(p5(2)+ceps_1)
      lf5_634(0)%c(2,1)=fcl(id5)*(-p5(2)+ceps_1)
      lf5_634(0)%d(1,1)=fcl(id5)
      lf5_634(0)%d(2,2)=fcr(id5)
* T -- qu=p5,qd=p634,v=1,a=lf5_634(1)%a,b=lf5_634(1)%b,c=lf5_634(1)%c,d=
* lf5_634(1)%d,cr=fcr(id5),cl=fcl(id5),nsum=0
      auxa=-quqd+p5k0*p634(1)+p634k0*p5(1)
      lf5_634(1)%a(1,1)=fcr(id5)*(auxa+ceps_0)
      lf5_634(1)%a(2,2)=fcl(id5)*(auxa-ceps_0)
      lf5_634(1)%b(1,2)=-fcl(id5)*(p634(2)+ceps_2)
      lf5_634(1)%b(2,1)=fcr(id5)*(p634(2)-ceps_2)
      lf5_634(1)%c(1,2)=fcr(id5)*(p5(2)+ceps_1)
      lf5_634(1)%c(2,1)=fcl(id5)*(-p5(2)+ceps_1)
      lf5_634(1)%d(1,1)=fcl(id5)
      lf5_634(1)%d(2,2)=fcr(id5)
* T -- qu=p5,qd=p634,v=2,a=lf5_634(2)%a,b=lf5_634(2)%b,c=lf5_634(2)%c,d=
* lf5_634(2)%d,cr=fcr(id5),cl=fcl(id5),nsum=0
      eps_0=-p5k0*p634(3)+p634k0*p5(3)
      ceps_0=eps_0*cim
      auxa=p5k0*p634(2)+p634k0*p5(2)
      lf5_634(2)%a(1,1)=fcr(id5)*(auxa+ceps_0)
      lf5_634(2)%a(2,2)=fcl(id5)*(auxa-ceps_0)
      lf5_634(2)%b(1,2)=-fcl(id5)*p634k0
      lf5_634(2)%b(2,1)=fcr(id5)*p634k0
      lf5_634(2)%c(1,2)=fcr(id5)*p5k0
      lf5_634(2)%c(2,1)=-fcl(id5)*p5k0
* T -- qu=p5,qd=p634,v=3,a=lf5_634(3)%a,b=lf5_634(3)%b,c=lf5_634(3)%c,d=
* lf5_634(3)%d,cr=fcr(id5),cl=fcl(id5),nsum=0
      eps_0=p5k0*p634(2)-p634k0*p5(2)
      ceps_0=eps_0*cim
      ceps_1=p5k0*cim
      ceps_2=p634k0*cim
      auxa=+p5k0*p634(3)+p634k0*p5(3)
      lf5_634(3)%a(1,1)=fcr(id5)*(auxa+ceps_0)
      lf5_634(3)%a(2,2)=fcl(id5)*(auxa-ceps_0)
      lf5_634(3)%b(1,2)=-fcl(id5)*ceps_2
      lf5_634(3)%b(2,1)=-fcr(id5)*ceps_2
      lf5_634(3)%c(1,2)=fcr(id5)*ceps_1
      lf5_634(3)%c(2,1)=fcl(id5)*ceps_1
  
      else
        do mu=0,3
          lf5_634(mu)%a(1,1) = czero
          lf5_634(mu)%a(2,2) = czero
          lf5_634(mu)%b(1,2) = czero
          lf5_634(mu)%b(2,1) = czero
          lf5_634(mu)%c(1,2) = czero
          lf5_634(mu)%c(2,1) = czero
          lf5_634(mu)%d(1,1) = czero
          lf5_634(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p5,q=p678
      quqd=p5(0)*p678(0)-p5(1)*p678(1)-p5(2)*p678(2)-p5(3)*p678(
     & 3)
* T -- qu=p5,qd=p678,v=0,a=lz5_678(0)%a,b=lz5_678(0)%b,c=lz5_678(0)%c,d=
* lz5_678(0)%d,cr=zcr(id5),cl=zcl(id5),nsum=0
      eps_0=-p5(2)*p678(3)+p678(2)*p5(3)
      ceps_0=eps_0*cim
      ceps_1=p5(3)*cim
      ceps_2=p678(3)*cim
      auxa=-quqd+p5k0*p678(0)+p678k0*p5(0)
      lz5_678(0)%a(1,1)=zcr(id5)*(auxa+ceps_0)
      lz5_678(0)%a(2,2)=zcl(id5)*(auxa-ceps_0)
      lz5_678(0)%b(1,2)=-zcl(id5)*(p678(2)+ceps_2)
      lz5_678(0)%b(2,1)=zcr(id5)*(p678(2)-ceps_2)
      lz5_678(0)%c(1,2)=zcr(id5)*(p5(2)+ceps_1)
      lz5_678(0)%c(2,1)=zcl(id5)*(-p5(2)+ceps_1)
      lz5_678(0)%d(1,1)=zcl(id5)
      lz5_678(0)%d(2,2)=zcr(id5)
* T -- qu=p5,qd=p678,v=1,a=lz5_678(1)%a,b=lz5_678(1)%b,c=lz5_678(1)%c,d=
* lz5_678(1)%d,cr=zcr(id5),cl=zcl(id5),nsum=0
      auxa=-quqd+p5k0*p678(1)+p678k0*p5(1)
      lz5_678(1)%a(1,1)=zcr(id5)*(auxa+ceps_0)
      lz5_678(1)%a(2,2)=zcl(id5)*(auxa-ceps_0)
      lz5_678(1)%b(1,2)=-zcl(id5)*(p678(2)+ceps_2)
      lz5_678(1)%b(2,1)=zcr(id5)*(p678(2)-ceps_2)
      lz5_678(1)%c(1,2)=zcr(id5)*(p5(2)+ceps_1)
      lz5_678(1)%c(2,1)=zcl(id5)*(-p5(2)+ceps_1)
      lz5_678(1)%d(1,1)=zcl(id5)
      lz5_678(1)%d(2,2)=zcr(id5)
* T -- qu=p5,qd=p678,v=2,a=lz5_678(2)%a,b=lz5_678(2)%b,c=lz5_678(2)%c,d=
* lz5_678(2)%d,cr=zcr(id5),cl=zcl(id5),nsum=0
      eps_0=-p5k0*p678(3)+p678k0*p5(3)
      ceps_0=eps_0*cim
      auxa=p5k0*p678(2)+p678k0*p5(2)
      lz5_678(2)%a(1,1)=zcr(id5)*(auxa+ceps_0)
      lz5_678(2)%a(2,2)=zcl(id5)*(auxa-ceps_0)
      lz5_678(2)%b(1,2)=-zcl(id5)*p678k0
      lz5_678(2)%b(2,1)=zcr(id5)*p678k0
      lz5_678(2)%c(1,2)=zcr(id5)*p5k0
      lz5_678(2)%c(2,1)=-zcl(id5)*p5k0
* T -- qu=p5,qd=p678,v=3,a=lz5_678(3)%a,b=lz5_678(3)%b,c=lz5_678(3)%c,d=
* lz5_678(3)%d,cr=zcr(id5),cl=zcl(id5),nsum=0
      eps_0=p5k0*p678(2)-p678k0*p5(2)
      ceps_0=eps_0*cim
      ceps_1=p5k0*cim
      ceps_2=p678k0*cim
      auxa=+p5k0*p678(3)+p678k0*p5(3)
      lz5_678(3)%a(1,1)=zcr(id5)*(auxa+ceps_0)
      lz5_678(3)%a(2,2)=zcl(id5)*(auxa-ceps_0)
      lz5_678(3)%b(1,2)=-zcl(id5)*ceps_2
      lz5_678(3)%b(2,1)=-zcr(id5)*ceps_2
      lz5_678(3)%c(1,2)=zcr(id5)*ceps_1
      lz5_678(3)%c(2,1)=zcl(id5)*ceps_1
  
  
      if(ineutri(id5).ne.1) then
* T -- qu=p5,qd=p678,v=0,a=lf5_678(0)%a,b=lf5_678(0)%b,c=lf5_678(0)%c,d=
* lf5_678(0)%d,cr=fcr(id5),cl=fcl(id5),nsum=0
      eps_0=-p5(2)*p678(3)+p678(2)*p5(3)
      ceps_0=eps_0*cim
      ceps_1=p5(3)*cim
      ceps_2=p678(3)*cim
      auxa=-quqd+p5k0*p678(0)+p678k0*p5(0)
      lf5_678(0)%a(1,1)=fcr(id5)*(auxa+ceps_0)
      lf5_678(0)%a(2,2)=fcl(id5)*(auxa-ceps_0)
      lf5_678(0)%b(1,2)=-fcl(id5)*(p678(2)+ceps_2)
      lf5_678(0)%b(2,1)=fcr(id5)*(p678(2)-ceps_2)
      lf5_678(0)%c(1,2)=fcr(id5)*(p5(2)+ceps_1)
      lf5_678(0)%c(2,1)=fcl(id5)*(-p5(2)+ceps_1)
      lf5_678(0)%d(1,1)=fcl(id5)
      lf5_678(0)%d(2,2)=fcr(id5)
* T -- qu=p5,qd=p678,v=1,a=lf5_678(1)%a,b=lf5_678(1)%b,c=lf5_678(1)%c,d=
* lf5_678(1)%d,cr=fcr(id5),cl=fcl(id5),nsum=0
      auxa=-quqd+p5k0*p678(1)+p678k0*p5(1)
      lf5_678(1)%a(1,1)=fcr(id5)*(auxa+ceps_0)
      lf5_678(1)%a(2,2)=fcl(id5)*(auxa-ceps_0)
      lf5_678(1)%b(1,2)=-fcl(id5)*(p678(2)+ceps_2)
      lf5_678(1)%b(2,1)=fcr(id5)*(p678(2)-ceps_2)
      lf5_678(1)%c(1,2)=fcr(id5)*(p5(2)+ceps_1)
      lf5_678(1)%c(2,1)=fcl(id5)*(-p5(2)+ceps_1)
      lf5_678(1)%d(1,1)=fcl(id5)
      lf5_678(1)%d(2,2)=fcr(id5)
* T -- qu=p5,qd=p678,v=2,a=lf5_678(2)%a,b=lf5_678(2)%b,c=lf5_678(2)%c,d=
* lf5_678(2)%d,cr=fcr(id5),cl=fcl(id5),nsum=0
      eps_0=-p5k0*p678(3)+p678k0*p5(3)
      ceps_0=eps_0*cim
      auxa=p5k0*p678(2)+p678k0*p5(2)
      lf5_678(2)%a(1,1)=fcr(id5)*(auxa+ceps_0)
      lf5_678(2)%a(2,2)=fcl(id5)*(auxa-ceps_0)
      lf5_678(2)%b(1,2)=-fcl(id5)*p678k0
      lf5_678(2)%b(2,1)=fcr(id5)*p678k0
      lf5_678(2)%c(1,2)=fcr(id5)*p5k0
      lf5_678(2)%c(2,1)=-fcl(id5)*p5k0
* T -- qu=p5,qd=p678,v=3,a=lf5_678(3)%a,b=lf5_678(3)%b,c=lf5_678(3)%c,d=
* lf5_678(3)%d,cr=fcr(id5),cl=fcl(id5),nsum=0
      eps_0=p5k0*p678(2)-p678k0*p5(2)
      ceps_0=eps_0*cim
      ceps_1=p5k0*cim
      ceps_2=p678k0*cim
      auxa=+p5k0*p678(3)+p678k0*p5(3)
      lf5_678(3)%a(1,1)=fcr(id5)*(auxa+ceps_0)
      lf5_678(3)%a(2,2)=fcl(id5)*(auxa-ceps_0)
      lf5_678(3)%b(1,2)=-fcl(id5)*ceps_2
      lf5_678(3)%b(2,1)=-fcr(id5)*ceps_2
      lf5_678(3)%c(1,2)=fcr(id5)*ceps_1
      lf5_678(3)%c(2,1)=fcl(id5)*ceps_1
  
      else
        do mu=0,3
          lf5_678(mu)%a(1,1) = czero
          lf5_678(mu)%a(2,2) = czero
          lf5_678(mu)%b(1,2) = czero
          lf5_678(mu)%b(2,1) = czero
          lf5_678(mu)%c(1,2) = czero
          lf5_678(mu)%c(2,1) = czero
          lf5_678(mu)%d(1,1) = czero
          lf5_678(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p7,q=p812
      quqd=p7(0)*p812(0)-p7(1)*p812(1)-p7(2)*p812(2)-p7(3)*p812(
     & 3)
* T -- qu=p7,qd=p812,v=0,a=lz7_812(0)%a,b=lz7_812(0)%b,c=lz7_812(0)%c,d=
* lz7_812(0)%d,cr=zcr(id7),cl=zcl(id7),nsum=0
      eps_0=-p7(2)*p812(3)+p812(2)*p7(3)
      ceps_0=eps_0*cim
      ceps_1=p7(3)*cim
      ceps_2=p812(3)*cim
      auxa=-quqd+p7k0*p812(0)+p812k0*p7(0)
      lz7_812(0)%a(1,1)=zcr(id7)*(auxa+ceps_0)
      lz7_812(0)%a(2,2)=zcl(id7)*(auxa-ceps_0)
      lz7_812(0)%b(1,2)=-zcl(id7)*(p812(2)+ceps_2)
      lz7_812(0)%b(2,1)=zcr(id7)*(p812(2)-ceps_2)
      lz7_812(0)%c(1,2)=zcr(id7)*(p7(2)+ceps_1)
      lz7_812(0)%c(2,1)=zcl(id7)*(-p7(2)+ceps_1)
      lz7_812(0)%d(1,1)=zcl(id7)
      lz7_812(0)%d(2,2)=zcr(id7)
* T -- qu=p7,qd=p812,v=1,a=lz7_812(1)%a,b=lz7_812(1)%b,c=lz7_812(1)%c,d=
* lz7_812(1)%d,cr=zcr(id7),cl=zcl(id7),nsum=0
      auxa=-quqd+p7k0*p812(1)+p812k0*p7(1)
      lz7_812(1)%a(1,1)=zcr(id7)*(auxa+ceps_0)
      lz7_812(1)%a(2,2)=zcl(id7)*(auxa-ceps_0)
      lz7_812(1)%b(1,2)=-zcl(id7)*(p812(2)+ceps_2)
      lz7_812(1)%b(2,1)=zcr(id7)*(p812(2)-ceps_2)
      lz7_812(1)%c(1,2)=zcr(id7)*(p7(2)+ceps_1)
      lz7_812(1)%c(2,1)=zcl(id7)*(-p7(2)+ceps_1)
      lz7_812(1)%d(1,1)=zcl(id7)
      lz7_812(1)%d(2,2)=zcr(id7)
* T -- qu=p7,qd=p812,v=2,a=lz7_812(2)%a,b=lz7_812(2)%b,c=lz7_812(2)%c,d=
* lz7_812(2)%d,cr=zcr(id7),cl=zcl(id7),nsum=0
      eps_0=-p7k0*p812(3)+p812k0*p7(3)
      ceps_0=eps_0*cim
      auxa=p7k0*p812(2)+p812k0*p7(2)
      lz7_812(2)%a(1,1)=zcr(id7)*(auxa+ceps_0)
      lz7_812(2)%a(2,2)=zcl(id7)*(auxa-ceps_0)
      lz7_812(2)%b(1,2)=-zcl(id7)*p812k0
      lz7_812(2)%b(2,1)=zcr(id7)*p812k0
      lz7_812(2)%c(1,2)=zcr(id7)*p7k0
      lz7_812(2)%c(2,1)=-zcl(id7)*p7k0
* T -- qu=p7,qd=p812,v=3,a=lz7_812(3)%a,b=lz7_812(3)%b,c=lz7_812(3)%c,d=
* lz7_812(3)%d,cr=zcr(id7),cl=zcl(id7),nsum=0
      eps_0=p7k0*p812(2)-p812k0*p7(2)
      ceps_0=eps_0*cim
      ceps_1=p7k0*cim
      ceps_2=p812k0*cim
      auxa=+p7k0*p812(3)+p812k0*p7(3)
      lz7_812(3)%a(1,1)=zcr(id7)*(auxa+ceps_0)
      lz7_812(3)%a(2,2)=zcl(id7)*(auxa-ceps_0)
      lz7_812(3)%b(1,2)=-zcl(id7)*ceps_2
      lz7_812(3)%b(2,1)=-zcr(id7)*ceps_2
      lz7_812(3)%c(1,2)=zcr(id7)*ceps_1
      lz7_812(3)%c(2,1)=zcl(id7)*ceps_1
  
  
      if(ineutri(id7).ne.1) then
* T -- qu=p7,qd=p812,v=0,a=lf7_812(0)%a,b=lf7_812(0)%b,c=lf7_812(0)%c,d=
* lf7_812(0)%d,cr=fcr(id7),cl=fcl(id7),nsum=0
      eps_0=-p7(2)*p812(3)+p812(2)*p7(3)
      ceps_0=eps_0*cim
      ceps_1=p7(3)*cim
      ceps_2=p812(3)*cim
      auxa=-quqd+p7k0*p812(0)+p812k0*p7(0)
      lf7_812(0)%a(1,1)=fcr(id7)*(auxa+ceps_0)
      lf7_812(0)%a(2,2)=fcl(id7)*(auxa-ceps_0)
      lf7_812(0)%b(1,2)=-fcl(id7)*(p812(2)+ceps_2)
      lf7_812(0)%b(2,1)=fcr(id7)*(p812(2)-ceps_2)
      lf7_812(0)%c(1,2)=fcr(id7)*(p7(2)+ceps_1)
      lf7_812(0)%c(2,1)=fcl(id7)*(-p7(2)+ceps_1)
      lf7_812(0)%d(1,1)=fcl(id7)
      lf7_812(0)%d(2,2)=fcr(id7)
* T -- qu=p7,qd=p812,v=1,a=lf7_812(1)%a,b=lf7_812(1)%b,c=lf7_812(1)%c,d=
* lf7_812(1)%d,cr=fcr(id7),cl=fcl(id7),nsum=0
      auxa=-quqd+p7k0*p812(1)+p812k0*p7(1)
      lf7_812(1)%a(1,1)=fcr(id7)*(auxa+ceps_0)
      lf7_812(1)%a(2,2)=fcl(id7)*(auxa-ceps_0)
      lf7_812(1)%b(1,2)=-fcl(id7)*(p812(2)+ceps_2)
      lf7_812(1)%b(2,1)=fcr(id7)*(p812(2)-ceps_2)
      lf7_812(1)%c(1,2)=fcr(id7)*(p7(2)+ceps_1)
      lf7_812(1)%c(2,1)=fcl(id7)*(-p7(2)+ceps_1)
      lf7_812(1)%d(1,1)=fcl(id7)
      lf7_812(1)%d(2,2)=fcr(id7)
* T -- qu=p7,qd=p812,v=2,a=lf7_812(2)%a,b=lf7_812(2)%b,c=lf7_812(2)%c,d=
* lf7_812(2)%d,cr=fcr(id7),cl=fcl(id7),nsum=0
      eps_0=-p7k0*p812(3)+p812k0*p7(3)
      ceps_0=eps_0*cim
      auxa=p7k0*p812(2)+p812k0*p7(2)
      lf7_812(2)%a(1,1)=fcr(id7)*(auxa+ceps_0)
      lf7_812(2)%a(2,2)=fcl(id7)*(auxa-ceps_0)
      lf7_812(2)%b(1,2)=-fcl(id7)*p812k0
      lf7_812(2)%b(2,1)=fcr(id7)*p812k0
      lf7_812(2)%c(1,2)=fcr(id7)*p7k0
      lf7_812(2)%c(2,1)=-fcl(id7)*p7k0
* T -- qu=p7,qd=p812,v=3,a=lf7_812(3)%a,b=lf7_812(3)%b,c=lf7_812(3)%c,d=
* lf7_812(3)%d,cr=fcr(id7),cl=fcl(id7),nsum=0
      eps_0=p7k0*p812(2)-p812k0*p7(2)
      ceps_0=eps_0*cim
      ceps_1=p7k0*cim
      ceps_2=p812k0*cim
      auxa=+p7k0*p812(3)+p812k0*p7(3)
      lf7_812(3)%a(1,1)=fcr(id7)*(auxa+ceps_0)
      lf7_812(3)%a(2,2)=fcl(id7)*(auxa-ceps_0)
      lf7_812(3)%b(1,2)=-fcl(id7)*ceps_2
      lf7_812(3)%b(2,1)=-fcr(id7)*ceps_2
      lf7_812(3)%c(1,2)=fcr(id7)*ceps_1
      lf7_812(3)%c(2,1)=fcl(id7)*ceps_1
  
      else
        do mu=0,3
          lf7_812(mu)%a(1,1) = czero
          lf7_812(mu)%a(2,2) = czero
          lf7_812(mu)%b(1,2) = czero
          lf7_812(mu)%b(2,1) = czero
          lf7_812(mu)%c(1,2) = czero
          lf7_812(mu)%c(2,1) = czero
          lf7_812(mu)%d(1,1) = czero
          lf7_812(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p7,q=p834
      quqd=p7(0)*p834(0)-p7(1)*p834(1)-p7(2)*p834(2)-p7(3)*p834(
     & 3)
* T -- qu=p7,qd=p834,v=0,a=lz7_834(0)%a,b=lz7_834(0)%b,c=lz7_834(0)%c,d=
* lz7_834(0)%d,cr=zcr(id7),cl=zcl(id7),nsum=0
      eps_0=-p7(2)*p834(3)+p834(2)*p7(3)
      ceps_0=eps_0*cim
      ceps_1=p7(3)*cim
      ceps_2=p834(3)*cim
      auxa=-quqd+p7k0*p834(0)+p834k0*p7(0)
      lz7_834(0)%a(1,1)=zcr(id7)*(auxa+ceps_0)
      lz7_834(0)%a(2,2)=zcl(id7)*(auxa-ceps_0)
      lz7_834(0)%b(1,2)=-zcl(id7)*(p834(2)+ceps_2)
      lz7_834(0)%b(2,1)=zcr(id7)*(p834(2)-ceps_2)
      lz7_834(0)%c(1,2)=zcr(id7)*(p7(2)+ceps_1)
      lz7_834(0)%c(2,1)=zcl(id7)*(-p7(2)+ceps_1)
      lz7_834(0)%d(1,1)=zcl(id7)
      lz7_834(0)%d(2,2)=zcr(id7)
* T -- qu=p7,qd=p834,v=1,a=lz7_834(1)%a,b=lz7_834(1)%b,c=lz7_834(1)%c,d=
* lz7_834(1)%d,cr=zcr(id7),cl=zcl(id7),nsum=0
      auxa=-quqd+p7k0*p834(1)+p834k0*p7(1)
      lz7_834(1)%a(1,1)=zcr(id7)*(auxa+ceps_0)
      lz7_834(1)%a(2,2)=zcl(id7)*(auxa-ceps_0)
      lz7_834(1)%b(1,2)=-zcl(id7)*(p834(2)+ceps_2)
      lz7_834(1)%b(2,1)=zcr(id7)*(p834(2)-ceps_2)
      lz7_834(1)%c(1,2)=zcr(id7)*(p7(2)+ceps_1)
      lz7_834(1)%c(2,1)=zcl(id7)*(-p7(2)+ceps_1)
      lz7_834(1)%d(1,1)=zcl(id7)
      lz7_834(1)%d(2,2)=zcr(id7)
* T -- qu=p7,qd=p834,v=2,a=lz7_834(2)%a,b=lz7_834(2)%b,c=lz7_834(2)%c,d=
* lz7_834(2)%d,cr=zcr(id7),cl=zcl(id7),nsum=0
      eps_0=-p7k0*p834(3)+p834k0*p7(3)
      ceps_0=eps_0*cim
      auxa=p7k0*p834(2)+p834k0*p7(2)
      lz7_834(2)%a(1,1)=zcr(id7)*(auxa+ceps_0)
      lz7_834(2)%a(2,2)=zcl(id7)*(auxa-ceps_0)
      lz7_834(2)%b(1,2)=-zcl(id7)*p834k0
      lz7_834(2)%b(2,1)=zcr(id7)*p834k0
      lz7_834(2)%c(1,2)=zcr(id7)*p7k0
      lz7_834(2)%c(2,1)=-zcl(id7)*p7k0
* T -- qu=p7,qd=p834,v=3,a=lz7_834(3)%a,b=lz7_834(3)%b,c=lz7_834(3)%c,d=
* lz7_834(3)%d,cr=zcr(id7),cl=zcl(id7),nsum=0
      eps_0=p7k0*p834(2)-p834k0*p7(2)
      ceps_0=eps_0*cim
      ceps_1=p7k0*cim
      ceps_2=p834k0*cim
      auxa=+p7k0*p834(3)+p834k0*p7(3)
      lz7_834(3)%a(1,1)=zcr(id7)*(auxa+ceps_0)
      lz7_834(3)%a(2,2)=zcl(id7)*(auxa-ceps_0)
      lz7_834(3)%b(1,2)=-zcl(id7)*ceps_2
      lz7_834(3)%b(2,1)=-zcr(id7)*ceps_2
      lz7_834(3)%c(1,2)=zcr(id7)*ceps_1
      lz7_834(3)%c(2,1)=zcl(id7)*ceps_1
  
  
      if(ineutri(id7).ne.1) then
* T -- qu=p7,qd=p834,v=0,a=lf7_834(0)%a,b=lf7_834(0)%b,c=lf7_834(0)%c,d=
* lf7_834(0)%d,cr=fcr(id7),cl=fcl(id7),nsum=0
      eps_0=-p7(2)*p834(3)+p834(2)*p7(3)
      ceps_0=eps_0*cim
      ceps_1=p7(3)*cim
      ceps_2=p834(3)*cim
      auxa=-quqd+p7k0*p834(0)+p834k0*p7(0)
      lf7_834(0)%a(1,1)=fcr(id7)*(auxa+ceps_0)
      lf7_834(0)%a(2,2)=fcl(id7)*(auxa-ceps_0)
      lf7_834(0)%b(1,2)=-fcl(id7)*(p834(2)+ceps_2)
      lf7_834(0)%b(2,1)=fcr(id7)*(p834(2)-ceps_2)
      lf7_834(0)%c(1,2)=fcr(id7)*(p7(2)+ceps_1)
      lf7_834(0)%c(2,1)=fcl(id7)*(-p7(2)+ceps_1)
      lf7_834(0)%d(1,1)=fcl(id7)
      lf7_834(0)%d(2,2)=fcr(id7)
* T -- qu=p7,qd=p834,v=1,a=lf7_834(1)%a,b=lf7_834(1)%b,c=lf7_834(1)%c,d=
* lf7_834(1)%d,cr=fcr(id7),cl=fcl(id7),nsum=0
      auxa=-quqd+p7k0*p834(1)+p834k0*p7(1)
      lf7_834(1)%a(1,1)=fcr(id7)*(auxa+ceps_0)
      lf7_834(1)%a(2,2)=fcl(id7)*(auxa-ceps_0)
      lf7_834(1)%b(1,2)=-fcl(id7)*(p834(2)+ceps_2)
      lf7_834(1)%b(2,1)=fcr(id7)*(p834(2)-ceps_2)
      lf7_834(1)%c(1,2)=fcr(id7)*(p7(2)+ceps_1)
      lf7_834(1)%c(2,1)=fcl(id7)*(-p7(2)+ceps_1)
      lf7_834(1)%d(1,1)=fcl(id7)
      lf7_834(1)%d(2,2)=fcr(id7)
* T -- qu=p7,qd=p834,v=2,a=lf7_834(2)%a,b=lf7_834(2)%b,c=lf7_834(2)%c,d=
* lf7_834(2)%d,cr=fcr(id7),cl=fcl(id7),nsum=0
      eps_0=-p7k0*p834(3)+p834k0*p7(3)
      ceps_0=eps_0*cim
      auxa=p7k0*p834(2)+p834k0*p7(2)
      lf7_834(2)%a(1,1)=fcr(id7)*(auxa+ceps_0)
      lf7_834(2)%a(2,2)=fcl(id7)*(auxa-ceps_0)
      lf7_834(2)%b(1,2)=-fcl(id7)*p834k0
      lf7_834(2)%b(2,1)=fcr(id7)*p834k0
      lf7_834(2)%c(1,2)=fcr(id7)*p7k0
      lf7_834(2)%c(2,1)=-fcl(id7)*p7k0
* T -- qu=p7,qd=p834,v=3,a=lf7_834(3)%a,b=lf7_834(3)%b,c=lf7_834(3)%c,d=
* lf7_834(3)%d,cr=fcr(id7),cl=fcl(id7),nsum=0
      eps_0=p7k0*p834(2)-p834k0*p7(2)
      ceps_0=eps_0*cim
      ceps_1=p7k0*cim
      ceps_2=p834k0*cim
      auxa=+p7k0*p834(3)+p834k0*p7(3)
      lf7_834(3)%a(1,1)=fcr(id7)*(auxa+ceps_0)
      lf7_834(3)%a(2,2)=fcl(id7)*(auxa-ceps_0)
      lf7_834(3)%b(1,2)=-fcl(id7)*ceps_2
      lf7_834(3)%b(2,1)=-fcr(id7)*ceps_2
      lf7_834(3)%c(1,2)=fcr(id7)*ceps_1
      lf7_834(3)%c(2,1)=fcl(id7)*ceps_1
  
      else
        do mu=0,3
          lf7_834(mu)%a(1,1) = czero
          lf7_834(mu)%a(2,2) = czero
          lf7_834(mu)%b(1,2) = czero
          lf7_834(mu)%b(2,1) = czero
          lf7_834(mu)%c(1,2) = czero
          lf7_834(mu)%c(2,1) = czero
          lf7_834(mu)%d(1,1) = czero
          lf7_834(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p7,q=p856
      quqd=p7(0)*p856(0)-p7(1)*p856(1)-p7(2)*p856(2)-p7(3)*p856(
     & 3)
* T -- qu=p7,qd=p856,v=0,a=lz7_856(0)%a,b=lz7_856(0)%b,c=lz7_856(0)%c,d=
* lz7_856(0)%d,cr=zcr(id7),cl=zcl(id7),nsum=0
      eps_0=-p7(2)*p856(3)+p856(2)*p7(3)
      ceps_0=eps_0*cim
      ceps_1=p7(3)*cim
      ceps_2=p856(3)*cim
      auxa=-quqd+p7k0*p856(0)+p856k0*p7(0)
      lz7_856(0)%a(1,1)=zcr(id7)*(auxa+ceps_0)
      lz7_856(0)%a(2,2)=zcl(id7)*(auxa-ceps_0)
      lz7_856(0)%b(1,2)=-zcl(id7)*(p856(2)+ceps_2)
      lz7_856(0)%b(2,1)=zcr(id7)*(p856(2)-ceps_2)
      lz7_856(0)%c(1,2)=zcr(id7)*(p7(2)+ceps_1)
      lz7_856(0)%c(2,1)=zcl(id7)*(-p7(2)+ceps_1)
      lz7_856(0)%d(1,1)=zcl(id7)
      lz7_856(0)%d(2,2)=zcr(id7)
* T -- qu=p7,qd=p856,v=1,a=lz7_856(1)%a,b=lz7_856(1)%b,c=lz7_856(1)%c,d=
* lz7_856(1)%d,cr=zcr(id7),cl=zcl(id7),nsum=0
      auxa=-quqd+p7k0*p856(1)+p856k0*p7(1)
      lz7_856(1)%a(1,1)=zcr(id7)*(auxa+ceps_0)
      lz7_856(1)%a(2,2)=zcl(id7)*(auxa-ceps_0)
      lz7_856(1)%b(1,2)=-zcl(id7)*(p856(2)+ceps_2)
      lz7_856(1)%b(2,1)=zcr(id7)*(p856(2)-ceps_2)
      lz7_856(1)%c(1,2)=zcr(id7)*(p7(2)+ceps_1)
      lz7_856(1)%c(2,1)=zcl(id7)*(-p7(2)+ceps_1)
      lz7_856(1)%d(1,1)=zcl(id7)
      lz7_856(1)%d(2,2)=zcr(id7)
* T -- qu=p7,qd=p856,v=2,a=lz7_856(2)%a,b=lz7_856(2)%b,c=lz7_856(2)%c,d=
* lz7_856(2)%d,cr=zcr(id7),cl=zcl(id7),nsum=0
      eps_0=-p7k0*p856(3)+p856k0*p7(3)
      ceps_0=eps_0*cim
      auxa=p7k0*p856(2)+p856k0*p7(2)
      lz7_856(2)%a(1,1)=zcr(id7)*(auxa+ceps_0)
      lz7_856(2)%a(2,2)=zcl(id7)*(auxa-ceps_0)
      lz7_856(2)%b(1,2)=-zcl(id7)*p856k0
      lz7_856(2)%b(2,1)=zcr(id7)*p856k0
      lz7_856(2)%c(1,2)=zcr(id7)*p7k0
      lz7_856(2)%c(2,1)=-zcl(id7)*p7k0
* T -- qu=p7,qd=p856,v=3,a=lz7_856(3)%a,b=lz7_856(3)%b,c=lz7_856(3)%c,d=
* lz7_856(3)%d,cr=zcr(id7),cl=zcl(id7),nsum=0
      eps_0=p7k0*p856(2)-p856k0*p7(2)
      ceps_0=eps_0*cim
      ceps_1=p7k0*cim
      ceps_2=p856k0*cim
      auxa=+p7k0*p856(3)+p856k0*p7(3)
      lz7_856(3)%a(1,1)=zcr(id7)*(auxa+ceps_0)
      lz7_856(3)%a(2,2)=zcl(id7)*(auxa-ceps_0)
      lz7_856(3)%b(1,2)=-zcl(id7)*ceps_2
      lz7_856(3)%b(2,1)=-zcr(id7)*ceps_2
      lz7_856(3)%c(1,2)=zcr(id7)*ceps_1
      lz7_856(3)%c(2,1)=zcl(id7)*ceps_1
  
  
      if(ineutri(id7).ne.1) then
* T -- qu=p7,qd=p856,v=0,a=lf7_856(0)%a,b=lf7_856(0)%b,c=lf7_856(0)%c,d=
* lf7_856(0)%d,cr=fcr(id7),cl=fcl(id7),nsum=0
      eps_0=-p7(2)*p856(3)+p856(2)*p7(3)
      ceps_0=eps_0*cim
      ceps_1=p7(3)*cim
      ceps_2=p856(3)*cim
      auxa=-quqd+p7k0*p856(0)+p856k0*p7(0)
      lf7_856(0)%a(1,1)=fcr(id7)*(auxa+ceps_0)
      lf7_856(0)%a(2,2)=fcl(id7)*(auxa-ceps_0)
      lf7_856(0)%b(1,2)=-fcl(id7)*(p856(2)+ceps_2)
      lf7_856(0)%b(2,1)=fcr(id7)*(p856(2)-ceps_2)
      lf7_856(0)%c(1,2)=fcr(id7)*(p7(2)+ceps_1)
      lf7_856(0)%c(2,1)=fcl(id7)*(-p7(2)+ceps_1)
      lf7_856(0)%d(1,1)=fcl(id7)
      lf7_856(0)%d(2,2)=fcr(id7)
* T -- qu=p7,qd=p856,v=1,a=lf7_856(1)%a,b=lf7_856(1)%b,c=lf7_856(1)%c,d=
* lf7_856(1)%d,cr=fcr(id7),cl=fcl(id7),nsum=0
      auxa=-quqd+p7k0*p856(1)+p856k0*p7(1)
      lf7_856(1)%a(1,1)=fcr(id7)*(auxa+ceps_0)
      lf7_856(1)%a(2,2)=fcl(id7)*(auxa-ceps_0)
      lf7_856(1)%b(1,2)=-fcl(id7)*(p856(2)+ceps_2)
      lf7_856(1)%b(2,1)=fcr(id7)*(p856(2)-ceps_2)
      lf7_856(1)%c(1,2)=fcr(id7)*(p7(2)+ceps_1)
      lf7_856(1)%c(2,1)=fcl(id7)*(-p7(2)+ceps_1)
      lf7_856(1)%d(1,1)=fcl(id7)
      lf7_856(1)%d(2,2)=fcr(id7)
* T -- qu=p7,qd=p856,v=2,a=lf7_856(2)%a,b=lf7_856(2)%b,c=lf7_856(2)%c,d=
* lf7_856(2)%d,cr=fcr(id7),cl=fcl(id7),nsum=0
      eps_0=-p7k0*p856(3)+p856k0*p7(3)
      ceps_0=eps_0*cim
      auxa=p7k0*p856(2)+p856k0*p7(2)
      lf7_856(2)%a(1,1)=fcr(id7)*(auxa+ceps_0)
      lf7_856(2)%a(2,2)=fcl(id7)*(auxa-ceps_0)
      lf7_856(2)%b(1,2)=-fcl(id7)*p856k0
      lf7_856(2)%b(2,1)=fcr(id7)*p856k0
      lf7_856(2)%c(1,2)=fcr(id7)*p7k0
      lf7_856(2)%c(2,1)=-fcl(id7)*p7k0
* T -- qu=p7,qd=p856,v=3,a=lf7_856(3)%a,b=lf7_856(3)%b,c=lf7_856(3)%c,d=
* lf7_856(3)%d,cr=fcr(id7),cl=fcl(id7),nsum=0
      eps_0=p7k0*p856(2)-p856k0*p7(2)
      ceps_0=eps_0*cim
      ceps_1=p7k0*cim
      ceps_2=p856k0*cim
      auxa=+p7k0*p856(3)+p856k0*p7(3)
      lf7_856(3)%a(1,1)=fcr(id7)*(auxa+ceps_0)
      lf7_856(3)%a(2,2)=fcl(id7)*(auxa-ceps_0)
      lf7_856(3)%b(1,2)=-fcl(id7)*ceps_2
      lf7_856(3)%b(2,1)=-fcr(id7)*ceps_2
      lf7_856(3)%c(1,2)=fcr(id7)*ceps_1
      lf7_856(3)%c(2,1)=fcl(id7)*ceps_1
  
      else
        do mu=0,3
          lf7_856(mu)%a(1,1) = czero
          lf7_856(mu)%a(2,2) = czero
          lf7_856(mu)%b(1,2) = czero
          lf7_856(mu)%b(2,1) = czero
          lf7_856(mu)%c(1,2) = czero
          lf7_856(mu)%c(2,1) = czero
          lf7_856(mu)%d(1,1) = czero
          lf7_856(mu)%d(2,2) = czero
        enddo
      endif
  
  
  
* compute all single insertions of the type rzi_ and rfi_ (i=2,4)       
*    to a Zline                                                         
*                                                                       
*            |_Z__(mu)         |__f__(mu)                               
*        i __|             i __|                                        
*                                                                       
  
  
* quqd -- p=p134,q=p2
      quqd=p134(0)*p2(0)-p134(1)*p2(1)-p134(2)*p2(2)-p134(3)*p2(
     & 3)
* T -- qu=p134,qd=p2,v=0,a=rz2_134(0)%a,b=rz2_134(0)%b,c=rz2_134(0)%c,d=
* rz2_134(0)%d,cr=zcr(id2),cl=zcl(id2),nsum=0
      eps_0=-p134(2)*p2(3)+p2(2)*p134(3)
      ceps_0=eps_0*cim
      ceps_1=p134(3)*cim
      ceps_2=p2(3)*cim
      auxa=-quqd+p134k0*p2(0)+p2k0*p134(0)
      rz2_134(0)%a(1,1)=zcr(id2)*(auxa+ceps_0)
      rz2_134(0)%a(2,2)=zcl(id2)*(auxa-ceps_0)
      rz2_134(0)%b(1,2)=-zcl(id2)*(p2(2)+ceps_2)
      rz2_134(0)%b(2,1)=zcr(id2)*(p2(2)-ceps_2)
      rz2_134(0)%c(1,2)=zcr(id2)*(p134(2)+ceps_1)
      rz2_134(0)%c(2,1)=zcl(id2)*(-p134(2)+ceps_1)
      rz2_134(0)%d(1,1)=zcl(id2)
      rz2_134(0)%d(2,2)=zcr(id2)
* T -- qu=p134,qd=p2,v=1,a=rz2_134(1)%a,b=rz2_134(1)%b,c=rz2_134(1)%c,d=
* rz2_134(1)%d,cr=zcr(id2),cl=zcl(id2),nsum=0
      auxa=-quqd+p134k0*p2(1)+p2k0*p134(1)
      rz2_134(1)%a(1,1)=zcr(id2)*(auxa+ceps_0)
      rz2_134(1)%a(2,2)=zcl(id2)*(auxa-ceps_0)
      rz2_134(1)%b(1,2)=-zcl(id2)*(p2(2)+ceps_2)
      rz2_134(1)%b(2,1)=zcr(id2)*(p2(2)-ceps_2)
      rz2_134(1)%c(1,2)=zcr(id2)*(p134(2)+ceps_1)
      rz2_134(1)%c(2,1)=zcl(id2)*(-p134(2)+ceps_1)
      rz2_134(1)%d(1,1)=zcl(id2)
      rz2_134(1)%d(2,2)=zcr(id2)
* T -- qu=p134,qd=p2,v=2,a=rz2_134(2)%a,b=rz2_134(2)%b,c=rz2_134(2)%c,d=
* rz2_134(2)%d,cr=zcr(id2),cl=zcl(id2),nsum=0
      eps_0=-p134k0*p2(3)+p2k0*p134(3)
      ceps_0=eps_0*cim
      auxa=p134k0*p2(2)+p2k0*p134(2)
      rz2_134(2)%a(1,1)=zcr(id2)*(auxa+ceps_0)
      rz2_134(2)%a(2,2)=zcl(id2)*(auxa-ceps_0)
      rz2_134(2)%b(1,2)=-zcl(id2)*p2k0
      rz2_134(2)%b(2,1)=zcr(id2)*p2k0
      rz2_134(2)%c(1,2)=zcr(id2)*p134k0
      rz2_134(2)%c(2,1)=-zcl(id2)*p134k0
* T -- qu=p134,qd=p2,v=3,a=rz2_134(3)%a,b=rz2_134(3)%b,c=rz2_134(3)%c,d=
* rz2_134(3)%d,cr=zcr(id2),cl=zcl(id2),nsum=0
      eps_0=p134k0*p2(2)-p2k0*p134(2)
      ceps_0=eps_0*cim
      ceps_1=p134k0*cim
      ceps_2=p2k0*cim
      auxa=+p134k0*p2(3)+p2k0*p134(3)
      rz2_134(3)%a(1,1)=zcr(id2)*(auxa+ceps_0)
      rz2_134(3)%a(2,2)=zcl(id2)*(auxa-ceps_0)
      rz2_134(3)%b(1,2)=-zcl(id2)*ceps_2
      rz2_134(3)%b(2,1)=-zcr(id2)*ceps_2
      rz2_134(3)%c(1,2)=zcr(id2)*ceps_1
      rz2_134(3)%c(2,1)=zcl(id2)*ceps_1
  
  
      if(ineutri(id2).ne.1) then
* T -- qu=p134,qd=p2,v=0,a=rf2_134(0)%a,b=rf2_134(0)%b,c=rf2_134(0)%c,d=
* rf2_134(0)%d,cr=fcr(id2),cl=fcl(id2),nsum=0
      eps_0=-p134(2)*p2(3)+p2(2)*p134(3)
      ceps_0=eps_0*cim
      ceps_1=p134(3)*cim
      ceps_2=p2(3)*cim
      auxa=-quqd+p134k0*p2(0)+p2k0*p134(0)
      rf2_134(0)%a(1,1)=fcr(id2)*(auxa+ceps_0)
      rf2_134(0)%a(2,2)=fcl(id2)*(auxa-ceps_0)
      rf2_134(0)%b(1,2)=-fcl(id2)*(p2(2)+ceps_2)
      rf2_134(0)%b(2,1)=fcr(id2)*(p2(2)-ceps_2)
      rf2_134(0)%c(1,2)=fcr(id2)*(p134(2)+ceps_1)
      rf2_134(0)%c(2,1)=fcl(id2)*(-p134(2)+ceps_1)
      rf2_134(0)%d(1,1)=fcl(id2)
      rf2_134(0)%d(2,2)=fcr(id2)
* T -- qu=p134,qd=p2,v=1,a=rf2_134(1)%a,b=rf2_134(1)%b,c=rf2_134(1)%c,d=
* rf2_134(1)%d,cr=fcr(id2),cl=fcl(id2),nsum=0
      auxa=-quqd+p134k0*p2(1)+p2k0*p134(1)
      rf2_134(1)%a(1,1)=fcr(id2)*(auxa+ceps_0)
      rf2_134(1)%a(2,2)=fcl(id2)*(auxa-ceps_0)
      rf2_134(1)%b(1,2)=-fcl(id2)*(p2(2)+ceps_2)
      rf2_134(1)%b(2,1)=fcr(id2)*(p2(2)-ceps_2)
      rf2_134(1)%c(1,2)=fcr(id2)*(p134(2)+ceps_1)
      rf2_134(1)%c(2,1)=fcl(id2)*(-p134(2)+ceps_1)
      rf2_134(1)%d(1,1)=fcl(id2)
      rf2_134(1)%d(2,2)=fcr(id2)
* T -- qu=p134,qd=p2,v=2,a=rf2_134(2)%a,b=rf2_134(2)%b,c=rf2_134(2)%c,d=
* rf2_134(2)%d,cr=fcr(id2),cl=fcl(id2),nsum=0
      eps_0=-p134k0*p2(3)+p2k0*p134(3)
      ceps_0=eps_0*cim
      auxa=p134k0*p2(2)+p2k0*p134(2)
      rf2_134(2)%a(1,1)=fcr(id2)*(auxa+ceps_0)
      rf2_134(2)%a(2,2)=fcl(id2)*(auxa-ceps_0)
      rf2_134(2)%b(1,2)=-fcl(id2)*p2k0
      rf2_134(2)%b(2,1)=fcr(id2)*p2k0
      rf2_134(2)%c(1,2)=fcr(id2)*p134k0
      rf2_134(2)%c(2,1)=-fcl(id2)*p134k0
* T -- qu=p134,qd=p2,v=3,a=rf2_134(3)%a,b=rf2_134(3)%b,c=rf2_134(3)%c,d=
* rf2_134(3)%d,cr=fcr(id2),cl=fcl(id2),nsum=0
      eps_0=p134k0*p2(2)-p2k0*p134(2)
      ceps_0=eps_0*cim
      ceps_1=p134k0*cim
      ceps_2=p2k0*cim
      auxa=+p134k0*p2(3)+p2k0*p134(3)
      rf2_134(3)%a(1,1)=fcr(id2)*(auxa+ceps_0)
      rf2_134(3)%a(2,2)=fcl(id2)*(auxa-ceps_0)
      rf2_134(3)%b(1,2)=-fcl(id2)*ceps_2
      rf2_134(3)%b(2,1)=-fcr(id2)*ceps_2
      rf2_134(3)%c(1,2)=fcr(id2)*ceps_1
      rf2_134(3)%c(2,1)=fcl(id2)*ceps_1
  
      else
        do mu=0,3
          rf2_134(mu)%a(1,1) = czero
          rf2_134(mu)%a(2,2) = czero
          rf2_134(mu)%b(1,2) = czero
          rf2_134(mu)%b(2,1) = czero
          rf2_134(mu)%c(1,2) = czero
          rf2_134(mu)%c(2,1) = czero
          rf2_134(mu)%d(1,1) = czero
          rf2_134(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p156,q=p2
      quqd=p156(0)*p2(0)-p156(1)*p2(1)-p156(2)*p2(2)-p156(3)*p2(
     & 3)
* T -- qu=p156,qd=p2,v=0,a=rz2_156(0)%a,b=rz2_156(0)%b,c=rz2_156(0)%c,d=
* rz2_156(0)%d,cr=zcr(id2),cl=zcl(id2),nsum=0
      eps_0=-p156(2)*p2(3)+p2(2)*p156(3)
      ceps_0=eps_0*cim
      ceps_1=p156(3)*cim
      ceps_2=p2(3)*cim
      auxa=-quqd+p156k0*p2(0)+p2k0*p156(0)
      rz2_156(0)%a(1,1)=zcr(id2)*(auxa+ceps_0)
      rz2_156(0)%a(2,2)=zcl(id2)*(auxa-ceps_0)
      rz2_156(0)%b(1,2)=-zcl(id2)*(p2(2)+ceps_2)
      rz2_156(0)%b(2,1)=zcr(id2)*(p2(2)-ceps_2)
      rz2_156(0)%c(1,2)=zcr(id2)*(p156(2)+ceps_1)
      rz2_156(0)%c(2,1)=zcl(id2)*(-p156(2)+ceps_1)
      rz2_156(0)%d(1,1)=zcl(id2)
      rz2_156(0)%d(2,2)=zcr(id2)
* T -- qu=p156,qd=p2,v=1,a=rz2_156(1)%a,b=rz2_156(1)%b,c=rz2_156(1)%c,d=
* rz2_156(1)%d,cr=zcr(id2),cl=zcl(id2),nsum=0
      auxa=-quqd+p156k0*p2(1)+p2k0*p156(1)
      rz2_156(1)%a(1,1)=zcr(id2)*(auxa+ceps_0)
      rz2_156(1)%a(2,2)=zcl(id2)*(auxa-ceps_0)
      rz2_156(1)%b(1,2)=-zcl(id2)*(p2(2)+ceps_2)
      rz2_156(1)%b(2,1)=zcr(id2)*(p2(2)-ceps_2)
      rz2_156(1)%c(1,2)=zcr(id2)*(p156(2)+ceps_1)
      rz2_156(1)%c(2,1)=zcl(id2)*(-p156(2)+ceps_1)
      rz2_156(1)%d(1,1)=zcl(id2)
      rz2_156(1)%d(2,2)=zcr(id2)
* T -- qu=p156,qd=p2,v=2,a=rz2_156(2)%a,b=rz2_156(2)%b,c=rz2_156(2)%c,d=
* rz2_156(2)%d,cr=zcr(id2),cl=zcl(id2),nsum=0
      eps_0=-p156k0*p2(3)+p2k0*p156(3)
      ceps_0=eps_0*cim
      auxa=p156k0*p2(2)+p2k0*p156(2)
      rz2_156(2)%a(1,1)=zcr(id2)*(auxa+ceps_0)
      rz2_156(2)%a(2,2)=zcl(id2)*(auxa-ceps_0)
      rz2_156(2)%b(1,2)=-zcl(id2)*p2k0
      rz2_156(2)%b(2,1)=zcr(id2)*p2k0
      rz2_156(2)%c(1,2)=zcr(id2)*p156k0
      rz2_156(2)%c(2,1)=-zcl(id2)*p156k0
* T -- qu=p156,qd=p2,v=3,a=rz2_156(3)%a,b=rz2_156(3)%b,c=rz2_156(3)%c,d=
* rz2_156(3)%d,cr=zcr(id2),cl=zcl(id2),nsum=0
      eps_0=p156k0*p2(2)-p2k0*p156(2)
      ceps_0=eps_0*cim
      ceps_1=p156k0*cim
      ceps_2=p2k0*cim
      auxa=+p156k0*p2(3)+p2k0*p156(3)
      rz2_156(3)%a(1,1)=zcr(id2)*(auxa+ceps_0)
      rz2_156(3)%a(2,2)=zcl(id2)*(auxa-ceps_0)
      rz2_156(3)%b(1,2)=-zcl(id2)*ceps_2
      rz2_156(3)%b(2,1)=-zcr(id2)*ceps_2
      rz2_156(3)%c(1,2)=zcr(id2)*ceps_1
      rz2_156(3)%c(2,1)=zcl(id2)*ceps_1
  
  
      if(ineutri(id2).ne.1) then
* T -- qu=p156,qd=p2,v=0,a=rf2_156(0)%a,b=rf2_156(0)%b,c=rf2_156(0)%c,d=
* rf2_156(0)%d,cr=fcr(id2),cl=fcl(id2),nsum=0
      eps_0=-p156(2)*p2(3)+p2(2)*p156(3)
      ceps_0=eps_0*cim
      ceps_1=p156(3)*cim
      ceps_2=p2(3)*cim
      auxa=-quqd+p156k0*p2(0)+p2k0*p156(0)
      rf2_156(0)%a(1,1)=fcr(id2)*(auxa+ceps_0)
      rf2_156(0)%a(2,2)=fcl(id2)*(auxa-ceps_0)
      rf2_156(0)%b(1,2)=-fcl(id2)*(p2(2)+ceps_2)
      rf2_156(0)%b(2,1)=fcr(id2)*(p2(2)-ceps_2)
      rf2_156(0)%c(1,2)=fcr(id2)*(p156(2)+ceps_1)
      rf2_156(0)%c(2,1)=fcl(id2)*(-p156(2)+ceps_1)
      rf2_156(0)%d(1,1)=fcl(id2)
      rf2_156(0)%d(2,2)=fcr(id2)
* T -- qu=p156,qd=p2,v=1,a=rf2_156(1)%a,b=rf2_156(1)%b,c=rf2_156(1)%c,d=
* rf2_156(1)%d,cr=fcr(id2),cl=fcl(id2),nsum=0
      auxa=-quqd+p156k0*p2(1)+p2k0*p156(1)
      rf2_156(1)%a(1,1)=fcr(id2)*(auxa+ceps_0)
      rf2_156(1)%a(2,2)=fcl(id2)*(auxa-ceps_0)
      rf2_156(1)%b(1,2)=-fcl(id2)*(p2(2)+ceps_2)
      rf2_156(1)%b(2,1)=fcr(id2)*(p2(2)-ceps_2)
      rf2_156(1)%c(1,2)=fcr(id2)*(p156(2)+ceps_1)
      rf2_156(1)%c(2,1)=fcl(id2)*(-p156(2)+ceps_1)
      rf2_156(1)%d(1,1)=fcl(id2)
      rf2_156(1)%d(2,2)=fcr(id2)
* T -- qu=p156,qd=p2,v=2,a=rf2_156(2)%a,b=rf2_156(2)%b,c=rf2_156(2)%c,d=
* rf2_156(2)%d,cr=fcr(id2),cl=fcl(id2),nsum=0
      eps_0=-p156k0*p2(3)+p2k0*p156(3)
      ceps_0=eps_0*cim
      auxa=p156k0*p2(2)+p2k0*p156(2)
      rf2_156(2)%a(1,1)=fcr(id2)*(auxa+ceps_0)
      rf2_156(2)%a(2,2)=fcl(id2)*(auxa-ceps_0)
      rf2_156(2)%b(1,2)=-fcl(id2)*p2k0
      rf2_156(2)%b(2,1)=fcr(id2)*p2k0
      rf2_156(2)%c(1,2)=fcr(id2)*p156k0
      rf2_156(2)%c(2,1)=-fcl(id2)*p156k0
* T -- qu=p156,qd=p2,v=3,a=rf2_156(3)%a,b=rf2_156(3)%b,c=rf2_156(3)%c,d=
* rf2_156(3)%d,cr=fcr(id2),cl=fcl(id2),nsum=0
      eps_0=p156k0*p2(2)-p2k0*p156(2)
      ceps_0=eps_0*cim
      ceps_1=p156k0*cim
      ceps_2=p2k0*cim
      auxa=+p156k0*p2(3)+p2k0*p156(3)
      rf2_156(3)%a(1,1)=fcr(id2)*(auxa+ceps_0)
      rf2_156(3)%a(2,2)=fcl(id2)*(auxa-ceps_0)
      rf2_156(3)%b(1,2)=-fcl(id2)*ceps_2
      rf2_156(3)%b(2,1)=-fcr(id2)*ceps_2
      rf2_156(3)%c(1,2)=fcr(id2)*ceps_1
      rf2_156(3)%c(2,1)=fcl(id2)*ceps_1
  
      else
        do mu=0,3
          rf2_156(mu)%a(1,1) = czero
          rf2_156(mu)%a(2,2) = czero
          rf2_156(mu)%b(1,2) = czero
          rf2_156(mu)%b(2,1) = czero
          rf2_156(mu)%c(1,2) = czero
          rf2_156(mu)%c(2,1) = czero
          rf2_156(mu)%d(1,1) = czero
          rf2_156(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p178,q=p2
      quqd=p178(0)*p2(0)-p178(1)*p2(1)-p178(2)*p2(2)-p178(3)*p2(
     & 3)
* T -- qu=p178,qd=p2,v=0,a=rz2_178(0)%a,b=rz2_178(0)%b,c=rz2_178(0)%c,d=
* rz2_178(0)%d,cr=zcr(id2),cl=zcl(id2),nsum=0
      eps_0=-p178(2)*p2(3)+p2(2)*p178(3)
      ceps_0=eps_0*cim
      ceps_1=p178(3)*cim
      ceps_2=p2(3)*cim
      auxa=-quqd+p178k0*p2(0)+p2k0*p178(0)
      rz2_178(0)%a(1,1)=zcr(id2)*(auxa+ceps_0)
      rz2_178(0)%a(2,2)=zcl(id2)*(auxa-ceps_0)
      rz2_178(0)%b(1,2)=-zcl(id2)*(p2(2)+ceps_2)
      rz2_178(0)%b(2,1)=zcr(id2)*(p2(2)-ceps_2)
      rz2_178(0)%c(1,2)=zcr(id2)*(p178(2)+ceps_1)
      rz2_178(0)%c(2,1)=zcl(id2)*(-p178(2)+ceps_1)
      rz2_178(0)%d(1,1)=zcl(id2)
      rz2_178(0)%d(2,2)=zcr(id2)
* T -- qu=p178,qd=p2,v=1,a=rz2_178(1)%a,b=rz2_178(1)%b,c=rz2_178(1)%c,d=
* rz2_178(1)%d,cr=zcr(id2),cl=zcl(id2),nsum=0
      auxa=-quqd+p178k0*p2(1)+p2k0*p178(1)
      rz2_178(1)%a(1,1)=zcr(id2)*(auxa+ceps_0)
      rz2_178(1)%a(2,2)=zcl(id2)*(auxa-ceps_0)
      rz2_178(1)%b(1,2)=-zcl(id2)*(p2(2)+ceps_2)
      rz2_178(1)%b(2,1)=zcr(id2)*(p2(2)-ceps_2)
      rz2_178(1)%c(1,2)=zcr(id2)*(p178(2)+ceps_1)
      rz2_178(1)%c(2,1)=zcl(id2)*(-p178(2)+ceps_1)
      rz2_178(1)%d(1,1)=zcl(id2)
      rz2_178(1)%d(2,2)=zcr(id2)
* T -- qu=p178,qd=p2,v=2,a=rz2_178(2)%a,b=rz2_178(2)%b,c=rz2_178(2)%c,d=
* rz2_178(2)%d,cr=zcr(id2),cl=zcl(id2),nsum=0
      eps_0=-p178k0*p2(3)+p2k0*p178(3)
      ceps_0=eps_0*cim
      auxa=p178k0*p2(2)+p2k0*p178(2)
      rz2_178(2)%a(1,1)=zcr(id2)*(auxa+ceps_0)
      rz2_178(2)%a(2,2)=zcl(id2)*(auxa-ceps_0)
      rz2_178(2)%b(1,2)=-zcl(id2)*p2k0
      rz2_178(2)%b(2,1)=zcr(id2)*p2k0
      rz2_178(2)%c(1,2)=zcr(id2)*p178k0
      rz2_178(2)%c(2,1)=-zcl(id2)*p178k0
* T -- qu=p178,qd=p2,v=3,a=rz2_178(3)%a,b=rz2_178(3)%b,c=rz2_178(3)%c,d=
* rz2_178(3)%d,cr=zcr(id2),cl=zcl(id2),nsum=0
      eps_0=p178k0*p2(2)-p2k0*p178(2)
      ceps_0=eps_0*cim
      ceps_1=p178k0*cim
      ceps_2=p2k0*cim
      auxa=+p178k0*p2(3)+p2k0*p178(3)
      rz2_178(3)%a(1,1)=zcr(id2)*(auxa+ceps_0)
      rz2_178(3)%a(2,2)=zcl(id2)*(auxa-ceps_0)
      rz2_178(3)%b(1,2)=-zcl(id2)*ceps_2
      rz2_178(3)%b(2,1)=-zcr(id2)*ceps_2
      rz2_178(3)%c(1,2)=zcr(id2)*ceps_1
      rz2_178(3)%c(2,1)=zcl(id2)*ceps_1
  
  
      if(ineutri(id2).ne.1) then
* T -- qu=p178,qd=p2,v=0,a=rf2_178(0)%a,b=rf2_178(0)%b,c=rf2_178(0)%c,d=
* rf2_178(0)%d,cr=fcr(id2),cl=fcl(id2),nsum=0
      eps_0=-p178(2)*p2(3)+p2(2)*p178(3)
      ceps_0=eps_0*cim
      ceps_1=p178(3)*cim
      ceps_2=p2(3)*cim
      auxa=-quqd+p178k0*p2(0)+p2k0*p178(0)
      rf2_178(0)%a(1,1)=fcr(id2)*(auxa+ceps_0)
      rf2_178(0)%a(2,2)=fcl(id2)*(auxa-ceps_0)
      rf2_178(0)%b(1,2)=-fcl(id2)*(p2(2)+ceps_2)
      rf2_178(0)%b(2,1)=fcr(id2)*(p2(2)-ceps_2)
      rf2_178(0)%c(1,2)=fcr(id2)*(p178(2)+ceps_1)
      rf2_178(0)%c(2,1)=fcl(id2)*(-p178(2)+ceps_1)
      rf2_178(0)%d(1,1)=fcl(id2)
      rf2_178(0)%d(2,2)=fcr(id2)
* T -- qu=p178,qd=p2,v=1,a=rf2_178(1)%a,b=rf2_178(1)%b,c=rf2_178(1)%c,d=
* rf2_178(1)%d,cr=fcr(id2),cl=fcl(id2),nsum=0
      auxa=-quqd+p178k0*p2(1)+p2k0*p178(1)
      rf2_178(1)%a(1,1)=fcr(id2)*(auxa+ceps_0)
      rf2_178(1)%a(2,2)=fcl(id2)*(auxa-ceps_0)
      rf2_178(1)%b(1,2)=-fcl(id2)*(p2(2)+ceps_2)
      rf2_178(1)%b(2,1)=fcr(id2)*(p2(2)-ceps_2)
      rf2_178(1)%c(1,2)=fcr(id2)*(p178(2)+ceps_1)
      rf2_178(1)%c(2,1)=fcl(id2)*(-p178(2)+ceps_1)
      rf2_178(1)%d(1,1)=fcl(id2)
      rf2_178(1)%d(2,2)=fcr(id2)
* T -- qu=p178,qd=p2,v=2,a=rf2_178(2)%a,b=rf2_178(2)%b,c=rf2_178(2)%c,d=
* rf2_178(2)%d,cr=fcr(id2),cl=fcl(id2),nsum=0
      eps_0=-p178k0*p2(3)+p2k0*p178(3)
      ceps_0=eps_0*cim
      auxa=p178k0*p2(2)+p2k0*p178(2)
      rf2_178(2)%a(1,1)=fcr(id2)*(auxa+ceps_0)
      rf2_178(2)%a(2,2)=fcl(id2)*(auxa-ceps_0)
      rf2_178(2)%b(1,2)=-fcl(id2)*p2k0
      rf2_178(2)%b(2,1)=fcr(id2)*p2k0
      rf2_178(2)%c(1,2)=fcr(id2)*p178k0
      rf2_178(2)%c(2,1)=-fcl(id2)*p178k0
* T -- qu=p178,qd=p2,v=3,a=rf2_178(3)%a,b=rf2_178(3)%b,c=rf2_178(3)%c,d=
* rf2_178(3)%d,cr=fcr(id2),cl=fcl(id2),nsum=0
      eps_0=p178k0*p2(2)-p2k0*p178(2)
      ceps_0=eps_0*cim
      ceps_1=p178k0*cim
      ceps_2=p2k0*cim
      auxa=+p178k0*p2(3)+p2k0*p178(3)
      rf2_178(3)%a(1,1)=fcr(id2)*(auxa+ceps_0)
      rf2_178(3)%a(2,2)=fcl(id2)*(auxa-ceps_0)
      rf2_178(3)%b(1,2)=-fcl(id2)*ceps_2
      rf2_178(3)%b(2,1)=-fcr(id2)*ceps_2
      rf2_178(3)%c(1,2)=fcr(id2)*ceps_1
      rf2_178(3)%c(2,1)=fcl(id2)*ceps_1
  
      else
        do mu=0,3
          rf2_178(mu)%a(1,1) = czero
          rf2_178(mu)%a(2,2) = czero
          rf2_178(mu)%b(1,2) = czero
          rf2_178(mu)%b(2,1) = czero
          rf2_178(mu)%c(1,2) = czero
          rf2_178(mu)%c(2,1) = czero
          rf2_178(mu)%d(1,1) = czero
          rf2_178(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p312,q=p4
      quqd=p312(0)*p4(0)-p312(1)*p4(1)-p312(2)*p4(2)-p312(3)*p4(
     & 3)
* T -- qu=p312,qd=p4,v=0,a=rz4_312(0)%a,b=rz4_312(0)%b,c=rz4_312(0)%c,d=
* rz4_312(0)%d,cr=zcr(id4),cl=zcl(id4),nsum=0
      eps_0=-p312(2)*p4(3)+p4(2)*p312(3)
      ceps_0=eps_0*cim
      ceps_1=p312(3)*cim
      ceps_2=p4(3)*cim
      auxa=-quqd+p312k0*p4(0)+p4k0*p312(0)
      rz4_312(0)%a(1,1)=zcr(id4)*(auxa+ceps_0)
      rz4_312(0)%a(2,2)=zcl(id4)*(auxa-ceps_0)
      rz4_312(0)%b(1,2)=-zcl(id4)*(p4(2)+ceps_2)
      rz4_312(0)%b(2,1)=zcr(id4)*(p4(2)-ceps_2)
      rz4_312(0)%c(1,2)=zcr(id4)*(p312(2)+ceps_1)
      rz4_312(0)%c(2,1)=zcl(id4)*(-p312(2)+ceps_1)
      rz4_312(0)%d(1,1)=zcl(id4)
      rz4_312(0)%d(2,2)=zcr(id4)
* T -- qu=p312,qd=p4,v=1,a=rz4_312(1)%a,b=rz4_312(1)%b,c=rz4_312(1)%c,d=
* rz4_312(1)%d,cr=zcr(id4),cl=zcl(id4),nsum=0
      auxa=-quqd+p312k0*p4(1)+p4k0*p312(1)
      rz4_312(1)%a(1,1)=zcr(id4)*(auxa+ceps_0)
      rz4_312(1)%a(2,2)=zcl(id4)*(auxa-ceps_0)
      rz4_312(1)%b(1,2)=-zcl(id4)*(p4(2)+ceps_2)
      rz4_312(1)%b(2,1)=zcr(id4)*(p4(2)-ceps_2)
      rz4_312(1)%c(1,2)=zcr(id4)*(p312(2)+ceps_1)
      rz4_312(1)%c(2,1)=zcl(id4)*(-p312(2)+ceps_1)
      rz4_312(1)%d(1,1)=zcl(id4)
      rz4_312(1)%d(2,2)=zcr(id4)
* T -- qu=p312,qd=p4,v=2,a=rz4_312(2)%a,b=rz4_312(2)%b,c=rz4_312(2)%c,d=
* rz4_312(2)%d,cr=zcr(id4),cl=zcl(id4),nsum=0
      eps_0=-p312k0*p4(3)+p4k0*p312(3)
      ceps_0=eps_0*cim
      auxa=p312k0*p4(2)+p4k0*p312(2)
      rz4_312(2)%a(1,1)=zcr(id4)*(auxa+ceps_0)
      rz4_312(2)%a(2,2)=zcl(id4)*(auxa-ceps_0)
      rz4_312(2)%b(1,2)=-zcl(id4)*p4k0
      rz4_312(2)%b(2,1)=zcr(id4)*p4k0
      rz4_312(2)%c(1,2)=zcr(id4)*p312k0
      rz4_312(2)%c(2,1)=-zcl(id4)*p312k0
* T -- qu=p312,qd=p4,v=3,a=rz4_312(3)%a,b=rz4_312(3)%b,c=rz4_312(3)%c,d=
* rz4_312(3)%d,cr=zcr(id4),cl=zcl(id4),nsum=0
      eps_0=p312k0*p4(2)-p4k0*p312(2)
      ceps_0=eps_0*cim
      ceps_1=p312k0*cim
      ceps_2=p4k0*cim
      auxa=+p312k0*p4(3)+p4k0*p312(3)
      rz4_312(3)%a(1,1)=zcr(id4)*(auxa+ceps_0)
      rz4_312(3)%a(2,2)=zcl(id4)*(auxa-ceps_0)
      rz4_312(3)%b(1,2)=-zcl(id4)*ceps_2
      rz4_312(3)%b(2,1)=-zcr(id4)*ceps_2
      rz4_312(3)%c(1,2)=zcr(id4)*ceps_1
      rz4_312(3)%c(2,1)=zcl(id4)*ceps_1
  
  
      if(ineutri(id4).ne.1) then
* T -- qu=p312,qd=p4,v=0,a=rf4_312(0)%a,b=rf4_312(0)%b,c=rf4_312(0)%c,d=
* rf4_312(0)%d,cr=fcr(id4),cl=fcl(id4),nsum=0
      eps_0=-p312(2)*p4(3)+p4(2)*p312(3)
      ceps_0=eps_0*cim
      ceps_1=p312(3)*cim
      ceps_2=p4(3)*cim
      auxa=-quqd+p312k0*p4(0)+p4k0*p312(0)
      rf4_312(0)%a(1,1)=fcr(id4)*(auxa+ceps_0)
      rf4_312(0)%a(2,2)=fcl(id4)*(auxa-ceps_0)
      rf4_312(0)%b(1,2)=-fcl(id4)*(p4(2)+ceps_2)
      rf4_312(0)%b(2,1)=fcr(id4)*(p4(2)-ceps_2)
      rf4_312(0)%c(1,2)=fcr(id4)*(p312(2)+ceps_1)
      rf4_312(0)%c(2,1)=fcl(id4)*(-p312(2)+ceps_1)
      rf4_312(0)%d(1,1)=fcl(id4)
      rf4_312(0)%d(2,2)=fcr(id4)
* T -- qu=p312,qd=p4,v=1,a=rf4_312(1)%a,b=rf4_312(1)%b,c=rf4_312(1)%c,d=
* rf4_312(1)%d,cr=fcr(id4),cl=fcl(id4),nsum=0
      auxa=-quqd+p312k0*p4(1)+p4k0*p312(1)
      rf4_312(1)%a(1,1)=fcr(id4)*(auxa+ceps_0)
      rf4_312(1)%a(2,2)=fcl(id4)*(auxa-ceps_0)
      rf4_312(1)%b(1,2)=-fcl(id4)*(p4(2)+ceps_2)
      rf4_312(1)%b(2,1)=fcr(id4)*(p4(2)-ceps_2)
      rf4_312(1)%c(1,2)=fcr(id4)*(p312(2)+ceps_1)
      rf4_312(1)%c(2,1)=fcl(id4)*(-p312(2)+ceps_1)
      rf4_312(1)%d(1,1)=fcl(id4)
      rf4_312(1)%d(2,2)=fcr(id4)
* T -- qu=p312,qd=p4,v=2,a=rf4_312(2)%a,b=rf4_312(2)%b,c=rf4_312(2)%c,d=
* rf4_312(2)%d,cr=fcr(id4),cl=fcl(id4),nsum=0
      eps_0=-p312k0*p4(3)+p4k0*p312(3)
      ceps_0=eps_0*cim
      auxa=p312k0*p4(2)+p4k0*p312(2)
      rf4_312(2)%a(1,1)=fcr(id4)*(auxa+ceps_0)
      rf4_312(2)%a(2,2)=fcl(id4)*(auxa-ceps_0)
      rf4_312(2)%b(1,2)=-fcl(id4)*p4k0
      rf4_312(2)%b(2,1)=fcr(id4)*p4k0
      rf4_312(2)%c(1,2)=fcr(id4)*p312k0
      rf4_312(2)%c(2,1)=-fcl(id4)*p312k0
* T -- qu=p312,qd=p4,v=3,a=rf4_312(3)%a,b=rf4_312(3)%b,c=rf4_312(3)%c,d=
* rf4_312(3)%d,cr=fcr(id4),cl=fcl(id4),nsum=0
      eps_0=p312k0*p4(2)-p4k0*p312(2)
      ceps_0=eps_0*cim
      ceps_1=p312k0*cim
      ceps_2=p4k0*cim
      auxa=+p312k0*p4(3)+p4k0*p312(3)
      rf4_312(3)%a(1,1)=fcr(id4)*(auxa+ceps_0)
      rf4_312(3)%a(2,2)=fcl(id4)*(auxa-ceps_0)
      rf4_312(3)%b(1,2)=-fcl(id4)*ceps_2
      rf4_312(3)%b(2,1)=-fcr(id4)*ceps_2
      rf4_312(3)%c(1,2)=fcr(id4)*ceps_1
      rf4_312(3)%c(2,1)=fcl(id4)*ceps_1
  
      else
        do mu=0,3
          rf4_312(mu)%a(1,1) = czero
          rf4_312(mu)%a(2,2) = czero
          rf4_312(mu)%b(1,2) = czero
          rf4_312(mu)%b(2,1) = czero
          rf4_312(mu)%c(1,2) = czero
          rf4_312(mu)%c(2,1) = czero
          rf4_312(mu)%d(1,1) = czero
          rf4_312(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p356,q=p4
      quqd=p356(0)*p4(0)-p356(1)*p4(1)-p356(2)*p4(2)-p356(3)*p4(
     & 3)
* T -- qu=p356,qd=p4,v=0,a=rz4_356(0)%a,b=rz4_356(0)%b,c=rz4_356(0)%c,d=
* rz4_356(0)%d,cr=zcr(id4),cl=zcl(id4),nsum=0
      eps_0=-p356(2)*p4(3)+p4(2)*p356(3)
      ceps_0=eps_0*cim
      ceps_1=p356(3)*cim
      ceps_2=p4(3)*cim
      auxa=-quqd+p356k0*p4(0)+p4k0*p356(0)
      rz4_356(0)%a(1,1)=zcr(id4)*(auxa+ceps_0)
      rz4_356(0)%a(2,2)=zcl(id4)*(auxa-ceps_0)
      rz4_356(0)%b(1,2)=-zcl(id4)*(p4(2)+ceps_2)
      rz4_356(0)%b(2,1)=zcr(id4)*(p4(2)-ceps_2)
      rz4_356(0)%c(1,2)=zcr(id4)*(p356(2)+ceps_1)
      rz4_356(0)%c(2,1)=zcl(id4)*(-p356(2)+ceps_1)
      rz4_356(0)%d(1,1)=zcl(id4)
      rz4_356(0)%d(2,2)=zcr(id4)
* T -- qu=p356,qd=p4,v=1,a=rz4_356(1)%a,b=rz4_356(1)%b,c=rz4_356(1)%c,d=
* rz4_356(1)%d,cr=zcr(id4),cl=zcl(id4),nsum=0
      auxa=-quqd+p356k0*p4(1)+p4k0*p356(1)
      rz4_356(1)%a(1,1)=zcr(id4)*(auxa+ceps_0)
      rz4_356(1)%a(2,2)=zcl(id4)*(auxa-ceps_0)
      rz4_356(1)%b(1,2)=-zcl(id4)*(p4(2)+ceps_2)
      rz4_356(1)%b(2,1)=zcr(id4)*(p4(2)-ceps_2)
      rz4_356(1)%c(1,2)=zcr(id4)*(p356(2)+ceps_1)
      rz4_356(1)%c(2,1)=zcl(id4)*(-p356(2)+ceps_1)
      rz4_356(1)%d(1,1)=zcl(id4)
      rz4_356(1)%d(2,2)=zcr(id4)
* T -- qu=p356,qd=p4,v=2,a=rz4_356(2)%a,b=rz4_356(2)%b,c=rz4_356(2)%c,d=
* rz4_356(2)%d,cr=zcr(id4),cl=zcl(id4),nsum=0
      eps_0=-p356k0*p4(3)+p4k0*p356(3)
      ceps_0=eps_0*cim
      auxa=p356k0*p4(2)+p4k0*p356(2)
      rz4_356(2)%a(1,1)=zcr(id4)*(auxa+ceps_0)
      rz4_356(2)%a(2,2)=zcl(id4)*(auxa-ceps_0)
      rz4_356(2)%b(1,2)=-zcl(id4)*p4k0
      rz4_356(2)%b(2,1)=zcr(id4)*p4k0
      rz4_356(2)%c(1,2)=zcr(id4)*p356k0
      rz4_356(2)%c(2,1)=-zcl(id4)*p356k0
* T -- qu=p356,qd=p4,v=3,a=rz4_356(3)%a,b=rz4_356(3)%b,c=rz4_356(3)%c,d=
* rz4_356(3)%d,cr=zcr(id4),cl=zcl(id4),nsum=0
      eps_0=p356k0*p4(2)-p4k0*p356(2)
      ceps_0=eps_0*cim
      ceps_1=p356k0*cim
      ceps_2=p4k0*cim
      auxa=+p356k0*p4(3)+p4k0*p356(3)
      rz4_356(3)%a(1,1)=zcr(id4)*(auxa+ceps_0)
      rz4_356(3)%a(2,2)=zcl(id4)*(auxa-ceps_0)
      rz4_356(3)%b(1,2)=-zcl(id4)*ceps_2
      rz4_356(3)%b(2,1)=-zcr(id4)*ceps_2
      rz4_356(3)%c(1,2)=zcr(id4)*ceps_1
      rz4_356(3)%c(2,1)=zcl(id4)*ceps_1
  
  
      if(ineutri(id4).ne.1) then
* T -- qu=p356,qd=p4,v=0,a=rf4_356(0)%a,b=rf4_356(0)%b,c=rf4_356(0)%c,d=
* rf4_356(0)%d,cr=fcr(id4),cl=fcl(id4),nsum=0
      eps_0=-p356(2)*p4(3)+p4(2)*p356(3)
      ceps_0=eps_0*cim
      ceps_1=p356(3)*cim
      ceps_2=p4(3)*cim
      auxa=-quqd+p356k0*p4(0)+p4k0*p356(0)
      rf4_356(0)%a(1,1)=fcr(id4)*(auxa+ceps_0)
      rf4_356(0)%a(2,2)=fcl(id4)*(auxa-ceps_0)
      rf4_356(0)%b(1,2)=-fcl(id4)*(p4(2)+ceps_2)
      rf4_356(0)%b(2,1)=fcr(id4)*(p4(2)-ceps_2)
      rf4_356(0)%c(1,2)=fcr(id4)*(p356(2)+ceps_1)
      rf4_356(0)%c(2,1)=fcl(id4)*(-p356(2)+ceps_1)
      rf4_356(0)%d(1,1)=fcl(id4)
      rf4_356(0)%d(2,2)=fcr(id4)
* T -- qu=p356,qd=p4,v=1,a=rf4_356(1)%a,b=rf4_356(1)%b,c=rf4_356(1)%c,d=
* rf4_356(1)%d,cr=fcr(id4),cl=fcl(id4),nsum=0
      auxa=-quqd+p356k0*p4(1)+p4k0*p356(1)
      rf4_356(1)%a(1,1)=fcr(id4)*(auxa+ceps_0)
      rf4_356(1)%a(2,2)=fcl(id4)*(auxa-ceps_0)
      rf4_356(1)%b(1,2)=-fcl(id4)*(p4(2)+ceps_2)
      rf4_356(1)%b(2,1)=fcr(id4)*(p4(2)-ceps_2)
      rf4_356(1)%c(1,2)=fcr(id4)*(p356(2)+ceps_1)
      rf4_356(1)%c(2,1)=fcl(id4)*(-p356(2)+ceps_1)
      rf4_356(1)%d(1,1)=fcl(id4)
      rf4_356(1)%d(2,2)=fcr(id4)
* T -- qu=p356,qd=p4,v=2,a=rf4_356(2)%a,b=rf4_356(2)%b,c=rf4_356(2)%c,d=
* rf4_356(2)%d,cr=fcr(id4),cl=fcl(id4),nsum=0
      eps_0=-p356k0*p4(3)+p4k0*p356(3)
      ceps_0=eps_0*cim
      auxa=p356k0*p4(2)+p4k0*p356(2)
      rf4_356(2)%a(1,1)=fcr(id4)*(auxa+ceps_0)
      rf4_356(2)%a(2,2)=fcl(id4)*(auxa-ceps_0)
      rf4_356(2)%b(1,2)=-fcl(id4)*p4k0
      rf4_356(2)%b(2,1)=fcr(id4)*p4k0
      rf4_356(2)%c(1,2)=fcr(id4)*p356k0
      rf4_356(2)%c(2,1)=-fcl(id4)*p356k0
* T -- qu=p356,qd=p4,v=3,a=rf4_356(3)%a,b=rf4_356(3)%b,c=rf4_356(3)%c,d=
* rf4_356(3)%d,cr=fcr(id4),cl=fcl(id4),nsum=0
      eps_0=p356k0*p4(2)-p4k0*p356(2)
      ceps_0=eps_0*cim
      ceps_1=p356k0*cim
      ceps_2=p4k0*cim
      auxa=+p356k0*p4(3)+p4k0*p356(3)
      rf4_356(3)%a(1,1)=fcr(id4)*(auxa+ceps_0)
      rf4_356(3)%a(2,2)=fcl(id4)*(auxa-ceps_0)
      rf4_356(3)%b(1,2)=-fcl(id4)*ceps_2
      rf4_356(3)%b(2,1)=-fcr(id4)*ceps_2
      rf4_356(3)%c(1,2)=fcr(id4)*ceps_1
      rf4_356(3)%c(2,1)=fcl(id4)*ceps_1
  
      else
        do mu=0,3
          rf4_356(mu)%a(1,1) = czero
          rf4_356(mu)%a(2,2) = czero
          rf4_356(mu)%b(1,2) = czero
          rf4_356(mu)%b(2,1) = czero
          rf4_356(mu)%c(1,2) = czero
          rf4_356(mu)%c(2,1) = czero
          rf4_356(mu)%d(1,1) = czero
          rf4_356(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p378,q=p4
      quqd=p378(0)*p4(0)-p378(1)*p4(1)-p378(2)*p4(2)-p378(3)*p4(
     & 3)
* T -- qu=p378,qd=p4,v=0,a=rz4_378(0)%a,b=rz4_378(0)%b,c=rz4_378(0)%c,d=
* rz4_378(0)%d,cr=zcr(id4),cl=zcl(id4),nsum=0
      eps_0=-p378(2)*p4(3)+p4(2)*p378(3)
      ceps_0=eps_0*cim
      ceps_1=p378(3)*cim
      ceps_2=p4(3)*cim
      auxa=-quqd+p378k0*p4(0)+p4k0*p378(0)
      rz4_378(0)%a(1,1)=zcr(id4)*(auxa+ceps_0)
      rz4_378(0)%a(2,2)=zcl(id4)*(auxa-ceps_0)
      rz4_378(0)%b(1,2)=-zcl(id4)*(p4(2)+ceps_2)
      rz4_378(0)%b(2,1)=zcr(id4)*(p4(2)-ceps_2)
      rz4_378(0)%c(1,2)=zcr(id4)*(p378(2)+ceps_1)
      rz4_378(0)%c(2,1)=zcl(id4)*(-p378(2)+ceps_1)
      rz4_378(0)%d(1,1)=zcl(id4)
      rz4_378(0)%d(2,2)=zcr(id4)
* T -- qu=p378,qd=p4,v=1,a=rz4_378(1)%a,b=rz4_378(1)%b,c=rz4_378(1)%c,d=
* rz4_378(1)%d,cr=zcr(id4),cl=zcl(id4),nsum=0
      auxa=-quqd+p378k0*p4(1)+p4k0*p378(1)
      rz4_378(1)%a(1,1)=zcr(id4)*(auxa+ceps_0)
      rz4_378(1)%a(2,2)=zcl(id4)*(auxa-ceps_0)
      rz4_378(1)%b(1,2)=-zcl(id4)*(p4(2)+ceps_2)
      rz4_378(1)%b(2,1)=zcr(id4)*(p4(2)-ceps_2)
      rz4_378(1)%c(1,2)=zcr(id4)*(p378(2)+ceps_1)
      rz4_378(1)%c(2,1)=zcl(id4)*(-p378(2)+ceps_1)
      rz4_378(1)%d(1,1)=zcl(id4)
      rz4_378(1)%d(2,2)=zcr(id4)
* T -- qu=p378,qd=p4,v=2,a=rz4_378(2)%a,b=rz4_378(2)%b,c=rz4_378(2)%c,d=
* rz4_378(2)%d,cr=zcr(id4),cl=zcl(id4),nsum=0
      eps_0=-p378k0*p4(3)+p4k0*p378(3)
      ceps_0=eps_0*cim
      auxa=p378k0*p4(2)+p4k0*p378(2)
      rz4_378(2)%a(1,1)=zcr(id4)*(auxa+ceps_0)
      rz4_378(2)%a(2,2)=zcl(id4)*(auxa-ceps_0)
      rz4_378(2)%b(1,2)=-zcl(id4)*p4k0
      rz4_378(2)%b(2,1)=zcr(id4)*p4k0
      rz4_378(2)%c(1,2)=zcr(id4)*p378k0
      rz4_378(2)%c(2,1)=-zcl(id4)*p378k0
* T -- qu=p378,qd=p4,v=3,a=rz4_378(3)%a,b=rz4_378(3)%b,c=rz4_378(3)%c,d=
* rz4_378(3)%d,cr=zcr(id4),cl=zcl(id4),nsum=0
      eps_0=p378k0*p4(2)-p4k0*p378(2)
      ceps_0=eps_0*cim
      ceps_1=p378k0*cim
      ceps_2=p4k0*cim
      auxa=+p378k0*p4(3)+p4k0*p378(3)
      rz4_378(3)%a(1,1)=zcr(id4)*(auxa+ceps_0)
      rz4_378(3)%a(2,2)=zcl(id4)*(auxa-ceps_0)
      rz4_378(3)%b(1,2)=-zcl(id4)*ceps_2
      rz4_378(3)%b(2,1)=-zcr(id4)*ceps_2
      rz4_378(3)%c(1,2)=zcr(id4)*ceps_1
      rz4_378(3)%c(2,1)=zcl(id4)*ceps_1
  
  
      if(ineutri(id4).ne.1) then
* T -- qu=p378,qd=p4,v=0,a=rf4_378(0)%a,b=rf4_378(0)%b,c=rf4_378(0)%c,d=
* rf4_378(0)%d,cr=fcr(id4),cl=fcl(id4),nsum=0
      eps_0=-p378(2)*p4(3)+p4(2)*p378(3)
      ceps_0=eps_0*cim
      ceps_1=p378(3)*cim
      ceps_2=p4(3)*cim
      auxa=-quqd+p378k0*p4(0)+p4k0*p378(0)
      rf4_378(0)%a(1,1)=fcr(id4)*(auxa+ceps_0)
      rf4_378(0)%a(2,2)=fcl(id4)*(auxa-ceps_0)
      rf4_378(0)%b(1,2)=-fcl(id4)*(p4(2)+ceps_2)
      rf4_378(0)%b(2,1)=fcr(id4)*(p4(2)-ceps_2)
      rf4_378(0)%c(1,2)=fcr(id4)*(p378(2)+ceps_1)
      rf4_378(0)%c(2,1)=fcl(id4)*(-p378(2)+ceps_1)
      rf4_378(0)%d(1,1)=fcl(id4)
      rf4_378(0)%d(2,2)=fcr(id4)
* T -- qu=p378,qd=p4,v=1,a=rf4_378(1)%a,b=rf4_378(1)%b,c=rf4_378(1)%c,d=
* rf4_378(1)%d,cr=fcr(id4),cl=fcl(id4),nsum=0
      auxa=-quqd+p378k0*p4(1)+p4k0*p378(1)
      rf4_378(1)%a(1,1)=fcr(id4)*(auxa+ceps_0)
      rf4_378(1)%a(2,2)=fcl(id4)*(auxa-ceps_0)
      rf4_378(1)%b(1,2)=-fcl(id4)*(p4(2)+ceps_2)
      rf4_378(1)%b(2,1)=fcr(id4)*(p4(2)-ceps_2)
      rf4_378(1)%c(1,2)=fcr(id4)*(p378(2)+ceps_1)
      rf4_378(1)%c(2,1)=fcl(id4)*(-p378(2)+ceps_1)
      rf4_378(1)%d(1,1)=fcl(id4)
      rf4_378(1)%d(2,2)=fcr(id4)
* T -- qu=p378,qd=p4,v=2,a=rf4_378(2)%a,b=rf4_378(2)%b,c=rf4_378(2)%c,d=
* rf4_378(2)%d,cr=fcr(id4),cl=fcl(id4),nsum=0
      eps_0=-p378k0*p4(3)+p4k0*p378(3)
      ceps_0=eps_0*cim
      auxa=p378k0*p4(2)+p4k0*p378(2)
      rf4_378(2)%a(1,1)=fcr(id4)*(auxa+ceps_0)
      rf4_378(2)%a(2,2)=fcl(id4)*(auxa-ceps_0)
      rf4_378(2)%b(1,2)=-fcl(id4)*p4k0
      rf4_378(2)%b(2,1)=fcr(id4)*p4k0
      rf4_378(2)%c(1,2)=fcr(id4)*p378k0
      rf4_378(2)%c(2,1)=-fcl(id4)*p378k0
* T -- qu=p378,qd=p4,v=3,a=rf4_378(3)%a,b=rf4_378(3)%b,c=rf4_378(3)%c,d=
* rf4_378(3)%d,cr=fcr(id4),cl=fcl(id4),nsum=0
      eps_0=p378k0*p4(2)-p4k0*p378(2)
      ceps_0=eps_0*cim
      ceps_1=p378k0*cim
      ceps_2=p4k0*cim
      auxa=+p378k0*p4(3)+p4k0*p378(3)
      rf4_378(3)%a(1,1)=fcr(id4)*(auxa+ceps_0)
      rf4_378(3)%a(2,2)=fcl(id4)*(auxa-ceps_0)
      rf4_378(3)%b(1,2)=-fcl(id4)*ceps_2
      rf4_378(3)%b(2,1)=-fcr(id4)*ceps_2
      rf4_378(3)%c(1,2)=fcr(id4)*ceps_1
      rf4_378(3)%c(2,1)=fcl(id4)*ceps_1
  
      else
        do mu=0,3
          rf4_378(mu)%a(1,1) = czero
          rf4_378(mu)%a(2,2) = czero
          rf4_378(mu)%b(1,2) = czero
          rf4_378(mu)%b(2,1) = czero
          rf4_378(mu)%c(1,2) = czero
          rf4_378(mu)%c(2,1) = czero
          rf4_378(mu)%d(1,1) = czero
          rf4_378(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p512,q=p6
      quqd=p512(0)*p6(0)-p512(1)*p6(1)-p512(2)*p6(2)-p512(3)*p6(
     & 3)
* T -- qu=p512,qd=p6,v=0,a=rz6_512(0)%a,b=rz6_512(0)%b,c=rz6_512(0)%c,d=
* rz6_512(0)%d,cr=zcr(id6),cl=zcl(id6),nsum=0
      eps_0=-p512(2)*p6(3)+p6(2)*p512(3)
      ceps_0=eps_0*cim
      ceps_1=p512(3)*cim
      ceps_2=p6(3)*cim
      auxa=-quqd+p512k0*p6(0)+p6k0*p512(0)
      rz6_512(0)%a(1,1)=zcr(id6)*(auxa+ceps_0)
      rz6_512(0)%a(2,2)=zcl(id6)*(auxa-ceps_0)
      rz6_512(0)%b(1,2)=-zcl(id6)*(p6(2)+ceps_2)
      rz6_512(0)%b(2,1)=zcr(id6)*(p6(2)-ceps_2)
      rz6_512(0)%c(1,2)=zcr(id6)*(p512(2)+ceps_1)
      rz6_512(0)%c(2,1)=zcl(id6)*(-p512(2)+ceps_1)
      rz6_512(0)%d(1,1)=zcl(id6)
      rz6_512(0)%d(2,2)=zcr(id6)
* T -- qu=p512,qd=p6,v=1,a=rz6_512(1)%a,b=rz6_512(1)%b,c=rz6_512(1)%c,d=
* rz6_512(1)%d,cr=zcr(id6),cl=zcl(id6),nsum=0
      auxa=-quqd+p512k0*p6(1)+p6k0*p512(1)
      rz6_512(1)%a(1,1)=zcr(id6)*(auxa+ceps_0)
      rz6_512(1)%a(2,2)=zcl(id6)*(auxa-ceps_0)
      rz6_512(1)%b(1,2)=-zcl(id6)*(p6(2)+ceps_2)
      rz6_512(1)%b(2,1)=zcr(id6)*(p6(2)-ceps_2)
      rz6_512(1)%c(1,2)=zcr(id6)*(p512(2)+ceps_1)
      rz6_512(1)%c(2,1)=zcl(id6)*(-p512(2)+ceps_1)
      rz6_512(1)%d(1,1)=zcl(id6)
      rz6_512(1)%d(2,2)=zcr(id6)
* T -- qu=p512,qd=p6,v=2,a=rz6_512(2)%a,b=rz6_512(2)%b,c=rz6_512(2)%c,d=
* rz6_512(2)%d,cr=zcr(id6),cl=zcl(id6),nsum=0
      eps_0=-p512k0*p6(3)+p6k0*p512(3)
      ceps_0=eps_0*cim
      auxa=p512k0*p6(2)+p6k0*p512(2)
      rz6_512(2)%a(1,1)=zcr(id6)*(auxa+ceps_0)
      rz6_512(2)%a(2,2)=zcl(id6)*(auxa-ceps_0)
      rz6_512(2)%b(1,2)=-zcl(id6)*p6k0
      rz6_512(2)%b(2,1)=zcr(id6)*p6k0
      rz6_512(2)%c(1,2)=zcr(id6)*p512k0
      rz6_512(2)%c(2,1)=-zcl(id6)*p512k0
* T -- qu=p512,qd=p6,v=3,a=rz6_512(3)%a,b=rz6_512(3)%b,c=rz6_512(3)%c,d=
* rz6_512(3)%d,cr=zcr(id6),cl=zcl(id6),nsum=0
      eps_0=p512k0*p6(2)-p6k0*p512(2)
      ceps_0=eps_0*cim
      ceps_1=p512k0*cim
      ceps_2=p6k0*cim
      auxa=+p512k0*p6(3)+p6k0*p512(3)
      rz6_512(3)%a(1,1)=zcr(id6)*(auxa+ceps_0)
      rz6_512(3)%a(2,2)=zcl(id6)*(auxa-ceps_0)
      rz6_512(3)%b(1,2)=-zcl(id6)*ceps_2
      rz6_512(3)%b(2,1)=-zcr(id6)*ceps_2
      rz6_512(3)%c(1,2)=zcr(id6)*ceps_1
      rz6_512(3)%c(2,1)=zcl(id6)*ceps_1
  
  
      if(ineutri(id6).ne.1) then
* T -- qu=p512,qd=p6,v=0,a=rf6_512(0)%a,b=rf6_512(0)%b,c=rf6_512(0)%c,d=
* rf6_512(0)%d,cr=fcr(id6),cl=fcl(id6),nsum=0
      eps_0=-p512(2)*p6(3)+p6(2)*p512(3)
      ceps_0=eps_0*cim
      ceps_1=p512(3)*cim
      ceps_2=p6(3)*cim
      auxa=-quqd+p512k0*p6(0)+p6k0*p512(0)
      rf6_512(0)%a(1,1)=fcr(id6)*(auxa+ceps_0)
      rf6_512(0)%a(2,2)=fcl(id6)*(auxa-ceps_0)
      rf6_512(0)%b(1,2)=-fcl(id6)*(p6(2)+ceps_2)
      rf6_512(0)%b(2,1)=fcr(id6)*(p6(2)-ceps_2)
      rf6_512(0)%c(1,2)=fcr(id6)*(p512(2)+ceps_1)
      rf6_512(0)%c(2,1)=fcl(id6)*(-p512(2)+ceps_1)
      rf6_512(0)%d(1,1)=fcl(id6)
      rf6_512(0)%d(2,2)=fcr(id6)
* T -- qu=p512,qd=p6,v=1,a=rf6_512(1)%a,b=rf6_512(1)%b,c=rf6_512(1)%c,d=
* rf6_512(1)%d,cr=fcr(id6),cl=fcl(id6),nsum=0
      auxa=-quqd+p512k0*p6(1)+p6k0*p512(1)
      rf6_512(1)%a(1,1)=fcr(id6)*(auxa+ceps_0)
      rf6_512(1)%a(2,2)=fcl(id6)*(auxa-ceps_0)
      rf6_512(1)%b(1,2)=-fcl(id6)*(p6(2)+ceps_2)
      rf6_512(1)%b(2,1)=fcr(id6)*(p6(2)-ceps_2)
      rf6_512(1)%c(1,2)=fcr(id6)*(p512(2)+ceps_1)
      rf6_512(1)%c(2,1)=fcl(id6)*(-p512(2)+ceps_1)
      rf6_512(1)%d(1,1)=fcl(id6)
      rf6_512(1)%d(2,2)=fcr(id6)
* T -- qu=p512,qd=p6,v=2,a=rf6_512(2)%a,b=rf6_512(2)%b,c=rf6_512(2)%c,d=
* rf6_512(2)%d,cr=fcr(id6),cl=fcl(id6),nsum=0
      eps_0=-p512k0*p6(3)+p6k0*p512(3)
      ceps_0=eps_0*cim
      auxa=p512k0*p6(2)+p6k0*p512(2)
      rf6_512(2)%a(1,1)=fcr(id6)*(auxa+ceps_0)
      rf6_512(2)%a(2,2)=fcl(id6)*(auxa-ceps_0)
      rf6_512(2)%b(1,2)=-fcl(id6)*p6k0
      rf6_512(2)%b(2,1)=fcr(id6)*p6k0
      rf6_512(2)%c(1,2)=fcr(id6)*p512k0
      rf6_512(2)%c(2,1)=-fcl(id6)*p512k0
* T -- qu=p512,qd=p6,v=3,a=rf6_512(3)%a,b=rf6_512(3)%b,c=rf6_512(3)%c,d=
* rf6_512(3)%d,cr=fcr(id6),cl=fcl(id6),nsum=0
      eps_0=p512k0*p6(2)-p6k0*p512(2)
      ceps_0=eps_0*cim
      ceps_1=p512k0*cim
      ceps_2=p6k0*cim
      auxa=+p512k0*p6(3)+p6k0*p512(3)
      rf6_512(3)%a(1,1)=fcr(id6)*(auxa+ceps_0)
      rf6_512(3)%a(2,2)=fcl(id6)*(auxa-ceps_0)
      rf6_512(3)%b(1,2)=-fcl(id6)*ceps_2
      rf6_512(3)%b(2,1)=-fcr(id6)*ceps_2
      rf6_512(3)%c(1,2)=fcr(id6)*ceps_1
      rf6_512(3)%c(2,1)=fcl(id6)*ceps_1
  
      else
        do mu=0,3
          rf6_512(mu)%a(1,1) = czero
          rf6_512(mu)%a(2,2) = czero
          rf6_512(mu)%b(1,2) = czero
          rf6_512(mu)%b(2,1) = czero
          rf6_512(mu)%c(1,2) = czero
          rf6_512(mu)%c(2,1) = czero
          rf6_512(mu)%d(1,1) = czero
          rf6_512(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p534,q=p6
      quqd=p534(0)*p6(0)-p534(1)*p6(1)-p534(2)*p6(2)-p534(3)*p6(
     & 3)
* T -- qu=p534,qd=p6,v=0,a=rz6_534(0)%a,b=rz6_534(0)%b,c=rz6_534(0)%c,d=
* rz6_534(0)%d,cr=zcr(id6),cl=zcl(id6),nsum=0
      eps_0=-p534(2)*p6(3)+p6(2)*p534(3)
      ceps_0=eps_0*cim
      ceps_1=p534(3)*cim
      ceps_2=p6(3)*cim
      auxa=-quqd+p534k0*p6(0)+p6k0*p534(0)
      rz6_534(0)%a(1,1)=zcr(id6)*(auxa+ceps_0)
      rz6_534(0)%a(2,2)=zcl(id6)*(auxa-ceps_0)
      rz6_534(0)%b(1,2)=-zcl(id6)*(p6(2)+ceps_2)
      rz6_534(0)%b(2,1)=zcr(id6)*(p6(2)-ceps_2)
      rz6_534(0)%c(1,2)=zcr(id6)*(p534(2)+ceps_1)
      rz6_534(0)%c(2,1)=zcl(id6)*(-p534(2)+ceps_1)
      rz6_534(0)%d(1,1)=zcl(id6)
      rz6_534(0)%d(2,2)=zcr(id6)
* T -- qu=p534,qd=p6,v=1,a=rz6_534(1)%a,b=rz6_534(1)%b,c=rz6_534(1)%c,d=
* rz6_534(1)%d,cr=zcr(id6),cl=zcl(id6),nsum=0
      auxa=-quqd+p534k0*p6(1)+p6k0*p534(1)
      rz6_534(1)%a(1,1)=zcr(id6)*(auxa+ceps_0)
      rz6_534(1)%a(2,2)=zcl(id6)*(auxa-ceps_0)
      rz6_534(1)%b(1,2)=-zcl(id6)*(p6(2)+ceps_2)
      rz6_534(1)%b(2,1)=zcr(id6)*(p6(2)-ceps_2)
      rz6_534(1)%c(1,2)=zcr(id6)*(p534(2)+ceps_1)
      rz6_534(1)%c(2,1)=zcl(id6)*(-p534(2)+ceps_1)
      rz6_534(1)%d(1,1)=zcl(id6)
      rz6_534(1)%d(2,2)=zcr(id6)
* T -- qu=p534,qd=p6,v=2,a=rz6_534(2)%a,b=rz6_534(2)%b,c=rz6_534(2)%c,d=
* rz6_534(2)%d,cr=zcr(id6),cl=zcl(id6),nsum=0
      eps_0=-p534k0*p6(3)+p6k0*p534(3)
      ceps_0=eps_0*cim
      auxa=p534k0*p6(2)+p6k0*p534(2)
      rz6_534(2)%a(1,1)=zcr(id6)*(auxa+ceps_0)
      rz6_534(2)%a(2,2)=zcl(id6)*(auxa-ceps_0)
      rz6_534(2)%b(1,2)=-zcl(id6)*p6k0
      rz6_534(2)%b(2,1)=zcr(id6)*p6k0
      rz6_534(2)%c(1,2)=zcr(id6)*p534k0
      rz6_534(2)%c(2,1)=-zcl(id6)*p534k0
* T -- qu=p534,qd=p6,v=3,a=rz6_534(3)%a,b=rz6_534(3)%b,c=rz6_534(3)%c,d=
* rz6_534(3)%d,cr=zcr(id6),cl=zcl(id6),nsum=0
      eps_0=p534k0*p6(2)-p6k0*p534(2)
      ceps_0=eps_0*cim
      ceps_1=p534k0*cim
      ceps_2=p6k0*cim
      auxa=+p534k0*p6(3)+p6k0*p534(3)
      rz6_534(3)%a(1,1)=zcr(id6)*(auxa+ceps_0)
      rz6_534(3)%a(2,2)=zcl(id6)*(auxa-ceps_0)
      rz6_534(3)%b(1,2)=-zcl(id6)*ceps_2
      rz6_534(3)%b(2,1)=-zcr(id6)*ceps_2
      rz6_534(3)%c(1,2)=zcr(id6)*ceps_1
      rz6_534(3)%c(2,1)=zcl(id6)*ceps_1
  
  
      if(ineutri(id6).ne.1) then
* T -- qu=p534,qd=p6,v=0,a=rf6_534(0)%a,b=rf6_534(0)%b,c=rf6_534(0)%c,d=
* rf6_534(0)%d,cr=fcr(id6),cl=fcl(id6),nsum=0
      eps_0=-p534(2)*p6(3)+p6(2)*p534(3)
      ceps_0=eps_0*cim
      ceps_1=p534(3)*cim
      ceps_2=p6(3)*cim
      auxa=-quqd+p534k0*p6(0)+p6k0*p534(0)
      rf6_534(0)%a(1,1)=fcr(id6)*(auxa+ceps_0)
      rf6_534(0)%a(2,2)=fcl(id6)*(auxa-ceps_0)
      rf6_534(0)%b(1,2)=-fcl(id6)*(p6(2)+ceps_2)
      rf6_534(0)%b(2,1)=fcr(id6)*(p6(2)-ceps_2)
      rf6_534(0)%c(1,2)=fcr(id6)*(p534(2)+ceps_1)
      rf6_534(0)%c(2,1)=fcl(id6)*(-p534(2)+ceps_1)
      rf6_534(0)%d(1,1)=fcl(id6)
      rf6_534(0)%d(2,2)=fcr(id6)
* T -- qu=p534,qd=p6,v=1,a=rf6_534(1)%a,b=rf6_534(1)%b,c=rf6_534(1)%c,d=
* rf6_534(1)%d,cr=fcr(id6),cl=fcl(id6),nsum=0
      auxa=-quqd+p534k0*p6(1)+p6k0*p534(1)
      rf6_534(1)%a(1,1)=fcr(id6)*(auxa+ceps_0)
      rf6_534(1)%a(2,2)=fcl(id6)*(auxa-ceps_0)
      rf6_534(1)%b(1,2)=-fcl(id6)*(p6(2)+ceps_2)
      rf6_534(1)%b(2,1)=fcr(id6)*(p6(2)-ceps_2)
      rf6_534(1)%c(1,2)=fcr(id6)*(p534(2)+ceps_1)
      rf6_534(1)%c(2,1)=fcl(id6)*(-p534(2)+ceps_1)
      rf6_534(1)%d(1,1)=fcl(id6)
      rf6_534(1)%d(2,2)=fcr(id6)
* T -- qu=p534,qd=p6,v=2,a=rf6_534(2)%a,b=rf6_534(2)%b,c=rf6_534(2)%c,d=
* rf6_534(2)%d,cr=fcr(id6),cl=fcl(id6),nsum=0
      eps_0=-p534k0*p6(3)+p6k0*p534(3)
      ceps_0=eps_0*cim
      auxa=p534k0*p6(2)+p6k0*p534(2)
      rf6_534(2)%a(1,1)=fcr(id6)*(auxa+ceps_0)
      rf6_534(2)%a(2,2)=fcl(id6)*(auxa-ceps_0)
      rf6_534(2)%b(1,2)=-fcl(id6)*p6k0
      rf6_534(2)%b(2,1)=fcr(id6)*p6k0
      rf6_534(2)%c(1,2)=fcr(id6)*p534k0
      rf6_534(2)%c(2,1)=-fcl(id6)*p534k0
* T -- qu=p534,qd=p6,v=3,a=rf6_534(3)%a,b=rf6_534(3)%b,c=rf6_534(3)%c,d=
* rf6_534(3)%d,cr=fcr(id6),cl=fcl(id6),nsum=0
      eps_0=p534k0*p6(2)-p6k0*p534(2)
      ceps_0=eps_0*cim
      ceps_1=p534k0*cim
      ceps_2=p6k0*cim
      auxa=+p534k0*p6(3)+p6k0*p534(3)
      rf6_534(3)%a(1,1)=fcr(id6)*(auxa+ceps_0)
      rf6_534(3)%a(2,2)=fcl(id6)*(auxa-ceps_0)
      rf6_534(3)%b(1,2)=-fcl(id6)*ceps_2
      rf6_534(3)%b(2,1)=-fcr(id6)*ceps_2
      rf6_534(3)%c(1,2)=fcr(id6)*ceps_1
      rf6_534(3)%c(2,1)=fcl(id6)*ceps_1
  
      else
        do mu=0,3
          rf6_534(mu)%a(1,1) = czero
          rf6_534(mu)%a(2,2) = czero
          rf6_534(mu)%b(1,2) = czero
          rf6_534(mu)%b(2,1) = czero
          rf6_534(mu)%c(1,2) = czero
          rf6_534(mu)%c(2,1) = czero
          rf6_534(mu)%d(1,1) = czero
          rf6_534(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p578,q=p6
      quqd=p578(0)*p6(0)-p578(1)*p6(1)-p578(2)*p6(2)-p578(3)*p6(
     & 3)
* T -- qu=p578,qd=p6,v=0,a=rz6_578(0)%a,b=rz6_578(0)%b,c=rz6_578(0)%c,d=
* rz6_578(0)%d,cr=zcr(id6),cl=zcl(id6),nsum=0
      eps_0=-p578(2)*p6(3)+p6(2)*p578(3)
      ceps_0=eps_0*cim
      ceps_1=p578(3)*cim
      ceps_2=p6(3)*cim
      auxa=-quqd+p578k0*p6(0)+p6k0*p578(0)
      rz6_578(0)%a(1,1)=zcr(id6)*(auxa+ceps_0)
      rz6_578(0)%a(2,2)=zcl(id6)*(auxa-ceps_0)
      rz6_578(0)%b(1,2)=-zcl(id6)*(p6(2)+ceps_2)
      rz6_578(0)%b(2,1)=zcr(id6)*(p6(2)-ceps_2)
      rz6_578(0)%c(1,2)=zcr(id6)*(p578(2)+ceps_1)
      rz6_578(0)%c(2,1)=zcl(id6)*(-p578(2)+ceps_1)
      rz6_578(0)%d(1,1)=zcl(id6)
      rz6_578(0)%d(2,2)=zcr(id6)
* T -- qu=p578,qd=p6,v=1,a=rz6_578(1)%a,b=rz6_578(1)%b,c=rz6_578(1)%c,d=
* rz6_578(1)%d,cr=zcr(id6),cl=zcl(id6),nsum=0
      auxa=-quqd+p578k0*p6(1)+p6k0*p578(1)
      rz6_578(1)%a(1,1)=zcr(id6)*(auxa+ceps_0)
      rz6_578(1)%a(2,2)=zcl(id6)*(auxa-ceps_0)
      rz6_578(1)%b(1,2)=-zcl(id6)*(p6(2)+ceps_2)
      rz6_578(1)%b(2,1)=zcr(id6)*(p6(2)-ceps_2)
      rz6_578(1)%c(1,2)=zcr(id6)*(p578(2)+ceps_1)
      rz6_578(1)%c(2,1)=zcl(id6)*(-p578(2)+ceps_1)
      rz6_578(1)%d(1,1)=zcl(id6)
      rz6_578(1)%d(2,2)=zcr(id6)
* T -- qu=p578,qd=p6,v=2,a=rz6_578(2)%a,b=rz6_578(2)%b,c=rz6_578(2)%c,d=
* rz6_578(2)%d,cr=zcr(id6),cl=zcl(id6),nsum=0
      eps_0=-p578k0*p6(3)+p6k0*p578(3)
      ceps_0=eps_0*cim
      auxa=p578k0*p6(2)+p6k0*p578(2)
      rz6_578(2)%a(1,1)=zcr(id6)*(auxa+ceps_0)
      rz6_578(2)%a(2,2)=zcl(id6)*(auxa-ceps_0)
      rz6_578(2)%b(1,2)=-zcl(id6)*p6k0
      rz6_578(2)%b(2,1)=zcr(id6)*p6k0
      rz6_578(2)%c(1,2)=zcr(id6)*p578k0
      rz6_578(2)%c(2,1)=-zcl(id6)*p578k0
* T -- qu=p578,qd=p6,v=3,a=rz6_578(3)%a,b=rz6_578(3)%b,c=rz6_578(3)%c,d=
* rz6_578(3)%d,cr=zcr(id6),cl=zcl(id6),nsum=0
      eps_0=p578k0*p6(2)-p6k0*p578(2)
      ceps_0=eps_0*cim
      ceps_1=p578k0*cim
      ceps_2=p6k0*cim
      auxa=+p578k0*p6(3)+p6k0*p578(3)
      rz6_578(3)%a(1,1)=zcr(id6)*(auxa+ceps_0)
      rz6_578(3)%a(2,2)=zcl(id6)*(auxa-ceps_0)
      rz6_578(3)%b(1,2)=-zcl(id6)*ceps_2
      rz6_578(3)%b(2,1)=-zcr(id6)*ceps_2
      rz6_578(3)%c(1,2)=zcr(id6)*ceps_1
      rz6_578(3)%c(2,1)=zcl(id6)*ceps_1
  
  
      if(ineutri(id6).ne.1) then
* T -- qu=p578,qd=p6,v=0,a=rf6_578(0)%a,b=rf6_578(0)%b,c=rf6_578(0)%c,d=
* rf6_578(0)%d,cr=fcr(id6),cl=fcl(id6),nsum=0
      eps_0=-p578(2)*p6(3)+p6(2)*p578(3)
      ceps_0=eps_0*cim
      ceps_1=p578(3)*cim
      ceps_2=p6(3)*cim
      auxa=-quqd+p578k0*p6(0)+p6k0*p578(0)
      rf6_578(0)%a(1,1)=fcr(id6)*(auxa+ceps_0)
      rf6_578(0)%a(2,2)=fcl(id6)*(auxa-ceps_0)
      rf6_578(0)%b(1,2)=-fcl(id6)*(p6(2)+ceps_2)
      rf6_578(0)%b(2,1)=fcr(id6)*(p6(2)-ceps_2)
      rf6_578(0)%c(1,2)=fcr(id6)*(p578(2)+ceps_1)
      rf6_578(0)%c(2,1)=fcl(id6)*(-p578(2)+ceps_1)
      rf6_578(0)%d(1,1)=fcl(id6)
      rf6_578(0)%d(2,2)=fcr(id6)
* T -- qu=p578,qd=p6,v=1,a=rf6_578(1)%a,b=rf6_578(1)%b,c=rf6_578(1)%c,d=
* rf6_578(1)%d,cr=fcr(id6),cl=fcl(id6),nsum=0
      auxa=-quqd+p578k0*p6(1)+p6k0*p578(1)
      rf6_578(1)%a(1,1)=fcr(id6)*(auxa+ceps_0)
      rf6_578(1)%a(2,2)=fcl(id6)*(auxa-ceps_0)
      rf6_578(1)%b(1,2)=-fcl(id6)*(p6(2)+ceps_2)
      rf6_578(1)%b(2,1)=fcr(id6)*(p6(2)-ceps_2)
      rf6_578(1)%c(1,2)=fcr(id6)*(p578(2)+ceps_1)
      rf6_578(1)%c(2,1)=fcl(id6)*(-p578(2)+ceps_1)
      rf6_578(1)%d(1,1)=fcl(id6)
      rf6_578(1)%d(2,2)=fcr(id6)
* T -- qu=p578,qd=p6,v=2,a=rf6_578(2)%a,b=rf6_578(2)%b,c=rf6_578(2)%c,d=
* rf6_578(2)%d,cr=fcr(id6),cl=fcl(id6),nsum=0
      eps_0=-p578k0*p6(3)+p6k0*p578(3)
      ceps_0=eps_0*cim
      auxa=p578k0*p6(2)+p6k0*p578(2)
      rf6_578(2)%a(1,1)=fcr(id6)*(auxa+ceps_0)
      rf6_578(2)%a(2,2)=fcl(id6)*(auxa-ceps_0)
      rf6_578(2)%b(1,2)=-fcl(id6)*p6k0
      rf6_578(2)%b(2,1)=fcr(id6)*p6k0
      rf6_578(2)%c(1,2)=fcr(id6)*p578k0
      rf6_578(2)%c(2,1)=-fcl(id6)*p578k0
* T -- qu=p578,qd=p6,v=3,a=rf6_578(3)%a,b=rf6_578(3)%b,c=rf6_578(3)%c,d=
* rf6_578(3)%d,cr=fcr(id6),cl=fcl(id6),nsum=0
      eps_0=p578k0*p6(2)-p6k0*p578(2)
      ceps_0=eps_0*cim
      ceps_1=p578k0*cim
      ceps_2=p6k0*cim
      auxa=+p578k0*p6(3)+p6k0*p578(3)
      rf6_578(3)%a(1,1)=fcr(id6)*(auxa+ceps_0)
      rf6_578(3)%a(2,2)=fcl(id6)*(auxa-ceps_0)
      rf6_578(3)%b(1,2)=-fcl(id6)*ceps_2
      rf6_578(3)%b(2,1)=-fcr(id6)*ceps_2
      rf6_578(3)%c(1,2)=fcr(id6)*ceps_1
      rf6_578(3)%c(2,1)=fcl(id6)*ceps_1
  
      else
        do mu=0,3
          rf6_578(mu)%a(1,1) = czero
          rf6_578(mu)%a(2,2) = czero
          rf6_578(mu)%b(1,2) = czero
          rf6_578(mu)%b(2,1) = czero
          rf6_578(mu)%c(1,2) = czero
          rf6_578(mu)%c(2,1) = czero
          rf6_578(mu)%d(1,1) = czero
          rf6_578(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p712,q=p8
      quqd=p712(0)*p8(0)-p712(1)*p8(1)-p712(2)*p8(2)-p712(3)*p8(
     & 3)
* T -- qu=p712,qd=p8,v=0,a=rz8_712(0)%a,b=rz8_712(0)%b,c=rz8_712(0)%c,d=
* rz8_712(0)%d,cr=zcr(id8),cl=zcl(id8),nsum=0
      eps_0=-p712(2)*p8(3)+p8(2)*p712(3)
      ceps_0=eps_0*cim
      ceps_1=p712(3)*cim
      ceps_2=p8(3)*cim
      auxa=-quqd+p712k0*p8(0)+p8k0*p712(0)
      rz8_712(0)%a(1,1)=zcr(id8)*(auxa+ceps_0)
      rz8_712(0)%a(2,2)=zcl(id8)*(auxa-ceps_0)
      rz8_712(0)%b(1,2)=-zcl(id8)*(p8(2)+ceps_2)
      rz8_712(0)%b(2,1)=zcr(id8)*(p8(2)-ceps_2)
      rz8_712(0)%c(1,2)=zcr(id8)*(p712(2)+ceps_1)
      rz8_712(0)%c(2,1)=zcl(id8)*(-p712(2)+ceps_1)
      rz8_712(0)%d(1,1)=zcl(id8)
      rz8_712(0)%d(2,2)=zcr(id8)
* T -- qu=p712,qd=p8,v=1,a=rz8_712(1)%a,b=rz8_712(1)%b,c=rz8_712(1)%c,d=
* rz8_712(1)%d,cr=zcr(id8),cl=zcl(id8),nsum=0
      auxa=-quqd+p712k0*p8(1)+p8k0*p712(1)
      rz8_712(1)%a(1,1)=zcr(id8)*(auxa+ceps_0)
      rz8_712(1)%a(2,2)=zcl(id8)*(auxa-ceps_0)
      rz8_712(1)%b(1,2)=-zcl(id8)*(p8(2)+ceps_2)
      rz8_712(1)%b(2,1)=zcr(id8)*(p8(2)-ceps_2)
      rz8_712(1)%c(1,2)=zcr(id8)*(p712(2)+ceps_1)
      rz8_712(1)%c(2,1)=zcl(id8)*(-p712(2)+ceps_1)
      rz8_712(1)%d(1,1)=zcl(id8)
      rz8_712(1)%d(2,2)=zcr(id8)
* T -- qu=p712,qd=p8,v=2,a=rz8_712(2)%a,b=rz8_712(2)%b,c=rz8_712(2)%c,d=
* rz8_712(2)%d,cr=zcr(id8),cl=zcl(id8),nsum=0
      eps_0=-p712k0*p8(3)+p8k0*p712(3)
      ceps_0=eps_0*cim
      auxa=p712k0*p8(2)+p8k0*p712(2)
      rz8_712(2)%a(1,1)=zcr(id8)*(auxa+ceps_0)
      rz8_712(2)%a(2,2)=zcl(id8)*(auxa-ceps_0)
      rz8_712(2)%b(1,2)=-zcl(id8)*p8k0
      rz8_712(2)%b(2,1)=zcr(id8)*p8k0
      rz8_712(2)%c(1,2)=zcr(id8)*p712k0
      rz8_712(2)%c(2,1)=-zcl(id8)*p712k0
* T -- qu=p712,qd=p8,v=3,a=rz8_712(3)%a,b=rz8_712(3)%b,c=rz8_712(3)%c,d=
* rz8_712(3)%d,cr=zcr(id8),cl=zcl(id8),nsum=0
      eps_0=p712k0*p8(2)-p8k0*p712(2)
      ceps_0=eps_0*cim
      ceps_1=p712k0*cim
      ceps_2=p8k0*cim
      auxa=+p712k0*p8(3)+p8k0*p712(3)
      rz8_712(3)%a(1,1)=zcr(id8)*(auxa+ceps_0)
      rz8_712(3)%a(2,2)=zcl(id8)*(auxa-ceps_0)
      rz8_712(3)%b(1,2)=-zcl(id8)*ceps_2
      rz8_712(3)%b(2,1)=-zcr(id8)*ceps_2
      rz8_712(3)%c(1,2)=zcr(id8)*ceps_1
      rz8_712(3)%c(2,1)=zcl(id8)*ceps_1
  
  
      if(ineutri(id8).ne.1) then
* T -- qu=p712,qd=p8,v=0,a=rf8_712(0)%a,b=rf8_712(0)%b,c=rf8_712(0)%c,d=
* rf8_712(0)%d,cr=fcr(id8),cl=fcl(id8),nsum=0
      eps_0=-p712(2)*p8(3)+p8(2)*p712(3)
      ceps_0=eps_0*cim
      ceps_1=p712(3)*cim
      ceps_2=p8(3)*cim
      auxa=-quqd+p712k0*p8(0)+p8k0*p712(0)
      rf8_712(0)%a(1,1)=fcr(id8)*(auxa+ceps_0)
      rf8_712(0)%a(2,2)=fcl(id8)*(auxa-ceps_0)
      rf8_712(0)%b(1,2)=-fcl(id8)*(p8(2)+ceps_2)
      rf8_712(0)%b(2,1)=fcr(id8)*(p8(2)-ceps_2)
      rf8_712(0)%c(1,2)=fcr(id8)*(p712(2)+ceps_1)
      rf8_712(0)%c(2,1)=fcl(id8)*(-p712(2)+ceps_1)
      rf8_712(0)%d(1,1)=fcl(id8)
      rf8_712(0)%d(2,2)=fcr(id8)
* T -- qu=p712,qd=p8,v=1,a=rf8_712(1)%a,b=rf8_712(1)%b,c=rf8_712(1)%c,d=
* rf8_712(1)%d,cr=fcr(id8),cl=fcl(id8),nsum=0
      auxa=-quqd+p712k0*p8(1)+p8k0*p712(1)
      rf8_712(1)%a(1,1)=fcr(id8)*(auxa+ceps_0)
      rf8_712(1)%a(2,2)=fcl(id8)*(auxa-ceps_0)
      rf8_712(1)%b(1,2)=-fcl(id8)*(p8(2)+ceps_2)
      rf8_712(1)%b(2,1)=fcr(id8)*(p8(2)-ceps_2)
      rf8_712(1)%c(1,2)=fcr(id8)*(p712(2)+ceps_1)
      rf8_712(1)%c(2,1)=fcl(id8)*(-p712(2)+ceps_1)
      rf8_712(1)%d(1,1)=fcl(id8)
      rf8_712(1)%d(2,2)=fcr(id8)
* T -- qu=p712,qd=p8,v=2,a=rf8_712(2)%a,b=rf8_712(2)%b,c=rf8_712(2)%c,d=
* rf8_712(2)%d,cr=fcr(id8),cl=fcl(id8),nsum=0
      eps_0=-p712k0*p8(3)+p8k0*p712(3)
      ceps_0=eps_0*cim
      auxa=p712k0*p8(2)+p8k0*p712(2)
      rf8_712(2)%a(1,1)=fcr(id8)*(auxa+ceps_0)
      rf8_712(2)%a(2,2)=fcl(id8)*(auxa-ceps_0)
      rf8_712(2)%b(1,2)=-fcl(id8)*p8k0
      rf8_712(2)%b(2,1)=fcr(id8)*p8k0
      rf8_712(2)%c(1,2)=fcr(id8)*p712k0
      rf8_712(2)%c(2,1)=-fcl(id8)*p712k0
* T -- qu=p712,qd=p8,v=3,a=rf8_712(3)%a,b=rf8_712(3)%b,c=rf8_712(3)%c,d=
* rf8_712(3)%d,cr=fcr(id8),cl=fcl(id8),nsum=0
      eps_0=p712k0*p8(2)-p8k0*p712(2)
      ceps_0=eps_0*cim
      ceps_1=p712k0*cim
      ceps_2=p8k0*cim
      auxa=+p712k0*p8(3)+p8k0*p712(3)
      rf8_712(3)%a(1,1)=fcr(id8)*(auxa+ceps_0)
      rf8_712(3)%a(2,2)=fcl(id8)*(auxa-ceps_0)
      rf8_712(3)%b(1,2)=-fcl(id8)*ceps_2
      rf8_712(3)%b(2,1)=-fcr(id8)*ceps_2
      rf8_712(3)%c(1,2)=fcr(id8)*ceps_1
      rf8_712(3)%c(2,1)=fcl(id8)*ceps_1
  
      else
        do mu=0,3
          rf8_712(mu)%a(1,1) = czero
          rf8_712(mu)%a(2,2) = czero
          rf8_712(mu)%b(1,2) = czero
          rf8_712(mu)%b(2,1) = czero
          rf8_712(mu)%c(1,2) = czero
          rf8_712(mu)%c(2,1) = czero
          rf8_712(mu)%d(1,1) = czero
          rf8_712(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p734,q=p8
      quqd=p734(0)*p8(0)-p734(1)*p8(1)-p734(2)*p8(2)-p734(3)*p8(
     & 3)
* T -- qu=p734,qd=p8,v=0,a=rz8_734(0)%a,b=rz8_734(0)%b,c=rz8_734(0)%c,d=
* rz8_734(0)%d,cr=zcr(id8),cl=zcl(id8),nsum=0
      eps_0=-p734(2)*p8(3)+p8(2)*p734(3)
      ceps_0=eps_0*cim
      ceps_1=p734(3)*cim
      ceps_2=p8(3)*cim
      auxa=-quqd+p734k0*p8(0)+p8k0*p734(0)
      rz8_734(0)%a(1,1)=zcr(id8)*(auxa+ceps_0)
      rz8_734(0)%a(2,2)=zcl(id8)*(auxa-ceps_0)
      rz8_734(0)%b(1,2)=-zcl(id8)*(p8(2)+ceps_2)
      rz8_734(0)%b(2,1)=zcr(id8)*(p8(2)-ceps_2)
      rz8_734(0)%c(1,2)=zcr(id8)*(p734(2)+ceps_1)
      rz8_734(0)%c(2,1)=zcl(id8)*(-p734(2)+ceps_1)
      rz8_734(0)%d(1,1)=zcl(id8)
      rz8_734(0)%d(2,2)=zcr(id8)
* T -- qu=p734,qd=p8,v=1,a=rz8_734(1)%a,b=rz8_734(1)%b,c=rz8_734(1)%c,d=
* rz8_734(1)%d,cr=zcr(id8),cl=zcl(id8),nsum=0
      auxa=-quqd+p734k0*p8(1)+p8k0*p734(1)
      rz8_734(1)%a(1,1)=zcr(id8)*(auxa+ceps_0)
      rz8_734(1)%a(2,2)=zcl(id8)*(auxa-ceps_0)
      rz8_734(1)%b(1,2)=-zcl(id8)*(p8(2)+ceps_2)
      rz8_734(1)%b(2,1)=zcr(id8)*(p8(2)-ceps_2)
      rz8_734(1)%c(1,2)=zcr(id8)*(p734(2)+ceps_1)
      rz8_734(1)%c(2,1)=zcl(id8)*(-p734(2)+ceps_1)
      rz8_734(1)%d(1,1)=zcl(id8)
      rz8_734(1)%d(2,2)=zcr(id8)
* T -- qu=p734,qd=p8,v=2,a=rz8_734(2)%a,b=rz8_734(2)%b,c=rz8_734(2)%c,d=
* rz8_734(2)%d,cr=zcr(id8),cl=zcl(id8),nsum=0
      eps_0=-p734k0*p8(3)+p8k0*p734(3)
      ceps_0=eps_0*cim
      auxa=p734k0*p8(2)+p8k0*p734(2)
      rz8_734(2)%a(1,1)=zcr(id8)*(auxa+ceps_0)
      rz8_734(2)%a(2,2)=zcl(id8)*(auxa-ceps_0)
      rz8_734(2)%b(1,2)=-zcl(id8)*p8k0
      rz8_734(2)%b(2,1)=zcr(id8)*p8k0
      rz8_734(2)%c(1,2)=zcr(id8)*p734k0
      rz8_734(2)%c(2,1)=-zcl(id8)*p734k0
* T -- qu=p734,qd=p8,v=3,a=rz8_734(3)%a,b=rz8_734(3)%b,c=rz8_734(3)%c,d=
* rz8_734(3)%d,cr=zcr(id8),cl=zcl(id8),nsum=0
      eps_0=p734k0*p8(2)-p8k0*p734(2)
      ceps_0=eps_0*cim
      ceps_1=p734k0*cim
      ceps_2=p8k0*cim
      auxa=+p734k0*p8(3)+p8k0*p734(3)
      rz8_734(3)%a(1,1)=zcr(id8)*(auxa+ceps_0)
      rz8_734(3)%a(2,2)=zcl(id8)*(auxa-ceps_0)
      rz8_734(3)%b(1,2)=-zcl(id8)*ceps_2
      rz8_734(3)%b(2,1)=-zcr(id8)*ceps_2
      rz8_734(3)%c(1,2)=zcr(id8)*ceps_1
      rz8_734(3)%c(2,1)=zcl(id8)*ceps_1
  
  
      if(ineutri(id8).ne.1) then
* T -- qu=p734,qd=p8,v=0,a=rf8_734(0)%a,b=rf8_734(0)%b,c=rf8_734(0)%c,d=
* rf8_734(0)%d,cr=fcr(id8),cl=fcl(id8),nsum=0
      eps_0=-p734(2)*p8(3)+p8(2)*p734(3)
      ceps_0=eps_0*cim
      ceps_1=p734(3)*cim
      ceps_2=p8(3)*cim
      auxa=-quqd+p734k0*p8(0)+p8k0*p734(0)
      rf8_734(0)%a(1,1)=fcr(id8)*(auxa+ceps_0)
      rf8_734(0)%a(2,2)=fcl(id8)*(auxa-ceps_0)
      rf8_734(0)%b(1,2)=-fcl(id8)*(p8(2)+ceps_2)
      rf8_734(0)%b(2,1)=fcr(id8)*(p8(2)-ceps_2)
      rf8_734(0)%c(1,2)=fcr(id8)*(p734(2)+ceps_1)
      rf8_734(0)%c(2,1)=fcl(id8)*(-p734(2)+ceps_1)
      rf8_734(0)%d(1,1)=fcl(id8)
      rf8_734(0)%d(2,2)=fcr(id8)
* T -- qu=p734,qd=p8,v=1,a=rf8_734(1)%a,b=rf8_734(1)%b,c=rf8_734(1)%c,d=
* rf8_734(1)%d,cr=fcr(id8),cl=fcl(id8),nsum=0
      auxa=-quqd+p734k0*p8(1)+p8k0*p734(1)
      rf8_734(1)%a(1,1)=fcr(id8)*(auxa+ceps_0)
      rf8_734(1)%a(2,2)=fcl(id8)*(auxa-ceps_0)
      rf8_734(1)%b(1,2)=-fcl(id8)*(p8(2)+ceps_2)
      rf8_734(1)%b(2,1)=fcr(id8)*(p8(2)-ceps_2)
      rf8_734(1)%c(1,2)=fcr(id8)*(p734(2)+ceps_1)
      rf8_734(1)%c(2,1)=fcl(id8)*(-p734(2)+ceps_1)
      rf8_734(1)%d(1,1)=fcl(id8)
      rf8_734(1)%d(2,2)=fcr(id8)
* T -- qu=p734,qd=p8,v=2,a=rf8_734(2)%a,b=rf8_734(2)%b,c=rf8_734(2)%c,d=
* rf8_734(2)%d,cr=fcr(id8),cl=fcl(id8),nsum=0
      eps_0=-p734k0*p8(3)+p8k0*p734(3)
      ceps_0=eps_0*cim
      auxa=p734k0*p8(2)+p8k0*p734(2)
      rf8_734(2)%a(1,1)=fcr(id8)*(auxa+ceps_0)
      rf8_734(2)%a(2,2)=fcl(id8)*(auxa-ceps_0)
      rf8_734(2)%b(1,2)=-fcl(id8)*p8k0
      rf8_734(2)%b(2,1)=fcr(id8)*p8k0
      rf8_734(2)%c(1,2)=fcr(id8)*p734k0
      rf8_734(2)%c(2,1)=-fcl(id8)*p734k0
* T -- qu=p734,qd=p8,v=3,a=rf8_734(3)%a,b=rf8_734(3)%b,c=rf8_734(3)%c,d=
* rf8_734(3)%d,cr=fcr(id8),cl=fcl(id8),nsum=0
      eps_0=p734k0*p8(2)-p8k0*p734(2)
      ceps_0=eps_0*cim
      ceps_1=p734k0*cim
      ceps_2=p8k0*cim
      auxa=+p734k0*p8(3)+p8k0*p734(3)
      rf8_734(3)%a(1,1)=fcr(id8)*(auxa+ceps_0)
      rf8_734(3)%a(2,2)=fcl(id8)*(auxa-ceps_0)
      rf8_734(3)%b(1,2)=-fcl(id8)*ceps_2
      rf8_734(3)%b(2,1)=-fcr(id8)*ceps_2
      rf8_734(3)%c(1,2)=fcr(id8)*ceps_1
      rf8_734(3)%c(2,1)=fcl(id8)*ceps_1
  
      else
        do mu=0,3
          rf8_734(mu)%a(1,1) = czero
          rf8_734(mu)%a(2,2) = czero
          rf8_734(mu)%b(1,2) = czero
          rf8_734(mu)%b(2,1) = czero
          rf8_734(mu)%c(1,2) = czero
          rf8_734(mu)%c(2,1) = czero
          rf8_734(mu)%d(1,1) = czero
          rf8_734(mu)%d(2,2) = czero
        enddo
      endif
  
* quqd -- p=p756,q=p8
      quqd=p756(0)*p8(0)-p756(1)*p8(1)-p756(2)*p8(2)-p756(3)*p8(
     & 3)
* T -- qu=p756,qd=p8,v=0,a=rz8_756(0)%a,b=rz8_756(0)%b,c=rz8_756(0)%c,d=
* rz8_756(0)%d,cr=zcr(id8),cl=zcl(id8),nsum=0
      eps_0=-p756(2)*p8(3)+p8(2)*p756(3)
      ceps_0=eps_0*cim
      ceps_1=p756(3)*cim
      ceps_2=p8(3)*cim
      auxa=-quqd+p756k0*p8(0)+p8k0*p756(0)
      rz8_756(0)%a(1,1)=zcr(id8)*(auxa+ceps_0)
      rz8_756(0)%a(2,2)=zcl(id8)*(auxa-ceps_0)
      rz8_756(0)%b(1,2)=-zcl(id8)*(p8(2)+ceps_2)
      rz8_756(0)%b(2,1)=zcr(id8)*(p8(2)-ceps_2)
      rz8_756(0)%c(1,2)=zcr(id8)*(p756(2)+ceps_1)
      rz8_756(0)%c(2,1)=zcl(id8)*(-p756(2)+ceps_1)
      rz8_756(0)%d(1,1)=zcl(id8)
      rz8_756(0)%d(2,2)=zcr(id8)
* T -- qu=p756,qd=p8,v=1,a=rz8_756(1)%a,b=rz8_756(1)%b,c=rz8_756(1)%c,d=
* rz8_756(1)%d,cr=zcr(id8),cl=zcl(id8),nsum=0
      auxa=-quqd+p756k0*p8(1)+p8k0*p756(1)
      rz8_756(1)%a(1,1)=zcr(id8)*(auxa+ceps_0)
      rz8_756(1)%a(2,2)=zcl(id8)*(auxa-ceps_0)
      rz8_756(1)%b(1,2)=-zcl(id8)*(p8(2)+ceps_2)
      rz8_756(1)%b(2,1)=zcr(id8)*(p8(2)-ceps_2)
      rz8_756(1)%c(1,2)=zcr(id8)*(p756(2)+ceps_1)
      rz8_756(1)%c(2,1)=zcl(id8)*(-p756(2)+ceps_1)
      rz8_756(1)%d(1,1)=zcl(id8)
      rz8_756(1)%d(2,2)=zcr(id8)
* T -- qu=p756,qd=p8,v=2,a=rz8_756(2)%a,b=rz8_756(2)%b,c=rz8_756(2)%c,d=
* rz8_756(2)%d,cr=zcr(id8),cl=zcl(id8),nsum=0
      eps_0=-p756k0*p8(3)+p8k0*p756(3)
      ceps_0=eps_0*cim
      auxa=p756k0*p8(2)+p8k0*p756(2)
      rz8_756(2)%a(1,1)=zcr(id8)*(auxa+ceps_0)
      rz8_756(2)%a(2,2)=zcl(id8)*(auxa-ceps_0)
      rz8_756(2)%b(1,2)=-zcl(id8)*p8k0
      rz8_756(2)%b(2,1)=zcr(id8)*p8k0
      rz8_756(2)%c(1,2)=zcr(id8)*p756k0
      rz8_756(2)%c(2,1)=-zcl(id8)*p756k0
* T -- qu=p756,qd=p8,v=3,a=rz8_756(3)%a,b=rz8_756(3)%b,c=rz8_756(3)%c,d=
* rz8_756(3)%d,cr=zcr(id8),cl=zcl(id8),nsum=0
      eps_0=p756k0*p8(2)-p8k0*p756(2)
      ceps_0=eps_0*cim
      ceps_1=p756k0*cim
      ceps_2=p8k0*cim
      auxa=+p756k0*p8(3)+p8k0*p756(3)
      rz8_756(3)%a(1,1)=zcr(id8)*(auxa+ceps_0)
      rz8_756(3)%a(2,2)=zcl(id8)*(auxa-ceps_0)
      rz8_756(3)%b(1,2)=-zcl(id8)*ceps_2
      rz8_756(3)%b(2,1)=-zcr(id8)*ceps_2
      rz8_756(3)%c(1,2)=zcr(id8)*ceps_1
      rz8_756(3)%c(2,1)=zcl(id8)*ceps_1
  
  
      if(ineutri(id8).ne.1) then
* T -- qu=p756,qd=p8,v=0,a=rf8_756(0)%a,b=rf8_756(0)%b,c=rf8_756(0)%c,d=
* rf8_756(0)%d,cr=fcr(id8),cl=fcl(id8),nsum=0
      eps_0=-p756(2)*p8(3)+p8(2)*p756(3)
      ceps_0=eps_0*cim
      ceps_1=p756(3)*cim
      ceps_2=p8(3)*cim
      auxa=-quqd+p756k0*p8(0)+p8k0*p756(0)
      rf8_756(0)%a(1,1)=fcr(id8)*(auxa+ceps_0)
      rf8_756(0)%a(2,2)=fcl(id8)*(auxa-ceps_0)
      rf8_756(0)%b(1,2)=-fcl(id8)*(p8(2)+ceps_2)
      rf8_756(0)%b(2,1)=fcr(id8)*(p8(2)-ceps_2)
      rf8_756(0)%c(1,2)=fcr(id8)*(p756(2)+ceps_1)
      rf8_756(0)%c(2,1)=fcl(id8)*(-p756(2)+ceps_1)
      rf8_756(0)%d(1,1)=fcl(id8)
      rf8_756(0)%d(2,2)=fcr(id8)
* T -- qu=p756,qd=p8,v=1,a=rf8_756(1)%a,b=rf8_756(1)%b,c=rf8_756(1)%c,d=
* rf8_756(1)%d,cr=fcr(id8),cl=fcl(id8),nsum=0
      auxa=-quqd+p756k0*p8(1)+p8k0*p756(1)
      rf8_756(1)%a(1,1)=fcr(id8)*(auxa+ceps_0)
      rf8_756(1)%a(2,2)=fcl(id8)*(auxa-ceps_0)
      rf8_756(1)%b(1,2)=-fcl(id8)*(p8(2)+ceps_2)
      rf8_756(1)%b(2,1)=fcr(id8)*(p8(2)-ceps_2)
      rf8_756(1)%c(1,2)=fcr(id8)*(p756(2)+ceps_1)
      rf8_756(1)%c(2,1)=fcl(id8)*(-p756(2)+ceps_1)
      rf8_756(1)%d(1,1)=fcl(id8)
      rf8_756(1)%d(2,2)=fcr(id8)
* T -- qu=p756,qd=p8,v=2,a=rf8_756(2)%a,b=rf8_756(2)%b,c=rf8_756(2)%c,d=
* rf8_756(2)%d,cr=fcr(id8),cl=fcl(id8),nsum=0
      eps_0=-p756k0*p8(3)+p8k0*p756(3)
      ceps_0=eps_0*cim
      auxa=p756k0*p8(2)+p8k0*p756(2)
      rf8_756(2)%a(1,1)=fcr(id8)*(auxa+ceps_0)
      rf8_756(2)%a(2,2)=fcl(id8)*(auxa-ceps_0)
      rf8_756(2)%b(1,2)=-fcl(id8)*p8k0
      rf8_756(2)%b(2,1)=fcr(id8)*p8k0
      rf8_756(2)%c(1,2)=fcr(id8)*p756k0
      rf8_756(2)%c(2,1)=-fcl(id8)*p756k0
* T -- qu=p756,qd=p8,v=3,a=rf8_756(3)%a,b=rf8_756(3)%b,c=rf8_756(3)%c,d=
* rf8_756(3)%d,cr=fcr(id8),cl=fcl(id8),nsum=0
      eps_0=p756k0*p8(2)-p8k0*p756(2)
      ceps_0=eps_0*cim
      ceps_1=p756k0*cim
      ceps_2=p8k0*cim
      auxa=+p756k0*p8(3)+p8k0*p756(3)
      rf8_756(3)%a(1,1)=fcr(id8)*(auxa+ceps_0)
      rf8_756(3)%a(2,2)=fcl(id8)*(auxa-ceps_0)
      rf8_756(3)%b(1,2)=-fcl(id8)*ceps_2
      rf8_756(3)%b(2,1)=-fcr(id8)*ceps_2
      rf8_756(3)%c(1,2)=fcr(id8)*ceps_1
      rf8_756(3)%c(2,1)=fcl(id8)*ceps_1
  
      else
        do mu=0,3
          rf8_756(mu)%a(1,1) = czero
          rf8_756(mu)%a(2,2) = czero
          rf8_756(mu)%b(1,2) = czero
          rf8_756(mu)%b(2,1) = czero
          rf8_756(mu)%c(1,2) = czero
          rf8_756(mu)%c(2,1) = czero
          rf8_756(mu)%d(1,1) = czero
          rf8_756(mu)%d(2,2) = czero
        enddo
      endif
  
  
* compute all single insertions of the type lhi_ (i=1,3)                
*    to a Zline                                                         
*                                                                       
*        i __                                                           
*            |_h__                                                      
*            |                                                          
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.rmh.ge.0.d0) then
* TH -- qu=p1,qd=p234,a=lh1_234%a,b=lh1_234%b,c=lh1_234%c,coupl=rhbb
      auxa=-p1k0*p234(2)+p234k0*p1(2)
      cauxa=auxa-cim*(p234(3)*p1k0-p1(3)*p234k0)
      lh1_234%a(1,2)=rhbb*cauxa
      lh1_234%a(2,1)=-rhbb*conjg(cauxa)
      lh1_234%b(1,1)=rhbb*p234k0
      lh1_234%b(2,2)=lh1_234%b(1,1)
      lh1_234%c(1,1)=rhbb*p1k0
      lh1_234%c(2,2)=lh1_234%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.rmh.ge.0.d0) then
* TH -- qu=p1,qd=p256,a=lh1_256%a,b=lh1_256%b,c=lh1_256%c,coupl=rhbb
      auxa=-p1k0*p256(2)+p256k0*p1(2)
      cauxa=auxa-cim*(p256(3)*p1k0-p1(3)*p256k0)
      lh1_256%a(1,2)=rhbb*cauxa
      lh1_256%a(2,1)=-rhbb*conjg(cauxa)
      lh1_256%b(1,1)=rhbb*p256k0
      lh1_256%b(2,2)=lh1_256%b(1,1)
      lh1_256%c(1,1)=rhbb*p1k0
      lh1_256%c(2,2)=lh1_256%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.rmh.ge.0.d0) then
* TH -- qu=p1,qd=p278,a=lh1_278%a,b=lh1_278%b,c=lh1_278%c,coupl=rhbb
      auxa=-p1k0*p278(2)+p278k0*p1(2)
      cauxa=auxa-cim*(p278(3)*p1k0-p1(3)*p278k0)
      lh1_278%a(1,2)=rhbb*cauxa
      lh1_278%a(2,1)=-rhbb*conjg(cauxa)
      lh1_278%b(1,1)=rhbb*p278k0
      lh1_278%b(2,2)=lh1_278%b(1,1)
      lh1_278%c(1,1)=rhbb*p1k0
      lh1_278%c(2,2)=lh1_278%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.rmh.ge.0.d0) then
* TH -- qu=p3,qd=p412,a=lh3_412%a,b=lh3_412%b,c=lh3_412%c,coupl=rhbb
      auxa=-p3k0*p412(2)+p412k0*p3(2)
      cauxa=auxa-cim*(p412(3)*p3k0-p3(3)*p412k0)
      lh3_412%a(1,2)=rhbb*cauxa
      lh3_412%a(2,1)=-rhbb*conjg(cauxa)
      lh3_412%b(1,1)=rhbb*p412k0
      lh3_412%b(2,2)=lh3_412%b(1,1)
      lh3_412%c(1,1)=rhbb*p3k0
      lh3_412%c(2,2)=lh3_412%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.rmh.ge.0.d0) then
* TH -- qu=p3,qd=p456,a=lh3_456%a,b=lh3_456%b,c=lh3_456%c,coupl=rhbb
      auxa=-p3k0*p456(2)+p456k0*p3(2)
      cauxa=auxa-cim*(p456(3)*p3k0-p3(3)*p456k0)
      lh3_456%a(1,2)=rhbb*cauxa
      lh3_456%a(2,1)=-rhbb*conjg(cauxa)
      lh3_456%b(1,1)=rhbb*p456k0
      lh3_456%b(2,2)=lh3_456%b(1,1)
      lh3_456%c(1,1)=rhbb*p3k0
      lh3_456%c(2,2)=lh3_456%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.rmh.ge.0.d0) then
* TH -- qu=p3,qd=p478,a=lh3_478%a,b=lh3_478%b,c=lh3_478%c,coupl=rhbb
      auxa=-p3k0*p478(2)+p478k0*p3(2)
      cauxa=auxa-cim*(p478(3)*p3k0-p3(3)*p478k0)
      lh3_478%a(1,2)=rhbb*cauxa
      lh3_478%a(2,1)=-rhbb*conjg(cauxa)
      lh3_478%b(1,1)=rhbb*p478k0
      lh3_478%b(2,2)=lh3_478%b(1,1)
      lh3_478%c(1,1)=rhbb*p3k0
      lh3_478%c(2,2)=lh3_478%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.rmh.ge.0.d0) then
* TH -- qu=p5,qd=p612,a=lh5_612%a,b=lh5_612%b,c=lh5_612%c,coupl=rhbb
      auxa=-p5k0*p612(2)+p612k0*p5(2)
      cauxa=auxa-cim*(p612(3)*p5k0-p5(3)*p612k0)
      lh5_612%a(1,2)=rhbb*cauxa
      lh5_612%a(2,1)=-rhbb*conjg(cauxa)
      lh5_612%b(1,1)=rhbb*p612k0
      lh5_612%b(2,2)=lh5_612%b(1,1)
      lh5_612%c(1,1)=rhbb*p5k0
      lh5_612%c(2,2)=lh5_612%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.rmh.ge.0.d0) then
* TH -- qu=p5,qd=p634,a=lh5_634%a,b=lh5_634%b,c=lh5_634%c,coupl=rhbb
      auxa=-p5k0*p634(2)+p634k0*p5(2)
      cauxa=auxa-cim*(p634(3)*p5k0-p5(3)*p634k0)
      lh5_634%a(1,2)=rhbb*cauxa
      lh5_634%a(2,1)=-rhbb*conjg(cauxa)
      lh5_634%b(1,1)=rhbb*p634k0
      lh5_634%b(2,2)=lh5_634%b(1,1)
      lh5_634%c(1,1)=rhbb*p5k0
      lh5_634%c(2,2)=lh5_634%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.rmh.ge.0.d0) then
* TH -- qu=p5,qd=p678,a=lh5_678%a,b=lh5_678%b,c=lh5_678%c,coupl=rhbb
      auxa=-p5k0*p678(2)+p678k0*p5(2)
      cauxa=auxa-cim*(p678(3)*p5k0-p5(3)*p678k0)
      lh5_678%a(1,2)=rhbb*cauxa
      lh5_678%a(2,1)=-rhbb*conjg(cauxa)
      lh5_678%b(1,1)=rhbb*p678k0
      lh5_678%b(2,2)=lh5_678%b(1,1)
      lh5_678%c(1,1)=rhbb*p5k0
      lh5_678%c(2,2)=lh5_678%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id7.eq.5.and.rmh.ge.0.d0) then
* TH -- qu=p7,qd=p812,a=lh7_812%a,b=lh7_812%b,c=lh7_812%c,coupl=rhbb
      auxa=-p7k0*p812(2)+p812k0*p7(2)
      cauxa=auxa-cim*(p812(3)*p7k0-p7(3)*p812k0)
      lh7_812%a(1,2)=rhbb*cauxa
      lh7_812%a(2,1)=-rhbb*conjg(cauxa)
      lh7_812%b(1,1)=rhbb*p812k0
      lh7_812%b(2,2)=lh7_812%b(1,1)
      lh7_812%c(1,1)=rhbb*p7k0
      lh7_812%c(2,2)=lh7_812%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id7.eq.5.and.rmh.ge.0.d0) then
* TH -- qu=p7,qd=p834,a=lh7_834%a,b=lh7_834%b,c=lh7_834%c,coupl=rhbb
      auxa=-p7k0*p834(2)+p834k0*p7(2)
      cauxa=auxa-cim*(p834(3)*p7k0-p7(3)*p834k0)
      lh7_834%a(1,2)=rhbb*cauxa
      lh7_834%a(2,1)=-rhbb*conjg(cauxa)
      lh7_834%b(1,1)=rhbb*p834k0
      lh7_834%b(2,2)=lh7_834%b(1,1)
      lh7_834%c(1,1)=rhbb*p7k0
      lh7_834%c(2,2)=lh7_834%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id7.eq.5.and.rmh.ge.0.d0) then
* TH -- qu=p7,qd=p856,a=lh7_856%a,b=lh7_856%b,c=lh7_856%c,coupl=rhbb
      auxa=-p7k0*p856(2)+p856k0*p7(2)
      cauxa=auxa-cim*(p856(3)*p7k0-p7(3)*p856k0)
      lh7_856%a(1,2)=rhbb*cauxa
      lh7_856%a(2,1)=-rhbb*conjg(cauxa)
      lh7_856%b(1,1)=rhbb*p856k0
      lh7_856%b(2,2)=lh7_856%b(1,1)
      lh7_856%c(1,1)=rhbb*p7k0
      lh7_856%c(2,2)=lh7_856%c(1,1)
      endif
  
  
* compute all single insertions of the type rhi_ (i=2,4)                
*    to a Zline                                                         
*                                                                       
*            |_h__                                                      
*        i __|                                                          
*                                                                       
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id2.eq.-5.and.rmh.ge.0.d0) then
* TH -- qu=p134,qd=p2,a=rh2_134%a,b=rh2_134%b,c=rh2_134%c,coupl=rhbb
      auxa=-p134k0*p2(2)+p2k0*p134(2)
      cauxa=auxa-cim*(p2(3)*p134k0-p134(3)*p2k0)
      rh2_134%a(1,2)=rhbb*cauxa
      rh2_134%a(2,1)=-rhbb*conjg(cauxa)
      rh2_134%b(1,1)=rhbb*p2k0
      rh2_134%b(2,2)=rh2_134%b(1,1)
      rh2_134%c(1,1)=rhbb*p134k0
      rh2_134%c(2,2)=rh2_134%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id2.eq.-5.and.rmh.ge.0.d0) then
* TH -- qu=p156,qd=p2,a=rh2_156%a,b=rh2_156%b,c=rh2_156%c,coupl=rhbb
      auxa=-p156k0*p2(2)+p2k0*p156(2)
      cauxa=auxa-cim*(p2(3)*p156k0-p156(3)*p2k0)
      rh2_156%a(1,2)=rhbb*cauxa
      rh2_156%a(2,1)=-rhbb*conjg(cauxa)
      rh2_156%b(1,1)=rhbb*p2k0
      rh2_156%b(2,2)=rh2_156%b(1,1)
      rh2_156%c(1,1)=rhbb*p156k0
      rh2_156%c(2,2)=rh2_156%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id2.eq.-5.and.rmh.ge.0.d0) then
* TH -- qu=p178,qd=p2,a=rh2_178%a,b=rh2_178%b,c=rh2_178%c,coupl=rhbb
      auxa=-p178k0*p2(2)+p2k0*p178(2)
      cauxa=auxa-cim*(p2(3)*p178k0-p178(3)*p2k0)
      rh2_178%a(1,2)=rhbb*cauxa
      rh2_178%a(2,1)=-rhbb*conjg(cauxa)
      rh2_178%b(1,1)=rhbb*p2k0
      rh2_178%b(2,2)=rh2_178%b(1,1)
      rh2_178%c(1,1)=rhbb*p178k0
      rh2_178%c(2,2)=rh2_178%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id4.eq.-5.and.rmh.ge.0.d0) then
* TH -- qu=p312,qd=p4,a=rh4_312%a,b=rh4_312%b,c=rh4_312%c,coupl=rhbb
      auxa=-p312k0*p4(2)+p4k0*p312(2)
      cauxa=auxa-cim*(p4(3)*p312k0-p312(3)*p4k0)
      rh4_312%a(1,2)=rhbb*cauxa
      rh4_312%a(2,1)=-rhbb*conjg(cauxa)
      rh4_312%b(1,1)=rhbb*p4k0
      rh4_312%b(2,2)=rh4_312%b(1,1)
      rh4_312%c(1,1)=rhbb*p312k0
      rh4_312%c(2,2)=rh4_312%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id4.eq.-5.and.rmh.ge.0.d0) then
* TH -- qu=p356,qd=p4,a=rh4_356%a,b=rh4_356%b,c=rh4_356%c,coupl=rhbb
      auxa=-p356k0*p4(2)+p4k0*p356(2)
      cauxa=auxa-cim*(p4(3)*p356k0-p356(3)*p4k0)
      rh4_356%a(1,2)=rhbb*cauxa
      rh4_356%a(2,1)=-rhbb*conjg(cauxa)
      rh4_356%b(1,1)=rhbb*p4k0
      rh4_356%b(2,2)=rh4_356%b(1,1)
      rh4_356%c(1,1)=rhbb*p356k0
      rh4_356%c(2,2)=rh4_356%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id4.eq.-5.and.rmh.ge.0.d0) then
* TH -- qu=p378,qd=p4,a=rh4_378%a,b=rh4_378%b,c=rh4_378%c,coupl=rhbb
      auxa=-p378k0*p4(2)+p4k0*p378(2)
      cauxa=auxa-cim*(p4(3)*p378k0-p378(3)*p4k0)
      rh4_378%a(1,2)=rhbb*cauxa
      rh4_378%a(2,1)=-rhbb*conjg(cauxa)
      rh4_378%b(1,1)=rhbb*p4k0
      rh4_378%b(2,2)=rh4_378%b(1,1)
      rh4_378%c(1,1)=rhbb*p378k0
      rh4_378%c(2,2)=rh4_378%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id6.eq.-5.and.rmh.ge.0.d0) then
* TH -- qu=p512,qd=p6,a=rh6_512%a,b=rh6_512%b,c=rh6_512%c,coupl=rhbb
      auxa=-p512k0*p6(2)+p6k0*p512(2)
      cauxa=auxa-cim*(p6(3)*p512k0-p512(3)*p6k0)
      rh6_512%a(1,2)=rhbb*cauxa
      rh6_512%a(2,1)=-rhbb*conjg(cauxa)
      rh6_512%b(1,1)=rhbb*p6k0
      rh6_512%b(2,2)=rh6_512%b(1,1)
      rh6_512%c(1,1)=rhbb*p512k0
      rh6_512%c(2,2)=rh6_512%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id6.eq.-5.and.rmh.ge.0.d0) then
* TH -- qu=p534,qd=p6,a=rh6_534%a,b=rh6_534%b,c=rh6_534%c,coupl=rhbb
      auxa=-p534k0*p6(2)+p6k0*p534(2)
      cauxa=auxa-cim*(p6(3)*p534k0-p534(3)*p6k0)
      rh6_534%a(1,2)=rhbb*cauxa
      rh6_534%a(2,1)=-rhbb*conjg(cauxa)
      rh6_534%b(1,1)=rhbb*p6k0
      rh6_534%b(2,2)=rh6_534%b(1,1)
      rh6_534%c(1,1)=rhbb*p534k0
      rh6_534%c(2,2)=rh6_534%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id6.eq.-5.and.rmh.ge.0.d0) then
* TH -- qu=p578,qd=p6,a=rh6_578%a,b=rh6_578%b,c=rh6_578%c,coupl=rhbb
      auxa=-p578k0*p6(2)+p6k0*p578(2)
      cauxa=auxa-cim*(p6(3)*p578k0-p578(3)*p6k0)
      rh6_578%a(1,2)=rhbb*cauxa
      rh6_578%a(2,1)=-rhbb*conjg(cauxa)
      rh6_578%b(1,1)=rhbb*p6k0
      rh6_578%b(2,2)=rh6_578%b(1,1)
      rh6_578%c(1,1)=rhbb*p578k0
      rh6_578%c(2,2)=rh6_578%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id8.eq.-5.and.rmh.ge.0.d0) then
* TH -- qu=p712,qd=p8,a=rh8_712%a,b=rh8_712%b,c=rh8_712%c,coupl=rhbb
      auxa=-p712k0*p8(2)+p8k0*p712(2)
      cauxa=auxa-cim*(p8(3)*p712k0-p712(3)*p8k0)
      rh8_712%a(1,2)=rhbb*cauxa
      rh8_712%a(2,1)=-rhbb*conjg(cauxa)
      rh8_712%b(1,1)=rhbb*p8k0
      rh8_712%b(2,2)=rh8_712%b(1,1)
      rh8_712%c(1,1)=rhbb*p712k0
      rh8_712%c(2,2)=rh8_712%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id8.eq.-5.and.rmh.ge.0.d0) then
* TH -- qu=p734,qd=p8,a=rh8_734%a,b=rh8_734%b,c=rh8_734%c,coupl=rhbb
      auxa=-p734k0*p8(2)+p8k0*p734(2)
      cauxa=auxa-cim*(p8(3)*p734k0-p734(3)*p8k0)
      rh8_734%a(1,2)=rhbb*cauxa
      rh8_734%a(2,1)=-rhbb*conjg(cauxa)
      rh8_734%b(1,1)=rhbb*p8k0
      rh8_734%b(2,2)=rh8_734%b(1,1)
      rh8_734%c(1,1)=rhbb*p734k0
      rh8_734%c(2,2)=rh8_734%c(1,1)
      endif
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id8.eq.-5.and.rmh.ge.0.d0) then
* TH -- qu=p756,qd=p8,a=rh8_756%a,b=rh8_756%b,c=rh8_756%c,coupl=rhbb
      auxa=-p756k0*p8(2)+p8k0*p756(2)
      cauxa=auxa-cim*(p8(3)*p756k0-p756(3)*p8k0)
      rh8_756%a(1,2)=rhbb*cauxa
      rh8_756%a(2,1)=-rhbb*conjg(cauxa)
      rh8_756%b(1,1)=rhbb*p8k0
      rh8_756%b(2,2)=rh8_756%b(1,1)
      rh8_756%c(1,1)=rhbb*p756k0
      rh8_756%c(2,2)=rh8_756%c(1,1)
      endif
  
  
* COMPUTE ALL SUBDIAGRAMS WITH A Z OR A GAMMA "DECAYING" TO 4 FERMIONS  
*  WHICH CORRESPOND TO TWO Z'S                                          
*                  CZIJKL(MU)  AND CFIJKL(MU) (IJKL PARTICLE NUMBERS)   
*                                                                       
*               _____ i                     _____ i                     
*              |  |__ j                    |  |__ j                     
*    (mu) --Z--|  |__ k          (mu) --f--|  |__ k                     
*              |__|__ l                    |__|__ l                     
*                                                                       
*                                                                       
**QCD                                                                   
*     and QCD subdiagrams with a gluon "decaying" to 4 fermions         
*  which correspond to two z's                                          
*                            _____ i                                    
*                           |  |__ j  Z                                 
*                 (mu) ~~g~~|  |__ k                                    
*                           |__|__ l  Z                                 
*                                                                       
*As g_strong and e are factorized, there is simply a difference in terms
*of the factor Qf (electric charge in unit of |e|) between QCD g->ZZ    
*subdiagrams and pure EW gamma->ZZ.                                     
*                                                                       
  
  
*    First all diagrams of the type                                     
*                                                                       
*                 |_Z,f,h__/             (mu) _Z____|                   
*       (mu) _Z___|        \    and                 |_Z,f,h__/          
*                 |                                 |        \          
*                                                                       
* Use tst, tts  because Z,f,h correspond to ts                          
  
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TsT -- aa=clinetzz(i3,i4,mu)%a,bb=clinetzz(i3,i4,mu)%b,cc=clinetzz(i3,
* i4,mu)%c,dd=clinetzz(i3,i4,mu)%d,a1=l1_34(i3,i4)%a,b1=l1_34(i3,i4)%b,c
* 1=l1_34(i3,i4)%c,d1=l1_34(i3,i4)%d,a2=rz2_134(mu)%a,b2=rz2_134(mu)%b,c
* 2=rz2_134(mu)%c,d2=rz2_134(mu)%d,prq=p134q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=l1_34(i3,i4)%a(iut,1)+l1_34(i3,i4)%c(iut,1)*rmass(id1)
      cx2=l1_34(i3,i4)%c(iut,2)*p134q+l1_34(i3,i4)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_34(i3,i4)%b(iut,1)+l1_34(i3,i4)%d(iut,1)*rmass(id1)
      cy2=l1_34(i3,i4)%d(iut,2)*p134q+l1_34(i3,i4)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_34(i3,i4)%c(iut,1)*p134q+l1_34(i3,i4)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_34(i3,i4)%a(iut,2)+l1_34(i3,i4)%c(iut,2)*rmass(id1)
      cz1=l1_34(i3,i4)%d(iut,1)*p134q+l1_34(i3,i4)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_34(i3,i4)%b(iut,2)+l1_34(i3,i4)%d(iut,2)*rmass(id1)
      clinetzz(i3,i4,mu)%a(iut,1)=cx1*rz2_134(mu)%a(1,1)+cx2*rz2
     & _134(mu)%b(2,1)
      clinetzz(i3,i4,mu)%b(iut,1)=cy1*rz2_134(mu)%a(1,1)+cy2*rz2
     & _134(mu)%b(2,1)
      clinetzz(i3,i4,mu)%c(iut,1)=cw1*rz2_134(mu)%d(1,1)+cw2*rz2
     & _134(mu)%c(2,1)
      clinetzz(i3,i4,mu)%d(iut,1)=cz1*rz2_134(mu)%d(1,1)+cz2*rz2
     & _134(mu)%c(2,1)
      clinetzz(i3,i4,mu)%a(iut,2)=cw1*rz2_134(mu)%b(1,2)+cw2*rz2
     & _134(mu)%a(2,2)
      clinetzz(i3,i4,mu)%b(iut,2)=cz1*rz2_134(mu)%b(1,2)+cz2*rz2
     & _134(mu)%a(2,2)
      clinetzz(i3,i4,mu)%c(iut,2)=cx1*rz2_134(mu)%c(1,2)+cx2*rz2
     & _134(mu)%d(2,2)
      clinetzz(i3,i4,mu)%d(iut,2)=cy1*rz2_134(mu)%c(1,2)+cy2*rz2
     & _134(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TTs -- aa=clinetzz(i3,i4,mu)%a,bb=clinetzz(i3,i4,mu)%b,cc=clinetzz(i3,
* i4,mu)%c,dd=clinetzz(i3,i4,mu)%d,a1=lz1_234(mu)%a,b1=lz1_234(mu)%b,c1=
* lz1_234(mu)%c,d1=lz1_234(mu)%d,a2=r2_34(i3,i4)%a,b2=r2_34(i3,i4)%b,c2=
* r2_34(i3,i4)%c,d2=r2_34(i3,i4)%d,prq=p234q,m=rmass(id1),nsum=1
      do jut=1,2
      cx1=r2_34(i3,i4)%a(1,jut)+rmass(id1)*r2_34(i3,i4)%b(1,jut)
      cx2=r2_34(i3,i4)%a(2,jut)+rmass(id1)*r2_34(i3,i4)%b(2,jut)
      cy1=p234q*r2_34(i3,i4)%b(1,jut)+rmass(id1)*r2_34(i3,i4)%a(
     & 1,jut)
      cy2=p234q*r2_34(i3,i4)%b(2,jut)+rmass(id1)*r2_34(i3,i4)%a(
     & 2,jut)
      cw1=r2_34(i3,i4)%c(1,jut)+rmass(id1)*r2_34(i3,i4)%d(1,jut)
      cw2=r2_34(i3,i4)%c(2,jut)+rmass(id1)*r2_34(i3,i4)%d(2,jut)
      cz1=p234q*r2_34(i3,i4)%d(1,jut)+rmass(id1)*r2_34(i3,i4)%c(
     & 1,jut)
      cz2=p234q*r2_34(i3,i4)%d(2,jut)+rmass(id1)*r2_34(i3,i4)%c(
     & 2,jut)
      clinetzz(i3,i4,mu)%a(1,jut)=clinetzz(i3,i4,mu)%a(1,jut)+lz
     & 1_234(mu)%a(1,1)*cx1+lz1_234(mu)%c(1,2)*cy2
      clinetzz(i3,i4,mu)%b(1,jut)=clinetzz(i3,i4,mu)%b(1,jut)+lz
     & 1_234(mu)%d(1,1)*cy1+lz1_234(mu)%b(1,2)*cx2
      clinetzz(i3,i4,mu)%c(1,jut)=clinetzz(i3,i4,mu)%c(1,jut)+lz
     & 1_234(mu)%a(1,1)*cw1+lz1_234(mu)%c(1,2)*cz2
      clinetzz(i3,i4,mu)%d(1,jut)=clinetzz(i3,i4,mu)%d(1,jut)+lz
     & 1_234(mu)%d(1,1)*cz1+lz1_234(mu)%b(1,2)*cw2
      clinetzz(i3,i4,mu)%a(2,jut)=clinetzz(i3,i4,mu)%a(2,jut)+lz
     & 1_234(mu)%c(2,1)*cy1+lz1_234(mu)%a(2,2)*cx2
      clinetzz(i3,i4,mu)%b(2,jut)=clinetzz(i3,i4,mu)%b(2,jut)+lz
     & 1_234(mu)%b(2,1)*cx1+lz1_234(mu)%d(2,2)*cy2
      clinetzz(i3,i4,mu)%c(2,jut)=clinetzz(i3,i4,mu)%c(2,jut)+lz
     & 1_234(mu)%c(2,1)*cz1+lz1_234(mu)%a(2,2)*cw2
      clinetzz(i3,i4,mu)%d(2,jut)=clinetzz(i3,i4,mu)%d(2,jut)+lz
     & 1_234(mu)%b(2,1)*cw1+lz1_234(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id1)
      rmassr=-rmass(id2)
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=cz1234(&1,&2,i3,i4,mu),abcd=clinetzz(i3,i4,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cz1234(iut,jut,i3,i4,mu)=clinetzz(i3,i4,mu)%a(iut,jut)+rma
     & ssl*clinetzz(i3,i4,mu)%b(iut,jut)+rmassr*clinetzz(i3,i4,m
     & u)%c(iut,jut)+rmassl*rmassr*clinetzz(i3,i4,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TsT -- aa=clinetzz(i1,i2,mu)%a,bb=clinetzz(i1,i2,mu)%b,cc=clinetzz(i1,
* i2,mu)%c,dd=clinetzz(i1,i2,mu)%d,a1=l3_12(i1,i2)%a,b1=l3_12(i1,i2)%b,c
* 1=l3_12(i1,i2)%c,d1=l3_12(i1,i2)%d,a2=rz4_312(mu)%a,b2=rz4_312(mu)%b,c
* 2=rz4_312(mu)%c,d2=rz4_312(mu)%d,prq=p312q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=l3_12(i1,i2)%a(iut,1)+l3_12(i1,i2)%c(iut,1)*rmass(id3)
      cx2=l3_12(i1,i2)%c(iut,2)*p312q+l3_12(i1,i2)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_12(i1,i2)%b(iut,1)+l3_12(i1,i2)%d(iut,1)*rmass(id3)
      cy2=l3_12(i1,i2)%d(iut,2)*p312q+l3_12(i1,i2)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_12(i1,i2)%c(iut,1)*p312q+l3_12(i1,i2)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_12(i1,i2)%a(iut,2)+l3_12(i1,i2)%c(iut,2)*rmass(id3)
      cz1=l3_12(i1,i2)%d(iut,1)*p312q+l3_12(i1,i2)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_12(i1,i2)%b(iut,2)+l3_12(i1,i2)%d(iut,2)*rmass(id3)
      clinetzz(i1,i2,mu)%a(iut,1)=cx1*rz4_312(mu)%a(1,1)+cx2*rz4
     & _312(mu)%b(2,1)
      clinetzz(i1,i2,mu)%b(iut,1)=cy1*rz4_312(mu)%a(1,1)+cy2*rz4
     & _312(mu)%b(2,1)
      clinetzz(i1,i2,mu)%c(iut,1)=cw1*rz4_312(mu)%d(1,1)+cw2*rz4
     & _312(mu)%c(2,1)
      clinetzz(i1,i2,mu)%d(iut,1)=cz1*rz4_312(mu)%d(1,1)+cz2*rz4
     & _312(mu)%c(2,1)
      clinetzz(i1,i2,mu)%a(iut,2)=cw1*rz4_312(mu)%b(1,2)+cw2*rz4
     & _312(mu)%a(2,2)
      clinetzz(i1,i2,mu)%b(iut,2)=cz1*rz4_312(mu)%b(1,2)+cz2*rz4
     & _312(mu)%a(2,2)
      clinetzz(i1,i2,mu)%c(iut,2)=cx1*rz4_312(mu)%c(1,2)+cx2*rz4
     & _312(mu)%d(2,2)
      clinetzz(i1,i2,mu)%d(iut,2)=cy1*rz4_312(mu)%c(1,2)+cy2*rz4
     & _312(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TTs -- aa=clinetzz(i1,i2,mu)%a,bb=clinetzz(i1,i2,mu)%b,cc=clinetzz(i1,
* i2,mu)%c,dd=clinetzz(i1,i2,mu)%d,a1=lz3_412(mu)%a,b1=lz3_412(mu)%b,c1=
* lz3_412(mu)%c,d1=lz3_412(mu)%d,a2=r4_12(i1,i2)%a,b2=r4_12(i1,i2)%b,c2=
* r4_12(i1,i2)%c,d2=r4_12(i1,i2)%d,prq=p412q,m=rmass(id3),nsum=1
      do jut=1,2
      cx1=r4_12(i1,i2)%a(1,jut)+rmass(id3)*r4_12(i1,i2)%b(1,jut)
      cx2=r4_12(i1,i2)%a(2,jut)+rmass(id3)*r4_12(i1,i2)%b(2,jut)
      cy1=p412q*r4_12(i1,i2)%b(1,jut)+rmass(id3)*r4_12(i1,i2)%a(
     & 1,jut)
      cy2=p412q*r4_12(i1,i2)%b(2,jut)+rmass(id3)*r4_12(i1,i2)%a(
     & 2,jut)
      cw1=r4_12(i1,i2)%c(1,jut)+rmass(id3)*r4_12(i1,i2)%d(1,jut)
      cw2=r4_12(i1,i2)%c(2,jut)+rmass(id3)*r4_12(i1,i2)%d(2,jut)
      cz1=p412q*r4_12(i1,i2)%d(1,jut)+rmass(id3)*r4_12(i1,i2)%c(
     & 1,jut)
      cz2=p412q*r4_12(i1,i2)%d(2,jut)+rmass(id3)*r4_12(i1,i2)%c(
     & 2,jut)
      clinetzz(i1,i2,mu)%a(1,jut)=clinetzz(i1,i2,mu)%a(1,jut)+lz
     & 3_412(mu)%a(1,1)*cx1+lz3_412(mu)%c(1,2)*cy2
      clinetzz(i1,i2,mu)%b(1,jut)=clinetzz(i1,i2,mu)%b(1,jut)+lz
     & 3_412(mu)%d(1,1)*cy1+lz3_412(mu)%b(1,2)*cx2
      clinetzz(i1,i2,mu)%c(1,jut)=clinetzz(i1,i2,mu)%c(1,jut)+lz
     & 3_412(mu)%a(1,1)*cw1+lz3_412(mu)%c(1,2)*cz2
      clinetzz(i1,i2,mu)%d(1,jut)=clinetzz(i1,i2,mu)%d(1,jut)+lz
     & 3_412(mu)%d(1,1)*cz1+lz3_412(mu)%b(1,2)*cw2
      clinetzz(i1,i2,mu)%a(2,jut)=clinetzz(i1,i2,mu)%a(2,jut)+lz
     & 3_412(mu)%c(2,1)*cy1+lz3_412(mu)%a(2,2)*cx2
      clinetzz(i1,i2,mu)%b(2,jut)=clinetzz(i1,i2,mu)%b(2,jut)+lz
     & 3_412(mu)%b(2,1)*cx1+lz3_412(mu)%d(2,2)*cy2
      clinetzz(i1,i2,mu)%c(2,jut)=clinetzz(i1,i2,mu)%c(2,jut)+lz
     & 3_412(mu)%c(2,1)*cz1+lz3_412(mu)%a(2,2)*cw2
      clinetzz(i1,i2,mu)%d(2,jut)=clinetzz(i1,i2,mu)%d(2,jut)+lz
     & 3_412(mu)%b(2,1)*cw1+lz3_412(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id3)
      rmassr=-rmass(id4)
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=cz1234(i1,i2,&1,&2,mu),abcd=clinetzz(i1,i2,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cz1234(i1,i2,iut,jut,mu)=cz1234(i1,i2,iut,jut,mu)+clinetzz
     & (i1,i2,mu)%a(iut,jut)+rmassl*clinetzz(i1,i2,mu)%b(iut,jut
     & )+rmassr*clinetzz(i1,i2,mu)%c(iut,jut)+rmassl*rmassr*clin
     & etzz(i1,i2,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TsT -- aa=clinetzz(i7,i8,mu)%a,bb=clinetzz(i7,i8,mu)%b,cc=clinetzz(i7,
* i8,mu)%c,dd=clinetzz(i7,i8,mu)%d,a1=l5_78(i7,i8)%a,b1=l5_78(i7,i8)%b,c
* 1=l5_78(i7,i8)%c,d1=l5_78(i7,i8)%d,a2=rz6_578(mu)%a,b2=rz6_578(mu)%b,c
* 2=rz6_578(mu)%c,d2=rz6_578(mu)%d,prq=p578q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=l5_78(i7,i8)%a(iut,1)+l5_78(i7,i8)%c(iut,1)*rmass(id5)
      cx2=l5_78(i7,i8)%c(iut,2)*p578q+l5_78(i7,i8)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_78(i7,i8)%b(iut,1)+l5_78(i7,i8)%d(iut,1)*rmass(id5)
      cy2=l5_78(i7,i8)%d(iut,2)*p578q+l5_78(i7,i8)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_78(i7,i8)%c(iut,1)*p578q+l5_78(i7,i8)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_78(i7,i8)%a(iut,2)+l5_78(i7,i8)%c(iut,2)*rmass(id5)
      cz1=l5_78(i7,i8)%d(iut,1)*p578q+l5_78(i7,i8)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_78(i7,i8)%b(iut,2)+l5_78(i7,i8)%d(iut,2)*rmass(id5)
      clinetzz(i7,i8,mu)%a(iut,1)=cx1*rz6_578(mu)%a(1,1)+cx2*rz6
     & _578(mu)%b(2,1)
      clinetzz(i7,i8,mu)%b(iut,1)=cy1*rz6_578(mu)%a(1,1)+cy2*rz6
     & _578(mu)%b(2,1)
      clinetzz(i7,i8,mu)%c(iut,1)=cw1*rz6_578(mu)%d(1,1)+cw2*rz6
     & _578(mu)%c(2,1)
      clinetzz(i7,i8,mu)%d(iut,1)=cz1*rz6_578(mu)%d(1,1)+cz2*rz6
     & _578(mu)%c(2,1)
      clinetzz(i7,i8,mu)%a(iut,2)=cw1*rz6_578(mu)%b(1,2)+cw2*rz6
     & _578(mu)%a(2,2)
      clinetzz(i7,i8,mu)%b(iut,2)=cz1*rz6_578(mu)%b(1,2)+cz2*rz6
     & _578(mu)%a(2,2)
      clinetzz(i7,i8,mu)%c(iut,2)=cx1*rz6_578(mu)%c(1,2)+cx2*rz6
     & _578(mu)%d(2,2)
      clinetzz(i7,i8,mu)%d(iut,2)=cy1*rz6_578(mu)%c(1,2)+cy2*rz6
     & _578(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TTs -- aa=clinetzz(i7,i8,mu)%a,bb=clinetzz(i7,i8,mu)%b,cc=clinetzz(i7,
* i8,mu)%c,dd=clinetzz(i7,i8,mu)%d,a1=lz5_678(mu)%a,b1=lz5_678(mu)%b,c1=
* lz5_678(mu)%c,d1=lz5_678(mu)%d,a2=r6_78(i7,i8)%a,b2=r6_78(i7,i8)%b,c2=
* r6_78(i7,i8)%c,d2=r6_78(i7,i8)%d,prq=p678q,m=rmass(id5),nsum=1
      do jut=1,2
      cx1=r6_78(i7,i8)%a(1,jut)+rmass(id5)*r6_78(i7,i8)%b(1,jut)
      cx2=r6_78(i7,i8)%a(2,jut)+rmass(id5)*r6_78(i7,i8)%b(2,jut)
      cy1=p678q*r6_78(i7,i8)%b(1,jut)+rmass(id5)*r6_78(i7,i8)%a(
     & 1,jut)
      cy2=p678q*r6_78(i7,i8)%b(2,jut)+rmass(id5)*r6_78(i7,i8)%a(
     & 2,jut)
      cw1=r6_78(i7,i8)%c(1,jut)+rmass(id5)*r6_78(i7,i8)%d(1,jut)
      cw2=r6_78(i7,i8)%c(2,jut)+rmass(id5)*r6_78(i7,i8)%d(2,jut)
      cz1=p678q*r6_78(i7,i8)%d(1,jut)+rmass(id5)*r6_78(i7,i8)%c(
     & 1,jut)
      cz2=p678q*r6_78(i7,i8)%d(2,jut)+rmass(id5)*r6_78(i7,i8)%c(
     & 2,jut)
      clinetzz(i7,i8,mu)%a(1,jut)=clinetzz(i7,i8,mu)%a(1,jut)+lz
     & 5_678(mu)%a(1,1)*cx1+lz5_678(mu)%c(1,2)*cy2
      clinetzz(i7,i8,mu)%b(1,jut)=clinetzz(i7,i8,mu)%b(1,jut)+lz
     & 5_678(mu)%d(1,1)*cy1+lz5_678(mu)%b(1,2)*cx2
      clinetzz(i7,i8,mu)%c(1,jut)=clinetzz(i7,i8,mu)%c(1,jut)+lz
     & 5_678(mu)%a(1,1)*cw1+lz5_678(mu)%c(1,2)*cz2
      clinetzz(i7,i8,mu)%d(1,jut)=clinetzz(i7,i8,mu)%d(1,jut)+lz
     & 5_678(mu)%d(1,1)*cz1+lz5_678(mu)%b(1,2)*cw2
      clinetzz(i7,i8,mu)%a(2,jut)=clinetzz(i7,i8,mu)%a(2,jut)+lz
     & 5_678(mu)%c(2,1)*cy1+lz5_678(mu)%a(2,2)*cx2
      clinetzz(i7,i8,mu)%b(2,jut)=clinetzz(i7,i8,mu)%b(2,jut)+lz
     & 5_678(mu)%b(2,1)*cx1+lz5_678(mu)%d(2,2)*cy2
      clinetzz(i7,i8,mu)%c(2,jut)=clinetzz(i7,i8,mu)%c(2,jut)+lz
     & 5_678(mu)%c(2,1)*cz1+lz5_678(mu)%a(2,2)*cw2
      clinetzz(i7,i8,mu)%d(2,jut)=clinetzz(i7,i8,mu)%d(2,jut)+lz
     & 5_678(mu)%b(2,1)*cw1+lz5_678(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id5)
      rmassr=-rmass(id6)
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=cz5678(&1,&2,i3,i4,mu),abcd=clinetzz(i3,i4,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cz5678(iut,jut,i3,i4,mu)=clinetzz(i3,i4,mu)%a(iut,jut)+rma
     & ssl*clinetzz(i3,i4,mu)%b(iut,jut)+rmassr*clinetzz(i3,i4,m
     & u)%c(iut,jut)+rmassl*rmassr*clinetzz(i3,i4,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TsT -- aa=clinetzz(i5,i6,mu)%a,bb=clinetzz(i5,i6,mu)%b,cc=clinetzz(i5,
* i6,mu)%c,dd=clinetzz(i5,i6,mu)%d,a1=l7_56(i5,i6)%a,b1=l7_56(i5,i6)%b,c
* 1=l7_56(i5,i6)%c,d1=l7_56(i5,i6)%d,a2=rz8_756(mu)%a,b2=rz8_756(mu)%b,c
* 2=rz8_756(mu)%c,d2=rz8_756(mu)%d,prq=p756q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=l7_56(i5,i6)%a(iut,1)+l7_56(i5,i6)%c(iut,1)*rmass(id7)
      cx2=l7_56(i5,i6)%c(iut,2)*p756q+l7_56(i5,i6)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_56(i5,i6)%b(iut,1)+l7_56(i5,i6)%d(iut,1)*rmass(id7)
      cy2=l7_56(i5,i6)%d(iut,2)*p756q+l7_56(i5,i6)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_56(i5,i6)%c(iut,1)*p756q+l7_56(i5,i6)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_56(i5,i6)%a(iut,2)+l7_56(i5,i6)%c(iut,2)*rmass(id7)
      cz1=l7_56(i5,i6)%d(iut,1)*p756q+l7_56(i5,i6)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_56(i5,i6)%b(iut,2)+l7_56(i5,i6)%d(iut,2)*rmass(id7)
      clinetzz(i5,i6,mu)%a(iut,1)=cx1*rz8_756(mu)%a(1,1)+cx2*rz8
     & _756(mu)%b(2,1)
      clinetzz(i5,i6,mu)%b(iut,1)=cy1*rz8_756(mu)%a(1,1)+cy2*rz8
     & _756(mu)%b(2,1)
      clinetzz(i5,i6,mu)%c(iut,1)=cw1*rz8_756(mu)%d(1,1)+cw2*rz8
     & _756(mu)%c(2,1)
      clinetzz(i5,i6,mu)%d(iut,1)=cz1*rz8_756(mu)%d(1,1)+cz2*rz8
     & _756(mu)%c(2,1)
      clinetzz(i5,i6,mu)%a(iut,2)=cw1*rz8_756(mu)%b(1,2)+cw2*rz8
     & _756(mu)%a(2,2)
      clinetzz(i5,i6,mu)%b(iut,2)=cz1*rz8_756(mu)%b(1,2)+cz2*rz8
     & _756(mu)%a(2,2)
      clinetzz(i5,i6,mu)%c(iut,2)=cx1*rz8_756(mu)%c(1,2)+cx2*rz8
     & _756(mu)%d(2,2)
      clinetzz(i5,i6,mu)%d(iut,2)=cy1*rz8_756(mu)%c(1,2)+cy2*rz8
     & _756(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TTs -- aa=clinetzz(i5,i6,mu)%a,bb=clinetzz(i5,i6,mu)%b,cc=clinetzz(i5,
* i6,mu)%c,dd=clinetzz(i5,i6,mu)%d,a1=lz7_856(mu)%a,b1=lz7_856(mu)%b,c1=
* lz7_856(mu)%c,d1=lz7_856(mu)%d,a2=r8_56(i5,i6)%a,b2=r8_56(i5,i6)%b,c2=
* r8_56(i5,i6)%c,d2=r8_56(i5,i6)%d,prq=p856q,m=rmass(id7),nsum=1
      do jut=1,2
      cx1=r8_56(i5,i6)%a(1,jut)+rmass(id7)*r8_56(i5,i6)%b(1,jut)
      cx2=r8_56(i5,i6)%a(2,jut)+rmass(id7)*r8_56(i5,i6)%b(2,jut)
      cy1=p856q*r8_56(i5,i6)%b(1,jut)+rmass(id7)*r8_56(i5,i6)%a(
     & 1,jut)
      cy2=p856q*r8_56(i5,i6)%b(2,jut)+rmass(id7)*r8_56(i5,i6)%a(
     & 2,jut)
      cw1=r8_56(i5,i6)%c(1,jut)+rmass(id7)*r8_56(i5,i6)%d(1,jut)
      cw2=r8_56(i5,i6)%c(2,jut)+rmass(id7)*r8_56(i5,i6)%d(2,jut)
      cz1=p856q*r8_56(i5,i6)%d(1,jut)+rmass(id7)*r8_56(i5,i6)%c(
     & 1,jut)
      cz2=p856q*r8_56(i5,i6)%d(2,jut)+rmass(id7)*r8_56(i5,i6)%c(
     & 2,jut)
      clinetzz(i5,i6,mu)%a(1,jut)=clinetzz(i5,i6,mu)%a(1,jut)+lz
     & 7_856(mu)%a(1,1)*cx1+lz7_856(mu)%c(1,2)*cy2
      clinetzz(i5,i6,mu)%b(1,jut)=clinetzz(i5,i6,mu)%b(1,jut)+lz
     & 7_856(mu)%d(1,1)*cy1+lz7_856(mu)%b(1,2)*cx2
      clinetzz(i5,i6,mu)%c(1,jut)=clinetzz(i5,i6,mu)%c(1,jut)+lz
     & 7_856(mu)%a(1,1)*cw1+lz7_856(mu)%c(1,2)*cz2
      clinetzz(i5,i6,mu)%d(1,jut)=clinetzz(i5,i6,mu)%d(1,jut)+lz
     & 7_856(mu)%d(1,1)*cz1+lz7_856(mu)%b(1,2)*cw2
      clinetzz(i5,i6,mu)%a(2,jut)=clinetzz(i5,i6,mu)%a(2,jut)+lz
     & 7_856(mu)%c(2,1)*cy1+lz7_856(mu)%a(2,2)*cx2
      clinetzz(i5,i6,mu)%b(2,jut)=clinetzz(i5,i6,mu)%b(2,jut)+lz
     & 7_856(mu)%b(2,1)*cx1+lz7_856(mu)%d(2,2)*cy2
      clinetzz(i5,i6,mu)%c(2,jut)=clinetzz(i5,i6,mu)%c(2,jut)+lz
     & 7_856(mu)%c(2,1)*cz1+lz7_856(mu)%a(2,2)*cw2
      clinetzz(i5,i6,mu)%d(2,jut)=clinetzz(i5,i6,mu)%d(2,jut)+lz
     & 7_856(mu)%b(2,1)*cw1+lz7_856(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id7)
      rmassr=-rmass(id8)
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=cz5678(i1,i2,&1,&2,mu),abcd=clinetzz(i1,i2,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cz5678(i1,i2,iut,jut,mu)=cz5678(i1,i2,iut,jut,mu)+clinetzz
     & (i1,i2,mu)%a(iut,jut)+rmassl*clinetzz(i1,i2,mu)%b(iut,jut
     & )+rmassr*clinetzz(i1,i2,mu)%c(iut,jut)+rmassl*rmassr*clin
     & etzz(i1,i2,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TsT -- aa=clinetzz(i5,i6,mu)%a,bb=clinetzz(i5,i6,mu)%b,cc=clinetzz(i5,
* i6,mu)%c,dd=clinetzz(i5,i6,mu)%d,a1=l1_56(i5,i6)%a,b1=l1_56(i5,i6)%b,c
* 1=l1_56(i5,i6)%c,d1=l1_56(i5,i6)%d,a2=rz2_156(mu)%a,b2=rz2_156(mu)%b,c
* 2=rz2_156(mu)%c,d2=rz2_156(mu)%d,prq=p156q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=l1_56(i5,i6)%a(iut,1)+l1_56(i5,i6)%c(iut,1)*rmass(id1)
      cx2=l1_56(i5,i6)%c(iut,2)*p156q+l1_56(i5,i6)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_56(i5,i6)%b(iut,1)+l1_56(i5,i6)%d(iut,1)*rmass(id1)
      cy2=l1_56(i5,i6)%d(iut,2)*p156q+l1_56(i5,i6)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_56(i5,i6)%c(iut,1)*p156q+l1_56(i5,i6)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_56(i5,i6)%a(iut,2)+l1_56(i5,i6)%c(iut,2)*rmass(id1)
      cz1=l1_56(i5,i6)%d(iut,1)*p156q+l1_56(i5,i6)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_56(i5,i6)%b(iut,2)+l1_56(i5,i6)%d(iut,2)*rmass(id1)
      clinetzz(i5,i6,mu)%a(iut,1)=cx1*rz2_156(mu)%a(1,1)+cx2*rz2
     & _156(mu)%b(2,1)
      clinetzz(i5,i6,mu)%b(iut,1)=cy1*rz2_156(mu)%a(1,1)+cy2*rz2
     & _156(mu)%b(2,1)
      clinetzz(i5,i6,mu)%c(iut,1)=cw1*rz2_156(mu)%d(1,1)+cw2*rz2
     & _156(mu)%c(2,1)
      clinetzz(i5,i6,mu)%d(iut,1)=cz1*rz2_156(mu)%d(1,1)+cz2*rz2
     & _156(mu)%c(2,1)
      clinetzz(i5,i6,mu)%a(iut,2)=cw1*rz2_156(mu)%b(1,2)+cw2*rz2
     & _156(mu)%a(2,2)
      clinetzz(i5,i6,mu)%b(iut,2)=cz1*rz2_156(mu)%b(1,2)+cz2*rz2
     & _156(mu)%a(2,2)
      clinetzz(i5,i6,mu)%c(iut,2)=cx1*rz2_156(mu)%c(1,2)+cx2*rz2
     & _156(mu)%d(2,2)
      clinetzz(i5,i6,mu)%d(iut,2)=cy1*rz2_156(mu)%c(1,2)+cy2*rz2
     & _156(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TTs -- aa=clinetzz(i5,i6,mu)%a,bb=clinetzz(i5,i6,mu)%b,cc=clinetzz(i5,
* i6,mu)%c,dd=clinetzz(i5,i6,mu)%d,a1=lz1_256(mu)%a,b1=lz1_256(mu)%b,c1=
* lz1_256(mu)%c,d1=lz1_256(mu)%d,a2=r2_56(i5,i6)%a,b2=r2_56(i5,i6)%b,c2=
* r2_56(i5,i6)%c,d2=r2_56(i5,i6)%d,prq=p256q,m=rmass(id1),nsum=1
      do jut=1,2
      cx1=r2_56(i5,i6)%a(1,jut)+rmass(id1)*r2_56(i5,i6)%b(1,jut)
      cx2=r2_56(i5,i6)%a(2,jut)+rmass(id1)*r2_56(i5,i6)%b(2,jut)
      cy1=p256q*r2_56(i5,i6)%b(1,jut)+rmass(id1)*r2_56(i5,i6)%a(
     & 1,jut)
      cy2=p256q*r2_56(i5,i6)%b(2,jut)+rmass(id1)*r2_56(i5,i6)%a(
     & 2,jut)
      cw1=r2_56(i5,i6)%c(1,jut)+rmass(id1)*r2_56(i5,i6)%d(1,jut)
      cw2=r2_56(i5,i6)%c(2,jut)+rmass(id1)*r2_56(i5,i6)%d(2,jut)
      cz1=p256q*r2_56(i5,i6)%d(1,jut)+rmass(id1)*r2_56(i5,i6)%c(
     & 1,jut)
      cz2=p256q*r2_56(i5,i6)%d(2,jut)+rmass(id1)*r2_56(i5,i6)%c(
     & 2,jut)
      clinetzz(i5,i6,mu)%a(1,jut)=clinetzz(i5,i6,mu)%a(1,jut)+lz
     & 1_256(mu)%a(1,1)*cx1+lz1_256(mu)%c(1,2)*cy2
      clinetzz(i5,i6,mu)%b(1,jut)=clinetzz(i5,i6,mu)%b(1,jut)+lz
     & 1_256(mu)%d(1,1)*cy1+lz1_256(mu)%b(1,2)*cx2
      clinetzz(i5,i6,mu)%c(1,jut)=clinetzz(i5,i6,mu)%c(1,jut)+lz
     & 1_256(mu)%a(1,1)*cw1+lz1_256(mu)%c(1,2)*cz2
      clinetzz(i5,i6,mu)%d(1,jut)=clinetzz(i5,i6,mu)%d(1,jut)+lz
     & 1_256(mu)%d(1,1)*cz1+lz1_256(mu)%b(1,2)*cw2
      clinetzz(i5,i6,mu)%a(2,jut)=clinetzz(i5,i6,mu)%a(2,jut)+lz
     & 1_256(mu)%c(2,1)*cy1+lz1_256(mu)%a(2,2)*cx2
      clinetzz(i5,i6,mu)%b(2,jut)=clinetzz(i5,i6,mu)%b(2,jut)+lz
     & 1_256(mu)%b(2,1)*cx1+lz1_256(mu)%d(2,2)*cy2
      clinetzz(i5,i6,mu)%c(2,jut)=clinetzz(i5,i6,mu)%c(2,jut)+lz
     & 1_256(mu)%c(2,1)*cz1+lz1_256(mu)%a(2,2)*cw2
      clinetzz(i5,i6,mu)%d(2,jut)=clinetzz(i5,i6,mu)%d(2,jut)+lz
     & 1_256(mu)%b(2,1)*cw1+lz1_256(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id1)
      rmassr=-rmass(id2)
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=cz1256(&1,&2,i3,i4,mu),abcd=clinetzz(i3,i4,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cz1256(iut,jut,i3,i4,mu)=clinetzz(i3,i4,mu)%a(iut,jut)+rma
     & ssl*clinetzz(i3,i4,mu)%b(iut,jut)+rmassr*clinetzz(i3,i4,m
     & u)%c(iut,jut)+rmassl*rmassr*clinetzz(i3,i4,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TsT -- aa=clinetzz(i1,i2,mu)%a,bb=clinetzz(i1,i2,mu)%b,cc=clinetzz(i1,
* i2,mu)%c,dd=clinetzz(i1,i2,mu)%d,a1=l5_12(i1,i2)%a,b1=l5_12(i1,i2)%b,c
* 1=l5_12(i1,i2)%c,d1=l5_12(i1,i2)%d,a2=rz6_512(mu)%a,b2=rz6_512(mu)%b,c
* 2=rz6_512(mu)%c,d2=rz6_512(mu)%d,prq=p512q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=l5_12(i1,i2)%a(iut,1)+l5_12(i1,i2)%c(iut,1)*rmass(id5)
      cx2=l5_12(i1,i2)%c(iut,2)*p512q+l5_12(i1,i2)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_12(i1,i2)%b(iut,1)+l5_12(i1,i2)%d(iut,1)*rmass(id5)
      cy2=l5_12(i1,i2)%d(iut,2)*p512q+l5_12(i1,i2)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_12(i1,i2)%c(iut,1)*p512q+l5_12(i1,i2)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_12(i1,i2)%a(iut,2)+l5_12(i1,i2)%c(iut,2)*rmass(id5)
      cz1=l5_12(i1,i2)%d(iut,1)*p512q+l5_12(i1,i2)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_12(i1,i2)%b(iut,2)+l5_12(i1,i2)%d(iut,2)*rmass(id5)
      clinetzz(i1,i2,mu)%a(iut,1)=cx1*rz6_512(mu)%a(1,1)+cx2*rz6
     & _512(mu)%b(2,1)
      clinetzz(i1,i2,mu)%b(iut,1)=cy1*rz6_512(mu)%a(1,1)+cy2*rz6
     & _512(mu)%b(2,1)
      clinetzz(i1,i2,mu)%c(iut,1)=cw1*rz6_512(mu)%d(1,1)+cw2*rz6
     & _512(mu)%c(2,1)
      clinetzz(i1,i2,mu)%d(iut,1)=cz1*rz6_512(mu)%d(1,1)+cz2*rz6
     & _512(mu)%c(2,1)
      clinetzz(i1,i2,mu)%a(iut,2)=cw1*rz6_512(mu)%b(1,2)+cw2*rz6
     & _512(mu)%a(2,2)
      clinetzz(i1,i2,mu)%b(iut,2)=cz1*rz6_512(mu)%b(1,2)+cz2*rz6
     & _512(mu)%a(2,2)
      clinetzz(i1,i2,mu)%c(iut,2)=cx1*rz6_512(mu)%c(1,2)+cx2*rz6
     & _512(mu)%d(2,2)
      clinetzz(i1,i2,mu)%d(iut,2)=cy1*rz6_512(mu)%c(1,2)+cy2*rz6
     & _512(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TTs -- aa=clinetzz(i1,i2,mu)%a,bb=clinetzz(i1,i2,mu)%b,cc=clinetzz(i1,
* i2,mu)%c,dd=clinetzz(i1,i2,mu)%d,a1=lz5_612(mu)%a,b1=lz5_612(mu)%b,c1=
* lz5_612(mu)%c,d1=lz5_612(mu)%d,a2=r6_12(i1,i2)%a,b2=r6_12(i1,i2)%b,c2=
* r6_12(i1,i2)%c,d2=r6_12(i1,i2)%d,prq=p612q,m=rmass(id5),nsum=1
      do jut=1,2
      cx1=r6_12(i1,i2)%a(1,jut)+rmass(id5)*r6_12(i1,i2)%b(1,jut)
      cx2=r6_12(i1,i2)%a(2,jut)+rmass(id5)*r6_12(i1,i2)%b(2,jut)
      cy1=p612q*r6_12(i1,i2)%b(1,jut)+rmass(id5)*r6_12(i1,i2)%a(
     & 1,jut)
      cy2=p612q*r6_12(i1,i2)%b(2,jut)+rmass(id5)*r6_12(i1,i2)%a(
     & 2,jut)
      cw1=r6_12(i1,i2)%c(1,jut)+rmass(id5)*r6_12(i1,i2)%d(1,jut)
      cw2=r6_12(i1,i2)%c(2,jut)+rmass(id5)*r6_12(i1,i2)%d(2,jut)
      cz1=p612q*r6_12(i1,i2)%d(1,jut)+rmass(id5)*r6_12(i1,i2)%c(
     & 1,jut)
      cz2=p612q*r6_12(i1,i2)%d(2,jut)+rmass(id5)*r6_12(i1,i2)%c(
     & 2,jut)
      clinetzz(i1,i2,mu)%a(1,jut)=clinetzz(i1,i2,mu)%a(1,jut)+lz
     & 5_612(mu)%a(1,1)*cx1+lz5_612(mu)%c(1,2)*cy2
      clinetzz(i1,i2,mu)%b(1,jut)=clinetzz(i1,i2,mu)%b(1,jut)+lz
     & 5_612(mu)%d(1,1)*cy1+lz5_612(mu)%b(1,2)*cx2
      clinetzz(i1,i2,mu)%c(1,jut)=clinetzz(i1,i2,mu)%c(1,jut)+lz
     & 5_612(mu)%a(1,1)*cw1+lz5_612(mu)%c(1,2)*cz2
      clinetzz(i1,i2,mu)%d(1,jut)=clinetzz(i1,i2,mu)%d(1,jut)+lz
     & 5_612(mu)%d(1,1)*cz1+lz5_612(mu)%b(1,2)*cw2
      clinetzz(i1,i2,mu)%a(2,jut)=clinetzz(i1,i2,mu)%a(2,jut)+lz
     & 5_612(mu)%c(2,1)*cy1+lz5_612(mu)%a(2,2)*cx2
      clinetzz(i1,i2,mu)%b(2,jut)=clinetzz(i1,i2,mu)%b(2,jut)+lz
     & 5_612(mu)%b(2,1)*cx1+lz5_612(mu)%d(2,2)*cy2
      clinetzz(i1,i2,mu)%c(2,jut)=clinetzz(i1,i2,mu)%c(2,jut)+lz
     & 5_612(mu)%c(2,1)*cz1+lz5_612(mu)%a(2,2)*cw2
      clinetzz(i1,i2,mu)%d(2,jut)=clinetzz(i1,i2,mu)%d(2,jut)+lz
     & 5_612(mu)%b(2,1)*cw1+lz5_612(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id5)
      rmassr=-rmass(id6)
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=cz1256(i1,i2,&1,&2,mu),abcd=clinetzz(i1,i2,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cz1256(i1,i2,iut,jut,mu)=cz1256(i1,i2,iut,jut,mu)+clinetzz
     & (i1,i2,mu)%a(iut,jut)+rmassl*clinetzz(i1,i2,mu)%b(iut,jut
     & )+rmassr*clinetzz(i1,i2,mu)%c(iut,jut)+rmassl*rmassr*clin
     & etzz(i1,i2,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TsT -- aa=clinetzz(i7,i8,mu)%a,bb=clinetzz(i7,i8,mu)%b,cc=clinetzz(i7,
* i8,mu)%c,dd=clinetzz(i7,i8,mu)%d,a1=l3_78(i7,i8)%a,b1=l3_78(i7,i8)%b,c
* 1=l3_78(i7,i8)%c,d1=l3_78(i7,i8)%d,a2=rz4_378(mu)%a,b2=rz4_378(mu)%b,c
* 2=rz4_378(mu)%c,d2=rz4_378(mu)%d,prq=p378q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=l3_78(i7,i8)%a(iut,1)+l3_78(i7,i8)%c(iut,1)*rmass(id3)
      cx2=l3_78(i7,i8)%c(iut,2)*p378q+l3_78(i7,i8)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_78(i7,i8)%b(iut,1)+l3_78(i7,i8)%d(iut,1)*rmass(id3)
      cy2=l3_78(i7,i8)%d(iut,2)*p378q+l3_78(i7,i8)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_78(i7,i8)%c(iut,1)*p378q+l3_78(i7,i8)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_78(i7,i8)%a(iut,2)+l3_78(i7,i8)%c(iut,2)*rmass(id3)
      cz1=l3_78(i7,i8)%d(iut,1)*p378q+l3_78(i7,i8)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_78(i7,i8)%b(iut,2)+l3_78(i7,i8)%d(iut,2)*rmass(id3)
      clinetzz(i7,i8,mu)%a(iut,1)=cx1*rz4_378(mu)%a(1,1)+cx2*rz4
     & _378(mu)%b(2,1)
      clinetzz(i7,i8,mu)%b(iut,1)=cy1*rz4_378(mu)%a(1,1)+cy2*rz4
     & _378(mu)%b(2,1)
      clinetzz(i7,i8,mu)%c(iut,1)=cw1*rz4_378(mu)%d(1,1)+cw2*rz4
     & _378(mu)%c(2,1)
      clinetzz(i7,i8,mu)%d(iut,1)=cz1*rz4_378(mu)%d(1,1)+cz2*rz4
     & _378(mu)%c(2,1)
      clinetzz(i7,i8,mu)%a(iut,2)=cw1*rz4_378(mu)%b(1,2)+cw2*rz4
     & _378(mu)%a(2,2)
      clinetzz(i7,i8,mu)%b(iut,2)=cz1*rz4_378(mu)%b(1,2)+cz2*rz4
     & _378(mu)%a(2,2)
      clinetzz(i7,i8,mu)%c(iut,2)=cx1*rz4_378(mu)%c(1,2)+cx2*rz4
     & _378(mu)%d(2,2)
      clinetzz(i7,i8,mu)%d(iut,2)=cy1*rz4_378(mu)%c(1,2)+cy2*rz4
     & _378(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TTs -- aa=clinetzz(i7,i8,mu)%a,bb=clinetzz(i7,i8,mu)%b,cc=clinetzz(i7,
* i8,mu)%c,dd=clinetzz(i7,i8,mu)%d,a1=lz3_478(mu)%a,b1=lz3_478(mu)%b,c1=
* lz3_478(mu)%c,d1=lz3_478(mu)%d,a2=r4_78(i7,i8)%a,b2=r4_78(i7,i8)%b,c2=
* r4_78(i7,i8)%c,d2=r4_78(i7,i8)%d,prq=p478q,m=rmass(id3),nsum=1
      do jut=1,2
      cx1=r4_78(i7,i8)%a(1,jut)+rmass(id3)*r4_78(i7,i8)%b(1,jut)
      cx2=r4_78(i7,i8)%a(2,jut)+rmass(id3)*r4_78(i7,i8)%b(2,jut)
      cy1=p478q*r4_78(i7,i8)%b(1,jut)+rmass(id3)*r4_78(i7,i8)%a(
     & 1,jut)
      cy2=p478q*r4_78(i7,i8)%b(2,jut)+rmass(id3)*r4_78(i7,i8)%a(
     & 2,jut)
      cw1=r4_78(i7,i8)%c(1,jut)+rmass(id3)*r4_78(i7,i8)%d(1,jut)
      cw2=r4_78(i7,i8)%c(2,jut)+rmass(id3)*r4_78(i7,i8)%d(2,jut)
      cz1=p478q*r4_78(i7,i8)%d(1,jut)+rmass(id3)*r4_78(i7,i8)%c(
     & 1,jut)
      cz2=p478q*r4_78(i7,i8)%d(2,jut)+rmass(id3)*r4_78(i7,i8)%c(
     & 2,jut)
      clinetzz(i7,i8,mu)%a(1,jut)=clinetzz(i7,i8,mu)%a(1,jut)+lz
     & 3_478(mu)%a(1,1)*cx1+lz3_478(mu)%c(1,2)*cy2
      clinetzz(i7,i8,mu)%b(1,jut)=clinetzz(i7,i8,mu)%b(1,jut)+lz
     & 3_478(mu)%d(1,1)*cy1+lz3_478(mu)%b(1,2)*cx2
      clinetzz(i7,i8,mu)%c(1,jut)=clinetzz(i7,i8,mu)%c(1,jut)+lz
     & 3_478(mu)%a(1,1)*cw1+lz3_478(mu)%c(1,2)*cz2
      clinetzz(i7,i8,mu)%d(1,jut)=clinetzz(i7,i8,mu)%d(1,jut)+lz
     & 3_478(mu)%d(1,1)*cz1+lz3_478(mu)%b(1,2)*cw2
      clinetzz(i7,i8,mu)%a(2,jut)=clinetzz(i7,i8,mu)%a(2,jut)+lz
     & 3_478(mu)%c(2,1)*cy1+lz3_478(mu)%a(2,2)*cx2
      clinetzz(i7,i8,mu)%b(2,jut)=clinetzz(i7,i8,mu)%b(2,jut)+lz
     & 3_478(mu)%b(2,1)*cx1+lz3_478(mu)%d(2,2)*cy2
      clinetzz(i7,i8,mu)%c(2,jut)=clinetzz(i7,i8,mu)%c(2,jut)+lz
     & 3_478(mu)%c(2,1)*cz1+lz3_478(mu)%a(2,2)*cw2
      clinetzz(i7,i8,mu)%d(2,jut)=clinetzz(i7,i8,mu)%d(2,jut)+lz
     & 3_478(mu)%b(2,1)*cw1+lz3_478(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id3)
      rmassr=-rmass(id4)
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=cz3478(&1,&2,i3,i4,mu),abcd=clinetzz(i3,i4,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cz3478(iut,jut,i3,i4,mu)=clinetzz(i3,i4,mu)%a(iut,jut)+rma
     & ssl*clinetzz(i3,i4,mu)%b(iut,jut)+rmassr*clinetzz(i3,i4,m
     & u)%c(iut,jut)+rmassl*rmassr*clinetzz(i3,i4,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TsT -- aa=clinetzz(i3,i4,mu)%a,bb=clinetzz(i3,i4,mu)%b,cc=clinetzz(i3,
* i4,mu)%c,dd=clinetzz(i3,i4,mu)%d,a1=l7_34(i3,i4)%a,b1=l7_34(i3,i4)%b,c
* 1=l7_34(i3,i4)%c,d1=l7_34(i3,i4)%d,a2=rz8_734(mu)%a,b2=rz8_734(mu)%b,c
* 2=rz8_734(mu)%c,d2=rz8_734(mu)%d,prq=p734q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=l7_34(i3,i4)%a(iut,1)+l7_34(i3,i4)%c(iut,1)*rmass(id7)
      cx2=l7_34(i3,i4)%c(iut,2)*p734q+l7_34(i3,i4)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_34(i3,i4)%b(iut,1)+l7_34(i3,i4)%d(iut,1)*rmass(id7)
      cy2=l7_34(i3,i4)%d(iut,2)*p734q+l7_34(i3,i4)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_34(i3,i4)%c(iut,1)*p734q+l7_34(i3,i4)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_34(i3,i4)%a(iut,2)+l7_34(i3,i4)%c(iut,2)*rmass(id7)
      cz1=l7_34(i3,i4)%d(iut,1)*p734q+l7_34(i3,i4)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_34(i3,i4)%b(iut,2)+l7_34(i3,i4)%d(iut,2)*rmass(id7)
      clinetzz(i3,i4,mu)%a(iut,1)=cx1*rz8_734(mu)%a(1,1)+cx2*rz8
     & _734(mu)%b(2,1)
      clinetzz(i3,i4,mu)%b(iut,1)=cy1*rz8_734(mu)%a(1,1)+cy2*rz8
     & _734(mu)%b(2,1)
      clinetzz(i3,i4,mu)%c(iut,1)=cw1*rz8_734(mu)%d(1,1)+cw2*rz8
     & _734(mu)%c(2,1)
      clinetzz(i3,i4,mu)%d(iut,1)=cz1*rz8_734(mu)%d(1,1)+cz2*rz8
     & _734(mu)%c(2,1)
      clinetzz(i3,i4,mu)%a(iut,2)=cw1*rz8_734(mu)%b(1,2)+cw2*rz8
     & _734(mu)%a(2,2)
      clinetzz(i3,i4,mu)%b(iut,2)=cz1*rz8_734(mu)%b(1,2)+cz2*rz8
     & _734(mu)%a(2,2)
      clinetzz(i3,i4,mu)%c(iut,2)=cx1*rz8_734(mu)%c(1,2)+cx2*rz8
     & _734(mu)%d(2,2)
      clinetzz(i3,i4,mu)%d(iut,2)=cy1*rz8_734(mu)%c(1,2)+cy2*rz8
     & _734(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TTs -- aa=clinetzz(i3,i4,mu)%a,bb=clinetzz(i3,i4,mu)%b,cc=clinetzz(i3,
* i4,mu)%c,dd=clinetzz(i3,i4,mu)%d,a1=lz7_834(mu)%a,b1=lz7_834(mu)%b,c1=
* lz7_834(mu)%c,d1=lz7_834(mu)%d,a2=r8_34(i3,i4)%a,b2=r8_34(i3,i4)%b,c2=
* r8_34(i3,i4)%c,d2=r8_34(i3,i4)%d,prq=p834q,m=rmass(id7),nsum=1
      do jut=1,2
      cx1=r8_34(i3,i4)%a(1,jut)+rmass(id7)*r8_34(i3,i4)%b(1,jut)
      cx2=r8_34(i3,i4)%a(2,jut)+rmass(id7)*r8_34(i3,i4)%b(2,jut)
      cy1=p834q*r8_34(i3,i4)%b(1,jut)+rmass(id7)*r8_34(i3,i4)%a(
     & 1,jut)
      cy2=p834q*r8_34(i3,i4)%b(2,jut)+rmass(id7)*r8_34(i3,i4)%a(
     & 2,jut)
      cw1=r8_34(i3,i4)%c(1,jut)+rmass(id7)*r8_34(i3,i4)%d(1,jut)
      cw2=r8_34(i3,i4)%c(2,jut)+rmass(id7)*r8_34(i3,i4)%d(2,jut)
      cz1=p834q*r8_34(i3,i4)%d(1,jut)+rmass(id7)*r8_34(i3,i4)%c(
     & 1,jut)
      cz2=p834q*r8_34(i3,i4)%d(2,jut)+rmass(id7)*r8_34(i3,i4)%c(
     & 2,jut)
      clinetzz(i3,i4,mu)%a(1,jut)=clinetzz(i3,i4,mu)%a(1,jut)+lz
     & 7_834(mu)%a(1,1)*cx1+lz7_834(mu)%c(1,2)*cy2
      clinetzz(i3,i4,mu)%b(1,jut)=clinetzz(i3,i4,mu)%b(1,jut)+lz
     & 7_834(mu)%d(1,1)*cy1+lz7_834(mu)%b(1,2)*cx2
      clinetzz(i3,i4,mu)%c(1,jut)=clinetzz(i3,i4,mu)%c(1,jut)+lz
     & 7_834(mu)%a(1,1)*cw1+lz7_834(mu)%c(1,2)*cz2
      clinetzz(i3,i4,mu)%d(1,jut)=clinetzz(i3,i4,mu)%d(1,jut)+lz
     & 7_834(mu)%d(1,1)*cz1+lz7_834(mu)%b(1,2)*cw2
      clinetzz(i3,i4,mu)%a(2,jut)=clinetzz(i3,i4,mu)%a(2,jut)+lz
     & 7_834(mu)%c(2,1)*cy1+lz7_834(mu)%a(2,2)*cx2
      clinetzz(i3,i4,mu)%b(2,jut)=clinetzz(i3,i4,mu)%b(2,jut)+lz
     & 7_834(mu)%b(2,1)*cx1+lz7_834(mu)%d(2,2)*cy2
      clinetzz(i3,i4,mu)%c(2,jut)=clinetzz(i3,i4,mu)%c(2,jut)+lz
     & 7_834(mu)%c(2,1)*cz1+lz7_834(mu)%a(2,2)*cw2
      clinetzz(i3,i4,mu)%d(2,jut)=clinetzz(i3,i4,mu)%d(2,jut)+lz
     & 7_834(mu)%b(2,1)*cw1+lz7_834(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id7)
      rmassr=-rmass(id8)
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=cz3478(i1,i2,&1,&2,mu),abcd=clinetzz(i1,i2,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cz3478(i1,i2,iut,jut,mu)=cz3478(i1,i2,iut,jut,mu)+clinetzz
     & (i1,i2,mu)%a(iut,jut)+rmassl*clinetzz(i1,i2,mu)%b(iut,jut
     & )+rmassr*clinetzz(i1,i2,mu)%c(iut,jut)+rmassl*rmassr*clin
     & etzz(i1,i2,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TsT -- aa=clinetzz(i7,i8,mu)%a,bb=clinetzz(i7,i8,mu)%b,cc=clinetzz(i7,
* i8,mu)%c,dd=clinetzz(i7,i8,mu)%d,a1=l1_78(i7,i8)%a,b1=l1_78(i7,i8)%b,c
* 1=l1_78(i7,i8)%c,d1=l1_78(i7,i8)%d,a2=rz2_178(mu)%a,b2=rz2_178(mu)%b,c
* 2=rz2_178(mu)%c,d2=rz2_178(mu)%d,prq=p178q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=l1_78(i7,i8)%a(iut,1)+l1_78(i7,i8)%c(iut,1)*rmass(id1)
      cx2=l1_78(i7,i8)%c(iut,2)*p178q+l1_78(i7,i8)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_78(i7,i8)%b(iut,1)+l1_78(i7,i8)%d(iut,1)*rmass(id1)
      cy2=l1_78(i7,i8)%d(iut,2)*p178q+l1_78(i7,i8)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_78(i7,i8)%c(iut,1)*p178q+l1_78(i7,i8)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_78(i7,i8)%a(iut,2)+l1_78(i7,i8)%c(iut,2)*rmass(id1)
      cz1=l1_78(i7,i8)%d(iut,1)*p178q+l1_78(i7,i8)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_78(i7,i8)%b(iut,2)+l1_78(i7,i8)%d(iut,2)*rmass(id1)
      clinetzz(i7,i8,mu)%a(iut,1)=cx1*rz2_178(mu)%a(1,1)+cx2*rz2
     & _178(mu)%b(2,1)
      clinetzz(i7,i8,mu)%b(iut,1)=cy1*rz2_178(mu)%a(1,1)+cy2*rz2
     & _178(mu)%b(2,1)
      clinetzz(i7,i8,mu)%c(iut,1)=cw1*rz2_178(mu)%d(1,1)+cw2*rz2
     & _178(mu)%c(2,1)
      clinetzz(i7,i8,mu)%d(iut,1)=cz1*rz2_178(mu)%d(1,1)+cz2*rz2
     & _178(mu)%c(2,1)
      clinetzz(i7,i8,mu)%a(iut,2)=cw1*rz2_178(mu)%b(1,2)+cw2*rz2
     & _178(mu)%a(2,2)
      clinetzz(i7,i8,mu)%b(iut,2)=cz1*rz2_178(mu)%b(1,2)+cz2*rz2
     & _178(mu)%a(2,2)
      clinetzz(i7,i8,mu)%c(iut,2)=cx1*rz2_178(mu)%c(1,2)+cx2*rz2
     & _178(mu)%d(2,2)
      clinetzz(i7,i8,mu)%d(iut,2)=cy1*rz2_178(mu)%c(1,2)+cy2*rz2
     & _178(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TTs -- aa=clinetzz(i7,i8,mu)%a,bb=clinetzz(i7,i8,mu)%b,cc=clinetzz(i7,
* i8,mu)%c,dd=clinetzz(i7,i8,mu)%d,a1=lz1_278(mu)%a,b1=lz1_278(mu)%b,c1=
* lz1_278(mu)%c,d1=lz1_278(mu)%d,a2=r2_78(i7,i8)%a,b2=r2_78(i7,i8)%b,c2=
* r2_78(i7,i8)%c,d2=r2_78(i7,i8)%d,prq=p278q,m=rmass(id1),nsum=1
      do jut=1,2
      cx1=r2_78(i7,i8)%a(1,jut)+rmass(id1)*r2_78(i7,i8)%b(1,jut)
      cx2=r2_78(i7,i8)%a(2,jut)+rmass(id1)*r2_78(i7,i8)%b(2,jut)
      cy1=p278q*r2_78(i7,i8)%b(1,jut)+rmass(id1)*r2_78(i7,i8)%a(
     & 1,jut)
      cy2=p278q*r2_78(i7,i8)%b(2,jut)+rmass(id1)*r2_78(i7,i8)%a(
     & 2,jut)
      cw1=r2_78(i7,i8)%c(1,jut)+rmass(id1)*r2_78(i7,i8)%d(1,jut)
      cw2=r2_78(i7,i8)%c(2,jut)+rmass(id1)*r2_78(i7,i8)%d(2,jut)
      cz1=p278q*r2_78(i7,i8)%d(1,jut)+rmass(id1)*r2_78(i7,i8)%c(
     & 1,jut)
      cz2=p278q*r2_78(i7,i8)%d(2,jut)+rmass(id1)*r2_78(i7,i8)%c(
     & 2,jut)
      clinetzz(i7,i8,mu)%a(1,jut)=clinetzz(i7,i8,mu)%a(1,jut)+lz
     & 1_278(mu)%a(1,1)*cx1+lz1_278(mu)%c(1,2)*cy2
      clinetzz(i7,i8,mu)%b(1,jut)=clinetzz(i7,i8,mu)%b(1,jut)+lz
     & 1_278(mu)%d(1,1)*cy1+lz1_278(mu)%b(1,2)*cx2
      clinetzz(i7,i8,mu)%c(1,jut)=clinetzz(i7,i8,mu)%c(1,jut)+lz
     & 1_278(mu)%a(1,1)*cw1+lz1_278(mu)%c(1,2)*cz2
      clinetzz(i7,i8,mu)%d(1,jut)=clinetzz(i7,i8,mu)%d(1,jut)+lz
     & 1_278(mu)%d(1,1)*cz1+lz1_278(mu)%b(1,2)*cw2
      clinetzz(i7,i8,mu)%a(2,jut)=clinetzz(i7,i8,mu)%a(2,jut)+lz
     & 1_278(mu)%c(2,1)*cy1+lz1_278(mu)%a(2,2)*cx2
      clinetzz(i7,i8,mu)%b(2,jut)=clinetzz(i7,i8,mu)%b(2,jut)+lz
     & 1_278(mu)%b(2,1)*cx1+lz1_278(mu)%d(2,2)*cy2
      clinetzz(i7,i8,mu)%c(2,jut)=clinetzz(i7,i8,mu)%c(2,jut)+lz
     & 1_278(mu)%c(2,1)*cz1+lz1_278(mu)%a(2,2)*cw2
      clinetzz(i7,i8,mu)%d(2,jut)=clinetzz(i7,i8,mu)%d(2,jut)+lz
     & 1_278(mu)%b(2,1)*cw1+lz1_278(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id1)
      rmassr=-rmass(id2)
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=cz1278(&1,&2,i3,i4,mu),abcd=clinetzz(i3,i4,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cz1278(iut,jut,i3,i4,mu)=clinetzz(i3,i4,mu)%a(iut,jut)+rma
     & ssl*clinetzz(i3,i4,mu)%b(iut,jut)+rmassr*clinetzz(i3,i4,m
     & u)%c(iut,jut)+rmassl*rmassr*clinetzz(i3,i4,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TsT -- aa=clinetzz(i1,i2,mu)%a,bb=clinetzz(i1,i2,mu)%b,cc=clinetzz(i1,
* i2,mu)%c,dd=clinetzz(i1,i2,mu)%d,a1=l7_12(i1,i2)%a,b1=l7_12(i1,i2)%b,c
* 1=l7_12(i1,i2)%c,d1=l7_12(i1,i2)%d,a2=rz8_712(mu)%a,b2=rz8_712(mu)%b,c
* 2=rz8_712(mu)%c,d2=rz8_712(mu)%d,prq=p712q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=l7_12(i1,i2)%a(iut,1)+l7_12(i1,i2)%c(iut,1)*rmass(id7)
      cx2=l7_12(i1,i2)%c(iut,2)*p712q+l7_12(i1,i2)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_12(i1,i2)%b(iut,1)+l7_12(i1,i2)%d(iut,1)*rmass(id7)
      cy2=l7_12(i1,i2)%d(iut,2)*p712q+l7_12(i1,i2)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_12(i1,i2)%c(iut,1)*p712q+l7_12(i1,i2)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_12(i1,i2)%a(iut,2)+l7_12(i1,i2)%c(iut,2)*rmass(id7)
      cz1=l7_12(i1,i2)%d(iut,1)*p712q+l7_12(i1,i2)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_12(i1,i2)%b(iut,2)+l7_12(i1,i2)%d(iut,2)*rmass(id7)
      clinetzz(i1,i2,mu)%a(iut,1)=cx1*rz8_712(mu)%a(1,1)+cx2*rz8
     & _712(mu)%b(2,1)
      clinetzz(i1,i2,mu)%b(iut,1)=cy1*rz8_712(mu)%a(1,1)+cy2*rz8
     & _712(mu)%b(2,1)
      clinetzz(i1,i2,mu)%c(iut,1)=cw1*rz8_712(mu)%d(1,1)+cw2*rz8
     & _712(mu)%c(2,1)
      clinetzz(i1,i2,mu)%d(iut,1)=cz1*rz8_712(mu)%d(1,1)+cz2*rz8
     & _712(mu)%c(2,1)
      clinetzz(i1,i2,mu)%a(iut,2)=cw1*rz8_712(mu)%b(1,2)+cw2*rz8
     & _712(mu)%a(2,2)
      clinetzz(i1,i2,mu)%b(iut,2)=cz1*rz8_712(mu)%b(1,2)+cz2*rz8
     & _712(mu)%a(2,2)
      clinetzz(i1,i2,mu)%c(iut,2)=cx1*rz8_712(mu)%c(1,2)+cx2*rz8
     & _712(mu)%d(2,2)
      clinetzz(i1,i2,mu)%d(iut,2)=cy1*rz8_712(mu)%c(1,2)+cy2*rz8
     & _712(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TTs -- aa=clinetzz(i1,i2,mu)%a,bb=clinetzz(i1,i2,mu)%b,cc=clinetzz(i1,
* i2,mu)%c,dd=clinetzz(i1,i2,mu)%d,a1=lz7_812(mu)%a,b1=lz7_812(mu)%b,c1=
* lz7_812(mu)%c,d1=lz7_812(mu)%d,a2=r8_12(i1,i2)%a,b2=r8_12(i1,i2)%b,c2=
* r8_12(i1,i2)%c,d2=r8_12(i1,i2)%d,prq=p812q,m=rmass(id7),nsum=1
      do jut=1,2
      cx1=r8_12(i1,i2)%a(1,jut)+rmass(id7)*r8_12(i1,i2)%b(1,jut)
      cx2=r8_12(i1,i2)%a(2,jut)+rmass(id7)*r8_12(i1,i2)%b(2,jut)
      cy1=p812q*r8_12(i1,i2)%b(1,jut)+rmass(id7)*r8_12(i1,i2)%a(
     & 1,jut)
      cy2=p812q*r8_12(i1,i2)%b(2,jut)+rmass(id7)*r8_12(i1,i2)%a(
     & 2,jut)
      cw1=r8_12(i1,i2)%c(1,jut)+rmass(id7)*r8_12(i1,i2)%d(1,jut)
      cw2=r8_12(i1,i2)%c(2,jut)+rmass(id7)*r8_12(i1,i2)%d(2,jut)
      cz1=p812q*r8_12(i1,i2)%d(1,jut)+rmass(id7)*r8_12(i1,i2)%c(
     & 1,jut)
      cz2=p812q*r8_12(i1,i2)%d(2,jut)+rmass(id7)*r8_12(i1,i2)%c(
     & 2,jut)
      clinetzz(i1,i2,mu)%a(1,jut)=clinetzz(i1,i2,mu)%a(1,jut)+lz
     & 7_812(mu)%a(1,1)*cx1+lz7_812(mu)%c(1,2)*cy2
      clinetzz(i1,i2,mu)%b(1,jut)=clinetzz(i1,i2,mu)%b(1,jut)+lz
     & 7_812(mu)%d(1,1)*cy1+lz7_812(mu)%b(1,2)*cx2
      clinetzz(i1,i2,mu)%c(1,jut)=clinetzz(i1,i2,mu)%c(1,jut)+lz
     & 7_812(mu)%a(1,1)*cw1+lz7_812(mu)%c(1,2)*cz2
      clinetzz(i1,i2,mu)%d(1,jut)=clinetzz(i1,i2,mu)%d(1,jut)+lz
     & 7_812(mu)%d(1,1)*cz1+lz7_812(mu)%b(1,2)*cw2
      clinetzz(i1,i2,mu)%a(2,jut)=clinetzz(i1,i2,mu)%a(2,jut)+lz
     & 7_812(mu)%c(2,1)*cy1+lz7_812(mu)%a(2,2)*cx2
      clinetzz(i1,i2,mu)%b(2,jut)=clinetzz(i1,i2,mu)%b(2,jut)+lz
     & 7_812(mu)%b(2,1)*cx1+lz7_812(mu)%d(2,2)*cy2
      clinetzz(i1,i2,mu)%c(2,jut)=clinetzz(i1,i2,mu)%c(2,jut)+lz
     & 7_812(mu)%c(2,1)*cz1+lz7_812(mu)%a(2,2)*cw2
      clinetzz(i1,i2,mu)%d(2,jut)=clinetzz(i1,i2,mu)%d(2,jut)+lz
     & 7_812(mu)%b(2,1)*cw1+lz7_812(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id7)
      rmassr=-rmass(id8)
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=cz1278(i1,i2,&1,&2,mu),abcd=clinetzz(i1,i2,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cz1278(i1,i2,iut,jut,mu)=cz1278(i1,i2,iut,jut,mu)+clinetzz
     & (i1,i2,mu)%a(iut,jut)+rmassl*clinetzz(i1,i2,mu)%b(iut,jut
     & )+rmassr*clinetzz(i1,i2,mu)%c(iut,jut)+rmassl*rmassr*clin
     & etzz(i1,i2,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TsT -- aa=clinetzz(i5,i6,mu)%a,bb=clinetzz(i5,i6,mu)%b,cc=clinetzz(i5,
* i6,mu)%c,dd=clinetzz(i5,i6,mu)%d,a1=l3_56(i5,i6)%a,b1=l3_56(i5,i6)%b,c
* 1=l3_56(i5,i6)%c,d1=l3_56(i5,i6)%d,a2=rz4_356(mu)%a,b2=rz4_356(mu)%b,c
* 2=rz4_356(mu)%c,d2=rz4_356(mu)%d,prq=p356q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=l3_56(i5,i6)%a(iut,1)+l3_56(i5,i6)%c(iut,1)*rmass(id3)
      cx2=l3_56(i5,i6)%c(iut,2)*p356q+l3_56(i5,i6)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_56(i5,i6)%b(iut,1)+l3_56(i5,i6)%d(iut,1)*rmass(id3)
      cy2=l3_56(i5,i6)%d(iut,2)*p356q+l3_56(i5,i6)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_56(i5,i6)%c(iut,1)*p356q+l3_56(i5,i6)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_56(i5,i6)%a(iut,2)+l3_56(i5,i6)%c(iut,2)*rmass(id3)
      cz1=l3_56(i5,i6)%d(iut,1)*p356q+l3_56(i5,i6)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_56(i5,i6)%b(iut,2)+l3_56(i5,i6)%d(iut,2)*rmass(id3)
      clinetzz(i5,i6,mu)%a(iut,1)=cx1*rz4_356(mu)%a(1,1)+cx2*rz4
     & _356(mu)%b(2,1)
      clinetzz(i5,i6,mu)%b(iut,1)=cy1*rz4_356(mu)%a(1,1)+cy2*rz4
     & _356(mu)%b(2,1)
      clinetzz(i5,i6,mu)%c(iut,1)=cw1*rz4_356(mu)%d(1,1)+cw2*rz4
     & _356(mu)%c(2,1)
      clinetzz(i5,i6,mu)%d(iut,1)=cz1*rz4_356(mu)%d(1,1)+cz2*rz4
     & _356(mu)%c(2,1)
      clinetzz(i5,i6,mu)%a(iut,2)=cw1*rz4_356(mu)%b(1,2)+cw2*rz4
     & _356(mu)%a(2,2)
      clinetzz(i5,i6,mu)%b(iut,2)=cz1*rz4_356(mu)%b(1,2)+cz2*rz4
     & _356(mu)%a(2,2)
      clinetzz(i5,i6,mu)%c(iut,2)=cx1*rz4_356(mu)%c(1,2)+cx2*rz4
     & _356(mu)%d(2,2)
      clinetzz(i5,i6,mu)%d(iut,2)=cy1*rz4_356(mu)%c(1,2)+cy2*rz4
     & _356(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TTs -- aa=clinetzz(i5,i6,mu)%a,bb=clinetzz(i5,i6,mu)%b,cc=clinetzz(i5,
* i6,mu)%c,dd=clinetzz(i5,i6,mu)%d,a1=lz3_456(mu)%a,b1=lz3_456(mu)%b,c1=
* lz3_456(mu)%c,d1=lz3_456(mu)%d,a2=r4_56(i5,i6)%a,b2=r4_56(i5,i6)%b,c2=
* r4_56(i5,i6)%c,d2=r4_56(i5,i6)%d,prq=p456q,m=rmass(id3),nsum=1
      do jut=1,2
      cx1=r4_56(i5,i6)%a(1,jut)+rmass(id3)*r4_56(i5,i6)%b(1,jut)
      cx2=r4_56(i5,i6)%a(2,jut)+rmass(id3)*r4_56(i5,i6)%b(2,jut)
      cy1=p456q*r4_56(i5,i6)%b(1,jut)+rmass(id3)*r4_56(i5,i6)%a(
     & 1,jut)
      cy2=p456q*r4_56(i5,i6)%b(2,jut)+rmass(id3)*r4_56(i5,i6)%a(
     & 2,jut)
      cw1=r4_56(i5,i6)%c(1,jut)+rmass(id3)*r4_56(i5,i6)%d(1,jut)
      cw2=r4_56(i5,i6)%c(2,jut)+rmass(id3)*r4_56(i5,i6)%d(2,jut)
      cz1=p456q*r4_56(i5,i6)%d(1,jut)+rmass(id3)*r4_56(i5,i6)%c(
     & 1,jut)
      cz2=p456q*r4_56(i5,i6)%d(2,jut)+rmass(id3)*r4_56(i5,i6)%c(
     & 2,jut)
      clinetzz(i5,i6,mu)%a(1,jut)=clinetzz(i5,i6,mu)%a(1,jut)+lz
     & 3_456(mu)%a(1,1)*cx1+lz3_456(mu)%c(1,2)*cy2
      clinetzz(i5,i6,mu)%b(1,jut)=clinetzz(i5,i6,mu)%b(1,jut)+lz
     & 3_456(mu)%d(1,1)*cy1+lz3_456(mu)%b(1,2)*cx2
      clinetzz(i5,i6,mu)%c(1,jut)=clinetzz(i5,i6,mu)%c(1,jut)+lz
     & 3_456(mu)%a(1,1)*cw1+lz3_456(mu)%c(1,2)*cz2
      clinetzz(i5,i6,mu)%d(1,jut)=clinetzz(i5,i6,mu)%d(1,jut)+lz
     & 3_456(mu)%d(1,1)*cz1+lz3_456(mu)%b(1,2)*cw2
      clinetzz(i5,i6,mu)%a(2,jut)=clinetzz(i5,i6,mu)%a(2,jut)+lz
     & 3_456(mu)%c(2,1)*cy1+lz3_456(mu)%a(2,2)*cx2
      clinetzz(i5,i6,mu)%b(2,jut)=clinetzz(i5,i6,mu)%b(2,jut)+lz
     & 3_456(mu)%b(2,1)*cx1+lz3_456(mu)%d(2,2)*cy2
      clinetzz(i5,i6,mu)%c(2,jut)=clinetzz(i5,i6,mu)%c(2,jut)+lz
     & 3_456(mu)%c(2,1)*cz1+lz3_456(mu)%a(2,2)*cw2
      clinetzz(i5,i6,mu)%d(2,jut)=clinetzz(i5,i6,mu)%d(2,jut)+lz
     & 3_456(mu)%b(2,1)*cw1+lz3_456(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id3)
      rmassr=-rmass(id4)
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=cz3456(&1,&2,i3,i4,mu),abcd=clinetzz(i3,i4,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cz3456(iut,jut,i3,i4,mu)=clinetzz(i3,i4,mu)%a(iut,jut)+rma
     & ssl*clinetzz(i3,i4,mu)%b(iut,jut)+rmassr*clinetzz(i3,i4,m
     & u)%c(iut,jut)+rmassl*rmassr*clinetzz(i3,i4,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TsT -- aa=clinetzz(i3,i4,mu)%a,bb=clinetzz(i3,i4,mu)%b,cc=clinetzz(i3,
* i4,mu)%c,dd=clinetzz(i3,i4,mu)%d,a1=l5_34(i3,i4)%a,b1=l5_34(i3,i4)%b,c
* 1=l5_34(i3,i4)%c,d1=l5_34(i3,i4)%d,a2=rz6_534(mu)%a,b2=rz6_534(mu)%b,c
* 2=rz6_534(mu)%c,d2=rz6_534(mu)%d,prq=p534q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=l5_34(i3,i4)%a(iut,1)+l5_34(i3,i4)%c(iut,1)*rmass(id5)
      cx2=l5_34(i3,i4)%c(iut,2)*p534q+l5_34(i3,i4)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_34(i3,i4)%b(iut,1)+l5_34(i3,i4)%d(iut,1)*rmass(id5)
      cy2=l5_34(i3,i4)%d(iut,2)*p534q+l5_34(i3,i4)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_34(i3,i4)%c(iut,1)*p534q+l5_34(i3,i4)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_34(i3,i4)%a(iut,2)+l5_34(i3,i4)%c(iut,2)*rmass(id5)
      cz1=l5_34(i3,i4)%d(iut,1)*p534q+l5_34(i3,i4)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_34(i3,i4)%b(iut,2)+l5_34(i3,i4)%d(iut,2)*rmass(id5)
      clinetzz(i3,i4,mu)%a(iut,1)=cx1*rz6_534(mu)%a(1,1)+cx2*rz6
     & _534(mu)%b(2,1)
      clinetzz(i3,i4,mu)%b(iut,1)=cy1*rz6_534(mu)%a(1,1)+cy2*rz6
     & _534(mu)%b(2,1)
      clinetzz(i3,i4,mu)%c(iut,1)=cw1*rz6_534(mu)%d(1,1)+cw2*rz6
     & _534(mu)%c(2,1)
      clinetzz(i3,i4,mu)%d(iut,1)=cz1*rz6_534(mu)%d(1,1)+cz2*rz6
     & _534(mu)%c(2,1)
      clinetzz(i3,i4,mu)%a(iut,2)=cw1*rz6_534(mu)%b(1,2)+cw2*rz6
     & _534(mu)%a(2,2)
      clinetzz(i3,i4,mu)%b(iut,2)=cz1*rz6_534(mu)%b(1,2)+cz2*rz6
     & _534(mu)%a(2,2)
      clinetzz(i3,i4,mu)%c(iut,2)=cx1*rz6_534(mu)%c(1,2)+cx2*rz6
     & _534(mu)%d(2,2)
      clinetzz(i3,i4,mu)%d(iut,2)=cy1*rz6_534(mu)%c(1,2)+cy2*rz6
     & _534(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TTs -- aa=clinetzz(i3,i4,mu)%a,bb=clinetzz(i3,i4,mu)%b,cc=clinetzz(i3,
* i4,mu)%c,dd=clinetzz(i3,i4,mu)%d,a1=lz5_634(mu)%a,b1=lz5_634(mu)%b,c1=
* lz5_634(mu)%c,d1=lz5_634(mu)%d,a2=r6_34(i3,i4)%a,b2=r6_34(i3,i4)%b,c2=
* r6_34(i3,i4)%c,d2=r6_34(i3,i4)%d,prq=p634q,m=rmass(id5),nsum=1
      do jut=1,2
      cx1=r6_34(i3,i4)%a(1,jut)+rmass(id5)*r6_34(i3,i4)%b(1,jut)
      cx2=r6_34(i3,i4)%a(2,jut)+rmass(id5)*r6_34(i3,i4)%b(2,jut)
      cy1=p634q*r6_34(i3,i4)%b(1,jut)+rmass(id5)*r6_34(i3,i4)%a(
     & 1,jut)
      cy2=p634q*r6_34(i3,i4)%b(2,jut)+rmass(id5)*r6_34(i3,i4)%a(
     & 2,jut)
      cw1=r6_34(i3,i4)%c(1,jut)+rmass(id5)*r6_34(i3,i4)%d(1,jut)
      cw2=r6_34(i3,i4)%c(2,jut)+rmass(id5)*r6_34(i3,i4)%d(2,jut)
      cz1=p634q*r6_34(i3,i4)%d(1,jut)+rmass(id5)*r6_34(i3,i4)%c(
     & 1,jut)
      cz2=p634q*r6_34(i3,i4)%d(2,jut)+rmass(id5)*r6_34(i3,i4)%c(
     & 2,jut)
      clinetzz(i3,i4,mu)%a(1,jut)=clinetzz(i3,i4,mu)%a(1,jut)+lz
     & 5_634(mu)%a(1,1)*cx1+lz5_634(mu)%c(1,2)*cy2
      clinetzz(i3,i4,mu)%b(1,jut)=clinetzz(i3,i4,mu)%b(1,jut)+lz
     & 5_634(mu)%d(1,1)*cy1+lz5_634(mu)%b(1,2)*cx2
      clinetzz(i3,i4,mu)%c(1,jut)=clinetzz(i3,i4,mu)%c(1,jut)+lz
     & 5_634(mu)%a(1,1)*cw1+lz5_634(mu)%c(1,2)*cz2
      clinetzz(i3,i4,mu)%d(1,jut)=clinetzz(i3,i4,mu)%d(1,jut)+lz
     & 5_634(mu)%d(1,1)*cz1+lz5_634(mu)%b(1,2)*cw2
      clinetzz(i3,i4,mu)%a(2,jut)=clinetzz(i3,i4,mu)%a(2,jut)+lz
     & 5_634(mu)%c(2,1)*cy1+lz5_634(mu)%a(2,2)*cx2
      clinetzz(i3,i4,mu)%b(2,jut)=clinetzz(i3,i4,mu)%b(2,jut)+lz
     & 5_634(mu)%b(2,1)*cx1+lz5_634(mu)%d(2,2)*cy2
      clinetzz(i3,i4,mu)%c(2,jut)=clinetzz(i3,i4,mu)%c(2,jut)+lz
     & 5_634(mu)%c(2,1)*cz1+lz5_634(mu)%a(2,2)*cw2
      clinetzz(i3,i4,mu)%d(2,jut)=clinetzz(i3,i4,mu)%d(2,jut)+lz
     & 5_634(mu)%b(2,1)*cw1+lz5_634(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id5)
      rmassr=-rmass(id6)
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=cz3456(i1,i2,&1,&2,mu),abcd=clinetzz(i1,i2,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cz3456(i1,i2,iut,jut,mu)=cz3456(i1,i2,iut,jut,mu)+clinetzz
     & (i1,i2,mu)%a(iut,jut)+rmassl*clinetzz(i1,i2,mu)%b(iut,jut
     & )+rmassr*clinetzz(i1,i2,mu)%c(iut,jut)+rmassl*rmassr*clin
     & etzz(i1,i2,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
  
*    Then those of the type                                             
*                                                                       
*                 |_Z,f,h__/             (mu) _f__|                     
*       (mu) __f__|        \      and             |_Z,f,h__/            
*                 |                               |        \            
*                                                                       
**QCD                                                                   
*     and of the type                                                   
*                                                                       
*                 |_Z,f,h__/             (mu) ~~g~~|                    
*       (mu) ~~g~~|        \      and              |_Z,f,h__/           
*                 |                                |        \           
*                                                                       
* Use tts, tst because Z,f,h correspond to ts                           
*                                                                       
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do mu=0,3
                cf1234(i1,i2,i3,i4,mu)=czero
                cf5678(i1,i2,i3,i4,mu)=czero
                cf3456(i1,i2,i3,i4,mu)=czero
                cf1278(i1,i2,i3,i4,mu)=czero
                cf3478(i1,i2,i3,i4,mu)=czero
                cf1256(i1,i2,i3,i4,mu)=czero
                cg1234(i1,i2,i3,i4,mu)=czero
                cg3412(i1,i2,i3,i4,mu)=czero
                cg5678(i1,i2,i3,i4,mu)=czero
                cg7856(i1,i2,i3,i4,mu)=czero
                cg3456(i1,i2,i3,i4,mu)=czero
                cg5634(i1,i2,i3,i4,mu)=czero
                cg1278(i1,i2,i3,i4,mu)=czero
                cg7812(i1,i2,i3,i4,mu)=czero
                cg3478(i1,i2,i3,i4,mu)=czero
                cg7834(i1,i2,i3,i4,mu)=czero
                cg1256(i1,i2,i3,i4,mu)=czero
                cg5612(i1,i2,i3,i4,mu)=czero
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
  
      if(ineutri(id1).ne.1) then
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TsT -- aa=clinetfz(i3,i4,mu)%a,bb=clinetfz(i3,i4,mu)%b,cc=clinetfz(i3,
* i4,mu)%c,dd=clinetfz(i3,i4,mu)%d,a1=l1_34(i3,i4)%a,b1=l1_34(i3,i4)%b,c
* 1=l1_34(i3,i4)%c,d1=l1_34(i3,i4)%d,a2=rf2_134(mu)%a,b2=rf2_134(mu)%b,c
* 2=rf2_134(mu)%c,d2=rf2_134(mu)%d,prq=p134q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=l1_34(i3,i4)%a(iut,1)+l1_34(i3,i4)%c(iut,1)*rmass(id1)
      cx2=l1_34(i3,i4)%c(iut,2)*p134q+l1_34(i3,i4)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_34(i3,i4)%b(iut,1)+l1_34(i3,i4)%d(iut,1)*rmass(id1)
      cy2=l1_34(i3,i4)%d(iut,2)*p134q+l1_34(i3,i4)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_34(i3,i4)%c(iut,1)*p134q+l1_34(i3,i4)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_34(i3,i4)%a(iut,2)+l1_34(i3,i4)%c(iut,2)*rmass(id1)
      cz1=l1_34(i3,i4)%d(iut,1)*p134q+l1_34(i3,i4)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_34(i3,i4)%b(iut,2)+l1_34(i3,i4)%d(iut,2)*rmass(id1)
      clinetfz(i3,i4,mu)%a(iut,1)=cx1*rf2_134(mu)%a(1,1)+cx2*rf2
     & _134(mu)%b(2,1)
      clinetfz(i3,i4,mu)%b(iut,1)=cy1*rf2_134(mu)%a(1,1)+cy2*rf2
     & _134(mu)%b(2,1)
      clinetfz(i3,i4,mu)%c(iut,1)=cw1*rf2_134(mu)%d(1,1)+cw2*rf2
     & _134(mu)%c(2,1)
      clinetfz(i3,i4,mu)%d(iut,1)=cz1*rf2_134(mu)%d(1,1)+cz2*rf2
     & _134(mu)%c(2,1)
      clinetfz(i3,i4,mu)%a(iut,2)=cw1*rf2_134(mu)%b(1,2)+cw2*rf2
     & _134(mu)%a(2,2)
      clinetfz(i3,i4,mu)%b(iut,2)=cz1*rf2_134(mu)%b(1,2)+cz2*rf2
     & _134(mu)%a(2,2)
      clinetfz(i3,i4,mu)%c(iut,2)=cx1*rf2_134(mu)%c(1,2)+cx2*rf2
     & _134(mu)%d(2,2)
      clinetfz(i3,i4,mu)%d(iut,2)=cy1*rf2_134(mu)%c(1,2)+cy2*rf2
     & _134(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TTs -- aa=clinetfz(i3,i4,mu)%a,bb=clinetfz(i3,i4,mu)%b,cc=clinetfz(i3,
* i4,mu)%c,dd=clinetfz(i3,i4,mu)%d,a1=lf1_234(mu)%a,b1=lf1_234(mu)%b,c1=
* lf1_234(mu)%c,d1=lf1_234(mu)%d,a2=r2_34(i3,i4)%a,b2=r2_34(i3,i4)%b,c2=
* r2_34(i3,i4)%c,d2=r2_34(i3,i4)%d,prq=p234q,m=rmass(id1),nsum=1
      do jut=1,2
      cx1=r2_34(i3,i4)%a(1,jut)+rmass(id1)*r2_34(i3,i4)%b(1,jut)
      cx2=r2_34(i3,i4)%a(2,jut)+rmass(id1)*r2_34(i3,i4)%b(2,jut)
      cy1=p234q*r2_34(i3,i4)%b(1,jut)+rmass(id1)*r2_34(i3,i4)%a(
     & 1,jut)
      cy2=p234q*r2_34(i3,i4)%b(2,jut)+rmass(id1)*r2_34(i3,i4)%a(
     & 2,jut)
      cw1=r2_34(i3,i4)%c(1,jut)+rmass(id1)*r2_34(i3,i4)%d(1,jut)
      cw2=r2_34(i3,i4)%c(2,jut)+rmass(id1)*r2_34(i3,i4)%d(2,jut)
      cz1=p234q*r2_34(i3,i4)%d(1,jut)+rmass(id1)*r2_34(i3,i4)%c(
     & 1,jut)
      cz2=p234q*r2_34(i3,i4)%d(2,jut)+rmass(id1)*r2_34(i3,i4)%c(
     & 2,jut)
      clinetfz(i3,i4,mu)%a(1,jut)=clinetfz(i3,i4,mu)%a(1,jut)+lf
     & 1_234(mu)%a(1,1)*cx1+lf1_234(mu)%c(1,2)*cy2
      clinetfz(i3,i4,mu)%b(1,jut)=clinetfz(i3,i4,mu)%b(1,jut)+lf
     & 1_234(mu)%d(1,1)*cy1+lf1_234(mu)%b(1,2)*cx2
      clinetfz(i3,i4,mu)%c(1,jut)=clinetfz(i3,i4,mu)%c(1,jut)+lf
     & 1_234(mu)%a(1,1)*cw1+lf1_234(mu)%c(1,2)*cz2
      clinetfz(i3,i4,mu)%d(1,jut)=clinetfz(i3,i4,mu)%d(1,jut)+lf
     & 1_234(mu)%d(1,1)*cz1+lf1_234(mu)%b(1,2)*cw2
      clinetfz(i3,i4,mu)%a(2,jut)=clinetfz(i3,i4,mu)%a(2,jut)+lf
     & 1_234(mu)%c(2,1)*cy1+lf1_234(mu)%a(2,2)*cx2
      clinetfz(i3,i4,mu)%b(2,jut)=clinetfz(i3,i4,mu)%b(2,jut)+lf
     & 1_234(mu)%b(2,1)*cx1+lf1_234(mu)%d(2,2)*cy2
      clinetfz(i3,i4,mu)%c(2,jut)=clinetfz(i3,i4,mu)%c(2,jut)+lf
     & 1_234(mu)%c(2,1)*cz1+lf1_234(mu)%a(2,2)*cw2
      clinetfz(i3,i4,mu)%d(2,jut)=clinetfz(i3,i4,mu)%d(2,jut)+lf
     & 1_234(mu)%b(2,1)*cw1+lf1_234(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id1)
      rmassr=-rmass(id2)
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=cf1234(&1,&2,i3,i4,mu),abcd=clinetfz(i3,i4,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cf1234(iut,jut,i3,i4,mu)=clinetfz(i3,i4,mu)%a(iut,jut)+rma
     & ssl*clinetfz(i3,i4,mu)%b(iut,jut)+rmassr*clinetfz(i3,i4,m
     & u)%c(iut,jut)+rmassl*rmassr*clinetfz(i3,i4,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      if(ilept(id1).ne.1)then
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=cg1234(&1,&2,i3,i4,mu),abcd=clinetfz(i3,i4,mu)%,m1=rmassl
* ,m2=rmassr,den=fcl(id1),nsum=0
      do iut=1,2
      do jut=1,2
      cg1234(iut,jut,i3,i4,mu)=(clinetfz(i3,i4,mu)%a(iut,jut)+rm
     & assl*clinetfz(i3,i4,mu)%b(iut,jut)+rmassr*clinetfz(i3,i4,
     & mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i3,i4,mu)%d(iut,jut
     & ))/fcl(id1)
      enddo
      enddo
      end do
      end do
      end do
      endif
  
      endif
  
      if(ineutri(id3).ne.1) then
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TsT -- aa=clinetfz(i1,i2,mu)%a,bb=clinetfz(i1,i2,mu)%b,cc=clinetfz(i1,
* i2,mu)%c,dd=clinetfz(i1,i2,mu)%d,a1=l3_12(i1,i2)%a,b1=l3_12(i1,i2)%b,c
* 1=l3_12(i1,i2)%c,d1=l3_12(i1,i2)%d,a2=rf4_312(mu)%a,b2=rf4_312(mu)%b,c
* 2=rf4_312(mu)%c,d2=rf4_312(mu)%d,prq=p312q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=l3_12(i1,i2)%a(iut,1)+l3_12(i1,i2)%c(iut,1)*rmass(id3)
      cx2=l3_12(i1,i2)%c(iut,2)*p312q+l3_12(i1,i2)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_12(i1,i2)%b(iut,1)+l3_12(i1,i2)%d(iut,1)*rmass(id3)
      cy2=l3_12(i1,i2)%d(iut,2)*p312q+l3_12(i1,i2)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_12(i1,i2)%c(iut,1)*p312q+l3_12(i1,i2)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_12(i1,i2)%a(iut,2)+l3_12(i1,i2)%c(iut,2)*rmass(id3)
      cz1=l3_12(i1,i2)%d(iut,1)*p312q+l3_12(i1,i2)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_12(i1,i2)%b(iut,2)+l3_12(i1,i2)%d(iut,2)*rmass(id3)
      clinetfz(i1,i2,mu)%a(iut,1)=cx1*rf4_312(mu)%a(1,1)+cx2*rf4
     & _312(mu)%b(2,1)
      clinetfz(i1,i2,mu)%b(iut,1)=cy1*rf4_312(mu)%a(1,1)+cy2*rf4
     & _312(mu)%b(2,1)
      clinetfz(i1,i2,mu)%c(iut,1)=cw1*rf4_312(mu)%d(1,1)+cw2*rf4
     & _312(mu)%c(2,1)
      clinetfz(i1,i2,mu)%d(iut,1)=cz1*rf4_312(mu)%d(1,1)+cz2*rf4
     & _312(mu)%c(2,1)
      clinetfz(i1,i2,mu)%a(iut,2)=cw1*rf4_312(mu)%b(1,2)+cw2*rf4
     & _312(mu)%a(2,2)
      clinetfz(i1,i2,mu)%b(iut,2)=cz1*rf4_312(mu)%b(1,2)+cz2*rf4
     & _312(mu)%a(2,2)
      clinetfz(i1,i2,mu)%c(iut,2)=cx1*rf4_312(mu)%c(1,2)+cx2*rf4
     & _312(mu)%d(2,2)
      clinetfz(i1,i2,mu)%d(iut,2)=cy1*rf4_312(mu)%c(1,2)+cy2*rf4
     & _312(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TTs -- aa=clinetfz(i1,i2,mu)%a,bb=clinetfz(i1,i2,mu)%b,cc=clinetfz(i1,
* i2,mu)%c,dd=clinetfz(i1,i2,mu)%d,a1=lf3_412(mu)%a,b1=lf3_412(mu)%b,c1=
* lf3_412(mu)%c,d1=lf3_412(mu)%d,a2=r4_12(i1,i2)%a,b2=r4_12(i1,i2)%b,c2=
* r4_12(i1,i2)%c,d2=r4_12(i1,i2)%d,prq=p412q,m=rmass(id3),nsum=1
      do jut=1,2
      cx1=r4_12(i1,i2)%a(1,jut)+rmass(id3)*r4_12(i1,i2)%b(1,jut)
      cx2=r4_12(i1,i2)%a(2,jut)+rmass(id3)*r4_12(i1,i2)%b(2,jut)
      cy1=p412q*r4_12(i1,i2)%b(1,jut)+rmass(id3)*r4_12(i1,i2)%a(
     & 1,jut)
      cy2=p412q*r4_12(i1,i2)%b(2,jut)+rmass(id3)*r4_12(i1,i2)%a(
     & 2,jut)
      cw1=r4_12(i1,i2)%c(1,jut)+rmass(id3)*r4_12(i1,i2)%d(1,jut)
      cw2=r4_12(i1,i2)%c(2,jut)+rmass(id3)*r4_12(i1,i2)%d(2,jut)
      cz1=p412q*r4_12(i1,i2)%d(1,jut)+rmass(id3)*r4_12(i1,i2)%c(
     & 1,jut)
      cz2=p412q*r4_12(i1,i2)%d(2,jut)+rmass(id3)*r4_12(i1,i2)%c(
     & 2,jut)
      clinetfz(i1,i2,mu)%a(1,jut)=clinetfz(i1,i2,mu)%a(1,jut)+lf
     & 3_412(mu)%a(1,1)*cx1+lf3_412(mu)%c(1,2)*cy2
      clinetfz(i1,i2,mu)%b(1,jut)=clinetfz(i1,i2,mu)%b(1,jut)+lf
     & 3_412(mu)%d(1,1)*cy1+lf3_412(mu)%b(1,2)*cx2
      clinetfz(i1,i2,mu)%c(1,jut)=clinetfz(i1,i2,mu)%c(1,jut)+lf
     & 3_412(mu)%a(1,1)*cw1+lf3_412(mu)%c(1,2)*cz2
      clinetfz(i1,i2,mu)%d(1,jut)=clinetfz(i1,i2,mu)%d(1,jut)+lf
     & 3_412(mu)%d(1,1)*cz1+lf3_412(mu)%b(1,2)*cw2
      clinetfz(i1,i2,mu)%a(2,jut)=clinetfz(i1,i2,mu)%a(2,jut)+lf
     & 3_412(mu)%c(2,1)*cy1+lf3_412(mu)%a(2,2)*cx2
      clinetfz(i1,i2,mu)%b(2,jut)=clinetfz(i1,i2,mu)%b(2,jut)+lf
     & 3_412(mu)%b(2,1)*cx1+lf3_412(mu)%d(2,2)*cy2
      clinetfz(i1,i2,mu)%c(2,jut)=clinetfz(i1,i2,mu)%c(2,jut)+lf
     & 3_412(mu)%c(2,1)*cz1+lf3_412(mu)%a(2,2)*cw2
      clinetfz(i1,i2,mu)%d(2,jut)=clinetfz(i1,i2,mu)%d(2,jut)+lf
     & 3_412(mu)%b(2,1)*cw1+lf3_412(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id3)
      rmassr=-rmass(id4)
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=cf1234(i1,i2,&1,&2,mu),abcd=clinetfz(i1,i2,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cf1234(i1,i2,iut,jut,mu)=cf1234(i1,i2,iut,jut,mu)+clinetfz
     & (i1,i2,mu)%a(iut,jut)+rmassl*clinetfz(i1,i2,mu)%b(iut,jut
     & )+rmassr*clinetfz(i1,i2,mu)%c(iut,jut)+rmassl*rmassr*clin
     & etfz(i1,i2,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
      if(ilept(id3).ne.1)then
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=cg3412(&1,&2,i1,i2,mu),abcd=clinetfz(i1,i2,mu)%,m1=rmassl
* ,m2=rmassr,den=fcl(id3),nsum=0
      do iut=1,2
      do jut=1,2
      cg3412(iut,jut,i1,i2,mu)=(clinetfz(i1,i2,mu)%a(iut,jut)+rm
     & assl*clinetfz(i1,i2,mu)%b(iut,jut)+rmassr*clinetfz(i1,i2,
     & mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i1,i2,mu)%d(iut,jut
     & ))/fcl(id3)
      enddo
      enddo
      end do
      end do
      end do
      endif
  
      endif
  
      if(ineutri(id5).ne.1) then
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TsT -- aa=clinetfz(i7,i8,mu)%a,bb=clinetfz(i7,i8,mu)%b,cc=clinetfz(i7,
* i8,mu)%c,dd=clinetfz(i7,i8,mu)%d,a1=l5_78(i7,i8)%a,b1=l5_78(i7,i8)%b,c
* 1=l5_78(i7,i8)%c,d1=l5_78(i7,i8)%d,a2=rf6_578(mu)%a,b2=rf6_578(mu)%b,c
* 2=rf6_578(mu)%c,d2=rf6_578(mu)%d,prq=p578q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=l5_78(i7,i8)%a(iut,1)+l5_78(i7,i8)%c(iut,1)*rmass(id5)
      cx2=l5_78(i7,i8)%c(iut,2)*p578q+l5_78(i7,i8)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_78(i7,i8)%b(iut,1)+l5_78(i7,i8)%d(iut,1)*rmass(id5)
      cy2=l5_78(i7,i8)%d(iut,2)*p578q+l5_78(i7,i8)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_78(i7,i8)%c(iut,1)*p578q+l5_78(i7,i8)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_78(i7,i8)%a(iut,2)+l5_78(i7,i8)%c(iut,2)*rmass(id5)
      cz1=l5_78(i7,i8)%d(iut,1)*p578q+l5_78(i7,i8)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_78(i7,i8)%b(iut,2)+l5_78(i7,i8)%d(iut,2)*rmass(id5)
      clinetfz(i7,i8,mu)%a(iut,1)=cx1*rf6_578(mu)%a(1,1)+cx2*rf6
     & _578(mu)%b(2,1)
      clinetfz(i7,i8,mu)%b(iut,1)=cy1*rf6_578(mu)%a(1,1)+cy2*rf6
     & _578(mu)%b(2,1)
      clinetfz(i7,i8,mu)%c(iut,1)=cw1*rf6_578(mu)%d(1,1)+cw2*rf6
     & _578(mu)%c(2,1)
      clinetfz(i7,i8,mu)%d(iut,1)=cz1*rf6_578(mu)%d(1,1)+cz2*rf6
     & _578(mu)%c(2,1)
      clinetfz(i7,i8,mu)%a(iut,2)=cw1*rf6_578(mu)%b(1,2)+cw2*rf6
     & _578(mu)%a(2,2)
      clinetfz(i7,i8,mu)%b(iut,2)=cz1*rf6_578(mu)%b(1,2)+cz2*rf6
     & _578(mu)%a(2,2)
      clinetfz(i7,i8,mu)%c(iut,2)=cx1*rf6_578(mu)%c(1,2)+cx2*rf6
     & _578(mu)%d(2,2)
      clinetfz(i7,i8,mu)%d(iut,2)=cy1*rf6_578(mu)%c(1,2)+cy2*rf6
     & _578(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TTs -- aa=clinetfz(i7,i8,mu)%a,bb=clinetfz(i7,i8,mu)%b,cc=clinetfz(i7,
* i8,mu)%c,dd=clinetfz(i7,i8,mu)%d,a1=lf5_678(mu)%a,b1=lf5_678(mu)%b,c1=
* lf5_678(mu)%c,d1=lf5_678(mu)%d,a2=r6_78(i7,i8)%a,b2=r6_78(i7,i8)%b,c2=
* r6_78(i7,i8)%c,d2=r6_78(i7,i8)%d,prq=p678q,m=rmass(id5),nsum=1
      do jut=1,2
      cx1=r6_78(i7,i8)%a(1,jut)+rmass(id5)*r6_78(i7,i8)%b(1,jut)
      cx2=r6_78(i7,i8)%a(2,jut)+rmass(id5)*r6_78(i7,i8)%b(2,jut)
      cy1=p678q*r6_78(i7,i8)%b(1,jut)+rmass(id5)*r6_78(i7,i8)%a(
     & 1,jut)
      cy2=p678q*r6_78(i7,i8)%b(2,jut)+rmass(id5)*r6_78(i7,i8)%a(
     & 2,jut)
      cw1=r6_78(i7,i8)%c(1,jut)+rmass(id5)*r6_78(i7,i8)%d(1,jut)
      cw2=r6_78(i7,i8)%c(2,jut)+rmass(id5)*r6_78(i7,i8)%d(2,jut)
      cz1=p678q*r6_78(i7,i8)%d(1,jut)+rmass(id5)*r6_78(i7,i8)%c(
     & 1,jut)
      cz2=p678q*r6_78(i7,i8)%d(2,jut)+rmass(id5)*r6_78(i7,i8)%c(
     & 2,jut)
      clinetfz(i7,i8,mu)%a(1,jut)=clinetfz(i7,i8,mu)%a(1,jut)+lf
     & 5_678(mu)%a(1,1)*cx1+lf5_678(mu)%c(1,2)*cy2
      clinetfz(i7,i8,mu)%b(1,jut)=clinetfz(i7,i8,mu)%b(1,jut)+lf
     & 5_678(mu)%d(1,1)*cy1+lf5_678(mu)%b(1,2)*cx2
      clinetfz(i7,i8,mu)%c(1,jut)=clinetfz(i7,i8,mu)%c(1,jut)+lf
     & 5_678(mu)%a(1,1)*cw1+lf5_678(mu)%c(1,2)*cz2
      clinetfz(i7,i8,mu)%d(1,jut)=clinetfz(i7,i8,mu)%d(1,jut)+lf
     & 5_678(mu)%d(1,1)*cz1+lf5_678(mu)%b(1,2)*cw2
      clinetfz(i7,i8,mu)%a(2,jut)=clinetfz(i7,i8,mu)%a(2,jut)+lf
     & 5_678(mu)%c(2,1)*cy1+lf5_678(mu)%a(2,2)*cx2
      clinetfz(i7,i8,mu)%b(2,jut)=clinetfz(i7,i8,mu)%b(2,jut)+lf
     & 5_678(mu)%b(2,1)*cx1+lf5_678(mu)%d(2,2)*cy2
      clinetfz(i7,i8,mu)%c(2,jut)=clinetfz(i7,i8,mu)%c(2,jut)+lf
     & 5_678(mu)%c(2,1)*cz1+lf5_678(mu)%a(2,2)*cw2
      clinetfz(i7,i8,mu)%d(2,jut)=clinetfz(i7,i8,mu)%d(2,jut)+lf
     & 5_678(mu)%b(2,1)*cw1+lf5_678(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id5)
      rmassr=-rmass(id6)
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* mline -- res=cf5678(&1,&2,i7,i8,mu),abcd=clinetfz(i7,i8,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cf5678(iut,jut,i7,i8,mu)=clinetfz(i7,i8,mu)%a(iut,jut)+rma
     & ssl*clinetfz(i7,i8,mu)%b(iut,jut)+rmassr*clinetfz(i7,i8,m
     & u)%c(iut,jut)+rmassl*rmassr*clinetfz(i7,i8,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      if(ilept(id5).ne.1)then
      do i7=1,2
      do i8=1,2
      do mu=0,3
* mline -- res=cg5678(&1,&2,i7,i8,mu),abcd=clinetfz(i7,i8,mu)%,m1=rmassl
* ,m2=rmassr,den=fcl(id5),nsum=0
      do iut=1,2
      do jut=1,2
      cg5678(iut,jut,i7,i8,mu)=(clinetfz(i7,i8,mu)%a(iut,jut)+rm
     & assl*clinetfz(i7,i8,mu)%b(iut,jut)+rmassr*clinetfz(i7,i8,
     & mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i7,i8,mu)%d(iut,jut
     & ))/fcl(id5)
      enddo
      enddo
      end do
      end do
      end do
      endif
  
      endif
  
      if(ineutri(id7).ne.1) then
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TsT -- aa=clinetfz(i5,i6,mu)%a,bb=clinetfz(i5,i6,mu)%b,cc=clinetfz(i5,
* i6,mu)%c,dd=clinetfz(i5,i6,mu)%d,a1=l7_56(i5,i6)%a,b1=l7_56(i5,i6)%b,c
* 1=l7_56(i5,i6)%c,d1=l7_56(i5,i6)%d,a2=rf8_756(mu)%a,b2=rf8_756(mu)%b,c
* 2=rf8_756(mu)%c,d2=rf8_756(mu)%d,prq=p756q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=l7_56(i5,i6)%a(iut,1)+l7_56(i5,i6)%c(iut,1)*rmass(id7)
      cx2=l7_56(i5,i6)%c(iut,2)*p756q+l7_56(i5,i6)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_56(i5,i6)%b(iut,1)+l7_56(i5,i6)%d(iut,1)*rmass(id7)
      cy2=l7_56(i5,i6)%d(iut,2)*p756q+l7_56(i5,i6)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_56(i5,i6)%c(iut,1)*p756q+l7_56(i5,i6)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_56(i5,i6)%a(iut,2)+l7_56(i5,i6)%c(iut,2)*rmass(id7)
      cz1=l7_56(i5,i6)%d(iut,1)*p756q+l7_56(i5,i6)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_56(i5,i6)%b(iut,2)+l7_56(i5,i6)%d(iut,2)*rmass(id7)
      clinetfz(i5,i6,mu)%a(iut,1)=cx1*rf8_756(mu)%a(1,1)+cx2*rf8
     & _756(mu)%b(2,1)
      clinetfz(i5,i6,mu)%b(iut,1)=cy1*rf8_756(mu)%a(1,1)+cy2*rf8
     & _756(mu)%b(2,1)
      clinetfz(i5,i6,mu)%c(iut,1)=cw1*rf8_756(mu)%d(1,1)+cw2*rf8
     & _756(mu)%c(2,1)
      clinetfz(i5,i6,mu)%d(iut,1)=cz1*rf8_756(mu)%d(1,1)+cz2*rf8
     & _756(mu)%c(2,1)
      clinetfz(i5,i6,mu)%a(iut,2)=cw1*rf8_756(mu)%b(1,2)+cw2*rf8
     & _756(mu)%a(2,2)
      clinetfz(i5,i6,mu)%b(iut,2)=cz1*rf8_756(mu)%b(1,2)+cz2*rf8
     & _756(mu)%a(2,2)
      clinetfz(i5,i6,mu)%c(iut,2)=cx1*rf8_756(mu)%c(1,2)+cx2*rf8
     & _756(mu)%d(2,2)
      clinetfz(i5,i6,mu)%d(iut,2)=cy1*rf8_756(mu)%c(1,2)+cy2*rf8
     & _756(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TTs -- aa=clinetfz(i5,i6,mu)%a,bb=clinetfz(i5,i6,mu)%b,cc=clinetfz(i5,
* i6,mu)%c,dd=clinetfz(i5,i6,mu)%d,a1=lf7_856(mu)%a,b1=lf7_856(mu)%b,c1=
* lf7_856(mu)%c,d1=lf7_856(mu)%d,a2=r8_56(i5,i6)%a,b2=r8_56(i5,i6)%b,c2=
* r8_56(i5,i6)%c,d2=r8_56(i5,i6)%d,prq=p856q,m=rmass(id7),nsum=1
      do jut=1,2
      cx1=r8_56(i5,i6)%a(1,jut)+rmass(id7)*r8_56(i5,i6)%b(1,jut)
      cx2=r8_56(i5,i6)%a(2,jut)+rmass(id7)*r8_56(i5,i6)%b(2,jut)
      cy1=p856q*r8_56(i5,i6)%b(1,jut)+rmass(id7)*r8_56(i5,i6)%a(
     & 1,jut)
      cy2=p856q*r8_56(i5,i6)%b(2,jut)+rmass(id7)*r8_56(i5,i6)%a(
     & 2,jut)
      cw1=r8_56(i5,i6)%c(1,jut)+rmass(id7)*r8_56(i5,i6)%d(1,jut)
      cw2=r8_56(i5,i6)%c(2,jut)+rmass(id7)*r8_56(i5,i6)%d(2,jut)
      cz1=p856q*r8_56(i5,i6)%d(1,jut)+rmass(id7)*r8_56(i5,i6)%c(
     & 1,jut)
      cz2=p856q*r8_56(i5,i6)%d(2,jut)+rmass(id7)*r8_56(i5,i6)%c(
     & 2,jut)
      clinetfz(i5,i6,mu)%a(1,jut)=clinetfz(i5,i6,mu)%a(1,jut)+lf
     & 7_856(mu)%a(1,1)*cx1+lf7_856(mu)%c(1,2)*cy2
      clinetfz(i5,i6,mu)%b(1,jut)=clinetfz(i5,i6,mu)%b(1,jut)+lf
     & 7_856(mu)%d(1,1)*cy1+lf7_856(mu)%b(1,2)*cx2
      clinetfz(i5,i6,mu)%c(1,jut)=clinetfz(i5,i6,mu)%c(1,jut)+lf
     & 7_856(mu)%a(1,1)*cw1+lf7_856(mu)%c(1,2)*cz2
      clinetfz(i5,i6,mu)%d(1,jut)=clinetfz(i5,i6,mu)%d(1,jut)+lf
     & 7_856(mu)%d(1,1)*cz1+lf7_856(mu)%b(1,2)*cw2
      clinetfz(i5,i6,mu)%a(2,jut)=clinetfz(i5,i6,mu)%a(2,jut)+lf
     & 7_856(mu)%c(2,1)*cy1+lf7_856(mu)%a(2,2)*cx2
      clinetfz(i5,i6,mu)%b(2,jut)=clinetfz(i5,i6,mu)%b(2,jut)+lf
     & 7_856(mu)%b(2,1)*cx1+lf7_856(mu)%d(2,2)*cy2
      clinetfz(i5,i6,mu)%c(2,jut)=clinetfz(i5,i6,mu)%c(2,jut)+lf
     & 7_856(mu)%c(2,1)*cz1+lf7_856(mu)%a(2,2)*cw2
      clinetfz(i5,i6,mu)%d(2,jut)=clinetfz(i5,i6,mu)%d(2,jut)+lf
     & 7_856(mu)%b(2,1)*cw1+lf7_856(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id7)
      rmassr=-rmass(id8)
  
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* mline -- res=cf5678(i5,i6,&1,&2,mu),abcd=clinetfz(i5,i6,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cf5678(i5,i6,iut,jut,mu)=cf5678(i5,i6,iut,jut,mu)+clinetfz
     & (i5,i6,mu)%a(iut,jut)+rmassl*clinetfz(i5,i6,mu)%b(iut,jut
     & )+rmassr*clinetfz(i5,i6,mu)%c(iut,jut)+rmassl*rmassr*clin
     & etfz(i5,i6,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
      if(ilept(id7).ne.1)then
      do i5=1,2
      do i6=1,2
      do mu=0,3
* mline -- res=cg7856(&1,&2,i5,i6,mu),abcd=clinetfz(i5,i6,mu)%,m1=rmassl
* ,m2=rmassr,den=fcl(id7),nsum=0
      do iut=1,2
      do jut=1,2
      cg7856(iut,jut,i5,i6,mu)=(clinetfz(i5,i6,mu)%a(iut,jut)+rm
     & assl*clinetfz(i5,i6,mu)%b(iut,jut)+rmassr*clinetfz(i5,i6,
     & mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i5,i6,mu)%d(iut,jut
     & ))/fcl(id7)
      enddo
      enddo
      end do
      end do
      end do
      endif
  
      endif
  
      if(ineutri(id1).ne.1) then
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TsT -- aa=clinetfz(i5,i6,mu)%a,bb=clinetfz(i5,i6,mu)%b,cc=clinetfz(i5,
* i6,mu)%c,dd=clinetfz(i5,i6,mu)%d,a1=l1_56(i5,i6)%a,b1=l1_56(i5,i6)%b,c
* 1=l1_56(i5,i6)%c,d1=l1_56(i5,i6)%d,a2=rf2_156(mu)%a,b2=rf2_156(mu)%b,c
* 2=rf2_156(mu)%c,d2=rf2_156(mu)%d,prq=p156q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=l1_56(i5,i6)%a(iut,1)+l1_56(i5,i6)%c(iut,1)*rmass(id1)
      cx2=l1_56(i5,i6)%c(iut,2)*p156q+l1_56(i5,i6)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_56(i5,i6)%b(iut,1)+l1_56(i5,i6)%d(iut,1)*rmass(id1)
      cy2=l1_56(i5,i6)%d(iut,2)*p156q+l1_56(i5,i6)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_56(i5,i6)%c(iut,1)*p156q+l1_56(i5,i6)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_56(i5,i6)%a(iut,2)+l1_56(i5,i6)%c(iut,2)*rmass(id1)
      cz1=l1_56(i5,i6)%d(iut,1)*p156q+l1_56(i5,i6)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_56(i5,i6)%b(iut,2)+l1_56(i5,i6)%d(iut,2)*rmass(id1)
      clinetfz(i5,i6,mu)%a(iut,1)=cx1*rf2_156(mu)%a(1,1)+cx2*rf2
     & _156(mu)%b(2,1)
      clinetfz(i5,i6,mu)%b(iut,1)=cy1*rf2_156(mu)%a(1,1)+cy2*rf2
     & _156(mu)%b(2,1)
      clinetfz(i5,i6,mu)%c(iut,1)=cw1*rf2_156(mu)%d(1,1)+cw2*rf2
     & _156(mu)%c(2,1)
      clinetfz(i5,i6,mu)%d(iut,1)=cz1*rf2_156(mu)%d(1,1)+cz2*rf2
     & _156(mu)%c(2,1)
      clinetfz(i5,i6,mu)%a(iut,2)=cw1*rf2_156(mu)%b(1,2)+cw2*rf2
     & _156(mu)%a(2,2)
      clinetfz(i5,i6,mu)%b(iut,2)=cz1*rf2_156(mu)%b(1,2)+cz2*rf2
     & _156(mu)%a(2,2)
      clinetfz(i5,i6,mu)%c(iut,2)=cx1*rf2_156(mu)%c(1,2)+cx2*rf2
     & _156(mu)%d(2,2)
      clinetfz(i5,i6,mu)%d(iut,2)=cy1*rf2_156(mu)%c(1,2)+cy2*rf2
     & _156(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TTs -- aa=clinetfz(i5,i6,mu)%a,bb=clinetfz(i5,i6,mu)%b,cc=clinetfz(i5,
* i6,mu)%c,dd=clinetfz(i5,i6,mu)%d,a1=lf1_256(mu)%a,b1=lf1_256(mu)%b,c1=
* lf1_256(mu)%c,d1=lf1_256(mu)%d,a2=r2_56(i5,i6)%a,b2=r2_56(i5,i6)%b,c2=
* r2_56(i5,i6)%c,d2=r2_56(i5,i6)%d,prq=p256q,m=rmass(id1),nsum=1
      do jut=1,2
      cx1=r2_56(i5,i6)%a(1,jut)+rmass(id1)*r2_56(i5,i6)%b(1,jut)
      cx2=r2_56(i5,i6)%a(2,jut)+rmass(id1)*r2_56(i5,i6)%b(2,jut)
      cy1=p256q*r2_56(i5,i6)%b(1,jut)+rmass(id1)*r2_56(i5,i6)%a(
     & 1,jut)
      cy2=p256q*r2_56(i5,i6)%b(2,jut)+rmass(id1)*r2_56(i5,i6)%a(
     & 2,jut)
      cw1=r2_56(i5,i6)%c(1,jut)+rmass(id1)*r2_56(i5,i6)%d(1,jut)
      cw2=r2_56(i5,i6)%c(2,jut)+rmass(id1)*r2_56(i5,i6)%d(2,jut)
      cz1=p256q*r2_56(i5,i6)%d(1,jut)+rmass(id1)*r2_56(i5,i6)%c(
     & 1,jut)
      cz2=p256q*r2_56(i5,i6)%d(2,jut)+rmass(id1)*r2_56(i5,i6)%c(
     & 2,jut)
      clinetfz(i5,i6,mu)%a(1,jut)=clinetfz(i5,i6,mu)%a(1,jut)+lf
     & 1_256(mu)%a(1,1)*cx1+lf1_256(mu)%c(1,2)*cy2
      clinetfz(i5,i6,mu)%b(1,jut)=clinetfz(i5,i6,mu)%b(1,jut)+lf
     & 1_256(mu)%d(1,1)*cy1+lf1_256(mu)%b(1,2)*cx2
      clinetfz(i5,i6,mu)%c(1,jut)=clinetfz(i5,i6,mu)%c(1,jut)+lf
     & 1_256(mu)%a(1,1)*cw1+lf1_256(mu)%c(1,2)*cz2
      clinetfz(i5,i6,mu)%d(1,jut)=clinetfz(i5,i6,mu)%d(1,jut)+lf
     & 1_256(mu)%d(1,1)*cz1+lf1_256(mu)%b(1,2)*cw2
      clinetfz(i5,i6,mu)%a(2,jut)=clinetfz(i5,i6,mu)%a(2,jut)+lf
     & 1_256(mu)%c(2,1)*cy1+lf1_256(mu)%a(2,2)*cx2
      clinetfz(i5,i6,mu)%b(2,jut)=clinetfz(i5,i6,mu)%b(2,jut)+lf
     & 1_256(mu)%b(2,1)*cx1+lf1_256(mu)%d(2,2)*cy2
      clinetfz(i5,i6,mu)%c(2,jut)=clinetfz(i5,i6,mu)%c(2,jut)+lf
     & 1_256(mu)%c(2,1)*cz1+lf1_256(mu)%a(2,2)*cw2
      clinetfz(i5,i6,mu)%d(2,jut)=clinetfz(i5,i6,mu)%d(2,jut)+lf
     & 1_256(mu)%b(2,1)*cw1+lf1_256(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id1)
      rmassr=-rmass(id2)
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* mline -- res=cf1256(&1,&2,i5,i6,mu),abcd=clinetfz(i5,i6,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cf1256(iut,jut,i5,i6,mu)=clinetfz(i5,i6,mu)%a(iut,jut)+rma
     & ssl*clinetfz(i5,i6,mu)%b(iut,jut)+rmassr*clinetfz(i5,i6,m
     & u)%c(iut,jut)+rmassl*rmassr*clinetfz(i5,i6,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      if(ilept(id1).ne.1)then
      do i5=1,2
      do i6=1,2
      do mu=0,3
* mline -- res=cg1256(&1,&2,i5,i6,mu),abcd=clinetfz(i5,i6,mu)%,m1=rmassl
* ,m2=rmassr,den=fcl(id1),nsum=0
      do iut=1,2
      do jut=1,2
      cg1256(iut,jut,i5,i6,mu)=(clinetfz(i5,i6,mu)%a(iut,jut)+rm
     & assl*clinetfz(i5,i6,mu)%b(iut,jut)+rmassr*clinetfz(i5,i6,
     & mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i5,i6,mu)%d(iut,jut
     & ))/fcl(id1)
      enddo
      enddo
      end do
      end do
      end do
      endif
  
      endif
  
      if(ineutri(id5).ne.1) then
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TsT -- aa=clinetfz(i1,i2,mu)%a,bb=clinetfz(i1,i2,mu)%b,cc=clinetfz(i1,
* i2,mu)%c,dd=clinetfz(i1,i2,mu)%d,a1=l5_12(i1,i2)%a,b1=l5_12(i1,i2)%b,c
* 1=l5_12(i1,i2)%c,d1=l5_12(i1,i2)%d,a2=rf6_512(mu)%a,b2=rf6_512(mu)%b,c
* 2=rf6_512(mu)%c,d2=rf6_512(mu)%d,prq=p512q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=l5_12(i1,i2)%a(iut,1)+l5_12(i1,i2)%c(iut,1)*rmass(id5)
      cx2=l5_12(i1,i2)%c(iut,2)*p512q+l5_12(i1,i2)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_12(i1,i2)%b(iut,1)+l5_12(i1,i2)%d(iut,1)*rmass(id5)
      cy2=l5_12(i1,i2)%d(iut,2)*p512q+l5_12(i1,i2)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_12(i1,i2)%c(iut,1)*p512q+l5_12(i1,i2)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_12(i1,i2)%a(iut,2)+l5_12(i1,i2)%c(iut,2)*rmass(id5)
      cz1=l5_12(i1,i2)%d(iut,1)*p512q+l5_12(i1,i2)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_12(i1,i2)%b(iut,2)+l5_12(i1,i2)%d(iut,2)*rmass(id5)
      clinetfz(i1,i2,mu)%a(iut,1)=cx1*rf6_512(mu)%a(1,1)+cx2*rf6
     & _512(mu)%b(2,1)
      clinetfz(i1,i2,mu)%b(iut,1)=cy1*rf6_512(mu)%a(1,1)+cy2*rf6
     & _512(mu)%b(2,1)
      clinetfz(i1,i2,mu)%c(iut,1)=cw1*rf6_512(mu)%d(1,1)+cw2*rf6
     & _512(mu)%c(2,1)
      clinetfz(i1,i2,mu)%d(iut,1)=cz1*rf6_512(mu)%d(1,1)+cz2*rf6
     & _512(mu)%c(2,1)
      clinetfz(i1,i2,mu)%a(iut,2)=cw1*rf6_512(mu)%b(1,2)+cw2*rf6
     & _512(mu)%a(2,2)
      clinetfz(i1,i2,mu)%b(iut,2)=cz1*rf6_512(mu)%b(1,2)+cz2*rf6
     & _512(mu)%a(2,2)
      clinetfz(i1,i2,mu)%c(iut,2)=cx1*rf6_512(mu)%c(1,2)+cx2*rf6
     & _512(mu)%d(2,2)
      clinetfz(i1,i2,mu)%d(iut,2)=cy1*rf6_512(mu)%c(1,2)+cy2*rf6
     & _512(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TTs -- aa=clinetfz(i1,i2,mu)%a,bb=clinetfz(i1,i2,mu)%b,cc=clinetfz(i1,
* i2,mu)%c,dd=clinetfz(i1,i2,mu)%d,a1=lf5_612(mu)%a,b1=lf5_612(mu)%b,c1=
* lf5_612(mu)%c,d1=lf5_612(mu)%d,a2=r6_12(i1,i2)%a,b2=r6_12(i1,i2)%b,c2=
* r6_12(i1,i2)%c,d2=r6_12(i1,i2)%d,prq=p612q,m=rmass(id5),nsum=1
      do jut=1,2
      cx1=r6_12(i1,i2)%a(1,jut)+rmass(id5)*r6_12(i1,i2)%b(1,jut)
      cx2=r6_12(i1,i2)%a(2,jut)+rmass(id5)*r6_12(i1,i2)%b(2,jut)
      cy1=p612q*r6_12(i1,i2)%b(1,jut)+rmass(id5)*r6_12(i1,i2)%a(
     & 1,jut)
      cy2=p612q*r6_12(i1,i2)%b(2,jut)+rmass(id5)*r6_12(i1,i2)%a(
     & 2,jut)
      cw1=r6_12(i1,i2)%c(1,jut)+rmass(id5)*r6_12(i1,i2)%d(1,jut)
      cw2=r6_12(i1,i2)%c(2,jut)+rmass(id5)*r6_12(i1,i2)%d(2,jut)
      cz1=p612q*r6_12(i1,i2)%d(1,jut)+rmass(id5)*r6_12(i1,i2)%c(
     & 1,jut)
      cz2=p612q*r6_12(i1,i2)%d(2,jut)+rmass(id5)*r6_12(i1,i2)%c(
     & 2,jut)
      clinetfz(i1,i2,mu)%a(1,jut)=clinetfz(i1,i2,mu)%a(1,jut)+lf
     & 5_612(mu)%a(1,1)*cx1+lf5_612(mu)%c(1,2)*cy2
      clinetfz(i1,i2,mu)%b(1,jut)=clinetfz(i1,i2,mu)%b(1,jut)+lf
     & 5_612(mu)%d(1,1)*cy1+lf5_612(mu)%b(1,2)*cx2
      clinetfz(i1,i2,mu)%c(1,jut)=clinetfz(i1,i2,mu)%c(1,jut)+lf
     & 5_612(mu)%a(1,1)*cw1+lf5_612(mu)%c(1,2)*cz2
      clinetfz(i1,i2,mu)%d(1,jut)=clinetfz(i1,i2,mu)%d(1,jut)+lf
     & 5_612(mu)%d(1,1)*cz1+lf5_612(mu)%b(1,2)*cw2
      clinetfz(i1,i2,mu)%a(2,jut)=clinetfz(i1,i2,mu)%a(2,jut)+lf
     & 5_612(mu)%c(2,1)*cy1+lf5_612(mu)%a(2,2)*cx2
      clinetfz(i1,i2,mu)%b(2,jut)=clinetfz(i1,i2,mu)%b(2,jut)+lf
     & 5_612(mu)%b(2,1)*cx1+lf5_612(mu)%d(2,2)*cy2
      clinetfz(i1,i2,mu)%c(2,jut)=clinetfz(i1,i2,mu)%c(2,jut)+lf
     & 5_612(mu)%c(2,1)*cz1+lf5_612(mu)%a(2,2)*cw2
      clinetfz(i1,i2,mu)%d(2,jut)=clinetfz(i1,i2,mu)%d(2,jut)+lf
     & 5_612(mu)%b(2,1)*cw1+lf5_612(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id5)
      rmassr=-rmass(id6)
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=cf1256(i1,i2,&1,&2,mu),abcd=clinetfz(i1,i2,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cf1256(i1,i2,iut,jut,mu)=cf1256(i1,i2,iut,jut,mu)+clinetfz
     & (i1,i2,mu)%a(iut,jut)+rmassl*clinetfz(i1,i2,mu)%b(iut,jut
     & )+rmassr*clinetfz(i1,i2,mu)%c(iut,jut)+rmassl*rmassr*clin
     & etfz(i1,i2,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
      if(ilept(id5).ne.1)then
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=cg5612(&1,&2,i1,i2,mu),abcd=clinetfz(i1,i2,mu)%,m1=rmassl
* ,m2=rmassr,den=fcl(id5),nsum=0
      do iut=1,2
      do jut=1,2
      cg5612(iut,jut,i1,i2,mu)=(clinetfz(i1,i2,mu)%a(iut,jut)+rm
     & assl*clinetfz(i1,i2,mu)%b(iut,jut)+rmassr*clinetfz(i1,i2,
     & mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i1,i2,mu)%d(iut,jut
     & ))/fcl(id5)
      enddo
      enddo
      end do
      end do
      end do
      endif
  
      endif
  
      if(ineutri(id3).ne.1) then
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TsT -- aa=clinetfz(i7,i8,mu)%a,bb=clinetfz(i7,i8,mu)%b,cc=clinetfz(i7,
* i8,mu)%c,dd=clinetfz(i7,i8,mu)%d,a1=l3_78(i7,i8)%a,b1=l3_78(i7,i8)%b,c
* 1=l3_78(i7,i8)%c,d1=l3_78(i7,i8)%d,a2=rf4_378(mu)%a,b2=rf4_378(mu)%b,c
* 2=rf4_378(mu)%c,d2=rf4_378(mu)%d,prq=p378q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=l3_78(i7,i8)%a(iut,1)+l3_78(i7,i8)%c(iut,1)*rmass(id3)
      cx2=l3_78(i7,i8)%c(iut,2)*p378q+l3_78(i7,i8)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_78(i7,i8)%b(iut,1)+l3_78(i7,i8)%d(iut,1)*rmass(id3)
      cy2=l3_78(i7,i8)%d(iut,2)*p378q+l3_78(i7,i8)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_78(i7,i8)%c(iut,1)*p378q+l3_78(i7,i8)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_78(i7,i8)%a(iut,2)+l3_78(i7,i8)%c(iut,2)*rmass(id3)
      cz1=l3_78(i7,i8)%d(iut,1)*p378q+l3_78(i7,i8)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_78(i7,i8)%b(iut,2)+l3_78(i7,i8)%d(iut,2)*rmass(id3)
      clinetfz(i7,i8,mu)%a(iut,1)=cx1*rf4_378(mu)%a(1,1)+cx2*rf4
     & _378(mu)%b(2,1)
      clinetfz(i7,i8,mu)%b(iut,1)=cy1*rf4_378(mu)%a(1,1)+cy2*rf4
     & _378(mu)%b(2,1)
      clinetfz(i7,i8,mu)%c(iut,1)=cw1*rf4_378(mu)%d(1,1)+cw2*rf4
     & _378(mu)%c(2,1)
      clinetfz(i7,i8,mu)%d(iut,1)=cz1*rf4_378(mu)%d(1,1)+cz2*rf4
     & _378(mu)%c(2,1)
      clinetfz(i7,i8,mu)%a(iut,2)=cw1*rf4_378(mu)%b(1,2)+cw2*rf4
     & _378(mu)%a(2,2)
      clinetfz(i7,i8,mu)%b(iut,2)=cz1*rf4_378(mu)%b(1,2)+cz2*rf4
     & _378(mu)%a(2,2)
      clinetfz(i7,i8,mu)%c(iut,2)=cx1*rf4_378(mu)%c(1,2)+cx2*rf4
     & _378(mu)%d(2,2)
      clinetfz(i7,i8,mu)%d(iut,2)=cy1*rf4_378(mu)%c(1,2)+cy2*rf4
     & _378(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TTs -- aa=clinetfz(i7,i8,mu)%a,bb=clinetfz(i7,i8,mu)%b,cc=clinetfz(i7,
* i8,mu)%c,dd=clinetfz(i7,i8,mu)%d,a1=lf3_478(mu)%a,b1=lf3_478(mu)%b,c1=
* lf3_478(mu)%c,d1=lf3_478(mu)%d,a2=r4_78(i7,i8)%a,b2=r4_78(i7,i8)%b,c2=
* r4_78(i7,i8)%c,d2=r4_78(i7,i8)%d,prq=p478q,m=rmass(id3),nsum=1
      do jut=1,2
      cx1=r4_78(i7,i8)%a(1,jut)+rmass(id3)*r4_78(i7,i8)%b(1,jut)
      cx2=r4_78(i7,i8)%a(2,jut)+rmass(id3)*r4_78(i7,i8)%b(2,jut)
      cy1=p478q*r4_78(i7,i8)%b(1,jut)+rmass(id3)*r4_78(i7,i8)%a(
     & 1,jut)
      cy2=p478q*r4_78(i7,i8)%b(2,jut)+rmass(id3)*r4_78(i7,i8)%a(
     & 2,jut)
      cw1=r4_78(i7,i8)%c(1,jut)+rmass(id3)*r4_78(i7,i8)%d(1,jut)
      cw2=r4_78(i7,i8)%c(2,jut)+rmass(id3)*r4_78(i7,i8)%d(2,jut)
      cz1=p478q*r4_78(i7,i8)%d(1,jut)+rmass(id3)*r4_78(i7,i8)%c(
     & 1,jut)
      cz2=p478q*r4_78(i7,i8)%d(2,jut)+rmass(id3)*r4_78(i7,i8)%c(
     & 2,jut)
      clinetfz(i7,i8,mu)%a(1,jut)=clinetfz(i7,i8,mu)%a(1,jut)+lf
     & 3_478(mu)%a(1,1)*cx1+lf3_478(mu)%c(1,2)*cy2
      clinetfz(i7,i8,mu)%b(1,jut)=clinetfz(i7,i8,mu)%b(1,jut)+lf
     & 3_478(mu)%d(1,1)*cy1+lf3_478(mu)%b(1,2)*cx2
      clinetfz(i7,i8,mu)%c(1,jut)=clinetfz(i7,i8,mu)%c(1,jut)+lf
     & 3_478(mu)%a(1,1)*cw1+lf3_478(mu)%c(1,2)*cz2
      clinetfz(i7,i8,mu)%d(1,jut)=clinetfz(i7,i8,mu)%d(1,jut)+lf
     & 3_478(mu)%d(1,1)*cz1+lf3_478(mu)%b(1,2)*cw2
      clinetfz(i7,i8,mu)%a(2,jut)=clinetfz(i7,i8,mu)%a(2,jut)+lf
     & 3_478(mu)%c(2,1)*cy1+lf3_478(mu)%a(2,2)*cx2
      clinetfz(i7,i8,mu)%b(2,jut)=clinetfz(i7,i8,mu)%b(2,jut)+lf
     & 3_478(mu)%b(2,1)*cx1+lf3_478(mu)%d(2,2)*cy2
      clinetfz(i7,i8,mu)%c(2,jut)=clinetfz(i7,i8,mu)%c(2,jut)+lf
     & 3_478(mu)%c(2,1)*cz1+lf3_478(mu)%a(2,2)*cw2
      clinetfz(i7,i8,mu)%d(2,jut)=clinetfz(i7,i8,mu)%d(2,jut)+lf
     & 3_478(mu)%b(2,1)*cw1+lf3_478(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id3)
      rmassr=-rmass(id4)
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* mline -- res=cf3478(&1,&2,i7,i8,mu),abcd=clinetfz(i7,i8,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cf3478(iut,jut,i7,i8,mu)=clinetfz(i7,i8,mu)%a(iut,jut)+rma
     & ssl*clinetfz(i7,i8,mu)%b(iut,jut)+rmassr*clinetfz(i7,i8,m
     & u)%c(iut,jut)+rmassl*rmassr*clinetfz(i7,i8,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      if(ilept(id3).ne.1)then
      do i7=1,2
      do i8=1,2
      do mu=0,3
* mline -- res=cg3478(&1,&2,i7,i8,mu),abcd=clinetfz(i7,i8,mu)%,m1=rmassl
* ,m2=rmassr,den=fcl(id3),nsum=0
      do iut=1,2
      do jut=1,2
      cg3478(iut,jut,i7,i8,mu)=(clinetfz(i7,i8,mu)%a(iut,jut)+rm
     & assl*clinetfz(i7,i8,mu)%b(iut,jut)+rmassr*clinetfz(i7,i8,
     & mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i7,i8,mu)%d(iut,jut
     & ))/fcl(id3)
      enddo
      enddo
      end do
      end do
      end do
      endif
  
      endif
  
      if(ineutri(id7).ne.1) then
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TsT -- aa=clinetfz(i3,i4,mu)%a,bb=clinetfz(i3,i4,mu)%b,cc=clinetfz(i3,
* i4,mu)%c,dd=clinetfz(i3,i4,mu)%d,a1=l7_34(i3,i4)%a,b1=l7_34(i3,i4)%b,c
* 1=l7_34(i3,i4)%c,d1=l7_34(i3,i4)%d,a2=rf8_734(mu)%a,b2=rf8_734(mu)%b,c
* 2=rf8_734(mu)%c,d2=rf8_734(mu)%d,prq=p734q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=l7_34(i3,i4)%a(iut,1)+l7_34(i3,i4)%c(iut,1)*rmass(id7)
      cx2=l7_34(i3,i4)%c(iut,2)*p734q+l7_34(i3,i4)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_34(i3,i4)%b(iut,1)+l7_34(i3,i4)%d(iut,1)*rmass(id7)
      cy2=l7_34(i3,i4)%d(iut,2)*p734q+l7_34(i3,i4)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_34(i3,i4)%c(iut,1)*p734q+l7_34(i3,i4)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_34(i3,i4)%a(iut,2)+l7_34(i3,i4)%c(iut,2)*rmass(id7)
      cz1=l7_34(i3,i4)%d(iut,1)*p734q+l7_34(i3,i4)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_34(i3,i4)%b(iut,2)+l7_34(i3,i4)%d(iut,2)*rmass(id7)
      clinetfz(i3,i4,mu)%a(iut,1)=cx1*rf8_734(mu)%a(1,1)+cx2*rf8
     & _734(mu)%b(2,1)
      clinetfz(i3,i4,mu)%b(iut,1)=cy1*rf8_734(mu)%a(1,1)+cy2*rf8
     & _734(mu)%b(2,1)
      clinetfz(i3,i4,mu)%c(iut,1)=cw1*rf8_734(mu)%d(1,1)+cw2*rf8
     & _734(mu)%c(2,1)
      clinetfz(i3,i4,mu)%d(iut,1)=cz1*rf8_734(mu)%d(1,1)+cz2*rf8
     & _734(mu)%c(2,1)
      clinetfz(i3,i4,mu)%a(iut,2)=cw1*rf8_734(mu)%b(1,2)+cw2*rf8
     & _734(mu)%a(2,2)
      clinetfz(i3,i4,mu)%b(iut,2)=cz1*rf8_734(mu)%b(1,2)+cz2*rf8
     & _734(mu)%a(2,2)
      clinetfz(i3,i4,mu)%c(iut,2)=cx1*rf8_734(mu)%c(1,2)+cx2*rf8
     & _734(mu)%d(2,2)
      clinetfz(i3,i4,mu)%d(iut,2)=cy1*rf8_734(mu)%c(1,2)+cy2*rf8
     & _734(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TTs -- aa=clinetfz(i3,i4,mu)%a,bb=clinetfz(i3,i4,mu)%b,cc=clinetfz(i3,
* i4,mu)%c,dd=clinetfz(i3,i4,mu)%d,a1=lf7_834(mu)%a,b1=lf7_834(mu)%b,c1=
* lf7_834(mu)%c,d1=lf7_834(mu)%d,a2=r8_34(i3,i4)%a,b2=r8_34(i3,i4)%b,c2=
* r8_34(i3,i4)%c,d2=r8_34(i3,i4)%d,prq=p834q,m=rmass(id7),nsum=1
      do jut=1,2
      cx1=r8_34(i3,i4)%a(1,jut)+rmass(id7)*r8_34(i3,i4)%b(1,jut)
      cx2=r8_34(i3,i4)%a(2,jut)+rmass(id7)*r8_34(i3,i4)%b(2,jut)
      cy1=p834q*r8_34(i3,i4)%b(1,jut)+rmass(id7)*r8_34(i3,i4)%a(
     & 1,jut)
      cy2=p834q*r8_34(i3,i4)%b(2,jut)+rmass(id7)*r8_34(i3,i4)%a(
     & 2,jut)
      cw1=r8_34(i3,i4)%c(1,jut)+rmass(id7)*r8_34(i3,i4)%d(1,jut)
      cw2=r8_34(i3,i4)%c(2,jut)+rmass(id7)*r8_34(i3,i4)%d(2,jut)
      cz1=p834q*r8_34(i3,i4)%d(1,jut)+rmass(id7)*r8_34(i3,i4)%c(
     & 1,jut)
      cz2=p834q*r8_34(i3,i4)%d(2,jut)+rmass(id7)*r8_34(i3,i4)%c(
     & 2,jut)
      clinetfz(i3,i4,mu)%a(1,jut)=clinetfz(i3,i4,mu)%a(1,jut)+lf
     & 7_834(mu)%a(1,1)*cx1+lf7_834(mu)%c(1,2)*cy2
      clinetfz(i3,i4,mu)%b(1,jut)=clinetfz(i3,i4,mu)%b(1,jut)+lf
     & 7_834(mu)%d(1,1)*cy1+lf7_834(mu)%b(1,2)*cx2
      clinetfz(i3,i4,mu)%c(1,jut)=clinetfz(i3,i4,mu)%c(1,jut)+lf
     & 7_834(mu)%a(1,1)*cw1+lf7_834(mu)%c(1,2)*cz2
      clinetfz(i3,i4,mu)%d(1,jut)=clinetfz(i3,i4,mu)%d(1,jut)+lf
     & 7_834(mu)%d(1,1)*cz1+lf7_834(mu)%b(1,2)*cw2
      clinetfz(i3,i4,mu)%a(2,jut)=clinetfz(i3,i4,mu)%a(2,jut)+lf
     & 7_834(mu)%c(2,1)*cy1+lf7_834(mu)%a(2,2)*cx2
      clinetfz(i3,i4,mu)%b(2,jut)=clinetfz(i3,i4,mu)%b(2,jut)+lf
     & 7_834(mu)%b(2,1)*cx1+lf7_834(mu)%d(2,2)*cy2
      clinetfz(i3,i4,mu)%c(2,jut)=clinetfz(i3,i4,mu)%c(2,jut)+lf
     & 7_834(mu)%c(2,1)*cz1+lf7_834(mu)%a(2,2)*cw2
      clinetfz(i3,i4,mu)%d(2,jut)=clinetfz(i3,i4,mu)%d(2,jut)+lf
     & 7_834(mu)%b(2,1)*cw1+lf7_834(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id7)
      rmassr=-rmass(id8)
  
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=cf3478(i3,i4,&1,&2,mu),abcd=clinetfz(i3,i4,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cf3478(i3,i4,iut,jut,mu)=cf3478(i3,i4,iut,jut,mu)+clinetfz
     & (i3,i4,mu)%a(iut,jut)+rmassl*clinetfz(i3,i4,mu)%b(iut,jut
     & )+rmassr*clinetfz(i3,i4,mu)%c(iut,jut)+rmassl*rmassr*clin
     & etfz(i3,i4,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
      if(ilept(id7).ne.1)then
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=cg7834(&1,&2,i3,i4,mu),abcd=clinetfz(i3,i4,mu)%,m1=rmassl
* ,m2=rmassr,den=fcl(id7),nsum=0
      do iut=1,2
      do jut=1,2
      cg7834(iut,jut,i3,i4,mu)=(clinetfz(i3,i4,mu)%a(iut,jut)+rm
     & assl*clinetfz(i3,i4,mu)%b(iut,jut)+rmassr*clinetfz(i3,i4,
     & mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i3,i4,mu)%d(iut,jut
     & ))/fcl(id7)
      enddo
      enddo
      end do
      end do
      end do
      endif
  
      endif
  
      if(ineutri(id1).ne.1) then
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TsT -- aa=clinetfz(i7,i8,mu)%a,bb=clinetfz(i7,i8,mu)%b,cc=clinetfz(i7,
* i8,mu)%c,dd=clinetfz(i7,i8,mu)%d,a1=l1_78(i7,i8)%a,b1=l1_78(i7,i8)%b,c
* 1=l1_78(i7,i8)%c,d1=l1_78(i7,i8)%d,a2=rf2_178(mu)%a,b2=rf2_178(mu)%b,c
* 2=rf2_178(mu)%c,d2=rf2_178(mu)%d,prq=p178q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=l1_78(i7,i8)%a(iut,1)+l1_78(i7,i8)%c(iut,1)*rmass(id1)
      cx2=l1_78(i7,i8)%c(iut,2)*p178q+l1_78(i7,i8)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_78(i7,i8)%b(iut,1)+l1_78(i7,i8)%d(iut,1)*rmass(id1)
      cy2=l1_78(i7,i8)%d(iut,2)*p178q+l1_78(i7,i8)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_78(i7,i8)%c(iut,1)*p178q+l1_78(i7,i8)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_78(i7,i8)%a(iut,2)+l1_78(i7,i8)%c(iut,2)*rmass(id1)
      cz1=l1_78(i7,i8)%d(iut,1)*p178q+l1_78(i7,i8)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_78(i7,i8)%b(iut,2)+l1_78(i7,i8)%d(iut,2)*rmass(id1)
      clinetfz(i7,i8,mu)%a(iut,1)=cx1*rf2_178(mu)%a(1,1)+cx2*rf2
     & _178(mu)%b(2,1)
      clinetfz(i7,i8,mu)%b(iut,1)=cy1*rf2_178(mu)%a(1,1)+cy2*rf2
     & _178(mu)%b(2,1)
      clinetfz(i7,i8,mu)%c(iut,1)=cw1*rf2_178(mu)%d(1,1)+cw2*rf2
     & _178(mu)%c(2,1)
      clinetfz(i7,i8,mu)%d(iut,1)=cz1*rf2_178(mu)%d(1,1)+cz2*rf2
     & _178(mu)%c(2,1)
      clinetfz(i7,i8,mu)%a(iut,2)=cw1*rf2_178(mu)%b(1,2)+cw2*rf2
     & _178(mu)%a(2,2)
      clinetfz(i7,i8,mu)%b(iut,2)=cz1*rf2_178(mu)%b(1,2)+cz2*rf2
     & _178(mu)%a(2,2)
      clinetfz(i7,i8,mu)%c(iut,2)=cx1*rf2_178(mu)%c(1,2)+cx2*rf2
     & _178(mu)%d(2,2)
      clinetfz(i7,i8,mu)%d(iut,2)=cy1*rf2_178(mu)%c(1,2)+cy2*rf2
     & _178(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TTs -- aa=clinetfz(i7,i8,mu)%a,bb=clinetfz(i7,i8,mu)%b,cc=clinetfz(i7,
* i8,mu)%c,dd=clinetfz(i7,i8,mu)%d,a1=lf1_278(mu)%a,b1=lf1_278(mu)%b,c1=
* lf1_278(mu)%c,d1=lf1_278(mu)%d,a2=r2_78(i7,i8)%a,b2=r2_78(i7,i8)%b,c2=
* r2_78(i7,i8)%c,d2=r2_78(i7,i8)%d,prq=p278q,m=rmass(id1),nsum=1
      do jut=1,2
      cx1=r2_78(i7,i8)%a(1,jut)+rmass(id1)*r2_78(i7,i8)%b(1,jut)
      cx2=r2_78(i7,i8)%a(2,jut)+rmass(id1)*r2_78(i7,i8)%b(2,jut)
      cy1=p278q*r2_78(i7,i8)%b(1,jut)+rmass(id1)*r2_78(i7,i8)%a(
     & 1,jut)
      cy2=p278q*r2_78(i7,i8)%b(2,jut)+rmass(id1)*r2_78(i7,i8)%a(
     & 2,jut)
      cw1=r2_78(i7,i8)%c(1,jut)+rmass(id1)*r2_78(i7,i8)%d(1,jut)
      cw2=r2_78(i7,i8)%c(2,jut)+rmass(id1)*r2_78(i7,i8)%d(2,jut)
      cz1=p278q*r2_78(i7,i8)%d(1,jut)+rmass(id1)*r2_78(i7,i8)%c(
     & 1,jut)
      cz2=p278q*r2_78(i7,i8)%d(2,jut)+rmass(id1)*r2_78(i7,i8)%c(
     & 2,jut)
      clinetfz(i7,i8,mu)%a(1,jut)=clinetfz(i7,i8,mu)%a(1,jut)+lf
     & 1_278(mu)%a(1,1)*cx1+lf1_278(mu)%c(1,2)*cy2
      clinetfz(i7,i8,mu)%b(1,jut)=clinetfz(i7,i8,mu)%b(1,jut)+lf
     & 1_278(mu)%d(1,1)*cy1+lf1_278(mu)%b(1,2)*cx2
      clinetfz(i7,i8,mu)%c(1,jut)=clinetfz(i7,i8,mu)%c(1,jut)+lf
     & 1_278(mu)%a(1,1)*cw1+lf1_278(mu)%c(1,2)*cz2
      clinetfz(i7,i8,mu)%d(1,jut)=clinetfz(i7,i8,mu)%d(1,jut)+lf
     & 1_278(mu)%d(1,1)*cz1+lf1_278(mu)%b(1,2)*cw2
      clinetfz(i7,i8,mu)%a(2,jut)=clinetfz(i7,i8,mu)%a(2,jut)+lf
     & 1_278(mu)%c(2,1)*cy1+lf1_278(mu)%a(2,2)*cx2
      clinetfz(i7,i8,mu)%b(2,jut)=clinetfz(i7,i8,mu)%b(2,jut)+lf
     & 1_278(mu)%b(2,1)*cx1+lf1_278(mu)%d(2,2)*cy2
      clinetfz(i7,i8,mu)%c(2,jut)=clinetfz(i7,i8,mu)%c(2,jut)+lf
     & 1_278(mu)%c(2,1)*cz1+lf1_278(mu)%a(2,2)*cw2
      clinetfz(i7,i8,mu)%d(2,jut)=clinetfz(i7,i8,mu)%d(2,jut)+lf
     & 1_278(mu)%b(2,1)*cw1+lf1_278(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id1)
      rmassr=-rmass(id2)
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* mline -- res=cf1278(&1,&2,i7,i8,mu),abcd=clinetfz(i7,i8,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cf1278(iut,jut,i7,i8,mu)=clinetfz(i7,i8,mu)%a(iut,jut)+rma
     & ssl*clinetfz(i7,i8,mu)%b(iut,jut)+rmassr*clinetfz(i7,i8,m
     & u)%c(iut,jut)+rmassl*rmassr*clinetfz(i7,i8,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      if(ilept(id1).ne.1)then
      do i7=1,2
      do i8=1,2
      do mu=0,3
* mline -- res=cg1278(&1,&2,i7,i8,mu),abcd=clinetfz(i7,i8,mu)%,m1=rmassl
* ,m2=rmassr,den=fcl(id1),nsum=0
      do iut=1,2
      do jut=1,2
      cg1278(iut,jut,i7,i8,mu)=(clinetfz(i7,i8,mu)%a(iut,jut)+rm
     & assl*clinetfz(i7,i8,mu)%b(iut,jut)+rmassr*clinetfz(i7,i8,
     & mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i7,i8,mu)%d(iut,jut
     & ))/fcl(id1)
      enddo
      enddo
      end do
      end do
      end do
      endif
  
      endif
  
      if(ineutri(id7).ne.1) then
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TsT -- aa=clinetfz(i1,i2,mu)%a,bb=clinetfz(i1,i2,mu)%b,cc=clinetfz(i1,
* i2,mu)%c,dd=clinetfz(i1,i2,mu)%d,a1=l7_12(i1,i2)%a,b1=l7_12(i1,i2)%b,c
* 1=l7_12(i1,i2)%c,d1=l7_12(i1,i2)%d,a2=rf8_712(mu)%a,b2=rf8_712(mu)%b,c
* 2=rf8_712(mu)%c,d2=rf8_712(mu)%d,prq=p712q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=l7_12(i1,i2)%a(iut,1)+l7_12(i1,i2)%c(iut,1)*rmass(id7)
      cx2=l7_12(i1,i2)%c(iut,2)*p712q+l7_12(i1,i2)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_12(i1,i2)%b(iut,1)+l7_12(i1,i2)%d(iut,1)*rmass(id7)
      cy2=l7_12(i1,i2)%d(iut,2)*p712q+l7_12(i1,i2)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_12(i1,i2)%c(iut,1)*p712q+l7_12(i1,i2)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_12(i1,i2)%a(iut,2)+l7_12(i1,i2)%c(iut,2)*rmass(id7)
      cz1=l7_12(i1,i2)%d(iut,1)*p712q+l7_12(i1,i2)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_12(i1,i2)%b(iut,2)+l7_12(i1,i2)%d(iut,2)*rmass(id7)
      clinetfz(i1,i2,mu)%a(iut,1)=cx1*rf8_712(mu)%a(1,1)+cx2*rf8
     & _712(mu)%b(2,1)
      clinetfz(i1,i2,mu)%b(iut,1)=cy1*rf8_712(mu)%a(1,1)+cy2*rf8
     & _712(mu)%b(2,1)
      clinetfz(i1,i2,mu)%c(iut,1)=cw1*rf8_712(mu)%d(1,1)+cw2*rf8
     & _712(mu)%c(2,1)
      clinetfz(i1,i2,mu)%d(iut,1)=cz1*rf8_712(mu)%d(1,1)+cz2*rf8
     & _712(mu)%c(2,1)
      clinetfz(i1,i2,mu)%a(iut,2)=cw1*rf8_712(mu)%b(1,2)+cw2*rf8
     & _712(mu)%a(2,2)
      clinetfz(i1,i2,mu)%b(iut,2)=cz1*rf8_712(mu)%b(1,2)+cz2*rf8
     & _712(mu)%a(2,2)
      clinetfz(i1,i2,mu)%c(iut,2)=cx1*rf8_712(mu)%c(1,2)+cx2*rf8
     & _712(mu)%d(2,2)
      clinetfz(i1,i2,mu)%d(iut,2)=cy1*rf8_712(mu)%c(1,2)+cy2*rf8
     & _712(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TTs -- aa=clinetfz(i1,i2,mu)%a,bb=clinetfz(i1,i2,mu)%b,cc=clinetfz(i1,
* i2,mu)%c,dd=clinetfz(i1,i2,mu)%d,a1=lf7_812(mu)%a,b1=lf7_812(mu)%b,c1=
* lf7_812(mu)%c,d1=lf7_812(mu)%d,a2=r8_12(i1,i2)%a,b2=r8_12(i1,i2)%b,c2=
* r8_12(i1,i2)%c,d2=r8_12(i1,i2)%d,prq=p812q,m=rmass(id7),nsum=1
      do jut=1,2
      cx1=r8_12(i1,i2)%a(1,jut)+rmass(id7)*r8_12(i1,i2)%b(1,jut)
      cx2=r8_12(i1,i2)%a(2,jut)+rmass(id7)*r8_12(i1,i2)%b(2,jut)
      cy1=p812q*r8_12(i1,i2)%b(1,jut)+rmass(id7)*r8_12(i1,i2)%a(
     & 1,jut)
      cy2=p812q*r8_12(i1,i2)%b(2,jut)+rmass(id7)*r8_12(i1,i2)%a(
     & 2,jut)
      cw1=r8_12(i1,i2)%c(1,jut)+rmass(id7)*r8_12(i1,i2)%d(1,jut)
      cw2=r8_12(i1,i2)%c(2,jut)+rmass(id7)*r8_12(i1,i2)%d(2,jut)
      cz1=p812q*r8_12(i1,i2)%d(1,jut)+rmass(id7)*r8_12(i1,i2)%c(
     & 1,jut)
      cz2=p812q*r8_12(i1,i2)%d(2,jut)+rmass(id7)*r8_12(i1,i2)%c(
     & 2,jut)
      clinetfz(i1,i2,mu)%a(1,jut)=clinetfz(i1,i2,mu)%a(1,jut)+lf
     & 7_812(mu)%a(1,1)*cx1+lf7_812(mu)%c(1,2)*cy2
      clinetfz(i1,i2,mu)%b(1,jut)=clinetfz(i1,i2,mu)%b(1,jut)+lf
     & 7_812(mu)%d(1,1)*cy1+lf7_812(mu)%b(1,2)*cx2
      clinetfz(i1,i2,mu)%c(1,jut)=clinetfz(i1,i2,mu)%c(1,jut)+lf
     & 7_812(mu)%a(1,1)*cw1+lf7_812(mu)%c(1,2)*cz2
      clinetfz(i1,i2,mu)%d(1,jut)=clinetfz(i1,i2,mu)%d(1,jut)+lf
     & 7_812(mu)%d(1,1)*cz1+lf7_812(mu)%b(1,2)*cw2
      clinetfz(i1,i2,mu)%a(2,jut)=clinetfz(i1,i2,mu)%a(2,jut)+lf
     & 7_812(mu)%c(2,1)*cy1+lf7_812(mu)%a(2,2)*cx2
      clinetfz(i1,i2,mu)%b(2,jut)=clinetfz(i1,i2,mu)%b(2,jut)+lf
     & 7_812(mu)%b(2,1)*cx1+lf7_812(mu)%d(2,2)*cy2
      clinetfz(i1,i2,mu)%c(2,jut)=clinetfz(i1,i2,mu)%c(2,jut)+lf
     & 7_812(mu)%c(2,1)*cz1+lf7_812(mu)%a(2,2)*cw2
      clinetfz(i1,i2,mu)%d(2,jut)=clinetfz(i1,i2,mu)%d(2,jut)+lf
     & 7_812(mu)%b(2,1)*cw1+lf7_812(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id7)
      rmassr=-rmass(id8)
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=cf1278(i1,i2,&1,&2,mu),abcd=clinetfz(i1,i2,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cf1278(i1,i2,iut,jut,mu)=cf1278(i1,i2,iut,jut,mu)+clinetfz
     & (i1,i2,mu)%a(iut,jut)+rmassl*clinetfz(i1,i2,mu)%b(iut,jut
     & )+rmassr*clinetfz(i1,i2,mu)%c(iut,jut)+rmassl*rmassr*clin
     & etfz(i1,i2,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
      if(ilept(id7).ne.1)then
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=cg7812(&1,&2,i1,i2,mu),abcd=clinetfz(i1,i2,mu)%,m1=rmassl
* ,m2=rmassr,den=fcl(id7),nsum=0
      do iut=1,2
      do jut=1,2
      cg7812(iut,jut,i1,i2,mu)=(clinetfz(i1,i2,mu)%a(iut,jut)+rm
     & assl*clinetfz(i1,i2,mu)%b(iut,jut)+rmassr*clinetfz(i1,i2,
     & mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i1,i2,mu)%d(iut,jut
     & ))/fcl(id7)
      enddo
      enddo
      end do
      end do
      end do
      endif
  
      endif
  
      if(ineutri(id3).ne.1) then
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TsT -- aa=clinetfz(i5,i6,mu)%a,bb=clinetfz(i5,i6,mu)%b,cc=clinetfz(i5,
* i6,mu)%c,dd=clinetfz(i5,i6,mu)%d,a1=l3_56(i5,i6)%a,b1=l3_56(i5,i6)%b,c
* 1=l3_56(i5,i6)%c,d1=l3_56(i5,i6)%d,a2=rf4_356(mu)%a,b2=rf4_356(mu)%b,c
* 2=rf4_356(mu)%c,d2=rf4_356(mu)%d,prq=p356q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=l3_56(i5,i6)%a(iut,1)+l3_56(i5,i6)%c(iut,1)*rmass(id3)
      cx2=l3_56(i5,i6)%c(iut,2)*p356q+l3_56(i5,i6)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_56(i5,i6)%b(iut,1)+l3_56(i5,i6)%d(iut,1)*rmass(id3)
      cy2=l3_56(i5,i6)%d(iut,2)*p356q+l3_56(i5,i6)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_56(i5,i6)%c(iut,1)*p356q+l3_56(i5,i6)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_56(i5,i6)%a(iut,2)+l3_56(i5,i6)%c(iut,2)*rmass(id3)
      cz1=l3_56(i5,i6)%d(iut,1)*p356q+l3_56(i5,i6)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_56(i5,i6)%b(iut,2)+l3_56(i5,i6)%d(iut,2)*rmass(id3)
      clinetfz(i5,i6,mu)%a(iut,1)=cx1*rf4_356(mu)%a(1,1)+cx2*rf4
     & _356(mu)%b(2,1)
      clinetfz(i5,i6,mu)%b(iut,1)=cy1*rf4_356(mu)%a(1,1)+cy2*rf4
     & _356(mu)%b(2,1)
      clinetfz(i5,i6,mu)%c(iut,1)=cw1*rf4_356(mu)%d(1,1)+cw2*rf4
     & _356(mu)%c(2,1)
      clinetfz(i5,i6,mu)%d(iut,1)=cz1*rf4_356(mu)%d(1,1)+cz2*rf4
     & _356(mu)%c(2,1)
      clinetfz(i5,i6,mu)%a(iut,2)=cw1*rf4_356(mu)%b(1,2)+cw2*rf4
     & _356(mu)%a(2,2)
      clinetfz(i5,i6,mu)%b(iut,2)=cz1*rf4_356(mu)%b(1,2)+cz2*rf4
     & _356(mu)%a(2,2)
      clinetfz(i5,i6,mu)%c(iut,2)=cx1*rf4_356(mu)%c(1,2)+cx2*rf4
     & _356(mu)%d(2,2)
      clinetfz(i5,i6,mu)%d(iut,2)=cy1*rf4_356(mu)%c(1,2)+cy2*rf4
     & _356(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TTs -- aa=clinetfz(i5,i6,mu)%a,bb=clinetfz(i5,i6,mu)%b,cc=clinetfz(i5,
* i6,mu)%c,dd=clinetfz(i5,i6,mu)%d,a1=lf3_456(mu)%a,b1=lf3_456(mu)%b,c1=
* lf3_456(mu)%c,d1=lf3_456(mu)%d,a2=r4_56(i5,i6)%a,b2=r4_56(i5,i6)%b,c2=
* r4_56(i5,i6)%c,d2=r4_56(i5,i6)%d,prq=p456q,m=rmass(id3),nsum=1
      do jut=1,2
      cx1=r4_56(i5,i6)%a(1,jut)+rmass(id3)*r4_56(i5,i6)%b(1,jut)
      cx2=r4_56(i5,i6)%a(2,jut)+rmass(id3)*r4_56(i5,i6)%b(2,jut)
      cy1=p456q*r4_56(i5,i6)%b(1,jut)+rmass(id3)*r4_56(i5,i6)%a(
     & 1,jut)
      cy2=p456q*r4_56(i5,i6)%b(2,jut)+rmass(id3)*r4_56(i5,i6)%a(
     & 2,jut)
      cw1=r4_56(i5,i6)%c(1,jut)+rmass(id3)*r4_56(i5,i6)%d(1,jut)
      cw2=r4_56(i5,i6)%c(2,jut)+rmass(id3)*r4_56(i5,i6)%d(2,jut)
      cz1=p456q*r4_56(i5,i6)%d(1,jut)+rmass(id3)*r4_56(i5,i6)%c(
     & 1,jut)
      cz2=p456q*r4_56(i5,i6)%d(2,jut)+rmass(id3)*r4_56(i5,i6)%c(
     & 2,jut)
      clinetfz(i5,i6,mu)%a(1,jut)=clinetfz(i5,i6,mu)%a(1,jut)+lf
     & 3_456(mu)%a(1,1)*cx1+lf3_456(mu)%c(1,2)*cy2
      clinetfz(i5,i6,mu)%b(1,jut)=clinetfz(i5,i6,mu)%b(1,jut)+lf
     & 3_456(mu)%d(1,1)*cy1+lf3_456(mu)%b(1,2)*cx2
      clinetfz(i5,i6,mu)%c(1,jut)=clinetfz(i5,i6,mu)%c(1,jut)+lf
     & 3_456(mu)%a(1,1)*cw1+lf3_456(mu)%c(1,2)*cz2
      clinetfz(i5,i6,mu)%d(1,jut)=clinetfz(i5,i6,mu)%d(1,jut)+lf
     & 3_456(mu)%d(1,1)*cz1+lf3_456(mu)%b(1,2)*cw2
      clinetfz(i5,i6,mu)%a(2,jut)=clinetfz(i5,i6,mu)%a(2,jut)+lf
     & 3_456(mu)%c(2,1)*cy1+lf3_456(mu)%a(2,2)*cx2
      clinetfz(i5,i6,mu)%b(2,jut)=clinetfz(i5,i6,mu)%b(2,jut)+lf
     & 3_456(mu)%b(2,1)*cx1+lf3_456(mu)%d(2,2)*cy2
      clinetfz(i5,i6,mu)%c(2,jut)=clinetfz(i5,i6,mu)%c(2,jut)+lf
     & 3_456(mu)%c(2,1)*cz1+lf3_456(mu)%a(2,2)*cw2
      clinetfz(i5,i6,mu)%d(2,jut)=clinetfz(i5,i6,mu)%d(2,jut)+lf
     & 3_456(mu)%b(2,1)*cw1+lf3_456(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id3)
      rmassr=-rmass(id4)
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* mline -- res=cf3456(&1,&2,i5,i6,mu),abcd=clinetfz(i5,i6,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cf3456(iut,jut,i5,i6,mu)=clinetfz(i5,i6,mu)%a(iut,jut)+rma
     & ssl*clinetfz(i5,i6,mu)%b(iut,jut)+rmassr*clinetfz(i5,i6,m
     & u)%c(iut,jut)+rmassl*rmassr*clinetfz(i5,i6,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      if(ilept(id3).ne.1)then
      do i5=1,2
      do i6=1,2
      do mu=0,3
* mline -- res=cg3456(&1,&2,i5,i6,mu),abcd=clinetfz(i5,i6,mu)%,m1=rmassl
* ,m2=rmassr,den=fcl(id3),nsum=0
      do iut=1,2
      do jut=1,2
      cg3456(iut,jut,i5,i6,mu)=(clinetfz(i5,i6,mu)%a(iut,jut)+rm
     & assl*clinetfz(i5,i6,mu)%b(iut,jut)+rmassr*clinetfz(i5,i6,
     & mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i5,i6,mu)%d(iut,jut
     & ))/fcl(id3)
      enddo
      enddo
      end do
      end do
      end do
      endif
  
      endif
  
      if(ineutri(id5).ne.1) then
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TsT -- aa=clinetfz(i3,i4,mu)%a,bb=clinetfz(i3,i4,mu)%b,cc=clinetfz(i3,
* i4,mu)%c,dd=clinetfz(i3,i4,mu)%d,a1=l5_34(i3,i4)%a,b1=l5_34(i3,i4)%b,c
* 1=l5_34(i3,i4)%c,d1=l5_34(i3,i4)%d,a2=rf6_534(mu)%a,b2=rf6_534(mu)%b,c
* 2=rf6_534(mu)%c,d2=rf6_534(mu)%d,prq=p534q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=l5_34(i3,i4)%a(iut,1)+l5_34(i3,i4)%c(iut,1)*rmass(id5)
      cx2=l5_34(i3,i4)%c(iut,2)*p534q+l5_34(i3,i4)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_34(i3,i4)%b(iut,1)+l5_34(i3,i4)%d(iut,1)*rmass(id5)
      cy2=l5_34(i3,i4)%d(iut,2)*p534q+l5_34(i3,i4)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_34(i3,i4)%c(iut,1)*p534q+l5_34(i3,i4)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_34(i3,i4)%a(iut,2)+l5_34(i3,i4)%c(iut,2)*rmass(id5)
      cz1=l5_34(i3,i4)%d(iut,1)*p534q+l5_34(i3,i4)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_34(i3,i4)%b(iut,2)+l5_34(i3,i4)%d(iut,2)*rmass(id5)
      clinetfz(i3,i4,mu)%a(iut,1)=cx1*rf6_534(mu)%a(1,1)+cx2*rf6
     & _534(mu)%b(2,1)
      clinetfz(i3,i4,mu)%b(iut,1)=cy1*rf6_534(mu)%a(1,1)+cy2*rf6
     & _534(mu)%b(2,1)
      clinetfz(i3,i4,mu)%c(iut,1)=cw1*rf6_534(mu)%d(1,1)+cw2*rf6
     & _534(mu)%c(2,1)
      clinetfz(i3,i4,mu)%d(iut,1)=cz1*rf6_534(mu)%d(1,1)+cz2*rf6
     & _534(mu)%c(2,1)
      clinetfz(i3,i4,mu)%a(iut,2)=cw1*rf6_534(mu)%b(1,2)+cw2*rf6
     & _534(mu)%a(2,2)
      clinetfz(i3,i4,mu)%b(iut,2)=cz1*rf6_534(mu)%b(1,2)+cz2*rf6
     & _534(mu)%a(2,2)
      clinetfz(i3,i4,mu)%c(iut,2)=cx1*rf6_534(mu)%c(1,2)+cx2*rf6
     & _534(mu)%d(2,2)
      clinetfz(i3,i4,mu)%d(iut,2)=cy1*rf6_534(mu)%c(1,2)+cy2*rf6
     & _534(mu)%d(2,2)
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TTs -- aa=clinetfz(i3,i4,mu)%a,bb=clinetfz(i3,i4,mu)%b,cc=clinetfz(i3,
* i4,mu)%c,dd=clinetfz(i3,i4,mu)%d,a1=lf5_634(mu)%a,b1=lf5_634(mu)%b,c1=
* lf5_634(mu)%c,d1=lf5_634(mu)%d,a2=r6_34(i3,i4)%a,b2=r6_34(i3,i4)%b,c2=
* r6_34(i3,i4)%c,d2=r6_34(i3,i4)%d,prq=p634q,m=rmass(id5),nsum=1
      do jut=1,2
      cx1=r6_34(i3,i4)%a(1,jut)+rmass(id5)*r6_34(i3,i4)%b(1,jut)
      cx2=r6_34(i3,i4)%a(2,jut)+rmass(id5)*r6_34(i3,i4)%b(2,jut)
      cy1=p634q*r6_34(i3,i4)%b(1,jut)+rmass(id5)*r6_34(i3,i4)%a(
     & 1,jut)
      cy2=p634q*r6_34(i3,i4)%b(2,jut)+rmass(id5)*r6_34(i3,i4)%a(
     & 2,jut)
      cw1=r6_34(i3,i4)%c(1,jut)+rmass(id5)*r6_34(i3,i4)%d(1,jut)
      cw2=r6_34(i3,i4)%c(2,jut)+rmass(id5)*r6_34(i3,i4)%d(2,jut)
      cz1=p634q*r6_34(i3,i4)%d(1,jut)+rmass(id5)*r6_34(i3,i4)%c(
     & 1,jut)
      cz2=p634q*r6_34(i3,i4)%d(2,jut)+rmass(id5)*r6_34(i3,i4)%c(
     & 2,jut)
      clinetfz(i3,i4,mu)%a(1,jut)=clinetfz(i3,i4,mu)%a(1,jut)+lf
     & 5_634(mu)%a(1,1)*cx1+lf5_634(mu)%c(1,2)*cy2
      clinetfz(i3,i4,mu)%b(1,jut)=clinetfz(i3,i4,mu)%b(1,jut)+lf
     & 5_634(mu)%d(1,1)*cy1+lf5_634(mu)%b(1,2)*cx2
      clinetfz(i3,i4,mu)%c(1,jut)=clinetfz(i3,i4,mu)%c(1,jut)+lf
     & 5_634(mu)%a(1,1)*cw1+lf5_634(mu)%c(1,2)*cz2
      clinetfz(i3,i4,mu)%d(1,jut)=clinetfz(i3,i4,mu)%d(1,jut)+lf
     & 5_634(mu)%d(1,1)*cz1+lf5_634(mu)%b(1,2)*cw2
      clinetfz(i3,i4,mu)%a(2,jut)=clinetfz(i3,i4,mu)%a(2,jut)+lf
     & 5_634(mu)%c(2,1)*cy1+lf5_634(mu)%a(2,2)*cx2
      clinetfz(i3,i4,mu)%b(2,jut)=clinetfz(i3,i4,mu)%b(2,jut)+lf
     & 5_634(mu)%b(2,1)*cx1+lf5_634(mu)%d(2,2)*cy2
      clinetfz(i3,i4,mu)%c(2,jut)=clinetfz(i3,i4,mu)%c(2,jut)+lf
     & 5_634(mu)%c(2,1)*cz1+lf5_634(mu)%a(2,2)*cw2
      clinetfz(i3,i4,mu)%d(2,jut)=clinetfz(i3,i4,mu)%d(2,jut)+lf
     & 5_634(mu)%b(2,1)*cw1+lf5_634(mu)%d(2,2)*cz2
      end do
      end do
      end do
      end do
  
      rmassl=rmass(id5)
      rmassr=-rmass(id6)
  
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=cf3456(i3,i4,&1,&2,mu),abcd=clinetfz(i3,i4,mu)%,m1=rmassl
* ,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cf3456(i3,i4,iut,jut,mu)=cf3456(i3,i4,iut,jut,mu)+clinetfz
     & (i3,i4,mu)%a(iut,jut)+rmassl*clinetfz(i3,i4,mu)%b(iut,jut
     & )+rmassr*clinetfz(i3,i4,mu)%c(iut,jut)+rmassl*rmassr*clin
     & etfz(i3,i4,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
      if(ilept(id5).ne.1)then
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=cg5634(&1,&2,i3,i4,mu),abcd=clinetfz(i3,i4,mu)%,m1=rmassl
* ,m2=rmassr,den=fcl(id5),nsum=0
      do iut=1,2
      do jut=1,2
      cg5634(iut,jut,i3,i4,mu)=(clinetfz(i3,i4,mu)%a(iut,jut)+rm
     & assl*clinetfz(i3,i4,mu)%b(iut,jut)+rmassr*clinetfz(i3,i4,
     & mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i3,i4,mu)%d(iut,jut
     & ))/fcl(id5)
      enddo
      enddo
      end do
      end do
      end do
      endif
  
      endif
  
  
*    Then those with triple vertex                                      
*                                                                       
*                    /_                                                 
*                  Z/                                                   
*         (mu)_Z___/                                                    
*                  \                                                    
*                  h\_                                                  
*                    \                                                  
*                                                                       
  
  
* rmh < 0 in our convention means no higgs coupling                     
      if(id1.eq.5.and.rmh.ge.0.d0) then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do mu =0,3
                  cz1234(i1,i2,i3,i4,mu)= cz1234(i1,i2,i3,i4,mu)
     &             +ch12(i1,i2)*cz34(i3,i4)%e(mu)*rmz/sw/rcw
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
* rmh < 0 in our convention means no higgs coupling                     
      if(id3.eq.5.and.rmh.ge.0.d0) then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do mu =0,3
                  cz1234(i1,i2,i3,i4,mu)= cz1234(i1,i2,i3,i4,mu)
     &             +ch34(i3,i4)*cz12(i1,i2)%e(mu)*rmz/sw/rcw
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
* rmh < 0 in our convention means no higgs coupling                     
      if(id5.eq.5.and.rmh.ge.0.d0) then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do mu =0,3
                  cz5678(i1,i2,i3,i4,mu)= cz5678(i1,i2,i3,i4,mu)
     &             +ch56(i1,i2)*cz78(i3,i4)%e(mu)*rmz/sw/rcw
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
* rmh < 0 in our convention means no higgs coupling                     
      if(id7.eq.5.and.rmh.ge.0.d0) then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do mu =0,3
                  cz5678(i1,i2,i3,i4,mu)= cz5678(i1,i2,i3,i4,mu)
     &             +ch78(i3,i4)*cz56(i1,i2)%e(mu)*rmz/sw/rcw
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
* rmh < 0 in our convention means no higgs coupling                     
      if(id1.eq.5.and.rmh.ge.0.d0) then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do mu =0,3
                  cz1256(i1,i2,i3,i4,mu)= cz1256(i1,i2,i3,i4,mu)
     &             +ch12(i1,i2)*cz56(i3,i4)%e(mu)*rmz/sw/rcw
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
* rmh < 0 in our convention means no higgs coupling                     
      if(id5.eq.5.and.rmh.ge.0.d0) then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do mu =0,3
                  cz1256(i1,i2,i3,i4,mu)= cz1256(i1,i2,i3,i4,mu)
     &             +ch56(i3,i4)*cz12(i1,i2)%e(mu)*rmz/sw/rcw
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
* rmh < 0 in our convention means no higgs coupling                     
      if(id3.eq.5.and.rmh.ge.0.d0) then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do mu =0,3
                  cz3478(i1,i2,i3,i4,mu)= cz3478(i1,i2,i3,i4,mu)
     &             +ch34(i1,i2)*cz78(i3,i4)%e(mu)*rmz/sw/rcw
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
* rmh < 0 in our convention means no higgs coupling                     
      if(id7.eq.5.and.rmh.ge.0.d0) then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do mu =0,3
                  cz3478(i1,i2,i3,i4,mu)= cz3478(i1,i2,i3,i4,mu)
     &             +ch78(i3,i4)*cz34(i1,i2)%e(mu)*rmz/sw/rcw
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
* rmh < 0 in our convention means no higgs coupling                     
      if(id1.eq.5.and.rmh.ge.0.d0) then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do mu =0,3
                  cz1278(i1,i2,i3,i4,mu)= cz1278(i1,i2,i3,i4,mu)
     &             +ch12(i1,i2)*cz78(i3,i4)%e(mu)*rmz/sw/rcw
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
* rmh < 0 in our convention means no higgs coupling                     
      if(id7.eq.5.and.rmh.ge.0.d0) then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do mu =0,3
                  cz1278(i1,i2,i3,i4,mu)= cz1278(i1,i2,i3,i4,mu)
     &             +ch78(i3,i4)*cz12(i1,i2)%e(mu)*rmz/sw/rcw
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
* rmh < 0 in our convention means no higgs coupling                     
      if(id3.eq.5.and.rmh.ge.0.d0) then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do mu =0,3
                  cz3456(i1,i2,i3,i4,mu)= cz3456(i1,i2,i3,i4,mu)
     &             +ch34(i1,i2)*cz56(i3,i4)%e(mu)*rmz/sw/rcw
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
* rmh < 0 in our convention means no higgs coupling                     
      if(id5.eq.5.and.rmh.ge.0.d0) then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do mu =0,3
                  cz3456(i1,i2,i3,i4,mu)= cz3456(i1,i2,i3,i4,mu)
     &             +ch56(i3,i4)*cz34(i1,i2)%e(mu)*rmz/sw/rcw
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
  
  
* COMPUTE ALL SUBDIAGRAMS WITH A HIGGS "DECAYING" TO 4 FERMIONS         
*  WHICH CORRESPOND TO TWO Z's                                          
*                                                                       
*                   _____ i                                             
*                  |  |__ j                                             
*             --h--|  |__ k                                             
*                  |__|__ l                                             
*                                                                       
*                  ch1234(i1,i2,i3,i4) con t aux clineth(2,2)           
*INITIALIZATION                                                         
  
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              ch1234(i1,i2,i3,i4)=czero
              ch1256(i1,i2,i3,i4)=czero
              ch1278(i1,i2,i3,i4)=czero
              ch5678(i1,i2,i3,i4)=czero
              ch3478(i1,i2,i3,i4)=czero
              ch3456(i1,i2,i3,i4)=czero
            enddo
           enddo
          enddo
         enddo
  
*                                                                       
*    First all diagrams of the type                                     
*                                                                       
*                   |_Z,f,h__/                                          
*              _h___|        \                                          
*                   |                                                   
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.rmh.ge.0.d0) then
      do i3=1,2
      do i4=1,2
* TsTSC -- aa=clineth_4f(i3,i4)%a,bb=clineth_4f(i3,i4)%b,cc=clineth_4f(i
* 3,i4)%c,dd=clineth_4f(i3,i4)%d,a1=l1_34(i3,i4)%a,b1=l1_34(i3,i4)%b,c1=
* l1_34(i3,i4)%c,d1=l1_34(i3,i4)%d,a2=rh2_134%a,b2=rh2_134%b,c2=rh2_134%
* c,prq=p134q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=l1_34(i3,i4)%a(iut,1)+l1_34(i3,i4)%c(iut,1)*rmass(id1)
      cx2=l1_34(i3,i4)%c(iut,2)*p134q+l1_34(i3,i4)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_34(i3,i4)%b(iut,1)+l1_34(i3,i4)%d(iut,1)*rmass(id1)
      cy2=l1_34(i3,i4)%d(iut,2)*p134q+l1_34(i3,i4)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_34(i3,i4)%c(iut,1)*p134q+l1_34(i3,i4)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_34(i3,i4)%a(iut,2)+l1_34(i3,i4)%c(iut,2)*rmass(id1)
      cz1=l1_34(i3,i4)%d(iut,1)*p134q+l1_34(i3,i4)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_34(i3,i4)%b(iut,2)+l1_34(i3,i4)%d(iut,2)*rmass(id1)
      clineth_4f(i3,i4)%a(iut,2)=cx1*rh2_134%a(1,2)+cx2*rh2_134%
     & b(2,2)
      clineth_4f(i3,i4)%b(iut,2)=cy1*rh2_134%a(1,2)+cy2*rh2_134%
     & b(2,2)
      clineth_4f(i3,i4)%c(iut,2)=cw2*rh2_134%c(2,2)
      clineth_4f(i3,i4)%d(iut,2)=cz2*rh2_134%c(2,2)
      clineth_4f(i3,i4)%a(iut,1)=cw1*rh2_134%b(1,1)+cw2*rh2_134%
     & a(2,1)
      clineth_4f(i3,i4)%b(iut,1)=cz1*rh2_134%b(1,1)+cz2*rh2_134%
     & a(2,1)
      clineth_4f(i3,i4)%c(iut,1)=cx1*rh2_134%c(1,1)
      clineth_4f(i3,i4)%d(iut,1)=cy1*rh2_134%c(1,1)
      end do
      end do
      end do
  
  
*    Then those of the type                                             
*                                                                       
*              _h___|                                                   
*                   |_Z,f,h__/                                          
*                   |        \                                          
*                                                                       
  
      do i3=1,2
      do i4=1,2
* TSCTs -- aa=clineth_4f(i3,i4)%a,bb=clineth_4f(i3,i4)%b,cc=clineth_4f(i
* 3,i4)%c,dd=clineth_4f(i3,i4)%d,a1=lh1_234%a,b1=lh1_234%b,c1=lh1_234%c,
* a2=r2_34(i3,i4)%a,b2=r2_34(i3,i4)%b,c2=r2_34(i3,i4)%c,d2=r2_34(i3,i4)%
* d,prq=p234q,m=rmass(id1),nsum=1
      do jut=1,2
      cx1=r2_34(i3,i4)%a(1,jut)+rmass(id1)*r2_34(i3,i4)%b(1,jut)
      cx2=r2_34(i3,i4)%a(2,jut)+rmass(id1)*r2_34(i3,i4)%b(2,jut)
      cy1=p234q*r2_34(i3,i4)%b(1,jut)+rmass(id1)*r2_34(i3,i4)%a(
     & 1,jut)
      cy2=p234q*r2_34(i3,i4)%b(2,jut)+rmass(id1)*r2_34(i3,i4)%a(
     & 2,jut)
      cw1=r2_34(i3,i4)%c(1,jut)+rmass(id1)*r2_34(i3,i4)%d(1,jut)
      cw2=r2_34(i3,i4)%c(2,jut)+rmass(id1)*r2_34(i3,i4)%d(2,jut)
      cz1=p234q*r2_34(i3,i4)%d(1,jut)+rmass(id1)*r2_34(i3,i4)%c(
     & 1,jut)
      cz2=p234q*r2_34(i3,i4)%d(2,jut)+rmass(id1)*r2_34(i3,i4)%c(
     & 2,jut)
      clineth_4f(i3,i4)%a(2,jut)=clineth_4f(i3,i4)%a(2,jut)+lh1_
     & 234%a(2,1)*cx1+lh1_234%c(2,2)*cy2
      clineth_4f(i3,i4)%b(2,jut)=clineth_4f(i3,i4)%b(2,jut)+lh1_
     & 234%b(2,2)*cx2
      clineth_4f(i3,i4)%c(2,jut)=clineth_4f(i3,i4)%c(2,jut)+lh1_
     & 234%a(2,1)*cw1+lh1_234%c(2,2)*cz2
      clineth_4f(i3,i4)%d(2,jut)=clineth_4f(i3,i4)%d(2,jut)+lh1_
     & 234%b(2,2)*cw2
      clineth_4f(i3,i4)%a(1,jut)=clineth_4f(i3,i4)%a(1,jut)+lh1_
     & 234%c(1,1)*cy1+lh1_234%a(1,2)*cx2
      clineth_4f(i3,i4)%b(1,jut)=clineth_4f(i3,i4)%b(1,jut)+lh1_
     & 234%b(1,1)*cx1
      clineth_4f(i3,i4)%c(1,jut)=clineth_4f(i3,i4)%c(1,jut)+lh1_
     & 234%c(1,1)*cz1+lh1_234%a(1,2)*cw2
      clineth_4f(i3,i4)%d(1,jut)=clineth_4f(i3,i4)%d(1,jut)+lh1_
     & 234%b(1,1)*cw1
      end do
      end do
      end do
  
  
  
  
        rmassl=rmass(id1)
        rmassr=-rmassl
  
  
      do i3=1,2
      do i4=1,2
* mline -- res=ch1234(&1,&2,i3,i4),abcd=clineth_4f(i3,i4)%,m1=rmassl,m2=
* rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      ch1234(iut,jut,i3,i4)=clineth_4f(i3,i4)%a(iut,jut)+rmassl*
     & clineth_4f(i3,i4)%b(iut,jut)+rmassr*clineth_4f(i3,i4)%c(i
     & ut,jut)+rmassl*rmassr*clineth_4f(i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
  
  
  
      endif
*                                                                       
*    First all diagrams of the type                                     
*                                                                       
*                   |_Z,f,h__/                                          
*              _h___|        \                                          
*                   |                                                   
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.rmh.ge.0.d0) then
      do i1=1,2
      do i2=1,2
* TsTSC -- aa=clineth_4f(i1,i2)%a,bb=clineth_4f(i1,i2)%b,cc=clineth_4f(i
* 1,i2)%c,dd=clineth_4f(i1,i2)%d,a1=l3_12(i1,i2)%a,b1=l3_12(i1,i2)%b,c1=
* l3_12(i1,i2)%c,d1=l3_12(i1,i2)%d,a2=rh4_312%a,b2=rh4_312%b,c2=rh4_312%
* c,prq=p312q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=l3_12(i1,i2)%a(iut,1)+l3_12(i1,i2)%c(iut,1)*rmass(id3)
      cx2=l3_12(i1,i2)%c(iut,2)*p312q+l3_12(i1,i2)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_12(i1,i2)%b(iut,1)+l3_12(i1,i2)%d(iut,1)*rmass(id3)
      cy2=l3_12(i1,i2)%d(iut,2)*p312q+l3_12(i1,i2)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_12(i1,i2)%c(iut,1)*p312q+l3_12(i1,i2)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_12(i1,i2)%a(iut,2)+l3_12(i1,i2)%c(iut,2)*rmass(id3)
      cz1=l3_12(i1,i2)%d(iut,1)*p312q+l3_12(i1,i2)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_12(i1,i2)%b(iut,2)+l3_12(i1,i2)%d(iut,2)*rmass(id3)
      clineth_4f(i1,i2)%a(iut,2)=cx1*rh4_312%a(1,2)+cx2*rh4_312%
     & b(2,2)
      clineth_4f(i1,i2)%b(iut,2)=cy1*rh4_312%a(1,2)+cy2*rh4_312%
     & b(2,2)
      clineth_4f(i1,i2)%c(iut,2)=cw2*rh4_312%c(2,2)
      clineth_4f(i1,i2)%d(iut,2)=cz2*rh4_312%c(2,2)
      clineth_4f(i1,i2)%a(iut,1)=cw1*rh4_312%b(1,1)+cw2*rh4_312%
     & a(2,1)
      clineth_4f(i1,i2)%b(iut,1)=cz1*rh4_312%b(1,1)+cz2*rh4_312%
     & a(2,1)
      clineth_4f(i1,i2)%c(iut,1)=cx1*rh4_312%c(1,1)
      clineth_4f(i1,i2)%d(iut,1)=cy1*rh4_312%c(1,1)
      end do
      end do
      end do
  
  
*    Then those of the type                                             
*                                                                       
*              _h___|                                                   
*                   |_Z,f,h__/                                          
*                   |        \                                          
*                                                                       
  
      do i1=1,2
      do i2=1,2
* TSCTs -- aa=clineth_4f(i1,i2)%a,bb=clineth_4f(i1,i2)%b,cc=clineth_4f(i
* 1,i2)%c,dd=clineth_4f(i1,i2)%d,a1=lh3_412%a,b1=lh3_412%b,c1=lh3_412%c,
* a2=r4_12(i1,i2)%a,b2=r4_12(i1,i2)%b,c2=r4_12(i1,i2)%c,d2=r4_12(i1,i2)%
* d,prq=p412q,m=rmass(id3),nsum=1
      do jut=1,2
      cx1=r4_12(i1,i2)%a(1,jut)+rmass(id3)*r4_12(i1,i2)%b(1,jut)
      cx2=r4_12(i1,i2)%a(2,jut)+rmass(id3)*r4_12(i1,i2)%b(2,jut)
      cy1=p412q*r4_12(i1,i2)%b(1,jut)+rmass(id3)*r4_12(i1,i2)%a(
     & 1,jut)
      cy2=p412q*r4_12(i1,i2)%b(2,jut)+rmass(id3)*r4_12(i1,i2)%a(
     & 2,jut)
      cw1=r4_12(i1,i2)%c(1,jut)+rmass(id3)*r4_12(i1,i2)%d(1,jut)
      cw2=r4_12(i1,i2)%c(2,jut)+rmass(id3)*r4_12(i1,i2)%d(2,jut)
      cz1=p412q*r4_12(i1,i2)%d(1,jut)+rmass(id3)*r4_12(i1,i2)%c(
     & 1,jut)
      cz2=p412q*r4_12(i1,i2)%d(2,jut)+rmass(id3)*r4_12(i1,i2)%c(
     & 2,jut)
      clineth_4f(i1,i2)%a(2,jut)=clineth_4f(i1,i2)%a(2,jut)+lh3_
     & 412%a(2,1)*cx1+lh3_412%c(2,2)*cy2
      clineth_4f(i1,i2)%b(2,jut)=clineth_4f(i1,i2)%b(2,jut)+lh3_
     & 412%b(2,2)*cx2
      clineth_4f(i1,i2)%c(2,jut)=clineth_4f(i1,i2)%c(2,jut)+lh3_
     & 412%a(2,1)*cw1+lh3_412%c(2,2)*cz2
      clineth_4f(i1,i2)%d(2,jut)=clineth_4f(i1,i2)%d(2,jut)+lh3_
     & 412%b(2,2)*cw2
      clineth_4f(i1,i2)%a(1,jut)=clineth_4f(i1,i2)%a(1,jut)+lh3_
     & 412%c(1,1)*cy1+lh3_412%a(1,2)*cx2
      clineth_4f(i1,i2)%b(1,jut)=clineth_4f(i1,i2)%b(1,jut)+lh3_
     & 412%b(1,1)*cx1
      clineth_4f(i1,i2)%c(1,jut)=clineth_4f(i1,i2)%c(1,jut)+lh3_
     & 412%c(1,1)*cz1+lh3_412%a(1,2)*cw2
      clineth_4f(i1,i2)%d(1,jut)=clineth_4f(i1,i2)%d(1,jut)+lh3_
     & 412%b(1,1)*cw1
      end do
      end do
      end do
  
  
  
  
        rmassl=rmass(id3)
        rmassr=-rmassl
  
  
  
  
      do i1=1,2
      do i2=1,2
* mline -- res=ch1234(i1,i2,&1,&2),abcd=clineth_4f(i1,i2)%,m1=rmassl,m2=
* rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      ch1234(i1,i2,iut,jut)=ch1234(i1,i2,iut,jut)+clineth_4f(i1,
     & i2)%a(iut,jut)+rmassl*clineth_4f(i1,i2)%b(iut,jut)+rmassr
     & *clineth_4f(i1,i2)%c(iut,jut)+rmassl*rmassr*clineth_4f(i1
     & ,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
  
      endif
*                                                                       
*    First all diagrams of the type                                     
*                                                                       
*                   |_Z,f,h__/                                          
*              _h___|        \                                          
*                   |                                                   
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.rmh.ge.0.d0) then
      do i7=1,2
      do i8=1,2
* TsTSC -- aa=clineth_4f(i7,i8)%a,bb=clineth_4f(i7,i8)%b,cc=clineth_4f(i
* 7,i8)%c,dd=clineth_4f(i7,i8)%d,a1=l5_78(i7,i8)%a,b1=l5_78(i7,i8)%b,c1=
* l5_78(i7,i8)%c,d1=l5_78(i7,i8)%d,a2=rh6_578%a,b2=rh6_578%b,c2=rh6_578%
* c,prq=p578q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=l5_78(i7,i8)%a(iut,1)+l5_78(i7,i8)%c(iut,1)*rmass(id5)
      cx2=l5_78(i7,i8)%c(iut,2)*p578q+l5_78(i7,i8)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_78(i7,i8)%b(iut,1)+l5_78(i7,i8)%d(iut,1)*rmass(id5)
      cy2=l5_78(i7,i8)%d(iut,2)*p578q+l5_78(i7,i8)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_78(i7,i8)%c(iut,1)*p578q+l5_78(i7,i8)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_78(i7,i8)%a(iut,2)+l5_78(i7,i8)%c(iut,2)*rmass(id5)
      cz1=l5_78(i7,i8)%d(iut,1)*p578q+l5_78(i7,i8)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_78(i7,i8)%b(iut,2)+l5_78(i7,i8)%d(iut,2)*rmass(id5)
      clineth_4f(i7,i8)%a(iut,2)=cx1*rh6_578%a(1,2)+cx2*rh6_578%
     & b(2,2)
      clineth_4f(i7,i8)%b(iut,2)=cy1*rh6_578%a(1,2)+cy2*rh6_578%
     & b(2,2)
      clineth_4f(i7,i8)%c(iut,2)=cw2*rh6_578%c(2,2)
      clineth_4f(i7,i8)%d(iut,2)=cz2*rh6_578%c(2,2)
      clineth_4f(i7,i8)%a(iut,1)=cw1*rh6_578%b(1,1)+cw2*rh6_578%
     & a(2,1)
      clineth_4f(i7,i8)%b(iut,1)=cz1*rh6_578%b(1,1)+cz2*rh6_578%
     & a(2,1)
      clineth_4f(i7,i8)%c(iut,1)=cx1*rh6_578%c(1,1)
      clineth_4f(i7,i8)%d(iut,1)=cy1*rh6_578%c(1,1)
      end do
      end do
      end do
  
  
*    Then those of the type                                             
*                                                                       
*              _h___|                                                   
*                   |_Z,f,h__/                                          
*                   |        \                                          
*                                                                       
  
      do i7=1,2
      do i8=1,2
* TSCTs -- aa=clineth_4f(i7,i8)%a,bb=clineth_4f(i7,i8)%b,cc=clineth_4f(i
* 7,i8)%c,dd=clineth_4f(i7,i8)%d,a1=lh5_678%a,b1=lh5_678%b,c1=lh5_678%c,
* a2=r6_78(i7,i8)%a,b2=r6_78(i7,i8)%b,c2=r6_78(i7,i8)%c,d2=r6_78(i7,i8)%
* d,prq=p678q,m=rmass(id5),nsum=1
      do jut=1,2
      cx1=r6_78(i7,i8)%a(1,jut)+rmass(id5)*r6_78(i7,i8)%b(1,jut)
      cx2=r6_78(i7,i8)%a(2,jut)+rmass(id5)*r6_78(i7,i8)%b(2,jut)
      cy1=p678q*r6_78(i7,i8)%b(1,jut)+rmass(id5)*r6_78(i7,i8)%a(
     & 1,jut)
      cy2=p678q*r6_78(i7,i8)%b(2,jut)+rmass(id5)*r6_78(i7,i8)%a(
     & 2,jut)
      cw1=r6_78(i7,i8)%c(1,jut)+rmass(id5)*r6_78(i7,i8)%d(1,jut)
      cw2=r6_78(i7,i8)%c(2,jut)+rmass(id5)*r6_78(i7,i8)%d(2,jut)
      cz1=p678q*r6_78(i7,i8)%d(1,jut)+rmass(id5)*r6_78(i7,i8)%c(
     & 1,jut)
      cz2=p678q*r6_78(i7,i8)%d(2,jut)+rmass(id5)*r6_78(i7,i8)%c(
     & 2,jut)
      clineth_4f(i7,i8)%a(2,jut)=clineth_4f(i7,i8)%a(2,jut)+lh5_
     & 678%a(2,1)*cx1+lh5_678%c(2,2)*cy2
      clineth_4f(i7,i8)%b(2,jut)=clineth_4f(i7,i8)%b(2,jut)+lh5_
     & 678%b(2,2)*cx2
      clineth_4f(i7,i8)%c(2,jut)=clineth_4f(i7,i8)%c(2,jut)+lh5_
     & 678%a(2,1)*cw1+lh5_678%c(2,2)*cz2
      clineth_4f(i7,i8)%d(2,jut)=clineth_4f(i7,i8)%d(2,jut)+lh5_
     & 678%b(2,2)*cw2
      clineth_4f(i7,i8)%a(1,jut)=clineth_4f(i7,i8)%a(1,jut)+lh5_
     & 678%c(1,1)*cy1+lh5_678%a(1,2)*cx2
      clineth_4f(i7,i8)%b(1,jut)=clineth_4f(i7,i8)%b(1,jut)+lh5_
     & 678%b(1,1)*cx1
      clineth_4f(i7,i8)%c(1,jut)=clineth_4f(i7,i8)%c(1,jut)+lh5_
     & 678%c(1,1)*cz1+lh5_678%a(1,2)*cw2
      clineth_4f(i7,i8)%d(1,jut)=clineth_4f(i7,i8)%d(1,jut)+lh5_
     & 678%b(1,1)*cw1
      end do
      end do
      end do
  
  
  
  
        rmassl=rmass(id5)
        rmassr=-rmassl
  
  
      do i3=1,2
      do i4=1,2
* mline -- res=ch5678(&1,&2,i3,i4),abcd=clineth_4f(i3,i4)%,m1=rmassl,m2=
* rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      ch5678(iut,jut,i3,i4)=clineth_4f(i3,i4)%a(iut,jut)+rmassl*
     & clineth_4f(i3,i4)%b(iut,jut)+rmassr*clineth_4f(i3,i4)%c(i
     & ut,jut)+rmassl*rmassr*clineth_4f(i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
  
  
  
      endif
*                                                                       
*    First all diagrams of the type                                     
*                                                                       
*                   |_Z,f,h__/                                          
*              _h___|        \                                          
*                   |                                                   
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id7.eq.5.and.rmh.ge.0.d0) then
      do i5=1,2
      do i6=1,2
* TsTSC -- aa=clineth_4f(i5,i6)%a,bb=clineth_4f(i5,i6)%b,cc=clineth_4f(i
* 5,i6)%c,dd=clineth_4f(i5,i6)%d,a1=l7_56(i5,i6)%a,b1=l7_56(i5,i6)%b,c1=
* l7_56(i5,i6)%c,d1=l7_56(i5,i6)%d,a2=rh8_756%a,b2=rh8_756%b,c2=rh8_756%
* c,prq=p756q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=l7_56(i5,i6)%a(iut,1)+l7_56(i5,i6)%c(iut,1)*rmass(id7)
      cx2=l7_56(i5,i6)%c(iut,2)*p756q+l7_56(i5,i6)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_56(i5,i6)%b(iut,1)+l7_56(i5,i6)%d(iut,1)*rmass(id7)
      cy2=l7_56(i5,i6)%d(iut,2)*p756q+l7_56(i5,i6)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_56(i5,i6)%c(iut,1)*p756q+l7_56(i5,i6)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_56(i5,i6)%a(iut,2)+l7_56(i5,i6)%c(iut,2)*rmass(id7)
      cz1=l7_56(i5,i6)%d(iut,1)*p756q+l7_56(i5,i6)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_56(i5,i6)%b(iut,2)+l7_56(i5,i6)%d(iut,2)*rmass(id7)
      clineth_4f(i5,i6)%a(iut,2)=cx1*rh8_756%a(1,2)+cx2*rh8_756%
     & b(2,2)
      clineth_4f(i5,i6)%b(iut,2)=cy1*rh8_756%a(1,2)+cy2*rh8_756%
     & b(2,2)
      clineth_4f(i5,i6)%c(iut,2)=cw2*rh8_756%c(2,2)
      clineth_4f(i5,i6)%d(iut,2)=cz2*rh8_756%c(2,2)
      clineth_4f(i5,i6)%a(iut,1)=cw1*rh8_756%b(1,1)+cw2*rh8_756%
     & a(2,1)
      clineth_4f(i5,i6)%b(iut,1)=cz1*rh8_756%b(1,1)+cz2*rh8_756%
     & a(2,1)
      clineth_4f(i5,i6)%c(iut,1)=cx1*rh8_756%c(1,1)
      clineth_4f(i5,i6)%d(iut,1)=cy1*rh8_756%c(1,1)
      end do
      end do
      end do
  
  
*    Then those of the type                                             
*                                                                       
*              _h___|                                                   
*                   |_Z,f,h__/                                          
*                   |        \                                          
*                                                                       
  
      do i5=1,2
      do i6=1,2
* TSCTs -- aa=clineth_4f(i5,i6)%a,bb=clineth_4f(i5,i6)%b,cc=clineth_4f(i
* 5,i6)%c,dd=clineth_4f(i5,i6)%d,a1=lh7_856%a,b1=lh7_856%b,c1=lh7_856%c,
* a2=r8_56(i5,i6)%a,b2=r8_56(i5,i6)%b,c2=r8_56(i5,i6)%c,d2=r8_56(i5,i6)%
* d,prq=p856q,m=rmass(id7),nsum=1
      do jut=1,2
      cx1=r8_56(i5,i6)%a(1,jut)+rmass(id7)*r8_56(i5,i6)%b(1,jut)
      cx2=r8_56(i5,i6)%a(2,jut)+rmass(id7)*r8_56(i5,i6)%b(2,jut)
      cy1=p856q*r8_56(i5,i6)%b(1,jut)+rmass(id7)*r8_56(i5,i6)%a(
     & 1,jut)
      cy2=p856q*r8_56(i5,i6)%b(2,jut)+rmass(id7)*r8_56(i5,i6)%a(
     & 2,jut)
      cw1=r8_56(i5,i6)%c(1,jut)+rmass(id7)*r8_56(i5,i6)%d(1,jut)
      cw2=r8_56(i5,i6)%c(2,jut)+rmass(id7)*r8_56(i5,i6)%d(2,jut)
      cz1=p856q*r8_56(i5,i6)%d(1,jut)+rmass(id7)*r8_56(i5,i6)%c(
     & 1,jut)
      cz2=p856q*r8_56(i5,i6)%d(2,jut)+rmass(id7)*r8_56(i5,i6)%c(
     & 2,jut)
      clineth_4f(i5,i6)%a(2,jut)=clineth_4f(i5,i6)%a(2,jut)+lh7_
     & 856%a(2,1)*cx1+lh7_856%c(2,2)*cy2
      clineth_4f(i5,i6)%b(2,jut)=clineth_4f(i5,i6)%b(2,jut)+lh7_
     & 856%b(2,2)*cx2
      clineth_4f(i5,i6)%c(2,jut)=clineth_4f(i5,i6)%c(2,jut)+lh7_
     & 856%a(2,1)*cw1+lh7_856%c(2,2)*cz2
      clineth_4f(i5,i6)%d(2,jut)=clineth_4f(i5,i6)%d(2,jut)+lh7_
     & 856%b(2,2)*cw2
      clineth_4f(i5,i6)%a(1,jut)=clineth_4f(i5,i6)%a(1,jut)+lh7_
     & 856%c(1,1)*cy1+lh7_856%a(1,2)*cx2
      clineth_4f(i5,i6)%b(1,jut)=clineth_4f(i5,i6)%b(1,jut)+lh7_
     & 856%b(1,1)*cx1
      clineth_4f(i5,i6)%c(1,jut)=clineth_4f(i5,i6)%c(1,jut)+lh7_
     & 856%c(1,1)*cz1+lh7_856%a(1,2)*cw2
      clineth_4f(i5,i6)%d(1,jut)=clineth_4f(i5,i6)%d(1,jut)+lh7_
     & 856%b(1,1)*cw1
      end do
      end do
      end do
  
  
  
  
        rmassl=rmass(id7)
        rmassr=-rmassl
  
  
  
  
      do i1=1,2
      do i2=1,2
* mline -- res=ch5678(i1,i2,&1,&2),abcd=clineth_4f(i1,i2)%,m1=rmassl,m2=
* rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      ch5678(i1,i2,iut,jut)=ch5678(i1,i2,iut,jut)+clineth_4f(i1,
     & i2)%a(iut,jut)+rmassl*clineth_4f(i1,i2)%b(iut,jut)+rmassr
     & *clineth_4f(i1,i2)%c(iut,jut)+rmassl*rmassr*clineth_4f(i1
     & ,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
  
      endif
*                                                                       
*    First all diagrams of the type                                     
*                                                                       
*                   |_Z,f,h__/                                          
*              _h___|        \                                          
*                   |                                                   
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.rmh.ge.0.d0) then
      do i5=1,2
      do i6=1,2
* TsTSC -- aa=clineth_4f(i5,i6)%a,bb=clineth_4f(i5,i6)%b,cc=clineth_4f(i
* 5,i6)%c,dd=clineth_4f(i5,i6)%d,a1=l1_56(i5,i6)%a,b1=l1_56(i5,i6)%b,c1=
* l1_56(i5,i6)%c,d1=l1_56(i5,i6)%d,a2=rh2_156%a,b2=rh2_156%b,c2=rh2_156%
* c,prq=p156q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=l1_56(i5,i6)%a(iut,1)+l1_56(i5,i6)%c(iut,1)*rmass(id1)
      cx2=l1_56(i5,i6)%c(iut,2)*p156q+l1_56(i5,i6)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_56(i5,i6)%b(iut,1)+l1_56(i5,i6)%d(iut,1)*rmass(id1)
      cy2=l1_56(i5,i6)%d(iut,2)*p156q+l1_56(i5,i6)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_56(i5,i6)%c(iut,1)*p156q+l1_56(i5,i6)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_56(i5,i6)%a(iut,2)+l1_56(i5,i6)%c(iut,2)*rmass(id1)
      cz1=l1_56(i5,i6)%d(iut,1)*p156q+l1_56(i5,i6)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_56(i5,i6)%b(iut,2)+l1_56(i5,i6)%d(iut,2)*rmass(id1)
      clineth_4f(i5,i6)%a(iut,2)=cx1*rh2_156%a(1,2)+cx2*rh2_156%
     & b(2,2)
      clineth_4f(i5,i6)%b(iut,2)=cy1*rh2_156%a(1,2)+cy2*rh2_156%
     & b(2,2)
      clineth_4f(i5,i6)%c(iut,2)=cw2*rh2_156%c(2,2)
      clineth_4f(i5,i6)%d(iut,2)=cz2*rh2_156%c(2,2)
      clineth_4f(i5,i6)%a(iut,1)=cw1*rh2_156%b(1,1)+cw2*rh2_156%
     & a(2,1)
      clineth_4f(i5,i6)%b(iut,1)=cz1*rh2_156%b(1,1)+cz2*rh2_156%
     & a(2,1)
      clineth_4f(i5,i6)%c(iut,1)=cx1*rh2_156%c(1,1)
      clineth_4f(i5,i6)%d(iut,1)=cy1*rh2_156%c(1,1)
      end do
      end do
      end do
  
  
*    Then those of the type                                             
*                                                                       
*              _h___|                                                   
*                   |_Z,f,h__/                                          
*                   |        \                                          
*                                                                       
  
      do i5=1,2
      do i6=1,2
* TSCTs -- aa=clineth_4f(i5,i6)%a,bb=clineth_4f(i5,i6)%b,cc=clineth_4f(i
* 5,i6)%c,dd=clineth_4f(i5,i6)%d,a1=lh1_256%a,b1=lh1_256%b,c1=lh1_256%c,
* a2=r2_56(i5,i6)%a,b2=r2_56(i5,i6)%b,c2=r2_56(i5,i6)%c,d2=r2_56(i5,i6)%
* d,prq=p256q,m=rmass(id1),nsum=1
      do jut=1,2
      cx1=r2_56(i5,i6)%a(1,jut)+rmass(id1)*r2_56(i5,i6)%b(1,jut)
      cx2=r2_56(i5,i6)%a(2,jut)+rmass(id1)*r2_56(i5,i6)%b(2,jut)
      cy1=p256q*r2_56(i5,i6)%b(1,jut)+rmass(id1)*r2_56(i5,i6)%a(
     & 1,jut)
      cy2=p256q*r2_56(i5,i6)%b(2,jut)+rmass(id1)*r2_56(i5,i6)%a(
     & 2,jut)
      cw1=r2_56(i5,i6)%c(1,jut)+rmass(id1)*r2_56(i5,i6)%d(1,jut)
      cw2=r2_56(i5,i6)%c(2,jut)+rmass(id1)*r2_56(i5,i6)%d(2,jut)
      cz1=p256q*r2_56(i5,i6)%d(1,jut)+rmass(id1)*r2_56(i5,i6)%c(
     & 1,jut)
      cz2=p256q*r2_56(i5,i6)%d(2,jut)+rmass(id1)*r2_56(i5,i6)%c(
     & 2,jut)
      clineth_4f(i5,i6)%a(2,jut)=clineth_4f(i5,i6)%a(2,jut)+lh1_
     & 256%a(2,1)*cx1+lh1_256%c(2,2)*cy2
      clineth_4f(i5,i6)%b(2,jut)=clineth_4f(i5,i6)%b(2,jut)+lh1_
     & 256%b(2,2)*cx2
      clineth_4f(i5,i6)%c(2,jut)=clineth_4f(i5,i6)%c(2,jut)+lh1_
     & 256%a(2,1)*cw1+lh1_256%c(2,2)*cz2
      clineth_4f(i5,i6)%d(2,jut)=clineth_4f(i5,i6)%d(2,jut)+lh1_
     & 256%b(2,2)*cw2
      clineth_4f(i5,i6)%a(1,jut)=clineth_4f(i5,i6)%a(1,jut)+lh1_
     & 256%c(1,1)*cy1+lh1_256%a(1,2)*cx2
      clineth_4f(i5,i6)%b(1,jut)=clineth_4f(i5,i6)%b(1,jut)+lh1_
     & 256%b(1,1)*cx1
      clineth_4f(i5,i6)%c(1,jut)=clineth_4f(i5,i6)%c(1,jut)+lh1_
     & 256%c(1,1)*cz1+lh1_256%a(1,2)*cw2
      clineth_4f(i5,i6)%d(1,jut)=clineth_4f(i5,i6)%d(1,jut)+lh1_
     & 256%b(1,1)*cw1
      end do
      end do
      end do
  
  
  
  
        rmassl=rmass(id1)
        rmassr=-rmassl
  
  
      do i3=1,2
      do i4=1,2
* mline -- res=ch1256(&1,&2,i3,i4),abcd=clineth_4f(i3,i4)%,m1=rmassl,m2=
* rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      ch1256(iut,jut,i3,i4)=clineth_4f(i3,i4)%a(iut,jut)+rmassl*
     & clineth_4f(i3,i4)%b(iut,jut)+rmassr*clineth_4f(i3,i4)%c(i
     & ut,jut)+rmassl*rmassr*clineth_4f(i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
  
  
  
      endif
*                                                                       
*    First all diagrams of the type                                     
*                                                                       
*                   |_Z,f,h__/                                          
*              _h___|        \                                          
*                   |                                                   
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.rmh.ge.0.d0) then
      do i1=1,2
      do i2=1,2
* TsTSC -- aa=clineth_4f(i1,i2)%a,bb=clineth_4f(i1,i2)%b,cc=clineth_4f(i
* 1,i2)%c,dd=clineth_4f(i1,i2)%d,a1=l5_12(i1,i2)%a,b1=l5_12(i1,i2)%b,c1=
* l5_12(i1,i2)%c,d1=l5_12(i1,i2)%d,a2=rh6_512%a,b2=rh6_512%b,c2=rh6_512%
* c,prq=p512q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=l5_12(i1,i2)%a(iut,1)+l5_12(i1,i2)%c(iut,1)*rmass(id5)
      cx2=l5_12(i1,i2)%c(iut,2)*p512q+l5_12(i1,i2)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_12(i1,i2)%b(iut,1)+l5_12(i1,i2)%d(iut,1)*rmass(id5)
      cy2=l5_12(i1,i2)%d(iut,2)*p512q+l5_12(i1,i2)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_12(i1,i2)%c(iut,1)*p512q+l5_12(i1,i2)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_12(i1,i2)%a(iut,2)+l5_12(i1,i2)%c(iut,2)*rmass(id5)
      cz1=l5_12(i1,i2)%d(iut,1)*p512q+l5_12(i1,i2)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_12(i1,i2)%b(iut,2)+l5_12(i1,i2)%d(iut,2)*rmass(id5)
      clineth_4f(i1,i2)%a(iut,2)=cx1*rh6_512%a(1,2)+cx2*rh6_512%
     & b(2,2)
      clineth_4f(i1,i2)%b(iut,2)=cy1*rh6_512%a(1,2)+cy2*rh6_512%
     & b(2,2)
      clineth_4f(i1,i2)%c(iut,2)=cw2*rh6_512%c(2,2)
      clineth_4f(i1,i2)%d(iut,2)=cz2*rh6_512%c(2,2)
      clineth_4f(i1,i2)%a(iut,1)=cw1*rh6_512%b(1,1)+cw2*rh6_512%
     & a(2,1)
      clineth_4f(i1,i2)%b(iut,1)=cz1*rh6_512%b(1,1)+cz2*rh6_512%
     & a(2,1)
      clineth_4f(i1,i2)%c(iut,1)=cx1*rh6_512%c(1,1)
      clineth_4f(i1,i2)%d(iut,1)=cy1*rh6_512%c(1,1)
      end do
      end do
      end do
  
  
*    Then those of the type                                             
*                                                                       
*              _h___|                                                   
*                   |_Z,f,h__/                                          
*                   |        \                                          
*                                                                       
  
      do i1=1,2
      do i2=1,2
* TSCTs -- aa=clineth_4f(i1,i2)%a,bb=clineth_4f(i1,i2)%b,cc=clineth_4f(i
* 1,i2)%c,dd=clineth_4f(i1,i2)%d,a1=lh5_612%a,b1=lh5_612%b,c1=lh5_612%c,
* a2=r6_12(i1,i2)%a,b2=r6_12(i1,i2)%b,c2=r6_12(i1,i2)%c,d2=r6_12(i1,i2)%
* d,prq=p612q,m=rmass(id5),nsum=1
      do jut=1,2
      cx1=r6_12(i1,i2)%a(1,jut)+rmass(id5)*r6_12(i1,i2)%b(1,jut)
      cx2=r6_12(i1,i2)%a(2,jut)+rmass(id5)*r6_12(i1,i2)%b(2,jut)
      cy1=p612q*r6_12(i1,i2)%b(1,jut)+rmass(id5)*r6_12(i1,i2)%a(
     & 1,jut)
      cy2=p612q*r6_12(i1,i2)%b(2,jut)+rmass(id5)*r6_12(i1,i2)%a(
     & 2,jut)
      cw1=r6_12(i1,i2)%c(1,jut)+rmass(id5)*r6_12(i1,i2)%d(1,jut)
      cw2=r6_12(i1,i2)%c(2,jut)+rmass(id5)*r6_12(i1,i2)%d(2,jut)
      cz1=p612q*r6_12(i1,i2)%d(1,jut)+rmass(id5)*r6_12(i1,i2)%c(
     & 1,jut)
      cz2=p612q*r6_12(i1,i2)%d(2,jut)+rmass(id5)*r6_12(i1,i2)%c(
     & 2,jut)
      clineth_4f(i1,i2)%a(2,jut)=clineth_4f(i1,i2)%a(2,jut)+lh5_
     & 612%a(2,1)*cx1+lh5_612%c(2,2)*cy2
      clineth_4f(i1,i2)%b(2,jut)=clineth_4f(i1,i2)%b(2,jut)+lh5_
     & 612%b(2,2)*cx2
      clineth_4f(i1,i2)%c(2,jut)=clineth_4f(i1,i2)%c(2,jut)+lh5_
     & 612%a(2,1)*cw1+lh5_612%c(2,2)*cz2
      clineth_4f(i1,i2)%d(2,jut)=clineth_4f(i1,i2)%d(2,jut)+lh5_
     & 612%b(2,2)*cw2
      clineth_4f(i1,i2)%a(1,jut)=clineth_4f(i1,i2)%a(1,jut)+lh5_
     & 612%c(1,1)*cy1+lh5_612%a(1,2)*cx2
      clineth_4f(i1,i2)%b(1,jut)=clineth_4f(i1,i2)%b(1,jut)+lh5_
     & 612%b(1,1)*cx1
      clineth_4f(i1,i2)%c(1,jut)=clineth_4f(i1,i2)%c(1,jut)+lh5_
     & 612%c(1,1)*cz1+lh5_612%a(1,2)*cw2
      clineth_4f(i1,i2)%d(1,jut)=clineth_4f(i1,i2)%d(1,jut)+lh5_
     & 612%b(1,1)*cw1
      end do
      end do
      end do
  
  
  
  
        rmassl=rmass(id5)
        rmassr=-rmassl
  
  
  
  
      do i1=1,2
      do i2=1,2
* mline -- res=ch1256(i1,i2,&1,&2),abcd=clineth_4f(i1,i2)%,m1=rmassl,m2=
* rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      ch1256(i1,i2,iut,jut)=ch1256(i1,i2,iut,jut)+clineth_4f(i1,
     & i2)%a(iut,jut)+rmassl*clineth_4f(i1,i2)%b(iut,jut)+rmassr
     & *clineth_4f(i1,i2)%c(iut,jut)+rmassl*rmassr*clineth_4f(i1
     & ,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
  
      endif
*                                                                       
*    First all diagrams of the type                                     
*                                                                       
*                   |_Z,f,h__/                                          
*              _h___|        \                                          
*                   |                                                   
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.rmh.ge.0.d0) then
      do i7=1,2
      do i8=1,2
* TsTSC -- aa=clineth_4f(i7,i8)%a,bb=clineth_4f(i7,i8)%b,cc=clineth_4f(i
* 7,i8)%c,dd=clineth_4f(i7,i8)%d,a1=l3_78(i7,i8)%a,b1=l3_78(i7,i8)%b,c1=
* l3_78(i7,i8)%c,d1=l3_78(i7,i8)%d,a2=rh4_378%a,b2=rh4_378%b,c2=rh4_378%
* c,prq=p378q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=l3_78(i7,i8)%a(iut,1)+l3_78(i7,i8)%c(iut,1)*rmass(id3)
      cx2=l3_78(i7,i8)%c(iut,2)*p378q+l3_78(i7,i8)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_78(i7,i8)%b(iut,1)+l3_78(i7,i8)%d(iut,1)*rmass(id3)
      cy2=l3_78(i7,i8)%d(iut,2)*p378q+l3_78(i7,i8)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_78(i7,i8)%c(iut,1)*p378q+l3_78(i7,i8)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_78(i7,i8)%a(iut,2)+l3_78(i7,i8)%c(iut,2)*rmass(id3)
      cz1=l3_78(i7,i8)%d(iut,1)*p378q+l3_78(i7,i8)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_78(i7,i8)%b(iut,2)+l3_78(i7,i8)%d(iut,2)*rmass(id3)
      clineth_4f(i7,i8)%a(iut,2)=cx1*rh4_378%a(1,2)+cx2*rh4_378%
     & b(2,2)
      clineth_4f(i7,i8)%b(iut,2)=cy1*rh4_378%a(1,2)+cy2*rh4_378%
     & b(2,2)
      clineth_4f(i7,i8)%c(iut,2)=cw2*rh4_378%c(2,2)
      clineth_4f(i7,i8)%d(iut,2)=cz2*rh4_378%c(2,2)
      clineth_4f(i7,i8)%a(iut,1)=cw1*rh4_378%b(1,1)+cw2*rh4_378%
     & a(2,1)
      clineth_4f(i7,i8)%b(iut,1)=cz1*rh4_378%b(1,1)+cz2*rh4_378%
     & a(2,1)
      clineth_4f(i7,i8)%c(iut,1)=cx1*rh4_378%c(1,1)
      clineth_4f(i7,i8)%d(iut,1)=cy1*rh4_378%c(1,1)
      end do
      end do
      end do
  
  
*    Then those of the type                                             
*                                                                       
*              _h___|                                                   
*                   |_Z,f,h__/                                          
*                   |        \                                          
*                                                                       
  
      do i7=1,2
      do i8=1,2
* TSCTs -- aa=clineth_4f(i7,i8)%a,bb=clineth_4f(i7,i8)%b,cc=clineth_4f(i
* 7,i8)%c,dd=clineth_4f(i7,i8)%d,a1=lh3_478%a,b1=lh3_478%b,c1=lh3_478%c,
* a2=r4_78(i7,i8)%a,b2=r4_78(i7,i8)%b,c2=r4_78(i7,i8)%c,d2=r4_78(i7,i8)%
* d,prq=p478q,m=rmass(id3),nsum=1
      do jut=1,2
      cx1=r4_78(i7,i8)%a(1,jut)+rmass(id3)*r4_78(i7,i8)%b(1,jut)
      cx2=r4_78(i7,i8)%a(2,jut)+rmass(id3)*r4_78(i7,i8)%b(2,jut)
      cy1=p478q*r4_78(i7,i8)%b(1,jut)+rmass(id3)*r4_78(i7,i8)%a(
     & 1,jut)
      cy2=p478q*r4_78(i7,i8)%b(2,jut)+rmass(id3)*r4_78(i7,i8)%a(
     & 2,jut)
      cw1=r4_78(i7,i8)%c(1,jut)+rmass(id3)*r4_78(i7,i8)%d(1,jut)
      cw2=r4_78(i7,i8)%c(2,jut)+rmass(id3)*r4_78(i7,i8)%d(2,jut)
      cz1=p478q*r4_78(i7,i8)%d(1,jut)+rmass(id3)*r4_78(i7,i8)%c(
     & 1,jut)
      cz2=p478q*r4_78(i7,i8)%d(2,jut)+rmass(id3)*r4_78(i7,i8)%c(
     & 2,jut)
      clineth_4f(i7,i8)%a(2,jut)=clineth_4f(i7,i8)%a(2,jut)+lh3_
     & 478%a(2,1)*cx1+lh3_478%c(2,2)*cy2
      clineth_4f(i7,i8)%b(2,jut)=clineth_4f(i7,i8)%b(2,jut)+lh3_
     & 478%b(2,2)*cx2
      clineth_4f(i7,i8)%c(2,jut)=clineth_4f(i7,i8)%c(2,jut)+lh3_
     & 478%a(2,1)*cw1+lh3_478%c(2,2)*cz2
      clineth_4f(i7,i8)%d(2,jut)=clineth_4f(i7,i8)%d(2,jut)+lh3_
     & 478%b(2,2)*cw2
      clineth_4f(i7,i8)%a(1,jut)=clineth_4f(i7,i8)%a(1,jut)+lh3_
     & 478%c(1,1)*cy1+lh3_478%a(1,2)*cx2
      clineth_4f(i7,i8)%b(1,jut)=clineth_4f(i7,i8)%b(1,jut)+lh3_
     & 478%b(1,1)*cx1
      clineth_4f(i7,i8)%c(1,jut)=clineth_4f(i7,i8)%c(1,jut)+lh3_
     & 478%c(1,1)*cz1+lh3_478%a(1,2)*cw2
      clineth_4f(i7,i8)%d(1,jut)=clineth_4f(i7,i8)%d(1,jut)+lh3_
     & 478%b(1,1)*cw1
      end do
      end do
      end do
  
  
  
  
        rmassl=rmass(id3)
        rmassr=-rmassl
  
  
      do i3=1,2
      do i4=1,2
* mline -- res=ch3478(&1,&2,i3,i4),abcd=clineth_4f(i3,i4)%,m1=rmassl,m2=
* rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      ch3478(iut,jut,i3,i4)=clineth_4f(i3,i4)%a(iut,jut)+rmassl*
     & clineth_4f(i3,i4)%b(iut,jut)+rmassr*clineth_4f(i3,i4)%c(i
     & ut,jut)+rmassl*rmassr*clineth_4f(i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
  
  
  
      endif
*                                                                       
*    First all diagrams of the type                                     
*                                                                       
*                   |_Z,f,h__/                                          
*              _h___|        \                                          
*                   |                                                   
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id7.eq.5.and.rmh.ge.0.d0) then
      do i3=1,2
      do i4=1,2
* TsTSC -- aa=clineth_4f(i3,i4)%a,bb=clineth_4f(i3,i4)%b,cc=clineth_4f(i
* 3,i4)%c,dd=clineth_4f(i3,i4)%d,a1=l7_34(i3,i4)%a,b1=l7_34(i3,i4)%b,c1=
* l7_34(i3,i4)%c,d1=l7_34(i3,i4)%d,a2=rh8_734%a,b2=rh8_734%b,c2=rh8_734%
* c,prq=p734q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=l7_34(i3,i4)%a(iut,1)+l7_34(i3,i4)%c(iut,1)*rmass(id7)
      cx2=l7_34(i3,i4)%c(iut,2)*p734q+l7_34(i3,i4)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_34(i3,i4)%b(iut,1)+l7_34(i3,i4)%d(iut,1)*rmass(id7)
      cy2=l7_34(i3,i4)%d(iut,2)*p734q+l7_34(i3,i4)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_34(i3,i4)%c(iut,1)*p734q+l7_34(i3,i4)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_34(i3,i4)%a(iut,2)+l7_34(i3,i4)%c(iut,2)*rmass(id7)
      cz1=l7_34(i3,i4)%d(iut,1)*p734q+l7_34(i3,i4)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_34(i3,i4)%b(iut,2)+l7_34(i3,i4)%d(iut,2)*rmass(id7)
      clineth_4f(i3,i4)%a(iut,2)=cx1*rh8_734%a(1,2)+cx2*rh8_734%
     & b(2,2)
      clineth_4f(i3,i4)%b(iut,2)=cy1*rh8_734%a(1,2)+cy2*rh8_734%
     & b(2,2)
      clineth_4f(i3,i4)%c(iut,2)=cw2*rh8_734%c(2,2)
      clineth_4f(i3,i4)%d(iut,2)=cz2*rh8_734%c(2,2)
      clineth_4f(i3,i4)%a(iut,1)=cw1*rh8_734%b(1,1)+cw2*rh8_734%
     & a(2,1)
      clineth_4f(i3,i4)%b(iut,1)=cz1*rh8_734%b(1,1)+cz2*rh8_734%
     & a(2,1)
      clineth_4f(i3,i4)%c(iut,1)=cx1*rh8_734%c(1,1)
      clineth_4f(i3,i4)%d(iut,1)=cy1*rh8_734%c(1,1)
      end do
      end do
      end do
  
  
*    Then those of the type                                             
*                                                                       
*              _h___|                                                   
*                   |_Z,f,h__/                                          
*                   |        \                                          
*                                                                       
  
      do i3=1,2
      do i4=1,2
* TSCTs -- aa=clineth_4f(i3,i4)%a,bb=clineth_4f(i3,i4)%b,cc=clineth_4f(i
* 3,i4)%c,dd=clineth_4f(i3,i4)%d,a1=lh7_834%a,b1=lh7_834%b,c1=lh7_834%c,
* a2=r8_34(i3,i4)%a,b2=r8_34(i3,i4)%b,c2=r8_34(i3,i4)%c,d2=r8_34(i3,i4)%
* d,prq=p834q,m=rmass(id7),nsum=1
      do jut=1,2
      cx1=r8_34(i3,i4)%a(1,jut)+rmass(id7)*r8_34(i3,i4)%b(1,jut)
      cx2=r8_34(i3,i4)%a(2,jut)+rmass(id7)*r8_34(i3,i4)%b(2,jut)
      cy1=p834q*r8_34(i3,i4)%b(1,jut)+rmass(id7)*r8_34(i3,i4)%a(
     & 1,jut)
      cy2=p834q*r8_34(i3,i4)%b(2,jut)+rmass(id7)*r8_34(i3,i4)%a(
     & 2,jut)
      cw1=r8_34(i3,i4)%c(1,jut)+rmass(id7)*r8_34(i3,i4)%d(1,jut)
      cw2=r8_34(i3,i4)%c(2,jut)+rmass(id7)*r8_34(i3,i4)%d(2,jut)
      cz1=p834q*r8_34(i3,i4)%d(1,jut)+rmass(id7)*r8_34(i3,i4)%c(
     & 1,jut)
      cz2=p834q*r8_34(i3,i4)%d(2,jut)+rmass(id7)*r8_34(i3,i4)%c(
     & 2,jut)
      clineth_4f(i3,i4)%a(2,jut)=clineth_4f(i3,i4)%a(2,jut)+lh7_
     & 834%a(2,1)*cx1+lh7_834%c(2,2)*cy2
      clineth_4f(i3,i4)%b(2,jut)=clineth_4f(i3,i4)%b(2,jut)+lh7_
     & 834%b(2,2)*cx2
      clineth_4f(i3,i4)%c(2,jut)=clineth_4f(i3,i4)%c(2,jut)+lh7_
     & 834%a(2,1)*cw1+lh7_834%c(2,2)*cz2
      clineth_4f(i3,i4)%d(2,jut)=clineth_4f(i3,i4)%d(2,jut)+lh7_
     & 834%b(2,2)*cw2
      clineth_4f(i3,i4)%a(1,jut)=clineth_4f(i3,i4)%a(1,jut)+lh7_
     & 834%c(1,1)*cy1+lh7_834%a(1,2)*cx2
      clineth_4f(i3,i4)%b(1,jut)=clineth_4f(i3,i4)%b(1,jut)+lh7_
     & 834%b(1,1)*cx1
      clineth_4f(i3,i4)%c(1,jut)=clineth_4f(i3,i4)%c(1,jut)+lh7_
     & 834%c(1,1)*cz1+lh7_834%a(1,2)*cw2
      clineth_4f(i3,i4)%d(1,jut)=clineth_4f(i3,i4)%d(1,jut)+lh7_
     & 834%b(1,1)*cw1
      end do
      end do
      end do
  
  
  
  
        rmassl=rmass(id7)
        rmassr=-rmassl
  
  
  
  
      do i1=1,2
      do i2=1,2
* mline -- res=ch3478(i1,i2,&1,&2),abcd=clineth_4f(i1,i2)%,m1=rmassl,m2=
* rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      ch3478(i1,i2,iut,jut)=ch3478(i1,i2,iut,jut)+clineth_4f(i1,
     & i2)%a(iut,jut)+rmassl*clineth_4f(i1,i2)%b(iut,jut)+rmassr
     & *clineth_4f(i1,i2)%c(iut,jut)+rmassl*rmassr*clineth_4f(i1
     & ,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
  
      endif
*                                                                       
*    First all diagrams of the type                                     
*                                                                       
*                   |_Z,f,h__/                                          
*              _h___|        \                                          
*                   |                                                   
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.rmh.ge.0.d0) then
      do i7=1,2
      do i8=1,2
* TsTSC -- aa=clineth_4f(i7,i8)%a,bb=clineth_4f(i7,i8)%b,cc=clineth_4f(i
* 7,i8)%c,dd=clineth_4f(i7,i8)%d,a1=l1_78(i7,i8)%a,b1=l1_78(i7,i8)%b,c1=
* l1_78(i7,i8)%c,d1=l1_78(i7,i8)%d,a2=rh2_178%a,b2=rh2_178%b,c2=rh2_178%
* c,prq=p178q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=l1_78(i7,i8)%a(iut,1)+l1_78(i7,i8)%c(iut,1)*rmass(id1)
      cx2=l1_78(i7,i8)%c(iut,2)*p178q+l1_78(i7,i8)%a(iut,2)*rmas
     & s(id1)
      cy1=l1_78(i7,i8)%b(iut,1)+l1_78(i7,i8)%d(iut,1)*rmass(id1)
      cy2=l1_78(i7,i8)%d(iut,2)*p178q+l1_78(i7,i8)%b(iut,2)*rmas
     & s(id1)
      cw1=l1_78(i7,i8)%c(iut,1)*p178q+l1_78(i7,i8)%a(iut,1)*rmas
     & s(id1)
      cw2=l1_78(i7,i8)%a(iut,2)+l1_78(i7,i8)%c(iut,2)*rmass(id1)
      cz1=l1_78(i7,i8)%d(iut,1)*p178q+l1_78(i7,i8)%b(iut,1)*rmas
     & s(id1)
      cz2=l1_78(i7,i8)%b(iut,2)+l1_78(i7,i8)%d(iut,2)*rmass(id1)
      clineth_4f(i7,i8)%a(iut,2)=cx1*rh2_178%a(1,2)+cx2*rh2_178%
     & b(2,2)
      clineth_4f(i7,i8)%b(iut,2)=cy1*rh2_178%a(1,2)+cy2*rh2_178%
     & b(2,2)
      clineth_4f(i7,i8)%c(iut,2)=cw2*rh2_178%c(2,2)
      clineth_4f(i7,i8)%d(iut,2)=cz2*rh2_178%c(2,2)
      clineth_4f(i7,i8)%a(iut,1)=cw1*rh2_178%b(1,1)+cw2*rh2_178%
     & a(2,1)
      clineth_4f(i7,i8)%b(iut,1)=cz1*rh2_178%b(1,1)+cz2*rh2_178%
     & a(2,1)
      clineth_4f(i7,i8)%c(iut,1)=cx1*rh2_178%c(1,1)
      clineth_4f(i7,i8)%d(iut,1)=cy1*rh2_178%c(1,1)
      end do
      end do
      end do
  
  
*    Then those of the type                                             
*                                                                       
*              _h___|                                                   
*                   |_Z,f,h__/                                          
*                   |        \                                          
*                                                                       
  
      do i7=1,2
      do i8=1,2
* TSCTs -- aa=clineth_4f(i7,i8)%a,bb=clineth_4f(i7,i8)%b,cc=clineth_4f(i
* 7,i8)%c,dd=clineth_4f(i7,i8)%d,a1=lh1_278%a,b1=lh1_278%b,c1=lh1_278%c,
* a2=r2_78(i7,i8)%a,b2=r2_78(i7,i8)%b,c2=r2_78(i7,i8)%c,d2=r2_78(i7,i8)%
* d,prq=p278q,m=rmass(id1),nsum=1
      do jut=1,2
      cx1=r2_78(i7,i8)%a(1,jut)+rmass(id1)*r2_78(i7,i8)%b(1,jut)
      cx2=r2_78(i7,i8)%a(2,jut)+rmass(id1)*r2_78(i7,i8)%b(2,jut)
      cy1=p278q*r2_78(i7,i8)%b(1,jut)+rmass(id1)*r2_78(i7,i8)%a(
     & 1,jut)
      cy2=p278q*r2_78(i7,i8)%b(2,jut)+rmass(id1)*r2_78(i7,i8)%a(
     & 2,jut)
      cw1=r2_78(i7,i8)%c(1,jut)+rmass(id1)*r2_78(i7,i8)%d(1,jut)
      cw2=r2_78(i7,i8)%c(2,jut)+rmass(id1)*r2_78(i7,i8)%d(2,jut)
      cz1=p278q*r2_78(i7,i8)%d(1,jut)+rmass(id1)*r2_78(i7,i8)%c(
     & 1,jut)
      cz2=p278q*r2_78(i7,i8)%d(2,jut)+rmass(id1)*r2_78(i7,i8)%c(
     & 2,jut)
      clineth_4f(i7,i8)%a(2,jut)=clineth_4f(i7,i8)%a(2,jut)+lh1_
     & 278%a(2,1)*cx1+lh1_278%c(2,2)*cy2
      clineth_4f(i7,i8)%b(2,jut)=clineth_4f(i7,i8)%b(2,jut)+lh1_
     & 278%b(2,2)*cx2
      clineth_4f(i7,i8)%c(2,jut)=clineth_4f(i7,i8)%c(2,jut)+lh1_
     & 278%a(2,1)*cw1+lh1_278%c(2,2)*cz2
      clineth_4f(i7,i8)%d(2,jut)=clineth_4f(i7,i8)%d(2,jut)+lh1_
     & 278%b(2,2)*cw2
      clineth_4f(i7,i8)%a(1,jut)=clineth_4f(i7,i8)%a(1,jut)+lh1_
     & 278%c(1,1)*cy1+lh1_278%a(1,2)*cx2
      clineth_4f(i7,i8)%b(1,jut)=clineth_4f(i7,i8)%b(1,jut)+lh1_
     & 278%b(1,1)*cx1
      clineth_4f(i7,i8)%c(1,jut)=clineth_4f(i7,i8)%c(1,jut)+lh1_
     & 278%c(1,1)*cz1+lh1_278%a(1,2)*cw2
      clineth_4f(i7,i8)%d(1,jut)=clineth_4f(i7,i8)%d(1,jut)+lh1_
     & 278%b(1,1)*cw1
      end do
      end do
      end do
  
  
  
  
        rmassl=rmass(id1)
        rmassr=-rmassl
  
  
      do i3=1,2
      do i4=1,2
* mline -- res=ch1278(&1,&2,i3,i4),abcd=clineth_4f(i3,i4)%,m1=rmassl,m2=
* rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      ch1278(iut,jut,i3,i4)=clineth_4f(i3,i4)%a(iut,jut)+rmassl*
     & clineth_4f(i3,i4)%b(iut,jut)+rmassr*clineth_4f(i3,i4)%c(i
     & ut,jut)+rmassl*rmassr*clineth_4f(i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
  
  
  
      endif
*                                                                       
*    First all diagrams of the type                                     
*                                                                       
*                   |_Z,f,h__/                                          
*              _h___|        \                                          
*                   |                                                   
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id7.eq.5.and.rmh.ge.0.d0) then
      do i1=1,2
      do i2=1,2
* TsTSC -- aa=clineth_4f(i1,i2)%a,bb=clineth_4f(i1,i2)%b,cc=clineth_4f(i
* 1,i2)%c,dd=clineth_4f(i1,i2)%d,a1=l7_12(i1,i2)%a,b1=l7_12(i1,i2)%b,c1=
* l7_12(i1,i2)%c,d1=l7_12(i1,i2)%d,a2=rh8_712%a,b2=rh8_712%b,c2=rh8_712%
* c,prq=p712q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=l7_12(i1,i2)%a(iut,1)+l7_12(i1,i2)%c(iut,1)*rmass(id7)
      cx2=l7_12(i1,i2)%c(iut,2)*p712q+l7_12(i1,i2)%a(iut,2)*rmas
     & s(id7)
      cy1=l7_12(i1,i2)%b(iut,1)+l7_12(i1,i2)%d(iut,1)*rmass(id7)
      cy2=l7_12(i1,i2)%d(iut,2)*p712q+l7_12(i1,i2)%b(iut,2)*rmas
     & s(id7)
      cw1=l7_12(i1,i2)%c(iut,1)*p712q+l7_12(i1,i2)%a(iut,1)*rmas
     & s(id7)
      cw2=l7_12(i1,i2)%a(iut,2)+l7_12(i1,i2)%c(iut,2)*rmass(id7)
      cz1=l7_12(i1,i2)%d(iut,1)*p712q+l7_12(i1,i2)%b(iut,1)*rmas
     & s(id7)
      cz2=l7_12(i1,i2)%b(iut,2)+l7_12(i1,i2)%d(iut,2)*rmass(id7)
      clineth_4f(i1,i2)%a(iut,2)=cx1*rh8_712%a(1,2)+cx2*rh8_712%
     & b(2,2)
      clineth_4f(i1,i2)%b(iut,2)=cy1*rh8_712%a(1,2)+cy2*rh8_712%
     & b(2,2)
      clineth_4f(i1,i2)%c(iut,2)=cw2*rh8_712%c(2,2)
      clineth_4f(i1,i2)%d(iut,2)=cz2*rh8_712%c(2,2)
      clineth_4f(i1,i2)%a(iut,1)=cw1*rh8_712%b(1,1)+cw2*rh8_712%
     & a(2,1)
      clineth_4f(i1,i2)%b(iut,1)=cz1*rh8_712%b(1,1)+cz2*rh8_712%
     & a(2,1)
      clineth_4f(i1,i2)%c(iut,1)=cx1*rh8_712%c(1,1)
      clineth_4f(i1,i2)%d(iut,1)=cy1*rh8_712%c(1,1)
      end do
      end do
      end do
  
  
*    Then those of the type                                             
*                                                                       
*              _h___|                                                   
*                   |_Z,f,h__/                                          
*                   |        \                                          
*                                                                       
  
      do i1=1,2
      do i2=1,2
* TSCTs -- aa=clineth_4f(i1,i2)%a,bb=clineth_4f(i1,i2)%b,cc=clineth_4f(i
* 1,i2)%c,dd=clineth_4f(i1,i2)%d,a1=lh7_812%a,b1=lh7_812%b,c1=lh7_812%c,
* a2=r8_12(i1,i2)%a,b2=r8_12(i1,i2)%b,c2=r8_12(i1,i2)%c,d2=r8_12(i1,i2)%
* d,prq=p812q,m=rmass(id7),nsum=1
      do jut=1,2
      cx1=r8_12(i1,i2)%a(1,jut)+rmass(id7)*r8_12(i1,i2)%b(1,jut)
      cx2=r8_12(i1,i2)%a(2,jut)+rmass(id7)*r8_12(i1,i2)%b(2,jut)
      cy1=p812q*r8_12(i1,i2)%b(1,jut)+rmass(id7)*r8_12(i1,i2)%a(
     & 1,jut)
      cy2=p812q*r8_12(i1,i2)%b(2,jut)+rmass(id7)*r8_12(i1,i2)%a(
     & 2,jut)
      cw1=r8_12(i1,i2)%c(1,jut)+rmass(id7)*r8_12(i1,i2)%d(1,jut)
      cw2=r8_12(i1,i2)%c(2,jut)+rmass(id7)*r8_12(i1,i2)%d(2,jut)
      cz1=p812q*r8_12(i1,i2)%d(1,jut)+rmass(id7)*r8_12(i1,i2)%c(
     & 1,jut)
      cz2=p812q*r8_12(i1,i2)%d(2,jut)+rmass(id7)*r8_12(i1,i2)%c(
     & 2,jut)
      clineth_4f(i1,i2)%a(2,jut)=clineth_4f(i1,i2)%a(2,jut)+lh7_
     & 812%a(2,1)*cx1+lh7_812%c(2,2)*cy2
      clineth_4f(i1,i2)%b(2,jut)=clineth_4f(i1,i2)%b(2,jut)+lh7_
     & 812%b(2,2)*cx2
      clineth_4f(i1,i2)%c(2,jut)=clineth_4f(i1,i2)%c(2,jut)+lh7_
     & 812%a(2,1)*cw1+lh7_812%c(2,2)*cz2
      clineth_4f(i1,i2)%d(2,jut)=clineth_4f(i1,i2)%d(2,jut)+lh7_
     & 812%b(2,2)*cw2
      clineth_4f(i1,i2)%a(1,jut)=clineth_4f(i1,i2)%a(1,jut)+lh7_
     & 812%c(1,1)*cy1+lh7_812%a(1,2)*cx2
      clineth_4f(i1,i2)%b(1,jut)=clineth_4f(i1,i2)%b(1,jut)+lh7_
     & 812%b(1,1)*cx1
      clineth_4f(i1,i2)%c(1,jut)=clineth_4f(i1,i2)%c(1,jut)+lh7_
     & 812%c(1,1)*cz1+lh7_812%a(1,2)*cw2
      clineth_4f(i1,i2)%d(1,jut)=clineth_4f(i1,i2)%d(1,jut)+lh7_
     & 812%b(1,1)*cw1
      end do
      end do
      end do
  
  
  
  
        rmassl=rmass(id7)
        rmassr=-rmassl
  
  
  
  
      do i1=1,2
      do i2=1,2
* mline -- res=ch1278(i1,i2,&1,&2),abcd=clineth_4f(i1,i2)%,m1=rmassl,m2=
* rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      ch1278(i1,i2,iut,jut)=ch1278(i1,i2,iut,jut)+clineth_4f(i1,
     & i2)%a(iut,jut)+rmassl*clineth_4f(i1,i2)%b(iut,jut)+rmassr
     & *clineth_4f(i1,i2)%c(iut,jut)+rmassl*rmassr*clineth_4f(i1
     & ,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
  
      endif
*                                                                       
*    First all diagrams of the type                                     
*                                                                       
*                   |_Z,f,h__/                                          
*              _h___|        \                                          
*                   |                                                   
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.rmh.ge.0.d0) then
      do i5=1,2
      do i6=1,2
* TsTSC -- aa=clineth_4f(i5,i6)%a,bb=clineth_4f(i5,i6)%b,cc=clineth_4f(i
* 5,i6)%c,dd=clineth_4f(i5,i6)%d,a1=l3_56(i5,i6)%a,b1=l3_56(i5,i6)%b,c1=
* l3_56(i5,i6)%c,d1=l3_56(i5,i6)%d,a2=rh4_356%a,b2=rh4_356%b,c2=rh4_356%
* c,prq=p356q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=l3_56(i5,i6)%a(iut,1)+l3_56(i5,i6)%c(iut,1)*rmass(id3)
      cx2=l3_56(i5,i6)%c(iut,2)*p356q+l3_56(i5,i6)%a(iut,2)*rmas
     & s(id3)
      cy1=l3_56(i5,i6)%b(iut,1)+l3_56(i5,i6)%d(iut,1)*rmass(id3)
      cy2=l3_56(i5,i6)%d(iut,2)*p356q+l3_56(i5,i6)%b(iut,2)*rmas
     & s(id3)
      cw1=l3_56(i5,i6)%c(iut,1)*p356q+l3_56(i5,i6)%a(iut,1)*rmas
     & s(id3)
      cw2=l3_56(i5,i6)%a(iut,2)+l3_56(i5,i6)%c(iut,2)*rmass(id3)
      cz1=l3_56(i5,i6)%d(iut,1)*p356q+l3_56(i5,i6)%b(iut,1)*rmas
     & s(id3)
      cz2=l3_56(i5,i6)%b(iut,2)+l3_56(i5,i6)%d(iut,2)*rmass(id3)
      clineth_4f(i5,i6)%a(iut,2)=cx1*rh4_356%a(1,2)+cx2*rh4_356%
     & b(2,2)
      clineth_4f(i5,i6)%b(iut,2)=cy1*rh4_356%a(1,2)+cy2*rh4_356%
     & b(2,2)
      clineth_4f(i5,i6)%c(iut,2)=cw2*rh4_356%c(2,2)
      clineth_4f(i5,i6)%d(iut,2)=cz2*rh4_356%c(2,2)
      clineth_4f(i5,i6)%a(iut,1)=cw1*rh4_356%b(1,1)+cw2*rh4_356%
     & a(2,1)
      clineth_4f(i5,i6)%b(iut,1)=cz1*rh4_356%b(1,1)+cz2*rh4_356%
     & a(2,1)
      clineth_4f(i5,i6)%c(iut,1)=cx1*rh4_356%c(1,1)
      clineth_4f(i5,i6)%d(iut,1)=cy1*rh4_356%c(1,1)
      end do
      end do
      end do
  
  
*    Then those of the type                                             
*                                                                       
*              _h___|                                                   
*                   |_Z,f,h__/                                          
*                   |        \                                          
*                                                                       
  
      do i5=1,2
      do i6=1,2
* TSCTs -- aa=clineth_4f(i5,i6)%a,bb=clineth_4f(i5,i6)%b,cc=clineth_4f(i
* 5,i6)%c,dd=clineth_4f(i5,i6)%d,a1=lh3_456%a,b1=lh3_456%b,c1=lh3_456%c,
* a2=r4_56(i5,i6)%a,b2=r4_56(i5,i6)%b,c2=r4_56(i5,i6)%c,d2=r4_56(i5,i6)%
* d,prq=p456q,m=rmass(id3),nsum=1
      do jut=1,2
      cx1=r4_56(i5,i6)%a(1,jut)+rmass(id3)*r4_56(i5,i6)%b(1,jut)
      cx2=r4_56(i5,i6)%a(2,jut)+rmass(id3)*r4_56(i5,i6)%b(2,jut)
      cy1=p456q*r4_56(i5,i6)%b(1,jut)+rmass(id3)*r4_56(i5,i6)%a(
     & 1,jut)
      cy2=p456q*r4_56(i5,i6)%b(2,jut)+rmass(id3)*r4_56(i5,i6)%a(
     & 2,jut)
      cw1=r4_56(i5,i6)%c(1,jut)+rmass(id3)*r4_56(i5,i6)%d(1,jut)
      cw2=r4_56(i5,i6)%c(2,jut)+rmass(id3)*r4_56(i5,i6)%d(2,jut)
      cz1=p456q*r4_56(i5,i6)%d(1,jut)+rmass(id3)*r4_56(i5,i6)%c(
     & 1,jut)
      cz2=p456q*r4_56(i5,i6)%d(2,jut)+rmass(id3)*r4_56(i5,i6)%c(
     & 2,jut)
      clineth_4f(i5,i6)%a(2,jut)=clineth_4f(i5,i6)%a(2,jut)+lh3_
     & 456%a(2,1)*cx1+lh3_456%c(2,2)*cy2
      clineth_4f(i5,i6)%b(2,jut)=clineth_4f(i5,i6)%b(2,jut)+lh3_
     & 456%b(2,2)*cx2
      clineth_4f(i5,i6)%c(2,jut)=clineth_4f(i5,i6)%c(2,jut)+lh3_
     & 456%a(2,1)*cw1+lh3_456%c(2,2)*cz2
      clineth_4f(i5,i6)%d(2,jut)=clineth_4f(i5,i6)%d(2,jut)+lh3_
     & 456%b(2,2)*cw2
      clineth_4f(i5,i6)%a(1,jut)=clineth_4f(i5,i6)%a(1,jut)+lh3_
     & 456%c(1,1)*cy1+lh3_456%a(1,2)*cx2
      clineth_4f(i5,i6)%b(1,jut)=clineth_4f(i5,i6)%b(1,jut)+lh3_
     & 456%b(1,1)*cx1
      clineth_4f(i5,i6)%c(1,jut)=clineth_4f(i5,i6)%c(1,jut)+lh3_
     & 456%c(1,1)*cz1+lh3_456%a(1,2)*cw2
      clineth_4f(i5,i6)%d(1,jut)=clineth_4f(i5,i6)%d(1,jut)+lh3_
     & 456%b(1,1)*cw1
      end do
      end do
      end do
  
  
  
  
        rmassl=rmass(id3)
        rmassr=-rmassl
  
  
      do i3=1,2
      do i4=1,2
* mline -- res=ch3456(&1,&2,i3,i4),abcd=clineth_4f(i3,i4)%,m1=rmassl,m2=
* rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      ch3456(iut,jut,i3,i4)=clineth_4f(i3,i4)%a(iut,jut)+rmassl*
     & clineth_4f(i3,i4)%b(iut,jut)+rmassr*clineth_4f(i3,i4)%c(i
     & ut,jut)+rmassl*rmassr*clineth_4f(i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
  
  
  
      endif
*                                                                       
*    First all diagrams of the type                                     
*                                                                       
*                   |_Z,f,h__/                                          
*              _h___|        \                                          
*                   |                                                   
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.rmh.ge.0.d0) then
      do i3=1,2
      do i4=1,2
* TsTSC -- aa=clineth_4f(i3,i4)%a,bb=clineth_4f(i3,i4)%b,cc=clineth_4f(i
* 3,i4)%c,dd=clineth_4f(i3,i4)%d,a1=l5_34(i3,i4)%a,b1=l5_34(i3,i4)%b,c1=
* l5_34(i3,i4)%c,d1=l5_34(i3,i4)%d,a2=rh6_534%a,b2=rh6_534%b,c2=rh6_534%
* c,prq=p534q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=l5_34(i3,i4)%a(iut,1)+l5_34(i3,i4)%c(iut,1)*rmass(id5)
      cx2=l5_34(i3,i4)%c(iut,2)*p534q+l5_34(i3,i4)%a(iut,2)*rmas
     & s(id5)
      cy1=l5_34(i3,i4)%b(iut,1)+l5_34(i3,i4)%d(iut,1)*rmass(id5)
      cy2=l5_34(i3,i4)%d(iut,2)*p534q+l5_34(i3,i4)%b(iut,2)*rmas
     & s(id5)
      cw1=l5_34(i3,i4)%c(iut,1)*p534q+l5_34(i3,i4)%a(iut,1)*rmas
     & s(id5)
      cw2=l5_34(i3,i4)%a(iut,2)+l5_34(i3,i4)%c(iut,2)*rmass(id5)
      cz1=l5_34(i3,i4)%d(iut,1)*p534q+l5_34(i3,i4)%b(iut,1)*rmas
     & s(id5)
      cz2=l5_34(i3,i4)%b(iut,2)+l5_34(i3,i4)%d(iut,2)*rmass(id5)
      clineth_4f(i3,i4)%a(iut,2)=cx1*rh6_534%a(1,2)+cx2*rh6_534%
     & b(2,2)
      clineth_4f(i3,i4)%b(iut,2)=cy1*rh6_534%a(1,2)+cy2*rh6_534%
     & b(2,2)
      clineth_4f(i3,i4)%c(iut,2)=cw2*rh6_534%c(2,2)
      clineth_4f(i3,i4)%d(iut,2)=cz2*rh6_534%c(2,2)
      clineth_4f(i3,i4)%a(iut,1)=cw1*rh6_534%b(1,1)+cw2*rh6_534%
     & a(2,1)
      clineth_4f(i3,i4)%b(iut,1)=cz1*rh6_534%b(1,1)+cz2*rh6_534%
     & a(2,1)
      clineth_4f(i3,i4)%c(iut,1)=cx1*rh6_534%c(1,1)
      clineth_4f(i3,i4)%d(iut,1)=cy1*rh6_534%c(1,1)
      end do
      end do
      end do
  
  
*    Then those of the type                                             
*                                                                       
*              _h___|                                                   
*                   |_Z,f,h__/                                          
*                   |        \                                          
*                                                                       
  
      do i3=1,2
      do i4=1,2
* TSCTs -- aa=clineth_4f(i3,i4)%a,bb=clineth_4f(i3,i4)%b,cc=clineth_4f(i
* 3,i4)%c,dd=clineth_4f(i3,i4)%d,a1=lh5_634%a,b1=lh5_634%b,c1=lh5_634%c,
* a2=r6_34(i3,i4)%a,b2=r6_34(i3,i4)%b,c2=r6_34(i3,i4)%c,d2=r6_34(i3,i4)%
* d,prq=p634q,m=rmass(id5),nsum=1
      do jut=1,2
      cx1=r6_34(i3,i4)%a(1,jut)+rmass(id5)*r6_34(i3,i4)%b(1,jut)
      cx2=r6_34(i3,i4)%a(2,jut)+rmass(id5)*r6_34(i3,i4)%b(2,jut)
      cy1=p634q*r6_34(i3,i4)%b(1,jut)+rmass(id5)*r6_34(i3,i4)%a(
     & 1,jut)
      cy2=p634q*r6_34(i3,i4)%b(2,jut)+rmass(id5)*r6_34(i3,i4)%a(
     & 2,jut)
      cw1=r6_34(i3,i4)%c(1,jut)+rmass(id5)*r6_34(i3,i4)%d(1,jut)
      cw2=r6_34(i3,i4)%c(2,jut)+rmass(id5)*r6_34(i3,i4)%d(2,jut)
      cz1=p634q*r6_34(i3,i4)%d(1,jut)+rmass(id5)*r6_34(i3,i4)%c(
     & 1,jut)
      cz2=p634q*r6_34(i3,i4)%d(2,jut)+rmass(id5)*r6_34(i3,i4)%c(
     & 2,jut)
      clineth_4f(i3,i4)%a(2,jut)=clineth_4f(i3,i4)%a(2,jut)+lh5_
     & 634%a(2,1)*cx1+lh5_634%c(2,2)*cy2
      clineth_4f(i3,i4)%b(2,jut)=clineth_4f(i3,i4)%b(2,jut)+lh5_
     & 634%b(2,2)*cx2
      clineth_4f(i3,i4)%c(2,jut)=clineth_4f(i3,i4)%c(2,jut)+lh5_
     & 634%a(2,1)*cw1+lh5_634%c(2,2)*cz2
      clineth_4f(i3,i4)%d(2,jut)=clineth_4f(i3,i4)%d(2,jut)+lh5_
     & 634%b(2,2)*cw2
      clineth_4f(i3,i4)%a(1,jut)=clineth_4f(i3,i4)%a(1,jut)+lh5_
     & 634%c(1,1)*cy1+lh5_634%a(1,2)*cx2
      clineth_4f(i3,i4)%b(1,jut)=clineth_4f(i3,i4)%b(1,jut)+lh5_
     & 634%b(1,1)*cx1
      clineth_4f(i3,i4)%c(1,jut)=clineth_4f(i3,i4)%c(1,jut)+lh5_
     & 634%c(1,1)*cz1+lh5_634%a(1,2)*cw2
      clineth_4f(i3,i4)%d(1,jut)=clineth_4f(i3,i4)%d(1,jut)+lh5_
     & 634%b(1,1)*cw1
      end do
      end do
      end do
  
  
  
  
        rmassl=rmass(id5)
        rmassr=-rmassl
  
  
  
  
      do i1=1,2
      do i2=1,2
* mline -- res=ch3456(i1,i2,&1,&2),abcd=clineth_4f(i1,i2)%,m1=rmassl,m2=
* rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      ch3456(i1,i2,iut,jut)=ch3456(i1,i2,iut,jut)+clineth_4f(i1,
     & i2)%a(iut,jut)+rmassl*clineth_4f(i1,i2)%b(iut,jut)+rmassr
     & *clineth_4f(i1,i2)%c(iut,jut)+rmassl*rmassr*clineth_4f(i1
     & ,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
  
      endif
  
*                                                                       
*    Then the triple vertex                                             
*                                                                       
*                    /_                      /_                         
*                  Z/                      h/                           
*             _h___/       and        _h___/                            
*                  \                       \                            
*                  Z\_                     h\_                          
*                    \                       \                          
*                                                                       
  
* rmh < 0 in our convention means no higgs coupling                     
  
      if (rmh.ge.0.d0)then
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=ch1234(i1,i2,i3,i4),p=cz12(i1,i2)%e,q=cz34(i3,i4)%e,bef=ch1
* 234(i1,i2,i3,i4)+,aft=*rmz/sw/rcw
      ch1234(i1,i2,i3,i4)=ch1234(i1,i2,i3,i4)+(cz12(i1,i2)%e(0)*
     & cz34(i3,i4)%e(0)-cz12(i1,i2)%e(1)*cz34(i3,i4)%e(1)-cz12(i
     & 1,i2)%e(2)*cz34(i3,i4)%e(2)-cz12(i1,i2)%e(3)*cz34(i3,i4)%
     & e(3))*rmz/sw/rcw
      end do
      end do
      end do
      end do
  
      if(id1.eq.5.and.id3.eq.5)then
  
  
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                ch1234(i1,i2,i3,i4)=ch1234(i1,i2,i3,i4)
     &               +ch12(i1,i2)*ch34(i3,i4)*r3h
              enddo
            enddo
          enddo
        enddo
      endif
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=ch5678(i1,i2,i3,i4),p=cz56(i1,i2)%e,q=cz78(i3,i4)%e,bef=ch5
* 678(i1,i2,i3,i4)+,aft=*rmz/sw/rcw
      ch5678(i1,i2,i3,i4)=ch5678(i1,i2,i3,i4)+(cz56(i1,i2)%e(0)*
     & cz78(i3,i4)%e(0)-cz56(i1,i2)%e(1)*cz78(i3,i4)%e(1)-cz56(i
     & 1,i2)%e(2)*cz78(i3,i4)%e(2)-cz56(i1,i2)%e(3)*cz78(i3,i4)%
     & e(3))*rmz/sw/rcw
      end do
      end do
      end do
      end do
  
      if(id5.eq.5.and.id7.eq.5)then
  
  
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                ch5678(i1,i2,i3,i4)=ch5678(i1,i2,i3,i4)
     &               +ch56(i1,i2)*ch78(i3,i4)*r3h
              enddo
            enddo
          enddo
        enddo
      endif
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=ch1256(i1,i2,i3,i4),p=cz12(i1,i2)%e,q=cz56(i3,i4)%e,bef=ch1
* 256(i1,i2,i3,i4)+,aft=*rmz/sw/rcw
      ch1256(i1,i2,i3,i4)=ch1256(i1,i2,i3,i4)+(cz12(i1,i2)%e(0)*
     & cz56(i3,i4)%e(0)-cz12(i1,i2)%e(1)*cz56(i3,i4)%e(1)-cz12(i
     & 1,i2)%e(2)*cz56(i3,i4)%e(2)-cz12(i1,i2)%e(3)*cz56(i3,i4)%
     & e(3))*rmz/sw/rcw
      end do
      end do
      end do
      end do
  
      if(id1.eq.5.and.id5.eq.5)then
  
  
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                ch1256(i1,i2,i3,i4)=ch1256(i1,i2,i3,i4)
     &               +ch12(i1,i2)*ch56(i3,i4)*r3h
              enddo
            enddo
          enddo
        enddo
      endif
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=ch3478(i1,i2,i3,i4),p=cz34(i1,i2)%e,q=cz78(i3,i4)%e,bef=ch3
* 478(i1,i2,i3,i4)+,aft=*rmz/sw/rcw
      ch3478(i1,i2,i3,i4)=ch3478(i1,i2,i3,i4)+(cz34(i1,i2)%e(0)*
     & cz78(i3,i4)%e(0)-cz34(i1,i2)%e(1)*cz78(i3,i4)%e(1)-cz34(i
     & 1,i2)%e(2)*cz78(i3,i4)%e(2)-cz34(i1,i2)%e(3)*cz78(i3,i4)%
     & e(3))*rmz/sw/rcw
      end do
      end do
      end do
      end do
  
      if(id3.eq.5.and.id7.eq.5)then
  
  
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                ch3478(i1,i2,i3,i4)=ch3478(i1,i2,i3,i4)
     &               +ch34(i1,i2)*ch78(i3,i4)*r3h
              enddo
            enddo
          enddo
        enddo
      endif
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=ch1278(i1,i2,i3,i4),p=cz12(i1,i2)%e,q=cz78(i3,i4)%e,bef=ch1
* 278(i1,i2,i3,i4)+,aft=*rmz/sw/rcw
      ch1278(i1,i2,i3,i4)=ch1278(i1,i2,i3,i4)+(cz12(i1,i2)%e(0)*
     & cz78(i3,i4)%e(0)-cz12(i1,i2)%e(1)*cz78(i3,i4)%e(1)-cz12(i
     & 1,i2)%e(2)*cz78(i3,i4)%e(2)-cz12(i1,i2)%e(3)*cz78(i3,i4)%
     & e(3))*rmz/sw/rcw
      end do
      end do
      end do
      end do
  
      if(id1.eq.5.and.id7.eq.5)then
  
  
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                ch1278(i1,i2,i3,i4)=ch1278(i1,i2,i3,i4)
     &               +ch12(i1,i2)*ch78(i3,i4)*r3h
              enddo
            enddo
          enddo
        enddo
      endif
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=ch3456(i1,i2,i3,i4),p=cz34(i1,i2)%e,q=cz56(i3,i4)%e,bef=ch3
* 456(i1,i2,i3,i4)+,aft=*rmz/sw/rcw
      ch3456(i1,i2,i3,i4)=ch3456(i1,i2,i3,i4)+(cz34(i1,i2)%e(0)*
     & cz56(i3,i4)%e(0)-cz34(i1,i2)%e(1)*cz56(i3,i4)%e(1)-cz34(i
     & 1,i2)%e(2)*cz56(i3,i4)%e(2)-cz34(i1,i2)%e(3)*cz56(i3,i4)%
     & e(3))*rmz/sw/rcw
      end do
      end do
      end do
      end do
  
      if(id3.eq.5.and.id5.eq.5)then
  
  
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                ch3456(i1,i2,i3,i4)=ch3456(i1,i2,i3,i4)
     &               +ch34(i1,i2)*ch56(i3,i4)*r3h
              enddo
            enddo
          enddo
        enddo
      endif
  
      endif
  
  
*     THE QUADRIPLE COUPLING COMPUTATION                                
*                                                                       
*                      Z                          H                     
*                	|			  |                                               
*                       |                         |                     
*                  H----|----Z      AND      H----|----H                
*                       |			  |		                                       
*                       |			  |                                         
*                       H			  H                                         
*                                                                       
  
  
*			FIRST ZZHH COUPLING                                                 
  
      if (rmh.ge.0.d0)then
*                                                                       
  
  
*c initialization                                                       
  
          do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                 do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
  
       cresquad_hh_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=czero
  
                         enddo
                        enddo
                      enddo
                    enddo
                   enddo
                 enddo
               enddo
             enddo
  
  
  
*   ZZHH COUPLING                                                       
  
        couplhhzz= -r2h2z
  
  
  
  
        if(id1.eq.5.and.id3.eq.5)then
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=cz_zzhh5678(i1,i2,i3,i4),p=cz56(i1,i2)%e,q=cz78(i3,i4)%e,be
* f=,aft=*couplhhzz
      cz_zzhh5678(i1,i2,i3,i4)=(cz56(i1,i2)%e(0)*cz78(i3,i4)%e(0
     & )-cz56(i1,i2)%e(1)*cz78(i3,i4)%e(1)-cz56(i1,i2)%e(2)*cz78
     & (i3,i4)%e(2)-cz56(i1,i2)%e(3)*cz78(i3,i4)%e(3))*couplhhzz
      end do
      end do
      end do
      end do
  
  
  
          do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                 do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
  
       cresquad_hh_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &cresquad_hh_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8) + ch12(i1,i2)*
     &  ch34(i3,i4)*cz_zzhh5678(i5,i6,i7,i8)
  
                         enddo
                        enddo
                      enddo
                    enddo
                   enddo
                 enddo
               enddo
             enddo
       endif
  
  
        if(id5.eq.5.and.id7.eq.5)then
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=cz_zzhh1234(i1,i2,i3,i4),p=cz12(i1,i2)%e,q=cz34(i3,i4)%e,be
* f=,aft=*couplhhzz
      cz_zzhh1234(i1,i2,i3,i4)=(cz12(i1,i2)%e(0)*cz34(i3,i4)%e(0
     & )-cz12(i1,i2)%e(1)*cz34(i3,i4)%e(1)-cz12(i1,i2)%e(2)*cz34
     & (i3,i4)%e(2)-cz12(i1,i2)%e(3)*cz34(i3,i4)%e(3))*couplhhzz
      end do
      end do
      end do
      end do
  
  
  
          do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                 do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
  
       cresquad_hh_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &cresquad_hh_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8) + ch56(i5,i6)*
     &  ch78(i7,i8)*cz_zzhh1234(i1,i2,i3,i4)
  
                         enddo
                        enddo
                      enddo
                    enddo
                   enddo
                 enddo
               enddo
             enddo
       endif
  
  
        if(id1.eq.5.and.id5.eq.5)then
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=cz_zzhh3478(i1,i2,i3,i4),p=cz34(i1,i2)%e,q=cz78(i3,i4)%e,be
* f=,aft=*couplhhzz
      cz_zzhh3478(i1,i2,i3,i4)=(cz34(i1,i2)%e(0)*cz78(i3,i4)%e(0
     & )-cz34(i1,i2)%e(1)*cz78(i3,i4)%e(1)-cz34(i1,i2)%e(2)*cz78
     & (i3,i4)%e(2)-cz34(i1,i2)%e(3)*cz78(i3,i4)%e(3))*couplhhzz
      end do
      end do
      end do
      end do
  
  
  
          do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                 do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
  
       cresquad_hh_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &cresquad_hh_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8) + ch12(i1,i2)*
     &  ch56(i5,i6)*cz_zzhh3478(i3,i4,i7,i8)
  
                         enddo
                        enddo
                      enddo
                    enddo
                   enddo
                 enddo
               enddo
             enddo
       endif
  
  
        if(id3.eq.5.and.id7.eq.5)then
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=cz_zzhh1256(i1,i2,i3,i4),p=cz12(i1,i2)%e,q=cz56(i3,i4)%e,be
* f=,aft=*couplhhzz
      cz_zzhh1256(i1,i2,i3,i4)=(cz12(i1,i2)%e(0)*cz56(i3,i4)%e(0
     & )-cz12(i1,i2)%e(1)*cz56(i3,i4)%e(1)-cz12(i1,i2)%e(2)*cz56
     & (i3,i4)%e(2)-cz12(i1,i2)%e(3)*cz56(i3,i4)%e(3))*couplhhzz
      end do
      end do
      end do
      end do
  
  
  
          do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                 do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
  
       cresquad_hh_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &cresquad_hh_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8) + ch34(i3,i4)*
     &  ch78(i7,i8)*cz_zzhh1256(i1,i2,i5,i6)
  
                         enddo
                        enddo
                      enddo
                    enddo
                   enddo
                 enddo
               enddo
             enddo
       endif
  
  
        if(id1.eq.5.and.id7.eq.5)then
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=cz_zzhh3456(i1,i2,i3,i4),p=cz34(i1,i2)%e,q=cz56(i3,i4)%e,be
* f=,aft=*couplhhzz
      cz_zzhh3456(i1,i2,i3,i4)=(cz34(i1,i2)%e(0)*cz56(i3,i4)%e(0
     & )-cz34(i1,i2)%e(1)*cz56(i3,i4)%e(1)-cz34(i1,i2)%e(2)*cz56
     & (i3,i4)%e(2)-cz34(i1,i2)%e(3)*cz56(i3,i4)%e(3))*couplhhzz
      end do
      end do
      end do
      end do
  
  
  
          do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                 do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
  
       cresquad_hh_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &cresquad_hh_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8) + ch12(i1,i2)*
     &  ch78(i7,i8)*cz_zzhh3456(i3,i4,i5,i6)
  
                         enddo
                        enddo
                      enddo
                    enddo
                   enddo
                 enddo
               enddo
             enddo
       endif
  
  
        if(id3.eq.5.and.id5.eq.5)then
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=cz_zzhh1278(i1,i2,i3,i4),p=cz12(i1,i2)%e,q=cz78(i3,i4)%e,be
* f=,aft=*couplhhzz
      cz_zzhh1278(i1,i2,i3,i4)=(cz12(i1,i2)%e(0)*cz78(i3,i4)%e(0
     & )-cz12(i1,i2)%e(1)*cz78(i3,i4)%e(1)-cz12(i1,i2)%e(2)*cz78
     & (i3,i4)%e(2)-cz12(i1,i2)%e(3)*cz78(i3,i4)%e(3))*couplhhzz
      end do
      end do
      end do
      end do
  
  
  
          do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                 do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
  
       cresquad_hh_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &cresquad_hh_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8) + ch34(i3,i4)*
     &  ch56(i5,i6)*cz_zzhh1278(i1,i2,i7,i8)
  
                         enddo
                        enddo
                      enddo
                    enddo
                   enddo
                 enddo
               enddo
             enddo
       endif
  
*              AND THEN HHHH COUPLING                                   
  
        if(id1.eq.5.and.id3.eq.5.and.id5.eq.5.and.id7.eq.5)then
  
        couplhhhh=-r4h
  
           do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                 do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
  
        cresquad_hh_hh(i1,i2,i3,i4,i5,i6)%pol(i7,i8)= ch12(i1,i2)*
     &   ch34(i3,i4)*ch56(i5,i6)*ch78(i7,i8)*couplhhhh
                         enddo
                        enddo
                      enddo
                    enddo
                   enddo
                 enddo
               enddo
             enddo
       else
           do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                 do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
  
          cresquad_hh_hh(i1,i2,i3,i4,i5,i6)%pol(i7,i8)= czero
  
                         enddo
                        enddo
                      enddo
                    enddo
                   enddo
                 enddo
               enddo
             enddo
  
  
        endif
       endif
  
  
  
  
*  COMPUTE DIAGRAMS WITH ONE Z, GAMMA, H, PROPAGATOR CONNECTING TWO "Z" 
*  ON ONE SIDE AND TWO "Z" ON THE OTHER                                 
  
  
  
  
          do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                  do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
  
  
       creszz_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=czero
        creszz_h_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=czero
                         enddo
                        enddo
                      enddo
                    enddo
                   enddo
                 enddo
               enddo
             enddo
  
  
  
*FIRST COMPUTE DIAGRAMS WITH ONE Z  PROPAGATOR CONNECTING TWO "Z" ON    
*ONE SIDE AND TWO  "Z" ON THE OTHER                                     
  
* creszz_z_zz(2,2,2,2,2,2)%pol(2,2)                                     
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=cp1234dotcz1234(i1,i2,i3,i4),p=p1234(#),q=cz1234(i1,i2,i3,i
* 4,#),bef=,aft=
      cp1234dotcz1234(i1,i2,i3,i4)=(p1234(0)*cz1234(i1,i2,i3,i4,
     & 0)-p1234(1)*cz1234(i1,i2,i3,i4,1)-p1234(2)*cz1234(i1,i2,i
     & 3,i4,2)-p1234(3)*cz1234(i1,i2,i3,i4,3))
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=cp1234dotcz5678(i1,i2,i3,i4),p=p1234(#),q=cz5678(i1,i2,i3,i
* 4,#),bef=,aft=
      cp1234dotcz5678(i1,i2,i3,i4)=(p1234(0)*cz5678(i1,i2,i3,i4,
     & 0)-p1234(1)*cz5678(i1,i2,i3,i4,1)-p1234(2)*cz5678(i1,i2,i
     & 3,i4,2)-p1234(3)*cz5678(i1,i2,i3,i4,3))
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=creszz_z_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8),p=cz1234(i1,i2,i3
* ,i4,#),q=cz5678(i5,i6,i7,i8,#),bef=-,aft=/(p1234q-cmz2)
      creszz_z_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=-(cz1234(i1,i2,i
     & 3,i4,0)*cz5678(i5,i6,i7,i8,0)-cz1234(i1,i2,i3,i4,1)*cz567
     & 8(i5,i6,i7,i8,1)-cz1234(i1,i2,i3,i4,2)*cz5678(i5,i6,i7,i8
     & ,2)-cz1234(i1,i2,i3,i4,3)*cz5678(i5,i6,i7,i8,3))/(p1234q-
     & cmz2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
  
*SECOND COMPUTE DIAGRAMS WITH ONE GAMMA  PROPAGATOR CONNECTING TWO "Z"  
*ON ONE SIDE AND TWO  "Z" ON THE OTHER                                  
  
* creszz_f_zz(2,2,2,2,2,2)%pol(2,2)                                     
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=creszz_f_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8),p=cf1234(i1,i2,i3
* ,i4,#),q=cf5678(i5,i6,i7,i8,#),bef=-,aft=/(p1234q)
      creszz_f_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=-(cf1234(i1,i2,i
     & 3,i4,0)*cf5678(i5,i6,i7,i8,0)-cf1234(i1,i2,i3,i4,1)*cf567
     & 8(i5,i6,i7,i8,1)-cf1234(i1,i2,i3,i4,2)*cf5678(i5,i6,i7,i8
     & ,2)-cf1234(i1,i2,i3,i4,3)*cf5678(i5,i6,i7,i8,3))/(p1234q)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
*THIRD THE SUM OF THE ABOVE AMPLITUDES Z+GAMMA PROPAGATOR CONNECTING TWO
*"Z" ON ONE SIDE AND TWO  "Z" ON THE OTHER PLUS THE PMU*PNU /Mz**2 TERM 
*OF THE Z PROPAGATORS                                                   
  
* creszz_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=                              
*   creszz_z_zz(2,2,2,2,2,2)%pol(2,2) +                                 
*   creszz_f_zz(2,2,2,2,2,2)%pol(2,2)+pmu pnu/mz**2 term                
  
          do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                 do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
  
       creszz_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &  creszz_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &  creszz_z_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &  (cp1234dotcz1234(i1,i2,i3,i4)*cp1234dotcz5678(
     &  i5,i6,i7,i8))/cmz2/(p1234q-cmz2)+
     &  creszz_f_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)
  
                       enddo
                     enddo
                   enddo
                 enddo
               enddo
             enddo
           enddo
         enddo
  
*FOURTH COMPUTE DIAGRAMS WITH H HIGGS  PROPAGATOR CONNECTING TWO "Z" ON 
*ONE SIDE AND TWO  "Z" ON THE OTHER                                     
  
        if(rmh.ge.0.d0)then
  
          do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                 do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
                        creszz_h_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &                       creszz_h_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &                       ch1234(i1,i2,i3,i4)*
     &                       ch5678(i5,i6,i7,i8)/(p1234q-cmh2)
                        enddo
                      enddo
                      enddo
                    enddo
                   enddo
                 enddo
               enddo
             enddo
        endif
  
*FIRST COMPUTE DIAGRAMS WITH ONE Z  PROPAGATOR CONNECTING TWO "Z" ON    
*ONE SIDE AND TWO  "Z" ON THE OTHER                                     
  
* creszz_z_zz(2,2,2,2,2,2)%pol(2,2)                                     
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=cp1256dotcz1256(i1,i2,i3,i4),p=p1256(#),q=cz1256(i1,i2,i3,i
* 4,#),bef=,aft=
      cp1256dotcz1256(i1,i2,i3,i4)=(p1256(0)*cz1256(i1,i2,i3,i4,
     & 0)-p1256(1)*cz1256(i1,i2,i3,i4,1)-p1256(2)*cz1256(i1,i2,i
     & 3,i4,2)-p1256(3)*cz1256(i1,i2,i3,i4,3))
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=cp1256dotcz3478(i1,i2,i3,i4),p=p1256(#),q=cz3478(i1,i2,i3,i
* 4,#),bef=,aft=
      cp1256dotcz3478(i1,i2,i3,i4)=(p1256(0)*cz3478(i1,i2,i3,i4,
     & 0)-p1256(1)*cz3478(i1,i2,i3,i4,1)-p1256(2)*cz3478(i1,i2,i
     & 3,i4,2)-p1256(3)*cz3478(i1,i2,i3,i4,3))
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=creszz_z_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8),p=cz1256(i1,i2,i3
* ,i4,#),q=cz3478(i5,i6,i7,i8,#),bef=-,aft=/(p1256q-cmz2)
      creszz_z_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=-(cz1256(i1,i2,i
     & 3,i4,0)*cz3478(i5,i6,i7,i8,0)-cz1256(i1,i2,i3,i4,1)*cz347
     & 8(i5,i6,i7,i8,1)-cz1256(i1,i2,i3,i4,2)*cz3478(i5,i6,i7,i8
     & ,2)-cz1256(i1,i2,i3,i4,3)*cz3478(i5,i6,i7,i8,3))/(p1256q-
     & cmz2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
  
*SECOND COMPUTE DIAGRAMS WITH ONE GAMMA  PROPAGATOR CONNECTING TWO "Z"  
*ON ONE SIDE AND TWO  "Z" ON THE OTHER                                  
  
* creszz_f_zz(2,2,2,2,2,2)%pol(2,2)                                     
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=creszz_f_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8),p=cf1256(i1,i2,i3
* ,i4,#),q=cf3478(i5,i6,i7,i8,#),bef=-,aft=/(p1256q)
      creszz_f_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=-(cf1256(i1,i2,i
     & 3,i4,0)*cf3478(i5,i6,i7,i8,0)-cf1256(i1,i2,i3,i4,1)*cf347
     & 8(i5,i6,i7,i8,1)-cf1256(i1,i2,i3,i4,2)*cf3478(i5,i6,i7,i8
     & ,2)-cf1256(i1,i2,i3,i4,3)*cf3478(i5,i6,i7,i8,3))/(p1256q)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
*THIRD THE SUM OF THE ABOVE AMPLITUDES Z+GAMMA PROPAGATOR CONNECTING TWO
*"Z" ON ONE SIDE AND TWO  "Z" ON THE OTHER PLUS THE PMU*PNU /Mz**2 TERM 
*OF THE Z PROPAGATORS                                                   
  
* creszz_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=                              
*   creszz_z_zz(2,2,2,2,2,2)%pol(2,2) +                                 
*   creszz_f_zz(2,2,2,2,2,2)%pol(2,2)+pmu pnu/mz**2 term                
  
          do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                 do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
  
       creszz_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &  creszz_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &  creszz_z_zz(i1,i2,i5,i6,i3,i4)%pol(i7,i8)+
     &  (cp1256dotcz1256(i1,i2,i5,i6)*cp1256dotcz3478(
     &  i3,i4,i7,i8))/cmz2/(p1256q-cmz2)+
     &  creszz_f_zz(i1,i2,i5,i6,i3,i4)%pol(i7,i8)
  
                       enddo
                     enddo
                   enddo
                 enddo
               enddo
             enddo
           enddo
         enddo
  
*FOURTH COMPUTE DIAGRAMS WITH H HIGGS  PROPAGATOR CONNECTING TWO "Z" ON 
*ONE SIDE AND TWO  "Z" ON THE OTHER                                     
  
        if(rmh.ge.0.d0)then
  
          do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                 do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
                        creszz_h_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &                       creszz_h_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &                       ch1256(i1,i2,i5,i6)*
     &                       ch3478(i3,i4,i7,i8)/(p1256q-cmh2)
                        enddo
                      enddo
                      enddo
                    enddo
                   enddo
                 enddo
               enddo
             enddo
        endif
  
*FIRST COMPUTE DIAGRAMS WITH ONE Z  PROPAGATOR CONNECTING TWO "Z" ON    
*ONE SIDE AND TWO  "Z" ON THE OTHER                                     
  
* creszz_z_zz(2,2,2,2,2,2)%pol(2,2)                                     
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=cp1278dotcz1278(i1,i2,i3,i4),p=p1278(#),q=cz1278(i1,i2,i3,i
* 4,#),bef=,aft=
      cp1278dotcz1278(i1,i2,i3,i4)=(p1278(0)*cz1278(i1,i2,i3,i4,
     & 0)-p1278(1)*cz1278(i1,i2,i3,i4,1)-p1278(2)*cz1278(i1,i2,i
     & 3,i4,2)-p1278(3)*cz1278(i1,i2,i3,i4,3))
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* p.q -- p.q=cp1278dotcz3456(i1,i2,i3,i4),p=p1278(#),q=cz3456(i1,i2,i3,i
* 4,#),bef=,aft=
      cp1278dotcz3456(i1,i2,i3,i4)=(p1278(0)*cz3456(i1,i2,i3,i4,
     & 0)-p1278(1)*cz3456(i1,i2,i3,i4,1)-p1278(2)*cz3456(i1,i2,i
     & 3,i4,2)-p1278(3)*cz3456(i1,i2,i3,i4,3))
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=creszz_z_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8),p=cz1278(i1,i2,i3
* ,i4,#),q=cz3456(i5,i6,i7,i8,#),bef=-,aft=/(p1278q-cmz2)
      creszz_z_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=-(cz1278(i1,i2,i
     & 3,i4,0)*cz3456(i5,i6,i7,i8,0)-cz1278(i1,i2,i3,i4,1)*cz345
     & 6(i5,i6,i7,i8,1)-cz1278(i1,i2,i3,i4,2)*cz3456(i5,i6,i7,i8
     & ,2)-cz1278(i1,i2,i3,i4,3)*cz3456(i5,i6,i7,i8,3))/(p1278q-
     & cmz2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
  
*SECOND COMPUTE DIAGRAMS WITH ONE GAMMA  PROPAGATOR CONNECTING TWO "Z"  
*ON ONE SIDE AND TWO  "Z" ON THE OTHER                                  
  
* creszz_f_zz(2,2,2,2,2,2)%pol(2,2)                                     
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=creszz_f_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8),p=cf1278(i1,i2,i3
* ,i4,#),q=cf3456(i5,i6,i7,i8,#),bef=-,aft=/(p1278q)
      creszz_f_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=-(cf1278(i1,i2,i
     & 3,i4,0)*cf3456(i5,i6,i7,i8,0)-cf1278(i1,i2,i3,i4,1)*cf345
     & 6(i5,i6,i7,i8,1)-cf1278(i1,i2,i3,i4,2)*cf3456(i5,i6,i7,i8
     & ,2)-cf1278(i1,i2,i3,i4,3)*cf3456(i5,i6,i7,i8,3))/(p1278q)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
*THIRD THE SUM OF THE ABOVE AMPLITUDES Z+GAMMA PROPAGATOR CONNECTING TWO
*"Z" ON ONE SIDE AND TWO  "Z" ON THE OTHER PLUS THE PMU*PNU /Mz**2 TERM 
*OF THE Z PROPAGATORS                                                   
  
* creszz_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=                              
*   creszz_z_zz(2,2,2,2,2,2)%pol(2,2) +                                 
*   creszz_f_zz(2,2,2,2,2,2)%pol(2,2)+pmu pnu/mz**2 term                
  
          do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                 do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
  
       creszz_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &  creszz_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &  creszz_z_zz(i1,i2,i7,i8,i3,i4)%pol(i5,i6)+
     &  (cp1278dotcz1278(i1,i2,i7,i8)*cp1278dotcz3456(
     &  i3,i4,i5,i6))/cmz2/(p1278q-cmz2)+
     &  creszz_f_zz(i1,i2,i7,i8,i3,i4)%pol(i5,i6)
  
                       enddo
                     enddo
                   enddo
                 enddo
               enddo
             enddo
           enddo
         enddo
  
*FOURTH COMPUTE DIAGRAMS WITH H HIGGS  PROPAGATOR CONNECTING TWO "Z" ON 
*ONE SIDE AND TWO  "Z" ON THE OTHER                                     
  
        if(rmh.ge.0.d0)then
  
          do i1=1,2
            do i2=1,2
              do i3=1,2
                do i4=1,2
                 do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
                        creszz_h_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)=
     &                       creszz_h_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8)+
     &                       ch1278(i1,i2,i7,i8)*
     &                       ch3456(i3,i4,i5,i6)/(p1278q-cmh2)
                        enddo
                      enddo
                      enddo
                    enddo
                   enddo
                 enddo
               enddo
             enddo
        endif
  
  
  
  
*Reset cres components before computing final results                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      do k=1,7
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,k) = czero
                      enddo
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
  
* sum the pure EW results. They all belong to colour configuration no.1 
  
************************************************************************
******Color configuration no. 1 ***** [cres(...).caux(i7,i8,1)] ********
************************************************************************
*                                                                       
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
  
*rmh < 0 in our convention means no higgs coupling                      
                      if(rmh.ge.0.d0)then
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,1) =
     &                    creszz_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8) +
     &                    cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8) +
     &                    creszz_h_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8) -
     &                    cresquad_hh_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8) +
     &                    cresquad_hh_hh(i1,i2,i3,i4,i5,i6)%pol(i7,i8)
                      else      ! no higgs contributions
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,1) =
     &                    creszz_zz(i1,i2,i3,i4,i5,i6)%pol(i7,i8) +
     &                    cres_3forks(i1,i2,i3,i4,i5,i6)%pol(i7,i8)
                      endif
  
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
**QCD: here is the computation of QCD diagrams. They are grouped in     
*several classes, as shown below:                                       
*                                                                       
* 1) a gluon propagator connecting two "Z" on one side and two "Z" on   
*    the other:                                                         
*                    _____           _____                              
*                Z   __|  |         |  |__   Z                          
*                    __|  |~~~~g~~~~|  |__                              
*                Z   __|__|         |__|__   Z                          
*                                                                       
*    to be assigned to color configurations no. 2,3,4,5,6,7.            
*                                                                       
* 2) a gluon "decaying" into 6 fermions:                                
*                           _______                                     
*                          |   |___  Z                                  
*                          |   |___                                     
*                    >~~g~~|   |___  Z                                  
*                          |   |___                                     
*                          |___|___  Z                                  
*                                                                       
* More specifically:                                                    
*                                                                       
*  2.a) with one "Z" insertion                                          
*                                   _____                               
*    e.g.:                   |     |  |__  Z                            
*                            |__Z__|  |__                               
*                      >~~g~~|     |__|__  Z                            
*                            |                                          
*                            |                                          
*                                                                       
*    to be assigned to color configurations no. 2,3,4,5,6,7.            
*                                                                       
*  2.b) with one "gamma" insertion                                      
*                                   _____                               
*    e.g.:                   |     |  |__  Z                            
*                            |__f__|  |__                               
*                      >~~g~~|     |__|__  Z                            
*                            |                                          
*                            |                                          
*                                                                       
*    to be assigned to color configurations no. 2,3,4,5,6,7.            
*                                                                       
*  2.c) with one "higgs" insertion                                      
*                                   _____                               
*    e.g.:                   |     |  |__  Z                            
*                            |__h__|  |__                               
*                      >~~g~~|     |__|__  Z                            
*                            |                                          
*                            |                                          
*                                                                       
*    to be assigned to color configurations no. 2,3,4,5,6,7.            
*                                                                       
*  2.d) with two forks attached to a Zline                              
*                          __                                           
*    e.g.:                   |_Z,f,h_/                                  
*                            |       \                                  
*                      >~~g~~|                                          
*                            |_Z,f,h_/                                  
*                          __|       \                                  
*                                                                       
*    to be assigned to color configurations no. 2,3,4,5,6,7.            
*                                                                       
*                                                                       
* In the following results about the different colour flow              
* configurations are computed.                                          
  
  
  
  
************************************************************************
******Color configuration no. 2 ***** [cres(...).caux(i7,i8,2)]*******  
************************************************************************
*                                                                       
*                           5| 1| 3| 7|                                 
*                            |  |~~|  |                                 
*                           6| 2| 4| 8|                                 
*                                                                       
*                                                                       
*Sum the diagrams belonging to classes 1), 2.a), 2.b), 2.c), 2.d) in    
*which the gluon connects Zlines 12 and 34                              
  
      if((ilept(id1).ne.1) .and. (ilept(id3).ne.1)) then
  
*****************Compute diagrams of class 1)***************************
*Link cg1256(2,2,2,2,0:3) with cg3478(2,2,2,2,0:3)                      
*     cg1278(2,2,2,2,0:3) with cg3456(2,2,2,2,0:3)                      
*The result is directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2)  
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2),p=cg1256(i1,i2,i5,i6,
* #),q=cg3478(i3,i4,i7,i8,#),bef=-,aft=/p1256q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2)=-(cg1256(i1,i2,i5,i6
     & ,0)*cg3478(i3,i4,i7,i8,0)-cg1256(i1,i2,i5,i6,1)*cg3478(i3
     & ,i4,i7,i8,1)-cg1256(i1,i2,i5,i6,2)*cg3478(i3,i4,i7,i8,2)-
     & cg1256(i1,i2,i5,i6,3)*cg3478(i3,i4,i7,i8,3))/p1256q
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2),p=cg1278(i1,i2,i7,i8,
* #),q=cg3456(i3,i4,i5,i6,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2)-,
* aft=/p1278q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,2)-(cg1278(i1,i2,i7,i8,0)*cg3456(i3,i4,i5,
     & i6,0)-cg1278(i1,i2,i7,i8,1)*cg3456(i3,i4,i5,i6,1)-cg1278(
     & i1,i2,i7,i8,2)*cg3456(i3,i4,i5,i6,2)-cg1278(i1,i2,i7,i8,3
     & )*cg3456(i3,i4,i5,i6,3))/p1278q
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
  
*****************Compute diagrams of class 2.a) and 2.b)****************
*                                                                       
* First compute subdiagrams of the type  [czqcd1234(2,2,2,2,0:3)]       
*                                        [cfqcd1234(2,2,2,2,0:3)]       
  
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TT -- aa=clinetzz(i1,i2,mu)%a,bb=clinetzz(i1,i2,mu)%b,cc=clinetzz(i1,i
* 2,mu)%c,dd=clinetzz(i1,i2,mu)%d,a1=lg3_12(i1,i2)%a,b1=lg3_12(i1,i2)%b,
* c1=lg3_12(i1,i2)%c,d1=lg3_12(i1,i2)%d,a2=rz4_312(mu)%a,b2=rz4_312(mu)%
* b,c2=rz4_312(mu)%c,d2=rz4_312(mu)%d,prq=p312q,m=rmass(id3),nsum=0
      clinetzz(i1,i2,mu)%a(1,1)=lg3_12(i1,i2)%a(1,1)*rz4_312(mu)
     & %a(1,1)+lg3_12(i1,i2)%c(1,2)*p312q*rz4_312(mu)%b(2,1)
      clinetzz(i1,i2,mu)%b(1,1)=rmass(id3)*(lg3_12(i1,i2)%d(1,1)
     & *rz4_312(mu)%a(1,1)+lg3_12(i1,i2)%b(1,2)*rz4_312(mu)%b(2,
     & 1))
      clinetzz(i1,i2,mu)%c(1,1)=rmass(id3)*(lg3_12(i1,i2)%a(1,1)
     & *rz4_312(mu)%d(1,1)+lg3_12(i1,i2)%c(1,2)*rz4_312(mu)%c(2,
     & 1))
      clinetzz(i1,i2,mu)%d(1,1)=lg3_12(i1,i2)%d(1,1)*p312q*rz4_3
     & 12(mu)%d(1,1)+lg3_12(i1,i2)%b(1,2)*rz4_312(mu)%c(2,1)
      clinetzz(i1,i2,mu)%a(1,2)=rmass(id3)*(lg3_12(i1,i2)%a(1,1)
     & *rz4_312(mu)%b(1,2)+lg3_12(i1,i2)%c(1,2)*rz4_312(mu)%a(2,
     & 2))
      clinetzz(i1,i2,mu)%b(1,2)=lg3_12(i1,i2)%d(1,1)*p312q*rz4_3
     & 12(mu)%b(1,2)+lg3_12(i1,i2)%b(1,2)*rz4_312(mu)%a(2,2)
      clinetzz(i1,i2,mu)%c(1,2)=lg3_12(i1,i2)%a(1,1)*rz4_312(mu)
     & %c(1,2)+lg3_12(i1,i2)%c(1,2)*p312q*rz4_312(mu)%d(2,2)
      clinetzz(i1,i2,mu)%d(1,2)=rmass(id3)*(lg3_12(i1,i2)%d(1,1)
     & *rz4_312(mu)%c(1,2)+lg3_12(i1,i2)%b(1,2)*rz4_312(mu)%d(2,
     & 2))
      clinetzz(i1,i2,mu)%a(2,1)=rmass(id3)*(lg3_12(i1,i2)%c(2,1)
     & *rz4_312(mu)%a(1,1)+lg3_12(i1,i2)%a(2,2)*rz4_312(mu)%b(2,
     & 1))
      clinetzz(i1,i2,mu)%b(2,1)=lg3_12(i1,i2)%b(2,1)*rz4_312(mu)
     & %a(1,1)+lg3_12(i1,i2)%d(2,2)*p312q*rz4_312(mu)%b(2,1)
      clinetzz(i1,i2,mu)%c(2,1)=lg3_12(i1,i2)%c(2,1)*p312q*rz4_3
     & 12(mu)%d(1,1)+lg3_12(i1,i2)%a(2,2)*rz4_312(mu)%c(2,1)
      clinetzz(i1,i2,mu)%d(2,1)=rmass(id3)*(lg3_12(i1,i2)%b(2,1)
     & *rz4_312(mu)%d(1,1)+lg3_12(i1,i2)%d(2,2)*rz4_312(mu)%c(2,
     & 1))
      clinetzz(i1,i2,mu)%a(2,2)=lg3_12(i1,i2)%c(2,1)*p312q*rz4_3
     & 12(mu)%b(1,2)+lg3_12(i1,i2)%a(2,2)*rz4_312(mu)%a(2,2)
      clinetzz(i1,i2,mu)%b(2,2)=rmass(id3)*(lg3_12(i1,i2)%b(2,1)
     & *rz4_312(mu)%b(1,2)+lg3_12(i1,i2)%d(2,2)*rz4_312(mu)%a(2,
     & 2))
      clinetzz(i1,i2,mu)%c(2,2)=rmass(id3)*(lg3_12(i1,i2)%c(2,1)
     & *rz4_312(mu)%c(1,2)+lg3_12(i1,i2)%a(2,2)*rz4_312(mu)%d(2,
     & 2))
      clinetzz(i1,i2,mu)%d(2,2)=lg3_12(i1,i2)%b(2,1)*rz4_312(mu)
     & %c(1,2)+lg3_12(i1,i2)%d(2,2)*p312q*rz4_312(mu)%d(2,2)
      end do
      end do
      end do
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TT -- aa=clinetzz(i1,i2,mu)%a,bb=clinetzz(i1,i2,mu)%b,cc=clinetzz(i1,i
* 2,mu)%c,dd=clinetzz(i1,i2,mu)%d,a1=lz3_412(mu)%a,b1=lz3_412(mu)%b,c1=l
* z3_412(mu)%c,d1=lz3_412(mu)%d,a2=rg4_12(i1,i2)%a,b2=rg4_12(i1,i2)%b,c2
* =rg4_12(i1,i2)%c,d2=rg4_12(i1,i2)%d,prq=p412q,m=rmass(id3),nsum=1
      clinetzz(i1,i2,mu)%a(1,1)=clinetzz(i1,i2,mu)%a(1,1)+lz3_41
     & 2(mu)%a(1,1)*rg4_12(i1,i2)%a(1,1)+lz3_412(mu)%c(1,2)*p412
     & q*rg4_12(i1,i2)%b(2,1)
      clinetzz(i1,i2,mu)%b(1,1)=clinetzz(i1,i2,mu)%b(1,1)+rmass(
     & id3)*(lz3_412(mu)%d(1,1)*rg4_12(i1,i2)%a(1,1)+lz3_412(mu)
     & %b(1,2)*rg4_12(i1,i2)%b(2,1))
      clinetzz(i1,i2,mu)%c(1,1)=clinetzz(i1,i2,mu)%c(1,1)+rmass(
     & id3)*(lz3_412(mu)%a(1,1)*rg4_12(i1,i2)%d(1,1)+lz3_412(mu)
     & %c(1,2)*rg4_12(i1,i2)%c(2,1))
      clinetzz(i1,i2,mu)%d(1,1)=clinetzz(i1,i2,mu)%d(1,1)+lz3_41
     & 2(mu)%d(1,1)*p412q*rg4_12(i1,i2)%d(1,1)+lz3_412(mu)%b(1,2
     & )*rg4_12(i1,i2)%c(2,1)
      clinetzz(i1,i2,mu)%a(1,2)=clinetzz(i1,i2,mu)%a(1,2)+rmass(
     & id3)*(lz3_412(mu)%a(1,1)*rg4_12(i1,i2)%b(1,2)+lz3_412(mu)
     & %c(1,2)*rg4_12(i1,i2)%a(2,2))
      clinetzz(i1,i2,mu)%b(1,2)=clinetzz(i1,i2,mu)%b(1,2)+lz3_41
     & 2(mu)%d(1,1)*p412q*rg4_12(i1,i2)%b(1,2)+lz3_412(mu)%b(1,2
     & )*rg4_12(i1,i2)%a(2,2)
      clinetzz(i1,i2,mu)%c(1,2)=clinetzz(i1,i2,mu)%c(1,2)+lz3_41
     & 2(mu)%a(1,1)*rg4_12(i1,i2)%c(1,2)+lz3_412(mu)%c(1,2)*p412
     & q*rg4_12(i1,i2)%d(2,2)
      clinetzz(i1,i2,mu)%d(1,2)=clinetzz(i1,i2,mu)%d(1,2)+rmass(
     & id3)*(lz3_412(mu)%d(1,1)*rg4_12(i1,i2)%c(1,2)+lz3_412(mu)
     & %b(1,2)*rg4_12(i1,i2)%d(2,2))
      clinetzz(i1,i2,mu)%a(2,1)=clinetzz(i1,i2,mu)%a(2,1)+rmass(
     & id3)*(lz3_412(mu)%c(2,1)*rg4_12(i1,i2)%a(1,1)+lz3_412(mu)
     & %a(2,2)*rg4_12(i1,i2)%b(2,1))
      clinetzz(i1,i2,mu)%b(2,1)=clinetzz(i1,i2,mu)%b(2,1)+lz3_41
     & 2(mu)%b(2,1)*rg4_12(i1,i2)%a(1,1)+lz3_412(mu)%d(2,2)*p412
     & q*rg4_12(i1,i2)%b(2,1)
      clinetzz(i1,i2,mu)%c(2,1)=clinetzz(i1,i2,mu)%c(2,1)+lz3_41
     & 2(mu)%c(2,1)*p412q*rg4_12(i1,i2)%d(1,1)+lz3_412(mu)%a(2,2
     & )*rg4_12(i1,i2)%c(2,1)
      clinetzz(i1,i2,mu)%d(2,1)=clinetzz(i1,i2,mu)%d(2,1)+rmass(
     & id3)*(lz3_412(mu)%b(2,1)*rg4_12(i1,i2)%d(1,1)+lz3_412(mu)
     & %d(2,2)*rg4_12(i1,i2)%c(2,1))
      clinetzz(i1,i2,mu)%a(2,2)=clinetzz(i1,i2,mu)%a(2,2)+lz3_41
     & 2(mu)%c(2,1)*p412q*rg4_12(i1,i2)%b(1,2)+lz3_412(mu)%a(2,2
     & )*rg4_12(i1,i2)%a(2,2)
      clinetzz(i1,i2,mu)%b(2,2)=clinetzz(i1,i2,mu)%b(2,2)+rmass(
     & id3)*(lz3_412(mu)%b(2,1)*rg4_12(i1,i2)%b(1,2)+lz3_412(mu)
     & %d(2,2)*rg4_12(i1,i2)%a(2,2))
      clinetzz(i1,i2,mu)%c(2,2)=clinetzz(i1,i2,mu)%c(2,2)+rmass(
     & id3)*(lz3_412(mu)%c(2,1)*rg4_12(i1,i2)%c(1,2)+lz3_412(mu)
     & %a(2,2)*rg4_12(i1,i2)%d(2,2))
      clinetzz(i1,i2,mu)%d(2,2)=clinetzz(i1,i2,mu)%d(2,2)+lz3_41
     & 2(mu)%b(2,1)*rg4_12(i1,i2)%c(1,2)+lz3_412(mu)%d(2,2)*p412
     & q*rg4_12(i1,i2)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id3)
      rmassr=-rmass(id3)
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=czqcd1234(i1,i2,&1,&2,mu),abcd=clinetzz(i1,i2,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      czqcd1234(i1,i2,iut,jut,mu)=clinetzz(i1,i2,mu)%a(iut,jut)+
     & rmassl*clinetzz(i1,i2,mu)%b(iut,jut)+rmassr*clinetzz(i1,i
     & 2,mu)%c(iut,jut)+rmassl*rmassr*clinetzz(i1,i2,mu)%d(iut,j
     & ut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TT -- aa=clinetzz(i3,i4,mu)%a,bb=clinetzz(i3,i4,mu)%b,cc=clinetzz(i3,i
* 4,mu)%c,dd=clinetzz(i3,i4,mu)%d,a1=lg1_34(i3,i4)%a,b1=lg1_34(i3,i4)%b,
* c1=lg1_34(i3,i4)%c,d1=lg1_34(i3,i4)%d,a2=rz2_134(mu)%a,b2=rz2_134(mu)%
* b,c2=rz2_134(mu)%c,d2=rz2_134(mu)%d,prq=p134q,m=rmass(id1),nsum=0
      clinetzz(i3,i4,mu)%a(1,1)=lg1_34(i3,i4)%a(1,1)*rz2_134(mu)
     & %a(1,1)+lg1_34(i3,i4)%c(1,2)*p134q*rz2_134(mu)%b(2,1)
      clinetzz(i3,i4,mu)%b(1,1)=rmass(id1)*(lg1_34(i3,i4)%d(1,1)
     & *rz2_134(mu)%a(1,1)+lg1_34(i3,i4)%b(1,2)*rz2_134(mu)%b(2,
     & 1))
      clinetzz(i3,i4,mu)%c(1,1)=rmass(id1)*(lg1_34(i3,i4)%a(1,1)
     & *rz2_134(mu)%d(1,1)+lg1_34(i3,i4)%c(1,2)*rz2_134(mu)%c(2,
     & 1))
      clinetzz(i3,i4,mu)%d(1,1)=lg1_34(i3,i4)%d(1,1)*p134q*rz2_1
     & 34(mu)%d(1,1)+lg1_34(i3,i4)%b(1,2)*rz2_134(mu)%c(2,1)
      clinetzz(i3,i4,mu)%a(1,2)=rmass(id1)*(lg1_34(i3,i4)%a(1,1)
     & *rz2_134(mu)%b(1,2)+lg1_34(i3,i4)%c(1,2)*rz2_134(mu)%a(2,
     & 2))
      clinetzz(i3,i4,mu)%b(1,2)=lg1_34(i3,i4)%d(1,1)*p134q*rz2_1
     & 34(mu)%b(1,2)+lg1_34(i3,i4)%b(1,2)*rz2_134(mu)%a(2,2)
      clinetzz(i3,i4,mu)%c(1,2)=lg1_34(i3,i4)%a(1,1)*rz2_134(mu)
     & %c(1,2)+lg1_34(i3,i4)%c(1,2)*p134q*rz2_134(mu)%d(2,2)
      clinetzz(i3,i4,mu)%d(1,2)=rmass(id1)*(lg1_34(i3,i4)%d(1,1)
     & *rz2_134(mu)%c(1,2)+lg1_34(i3,i4)%b(1,2)*rz2_134(mu)%d(2,
     & 2))
      clinetzz(i3,i4,mu)%a(2,1)=rmass(id1)*(lg1_34(i3,i4)%c(2,1)
     & *rz2_134(mu)%a(1,1)+lg1_34(i3,i4)%a(2,2)*rz2_134(mu)%b(2,
     & 1))
      clinetzz(i3,i4,mu)%b(2,1)=lg1_34(i3,i4)%b(2,1)*rz2_134(mu)
     & %a(1,1)+lg1_34(i3,i4)%d(2,2)*p134q*rz2_134(mu)%b(2,1)
      clinetzz(i3,i4,mu)%c(2,1)=lg1_34(i3,i4)%c(2,1)*p134q*rz2_1
     & 34(mu)%d(1,1)+lg1_34(i3,i4)%a(2,2)*rz2_134(mu)%c(2,1)
      clinetzz(i3,i4,mu)%d(2,1)=rmass(id1)*(lg1_34(i3,i4)%b(2,1)
     & *rz2_134(mu)%d(1,1)+lg1_34(i3,i4)%d(2,2)*rz2_134(mu)%c(2,
     & 1))
      clinetzz(i3,i4,mu)%a(2,2)=lg1_34(i3,i4)%c(2,1)*p134q*rz2_1
     & 34(mu)%b(1,2)+lg1_34(i3,i4)%a(2,2)*rz2_134(mu)%a(2,2)
      clinetzz(i3,i4,mu)%b(2,2)=rmass(id1)*(lg1_34(i3,i4)%b(2,1)
     & *rz2_134(mu)%b(1,2)+lg1_34(i3,i4)%d(2,2)*rz2_134(mu)%a(2,
     & 2))
      clinetzz(i3,i4,mu)%c(2,2)=rmass(id1)*(lg1_34(i3,i4)%c(2,1)
     & *rz2_134(mu)%c(1,2)+lg1_34(i3,i4)%a(2,2)*rz2_134(mu)%d(2,
     & 2))
      clinetzz(i3,i4,mu)%d(2,2)=lg1_34(i3,i4)%b(2,1)*rz2_134(mu)
     & %c(1,2)+lg1_34(i3,i4)%d(2,2)*p134q*rz2_134(mu)%d(2,2)
      end do
      end do
      end do
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TT -- aa=clinetzz(i3,i4,mu)%a,bb=clinetzz(i3,i4,mu)%b,cc=clinetzz(i3,i
* 4,mu)%c,dd=clinetzz(i3,i4,mu)%d,a1=lz1_234(mu)%a,b1=lz1_234(mu)%b,c1=l
* z1_234(mu)%c,d1=lz1_234(mu)%d,a2=rg2_34(i3,i4)%a,b2=rg2_34(i3,i4)%b,c2
* =rg2_34(i3,i4)%c,d2=rg2_34(i3,i4)%d,prq=p234q,m=rmass(id1),nsum=1
      clinetzz(i3,i4,mu)%a(1,1)=clinetzz(i3,i4,mu)%a(1,1)+lz1_23
     & 4(mu)%a(1,1)*rg2_34(i3,i4)%a(1,1)+lz1_234(mu)%c(1,2)*p234
     & q*rg2_34(i3,i4)%b(2,1)
      clinetzz(i3,i4,mu)%b(1,1)=clinetzz(i3,i4,mu)%b(1,1)+rmass(
     & id1)*(lz1_234(mu)%d(1,1)*rg2_34(i3,i4)%a(1,1)+lz1_234(mu)
     & %b(1,2)*rg2_34(i3,i4)%b(2,1))
      clinetzz(i3,i4,mu)%c(1,1)=clinetzz(i3,i4,mu)%c(1,1)+rmass(
     & id1)*(lz1_234(mu)%a(1,1)*rg2_34(i3,i4)%d(1,1)+lz1_234(mu)
     & %c(1,2)*rg2_34(i3,i4)%c(2,1))
      clinetzz(i3,i4,mu)%d(1,1)=clinetzz(i3,i4,mu)%d(1,1)+lz1_23
     & 4(mu)%d(1,1)*p234q*rg2_34(i3,i4)%d(1,1)+lz1_234(mu)%b(1,2
     & )*rg2_34(i3,i4)%c(2,1)
      clinetzz(i3,i4,mu)%a(1,2)=clinetzz(i3,i4,mu)%a(1,2)+rmass(
     & id1)*(lz1_234(mu)%a(1,1)*rg2_34(i3,i4)%b(1,2)+lz1_234(mu)
     & %c(1,2)*rg2_34(i3,i4)%a(2,2))
      clinetzz(i3,i4,mu)%b(1,2)=clinetzz(i3,i4,mu)%b(1,2)+lz1_23
     & 4(mu)%d(1,1)*p234q*rg2_34(i3,i4)%b(1,2)+lz1_234(mu)%b(1,2
     & )*rg2_34(i3,i4)%a(2,2)
      clinetzz(i3,i4,mu)%c(1,2)=clinetzz(i3,i4,mu)%c(1,2)+lz1_23
     & 4(mu)%a(1,1)*rg2_34(i3,i4)%c(1,2)+lz1_234(mu)%c(1,2)*p234
     & q*rg2_34(i3,i4)%d(2,2)
      clinetzz(i3,i4,mu)%d(1,2)=clinetzz(i3,i4,mu)%d(1,2)+rmass(
     & id1)*(lz1_234(mu)%d(1,1)*rg2_34(i3,i4)%c(1,2)+lz1_234(mu)
     & %b(1,2)*rg2_34(i3,i4)%d(2,2))
      clinetzz(i3,i4,mu)%a(2,1)=clinetzz(i3,i4,mu)%a(2,1)+rmass(
     & id1)*(lz1_234(mu)%c(2,1)*rg2_34(i3,i4)%a(1,1)+lz1_234(mu)
     & %a(2,2)*rg2_34(i3,i4)%b(2,1))
      clinetzz(i3,i4,mu)%b(2,1)=clinetzz(i3,i4,mu)%b(2,1)+lz1_23
     & 4(mu)%b(2,1)*rg2_34(i3,i4)%a(1,1)+lz1_234(mu)%d(2,2)*p234
     & q*rg2_34(i3,i4)%b(2,1)
      clinetzz(i3,i4,mu)%c(2,1)=clinetzz(i3,i4,mu)%c(2,1)+lz1_23
     & 4(mu)%c(2,1)*p234q*rg2_34(i3,i4)%d(1,1)+lz1_234(mu)%a(2,2
     & )*rg2_34(i3,i4)%c(2,1)
      clinetzz(i3,i4,mu)%d(2,1)=clinetzz(i3,i4,mu)%d(2,1)+rmass(
     & id1)*(lz1_234(mu)%b(2,1)*rg2_34(i3,i4)%d(1,1)+lz1_234(mu)
     & %d(2,2)*rg2_34(i3,i4)%c(2,1))
      clinetzz(i3,i4,mu)%a(2,2)=clinetzz(i3,i4,mu)%a(2,2)+lz1_23
     & 4(mu)%c(2,1)*p234q*rg2_34(i3,i4)%b(1,2)+lz1_234(mu)%a(2,2
     & )*rg2_34(i3,i4)%a(2,2)
      clinetzz(i3,i4,mu)%b(2,2)=clinetzz(i3,i4,mu)%b(2,2)+rmass(
     & id1)*(lz1_234(mu)%b(2,1)*rg2_34(i3,i4)%b(1,2)+lz1_234(mu)
     & %d(2,2)*rg2_34(i3,i4)%a(2,2))
      clinetzz(i3,i4,mu)%c(2,2)=clinetzz(i3,i4,mu)%c(2,2)+rmass(
     & id1)*(lz1_234(mu)%c(2,1)*rg2_34(i3,i4)%c(1,2)+lz1_234(mu)
     & %a(2,2)*rg2_34(i3,i4)%d(2,2))
      clinetzz(i3,i4,mu)%d(2,2)=clinetzz(i3,i4,mu)%d(2,2)+lz1_23
     & 4(mu)%b(2,1)*rg2_34(i3,i4)%c(1,2)+lz1_234(mu)%d(2,2)*p234
     & q*rg2_34(i3,i4)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id1)
      rmassr=-rmass(id1)
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=czqcd1234(&1,&2,i3,i4,mu),abcd=clinetzz(i3,i4,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      czqcd1234(iut,jut,i3,i4,mu)=czqcd1234(iut,jut,i3,i4,mu)+cl
     & inetzz(i3,i4,mu)%a(iut,jut)+rmassl*clinetzz(i3,i4,mu)%b(i
     & ut,jut)+rmassr*clinetzz(i3,i4,mu)%c(iut,jut)+rmassl*rmass
     & r*clinetzz(i3,i4,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TT -- aa=clinetfz(i1,i2,mu)%a,bb=clinetfz(i1,i2,mu)%b,cc=clinetfz(i1,i
* 2,mu)%c,dd=clinetfz(i1,i2,mu)%d,a1=lg3_12(i1,i2)%a,b1=lg3_12(i1,i2)%b,
* c1=lg3_12(i1,i2)%c,d1=lg3_12(i1,i2)%d,a2=rf4_312(mu)%a,b2=rf4_312(mu)%
* b,c2=rf4_312(mu)%c,d2=rf4_312(mu)%d,prq=p312q,m=rmass(id3),nsum=0
      clinetfz(i1,i2,mu)%a(1,1)=lg3_12(i1,i2)%a(1,1)*rf4_312(mu)
     & %a(1,1)+lg3_12(i1,i2)%c(1,2)*p312q*rf4_312(mu)%b(2,1)
      clinetfz(i1,i2,mu)%b(1,1)=rmass(id3)*(lg3_12(i1,i2)%d(1,1)
     & *rf4_312(mu)%a(1,1)+lg3_12(i1,i2)%b(1,2)*rf4_312(mu)%b(2,
     & 1))
      clinetfz(i1,i2,mu)%c(1,1)=rmass(id3)*(lg3_12(i1,i2)%a(1,1)
     & *rf4_312(mu)%d(1,1)+lg3_12(i1,i2)%c(1,2)*rf4_312(mu)%c(2,
     & 1))
      clinetfz(i1,i2,mu)%d(1,1)=lg3_12(i1,i2)%d(1,1)*p312q*rf4_3
     & 12(mu)%d(1,1)+lg3_12(i1,i2)%b(1,2)*rf4_312(mu)%c(2,1)
      clinetfz(i1,i2,mu)%a(1,2)=rmass(id3)*(lg3_12(i1,i2)%a(1,1)
     & *rf4_312(mu)%b(1,2)+lg3_12(i1,i2)%c(1,2)*rf4_312(mu)%a(2,
     & 2))
      clinetfz(i1,i2,mu)%b(1,2)=lg3_12(i1,i2)%d(1,1)*p312q*rf4_3
     & 12(mu)%b(1,2)+lg3_12(i1,i2)%b(1,2)*rf4_312(mu)%a(2,2)
      clinetfz(i1,i2,mu)%c(1,2)=lg3_12(i1,i2)%a(1,1)*rf4_312(mu)
     & %c(1,2)+lg3_12(i1,i2)%c(1,2)*p312q*rf4_312(mu)%d(2,2)
      clinetfz(i1,i2,mu)%d(1,2)=rmass(id3)*(lg3_12(i1,i2)%d(1,1)
     & *rf4_312(mu)%c(1,2)+lg3_12(i1,i2)%b(1,2)*rf4_312(mu)%d(2,
     & 2))
      clinetfz(i1,i2,mu)%a(2,1)=rmass(id3)*(lg3_12(i1,i2)%c(2,1)
     & *rf4_312(mu)%a(1,1)+lg3_12(i1,i2)%a(2,2)*rf4_312(mu)%b(2,
     & 1))
      clinetfz(i1,i2,mu)%b(2,1)=lg3_12(i1,i2)%b(2,1)*rf4_312(mu)
     & %a(1,1)+lg3_12(i1,i2)%d(2,2)*p312q*rf4_312(mu)%b(2,1)
      clinetfz(i1,i2,mu)%c(2,1)=lg3_12(i1,i2)%c(2,1)*p312q*rf4_3
     & 12(mu)%d(1,1)+lg3_12(i1,i2)%a(2,2)*rf4_312(mu)%c(2,1)
      clinetfz(i1,i2,mu)%d(2,1)=rmass(id3)*(lg3_12(i1,i2)%b(2,1)
     & *rf4_312(mu)%d(1,1)+lg3_12(i1,i2)%d(2,2)*rf4_312(mu)%c(2,
     & 1))
      clinetfz(i1,i2,mu)%a(2,2)=lg3_12(i1,i2)%c(2,1)*p312q*rf4_3
     & 12(mu)%b(1,2)+lg3_12(i1,i2)%a(2,2)*rf4_312(mu)%a(2,2)
      clinetfz(i1,i2,mu)%b(2,2)=rmass(id3)*(lg3_12(i1,i2)%b(2,1)
     & *rf4_312(mu)%b(1,2)+lg3_12(i1,i2)%d(2,2)*rf4_312(mu)%a(2,
     & 2))
      clinetfz(i1,i2,mu)%c(2,2)=rmass(id3)*(lg3_12(i1,i2)%c(2,1)
     & *rf4_312(mu)%c(1,2)+lg3_12(i1,i2)%a(2,2)*rf4_312(mu)%d(2,
     & 2))
      clinetfz(i1,i2,mu)%d(2,2)=lg3_12(i1,i2)%b(2,1)*rf4_312(mu)
     & %c(1,2)+lg3_12(i1,i2)%d(2,2)*p312q*rf4_312(mu)%d(2,2)
      end do
      end do
      end do
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TT -- aa=clinetfz(i1,i2,mu)%a,bb=clinetfz(i1,i2,mu)%b,cc=clinetfz(i1,i
* 2,mu)%c,dd=clinetfz(i1,i2,mu)%d,a1=lf3_412(mu)%a,b1=lf3_412(mu)%b,c1=l
* f3_412(mu)%c,d1=lf3_412(mu)%d,a2=rg4_12(i1,i2)%a,b2=rg4_12(i1,i2)%b,c2
* =rg4_12(i1,i2)%c,d2=rg4_12(i1,i2)%d,prq=p412q,m=rmass(id3),nsum=1
      clinetfz(i1,i2,mu)%a(1,1)=clinetfz(i1,i2,mu)%a(1,1)+lf3_41
     & 2(mu)%a(1,1)*rg4_12(i1,i2)%a(1,1)+lf3_412(mu)%c(1,2)*p412
     & q*rg4_12(i1,i2)%b(2,1)
      clinetfz(i1,i2,mu)%b(1,1)=clinetfz(i1,i2,mu)%b(1,1)+rmass(
     & id3)*(lf3_412(mu)%d(1,1)*rg4_12(i1,i2)%a(1,1)+lf3_412(mu)
     & %b(1,2)*rg4_12(i1,i2)%b(2,1))
      clinetfz(i1,i2,mu)%c(1,1)=clinetfz(i1,i2,mu)%c(1,1)+rmass(
     & id3)*(lf3_412(mu)%a(1,1)*rg4_12(i1,i2)%d(1,1)+lf3_412(mu)
     & %c(1,2)*rg4_12(i1,i2)%c(2,1))
      clinetfz(i1,i2,mu)%d(1,1)=clinetfz(i1,i2,mu)%d(1,1)+lf3_41
     & 2(mu)%d(1,1)*p412q*rg4_12(i1,i2)%d(1,1)+lf3_412(mu)%b(1,2
     & )*rg4_12(i1,i2)%c(2,1)
      clinetfz(i1,i2,mu)%a(1,2)=clinetfz(i1,i2,mu)%a(1,2)+rmass(
     & id3)*(lf3_412(mu)%a(1,1)*rg4_12(i1,i2)%b(1,2)+lf3_412(mu)
     & %c(1,2)*rg4_12(i1,i2)%a(2,2))
      clinetfz(i1,i2,mu)%b(1,2)=clinetfz(i1,i2,mu)%b(1,2)+lf3_41
     & 2(mu)%d(1,1)*p412q*rg4_12(i1,i2)%b(1,2)+lf3_412(mu)%b(1,2
     & )*rg4_12(i1,i2)%a(2,2)
      clinetfz(i1,i2,mu)%c(1,2)=clinetfz(i1,i2,mu)%c(1,2)+lf3_41
     & 2(mu)%a(1,1)*rg4_12(i1,i2)%c(1,2)+lf3_412(mu)%c(1,2)*p412
     & q*rg4_12(i1,i2)%d(2,2)
      clinetfz(i1,i2,mu)%d(1,2)=clinetfz(i1,i2,mu)%d(1,2)+rmass(
     & id3)*(lf3_412(mu)%d(1,1)*rg4_12(i1,i2)%c(1,2)+lf3_412(mu)
     & %b(1,2)*rg4_12(i1,i2)%d(2,2))
      clinetfz(i1,i2,mu)%a(2,1)=clinetfz(i1,i2,mu)%a(2,1)+rmass(
     & id3)*(lf3_412(mu)%c(2,1)*rg4_12(i1,i2)%a(1,1)+lf3_412(mu)
     & %a(2,2)*rg4_12(i1,i2)%b(2,1))
      clinetfz(i1,i2,mu)%b(2,1)=clinetfz(i1,i2,mu)%b(2,1)+lf3_41
     & 2(mu)%b(2,1)*rg4_12(i1,i2)%a(1,1)+lf3_412(mu)%d(2,2)*p412
     & q*rg4_12(i1,i2)%b(2,1)
      clinetfz(i1,i2,mu)%c(2,1)=clinetfz(i1,i2,mu)%c(2,1)+lf3_41
     & 2(mu)%c(2,1)*p412q*rg4_12(i1,i2)%d(1,1)+lf3_412(mu)%a(2,2
     & )*rg4_12(i1,i2)%c(2,1)
      clinetfz(i1,i2,mu)%d(2,1)=clinetfz(i1,i2,mu)%d(2,1)+rmass(
     & id3)*(lf3_412(mu)%b(2,1)*rg4_12(i1,i2)%d(1,1)+lf3_412(mu)
     & %d(2,2)*rg4_12(i1,i2)%c(2,1))
      clinetfz(i1,i2,mu)%a(2,2)=clinetfz(i1,i2,mu)%a(2,2)+lf3_41
     & 2(mu)%c(2,1)*p412q*rg4_12(i1,i2)%b(1,2)+lf3_412(mu)%a(2,2
     & )*rg4_12(i1,i2)%a(2,2)
      clinetfz(i1,i2,mu)%b(2,2)=clinetfz(i1,i2,mu)%b(2,2)+rmass(
     & id3)*(lf3_412(mu)%b(2,1)*rg4_12(i1,i2)%b(1,2)+lf3_412(mu)
     & %d(2,2)*rg4_12(i1,i2)%a(2,2))
      clinetfz(i1,i2,mu)%c(2,2)=clinetfz(i1,i2,mu)%c(2,2)+rmass(
     & id3)*(lf3_412(mu)%c(2,1)*rg4_12(i1,i2)%c(1,2)+lf3_412(mu)
     & %a(2,2)*rg4_12(i1,i2)%d(2,2))
      clinetfz(i1,i2,mu)%d(2,2)=clinetfz(i1,i2,mu)%d(2,2)+lf3_41
     & 2(mu)%b(2,1)*rg4_12(i1,i2)%c(1,2)+lf3_412(mu)%d(2,2)*p412
     & q*rg4_12(i1,i2)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id3)
      rmassr=-rmass(id3)
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=cfqcd1234(i1,i2,&1,&2,mu),abcd=clinetfz(i1,i2,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cfqcd1234(i1,i2,iut,jut,mu)=clinetfz(i1,i2,mu)%a(iut,jut)+
     & rmassl*clinetfz(i1,i2,mu)%b(iut,jut)+rmassr*clinetfz(i1,i
     & 2,mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i1,i2,mu)%d(iut,j
     & ut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TT -- aa=clinetfz(i3,i4,mu)%a,bb=clinetfz(i3,i4,mu)%b,cc=clinetfz(i3,i
* 4,mu)%c,dd=clinetfz(i3,i4,mu)%d,a1=lg1_34(i3,i4)%a,b1=lg1_34(i3,i4)%b,
* c1=lg1_34(i3,i4)%c,d1=lg1_34(i3,i4)%d,a2=rf2_134(mu)%a,b2=rf2_134(mu)%
* b,c2=rf2_134(mu)%c,d2=rf2_134(mu)%d,prq=p134q,m=rmass(id1),nsum=0
      clinetfz(i3,i4,mu)%a(1,1)=lg1_34(i3,i4)%a(1,1)*rf2_134(mu)
     & %a(1,1)+lg1_34(i3,i4)%c(1,2)*p134q*rf2_134(mu)%b(2,1)
      clinetfz(i3,i4,mu)%b(1,1)=rmass(id1)*(lg1_34(i3,i4)%d(1,1)
     & *rf2_134(mu)%a(1,1)+lg1_34(i3,i4)%b(1,2)*rf2_134(mu)%b(2,
     & 1))
      clinetfz(i3,i4,mu)%c(1,1)=rmass(id1)*(lg1_34(i3,i4)%a(1,1)
     & *rf2_134(mu)%d(1,1)+lg1_34(i3,i4)%c(1,2)*rf2_134(mu)%c(2,
     & 1))
      clinetfz(i3,i4,mu)%d(1,1)=lg1_34(i3,i4)%d(1,1)*p134q*rf2_1
     & 34(mu)%d(1,1)+lg1_34(i3,i4)%b(1,2)*rf2_134(mu)%c(2,1)
      clinetfz(i3,i4,mu)%a(1,2)=rmass(id1)*(lg1_34(i3,i4)%a(1,1)
     & *rf2_134(mu)%b(1,2)+lg1_34(i3,i4)%c(1,2)*rf2_134(mu)%a(2,
     & 2))
      clinetfz(i3,i4,mu)%b(1,2)=lg1_34(i3,i4)%d(1,1)*p134q*rf2_1
     & 34(mu)%b(1,2)+lg1_34(i3,i4)%b(1,2)*rf2_134(mu)%a(2,2)
      clinetfz(i3,i4,mu)%c(1,2)=lg1_34(i3,i4)%a(1,1)*rf2_134(mu)
     & %c(1,2)+lg1_34(i3,i4)%c(1,2)*p134q*rf2_134(mu)%d(2,2)
      clinetfz(i3,i4,mu)%d(1,2)=rmass(id1)*(lg1_34(i3,i4)%d(1,1)
     & *rf2_134(mu)%c(1,2)+lg1_34(i3,i4)%b(1,2)*rf2_134(mu)%d(2,
     & 2))
      clinetfz(i3,i4,mu)%a(2,1)=rmass(id1)*(lg1_34(i3,i4)%c(2,1)
     & *rf2_134(mu)%a(1,1)+lg1_34(i3,i4)%a(2,2)*rf2_134(mu)%b(2,
     & 1))
      clinetfz(i3,i4,mu)%b(2,1)=lg1_34(i3,i4)%b(2,1)*rf2_134(mu)
     & %a(1,1)+lg1_34(i3,i4)%d(2,2)*p134q*rf2_134(mu)%b(2,1)
      clinetfz(i3,i4,mu)%c(2,1)=lg1_34(i3,i4)%c(2,1)*p134q*rf2_1
     & 34(mu)%d(1,1)+lg1_34(i3,i4)%a(2,2)*rf2_134(mu)%c(2,1)
      clinetfz(i3,i4,mu)%d(2,1)=rmass(id1)*(lg1_34(i3,i4)%b(2,1)
     & *rf2_134(mu)%d(1,1)+lg1_34(i3,i4)%d(2,2)*rf2_134(mu)%c(2,
     & 1))
      clinetfz(i3,i4,mu)%a(2,2)=lg1_34(i3,i4)%c(2,1)*p134q*rf2_1
     & 34(mu)%b(1,2)+lg1_34(i3,i4)%a(2,2)*rf2_134(mu)%a(2,2)
      clinetfz(i3,i4,mu)%b(2,2)=rmass(id1)*(lg1_34(i3,i4)%b(2,1)
     & *rf2_134(mu)%b(1,2)+lg1_34(i3,i4)%d(2,2)*rf2_134(mu)%a(2,
     & 2))
      clinetfz(i3,i4,mu)%c(2,2)=rmass(id1)*(lg1_34(i3,i4)%c(2,1)
     & *rf2_134(mu)%c(1,2)+lg1_34(i3,i4)%a(2,2)*rf2_134(mu)%d(2,
     & 2))
      clinetfz(i3,i4,mu)%d(2,2)=lg1_34(i3,i4)%b(2,1)*rf2_134(mu)
     & %c(1,2)+lg1_34(i3,i4)%d(2,2)*p134q*rf2_134(mu)%d(2,2)
      end do
      end do
      end do
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TT -- aa=clinetfz(i3,i4,mu)%a,bb=clinetfz(i3,i4,mu)%b,cc=clinetfz(i3,i
* 4,mu)%c,dd=clinetfz(i3,i4,mu)%d,a1=lf1_234(mu)%a,b1=lf1_234(mu)%b,c1=l
* f1_234(mu)%c,d1=lf1_234(mu)%d,a2=rg2_34(i3,i4)%a,b2=rg2_34(i3,i4)%b,c2
* =rg2_34(i3,i4)%c,d2=rg2_34(i3,i4)%d,prq=p234q,m=rmass(id1),nsum=1
      clinetfz(i3,i4,mu)%a(1,1)=clinetfz(i3,i4,mu)%a(1,1)+lf1_23
     & 4(mu)%a(1,1)*rg2_34(i3,i4)%a(1,1)+lf1_234(mu)%c(1,2)*p234
     & q*rg2_34(i3,i4)%b(2,1)
      clinetfz(i3,i4,mu)%b(1,1)=clinetfz(i3,i4,mu)%b(1,1)+rmass(
     & id1)*(lf1_234(mu)%d(1,1)*rg2_34(i3,i4)%a(1,1)+lf1_234(mu)
     & %b(1,2)*rg2_34(i3,i4)%b(2,1))
      clinetfz(i3,i4,mu)%c(1,1)=clinetfz(i3,i4,mu)%c(1,1)+rmass(
     & id1)*(lf1_234(mu)%a(1,1)*rg2_34(i3,i4)%d(1,1)+lf1_234(mu)
     & %c(1,2)*rg2_34(i3,i4)%c(2,1))
      clinetfz(i3,i4,mu)%d(1,1)=clinetfz(i3,i4,mu)%d(1,1)+lf1_23
     & 4(mu)%d(1,1)*p234q*rg2_34(i3,i4)%d(1,1)+lf1_234(mu)%b(1,2
     & )*rg2_34(i3,i4)%c(2,1)
      clinetfz(i3,i4,mu)%a(1,2)=clinetfz(i3,i4,mu)%a(1,2)+rmass(
     & id1)*(lf1_234(mu)%a(1,1)*rg2_34(i3,i4)%b(1,2)+lf1_234(mu)
     & %c(1,2)*rg2_34(i3,i4)%a(2,2))
      clinetfz(i3,i4,mu)%b(1,2)=clinetfz(i3,i4,mu)%b(1,2)+lf1_23
     & 4(mu)%d(1,1)*p234q*rg2_34(i3,i4)%b(1,2)+lf1_234(mu)%b(1,2
     & )*rg2_34(i3,i4)%a(2,2)
      clinetfz(i3,i4,mu)%c(1,2)=clinetfz(i3,i4,mu)%c(1,2)+lf1_23
     & 4(mu)%a(1,1)*rg2_34(i3,i4)%c(1,2)+lf1_234(mu)%c(1,2)*p234
     & q*rg2_34(i3,i4)%d(2,2)
      clinetfz(i3,i4,mu)%d(1,2)=clinetfz(i3,i4,mu)%d(1,2)+rmass(
     & id1)*(lf1_234(mu)%d(1,1)*rg2_34(i3,i4)%c(1,2)+lf1_234(mu)
     & %b(1,2)*rg2_34(i3,i4)%d(2,2))
      clinetfz(i3,i4,mu)%a(2,1)=clinetfz(i3,i4,mu)%a(2,1)+rmass(
     & id1)*(lf1_234(mu)%c(2,1)*rg2_34(i3,i4)%a(1,1)+lf1_234(mu)
     & %a(2,2)*rg2_34(i3,i4)%b(2,1))
      clinetfz(i3,i4,mu)%b(2,1)=clinetfz(i3,i4,mu)%b(2,1)+lf1_23
     & 4(mu)%b(2,1)*rg2_34(i3,i4)%a(1,1)+lf1_234(mu)%d(2,2)*p234
     & q*rg2_34(i3,i4)%b(2,1)
      clinetfz(i3,i4,mu)%c(2,1)=clinetfz(i3,i4,mu)%c(2,1)+lf1_23
     & 4(mu)%c(2,1)*p234q*rg2_34(i3,i4)%d(1,1)+lf1_234(mu)%a(2,2
     & )*rg2_34(i3,i4)%c(2,1)
      clinetfz(i3,i4,mu)%d(2,1)=clinetfz(i3,i4,mu)%d(2,1)+rmass(
     & id1)*(lf1_234(mu)%b(2,1)*rg2_34(i3,i4)%d(1,1)+lf1_234(mu)
     & %d(2,2)*rg2_34(i3,i4)%c(2,1))
      clinetfz(i3,i4,mu)%a(2,2)=clinetfz(i3,i4,mu)%a(2,2)+lf1_23
     & 4(mu)%c(2,1)*p234q*rg2_34(i3,i4)%b(1,2)+lf1_234(mu)%a(2,2
     & )*rg2_34(i3,i4)%a(2,2)
      clinetfz(i3,i4,mu)%b(2,2)=clinetfz(i3,i4,mu)%b(2,2)+rmass(
     & id1)*(lf1_234(mu)%b(2,1)*rg2_34(i3,i4)%b(1,2)+lf1_234(mu)
     & %d(2,2)*rg2_34(i3,i4)%a(2,2))
      clinetfz(i3,i4,mu)%c(2,2)=clinetfz(i3,i4,mu)%c(2,2)+rmass(
     & id1)*(lf1_234(mu)%c(2,1)*rg2_34(i3,i4)%c(1,2)+lf1_234(mu)
     & %a(2,2)*rg2_34(i3,i4)%d(2,2))
      clinetfz(i3,i4,mu)%d(2,2)=clinetfz(i3,i4,mu)%d(2,2)+lf1_23
     & 4(mu)%b(2,1)*rg2_34(i3,i4)%c(1,2)+lf1_234(mu)%d(2,2)*p234
     & q*rg2_34(i3,i4)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id1)
      rmassr=-rmass(id1)
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=cfqcd1234(&1,&2,i3,i4,mu),abcd=clinetfz(i3,i4,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cfqcd1234(iut,jut,i3,i4,mu)=cfqcd1234(iut,jut,i3,i4,mu)+cl
     & inetfz(i3,i4,mu)%a(iut,jut)+rmassl*clinetfz(i3,i4,mu)%b(i
     & ut,jut)+rmassr*clinetfz(i3,i4,mu)%c(iut,jut)+rmassl*rmass
     & r*clinetfz(i3,i4,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
  
*                                                                       
* Then link the computed subdiagrams with the "Z" and "gamma" insertions
* [cz5678(2,2,2,2,0:3) and cf5678(2,2,2,2,0:3)]%                        
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2)   
*                                                                       
  
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
  
* "Z" insertion                                                         
* p.q -- p.q=cp1234dotczqcd1234,p=p1234(#),q=czqcd1234(i1,i2,i3,i4,#),be
* f=,aft=
      cp1234dotczqcd1234=(p1234(0)*czqcd1234(i1,i2,i3,i4,0)-p123
     & 4(1)*czqcd1234(i1,i2,i3,i4,1)-p1234(2)*czqcd1234(i1,i2,i3
     & ,i4,2)-p1234(3)*czqcd1234(i1,i2,i3,i4,3))
  
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2),p=czqcd1234(i1,i2,i3,
* i4,#),q=cz5678(i5,i6,i7,i8,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2
* )-,aft=/(p1234q-cmz2)
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,2)-(czqcd1234(i1,i2,i3,i4,0)*cz5678(i5,i6,
     & i7,i8,0)-czqcd1234(i1,i2,i3,i4,1)*cz5678(i5,i6,i7,i8,1)-c
     & zqcd1234(i1,i2,i3,i4,2)*cz5678(i5,i6,i7,i8,2)-czqcd1234(i
     & 1,i2,i3,i4,3)*cz5678(i5,i6,i7,i8,3))/(p1234q-cmz2)
  
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) =
     &   cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) +
     &   (cp1234dotczqcd1234*cp1234dotcz5678(i5,i6,i7,i8))
     &   /cmz2/(p1234q-cmz2)
  
* "gamma" insertion                                                     
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2),p=cfqcd1234(i1,i2,i3,
* i4,#),q=cf5678(i5,i6,i7,i8,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2
* )-,aft=/p1234q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,2)-(cfqcd1234(i1,i2,i3,i4,0)*cf5678(i5,i6,
     & i7,i8,0)-cfqcd1234(i1,i2,i3,i4,1)*cf5678(i5,i6,i7,i8,1)-c
     & fqcd1234(i1,i2,i3,i4,2)*cf5678(i5,i6,i7,i8,2)-cfqcd1234(i
     & 1,i2,i3,i4,3)*cf5678(i5,i6,i7,i8,3))/p1234q
  
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
*****************Compute diagrams of class 2.c)*************************
*                                                                       
*First compute subdiagrams of the type  [chqcd1234(2,2,2,2)]            
*                                                                       
*                                                                       
  
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              chqcd1234(i1,i2,i3,i4)=czero
            enddo
          enddo
        enddo
      enddo
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.rmh.ge.0.d0) then
  
      do i3=1,2
      do i4=1,2
* TTSC -- aa=clineth_4f(i3,i4)%a,bb=clineth_4f(i3,i4)%b,cc=clineth_4f(i3
* ,i4)%c,dd=clineth_4f(i3,i4)%d,a1=lg1_34(i3,i4)%a,b1=lg1_34(i3,i4)%b,c1
* =lg1_34(i3,i4)%c,d1=lg1_34(i3,i4)%d,a2=rh2_134%a,b2=rh2_134%b,c2=rh2_1
* 34%c,prq=p134q,m=rmass(id1),nsum=0
      clineth_4f(i3,i4)%a(1,2)=lg1_34(i3,i4)%a(1,1)*rh2_134%a(1,
     & 2)+lg1_34(i3,i4)%c(1,2)*p134q*rh2_134%b(2,2)
      clineth_4f(i3,i4)%b(1,2)=rmass(id1)*(lg1_34(i3,i4)%d(1,1)*
     & rh2_134%a(1,2)+lg1_34(i3,i4)%b(1,2)*rh2_134%b(2,2))
      clineth_4f(i3,i4)%c(1,2)=rmass(id1)*lg1_34(i3,i4)%c(1,2)*r
     & h2_134%c(2,2)
      clineth_4f(i3,i4)%d(1,2)=lg1_34(i3,i4)%b(1,2)*rh2_134%c(2,
     & 2)
      clineth_4f(i3,i4)%a(1,1)=rmass(id1)*(lg1_34(i3,i4)%a(1,1)*
     & rh2_134%b(1,1)+lg1_34(i3,i4)%c(1,2)*rh2_134%a(2,1))
      clineth_4f(i3,i4)%b(1,1)=lg1_34(i3,i4)%d(1,1)*p134q*rh2_13
     & 4%b(1,1)+lg1_34(i3,i4)%b(1,2)*rh2_134%a(2,1)
      clineth_4f(i3,i4)%c(1,1)=lg1_34(i3,i4)%a(1,1)*rh2_134%c(1,
     & 1)
      clineth_4f(i3,i4)%d(1,1)=rmass(id1)*lg1_34(i3,i4)%d(1,1)*r
     & h2_134%c(1,1)
      clineth_4f(i3,i4)%a(2,2)=rmass(id1)*(lg1_34(i3,i4)%c(2,1)*
     & rh2_134%a(1,2)+lg1_34(i3,i4)%a(2,2)*rh2_134%b(2,2))
      clineth_4f(i3,i4)%b(2,2)=lg1_34(i3,i4)%b(2,1)*rh2_134%a(1,
     & 2)+lg1_34(i3,i4)%d(2,2)*p134q*rh2_134%b(2,2)
      clineth_4f(i3,i4)%c(2,2)=lg1_34(i3,i4)%a(2,2)*rh2_134%c(2,
     & 2)
      clineth_4f(i3,i4)%d(2,2)=rmass(id1)*lg1_34(i3,i4)%d(2,2)*r
     & h2_134%c(2,2)
      clineth_4f(i3,i4)%a(2,1)=lg1_34(i3,i4)%c(2,1)*p134q*rh2_13
     & 4%b(1,1)+lg1_34(i3,i4)%a(2,2)*rh2_134%a(2,1)
      clineth_4f(i3,i4)%b(2,1)=rmass(id1)*(lg1_34(i3,i4)%b(2,1)*
     & rh2_134%b(1,1)+lg1_34(i3,i4)%d(2,2)*rh2_134%a(2,1))
      clineth_4f(i3,i4)%c(2,1)=rmass(id1)*lg1_34(i3,i4)%c(2,1)*r
     & h2_134%c(1,1)
      clineth_4f(i3,i4)%d(2,1)=lg1_34(i3,i4)%b(2,1)*rh2_134%c(1,
     & 1)
      end do
      end do
  
      do i3=1,2
      do i4=1,2
* TSCT -- aa=clineth_4f(i3,i4)%a,bb=clineth_4f(i3,i4)%b,cc=clineth_4f(i3
* ,i4)%c,dd=clineth_4f(i3,i4)%d,a1=lh1_234%a,b1=lh1_234%b,c1=lh1_234%c,a
* 2=rg2_34(i3,i4)%a,b2=rg2_34(i3,i4)%b,c2=rg2_34(i3,i4)%c,d2=rg2_34(i3,i
* 4)%d,prq=p234q,m=rmass(id1),nsum=1
      clineth_4f(i3,i4)%a(2,1)=clineth_4f(i3,i4)%a(2,1)+lh1_234%
     & a(2,1)*rg2_34(i3,i4)%a(1,1)+lh1_234%c(2,2)*p234q*rg2_34(i
     & 3,i4)%b(2,1)
      clineth_4f(i3,i4)%b(2,1)=clineth_4f(i3,i4)%b(2,1)+rmass(id
     & 1)*lh1_234%b(2,2)*rg2_34(i3,i4)%b(2,1)
      clineth_4f(i3,i4)%c(2,1)=clineth_4f(i3,i4)%c(2,1)+rmass(id
     & 1)*(lh1_234%a(2,1)*rg2_34(i3,i4)%d(1,1)+lh1_234%c(2,2)*rg
     & 2_34(i3,i4)%c(2,1))
      clineth_4f(i3,i4)%d(2,1)=clineth_4f(i3,i4)%d(2,1)+lh1_234%
     & b(2,2)*rg2_34(i3,i4)%c(2,1)
      clineth_4f(i3,i4)%a(2,2)=clineth_4f(i3,i4)%a(2,2)+rmass(id
     & 1)*(lh1_234%a(2,1)*rg2_34(i3,i4)%b(1,2)+lh1_234%c(2,2)*rg
     & 2_34(i3,i4)%a(2,2))
      clineth_4f(i3,i4)%b(2,2)=clineth_4f(i3,i4)%b(2,2)+lh1_234%
     & b(2,2)*rg2_34(i3,i4)%a(2,2)
      clineth_4f(i3,i4)%c(2,2)=clineth_4f(i3,i4)%c(2,2)+lh1_234%
     & a(2,1)*rg2_34(i3,i4)%c(1,2)+lh1_234%c(2,2)*p234q*rg2_34(i
     & 3,i4)%d(2,2)
      clineth_4f(i3,i4)%d(2,2)=clineth_4f(i3,i4)%d(2,2)+rmass(id
     & 1)*lh1_234%b(2,2)*rg2_34(i3,i4)%d(2,2)
      clineth_4f(i3,i4)%a(1,1)=clineth_4f(i3,i4)%a(1,1)+rmass(id
     & 1)*(lh1_234%c(1,1)*rg2_34(i3,i4)%a(1,1)+lh1_234%a(1,2)*rg
     & 2_34(i3,i4)%b(2,1))
      clineth_4f(i3,i4)%b(1,1)=clineth_4f(i3,i4)%b(1,1)+lh1_234%
     & b(1,1)*rg2_34(i3,i4)%a(1,1)
      clineth_4f(i3,i4)%c(1,1)=clineth_4f(i3,i4)%c(1,1)+lh1_234%
     & c(1,1)*p234q*rg2_34(i3,i4)%d(1,1)+lh1_234%a(1,2)*rg2_34(i
     & 3,i4)%c(2,1)
      clineth_4f(i3,i4)%d(1,1)=clineth_4f(i3,i4)%d(1,1)+rmass(id
     & 1)*lh1_234%b(1,1)*rg2_34(i3,i4)%d(1,1)
      clineth_4f(i3,i4)%a(1,2)=clineth_4f(i3,i4)%a(1,2)+lh1_234%
     & c(1,1)*p234q*rg2_34(i3,i4)%b(1,2)+lh1_234%a(1,2)*rg2_34(i
     & 3,i4)%a(2,2)
      clineth_4f(i3,i4)%b(1,2)=clineth_4f(i3,i4)%b(1,2)+rmass(id
     & 1)*lh1_234%b(1,1)*rg2_34(i3,i4)%b(1,2)
      clineth_4f(i3,i4)%c(1,2)=clineth_4f(i3,i4)%c(1,2)+rmass(id
     & 1)*(lh1_234%c(1,1)*rg2_34(i3,i4)%c(1,2)+lh1_234%a(1,2)*rg
     & 2_34(i3,i4)%d(2,2))
      clineth_4f(i3,i4)%d(1,2)=clineth_4f(i3,i4)%d(1,2)+lh1_234%
     & b(1,1)*rg2_34(i3,i4)%c(1,2)
      end do
      end do
  
      rmassl=rmass(id1)
      rmassr=-rmass(id1)
  
      do i3=1,2
      do i4=1,2
* mline -- res=chqcd1234(&1,&2,i3,i4),abcd=clineth_4f(i3,i4)%,m1=rmassl,
* m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      chqcd1234(iut,jut,i3,i4)=clineth_4f(i3,i4)%a(iut,jut)+rmas
     & sl*clineth_4f(i3,i4)%b(iut,jut)+rmassr*clineth_4f(i3,i4)%
     & c(iut,jut)+rmassl*rmassr*clineth_4f(i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
      endif
  
      if (id3.eq.5.and.rmh.ge.0.d0) then
  
      do i1=1,2
      do i2=1,2
* TTSC -- aa=clineth_4f(i1,i2)%a,bb=clineth_4f(i1,i2)%b,cc=clineth_4f(i1
* ,i2)%c,dd=clineth_4f(i1,i2)%d,a1=lg3_12(i1,i2)%a,b1=lg3_12(i1,i2)%b,c1
* =lg3_12(i1,i2)%c,d1=lg3_12(i1,i2)%d,a2=rh4_312%a,b2=rh4_312%b,c2=rh4_3
* 12%c,prq=p312q,m=rmass(id3),nsum=0
      clineth_4f(i1,i2)%a(1,2)=lg3_12(i1,i2)%a(1,1)*rh4_312%a(1,
     & 2)+lg3_12(i1,i2)%c(1,2)*p312q*rh4_312%b(2,2)
      clineth_4f(i1,i2)%b(1,2)=rmass(id3)*(lg3_12(i1,i2)%d(1,1)*
     & rh4_312%a(1,2)+lg3_12(i1,i2)%b(1,2)*rh4_312%b(2,2))
      clineth_4f(i1,i2)%c(1,2)=rmass(id3)*lg3_12(i1,i2)%c(1,2)*r
     & h4_312%c(2,2)
      clineth_4f(i1,i2)%d(1,2)=lg3_12(i1,i2)%b(1,2)*rh4_312%c(2,
     & 2)
      clineth_4f(i1,i2)%a(1,1)=rmass(id3)*(lg3_12(i1,i2)%a(1,1)*
     & rh4_312%b(1,1)+lg3_12(i1,i2)%c(1,2)*rh4_312%a(2,1))
      clineth_4f(i1,i2)%b(1,1)=lg3_12(i1,i2)%d(1,1)*p312q*rh4_31
     & 2%b(1,1)+lg3_12(i1,i2)%b(1,2)*rh4_312%a(2,1)
      clineth_4f(i1,i2)%c(1,1)=lg3_12(i1,i2)%a(1,1)*rh4_312%c(1,
     & 1)
      clineth_4f(i1,i2)%d(1,1)=rmass(id3)*lg3_12(i1,i2)%d(1,1)*r
     & h4_312%c(1,1)
      clineth_4f(i1,i2)%a(2,2)=rmass(id3)*(lg3_12(i1,i2)%c(2,1)*
     & rh4_312%a(1,2)+lg3_12(i1,i2)%a(2,2)*rh4_312%b(2,2))
      clineth_4f(i1,i2)%b(2,2)=lg3_12(i1,i2)%b(2,1)*rh4_312%a(1,
     & 2)+lg3_12(i1,i2)%d(2,2)*p312q*rh4_312%b(2,2)
      clineth_4f(i1,i2)%c(2,2)=lg3_12(i1,i2)%a(2,2)*rh4_312%c(2,
     & 2)
      clineth_4f(i1,i2)%d(2,2)=rmass(id3)*lg3_12(i1,i2)%d(2,2)*r
     & h4_312%c(2,2)
      clineth_4f(i1,i2)%a(2,1)=lg3_12(i1,i2)%c(2,1)*p312q*rh4_31
     & 2%b(1,1)+lg3_12(i1,i2)%a(2,2)*rh4_312%a(2,1)
      clineth_4f(i1,i2)%b(2,1)=rmass(id3)*(lg3_12(i1,i2)%b(2,1)*
     & rh4_312%b(1,1)+lg3_12(i1,i2)%d(2,2)*rh4_312%a(2,1))
      clineth_4f(i1,i2)%c(2,1)=rmass(id3)*lg3_12(i1,i2)%c(2,1)*r
     & h4_312%c(1,1)
      clineth_4f(i1,i2)%d(2,1)=lg3_12(i1,i2)%b(2,1)*rh4_312%c(1,
     & 1)
      end do
      end do
  
      do i1=1,2
      do i2=1,2
* TSCT -- aa=clineth_4f(i1,i2)%a,bb=clineth_4f(i1,i2)%b,cc=clineth_4f(i1
* ,i2)%c,dd=clineth_4f(i1,i2)%d,a1=lh3_412%a,b1=lh3_412%b,c1=lh3_412%c,a
* 2=rg4_12(i1,i2)%a,b2=rg4_12(i1,i2)%b,c2=rg4_12(i1,i2)%c,d2=rg4_12(i1,i
* 2)%d,prq=p412q,m=rmass(id3),nsum=1
      clineth_4f(i1,i2)%a(2,1)=clineth_4f(i1,i2)%a(2,1)+lh3_412%
     & a(2,1)*rg4_12(i1,i2)%a(1,1)+lh3_412%c(2,2)*p412q*rg4_12(i
     & 1,i2)%b(2,1)
      clineth_4f(i1,i2)%b(2,1)=clineth_4f(i1,i2)%b(2,1)+rmass(id
     & 3)*lh3_412%b(2,2)*rg4_12(i1,i2)%b(2,1)
      clineth_4f(i1,i2)%c(2,1)=clineth_4f(i1,i2)%c(2,1)+rmass(id
     & 3)*(lh3_412%a(2,1)*rg4_12(i1,i2)%d(1,1)+lh3_412%c(2,2)*rg
     & 4_12(i1,i2)%c(2,1))
      clineth_4f(i1,i2)%d(2,1)=clineth_4f(i1,i2)%d(2,1)+lh3_412%
     & b(2,2)*rg4_12(i1,i2)%c(2,1)
      clineth_4f(i1,i2)%a(2,2)=clineth_4f(i1,i2)%a(2,2)+rmass(id
     & 3)*(lh3_412%a(2,1)*rg4_12(i1,i2)%b(1,2)+lh3_412%c(2,2)*rg
     & 4_12(i1,i2)%a(2,2))
      clineth_4f(i1,i2)%b(2,2)=clineth_4f(i1,i2)%b(2,2)+lh3_412%
     & b(2,2)*rg4_12(i1,i2)%a(2,2)
      clineth_4f(i1,i2)%c(2,2)=clineth_4f(i1,i2)%c(2,2)+lh3_412%
     & a(2,1)*rg4_12(i1,i2)%c(1,2)+lh3_412%c(2,2)*p412q*rg4_12(i
     & 1,i2)%d(2,2)
      clineth_4f(i1,i2)%d(2,2)=clineth_4f(i1,i2)%d(2,2)+rmass(id
     & 3)*lh3_412%b(2,2)*rg4_12(i1,i2)%d(2,2)
      clineth_4f(i1,i2)%a(1,1)=clineth_4f(i1,i2)%a(1,1)+rmass(id
     & 3)*(lh3_412%c(1,1)*rg4_12(i1,i2)%a(1,1)+lh3_412%a(1,2)*rg
     & 4_12(i1,i2)%b(2,1))
      clineth_4f(i1,i2)%b(1,1)=clineth_4f(i1,i2)%b(1,1)+lh3_412%
     & b(1,1)*rg4_12(i1,i2)%a(1,1)
      clineth_4f(i1,i2)%c(1,1)=clineth_4f(i1,i2)%c(1,1)+lh3_412%
     & c(1,1)*p412q*rg4_12(i1,i2)%d(1,1)+lh3_412%a(1,2)*rg4_12(i
     & 1,i2)%c(2,1)
      clineth_4f(i1,i2)%d(1,1)=clineth_4f(i1,i2)%d(1,1)+rmass(id
     & 3)*lh3_412%b(1,1)*rg4_12(i1,i2)%d(1,1)
      clineth_4f(i1,i2)%a(1,2)=clineth_4f(i1,i2)%a(1,2)+lh3_412%
     & c(1,1)*p412q*rg4_12(i1,i2)%b(1,2)+lh3_412%a(1,2)*rg4_12(i
     & 1,i2)%a(2,2)
      clineth_4f(i1,i2)%b(1,2)=clineth_4f(i1,i2)%b(1,2)+rmass(id
     & 3)*lh3_412%b(1,1)*rg4_12(i1,i2)%b(1,2)
      clineth_4f(i1,i2)%c(1,2)=clineth_4f(i1,i2)%c(1,2)+rmass(id
     & 3)*(lh3_412%c(1,1)*rg4_12(i1,i2)%c(1,2)+lh3_412%a(1,2)*rg
     & 4_12(i1,i2)%d(2,2))
      clineth_4f(i1,i2)%d(1,2)=clineth_4f(i1,i2)%d(1,2)+lh3_412%
     & b(1,1)*rg4_12(i1,i2)%c(1,2)
      end do
      end do
  
      rmassl=rmass(id3)
      rmassr=-rmass(id3)
  
      do i1=1,2
      do i2=1,2
* mline -- res=chqcd1234(i1,i2,&1,&2),abcd=clineth_4f(i1,i2)%,m1=rmassl,
* m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      chqcd1234(i1,i2,iut,jut)=chqcd1234(i1,i2,iut,jut)+clineth_
     & 4f(i1,i2)%a(iut,jut)+rmassl*clineth_4f(i1,i2)%b(iut,jut)+
     & rmassr*clineth_4f(i1,i2)%c(iut,jut)+rmassl*rmassr*clineth
     & _4f(i1,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
      endif
  
*                                                                       
* Then link the computed subdiagrams with the "higgs" insertion         
* [ch5678(2,2,2,2)]                                                     
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2)   
*                                                                       
  
      if(rmh.ge.0.d0 .and. (id1.eq.5 .or. id3.eq.5))then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) =
     &                       cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) +
     &                       (chqcd1234(i1,i2,i3,i4)*
     &                       ch5678(i5,i6,i7,i8))/
     &                       (p1234q-cmh2)
                      enddo
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
  
**************Compute diagrams of class 2.d) (three-forks)**************
*                                                                       
* Diagrams are built-up by linking the following structures:            
*                                                                       
* u1|_5678     % rg2|_3|4|       [Z/f/h Z/f/h g]                        
* ug1|_3|4|56  % r2|_78          [g Z/f/h Z/f/h + Z/f/h g Z/f/h]        
* ug1|_3|4|78  % r2|_56          [g Z/f/h Z/f/h + Z/f/h g Z/f/h]        
*                                                                       
* where 1|={1,3}, 2|={2,4}, 3|4|={34,12}.                               
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2)   
*                                                                       
  
      rmassl=rmass(id1)
      rmassr=-rmass(id1)
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=cline_3forks_12(i5,i6,i7,i8,i3,i4)%a,bb=cline_3forks_12(i5,i
* 6,i7,i8,i3,i4)%b,cc=cline_3forks_12(i5,i6,i7,i8,i3,i4)%c,dd=cline_3for
* ks_12(i5,i6,i7,i8,i3,i4)%d,a1=u1_5678(i5,i6,i7,i8)%a,b1=u1_5678(i5,i6,
* i7,i8)%b,c1=u1_5678(i5,i6,i7,i8)%c,d1=u1_5678(i5,i6,i7,i8)%d,a2=rg2_34
* (i3,i4)%a,b2=rg2_34(i3,i4)%b,c2=rg2_34(i3,i4)%c,d2=rg2_34(i3,i4)%d,prq
* =p234q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=u1_5678(i5,i6,i7,i8)%a(iut,1)+u1_5678(i5,i6,i7,i8)%c(i
     & ut,1)*rmass(id1)
      cx2=u1_5678(i5,i6,i7,i8)%c(iut,2)*p234q+u1_5678(i5,i6,i7,i
     & 8)%a(iut,2)*rmass(id1)
      cy1=u1_5678(i5,i6,i7,i8)%b(iut,1)+u1_5678(i5,i6,i7,i8)%d(i
     & ut,1)*rmass(id1)
      cy2=u1_5678(i5,i6,i7,i8)%d(iut,2)*p234q+u1_5678(i5,i6,i7,i
     & 8)%b(iut,2)*rmass(id1)
      cw1=u1_5678(i5,i6,i7,i8)%c(iut,1)*p234q+u1_5678(i5,i6,i7,i
     & 8)%a(iut,1)*rmass(id1)
      cw2=u1_5678(i5,i6,i7,i8)%a(iut,2)+u1_5678(i5,i6,i7,i8)%c(i
     & ut,2)*rmass(id1)
      cz1=u1_5678(i5,i6,i7,i8)%d(iut,1)*p234q+u1_5678(i5,i6,i7,i
     & 8)%b(iut,1)*rmass(id1)
      cz2=u1_5678(i5,i6,i7,i8)%b(iut,2)+u1_5678(i5,i6,i7,i8)%d(i
     & ut,2)*rmass(id1)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%a(iut,1)=cx1*rg2_34(i3,
     & i4)%a(1,1)+cx2*rg2_34(i3,i4)%b(2,1)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%b(iut,1)=cy1*rg2_34(i3,
     & i4)%a(1,1)+cy2*rg2_34(i3,i4)%b(2,1)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%c(iut,1)=cw1*rg2_34(i3,
     & i4)%d(1,1)+cw2*rg2_34(i3,i4)%c(2,1)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%d(iut,1)=cz1*rg2_34(i3,
     & i4)%d(1,1)+cz2*rg2_34(i3,i4)%c(2,1)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%a(iut,2)=cw1*rg2_34(i3,
     & i4)%b(1,2)+cw2*rg2_34(i3,i4)%a(2,2)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%b(iut,2)=cz1*rg2_34(i3,
     & i4)%b(1,2)+cz2*rg2_34(i3,i4)%a(2,2)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%c(iut,2)=cx1*rg2_34(i3,
     & i4)%c(1,2)+cx2*rg2_34(i3,i4)%d(2,2)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%d(iut,2)=cy1*rg2_34(i3,
     & i4)%c(1,2)+cy2*rg2_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* mline -- res=cres_3forks_12(i5,i6,i7,i8,i3,i4)%pol(&1,&2),abcd=cline_3
* forks_12(i5,i6,i7,i8,i3,i4)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_12(i5,i6,i7,i8,i3,i4)%pol(iut,jut)=cline_3fork
     & s_12(i5,i6,i7,i8,i3,i4)%a(iut,jut)+rmassl*cline_3forks_12
     & (i5,i6,i7,i8,i3,i4)%b(iut,jut)+rmassr*cline_3forks_12(i5,
     & i6,i7,i8,i3,i4)%c(iut,jut)+rmassl*rmassr*cline_3forks_12(
     & i5,i6,i7,i8,i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) +
     &                     cres_3forks_12(i5,i6,i7,i8,i3,i4)
     &                     %pol(i1,i2)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id7.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=cline_3forks_12(i3,i4,i5,i6,i7,i8)%a,bb=cline_3forks_12(i3,
* i4,i5,i6,i7,i8)%b,cc=cline_3forks_12(i3,i4,i5,i6,i7,i8)%c,dd=cline_3fo
* rks_12(i3,i4,i5,i6,i7,i8)%d,a1=ug1_3456(i3,i4,i5,i6)%a,b1=ug1_3456(i3,
* i4,i5,i6)%b,c1=ug1_3456(i3,i4,i5,i6)%c,d1=ug1_3456(i3,i4,i5,i6)%d,a2=r
* 2_78(i7,i8)%a,b2=r2_78(i7,i8)%b,c2=r2_78(i7,i8)%c,d2=r2_78(i7,i8)%d,pr
* q=p278q,m=rmass(id1),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r2_78(i7,i8)%a(1,jut)+rmass(id1)*r2_78(i7,i8)%b(1,jut)
      cx2=r2_78(i7,i8)%a(2,jut)+rmass(id1)*r2_78(i7,i8)%b(2,jut)
      cy1=p278q*r2_78(i7,i8)%b(1,jut)+rmass(id1)*r2_78(i7,i8)%a(
     & 1,jut)
      cy2=p278q*r2_78(i7,i8)%b(2,jut)+rmass(id1)*r2_78(i7,i8)%a(
     & 2,jut)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%a(iut,jut)=ug1_3456(i3,
     & i4,i5,i6)%a(iut,1)*cx1+ug1_3456(i3,i4,i5,i6)%c(iut,1)*cy1
     & +ug1_3456(i3,i4,i5,i6)%a(iut,2)*cx2+ug1_3456(i3,i4,i5,i6)
     & %c(iut,2)*cy2
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%b(iut,jut)=ug1_3456(i3,
     & i4,i5,i6)%b(iut,1)*cx1+ug1_3456(i3,i4,i5,i6)%d(iut,1)*cy1
     & +ug1_3456(i3,i4,i5,i6)%b(iut,2)*cx2+ug1_3456(i3,i4,i5,i6)
     & %d(iut,2)*cy2
      cw1=r2_78(i7,i8)%c(1,jut)+rmass(id1)*r2_78(i7,i8)%d(1,jut)
      cw2=r2_78(i7,i8)%c(2,jut)+rmass(id1)*r2_78(i7,i8)%d(2,jut)
      cz1=p278q*r2_78(i7,i8)%d(1,jut)+rmass(id1)*r2_78(i7,i8)%c(
     & 1,jut)
      cz2=p278q*r2_78(i7,i8)%d(2,jut)+rmass(id1)*r2_78(i7,i8)%c(
     & 2,jut)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%c(iut,jut)=ug1_3456(i3,
     & i4,i5,i6)%a(iut,1)*cw1+ug1_3456(i3,i4,i5,i6)%c(iut,1)*cz1
     & +ug1_3456(i3,i4,i5,i6)%a(iut,2)*cw2+ug1_3456(i3,i4,i5,i6)
     & %c(iut,2)*cz2
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%d(iut,jut)=ug1_3456(i3,
     & i4,i5,i6)%b(iut,1)*cw1+ug1_3456(i3,i4,i5,i6)%d(iut,1)*cz1
     & +ug1_3456(i3,i4,i5,i6)%b(iut,2)*cw2+ug1_3456(i3,i4,i5,i6)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=cline_3forks_12(i3,i4,i5,i6,i7,i8)%a,bb=cline_3forks_12(i3,i
* 4,i5,i6,i7,i8)%b,cc=cline_3forks_12(i3,i4,i5,i6,i7,i8)%c,dd=cline_3for
* ks_12(i3,i4,i5,i6,i7,i8)%d,a1=ug1_3456(i3,i4,i5,i6)%a,b1=ug1_3456(i3,i
* 4,i5,i6)%b,c1=ug1_3456(i3,i4,i5,i6)%c,d1=ug1_3456(i3,i4,i5,i6)%d,a2=r2
* _78(i7,i8)%a,b2=r2_78(i7,i8)%b,c2=r2_78(i7,i8)%c,d2=r2_78(i7,i8)%d,prq
* =p278q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=ug1_3456(i3,i4,i5,i6)%a(iut,1)+ug1_3456(i3,i4,i5,i6)%c
     & (iut,1)*rmass(id1)
      cx2=ug1_3456(i3,i4,i5,i6)%c(iut,2)*p278q+ug1_3456(i3,i4,i5
     & ,i6)%a(iut,2)*rmass(id1)
      cy1=ug1_3456(i3,i4,i5,i6)%b(iut,1)+ug1_3456(i3,i4,i5,i6)%d
     & (iut,1)*rmass(id1)
      cy2=ug1_3456(i3,i4,i5,i6)%d(iut,2)*p278q+ug1_3456(i3,i4,i5
     & ,i6)%b(iut,2)*rmass(id1)
      cw1=ug1_3456(i3,i4,i5,i6)%c(iut,1)*p278q+ug1_3456(i3,i4,i5
     & ,i6)%a(iut,1)*rmass(id1)
      cw2=ug1_3456(i3,i4,i5,i6)%a(iut,2)+ug1_3456(i3,i4,i5,i6)%c
     & (iut,2)*rmass(id1)
      cz1=ug1_3456(i3,i4,i5,i6)%d(iut,1)*p278q+ug1_3456(i3,i4,i5
     & ,i6)%b(iut,1)*rmass(id1)
      cz2=ug1_3456(i3,i4,i5,i6)%b(iut,2)+ug1_3456(i3,i4,i5,i6)%d
     & (iut,2)*rmass(id1)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%a(iut,1)=cx1*r2_78(i7,i
     & 8)%a(1,1)+cx2*r2_78(i7,i8)%b(2,1)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%b(iut,1)=cy1*r2_78(i7,i
     & 8)%a(1,1)+cy2*r2_78(i7,i8)%b(2,1)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%c(iut,1)=cw1*r2_78(i7,i
     & 8)%d(1,1)+cw2*r2_78(i7,i8)%c(2,1)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%d(iut,1)=cz1*r2_78(i7,i
     & 8)%d(1,1)+cz2*r2_78(i7,i8)%c(2,1)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%a(iut,2)=cw1*r2_78(i7,i
     & 8)%b(1,2)+cw2*r2_78(i7,i8)%a(2,2)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%b(iut,2)=cz1*r2_78(i7,i
     & 8)%b(1,2)+cz2*r2_78(i7,i8)%a(2,2)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%c(iut,2)=cx1*r2_78(i7,i
     & 8)%c(1,2)+cx2*r2_78(i7,i8)%d(2,2)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%d(iut,2)=cy1*r2_78(i7,i
     & 8)%c(1,2)+cy2*r2_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* mline -- res=cres_3forks_12(i3,i4,i5,i6,i7,i8)%pol(&1,&2),abcd=cline_3
* forks_12(i3,i4,i5,i6,i7,i8)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_12(i3,i4,i5,i6,i7,i8)%pol(iut,jut)=cline_3fork
     & s_12(i3,i4,i5,i6,i7,i8)%a(iut,jut)+rmassl*cline_3forks_12
     & (i3,i4,i5,i6,i7,i8)%b(iut,jut)+rmassr*cline_3forks_12(i3,
     & i4,i5,i6,i7,i8)%c(iut,jut)+rmassl*rmassr*cline_3forks_12(
     & i3,i4,i5,i6,i7,i8)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) +
     &                     cres_3forks_12(i3,i4,i5,i6,i7,i8)
     &                     %pol(i1,i2)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
      if(id5.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=cline_3forks_12(i3,i4,i7,i8,i5,i6)%a,bb=cline_3forks_12(i3,
* i4,i7,i8,i5,i6)%b,cc=cline_3forks_12(i3,i4,i7,i8,i5,i6)%c,dd=cline_3fo
* rks_12(i3,i4,i7,i8,i5,i6)%d,a1=ug1_3478(i3,i4,i7,i8)%a,b1=ug1_3478(i3,
* i4,i7,i8)%b,c1=ug1_3478(i3,i4,i7,i8)%c,d1=ug1_3478(i3,i4,i7,i8)%d,a2=r
* 2_56(i5,i6)%a,b2=r2_56(i5,i6)%b,c2=r2_56(i5,i6)%c,d2=r2_56(i5,i6)%d,pr
* q=p256q,m=rmass(id1),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r2_56(i5,i6)%a(1,jut)+rmass(id1)*r2_56(i5,i6)%b(1,jut)
      cx2=r2_56(i5,i6)%a(2,jut)+rmass(id1)*r2_56(i5,i6)%b(2,jut)
      cy1=p256q*r2_56(i5,i6)%b(1,jut)+rmass(id1)*r2_56(i5,i6)%a(
     & 1,jut)
      cy2=p256q*r2_56(i5,i6)%b(2,jut)+rmass(id1)*r2_56(i5,i6)%a(
     & 2,jut)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%a(iut,jut)=ug1_3478(i3,
     & i4,i7,i8)%a(iut,1)*cx1+ug1_3478(i3,i4,i7,i8)%c(iut,1)*cy1
     & +ug1_3478(i3,i4,i7,i8)%a(iut,2)*cx2+ug1_3478(i3,i4,i7,i8)
     & %c(iut,2)*cy2
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%b(iut,jut)=ug1_3478(i3,
     & i4,i7,i8)%b(iut,1)*cx1+ug1_3478(i3,i4,i7,i8)%d(iut,1)*cy1
     & +ug1_3478(i3,i4,i7,i8)%b(iut,2)*cx2+ug1_3478(i3,i4,i7,i8)
     & %d(iut,2)*cy2
      cw1=r2_56(i5,i6)%c(1,jut)+rmass(id1)*r2_56(i5,i6)%d(1,jut)
      cw2=r2_56(i5,i6)%c(2,jut)+rmass(id1)*r2_56(i5,i6)%d(2,jut)
      cz1=p256q*r2_56(i5,i6)%d(1,jut)+rmass(id1)*r2_56(i5,i6)%c(
     & 1,jut)
      cz2=p256q*r2_56(i5,i6)%d(2,jut)+rmass(id1)*r2_56(i5,i6)%c(
     & 2,jut)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%c(iut,jut)=ug1_3478(i3,
     & i4,i7,i8)%a(iut,1)*cw1+ug1_3478(i3,i4,i7,i8)%c(iut,1)*cz1
     & +ug1_3478(i3,i4,i7,i8)%a(iut,2)*cw2+ug1_3478(i3,i4,i7,i8)
     & %c(iut,2)*cz2
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%d(iut,jut)=ug1_3478(i3,
     & i4,i7,i8)%b(iut,1)*cw1+ug1_3478(i3,i4,i7,i8)%d(iut,1)*cz1
     & +ug1_3478(i3,i4,i7,i8)%b(iut,2)*cw2+ug1_3478(i3,i4,i7,i8)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=cline_3forks_12(i3,i4,i7,i8,i5,i6)%a,bb=cline_3forks_12(i3,i
* 4,i7,i8,i5,i6)%b,cc=cline_3forks_12(i3,i4,i7,i8,i5,i6)%c,dd=cline_3for
* ks_12(i3,i4,i7,i8,i5,i6)%d,a1=ug1_3478(i3,i4,i7,i8)%a,b1=ug1_3478(i3,i
* 4,i7,i8)%b,c1=ug1_3478(i3,i4,i7,i8)%c,d1=ug1_3478(i3,i4,i7,i8)%d,a2=r2
* _56(i5,i6)%a,b2=r2_56(i5,i6)%b,c2=r2_56(i5,i6)%c,d2=r2_56(i5,i6)%d,prq
* =p256q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=ug1_3478(i3,i4,i7,i8)%a(iut,1)+ug1_3478(i3,i4,i7,i8)%c
     & (iut,1)*rmass(id1)
      cx2=ug1_3478(i3,i4,i7,i8)%c(iut,2)*p256q+ug1_3478(i3,i4,i7
     & ,i8)%a(iut,2)*rmass(id1)
      cy1=ug1_3478(i3,i4,i7,i8)%b(iut,1)+ug1_3478(i3,i4,i7,i8)%d
     & (iut,1)*rmass(id1)
      cy2=ug1_3478(i3,i4,i7,i8)%d(iut,2)*p256q+ug1_3478(i3,i4,i7
     & ,i8)%b(iut,2)*rmass(id1)
      cw1=ug1_3478(i3,i4,i7,i8)%c(iut,1)*p256q+ug1_3478(i3,i4,i7
     & ,i8)%a(iut,1)*rmass(id1)
      cw2=ug1_3478(i3,i4,i7,i8)%a(iut,2)+ug1_3478(i3,i4,i7,i8)%c
     & (iut,2)*rmass(id1)
      cz1=ug1_3478(i3,i4,i7,i8)%d(iut,1)*p256q+ug1_3478(i3,i4,i7
     & ,i8)%b(iut,1)*rmass(id1)
      cz2=ug1_3478(i3,i4,i7,i8)%b(iut,2)+ug1_3478(i3,i4,i7,i8)%d
     & (iut,2)*rmass(id1)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%a(iut,1)=cx1*r2_56(i5,i
     & 6)%a(1,1)+cx2*r2_56(i5,i6)%b(2,1)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%b(iut,1)=cy1*r2_56(i5,i
     & 6)%a(1,1)+cy2*r2_56(i5,i6)%b(2,1)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%c(iut,1)=cw1*r2_56(i5,i
     & 6)%d(1,1)+cw2*r2_56(i5,i6)%c(2,1)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%d(iut,1)=cz1*r2_56(i5,i
     & 6)%d(1,1)+cz2*r2_56(i5,i6)%c(2,1)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%a(iut,2)=cw1*r2_56(i5,i
     & 6)%b(1,2)+cw2*r2_56(i5,i6)%a(2,2)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%b(iut,2)=cz1*r2_56(i5,i
     & 6)%b(1,2)+cz2*r2_56(i5,i6)%a(2,2)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%c(iut,2)=cx1*r2_56(i5,i
     & 6)%c(1,2)+cx2*r2_56(i5,i6)%d(2,2)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%d(iut,2)=cy1*r2_56(i5,i
     & 6)%c(1,2)+cy2*r2_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* mline -- res=cres_3forks_12(i3,i4,i7,i8,i5,i6)%pol(&1,&2),abcd=cline_3
* forks_12(i3,i4,i7,i8,i5,i6)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_12(i3,i4,i7,i8,i5,i6)%pol(iut,jut)=cline_3fork
     & s_12(i3,i4,i7,i8,i5,i6)%a(iut,jut)+rmassl*cline_3forks_12
     & (i3,i4,i7,i8,i5,i6)%b(iut,jut)+rmassr*cline_3forks_12(i3,
     & i4,i7,i8,i5,i6)%c(iut,jut)+rmassl*rmassr*cline_3forks_12(
     & i3,i4,i7,i8,i5,i6)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) +
     &                     cres_3forks_12(i3,i4,i7,i8,i5,i6)
     &                     %pol(i1,i2)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
  
      rmassl=rmass(id3)
      rmassr=-rmass(id3)
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=cline_3forks_34(i5,i6,i7,i8,i1,i2)%a,bb=cline_3forks_34(i5,i
* 6,i7,i8,i1,i2)%b,cc=cline_3forks_34(i5,i6,i7,i8,i1,i2)%c,dd=cline_3for
* ks_34(i5,i6,i7,i8,i1,i2)%d,a1=u3_5678(i5,i6,i7,i8)%a,b1=u3_5678(i5,i6,
* i7,i8)%b,c1=u3_5678(i5,i6,i7,i8)%c,d1=u3_5678(i5,i6,i7,i8)%d,a2=rg4_12
* (i1,i2)%a,b2=rg4_12(i1,i2)%b,c2=rg4_12(i1,i2)%c,d2=rg4_12(i1,i2)%d,prq
* =p412q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=u3_5678(i5,i6,i7,i8)%a(iut,1)+u3_5678(i5,i6,i7,i8)%c(i
     & ut,1)*rmass(id3)
      cx2=u3_5678(i5,i6,i7,i8)%c(iut,2)*p412q+u3_5678(i5,i6,i7,i
     & 8)%a(iut,2)*rmass(id3)
      cy1=u3_5678(i5,i6,i7,i8)%b(iut,1)+u3_5678(i5,i6,i7,i8)%d(i
     & ut,1)*rmass(id3)
      cy2=u3_5678(i5,i6,i7,i8)%d(iut,2)*p412q+u3_5678(i5,i6,i7,i
     & 8)%b(iut,2)*rmass(id3)
      cw1=u3_5678(i5,i6,i7,i8)%c(iut,1)*p412q+u3_5678(i5,i6,i7,i
     & 8)%a(iut,1)*rmass(id3)
      cw2=u3_5678(i5,i6,i7,i8)%a(iut,2)+u3_5678(i5,i6,i7,i8)%c(i
     & ut,2)*rmass(id3)
      cz1=u3_5678(i5,i6,i7,i8)%d(iut,1)*p412q+u3_5678(i5,i6,i7,i
     & 8)%b(iut,1)*rmass(id3)
      cz2=u3_5678(i5,i6,i7,i8)%b(iut,2)+u3_5678(i5,i6,i7,i8)%d(i
     & ut,2)*rmass(id3)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%a(iut,1)=cx1*rg4_12(i1,
     & i2)%a(1,1)+cx2*rg4_12(i1,i2)%b(2,1)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%b(iut,1)=cy1*rg4_12(i1,
     & i2)%a(1,1)+cy2*rg4_12(i1,i2)%b(2,1)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%c(iut,1)=cw1*rg4_12(i1,
     & i2)%d(1,1)+cw2*rg4_12(i1,i2)%c(2,1)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%d(iut,1)=cz1*rg4_12(i1,
     & i2)%d(1,1)+cz2*rg4_12(i1,i2)%c(2,1)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%a(iut,2)=cw1*rg4_12(i1,
     & i2)%b(1,2)+cw2*rg4_12(i1,i2)%a(2,2)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%b(iut,2)=cz1*rg4_12(i1,
     & i2)%b(1,2)+cz2*rg4_12(i1,i2)%a(2,2)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%c(iut,2)=cx1*rg4_12(i1,
     & i2)%c(1,2)+cx2*rg4_12(i1,i2)%d(2,2)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%d(iut,2)=cy1*rg4_12(i1,
     & i2)%c(1,2)+cy2*rg4_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* mline -- res=cres_3forks_34(i5,i6,i7,i8,i1,i2)%pol(&1,&2),abcd=cline_3
* forks_34(i5,i6,i7,i8,i1,i2)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_34(i5,i6,i7,i8,i1,i2)%pol(iut,jut)=cline_3fork
     & s_34(i5,i6,i7,i8,i1,i2)%a(iut,jut)+rmassl*cline_3forks_34
     & (i5,i6,i7,i8,i1,i2)%b(iut,jut)+rmassr*cline_3forks_34(i5,
     & i6,i7,i8,i1,i2)%c(iut,jut)+rmassl*rmassr*cline_3forks_34(
     & i5,i6,i7,i8,i1,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) +
     &                     cres_3forks_34(i5,i6,i7,i8,i1,i2)
     &                     %pol(i3,i4)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id7.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=cline_3forks_34(i1,i2,i5,i6,i7,i8)%a,bb=cline_3forks_34(i1,
* i2,i5,i6,i7,i8)%b,cc=cline_3forks_34(i1,i2,i5,i6,i7,i8)%c,dd=cline_3fo
* rks_34(i1,i2,i5,i6,i7,i8)%d,a1=ug3_1256(i1,i2,i5,i6)%a,b1=ug3_1256(i1,
* i2,i5,i6)%b,c1=ug3_1256(i1,i2,i5,i6)%c,d1=ug3_1256(i1,i2,i5,i6)%d,a2=r
* 4_78(i7,i8)%a,b2=r4_78(i7,i8)%b,c2=r4_78(i7,i8)%c,d2=r4_78(i7,i8)%d,pr
* q=p478q,m=rmass(id3),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r4_78(i7,i8)%a(1,jut)+rmass(id3)*r4_78(i7,i8)%b(1,jut)
      cx2=r4_78(i7,i8)%a(2,jut)+rmass(id3)*r4_78(i7,i8)%b(2,jut)
      cy1=p478q*r4_78(i7,i8)%b(1,jut)+rmass(id3)*r4_78(i7,i8)%a(
     & 1,jut)
      cy2=p478q*r4_78(i7,i8)%b(2,jut)+rmass(id3)*r4_78(i7,i8)%a(
     & 2,jut)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%a(iut,jut)=ug3_1256(i1,
     & i2,i5,i6)%a(iut,1)*cx1+ug3_1256(i1,i2,i5,i6)%c(iut,1)*cy1
     & +ug3_1256(i1,i2,i5,i6)%a(iut,2)*cx2+ug3_1256(i1,i2,i5,i6)
     & %c(iut,2)*cy2
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%b(iut,jut)=ug3_1256(i1,
     & i2,i5,i6)%b(iut,1)*cx1+ug3_1256(i1,i2,i5,i6)%d(iut,1)*cy1
     & +ug3_1256(i1,i2,i5,i6)%b(iut,2)*cx2+ug3_1256(i1,i2,i5,i6)
     & %d(iut,2)*cy2
      cw1=r4_78(i7,i8)%c(1,jut)+rmass(id3)*r4_78(i7,i8)%d(1,jut)
      cw2=r4_78(i7,i8)%c(2,jut)+rmass(id3)*r4_78(i7,i8)%d(2,jut)
      cz1=p478q*r4_78(i7,i8)%d(1,jut)+rmass(id3)*r4_78(i7,i8)%c(
     & 1,jut)
      cz2=p478q*r4_78(i7,i8)%d(2,jut)+rmass(id3)*r4_78(i7,i8)%c(
     & 2,jut)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%c(iut,jut)=ug3_1256(i1,
     & i2,i5,i6)%a(iut,1)*cw1+ug3_1256(i1,i2,i5,i6)%c(iut,1)*cz1
     & +ug3_1256(i1,i2,i5,i6)%a(iut,2)*cw2+ug3_1256(i1,i2,i5,i6)
     & %c(iut,2)*cz2
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%d(iut,jut)=ug3_1256(i1,
     & i2,i5,i6)%b(iut,1)*cw1+ug3_1256(i1,i2,i5,i6)%d(iut,1)*cz1
     & +ug3_1256(i1,i2,i5,i6)%b(iut,2)*cw2+ug3_1256(i1,i2,i5,i6)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=cline_3forks_34(i1,i2,i5,i6,i7,i8)%a,bb=cline_3forks_34(i1,i
* 2,i5,i6,i7,i8)%b,cc=cline_3forks_34(i1,i2,i5,i6,i7,i8)%c,dd=cline_3for
* ks_34(i1,i2,i5,i6,i7,i8)%d,a1=ug3_1256(i1,i2,i5,i6)%a,b1=ug3_1256(i1,i
* 2,i5,i6)%b,c1=ug3_1256(i1,i2,i5,i6)%c,d1=ug3_1256(i1,i2,i5,i6)%d,a2=r4
* _78(i7,i8)%a,b2=r4_78(i7,i8)%b,c2=r4_78(i7,i8)%c,d2=r4_78(i7,i8)%d,prq
* =p478q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=ug3_1256(i1,i2,i5,i6)%a(iut,1)+ug3_1256(i1,i2,i5,i6)%c
     & (iut,1)*rmass(id3)
      cx2=ug3_1256(i1,i2,i5,i6)%c(iut,2)*p478q+ug3_1256(i1,i2,i5
     & ,i6)%a(iut,2)*rmass(id3)
      cy1=ug3_1256(i1,i2,i5,i6)%b(iut,1)+ug3_1256(i1,i2,i5,i6)%d
     & (iut,1)*rmass(id3)
      cy2=ug3_1256(i1,i2,i5,i6)%d(iut,2)*p478q+ug3_1256(i1,i2,i5
     & ,i6)%b(iut,2)*rmass(id3)
      cw1=ug3_1256(i1,i2,i5,i6)%c(iut,1)*p478q+ug3_1256(i1,i2,i5
     & ,i6)%a(iut,1)*rmass(id3)
      cw2=ug3_1256(i1,i2,i5,i6)%a(iut,2)+ug3_1256(i1,i2,i5,i6)%c
     & (iut,2)*rmass(id3)
      cz1=ug3_1256(i1,i2,i5,i6)%d(iut,1)*p478q+ug3_1256(i1,i2,i5
     & ,i6)%b(iut,1)*rmass(id3)
      cz2=ug3_1256(i1,i2,i5,i6)%b(iut,2)+ug3_1256(i1,i2,i5,i6)%d
     & (iut,2)*rmass(id3)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%a(iut,1)=cx1*r4_78(i7,i
     & 8)%a(1,1)+cx2*r4_78(i7,i8)%b(2,1)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%b(iut,1)=cy1*r4_78(i7,i
     & 8)%a(1,1)+cy2*r4_78(i7,i8)%b(2,1)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%c(iut,1)=cw1*r4_78(i7,i
     & 8)%d(1,1)+cw2*r4_78(i7,i8)%c(2,1)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%d(iut,1)=cz1*r4_78(i7,i
     & 8)%d(1,1)+cz2*r4_78(i7,i8)%c(2,1)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%a(iut,2)=cw1*r4_78(i7,i
     & 8)%b(1,2)+cw2*r4_78(i7,i8)%a(2,2)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%b(iut,2)=cz1*r4_78(i7,i
     & 8)%b(1,2)+cz2*r4_78(i7,i8)%a(2,2)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%c(iut,2)=cx1*r4_78(i7,i
     & 8)%c(1,2)+cx2*r4_78(i7,i8)%d(2,2)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%d(iut,2)=cy1*r4_78(i7,i
     & 8)%c(1,2)+cy2*r4_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* mline -- res=cres_3forks_34(i1,i2,i5,i6,i7,i8)%pol(&1,&2),abcd=cline_3
* forks_34(i1,i2,i5,i6,i7,i8)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_34(i1,i2,i5,i6,i7,i8)%pol(iut,jut)=cline_3fork
     & s_34(i1,i2,i5,i6,i7,i8)%a(iut,jut)+rmassl*cline_3forks_34
     & (i1,i2,i5,i6,i7,i8)%b(iut,jut)+rmassr*cline_3forks_34(i1,
     & i2,i5,i6,i7,i8)%c(iut,jut)+rmassl*rmassr*cline_3forks_34(
     & i1,i2,i5,i6,i7,i8)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) +
     &                     cres_3forks_34(i1,i2,i5,i6,i7,i8)
     &                     %pol(i3,i4)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id5.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=cline_3forks_34(i1,i2,i7,i8,i5,i6)%a,bb=cline_3forks_34(i1,
* i2,i7,i8,i5,i6)%b,cc=cline_3forks_34(i1,i2,i7,i8,i5,i6)%c,dd=cline_3fo
* rks_34(i1,i2,i7,i8,i5,i6)%d,a1=ug3_1278(i1,i2,i7,i8)%a,b1=ug3_1278(i1,
* i2,i7,i8)%b,c1=ug3_1278(i1,i2,i7,i8)%c,d1=ug3_1278(i1,i2,i7,i8)%d,a2=r
* 4_56(i5,i6)%a,b2=r4_56(i5,i6)%b,c2=r4_56(i5,i6)%c,d2=r4_56(i5,i6)%d,pr
* q=p456q,m=rmass(id3),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r4_56(i5,i6)%a(1,jut)+rmass(id3)*r4_56(i5,i6)%b(1,jut)
      cx2=r4_56(i5,i6)%a(2,jut)+rmass(id3)*r4_56(i5,i6)%b(2,jut)
      cy1=p456q*r4_56(i5,i6)%b(1,jut)+rmass(id3)*r4_56(i5,i6)%a(
     & 1,jut)
      cy2=p456q*r4_56(i5,i6)%b(2,jut)+rmass(id3)*r4_56(i5,i6)%a(
     & 2,jut)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%a(iut,jut)=ug3_1278(i1,
     & i2,i7,i8)%a(iut,1)*cx1+ug3_1278(i1,i2,i7,i8)%c(iut,1)*cy1
     & +ug3_1278(i1,i2,i7,i8)%a(iut,2)*cx2+ug3_1278(i1,i2,i7,i8)
     & %c(iut,2)*cy2
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%b(iut,jut)=ug3_1278(i1,
     & i2,i7,i8)%b(iut,1)*cx1+ug3_1278(i1,i2,i7,i8)%d(iut,1)*cy1
     & +ug3_1278(i1,i2,i7,i8)%b(iut,2)*cx2+ug3_1278(i1,i2,i7,i8)
     & %d(iut,2)*cy2
      cw1=r4_56(i5,i6)%c(1,jut)+rmass(id3)*r4_56(i5,i6)%d(1,jut)
      cw2=r4_56(i5,i6)%c(2,jut)+rmass(id3)*r4_56(i5,i6)%d(2,jut)
      cz1=p456q*r4_56(i5,i6)%d(1,jut)+rmass(id3)*r4_56(i5,i6)%c(
     & 1,jut)
      cz2=p456q*r4_56(i5,i6)%d(2,jut)+rmass(id3)*r4_56(i5,i6)%c(
     & 2,jut)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%c(iut,jut)=ug3_1278(i1,
     & i2,i7,i8)%a(iut,1)*cw1+ug3_1278(i1,i2,i7,i8)%c(iut,1)*cz1
     & +ug3_1278(i1,i2,i7,i8)%a(iut,2)*cw2+ug3_1278(i1,i2,i7,i8)
     & %c(iut,2)*cz2
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%d(iut,jut)=ug3_1278(i1,
     & i2,i7,i8)%b(iut,1)*cw1+ug3_1278(i1,i2,i7,i8)%d(iut,1)*cz1
     & +ug3_1278(i1,i2,i7,i8)%b(iut,2)*cw2+ug3_1278(i1,i2,i7,i8)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=cline_3forks_34(i1,i2,i7,i8,i5,i6)%a,bb=cline_3forks_34(i1,i
* 2,i7,i8,i5,i6)%b,cc=cline_3forks_34(i1,i2,i7,i8,i5,i6)%c,dd=cline_3for
* ks_34(i1,i2,i7,i8,i5,i6)%d,a1=ug3_1278(i1,i2,i7,i8)%a,b1=ug3_1278(i1,i
* 2,i7,i8)%b,c1=ug3_1278(i1,i2,i7,i8)%c,d1=ug3_1278(i1,i2,i7,i8)%d,a2=r4
* _56(i5,i6)%a,b2=r4_56(i5,i6)%b,c2=r4_56(i5,i6)%c,d2=r4_56(i5,i6)%d,prq
* =p456q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=ug3_1278(i1,i2,i7,i8)%a(iut,1)+ug3_1278(i1,i2,i7,i8)%c
     & (iut,1)*rmass(id3)
      cx2=ug3_1278(i1,i2,i7,i8)%c(iut,2)*p456q+ug3_1278(i1,i2,i7
     & ,i8)%a(iut,2)*rmass(id3)
      cy1=ug3_1278(i1,i2,i7,i8)%b(iut,1)+ug3_1278(i1,i2,i7,i8)%d
     & (iut,1)*rmass(id3)
      cy2=ug3_1278(i1,i2,i7,i8)%d(iut,2)*p456q+ug3_1278(i1,i2,i7
     & ,i8)%b(iut,2)*rmass(id3)
      cw1=ug3_1278(i1,i2,i7,i8)%c(iut,1)*p456q+ug3_1278(i1,i2,i7
     & ,i8)%a(iut,1)*rmass(id3)
      cw2=ug3_1278(i1,i2,i7,i8)%a(iut,2)+ug3_1278(i1,i2,i7,i8)%c
     & (iut,2)*rmass(id3)
      cz1=ug3_1278(i1,i2,i7,i8)%d(iut,1)*p456q+ug3_1278(i1,i2,i7
     & ,i8)%b(iut,1)*rmass(id3)
      cz2=ug3_1278(i1,i2,i7,i8)%b(iut,2)+ug3_1278(i1,i2,i7,i8)%d
     & (iut,2)*rmass(id3)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%a(iut,1)=cx1*r4_56(i5,i
     & 6)%a(1,1)+cx2*r4_56(i5,i6)%b(2,1)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%b(iut,1)=cy1*r4_56(i5,i
     & 6)%a(1,1)+cy2*r4_56(i5,i6)%b(2,1)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%c(iut,1)=cw1*r4_56(i5,i
     & 6)%d(1,1)+cw2*r4_56(i5,i6)%c(2,1)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%d(iut,1)=cz1*r4_56(i5,i
     & 6)%d(1,1)+cz2*r4_56(i5,i6)%c(2,1)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%a(iut,2)=cw1*r4_56(i5,i
     & 6)%b(1,2)+cw2*r4_56(i5,i6)%a(2,2)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%b(iut,2)=cz1*r4_56(i5,i
     & 6)%b(1,2)+cz2*r4_56(i5,i6)%a(2,2)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%c(iut,2)=cx1*r4_56(i5,i
     & 6)%c(1,2)+cx2*r4_56(i5,i6)%d(2,2)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%d(iut,2)=cy1*r4_56(i5,i
     & 6)%c(1,2)+cy2*r4_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* mline -- res=cres_3forks_34(i1,i2,i7,i8,i5,i6)%pol(&1,&2),abcd=cline_3
* forks_34(i1,i2,i7,i8,i5,i6)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_34(i1,i2,i7,i8,i5,i6)%pol(iut,jut)=cline_3fork
     & s_34(i1,i2,i7,i8,i5,i6)%a(iut,jut)+rmassl*cline_3forks_34
     & (i1,i2,i7,i8,i5,i6)%b(iut,jut)+rmassr*cline_3forks_34(i1,
     & i2,i7,i8,i5,i6)%c(iut,jut)+rmassl*rmassr*cline_3forks_34(
     & i1,i2,i7,i8,i5,i6)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,2) +
     &                     cres_3forks_34(i1,i2,i7,i8,i5,i6)
     &                     %pol(i3,i4)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
      endif    !if((ilept(id1).ne.1) .and. (ilept(id3).ne.1))
  
  
  
************************************************************************
******Color configuration no. 3 ***** [cres(...).caux(i7,i8,3)]*******  
************************************************************************
*                                                                       
*                           3| 1| 5| 7|                                 
*                            |  |~~|  |                                 
*                           4| 2| 6| 8|                                 
*                                                                       
*                                                                       
*Sum the diagrams belonging to classes 1), 2.a), 2.b), 2.c), 2.d) in    
*which the gluon connects Zlines 12 and 56                              
  
      if((ilept(id1).ne.1) .and. (ilept(id5).ne.1)) then
  
*****************Compute diagrams of class 1)***************************
*Link cg1234(2,2,2,2,0:3) with cg5678(2,2,2,2,0:3)                      
*     cg1278(2,2,2,2,0:3) with cg5634(2,2,2,2,0:3)                      
*The result is directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3)  
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3),p=cg1234(i1,i2,i3,i4,
* #),q=cg5678(i5,i6,i7,i8,#),bef=-,aft=/p1234q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3)=-(cg1234(i1,i2,i3,i4
     & ,0)*cg5678(i5,i6,i7,i8,0)-cg1234(i1,i2,i3,i4,1)*cg5678(i5
     & ,i6,i7,i8,1)-cg1234(i1,i2,i3,i4,2)*cg5678(i5,i6,i7,i8,2)-
     & cg1234(i1,i2,i3,i4,3)*cg5678(i5,i6,i7,i8,3))/p1234q
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3),p=cg1278(i1,i2,i7,i8,
* #),q=cg5634(i5,i6,i3,i4,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3)-,
* aft=/p1278q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,3)-(cg1278(i1,i2,i7,i8,0)*cg5634(i5,i6,i3,
     & i4,0)-cg1278(i1,i2,i7,i8,1)*cg5634(i5,i6,i3,i4,1)-cg1278(
     & i1,i2,i7,i8,2)*cg5634(i5,i6,i3,i4,2)-cg1278(i1,i2,i7,i8,3
     & )*cg5634(i5,i6,i3,i4,3))/p1278q
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
  
*****************Compute diagrams of class 2.a) and 2.b)****************
*                                                                       
* First compute subdiagrams of the type  [czqcd1256(2,2,2,2,0:3)]       
*                                        [cfqcd1256(2,2,2,2,0:3)]       
  
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TT -- aa=clinetzz(i1,i2,mu)%a,bb=clinetzz(i1,i2,mu)%b,cc=clinetzz(i1,i
* 2,mu)%c,dd=clinetzz(i1,i2,mu)%d,a1=lg5_12(i1,i2)%a,b1=lg5_12(i1,i2)%b,
* c1=lg5_12(i1,i2)%c,d1=lg5_12(i1,i2)%d,a2=rz6_512(mu)%a,b2=rz6_512(mu)%
* b,c2=rz6_512(mu)%c,d2=rz6_512(mu)%d,prq=p512q,m=rmass(id5),nsum=0
      clinetzz(i1,i2,mu)%a(1,1)=lg5_12(i1,i2)%a(1,1)*rz6_512(mu)
     & %a(1,1)+lg5_12(i1,i2)%c(1,2)*p512q*rz6_512(mu)%b(2,1)
      clinetzz(i1,i2,mu)%b(1,1)=rmass(id5)*(lg5_12(i1,i2)%d(1,1)
     & *rz6_512(mu)%a(1,1)+lg5_12(i1,i2)%b(1,2)*rz6_512(mu)%b(2,
     & 1))
      clinetzz(i1,i2,mu)%c(1,1)=rmass(id5)*(lg5_12(i1,i2)%a(1,1)
     & *rz6_512(mu)%d(1,1)+lg5_12(i1,i2)%c(1,2)*rz6_512(mu)%c(2,
     & 1))
      clinetzz(i1,i2,mu)%d(1,1)=lg5_12(i1,i2)%d(1,1)*p512q*rz6_5
     & 12(mu)%d(1,1)+lg5_12(i1,i2)%b(1,2)*rz6_512(mu)%c(2,1)
      clinetzz(i1,i2,mu)%a(1,2)=rmass(id5)*(lg5_12(i1,i2)%a(1,1)
     & *rz6_512(mu)%b(1,2)+lg5_12(i1,i2)%c(1,2)*rz6_512(mu)%a(2,
     & 2))
      clinetzz(i1,i2,mu)%b(1,2)=lg5_12(i1,i2)%d(1,1)*p512q*rz6_5
     & 12(mu)%b(1,2)+lg5_12(i1,i2)%b(1,2)*rz6_512(mu)%a(2,2)
      clinetzz(i1,i2,mu)%c(1,2)=lg5_12(i1,i2)%a(1,1)*rz6_512(mu)
     & %c(1,2)+lg5_12(i1,i2)%c(1,2)*p512q*rz6_512(mu)%d(2,2)
      clinetzz(i1,i2,mu)%d(1,2)=rmass(id5)*(lg5_12(i1,i2)%d(1,1)
     & *rz6_512(mu)%c(1,2)+lg5_12(i1,i2)%b(1,2)*rz6_512(mu)%d(2,
     & 2))
      clinetzz(i1,i2,mu)%a(2,1)=rmass(id5)*(lg5_12(i1,i2)%c(2,1)
     & *rz6_512(mu)%a(1,1)+lg5_12(i1,i2)%a(2,2)*rz6_512(mu)%b(2,
     & 1))
      clinetzz(i1,i2,mu)%b(2,1)=lg5_12(i1,i2)%b(2,1)*rz6_512(mu)
     & %a(1,1)+lg5_12(i1,i2)%d(2,2)*p512q*rz6_512(mu)%b(2,1)
      clinetzz(i1,i2,mu)%c(2,1)=lg5_12(i1,i2)%c(2,1)*p512q*rz6_5
     & 12(mu)%d(1,1)+lg5_12(i1,i2)%a(2,2)*rz6_512(mu)%c(2,1)
      clinetzz(i1,i2,mu)%d(2,1)=rmass(id5)*(lg5_12(i1,i2)%b(2,1)
     & *rz6_512(mu)%d(1,1)+lg5_12(i1,i2)%d(2,2)*rz6_512(mu)%c(2,
     & 1))
      clinetzz(i1,i2,mu)%a(2,2)=lg5_12(i1,i2)%c(2,1)*p512q*rz6_5
     & 12(mu)%b(1,2)+lg5_12(i1,i2)%a(2,2)*rz6_512(mu)%a(2,2)
      clinetzz(i1,i2,mu)%b(2,2)=rmass(id5)*(lg5_12(i1,i2)%b(2,1)
     & *rz6_512(mu)%b(1,2)+lg5_12(i1,i2)%d(2,2)*rz6_512(mu)%a(2,
     & 2))
      clinetzz(i1,i2,mu)%c(2,2)=rmass(id5)*(lg5_12(i1,i2)%c(2,1)
     & *rz6_512(mu)%c(1,2)+lg5_12(i1,i2)%a(2,2)*rz6_512(mu)%d(2,
     & 2))
      clinetzz(i1,i2,mu)%d(2,2)=lg5_12(i1,i2)%b(2,1)*rz6_512(mu)
     & %c(1,2)+lg5_12(i1,i2)%d(2,2)*p512q*rz6_512(mu)%d(2,2)
      end do
      end do
      end do
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TT -- aa=clinetzz(i1,i2,mu)%a,bb=clinetzz(i1,i2,mu)%b,cc=clinetzz(i1,i
* 2,mu)%c,dd=clinetzz(i1,i2,mu)%d,a1=lz5_612(mu)%a,b1=lz5_612(mu)%b,c1=l
* z5_612(mu)%c,d1=lz5_612(mu)%d,a2=rg6_12(i1,i2)%a,b2=rg6_12(i1,i2)%b,c2
* =rg6_12(i1,i2)%c,d2=rg6_12(i1,i2)%d,prq=p612q,m=rmass(id5),nsum=1
      clinetzz(i1,i2,mu)%a(1,1)=clinetzz(i1,i2,mu)%a(1,1)+lz5_61
     & 2(mu)%a(1,1)*rg6_12(i1,i2)%a(1,1)+lz5_612(mu)%c(1,2)*p612
     & q*rg6_12(i1,i2)%b(2,1)
      clinetzz(i1,i2,mu)%b(1,1)=clinetzz(i1,i2,mu)%b(1,1)+rmass(
     & id5)*(lz5_612(mu)%d(1,1)*rg6_12(i1,i2)%a(1,1)+lz5_612(mu)
     & %b(1,2)*rg6_12(i1,i2)%b(2,1))
      clinetzz(i1,i2,mu)%c(1,1)=clinetzz(i1,i2,mu)%c(1,1)+rmass(
     & id5)*(lz5_612(mu)%a(1,1)*rg6_12(i1,i2)%d(1,1)+lz5_612(mu)
     & %c(1,2)*rg6_12(i1,i2)%c(2,1))
      clinetzz(i1,i2,mu)%d(1,1)=clinetzz(i1,i2,mu)%d(1,1)+lz5_61
     & 2(mu)%d(1,1)*p612q*rg6_12(i1,i2)%d(1,1)+lz5_612(mu)%b(1,2
     & )*rg6_12(i1,i2)%c(2,1)
      clinetzz(i1,i2,mu)%a(1,2)=clinetzz(i1,i2,mu)%a(1,2)+rmass(
     & id5)*(lz5_612(mu)%a(1,1)*rg6_12(i1,i2)%b(1,2)+lz5_612(mu)
     & %c(1,2)*rg6_12(i1,i2)%a(2,2))
      clinetzz(i1,i2,mu)%b(1,2)=clinetzz(i1,i2,mu)%b(1,2)+lz5_61
     & 2(mu)%d(1,1)*p612q*rg6_12(i1,i2)%b(1,2)+lz5_612(mu)%b(1,2
     & )*rg6_12(i1,i2)%a(2,2)
      clinetzz(i1,i2,mu)%c(1,2)=clinetzz(i1,i2,mu)%c(1,2)+lz5_61
     & 2(mu)%a(1,1)*rg6_12(i1,i2)%c(1,2)+lz5_612(mu)%c(1,2)*p612
     & q*rg6_12(i1,i2)%d(2,2)
      clinetzz(i1,i2,mu)%d(1,2)=clinetzz(i1,i2,mu)%d(1,2)+rmass(
     & id5)*(lz5_612(mu)%d(1,1)*rg6_12(i1,i2)%c(1,2)+lz5_612(mu)
     & %b(1,2)*rg6_12(i1,i2)%d(2,2))
      clinetzz(i1,i2,mu)%a(2,1)=clinetzz(i1,i2,mu)%a(2,1)+rmass(
     & id5)*(lz5_612(mu)%c(2,1)*rg6_12(i1,i2)%a(1,1)+lz5_612(mu)
     & %a(2,2)*rg6_12(i1,i2)%b(2,1))
      clinetzz(i1,i2,mu)%b(2,1)=clinetzz(i1,i2,mu)%b(2,1)+lz5_61
     & 2(mu)%b(2,1)*rg6_12(i1,i2)%a(1,1)+lz5_612(mu)%d(2,2)*p612
     & q*rg6_12(i1,i2)%b(2,1)
      clinetzz(i1,i2,mu)%c(2,1)=clinetzz(i1,i2,mu)%c(2,1)+lz5_61
     & 2(mu)%c(2,1)*p612q*rg6_12(i1,i2)%d(1,1)+lz5_612(mu)%a(2,2
     & )*rg6_12(i1,i2)%c(2,1)
      clinetzz(i1,i2,mu)%d(2,1)=clinetzz(i1,i2,mu)%d(2,1)+rmass(
     & id5)*(lz5_612(mu)%b(2,1)*rg6_12(i1,i2)%d(1,1)+lz5_612(mu)
     & %d(2,2)*rg6_12(i1,i2)%c(2,1))
      clinetzz(i1,i2,mu)%a(2,2)=clinetzz(i1,i2,mu)%a(2,2)+lz5_61
     & 2(mu)%c(2,1)*p612q*rg6_12(i1,i2)%b(1,2)+lz5_612(mu)%a(2,2
     & )*rg6_12(i1,i2)%a(2,2)
      clinetzz(i1,i2,mu)%b(2,2)=clinetzz(i1,i2,mu)%b(2,2)+rmass(
     & id5)*(lz5_612(mu)%b(2,1)*rg6_12(i1,i2)%b(1,2)+lz5_612(mu)
     & %d(2,2)*rg6_12(i1,i2)%a(2,2))
      clinetzz(i1,i2,mu)%c(2,2)=clinetzz(i1,i2,mu)%c(2,2)+rmass(
     & id5)*(lz5_612(mu)%c(2,1)*rg6_12(i1,i2)%c(1,2)+lz5_612(mu)
     & %a(2,2)*rg6_12(i1,i2)%d(2,2))
      clinetzz(i1,i2,mu)%d(2,2)=clinetzz(i1,i2,mu)%d(2,2)+lz5_61
     & 2(mu)%b(2,1)*rg6_12(i1,i2)%c(1,2)+lz5_612(mu)%d(2,2)*p612
     & q*rg6_12(i1,i2)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id5)
      rmassr=-rmass(id5)
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=czqcd1256(i1,i2,&1,&2,mu),abcd=clinetzz(i1,i2,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      czqcd1256(i1,i2,iut,jut,mu)=clinetzz(i1,i2,mu)%a(iut,jut)+
     & rmassl*clinetzz(i1,i2,mu)%b(iut,jut)+rmassr*clinetzz(i1,i
     & 2,mu)%c(iut,jut)+rmassl*rmassr*clinetzz(i1,i2,mu)%d(iut,j
     & ut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TT -- aa=clinetzz(i5,i6,mu)%a,bb=clinetzz(i5,i6,mu)%b,cc=clinetzz(i5,i
* 6,mu)%c,dd=clinetzz(i5,i6,mu)%d,a1=lg1_56(i5,i6)%a,b1=lg1_56(i5,i6)%b,
* c1=lg1_56(i5,i6)%c,d1=lg1_56(i5,i6)%d,a2=rz2_156(mu)%a,b2=rz2_156(mu)%
* b,c2=rz2_156(mu)%c,d2=rz2_156(mu)%d,prq=p156q,m=rmass(id1),nsum=0
      clinetzz(i5,i6,mu)%a(1,1)=lg1_56(i5,i6)%a(1,1)*rz2_156(mu)
     & %a(1,1)+lg1_56(i5,i6)%c(1,2)*p156q*rz2_156(mu)%b(2,1)
      clinetzz(i5,i6,mu)%b(1,1)=rmass(id1)*(lg1_56(i5,i6)%d(1,1)
     & *rz2_156(mu)%a(1,1)+lg1_56(i5,i6)%b(1,2)*rz2_156(mu)%b(2,
     & 1))
      clinetzz(i5,i6,mu)%c(1,1)=rmass(id1)*(lg1_56(i5,i6)%a(1,1)
     & *rz2_156(mu)%d(1,1)+lg1_56(i5,i6)%c(1,2)*rz2_156(mu)%c(2,
     & 1))
      clinetzz(i5,i6,mu)%d(1,1)=lg1_56(i5,i6)%d(1,1)*p156q*rz2_1
     & 56(mu)%d(1,1)+lg1_56(i5,i6)%b(1,2)*rz2_156(mu)%c(2,1)
      clinetzz(i5,i6,mu)%a(1,2)=rmass(id1)*(lg1_56(i5,i6)%a(1,1)
     & *rz2_156(mu)%b(1,2)+lg1_56(i5,i6)%c(1,2)*rz2_156(mu)%a(2,
     & 2))
      clinetzz(i5,i6,mu)%b(1,2)=lg1_56(i5,i6)%d(1,1)*p156q*rz2_1
     & 56(mu)%b(1,2)+lg1_56(i5,i6)%b(1,2)*rz2_156(mu)%a(2,2)
      clinetzz(i5,i6,mu)%c(1,2)=lg1_56(i5,i6)%a(1,1)*rz2_156(mu)
     & %c(1,2)+lg1_56(i5,i6)%c(1,2)*p156q*rz2_156(mu)%d(2,2)
      clinetzz(i5,i6,mu)%d(1,2)=rmass(id1)*(lg1_56(i5,i6)%d(1,1)
     & *rz2_156(mu)%c(1,2)+lg1_56(i5,i6)%b(1,2)*rz2_156(mu)%d(2,
     & 2))
      clinetzz(i5,i6,mu)%a(2,1)=rmass(id1)*(lg1_56(i5,i6)%c(2,1)
     & *rz2_156(mu)%a(1,1)+lg1_56(i5,i6)%a(2,2)*rz2_156(mu)%b(2,
     & 1))
      clinetzz(i5,i6,mu)%b(2,1)=lg1_56(i5,i6)%b(2,1)*rz2_156(mu)
     & %a(1,1)+lg1_56(i5,i6)%d(2,2)*p156q*rz2_156(mu)%b(2,1)
      clinetzz(i5,i6,mu)%c(2,1)=lg1_56(i5,i6)%c(2,1)*p156q*rz2_1
     & 56(mu)%d(1,1)+lg1_56(i5,i6)%a(2,2)*rz2_156(mu)%c(2,1)
      clinetzz(i5,i6,mu)%d(2,1)=rmass(id1)*(lg1_56(i5,i6)%b(2,1)
     & *rz2_156(mu)%d(1,1)+lg1_56(i5,i6)%d(2,2)*rz2_156(mu)%c(2,
     & 1))
      clinetzz(i5,i6,mu)%a(2,2)=lg1_56(i5,i6)%c(2,1)*p156q*rz2_1
     & 56(mu)%b(1,2)+lg1_56(i5,i6)%a(2,2)*rz2_156(mu)%a(2,2)
      clinetzz(i5,i6,mu)%b(2,2)=rmass(id1)*(lg1_56(i5,i6)%b(2,1)
     & *rz2_156(mu)%b(1,2)+lg1_56(i5,i6)%d(2,2)*rz2_156(mu)%a(2,
     & 2))
      clinetzz(i5,i6,mu)%c(2,2)=rmass(id1)*(lg1_56(i5,i6)%c(2,1)
     & *rz2_156(mu)%c(1,2)+lg1_56(i5,i6)%a(2,2)*rz2_156(mu)%d(2,
     & 2))
      clinetzz(i5,i6,mu)%d(2,2)=lg1_56(i5,i6)%b(2,1)*rz2_156(mu)
     & %c(1,2)+lg1_56(i5,i6)%d(2,2)*p156q*rz2_156(mu)%d(2,2)
      end do
      end do
      end do
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TT -- aa=clinetzz(i5,i6,mu)%a,bb=clinetzz(i5,i6,mu)%b,cc=clinetzz(i5,i
* 6,mu)%c,dd=clinetzz(i5,i6,mu)%d,a1=lz1_256(mu)%a,b1=lz1_256(mu)%b,c1=l
* z1_256(mu)%c,d1=lz1_256(mu)%d,a2=rg2_56(i5,i6)%a,b2=rg2_56(i5,i6)%b,c2
* =rg2_56(i5,i6)%c,d2=rg2_56(i5,i6)%d,prq=p256q,m=rmass(id1),nsum=1
      clinetzz(i5,i6,mu)%a(1,1)=clinetzz(i5,i6,mu)%a(1,1)+lz1_25
     & 6(mu)%a(1,1)*rg2_56(i5,i6)%a(1,1)+lz1_256(mu)%c(1,2)*p256
     & q*rg2_56(i5,i6)%b(2,1)
      clinetzz(i5,i6,mu)%b(1,1)=clinetzz(i5,i6,mu)%b(1,1)+rmass(
     & id1)*(lz1_256(mu)%d(1,1)*rg2_56(i5,i6)%a(1,1)+lz1_256(mu)
     & %b(1,2)*rg2_56(i5,i6)%b(2,1))
      clinetzz(i5,i6,mu)%c(1,1)=clinetzz(i5,i6,mu)%c(1,1)+rmass(
     & id1)*(lz1_256(mu)%a(1,1)*rg2_56(i5,i6)%d(1,1)+lz1_256(mu)
     & %c(1,2)*rg2_56(i5,i6)%c(2,1))
      clinetzz(i5,i6,mu)%d(1,1)=clinetzz(i5,i6,mu)%d(1,1)+lz1_25
     & 6(mu)%d(1,1)*p256q*rg2_56(i5,i6)%d(1,1)+lz1_256(mu)%b(1,2
     & )*rg2_56(i5,i6)%c(2,1)
      clinetzz(i5,i6,mu)%a(1,2)=clinetzz(i5,i6,mu)%a(1,2)+rmass(
     & id1)*(lz1_256(mu)%a(1,1)*rg2_56(i5,i6)%b(1,2)+lz1_256(mu)
     & %c(1,2)*rg2_56(i5,i6)%a(2,2))
      clinetzz(i5,i6,mu)%b(1,2)=clinetzz(i5,i6,mu)%b(1,2)+lz1_25
     & 6(mu)%d(1,1)*p256q*rg2_56(i5,i6)%b(1,2)+lz1_256(mu)%b(1,2
     & )*rg2_56(i5,i6)%a(2,2)
      clinetzz(i5,i6,mu)%c(1,2)=clinetzz(i5,i6,mu)%c(1,2)+lz1_25
     & 6(mu)%a(1,1)*rg2_56(i5,i6)%c(1,2)+lz1_256(mu)%c(1,2)*p256
     & q*rg2_56(i5,i6)%d(2,2)
      clinetzz(i5,i6,mu)%d(1,2)=clinetzz(i5,i6,mu)%d(1,2)+rmass(
     & id1)*(lz1_256(mu)%d(1,1)*rg2_56(i5,i6)%c(1,2)+lz1_256(mu)
     & %b(1,2)*rg2_56(i5,i6)%d(2,2))
      clinetzz(i5,i6,mu)%a(2,1)=clinetzz(i5,i6,mu)%a(2,1)+rmass(
     & id1)*(lz1_256(mu)%c(2,1)*rg2_56(i5,i6)%a(1,1)+lz1_256(mu)
     & %a(2,2)*rg2_56(i5,i6)%b(2,1))
      clinetzz(i5,i6,mu)%b(2,1)=clinetzz(i5,i6,mu)%b(2,1)+lz1_25
     & 6(mu)%b(2,1)*rg2_56(i5,i6)%a(1,1)+lz1_256(mu)%d(2,2)*p256
     & q*rg2_56(i5,i6)%b(2,1)
      clinetzz(i5,i6,mu)%c(2,1)=clinetzz(i5,i6,mu)%c(2,1)+lz1_25
     & 6(mu)%c(2,1)*p256q*rg2_56(i5,i6)%d(1,1)+lz1_256(mu)%a(2,2
     & )*rg2_56(i5,i6)%c(2,1)
      clinetzz(i5,i6,mu)%d(2,1)=clinetzz(i5,i6,mu)%d(2,1)+rmass(
     & id1)*(lz1_256(mu)%b(2,1)*rg2_56(i5,i6)%d(1,1)+lz1_256(mu)
     & %d(2,2)*rg2_56(i5,i6)%c(2,1))
      clinetzz(i5,i6,mu)%a(2,2)=clinetzz(i5,i6,mu)%a(2,2)+lz1_25
     & 6(mu)%c(2,1)*p256q*rg2_56(i5,i6)%b(1,2)+lz1_256(mu)%a(2,2
     & )*rg2_56(i5,i6)%a(2,2)
      clinetzz(i5,i6,mu)%b(2,2)=clinetzz(i5,i6,mu)%b(2,2)+rmass(
     & id1)*(lz1_256(mu)%b(2,1)*rg2_56(i5,i6)%b(1,2)+lz1_256(mu)
     & %d(2,2)*rg2_56(i5,i6)%a(2,2))
      clinetzz(i5,i6,mu)%c(2,2)=clinetzz(i5,i6,mu)%c(2,2)+rmass(
     & id1)*(lz1_256(mu)%c(2,1)*rg2_56(i5,i6)%c(1,2)+lz1_256(mu)
     & %a(2,2)*rg2_56(i5,i6)%d(2,2))
      clinetzz(i5,i6,mu)%d(2,2)=clinetzz(i5,i6,mu)%d(2,2)+lz1_25
     & 6(mu)%b(2,1)*rg2_56(i5,i6)%c(1,2)+lz1_256(mu)%d(2,2)*p256
     & q*rg2_56(i5,i6)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id1)
      rmassr=-rmass(id1)
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* mline -- res=czqcd1256(&1,&2,i5,i6,mu),abcd=clinetzz(i5,i6,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      czqcd1256(iut,jut,i5,i6,mu)=czqcd1256(iut,jut,i5,i6,mu)+cl
     & inetzz(i5,i6,mu)%a(iut,jut)+rmassl*clinetzz(i5,i6,mu)%b(i
     & ut,jut)+rmassr*clinetzz(i5,i6,mu)%c(iut,jut)+rmassl*rmass
     & r*clinetzz(i5,i6,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TT -- aa=clinetfz(i1,i2,mu)%a,bb=clinetfz(i1,i2,mu)%b,cc=clinetfz(i1,i
* 2,mu)%c,dd=clinetfz(i1,i2,mu)%d,a1=lg5_12(i1,i2)%a,b1=lg5_12(i1,i2)%b,
* c1=lg5_12(i1,i2)%c,d1=lg5_12(i1,i2)%d,a2=rf6_512(mu)%a,b2=rf6_512(mu)%
* b,c2=rf6_512(mu)%c,d2=rf6_512(mu)%d,prq=p512q,m=rmass(id5),nsum=0
      clinetfz(i1,i2,mu)%a(1,1)=lg5_12(i1,i2)%a(1,1)*rf6_512(mu)
     & %a(1,1)+lg5_12(i1,i2)%c(1,2)*p512q*rf6_512(mu)%b(2,1)
      clinetfz(i1,i2,mu)%b(1,1)=rmass(id5)*(lg5_12(i1,i2)%d(1,1)
     & *rf6_512(mu)%a(1,1)+lg5_12(i1,i2)%b(1,2)*rf6_512(mu)%b(2,
     & 1))
      clinetfz(i1,i2,mu)%c(1,1)=rmass(id5)*(lg5_12(i1,i2)%a(1,1)
     & *rf6_512(mu)%d(1,1)+lg5_12(i1,i2)%c(1,2)*rf6_512(mu)%c(2,
     & 1))
      clinetfz(i1,i2,mu)%d(1,1)=lg5_12(i1,i2)%d(1,1)*p512q*rf6_5
     & 12(mu)%d(1,1)+lg5_12(i1,i2)%b(1,2)*rf6_512(mu)%c(2,1)
      clinetfz(i1,i2,mu)%a(1,2)=rmass(id5)*(lg5_12(i1,i2)%a(1,1)
     & *rf6_512(mu)%b(1,2)+lg5_12(i1,i2)%c(1,2)*rf6_512(mu)%a(2,
     & 2))
      clinetfz(i1,i2,mu)%b(1,2)=lg5_12(i1,i2)%d(1,1)*p512q*rf6_5
     & 12(mu)%b(1,2)+lg5_12(i1,i2)%b(1,2)*rf6_512(mu)%a(2,2)
      clinetfz(i1,i2,mu)%c(1,2)=lg5_12(i1,i2)%a(1,1)*rf6_512(mu)
     & %c(1,2)+lg5_12(i1,i2)%c(1,2)*p512q*rf6_512(mu)%d(2,2)
      clinetfz(i1,i2,mu)%d(1,2)=rmass(id5)*(lg5_12(i1,i2)%d(1,1)
     & *rf6_512(mu)%c(1,2)+lg5_12(i1,i2)%b(1,2)*rf6_512(mu)%d(2,
     & 2))
      clinetfz(i1,i2,mu)%a(2,1)=rmass(id5)*(lg5_12(i1,i2)%c(2,1)
     & *rf6_512(mu)%a(1,1)+lg5_12(i1,i2)%a(2,2)*rf6_512(mu)%b(2,
     & 1))
      clinetfz(i1,i2,mu)%b(2,1)=lg5_12(i1,i2)%b(2,1)*rf6_512(mu)
     & %a(1,1)+lg5_12(i1,i2)%d(2,2)*p512q*rf6_512(mu)%b(2,1)
      clinetfz(i1,i2,mu)%c(2,1)=lg5_12(i1,i2)%c(2,1)*p512q*rf6_5
     & 12(mu)%d(1,1)+lg5_12(i1,i2)%a(2,2)*rf6_512(mu)%c(2,1)
      clinetfz(i1,i2,mu)%d(2,1)=rmass(id5)*(lg5_12(i1,i2)%b(2,1)
     & *rf6_512(mu)%d(1,1)+lg5_12(i1,i2)%d(2,2)*rf6_512(mu)%c(2,
     & 1))
      clinetfz(i1,i2,mu)%a(2,2)=lg5_12(i1,i2)%c(2,1)*p512q*rf6_5
     & 12(mu)%b(1,2)+lg5_12(i1,i2)%a(2,2)*rf6_512(mu)%a(2,2)
      clinetfz(i1,i2,mu)%b(2,2)=rmass(id5)*(lg5_12(i1,i2)%b(2,1)
     & *rf6_512(mu)%b(1,2)+lg5_12(i1,i2)%d(2,2)*rf6_512(mu)%a(2,
     & 2))
      clinetfz(i1,i2,mu)%c(2,2)=rmass(id5)*(lg5_12(i1,i2)%c(2,1)
     & *rf6_512(mu)%c(1,2)+lg5_12(i1,i2)%a(2,2)*rf6_512(mu)%d(2,
     & 2))
      clinetfz(i1,i2,mu)%d(2,2)=lg5_12(i1,i2)%b(2,1)*rf6_512(mu)
     & %c(1,2)+lg5_12(i1,i2)%d(2,2)*p512q*rf6_512(mu)%d(2,2)
      end do
      end do
      end do
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TT -- aa=clinetfz(i1,i2,mu)%a,bb=clinetfz(i1,i2,mu)%b,cc=clinetfz(i1,i
* 2,mu)%c,dd=clinetfz(i1,i2,mu)%d,a1=lf5_612(mu)%a,b1=lf5_612(mu)%b,c1=l
* f5_612(mu)%c,d1=lf5_612(mu)%d,a2=rg6_12(i1,i2)%a,b2=rg6_12(i1,i2)%b,c2
* =rg6_12(i1,i2)%c,d2=rg6_12(i1,i2)%d,prq=p612q,m=rmass(id5),nsum=1
      clinetfz(i1,i2,mu)%a(1,1)=clinetfz(i1,i2,mu)%a(1,1)+lf5_61
     & 2(mu)%a(1,1)*rg6_12(i1,i2)%a(1,1)+lf5_612(mu)%c(1,2)*p612
     & q*rg6_12(i1,i2)%b(2,1)
      clinetfz(i1,i2,mu)%b(1,1)=clinetfz(i1,i2,mu)%b(1,1)+rmass(
     & id5)*(lf5_612(mu)%d(1,1)*rg6_12(i1,i2)%a(1,1)+lf5_612(mu)
     & %b(1,2)*rg6_12(i1,i2)%b(2,1))
      clinetfz(i1,i2,mu)%c(1,1)=clinetfz(i1,i2,mu)%c(1,1)+rmass(
     & id5)*(lf5_612(mu)%a(1,1)*rg6_12(i1,i2)%d(1,1)+lf5_612(mu)
     & %c(1,2)*rg6_12(i1,i2)%c(2,1))
      clinetfz(i1,i2,mu)%d(1,1)=clinetfz(i1,i2,mu)%d(1,1)+lf5_61
     & 2(mu)%d(1,1)*p612q*rg6_12(i1,i2)%d(1,1)+lf5_612(mu)%b(1,2
     & )*rg6_12(i1,i2)%c(2,1)
      clinetfz(i1,i2,mu)%a(1,2)=clinetfz(i1,i2,mu)%a(1,2)+rmass(
     & id5)*(lf5_612(mu)%a(1,1)*rg6_12(i1,i2)%b(1,2)+lf5_612(mu)
     & %c(1,2)*rg6_12(i1,i2)%a(2,2))
      clinetfz(i1,i2,mu)%b(1,2)=clinetfz(i1,i2,mu)%b(1,2)+lf5_61
     & 2(mu)%d(1,1)*p612q*rg6_12(i1,i2)%b(1,2)+lf5_612(mu)%b(1,2
     & )*rg6_12(i1,i2)%a(2,2)
      clinetfz(i1,i2,mu)%c(1,2)=clinetfz(i1,i2,mu)%c(1,2)+lf5_61
     & 2(mu)%a(1,1)*rg6_12(i1,i2)%c(1,2)+lf5_612(mu)%c(1,2)*p612
     & q*rg6_12(i1,i2)%d(2,2)
      clinetfz(i1,i2,mu)%d(1,2)=clinetfz(i1,i2,mu)%d(1,2)+rmass(
     & id5)*(lf5_612(mu)%d(1,1)*rg6_12(i1,i2)%c(1,2)+lf5_612(mu)
     & %b(1,2)*rg6_12(i1,i2)%d(2,2))
      clinetfz(i1,i2,mu)%a(2,1)=clinetfz(i1,i2,mu)%a(2,1)+rmass(
     & id5)*(lf5_612(mu)%c(2,1)*rg6_12(i1,i2)%a(1,1)+lf5_612(mu)
     & %a(2,2)*rg6_12(i1,i2)%b(2,1))
      clinetfz(i1,i2,mu)%b(2,1)=clinetfz(i1,i2,mu)%b(2,1)+lf5_61
     & 2(mu)%b(2,1)*rg6_12(i1,i2)%a(1,1)+lf5_612(mu)%d(2,2)*p612
     & q*rg6_12(i1,i2)%b(2,1)
      clinetfz(i1,i2,mu)%c(2,1)=clinetfz(i1,i2,mu)%c(2,1)+lf5_61
     & 2(mu)%c(2,1)*p612q*rg6_12(i1,i2)%d(1,1)+lf5_612(mu)%a(2,2
     & )*rg6_12(i1,i2)%c(2,1)
      clinetfz(i1,i2,mu)%d(2,1)=clinetfz(i1,i2,mu)%d(2,1)+rmass(
     & id5)*(lf5_612(mu)%b(2,1)*rg6_12(i1,i2)%d(1,1)+lf5_612(mu)
     & %d(2,2)*rg6_12(i1,i2)%c(2,1))
      clinetfz(i1,i2,mu)%a(2,2)=clinetfz(i1,i2,mu)%a(2,2)+lf5_61
     & 2(mu)%c(2,1)*p612q*rg6_12(i1,i2)%b(1,2)+lf5_612(mu)%a(2,2
     & )*rg6_12(i1,i2)%a(2,2)
      clinetfz(i1,i2,mu)%b(2,2)=clinetfz(i1,i2,mu)%b(2,2)+rmass(
     & id5)*(lf5_612(mu)%b(2,1)*rg6_12(i1,i2)%b(1,2)+lf5_612(mu)
     & %d(2,2)*rg6_12(i1,i2)%a(2,2))
      clinetfz(i1,i2,mu)%c(2,2)=clinetfz(i1,i2,mu)%c(2,2)+rmass(
     & id5)*(lf5_612(mu)%c(2,1)*rg6_12(i1,i2)%c(1,2)+lf5_612(mu)
     & %a(2,2)*rg6_12(i1,i2)%d(2,2))
      clinetfz(i1,i2,mu)%d(2,2)=clinetfz(i1,i2,mu)%d(2,2)+lf5_61
     & 2(mu)%b(2,1)*rg6_12(i1,i2)%c(1,2)+lf5_612(mu)%d(2,2)*p612
     & q*rg6_12(i1,i2)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id5)
      rmassr=-rmass(id5)
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=cfqcd1256(i1,i2,&1,&2,mu),abcd=clinetfz(i1,i2,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cfqcd1256(i1,i2,iut,jut,mu)=clinetfz(i1,i2,mu)%a(iut,jut)+
     & rmassl*clinetfz(i1,i2,mu)%b(iut,jut)+rmassr*clinetfz(i1,i
     & 2,mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i1,i2,mu)%d(iut,j
     & ut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TT -- aa=clinetfz(i5,i6,mu)%a,bb=clinetfz(i5,i6,mu)%b,cc=clinetfz(i5,i
* 6,mu)%c,dd=clinetfz(i5,i6,mu)%d,a1=lg1_56(i5,i6)%a,b1=lg1_56(i5,i6)%b,
* c1=lg1_56(i5,i6)%c,d1=lg1_56(i5,i6)%d,a2=rf2_156(mu)%a,b2=rf2_156(mu)%
* b,c2=rf2_156(mu)%c,d2=rf2_156(mu)%d,prq=p156q,m=rmass(id1),nsum=0
      clinetfz(i5,i6,mu)%a(1,1)=lg1_56(i5,i6)%a(1,1)*rf2_156(mu)
     & %a(1,1)+lg1_56(i5,i6)%c(1,2)*p156q*rf2_156(mu)%b(2,1)
      clinetfz(i5,i6,mu)%b(1,1)=rmass(id1)*(lg1_56(i5,i6)%d(1,1)
     & *rf2_156(mu)%a(1,1)+lg1_56(i5,i6)%b(1,2)*rf2_156(mu)%b(2,
     & 1))
      clinetfz(i5,i6,mu)%c(1,1)=rmass(id1)*(lg1_56(i5,i6)%a(1,1)
     & *rf2_156(mu)%d(1,1)+lg1_56(i5,i6)%c(1,2)*rf2_156(mu)%c(2,
     & 1))
      clinetfz(i5,i6,mu)%d(1,1)=lg1_56(i5,i6)%d(1,1)*p156q*rf2_1
     & 56(mu)%d(1,1)+lg1_56(i5,i6)%b(1,2)*rf2_156(mu)%c(2,1)
      clinetfz(i5,i6,mu)%a(1,2)=rmass(id1)*(lg1_56(i5,i6)%a(1,1)
     & *rf2_156(mu)%b(1,2)+lg1_56(i5,i6)%c(1,2)*rf2_156(mu)%a(2,
     & 2))
      clinetfz(i5,i6,mu)%b(1,2)=lg1_56(i5,i6)%d(1,1)*p156q*rf2_1
     & 56(mu)%b(1,2)+lg1_56(i5,i6)%b(1,2)*rf2_156(mu)%a(2,2)
      clinetfz(i5,i6,mu)%c(1,2)=lg1_56(i5,i6)%a(1,1)*rf2_156(mu)
     & %c(1,2)+lg1_56(i5,i6)%c(1,2)*p156q*rf2_156(mu)%d(2,2)
      clinetfz(i5,i6,mu)%d(1,2)=rmass(id1)*(lg1_56(i5,i6)%d(1,1)
     & *rf2_156(mu)%c(1,2)+lg1_56(i5,i6)%b(1,2)*rf2_156(mu)%d(2,
     & 2))
      clinetfz(i5,i6,mu)%a(2,1)=rmass(id1)*(lg1_56(i5,i6)%c(2,1)
     & *rf2_156(mu)%a(1,1)+lg1_56(i5,i6)%a(2,2)*rf2_156(mu)%b(2,
     & 1))
      clinetfz(i5,i6,mu)%b(2,1)=lg1_56(i5,i6)%b(2,1)*rf2_156(mu)
     & %a(1,1)+lg1_56(i5,i6)%d(2,2)*p156q*rf2_156(mu)%b(2,1)
      clinetfz(i5,i6,mu)%c(2,1)=lg1_56(i5,i6)%c(2,1)*p156q*rf2_1
     & 56(mu)%d(1,1)+lg1_56(i5,i6)%a(2,2)*rf2_156(mu)%c(2,1)
      clinetfz(i5,i6,mu)%d(2,1)=rmass(id1)*(lg1_56(i5,i6)%b(2,1)
     & *rf2_156(mu)%d(1,1)+lg1_56(i5,i6)%d(2,2)*rf2_156(mu)%c(2,
     & 1))
      clinetfz(i5,i6,mu)%a(2,2)=lg1_56(i5,i6)%c(2,1)*p156q*rf2_1
     & 56(mu)%b(1,2)+lg1_56(i5,i6)%a(2,2)*rf2_156(mu)%a(2,2)
      clinetfz(i5,i6,mu)%b(2,2)=rmass(id1)*(lg1_56(i5,i6)%b(2,1)
     & *rf2_156(mu)%b(1,2)+lg1_56(i5,i6)%d(2,2)*rf2_156(mu)%a(2,
     & 2))
      clinetfz(i5,i6,mu)%c(2,2)=rmass(id1)*(lg1_56(i5,i6)%c(2,1)
     & *rf2_156(mu)%c(1,2)+lg1_56(i5,i6)%a(2,2)*rf2_156(mu)%d(2,
     & 2))
      clinetfz(i5,i6,mu)%d(2,2)=lg1_56(i5,i6)%b(2,1)*rf2_156(mu)
     & %c(1,2)+lg1_56(i5,i6)%d(2,2)*p156q*rf2_156(mu)%d(2,2)
      end do
      end do
      end do
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TT -- aa=clinetfz(i5,i6,mu)%a,bb=clinetfz(i5,i6,mu)%b,cc=clinetfz(i5,i
* 6,mu)%c,dd=clinetfz(i5,i6,mu)%d,a1=lf1_256(mu)%a,b1=lf1_256(mu)%b,c1=l
* f1_256(mu)%c,d1=lf1_256(mu)%d,a2=rg2_56(i5,i6)%a,b2=rg2_56(i5,i6)%b,c2
* =rg2_56(i5,i6)%c,d2=rg2_56(i5,i6)%d,prq=p256q,m=rmass(id1),nsum=1
      clinetfz(i5,i6,mu)%a(1,1)=clinetfz(i5,i6,mu)%a(1,1)+lf1_25
     & 6(mu)%a(1,1)*rg2_56(i5,i6)%a(1,1)+lf1_256(mu)%c(1,2)*p256
     & q*rg2_56(i5,i6)%b(2,1)
      clinetfz(i5,i6,mu)%b(1,1)=clinetfz(i5,i6,mu)%b(1,1)+rmass(
     & id1)*(lf1_256(mu)%d(1,1)*rg2_56(i5,i6)%a(1,1)+lf1_256(mu)
     & %b(1,2)*rg2_56(i5,i6)%b(2,1))
      clinetfz(i5,i6,mu)%c(1,1)=clinetfz(i5,i6,mu)%c(1,1)+rmass(
     & id1)*(lf1_256(mu)%a(1,1)*rg2_56(i5,i6)%d(1,1)+lf1_256(mu)
     & %c(1,2)*rg2_56(i5,i6)%c(2,1))
      clinetfz(i5,i6,mu)%d(1,1)=clinetfz(i5,i6,mu)%d(1,1)+lf1_25
     & 6(mu)%d(1,1)*p256q*rg2_56(i5,i6)%d(1,1)+lf1_256(mu)%b(1,2
     & )*rg2_56(i5,i6)%c(2,1)
      clinetfz(i5,i6,mu)%a(1,2)=clinetfz(i5,i6,mu)%a(1,2)+rmass(
     & id1)*(lf1_256(mu)%a(1,1)*rg2_56(i5,i6)%b(1,2)+lf1_256(mu)
     & %c(1,2)*rg2_56(i5,i6)%a(2,2))
      clinetfz(i5,i6,mu)%b(1,2)=clinetfz(i5,i6,mu)%b(1,2)+lf1_25
     & 6(mu)%d(1,1)*p256q*rg2_56(i5,i6)%b(1,2)+lf1_256(mu)%b(1,2
     & )*rg2_56(i5,i6)%a(2,2)
      clinetfz(i5,i6,mu)%c(1,2)=clinetfz(i5,i6,mu)%c(1,2)+lf1_25
     & 6(mu)%a(1,1)*rg2_56(i5,i6)%c(1,2)+lf1_256(mu)%c(1,2)*p256
     & q*rg2_56(i5,i6)%d(2,2)
      clinetfz(i5,i6,mu)%d(1,2)=clinetfz(i5,i6,mu)%d(1,2)+rmass(
     & id1)*(lf1_256(mu)%d(1,1)*rg2_56(i5,i6)%c(1,2)+lf1_256(mu)
     & %b(1,2)*rg2_56(i5,i6)%d(2,2))
      clinetfz(i5,i6,mu)%a(2,1)=clinetfz(i5,i6,mu)%a(2,1)+rmass(
     & id1)*(lf1_256(mu)%c(2,1)*rg2_56(i5,i6)%a(1,1)+lf1_256(mu)
     & %a(2,2)*rg2_56(i5,i6)%b(2,1))
      clinetfz(i5,i6,mu)%b(2,1)=clinetfz(i5,i6,mu)%b(2,1)+lf1_25
     & 6(mu)%b(2,1)*rg2_56(i5,i6)%a(1,1)+lf1_256(mu)%d(2,2)*p256
     & q*rg2_56(i5,i6)%b(2,1)
      clinetfz(i5,i6,mu)%c(2,1)=clinetfz(i5,i6,mu)%c(2,1)+lf1_25
     & 6(mu)%c(2,1)*p256q*rg2_56(i5,i6)%d(1,1)+lf1_256(mu)%a(2,2
     & )*rg2_56(i5,i6)%c(2,1)
      clinetfz(i5,i6,mu)%d(2,1)=clinetfz(i5,i6,mu)%d(2,1)+rmass(
     & id1)*(lf1_256(mu)%b(2,1)*rg2_56(i5,i6)%d(1,1)+lf1_256(mu)
     & %d(2,2)*rg2_56(i5,i6)%c(2,1))
      clinetfz(i5,i6,mu)%a(2,2)=clinetfz(i5,i6,mu)%a(2,2)+lf1_25
     & 6(mu)%c(2,1)*p256q*rg2_56(i5,i6)%b(1,2)+lf1_256(mu)%a(2,2
     & )*rg2_56(i5,i6)%a(2,2)
      clinetfz(i5,i6,mu)%b(2,2)=clinetfz(i5,i6,mu)%b(2,2)+rmass(
     & id1)*(lf1_256(mu)%b(2,1)*rg2_56(i5,i6)%b(1,2)+lf1_256(mu)
     & %d(2,2)*rg2_56(i5,i6)%a(2,2))
      clinetfz(i5,i6,mu)%c(2,2)=clinetfz(i5,i6,mu)%c(2,2)+rmass(
     & id1)*(lf1_256(mu)%c(2,1)*rg2_56(i5,i6)%c(1,2)+lf1_256(mu)
     & %a(2,2)*rg2_56(i5,i6)%d(2,2))
      clinetfz(i5,i6,mu)%d(2,2)=clinetfz(i5,i6,mu)%d(2,2)+lf1_25
     & 6(mu)%b(2,1)*rg2_56(i5,i6)%c(1,2)+lf1_256(mu)%d(2,2)*p256
     & q*rg2_56(i5,i6)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id1)
      rmassr=-rmass(id1)
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* mline -- res=cfqcd1256(&1,&2,i5,i6,mu),abcd=clinetfz(i5,i6,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cfqcd1256(iut,jut,i5,i6,mu)=cfqcd1256(iut,jut,i5,i6,mu)+cl
     & inetfz(i5,i6,mu)%a(iut,jut)+rmassl*clinetfz(i5,i6,mu)%b(i
     & ut,jut)+rmassr*clinetfz(i5,i6,mu)%c(iut,jut)+rmassl*rmass
     & r*clinetfz(i5,i6,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
  
*                                                                       
* Then link the computed subdiagrams with the "Z" and "gamma" insertions
* [cz3478(2,2,2,2,0:3) and cf3478(2,2,2,2,0:3)]%                        
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3)   
*                                                                       
  
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
  
* "Z" insertion                                                         
* p.q -- p.q=cp1256dotczqcd1256,p=p1256(#),q=czqcd1256(i1,i2,i5,i6,#),be
* f=,aft=
      cp1256dotczqcd1256=(p1256(0)*czqcd1256(i1,i2,i5,i6,0)-p125
     & 6(1)*czqcd1256(i1,i2,i5,i6,1)-p1256(2)*czqcd1256(i1,i2,i5
     & ,i6,2)-p1256(3)*czqcd1256(i1,i2,i5,i6,3))
  
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3),p=czqcd1256(i1,i2,i5,
* i6,#),q=cz3478(i3,i4,i7,i8,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3
* )-,aft=/(p1256q-cmz2)
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,3)-(czqcd1256(i1,i2,i5,i6,0)*cz3478(i3,i4,
     & i7,i8,0)-czqcd1256(i1,i2,i5,i6,1)*cz3478(i3,i4,i7,i8,1)-c
     & zqcd1256(i1,i2,i5,i6,2)*cz3478(i3,i4,i7,i8,2)-czqcd1256(i
     & 1,i2,i5,i6,3)*cz3478(i3,i4,i7,i8,3))/(p1256q-cmz2)
  
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) =
     &   cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) +
     &   (cp1256dotczqcd1256*cp1256dotcz3478(i3,i4,i7,i8))
     &   /cmz2/(p1256q-cmz2)
  
* "gamma" insertion                                                     
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3),p=cfqcd1256(i1,i2,i5,
* i6,#),q=cf3478(i3,i4,i7,i8,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3
* )-,aft=/p1256q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,3)-(cfqcd1256(i1,i2,i5,i6,0)*cf3478(i3,i4,
     & i7,i8,0)-cfqcd1256(i1,i2,i5,i6,1)*cf3478(i3,i4,i7,i8,1)-c
     & fqcd1256(i1,i2,i5,i6,2)*cf3478(i3,i4,i7,i8,2)-cfqcd1256(i
     & 1,i2,i5,i6,3)*cf3478(i3,i4,i7,i8,3))/p1256q
  
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
*****************Compute diagrams of class 2.c)*************************
*                                                                       
*First compute subdiagrams of the type  [chqcd1256(2,2,2,2)]            
*                                                                       
*                                                                       
  
      do i1=1,2
        do i2=1,2
          do i5=1,2
            do i6=1,2
              chqcd1256(i1,i2,i5,i6)=czero
            enddo
          enddo
        enddo
      enddo
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.rmh.ge.0.d0) then
  
      do i5=1,2
      do i6=1,2
* TTSC -- aa=clineth_4f(i5,i6)%a,bb=clineth_4f(i5,i6)%b,cc=clineth_4f(i5
* ,i6)%c,dd=clineth_4f(i5,i6)%d,a1=lg1_56(i5,i6)%a,b1=lg1_56(i5,i6)%b,c1
* =lg1_56(i5,i6)%c,d1=lg1_56(i5,i6)%d,a2=rh2_156%a,b2=rh2_156%b,c2=rh2_1
* 56%c,prq=p156q,m=rmass(id1),nsum=0
      clineth_4f(i5,i6)%a(1,2)=lg1_56(i5,i6)%a(1,1)*rh2_156%a(1,
     & 2)+lg1_56(i5,i6)%c(1,2)*p156q*rh2_156%b(2,2)
      clineth_4f(i5,i6)%b(1,2)=rmass(id1)*(lg1_56(i5,i6)%d(1,1)*
     & rh2_156%a(1,2)+lg1_56(i5,i6)%b(1,2)*rh2_156%b(2,2))
      clineth_4f(i5,i6)%c(1,2)=rmass(id1)*lg1_56(i5,i6)%c(1,2)*r
     & h2_156%c(2,2)
      clineth_4f(i5,i6)%d(1,2)=lg1_56(i5,i6)%b(1,2)*rh2_156%c(2,
     & 2)
      clineth_4f(i5,i6)%a(1,1)=rmass(id1)*(lg1_56(i5,i6)%a(1,1)*
     & rh2_156%b(1,1)+lg1_56(i5,i6)%c(1,2)*rh2_156%a(2,1))
      clineth_4f(i5,i6)%b(1,1)=lg1_56(i5,i6)%d(1,1)*p156q*rh2_15
     & 6%b(1,1)+lg1_56(i5,i6)%b(1,2)*rh2_156%a(2,1)
      clineth_4f(i5,i6)%c(1,1)=lg1_56(i5,i6)%a(1,1)*rh2_156%c(1,
     & 1)
      clineth_4f(i5,i6)%d(1,1)=rmass(id1)*lg1_56(i5,i6)%d(1,1)*r
     & h2_156%c(1,1)
      clineth_4f(i5,i6)%a(2,2)=rmass(id1)*(lg1_56(i5,i6)%c(2,1)*
     & rh2_156%a(1,2)+lg1_56(i5,i6)%a(2,2)*rh2_156%b(2,2))
      clineth_4f(i5,i6)%b(2,2)=lg1_56(i5,i6)%b(2,1)*rh2_156%a(1,
     & 2)+lg1_56(i5,i6)%d(2,2)*p156q*rh2_156%b(2,2)
      clineth_4f(i5,i6)%c(2,2)=lg1_56(i5,i6)%a(2,2)*rh2_156%c(2,
     & 2)
      clineth_4f(i5,i6)%d(2,2)=rmass(id1)*lg1_56(i5,i6)%d(2,2)*r
     & h2_156%c(2,2)
      clineth_4f(i5,i6)%a(2,1)=lg1_56(i5,i6)%c(2,1)*p156q*rh2_15
     & 6%b(1,1)+lg1_56(i5,i6)%a(2,2)*rh2_156%a(2,1)
      clineth_4f(i5,i6)%b(2,1)=rmass(id1)*(lg1_56(i5,i6)%b(2,1)*
     & rh2_156%b(1,1)+lg1_56(i5,i6)%d(2,2)*rh2_156%a(2,1))
      clineth_4f(i5,i6)%c(2,1)=rmass(id1)*lg1_56(i5,i6)%c(2,1)*r
     & h2_156%c(1,1)
      clineth_4f(i5,i6)%d(2,1)=lg1_56(i5,i6)%b(2,1)*rh2_156%c(1,
     & 1)
      end do
      end do
  
      do i5=1,2
      do i6=1,2
* TSCT -- aa=clineth_4f(i5,i6)%a,bb=clineth_4f(i5,i6)%b,cc=clineth_4f(i5
* ,i6)%c,dd=clineth_4f(i5,i6)%d,a1=lh1_256%a,b1=lh1_256%b,c1=lh1_256%c,a
* 2=rg2_56(i5,i6)%a,b2=rg2_56(i5,i6)%b,c2=rg2_56(i5,i6)%c,d2=rg2_56(i5,i
* 6)%d,prq=p256q,m=rmass(id1),nsum=1
      clineth_4f(i5,i6)%a(2,1)=clineth_4f(i5,i6)%a(2,1)+lh1_256%
     & a(2,1)*rg2_56(i5,i6)%a(1,1)+lh1_256%c(2,2)*p256q*rg2_56(i
     & 5,i6)%b(2,1)
      clineth_4f(i5,i6)%b(2,1)=clineth_4f(i5,i6)%b(2,1)+rmass(id
     & 1)*lh1_256%b(2,2)*rg2_56(i5,i6)%b(2,1)
      clineth_4f(i5,i6)%c(2,1)=clineth_4f(i5,i6)%c(2,1)+rmass(id
     & 1)*(lh1_256%a(2,1)*rg2_56(i5,i6)%d(1,1)+lh1_256%c(2,2)*rg
     & 2_56(i5,i6)%c(2,1))
      clineth_4f(i5,i6)%d(2,1)=clineth_4f(i5,i6)%d(2,1)+lh1_256%
     & b(2,2)*rg2_56(i5,i6)%c(2,1)
      clineth_4f(i5,i6)%a(2,2)=clineth_4f(i5,i6)%a(2,2)+rmass(id
     & 1)*(lh1_256%a(2,1)*rg2_56(i5,i6)%b(1,2)+lh1_256%c(2,2)*rg
     & 2_56(i5,i6)%a(2,2))
      clineth_4f(i5,i6)%b(2,2)=clineth_4f(i5,i6)%b(2,2)+lh1_256%
     & b(2,2)*rg2_56(i5,i6)%a(2,2)
      clineth_4f(i5,i6)%c(2,2)=clineth_4f(i5,i6)%c(2,2)+lh1_256%
     & a(2,1)*rg2_56(i5,i6)%c(1,2)+lh1_256%c(2,2)*p256q*rg2_56(i
     & 5,i6)%d(2,2)
      clineth_4f(i5,i6)%d(2,2)=clineth_4f(i5,i6)%d(2,2)+rmass(id
     & 1)*lh1_256%b(2,2)*rg2_56(i5,i6)%d(2,2)
      clineth_4f(i5,i6)%a(1,1)=clineth_4f(i5,i6)%a(1,1)+rmass(id
     & 1)*(lh1_256%c(1,1)*rg2_56(i5,i6)%a(1,1)+lh1_256%a(1,2)*rg
     & 2_56(i5,i6)%b(2,1))
      clineth_4f(i5,i6)%b(1,1)=clineth_4f(i5,i6)%b(1,1)+lh1_256%
     & b(1,1)*rg2_56(i5,i6)%a(1,1)
      clineth_4f(i5,i6)%c(1,1)=clineth_4f(i5,i6)%c(1,1)+lh1_256%
     & c(1,1)*p256q*rg2_56(i5,i6)%d(1,1)+lh1_256%a(1,2)*rg2_56(i
     & 5,i6)%c(2,1)
      clineth_4f(i5,i6)%d(1,1)=clineth_4f(i5,i6)%d(1,1)+rmass(id
     & 1)*lh1_256%b(1,1)*rg2_56(i5,i6)%d(1,1)
      clineth_4f(i5,i6)%a(1,2)=clineth_4f(i5,i6)%a(1,2)+lh1_256%
     & c(1,1)*p256q*rg2_56(i5,i6)%b(1,2)+lh1_256%a(1,2)*rg2_56(i
     & 5,i6)%a(2,2)
      clineth_4f(i5,i6)%b(1,2)=clineth_4f(i5,i6)%b(1,2)+rmass(id
     & 1)*lh1_256%b(1,1)*rg2_56(i5,i6)%b(1,2)
      clineth_4f(i5,i6)%c(1,2)=clineth_4f(i5,i6)%c(1,2)+rmass(id
     & 1)*(lh1_256%c(1,1)*rg2_56(i5,i6)%c(1,2)+lh1_256%a(1,2)*rg
     & 2_56(i5,i6)%d(2,2))
      clineth_4f(i5,i6)%d(1,2)=clineth_4f(i5,i6)%d(1,2)+lh1_256%
     & b(1,1)*rg2_56(i5,i6)%c(1,2)
      end do
      end do
  
      rmassl=rmass(id1)
      rmassr=-rmass(id1)
  
      do i5=1,2
      do i6=1,2
* mline -- res=chqcd1256(&1,&2,i5,i6),abcd=clineth_4f(i5,i6)%,m1=rmassl,
* m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      chqcd1256(iut,jut,i5,i6)=clineth_4f(i5,i6)%a(iut,jut)+rmas
     & sl*clineth_4f(i5,i6)%b(iut,jut)+rmassr*clineth_4f(i5,i6)%
     & c(iut,jut)+rmassl*rmassr*clineth_4f(i5,i6)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
      endif
  
      if (id5.eq.5.and.rmh.ge.0.d0) then
  
      do i1=1,2
      do i2=1,2
* TTSC -- aa=clineth_4f(i1,i2)%a,bb=clineth_4f(i1,i2)%b,cc=clineth_4f(i1
* ,i2)%c,dd=clineth_4f(i1,i2)%d,a1=lg5_12(i1,i2)%a,b1=lg5_12(i1,i2)%b,c1
* =lg5_12(i1,i2)%c,d1=lg5_12(i1,i2)%d,a2=rh6_512%a,b2=rh6_512%b,c2=rh6_5
* 12%c,prq=p512q,m=rmass(id5),nsum=0
      clineth_4f(i1,i2)%a(1,2)=lg5_12(i1,i2)%a(1,1)*rh6_512%a(1,
     & 2)+lg5_12(i1,i2)%c(1,2)*p512q*rh6_512%b(2,2)
      clineth_4f(i1,i2)%b(1,2)=rmass(id5)*(lg5_12(i1,i2)%d(1,1)*
     & rh6_512%a(1,2)+lg5_12(i1,i2)%b(1,2)*rh6_512%b(2,2))
      clineth_4f(i1,i2)%c(1,2)=rmass(id5)*lg5_12(i1,i2)%c(1,2)*r
     & h6_512%c(2,2)
      clineth_4f(i1,i2)%d(1,2)=lg5_12(i1,i2)%b(1,2)*rh6_512%c(2,
     & 2)
      clineth_4f(i1,i2)%a(1,1)=rmass(id5)*(lg5_12(i1,i2)%a(1,1)*
     & rh6_512%b(1,1)+lg5_12(i1,i2)%c(1,2)*rh6_512%a(2,1))
      clineth_4f(i1,i2)%b(1,1)=lg5_12(i1,i2)%d(1,1)*p512q*rh6_51
     & 2%b(1,1)+lg5_12(i1,i2)%b(1,2)*rh6_512%a(2,1)
      clineth_4f(i1,i2)%c(1,1)=lg5_12(i1,i2)%a(1,1)*rh6_512%c(1,
     & 1)
      clineth_4f(i1,i2)%d(1,1)=rmass(id5)*lg5_12(i1,i2)%d(1,1)*r
     & h6_512%c(1,1)
      clineth_4f(i1,i2)%a(2,2)=rmass(id5)*(lg5_12(i1,i2)%c(2,1)*
     & rh6_512%a(1,2)+lg5_12(i1,i2)%a(2,2)*rh6_512%b(2,2))
      clineth_4f(i1,i2)%b(2,2)=lg5_12(i1,i2)%b(2,1)*rh6_512%a(1,
     & 2)+lg5_12(i1,i2)%d(2,2)*p512q*rh6_512%b(2,2)
      clineth_4f(i1,i2)%c(2,2)=lg5_12(i1,i2)%a(2,2)*rh6_512%c(2,
     & 2)
      clineth_4f(i1,i2)%d(2,2)=rmass(id5)*lg5_12(i1,i2)%d(2,2)*r
     & h6_512%c(2,2)
      clineth_4f(i1,i2)%a(2,1)=lg5_12(i1,i2)%c(2,1)*p512q*rh6_51
     & 2%b(1,1)+lg5_12(i1,i2)%a(2,2)*rh6_512%a(2,1)
      clineth_4f(i1,i2)%b(2,1)=rmass(id5)*(lg5_12(i1,i2)%b(2,1)*
     & rh6_512%b(1,1)+lg5_12(i1,i2)%d(2,2)*rh6_512%a(2,1))
      clineth_4f(i1,i2)%c(2,1)=rmass(id5)*lg5_12(i1,i2)%c(2,1)*r
     & h6_512%c(1,1)
      clineth_4f(i1,i2)%d(2,1)=lg5_12(i1,i2)%b(2,1)*rh6_512%c(1,
     & 1)
      end do
      end do
  
      do i1=1,2
      do i2=1,2
* TSCT -- aa=clineth_4f(i1,i2)%a,bb=clineth_4f(i1,i2)%b,cc=clineth_4f(i1
* ,i2)%c,dd=clineth_4f(i1,i2)%d,a1=lh5_612%a,b1=lh5_612%b,c1=lh5_612%c,a
* 2=rg6_12(i1,i2)%a,b2=rg6_12(i1,i2)%b,c2=rg6_12(i1,i2)%c,d2=rg6_12(i1,i
* 2)%d,prq=p612q,m=rmass(id5),nsum=1
      clineth_4f(i1,i2)%a(2,1)=clineth_4f(i1,i2)%a(2,1)+lh5_612%
     & a(2,1)*rg6_12(i1,i2)%a(1,1)+lh5_612%c(2,2)*p612q*rg6_12(i
     & 1,i2)%b(2,1)
      clineth_4f(i1,i2)%b(2,1)=clineth_4f(i1,i2)%b(2,1)+rmass(id
     & 5)*lh5_612%b(2,2)*rg6_12(i1,i2)%b(2,1)
      clineth_4f(i1,i2)%c(2,1)=clineth_4f(i1,i2)%c(2,1)+rmass(id
     & 5)*(lh5_612%a(2,1)*rg6_12(i1,i2)%d(1,1)+lh5_612%c(2,2)*rg
     & 6_12(i1,i2)%c(2,1))
      clineth_4f(i1,i2)%d(2,1)=clineth_4f(i1,i2)%d(2,1)+lh5_612%
     & b(2,2)*rg6_12(i1,i2)%c(2,1)
      clineth_4f(i1,i2)%a(2,2)=clineth_4f(i1,i2)%a(2,2)+rmass(id
     & 5)*(lh5_612%a(2,1)*rg6_12(i1,i2)%b(1,2)+lh5_612%c(2,2)*rg
     & 6_12(i1,i2)%a(2,2))
      clineth_4f(i1,i2)%b(2,2)=clineth_4f(i1,i2)%b(2,2)+lh5_612%
     & b(2,2)*rg6_12(i1,i2)%a(2,2)
      clineth_4f(i1,i2)%c(2,2)=clineth_4f(i1,i2)%c(2,2)+lh5_612%
     & a(2,1)*rg6_12(i1,i2)%c(1,2)+lh5_612%c(2,2)*p612q*rg6_12(i
     & 1,i2)%d(2,2)
      clineth_4f(i1,i2)%d(2,2)=clineth_4f(i1,i2)%d(2,2)+rmass(id
     & 5)*lh5_612%b(2,2)*rg6_12(i1,i2)%d(2,2)
      clineth_4f(i1,i2)%a(1,1)=clineth_4f(i1,i2)%a(1,1)+rmass(id
     & 5)*(lh5_612%c(1,1)*rg6_12(i1,i2)%a(1,1)+lh5_612%a(1,2)*rg
     & 6_12(i1,i2)%b(2,1))
      clineth_4f(i1,i2)%b(1,1)=clineth_4f(i1,i2)%b(1,1)+lh5_612%
     & b(1,1)*rg6_12(i1,i2)%a(1,1)
      clineth_4f(i1,i2)%c(1,1)=clineth_4f(i1,i2)%c(1,1)+lh5_612%
     & c(1,1)*p612q*rg6_12(i1,i2)%d(1,1)+lh5_612%a(1,2)*rg6_12(i
     & 1,i2)%c(2,1)
      clineth_4f(i1,i2)%d(1,1)=clineth_4f(i1,i2)%d(1,1)+rmass(id
     & 5)*lh5_612%b(1,1)*rg6_12(i1,i2)%d(1,1)
      clineth_4f(i1,i2)%a(1,2)=clineth_4f(i1,i2)%a(1,2)+lh5_612%
     & c(1,1)*p612q*rg6_12(i1,i2)%b(1,2)+lh5_612%a(1,2)*rg6_12(i
     & 1,i2)%a(2,2)
      clineth_4f(i1,i2)%b(1,2)=clineth_4f(i1,i2)%b(1,2)+rmass(id
     & 5)*lh5_612%b(1,1)*rg6_12(i1,i2)%b(1,2)
      clineth_4f(i1,i2)%c(1,2)=clineth_4f(i1,i2)%c(1,2)+rmass(id
     & 5)*(lh5_612%c(1,1)*rg6_12(i1,i2)%c(1,2)+lh5_612%a(1,2)*rg
     & 6_12(i1,i2)%d(2,2))
      clineth_4f(i1,i2)%d(1,2)=clineth_4f(i1,i2)%d(1,2)+lh5_612%
     & b(1,1)*rg6_12(i1,i2)%c(1,2)
      end do
      end do
  
      rmassl=rmass(id5)
      rmassr=-rmass(id5)
  
      do i1=1,2
      do i2=1,2
* mline -- res=chqcd1256(i1,i2,&1,&2),abcd=clineth_4f(i1,i2)%,m1=rmassl,
* m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      chqcd1256(i1,i2,iut,jut)=chqcd1256(i1,i2,iut,jut)+clineth_
     & 4f(i1,i2)%a(iut,jut)+rmassl*clineth_4f(i1,i2)%b(iut,jut)+
     & rmassr*clineth_4f(i1,i2)%c(iut,jut)+rmassl*rmassr*clineth
     & _4f(i1,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
      endif
  
*                                                                       
* Then link the computed subdiagrams with the "higgs" insertion         
* [ch3478(2,2,2,2)]                                                     
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3)   
*                                                                       
  
      if(rmh.ge.0.d0 .and. (id1.eq.5 .or. id5.eq.5))then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) =
     &                       cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) +
     &                       (chqcd1256(i1,i2,i5,i6)*
     &                       ch3478(i3,i4,i7,i8))/
     &                       (p1256q-cmh2)
                      enddo
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
  
**************Compute diagrams of class 2.d) (three-forks)**************
*                                                                       
* Diagrams are built-up by linking the following structures:            
*                                                                       
* u1|_3478     % rg2|_5|6|       [Z/f/h Z/f/h g]                        
* ug1|_5|6|34  % r2|_78          [g Z/f/h Z/f/h + Z/f/h g Z/f/h]        
* ug1|_5|6|78  % r2|_34          [g Z/f/h Z/f/h + Z/f/h g Z/f/h]        
*                                                                       
* where 1|={1,5}, 2|={2,6}, 5|6|={56,12}.                               
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3)   
*                                                                       
  
      rmassl=rmass(id1)
      rmassr=-rmass(id1)
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=cline_3forks_12(i3,i4,i7,i8,i5,i6)%a,bb=cline_3forks_12(i3,i
* 4,i7,i8,i5,i6)%b,cc=cline_3forks_12(i3,i4,i7,i8,i5,i6)%c,dd=cline_3for
* ks_12(i3,i4,i7,i8,i5,i6)%d,a1=u1_3478(i3,i4,i7,i8)%a,b1=u1_3478(i3,i4,
* i7,i8)%b,c1=u1_3478(i3,i4,i7,i8)%c,d1=u1_3478(i3,i4,i7,i8)%d,a2=rg2_56
* (i5,i6)%a,b2=rg2_56(i5,i6)%b,c2=rg2_56(i5,i6)%c,d2=rg2_56(i5,i6)%d,prq
* =p256q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=u1_3478(i3,i4,i7,i8)%a(iut,1)+u1_3478(i3,i4,i7,i8)%c(i
     & ut,1)*rmass(id1)
      cx2=u1_3478(i3,i4,i7,i8)%c(iut,2)*p256q+u1_3478(i3,i4,i7,i
     & 8)%a(iut,2)*rmass(id1)
      cy1=u1_3478(i3,i4,i7,i8)%b(iut,1)+u1_3478(i3,i4,i7,i8)%d(i
     & ut,1)*rmass(id1)
      cy2=u1_3478(i3,i4,i7,i8)%d(iut,2)*p256q+u1_3478(i3,i4,i7,i
     & 8)%b(iut,2)*rmass(id1)
      cw1=u1_3478(i3,i4,i7,i8)%c(iut,1)*p256q+u1_3478(i3,i4,i7,i
     & 8)%a(iut,1)*rmass(id1)
      cw2=u1_3478(i3,i4,i7,i8)%a(iut,2)+u1_3478(i3,i4,i7,i8)%c(i
     & ut,2)*rmass(id1)
      cz1=u1_3478(i3,i4,i7,i8)%d(iut,1)*p256q+u1_3478(i3,i4,i7,i
     & 8)%b(iut,1)*rmass(id1)
      cz2=u1_3478(i3,i4,i7,i8)%b(iut,2)+u1_3478(i3,i4,i7,i8)%d(i
     & ut,2)*rmass(id1)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%a(iut,1)=cx1*rg2_56(i5,
     & i6)%a(1,1)+cx2*rg2_56(i5,i6)%b(2,1)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%b(iut,1)=cy1*rg2_56(i5,
     & i6)%a(1,1)+cy2*rg2_56(i5,i6)%b(2,1)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%c(iut,1)=cw1*rg2_56(i5,
     & i6)%d(1,1)+cw2*rg2_56(i5,i6)%c(2,1)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%d(iut,1)=cz1*rg2_56(i5,
     & i6)%d(1,1)+cz2*rg2_56(i5,i6)%c(2,1)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%a(iut,2)=cw1*rg2_56(i5,
     & i6)%b(1,2)+cw2*rg2_56(i5,i6)%a(2,2)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%b(iut,2)=cz1*rg2_56(i5,
     & i6)%b(1,2)+cz2*rg2_56(i5,i6)%a(2,2)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%c(iut,2)=cx1*rg2_56(i5,
     & i6)%c(1,2)+cx2*rg2_56(i5,i6)%d(2,2)
      cline_3forks_12(i3,i4,i7,i8,i5,i6)%d(iut,2)=cy1*rg2_56(i5,
     & i6)%c(1,2)+cy2*rg2_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* mline -- res=cres_3forks_12(i3,i4,i7,i8,i5,i6)%pol(&1,&2),abcd=cline_3
* forks_12(i3,i4,i7,i8,i5,i6)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_12(i3,i4,i7,i8,i5,i6)%pol(iut,jut)=cline_3fork
     & s_12(i3,i4,i7,i8,i5,i6)%a(iut,jut)+rmassl*cline_3forks_12
     & (i3,i4,i7,i8,i5,i6)%b(iut,jut)+rmassr*cline_3forks_12(i3,
     & i4,i7,i8,i5,i6)%c(iut,jut)+rmassl*rmassr*cline_3forks_12(
     & i3,i4,i7,i8,i5,i6)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) +
     &                     cres_3forks_12(i3,i4,i7,i8,i5,i6)
     &                     %pol(i1,i2)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id7.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=cline_3forks_12(i5,i6,i3,i4,i7,i8)%a,bb=cline_3forks_12(i5,
* i6,i3,i4,i7,i8)%b,cc=cline_3forks_12(i5,i6,i3,i4,i7,i8)%c,dd=cline_3fo
* rks_12(i5,i6,i3,i4,i7,i8)%d,a1=ug1_5634(i5,i6,i3,i4)%a,b1=ug1_5634(i5,
* i6,i3,i4)%b,c1=ug1_5634(i5,i6,i3,i4)%c,d1=ug1_5634(i5,i6,i3,i4)%d,a2=r
* 2_78(i7,i8)%a,b2=r2_78(i7,i8)%b,c2=r2_78(i7,i8)%c,d2=r2_78(i7,i8)%d,pr
* q=p278q,m=rmass(id1),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r2_78(i7,i8)%a(1,jut)+rmass(id1)*r2_78(i7,i8)%b(1,jut)
      cx2=r2_78(i7,i8)%a(2,jut)+rmass(id1)*r2_78(i7,i8)%b(2,jut)
      cy1=p278q*r2_78(i7,i8)%b(1,jut)+rmass(id1)*r2_78(i7,i8)%a(
     & 1,jut)
      cy2=p278q*r2_78(i7,i8)%b(2,jut)+rmass(id1)*r2_78(i7,i8)%a(
     & 2,jut)
      cline_3forks_12(i5,i6,i3,i4,i7,i8)%a(iut,jut)=ug1_5634(i5,
     & i6,i3,i4)%a(iut,1)*cx1+ug1_5634(i5,i6,i3,i4)%c(iut,1)*cy1
     & +ug1_5634(i5,i6,i3,i4)%a(iut,2)*cx2+ug1_5634(i5,i6,i3,i4)
     & %c(iut,2)*cy2
      cline_3forks_12(i5,i6,i3,i4,i7,i8)%b(iut,jut)=ug1_5634(i5,
     & i6,i3,i4)%b(iut,1)*cx1+ug1_5634(i5,i6,i3,i4)%d(iut,1)*cy1
     & +ug1_5634(i5,i6,i3,i4)%b(iut,2)*cx2+ug1_5634(i5,i6,i3,i4)
     & %d(iut,2)*cy2
      cw1=r2_78(i7,i8)%c(1,jut)+rmass(id1)*r2_78(i7,i8)%d(1,jut)
      cw2=r2_78(i7,i8)%c(2,jut)+rmass(id1)*r2_78(i7,i8)%d(2,jut)
      cz1=p278q*r2_78(i7,i8)%d(1,jut)+rmass(id1)*r2_78(i7,i8)%c(
     & 1,jut)
      cz2=p278q*r2_78(i7,i8)%d(2,jut)+rmass(id1)*r2_78(i7,i8)%c(
     & 2,jut)
      cline_3forks_12(i5,i6,i3,i4,i7,i8)%c(iut,jut)=ug1_5634(i5,
     & i6,i3,i4)%a(iut,1)*cw1+ug1_5634(i5,i6,i3,i4)%c(iut,1)*cz1
     & +ug1_5634(i5,i6,i3,i4)%a(iut,2)*cw2+ug1_5634(i5,i6,i3,i4)
     & %c(iut,2)*cz2
      cline_3forks_12(i5,i6,i3,i4,i7,i8)%d(iut,jut)=ug1_5634(i5,
     & i6,i3,i4)%b(iut,1)*cw1+ug1_5634(i5,i6,i3,i4)%d(iut,1)*cz1
     & +ug1_5634(i5,i6,i3,i4)%b(iut,2)*cw2+ug1_5634(i5,i6,i3,i4)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=cline_3forks_12(i5,i6,i3,i4,i7,i8)%a,bb=cline_3forks_12(i5,i
* 6,i3,i4,i7,i8)%b,cc=cline_3forks_12(i5,i6,i3,i4,i7,i8)%c,dd=cline_3for
* ks_12(i5,i6,i3,i4,i7,i8)%d,a1=ug1_5634(i5,i6,i3,i4)%a,b1=ug1_5634(i5,i
* 6,i3,i4)%b,c1=ug1_5634(i5,i6,i3,i4)%c,d1=ug1_5634(i5,i6,i3,i4)%d,a2=r2
* _78(i7,i8)%a,b2=r2_78(i7,i8)%b,c2=r2_78(i7,i8)%c,d2=r2_78(i7,i8)%d,prq
* =p278q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=ug1_5634(i5,i6,i3,i4)%a(iut,1)+ug1_5634(i5,i6,i3,i4)%c
     & (iut,1)*rmass(id1)
      cx2=ug1_5634(i5,i6,i3,i4)%c(iut,2)*p278q+ug1_5634(i5,i6,i3
     & ,i4)%a(iut,2)*rmass(id1)
      cy1=ug1_5634(i5,i6,i3,i4)%b(iut,1)+ug1_5634(i5,i6,i3,i4)%d
     & (iut,1)*rmass(id1)
      cy2=ug1_5634(i5,i6,i3,i4)%d(iut,2)*p278q+ug1_5634(i5,i6,i3
     & ,i4)%b(iut,2)*rmass(id1)
      cw1=ug1_5634(i5,i6,i3,i4)%c(iut,1)*p278q+ug1_5634(i5,i6,i3
     & ,i4)%a(iut,1)*rmass(id1)
      cw2=ug1_5634(i5,i6,i3,i4)%a(iut,2)+ug1_5634(i5,i6,i3,i4)%c
     & (iut,2)*rmass(id1)
      cz1=ug1_5634(i5,i6,i3,i4)%d(iut,1)*p278q+ug1_5634(i5,i6,i3
     & ,i4)%b(iut,1)*rmass(id1)
      cz2=ug1_5634(i5,i6,i3,i4)%b(iut,2)+ug1_5634(i5,i6,i3,i4)%d
     & (iut,2)*rmass(id1)
      cline_3forks_12(i5,i6,i3,i4,i7,i8)%a(iut,1)=cx1*r2_78(i7,i
     & 8)%a(1,1)+cx2*r2_78(i7,i8)%b(2,1)
      cline_3forks_12(i5,i6,i3,i4,i7,i8)%b(iut,1)=cy1*r2_78(i7,i
     & 8)%a(1,1)+cy2*r2_78(i7,i8)%b(2,1)
      cline_3forks_12(i5,i6,i3,i4,i7,i8)%c(iut,1)=cw1*r2_78(i7,i
     & 8)%d(1,1)+cw2*r2_78(i7,i8)%c(2,1)
      cline_3forks_12(i5,i6,i3,i4,i7,i8)%d(iut,1)=cz1*r2_78(i7,i
     & 8)%d(1,1)+cz2*r2_78(i7,i8)%c(2,1)
      cline_3forks_12(i5,i6,i3,i4,i7,i8)%a(iut,2)=cw1*r2_78(i7,i
     & 8)%b(1,2)+cw2*r2_78(i7,i8)%a(2,2)
      cline_3forks_12(i5,i6,i3,i4,i7,i8)%b(iut,2)=cz1*r2_78(i7,i
     & 8)%b(1,2)+cz2*r2_78(i7,i8)%a(2,2)
      cline_3forks_12(i5,i6,i3,i4,i7,i8)%c(iut,2)=cx1*r2_78(i7,i
     & 8)%c(1,2)+cx2*r2_78(i7,i8)%d(2,2)
      cline_3forks_12(i5,i6,i3,i4,i7,i8)%d(iut,2)=cy1*r2_78(i7,i
     & 8)%c(1,2)+cy2*r2_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* mline -- res=cres_3forks_12(i5,i6,i3,i4,i7,i8)%pol(&1,&2),abcd=cline_3
* forks_12(i5,i6,i3,i4,i7,i8)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_12(i5,i6,i3,i4,i7,i8)%pol(iut,jut)=cline_3fork
     & s_12(i5,i6,i3,i4,i7,i8)%a(iut,jut)+rmassl*cline_3forks_12
     & (i5,i6,i3,i4,i7,i8)%b(iut,jut)+rmassr*cline_3forks_12(i5,
     & i6,i3,i4,i7,i8)%c(iut,jut)+rmassl*rmassr*cline_3forks_12(
     & i5,i6,i3,i4,i7,i8)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) +
     &                     cres_3forks_12(i5,i6,i3,i4,i7,i8)
     &                     %pol(i1,i2)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
      if(id3.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TsTs -- aa=cline_3forks_12(i5,i6,i7,i8,i3,i4)%a,bb=cline_3forks_12(i5,
* i6,i7,i8,i3,i4)%b,cc=cline_3forks_12(i5,i6,i7,i8,i3,i4)%c,dd=cline_3fo
* rks_12(i5,i6,i7,i8,i3,i4)%d,a1=ug1_5678(i5,i6,i7,i8)%a,b1=ug1_5678(i5,
* i6,i7,i8)%b,c1=ug1_5678(i5,i6,i7,i8)%c,d1=ug1_5678(i5,i6,i7,i8)%d,a2=r
* 2_34(i3,i4)%a,b2=r2_34(i3,i4)%b,c2=r2_34(i3,i4)%c,d2=r2_34(i3,i4)%d,pr
* q=p234q,m=rmass(id1),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r2_34(i3,i4)%a(1,jut)+rmass(id1)*r2_34(i3,i4)%b(1,jut)
      cx2=r2_34(i3,i4)%a(2,jut)+rmass(id1)*r2_34(i3,i4)%b(2,jut)
      cy1=p234q*r2_34(i3,i4)%b(1,jut)+rmass(id1)*r2_34(i3,i4)%a(
     & 1,jut)
      cy2=p234q*r2_34(i3,i4)%b(2,jut)+rmass(id1)*r2_34(i3,i4)%a(
     & 2,jut)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%a(iut,jut)=ug1_5678(i5,
     & i6,i7,i8)%a(iut,1)*cx1+ug1_5678(i5,i6,i7,i8)%c(iut,1)*cy1
     & +ug1_5678(i5,i6,i7,i8)%a(iut,2)*cx2+ug1_5678(i5,i6,i7,i8)
     & %c(iut,2)*cy2
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%b(iut,jut)=ug1_5678(i5,
     & i6,i7,i8)%b(iut,1)*cx1+ug1_5678(i5,i6,i7,i8)%d(iut,1)*cy1
     & +ug1_5678(i5,i6,i7,i8)%b(iut,2)*cx2+ug1_5678(i5,i6,i7,i8)
     & %d(iut,2)*cy2
      cw1=r2_34(i3,i4)%c(1,jut)+rmass(id1)*r2_34(i3,i4)%d(1,jut)
      cw2=r2_34(i3,i4)%c(2,jut)+rmass(id1)*r2_34(i3,i4)%d(2,jut)
      cz1=p234q*r2_34(i3,i4)%d(1,jut)+rmass(id1)*r2_34(i3,i4)%c(
     & 1,jut)
      cz2=p234q*r2_34(i3,i4)%d(2,jut)+rmass(id1)*r2_34(i3,i4)%c(
     & 2,jut)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%c(iut,jut)=ug1_5678(i5,
     & i6,i7,i8)%a(iut,1)*cw1+ug1_5678(i5,i6,i7,i8)%c(iut,1)*cz1
     & +ug1_5678(i5,i6,i7,i8)%a(iut,2)*cw2+ug1_5678(i5,i6,i7,i8)
     & %c(iut,2)*cz2
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%d(iut,jut)=ug1_5678(i5,
     & i6,i7,i8)%b(iut,1)*cw1+ug1_5678(i5,i6,i7,i8)%d(iut,1)*cz1
     & +ug1_5678(i5,i6,i7,i8)%b(iut,2)*cw2+ug1_5678(i5,i6,i7,i8)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=cline_3forks_12(i5,i6,i7,i8,i3,i4)%a,bb=cline_3forks_12(i5,i
* 6,i7,i8,i3,i4)%b,cc=cline_3forks_12(i5,i6,i7,i8,i3,i4)%c,dd=cline_3for
* ks_12(i5,i6,i7,i8,i3,i4)%d,a1=ug1_5678(i5,i6,i7,i8)%a,b1=ug1_5678(i5,i
* 6,i7,i8)%b,c1=ug1_5678(i5,i6,i7,i8)%c,d1=ug1_5678(i5,i6,i7,i8)%d,a2=r2
* _34(i3,i4)%a,b2=r2_34(i3,i4)%b,c2=r2_34(i3,i4)%c,d2=r2_34(i3,i4)%d,prq
* =p234q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=ug1_5678(i5,i6,i7,i8)%a(iut,1)+ug1_5678(i5,i6,i7,i8)%c
     & (iut,1)*rmass(id1)
      cx2=ug1_5678(i5,i6,i7,i8)%c(iut,2)*p234q+ug1_5678(i5,i6,i7
     & ,i8)%a(iut,2)*rmass(id1)
      cy1=ug1_5678(i5,i6,i7,i8)%b(iut,1)+ug1_5678(i5,i6,i7,i8)%d
     & (iut,1)*rmass(id1)
      cy2=ug1_5678(i5,i6,i7,i8)%d(iut,2)*p234q+ug1_5678(i5,i6,i7
     & ,i8)%b(iut,2)*rmass(id1)
      cw1=ug1_5678(i5,i6,i7,i8)%c(iut,1)*p234q+ug1_5678(i5,i6,i7
     & ,i8)%a(iut,1)*rmass(id1)
      cw2=ug1_5678(i5,i6,i7,i8)%a(iut,2)+ug1_5678(i5,i6,i7,i8)%c
     & (iut,2)*rmass(id1)
      cz1=ug1_5678(i5,i6,i7,i8)%d(iut,1)*p234q+ug1_5678(i5,i6,i7
     & ,i8)%b(iut,1)*rmass(id1)
      cz2=ug1_5678(i5,i6,i7,i8)%b(iut,2)+ug1_5678(i5,i6,i7,i8)%d
     & (iut,2)*rmass(id1)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%a(iut,1)=cx1*r2_34(i3,i
     & 4)%a(1,1)+cx2*r2_34(i3,i4)%b(2,1)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%b(iut,1)=cy1*r2_34(i3,i
     & 4)%a(1,1)+cy2*r2_34(i3,i4)%b(2,1)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%c(iut,1)=cw1*r2_34(i3,i
     & 4)%d(1,1)+cw2*r2_34(i3,i4)%c(2,1)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%d(iut,1)=cz1*r2_34(i3,i
     & 4)%d(1,1)+cz2*r2_34(i3,i4)%c(2,1)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%a(iut,2)=cw1*r2_34(i3,i
     & 4)%b(1,2)+cw2*r2_34(i3,i4)%a(2,2)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%b(iut,2)=cz1*r2_34(i3,i
     & 4)%b(1,2)+cz2*r2_34(i3,i4)%a(2,2)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%c(iut,2)=cx1*r2_34(i3,i
     & 4)%c(1,2)+cx2*r2_34(i3,i4)%d(2,2)
      cline_3forks_12(i5,i6,i7,i8,i3,i4)%d(iut,2)=cy1*r2_34(i3,i
     & 4)%c(1,2)+cy2*r2_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* mline -- res=cres_3forks_12(i5,i6,i7,i8,i3,i4)%pol(&1,&2),abcd=cline_3
* forks_12(i5,i6,i7,i8,i3,i4)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_12(i5,i6,i7,i8,i3,i4)%pol(iut,jut)=cline_3fork
     & s_12(i5,i6,i7,i8,i3,i4)%a(iut,jut)+rmassl*cline_3forks_12
     & (i5,i6,i7,i8,i3,i4)%b(iut,jut)+rmassr*cline_3forks_12(i5,
     & i6,i7,i8,i3,i4)%c(iut,jut)+rmassl*rmassr*cline_3forks_12(
     & i5,i6,i7,i8,i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) +
     &                     cres_3forks_12(i5,i6,i7,i8,i3,i4)
     &                     %pol(i1,i2)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
  
      rmassl=rmass(id5)
      rmassr=-rmass(id5)
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=cline_3forks_56(i3,i4,i7,i8,i1,i2)%a,bb=cline_3forks_56(i3,i
* 4,i7,i8,i1,i2)%b,cc=cline_3forks_56(i3,i4,i7,i8,i1,i2)%c,dd=cline_3for
* ks_56(i3,i4,i7,i8,i1,i2)%d,a1=u5_3478(i3,i4,i7,i8)%a,b1=u5_3478(i3,i4,
* i7,i8)%b,c1=u5_3478(i3,i4,i7,i8)%c,d1=u5_3478(i3,i4,i7,i8)%d,a2=rg6_12
* (i1,i2)%a,b2=rg6_12(i1,i2)%b,c2=rg6_12(i1,i2)%c,d2=rg6_12(i1,i2)%d,prq
* =p612q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=u5_3478(i3,i4,i7,i8)%a(iut,1)+u5_3478(i3,i4,i7,i8)%c(i
     & ut,1)*rmass(id5)
      cx2=u5_3478(i3,i4,i7,i8)%c(iut,2)*p612q+u5_3478(i3,i4,i7,i
     & 8)%a(iut,2)*rmass(id5)
      cy1=u5_3478(i3,i4,i7,i8)%b(iut,1)+u5_3478(i3,i4,i7,i8)%d(i
     & ut,1)*rmass(id5)
      cy2=u5_3478(i3,i4,i7,i8)%d(iut,2)*p612q+u5_3478(i3,i4,i7,i
     & 8)%b(iut,2)*rmass(id5)
      cw1=u5_3478(i3,i4,i7,i8)%c(iut,1)*p612q+u5_3478(i3,i4,i7,i
     & 8)%a(iut,1)*rmass(id5)
      cw2=u5_3478(i3,i4,i7,i8)%a(iut,2)+u5_3478(i3,i4,i7,i8)%c(i
     & ut,2)*rmass(id5)
      cz1=u5_3478(i3,i4,i7,i8)%d(iut,1)*p612q+u5_3478(i3,i4,i7,i
     & 8)%b(iut,1)*rmass(id5)
      cz2=u5_3478(i3,i4,i7,i8)%b(iut,2)+u5_3478(i3,i4,i7,i8)%d(i
     & ut,2)*rmass(id5)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%a(iut,1)=cx1*rg6_12(i1,
     & i2)%a(1,1)+cx2*rg6_12(i1,i2)%b(2,1)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%b(iut,1)=cy1*rg6_12(i1,
     & i2)%a(1,1)+cy2*rg6_12(i1,i2)%b(2,1)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%c(iut,1)=cw1*rg6_12(i1,
     & i2)%d(1,1)+cw2*rg6_12(i1,i2)%c(2,1)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%d(iut,1)=cz1*rg6_12(i1,
     & i2)%d(1,1)+cz2*rg6_12(i1,i2)%c(2,1)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%a(iut,2)=cw1*rg6_12(i1,
     & i2)%b(1,2)+cw2*rg6_12(i1,i2)%a(2,2)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%b(iut,2)=cz1*rg6_12(i1,
     & i2)%b(1,2)+cz2*rg6_12(i1,i2)%a(2,2)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%c(iut,2)=cx1*rg6_12(i1,
     & i2)%c(1,2)+cx2*rg6_12(i1,i2)%d(2,2)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%d(iut,2)=cy1*rg6_12(i1,
     & i2)%c(1,2)+cy2*rg6_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* mline -- res=cres_3forks_56(i3,i4,i7,i8,i1,i2)%pol(&1,&2),abcd=cline_3
* forks_56(i3,i4,i7,i8,i1,i2)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_56(i3,i4,i7,i8,i1,i2)%pol(iut,jut)=cline_3fork
     & s_56(i3,i4,i7,i8,i1,i2)%a(iut,jut)+rmassl*cline_3forks_56
     & (i3,i4,i7,i8,i1,i2)%b(iut,jut)+rmassr*cline_3forks_56(i3,
     & i4,i7,i8,i1,i2)%c(iut,jut)+rmassl*rmassr*cline_3forks_56(
     & i3,i4,i7,i8,i1,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) +
     &                     cres_3forks_56(i3,i4,i7,i8,i1,i2)
     &                     %pol(i5,i6)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id7.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=cline_3forks_56(i1,i2,i3,i4,i7,i8)%a,bb=cline_3forks_56(i1,
* i2,i3,i4,i7,i8)%b,cc=cline_3forks_56(i1,i2,i3,i4,i7,i8)%c,dd=cline_3fo
* rks_56(i1,i2,i3,i4,i7,i8)%d,a1=ug5_1234(i1,i2,i3,i4)%a,b1=ug5_1234(i1,
* i2,i3,i4)%b,c1=ug5_1234(i1,i2,i3,i4)%c,d1=ug5_1234(i1,i2,i3,i4)%d,a2=r
* 6_78(i7,i8)%a,b2=r6_78(i7,i8)%b,c2=r6_78(i7,i8)%c,d2=r6_78(i7,i8)%d,pr
* q=p678q,m=rmass(id5),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r6_78(i7,i8)%a(1,jut)+rmass(id5)*r6_78(i7,i8)%b(1,jut)
      cx2=r6_78(i7,i8)%a(2,jut)+rmass(id5)*r6_78(i7,i8)%b(2,jut)
      cy1=p678q*r6_78(i7,i8)%b(1,jut)+rmass(id5)*r6_78(i7,i8)%a(
     & 1,jut)
      cy2=p678q*r6_78(i7,i8)%b(2,jut)+rmass(id5)*r6_78(i7,i8)%a(
     & 2,jut)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%a(iut,jut)=ug5_1234(i1,
     & i2,i3,i4)%a(iut,1)*cx1+ug5_1234(i1,i2,i3,i4)%c(iut,1)*cy1
     & +ug5_1234(i1,i2,i3,i4)%a(iut,2)*cx2+ug5_1234(i1,i2,i3,i4)
     & %c(iut,2)*cy2
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%b(iut,jut)=ug5_1234(i1,
     & i2,i3,i4)%b(iut,1)*cx1+ug5_1234(i1,i2,i3,i4)%d(iut,1)*cy1
     & +ug5_1234(i1,i2,i3,i4)%b(iut,2)*cx2+ug5_1234(i1,i2,i3,i4)
     & %d(iut,2)*cy2
      cw1=r6_78(i7,i8)%c(1,jut)+rmass(id5)*r6_78(i7,i8)%d(1,jut)
      cw2=r6_78(i7,i8)%c(2,jut)+rmass(id5)*r6_78(i7,i8)%d(2,jut)
      cz1=p678q*r6_78(i7,i8)%d(1,jut)+rmass(id5)*r6_78(i7,i8)%c(
     & 1,jut)
      cz2=p678q*r6_78(i7,i8)%d(2,jut)+rmass(id5)*r6_78(i7,i8)%c(
     & 2,jut)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%c(iut,jut)=ug5_1234(i1,
     & i2,i3,i4)%a(iut,1)*cw1+ug5_1234(i1,i2,i3,i4)%c(iut,1)*cz1
     & +ug5_1234(i1,i2,i3,i4)%a(iut,2)*cw2+ug5_1234(i1,i2,i3,i4)
     & %c(iut,2)*cz2
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%d(iut,jut)=ug5_1234(i1,
     & i2,i3,i4)%b(iut,1)*cw1+ug5_1234(i1,i2,i3,i4)%d(iut,1)*cz1
     & +ug5_1234(i1,i2,i3,i4)%b(iut,2)*cw2+ug5_1234(i1,i2,i3,i4)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=cline_3forks_56(i1,i2,i3,i4,i7,i8)%a,bb=cline_3forks_56(i1,i
* 2,i3,i4,i7,i8)%b,cc=cline_3forks_56(i1,i2,i3,i4,i7,i8)%c,dd=cline_3for
* ks_56(i1,i2,i3,i4,i7,i8)%d,a1=ug5_1234(i1,i2,i3,i4)%a,b1=ug5_1234(i1,i
* 2,i3,i4)%b,c1=ug5_1234(i1,i2,i3,i4)%c,d1=ug5_1234(i1,i2,i3,i4)%d,a2=r6
* _78(i7,i8)%a,b2=r6_78(i7,i8)%b,c2=r6_78(i7,i8)%c,d2=r6_78(i7,i8)%d,prq
* =p678q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=ug5_1234(i1,i2,i3,i4)%a(iut,1)+ug5_1234(i1,i2,i3,i4)%c
     & (iut,1)*rmass(id5)
      cx2=ug5_1234(i1,i2,i3,i4)%c(iut,2)*p678q+ug5_1234(i1,i2,i3
     & ,i4)%a(iut,2)*rmass(id5)
      cy1=ug5_1234(i1,i2,i3,i4)%b(iut,1)+ug5_1234(i1,i2,i3,i4)%d
     & (iut,1)*rmass(id5)
      cy2=ug5_1234(i1,i2,i3,i4)%d(iut,2)*p678q+ug5_1234(i1,i2,i3
     & ,i4)%b(iut,2)*rmass(id5)
      cw1=ug5_1234(i1,i2,i3,i4)%c(iut,1)*p678q+ug5_1234(i1,i2,i3
     & ,i4)%a(iut,1)*rmass(id5)
      cw2=ug5_1234(i1,i2,i3,i4)%a(iut,2)+ug5_1234(i1,i2,i3,i4)%c
     & (iut,2)*rmass(id5)
      cz1=ug5_1234(i1,i2,i3,i4)%d(iut,1)*p678q+ug5_1234(i1,i2,i3
     & ,i4)%b(iut,1)*rmass(id5)
      cz2=ug5_1234(i1,i2,i3,i4)%b(iut,2)+ug5_1234(i1,i2,i3,i4)%d
     & (iut,2)*rmass(id5)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%a(iut,1)=cx1*r6_78(i7,i
     & 8)%a(1,1)+cx2*r6_78(i7,i8)%b(2,1)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%b(iut,1)=cy1*r6_78(i7,i
     & 8)%a(1,1)+cy2*r6_78(i7,i8)%b(2,1)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%c(iut,1)=cw1*r6_78(i7,i
     & 8)%d(1,1)+cw2*r6_78(i7,i8)%c(2,1)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%d(iut,1)=cz1*r6_78(i7,i
     & 8)%d(1,1)+cz2*r6_78(i7,i8)%c(2,1)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%a(iut,2)=cw1*r6_78(i7,i
     & 8)%b(1,2)+cw2*r6_78(i7,i8)%a(2,2)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%b(iut,2)=cz1*r6_78(i7,i
     & 8)%b(1,2)+cz2*r6_78(i7,i8)%a(2,2)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%c(iut,2)=cx1*r6_78(i7,i
     & 8)%c(1,2)+cx2*r6_78(i7,i8)%d(2,2)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%d(iut,2)=cy1*r6_78(i7,i
     & 8)%c(1,2)+cy2*r6_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* mline -- res=cres_3forks_56(i1,i2,i3,i4,i7,i8)%pol(&1,&2),abcd=cline_3
* forks_56(i1,i2,i3,i4,i7,i8)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_56(i1,i2,i3,i4,i7,i8)%pol(iut,jut)=cline_3fork
     & s_56(i1,i2,i3,i4,i7,i8)%a(iut,jut)+rmassl*cline_3forks_56
     & (i1,i2,i3,i4,i7,i8)%b(iut,jut)+rmassr*cline_3forks_56(i1,
     & i2,i3,i4,i7,i8)%c(iut,jut)+rmassl*rmassr*cline_3forks_56(
     & i1,i2,i3,i4,i7,i8)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) +
     &                     cres_3forks_56(i1,i2,i3,i4,i7,i8)
     &                     %pol(i5,i6)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id3.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TsTs -- aa=cline_3forks_56(i1,i2,i7,i8,i3,i4)%a,bb=cline_3forks_56(i1,
* i2,i7,i8,i3,i4)%b,cc=cline_3forks_56(i1,i2,i7,i8,i3,i4)%c,dd=cline_3fo
* rks_56(i1,i2,i7,i8,i3,i4)%d,a1=ug5_1278(i1,i2,i7,i8)%a,b1=ug5_1278(i1,
* i2,i7,i8)%b,c1=ug5_1278(i1,i2,i7,i8)%c,d1=ug5_1278(i1,i2,i7,i8)%d,a2=r
* 6_34(i3,i4)%a,b2=r6_34(i3,i4)%b,c2=r6_34(i3,i4)%c,d2=r6_34(i3,i4)%d,pr
* q=p634q,m=rmass(id5),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r6_34(i3,i4)%a(1,jut)+rmass(id5)*r6_34(i3,i4)%b(1,jut)
      cx2=r6_34(i3,i4)%a(2,jut)+rmass(id5)*r6_34(i3,i4)%b(2,jut)
      cy1=p634q*r6_34(i3,i4)%b(1,jut)+rmass(id5)*r6_34(i3,i4)%a(
     & 1,jut)
      cy2=p634q*r6_34(i3,i4)%b(2,jut)+rmass(id5)*r6_34(i3,i4)%a(
     & 2,jut)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%a(iut,jut)=ug5_1278(i1,
     & i2,i7,i8)%a(iut,1)*cx1+ug5_1278(i1,i2,i7,i8)%c(iut,1)*cy1
     & +ug5_1278(i1,i2,i7,i8)%a(iut,2)*cx2+ug5_1278(i1,i2,i7,i8)
     & %c(iut,2)*cy2
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%b(iut,jut)=ug5_1278(i1,
     & i2,i7,i8)%b(iut,1)*cx1+ug5_1278(i1,i2,i7,i8)%d(iut,1)*cy1
     & +ug5_1278(i1,i2,i7,i8)%b(iut,2)*cx2+ug5_1278(i1,i2,i7,i8)
     & %d(iut,2)*cy2
      cw1=r6_34(i3,i4)%c(1,jut)+rmass(id5)*r6_34(i3,i4)%d(1,jut)
      cw2=r6_34(i3,i4)%c(2,jut)+rmass(id5)*r6_34(i3,i4)%d(2,jut)
      cz1=p634q*r6_34(i3,i4)%d(1,jut)+rmass(id5)*r6_34(i3,i4)%c(
     & 1,jut)
      cz2=p634q*r6_34(i3,i4)%d(2,jut)+rmass(id5)*r6_34(i3,i4)%c(
     & 2,jut)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%c(iut,jut)=ug5_1278(i1,
     & i2,i7,i8)%a(iut,1)*cw1+ug5_1278(i1,i2,i7,i8)%c(iut,1)*cz1
     & +ug5_1278(i1,i2,i7,i8)%a(iut,2)*cw2+ug5_1278(i1,i2,i7,i8)
     & %c(iut,2)*cz2
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%d(iut,jut)=ug5_1278(i1,
     & i2,i7,i8)%b(iut,1)*cw1+ug5_1278(i1,i2,i7,i8)%d(iut,1)*cz1
     & +ug5_1278(i1,i2,i7,i8)%b(iut,2)*cw2+ug5_1278(i1,i2,i7,i8)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=cline_3forks_56(i1,i2,i7,i8,i3,i4)%a,bb=cline_3forks_56(i1,i
* 2,i7,i8,i3,i4)%b,cc=cline_3forks_56(i1,i2,i7,i8,i3,i4)%c,dd=cline_3for
* ks_56(i1,i2,i7,i8,i3,i4)%d,a1=ug5_1278(i1,i2,i7,i8)%a,b1=ug5_1278(i1,i
* 2,i7,i8)%b,c1=ug5_1278(i1,i2,i7,i8)%c,d1=ug5_1278(i1,i2,i7,i8)%d,a2=r6
* _34(i3,i4)%a,b2=r6_34(i3,i4)%b,c2=r6_34(i3,i4)%c,d2=r6_34(i3,i4)%d,prq
* =p634q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=ug5_1278(i1,i2,i7,i8)%a(iut,1)+ug5_1278(i1,i2,i7,i8)%c
     & (iut,1)*rmass(id5)
      cx2=ug5_1278(i1,i2,i7,i8)%c(iut,2)*p634q+ug5_1278(i1,i2,i7
     & ,i8)%a(iut,2)*rmass(id5)
      cy1=ug5_1278(i1,i2,i7,i8)%b(iut,1)+ug5_1278(i1,i2,i7,i8)%d
     & (iut,1)*rmass(id5)
      cy2=ug5_1278(i1,i2,i7,i8)%d(iut,2)*p634q+ug5_1278(i1,i2,i7
     & ,i8)%b(iut,2)*rmass(id5)
      cw1=ug5_1278(i1,i2,i7,i8)%c(iut,1)*p634q+ug5_1278(i1,i2,i7
     & ,i8)%a(iut,1)*rmass(id5)
      cw2=ug5_1278(i1,i2,i7,i8)%a(iut,2)+ug5_1278(i1,i2,i7,i8)%c
     & (iut,2)*rmass(id5)
      cz1=ug5_1278(i1,i2,i7,i8)%d(iut,1)*p634q+ug5_1278(i1,i2,i7
     & ,i8)%b(iut,1)*rmass(id5)
      cz2=ug5_1278(i1,i2,i7,i8)%b(iut,2)+ug5_1278(i1,i2,i7,i8)%d
     & (iut,2)*rmass(id5)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%a(iut,1)=cx1*r6_34(i3,i
     & 4)%a(1,1)+cx2*r6_34(i3,i4)%b(2,1)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%b(iut,1)=cy1*r6_34(i3,i
     & 4)%a(1,1)+cy2*r6_34(i3,i4)%b(2,1)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%c(iut,1)=cw1*r6_34(i3,i
     & 4)%d(1,1)+cw2*r6_34(i3,i4)%c(2,1)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%d(iut,1)=cz1*r6_34(i3,i
     & 4)%d(1,1)+cz2*r6_34(i3,i4)%c(2,1)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%a(iut,2)=cw1*r6_34(i3,i
     & 4)%b(1,2)+cw2*r6_34(i3,i4)%a(2,2)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%b(iut,2)=cz1*r6_34(i3,i
     & 4)%b(1,2)+cz2*r6_34(i3,i4)%a(2,2)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%c(iut,2)=cx1*r6_34(i3,i
     & 4)%c(1,2)+cx2*r6_34(i3,i4)%d(2,2)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%d(iut,2)=cy1*r6_34(i3,i
     & 4)%c(1,2)+cy2*r6_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* mline -- res=cres_3forks_56(i1,i2,i7,i8,i3,i4)%pol(&1,&2),abcd=cline_3
* forks_56(i1,i2,i7,i8,i3,i4)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_56(i1,i2,i7,i8,i3,i4)%pol(iut,jut)=cline_3fork
     & s_56(i1,i2,i7,i8,i3,i4)%a(iut,jut)+rmassl*cline_3forks_56
     & (i1,i2,i7,i8,i3,i4)%b(iut,jut)+rmassr*cline_3forks_56(i1,
     & i2,i7,i8,i3,i4)%c(iut,jut)+rmassl*rmassr*cline_3forks_56(
     & i1,i2,i7,i8,i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,3) +
     &                     cres_3forks_56(i1,i2,i7,i8,i3,i4)
     &                     %pol(i5,i6)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
      endif    !if((ilept(id1).ne.1) .and. (ilept(id5).ne.1))
  
  
  
************************************************************************
******Color configuration no. 4 ***** [cres(...).caux(i7,i8,4)]*******  
************************************************************************
*                                                                       
*                           1| 3| 5| 7|                                 
*                            |  |~~|  |                                 
*                           2| 4| 6| 8|                                 
*                                                                       
*                                                                       
*Sum the diagrams belonging to classes 1), 2.a), 2.b), 2.c), 2.d) in    
*which the gluon connects Zlines 34 and 56                              
  
      if((ilept(id3).ne.1) .and. (ilept(id5).ne.1)) then
  
*****************Compute diagrams of class 1)***************************
*Link cg3412(2,2,2,2,0:3) with cg5678(2,2,2,2,0:3)                      
*     cg3478(2,2,2,2,0:3) with cg5612(2,2,2,2,0:3)                      
*The result is directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4)  
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4),p=cg3412(i3,i4,i1,i2,
* #),q=cg5678(i5,i6,i7,i8,#),bef=-,aft=/p1234q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4)=-(cg3412(i3,i4,i1,i2
     & ,0)*cg5678(i5,i6,i7,i8,0)-cg3412(i3,i4,i1,i2,1)*cg5678(i5
     & ,i6,i7,i8,1)-cg3412(i3,i4,i1,i2,2)*cg5678(i5,i6,i7,i8,2)-
     & cg3412(i3,i4,i1,i2,3)*cg5678(i5,i6,i7,i8,3))/p1234q
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4),p=cg3478(i3,i4,i7,i8,
* #),q=cg5612(i5,i6,i1,i2,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4)-,
* aft=/p3478q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,4)-(cg3478(i3,i4,i7,i8,0)*cg5612(i5,i6,i1,
     & i2,0)-cg3478(i3,i4,i7,i8,1)*cg5612(i5,i6,i1,i2,1)-cg3478(
     & i3,i4,i7,i8,2)*cg5612(i5,i6,i1,i2,2)-cg3478(i3,i4,i7,i8,3
     & )*cg5612(i5,i6,i1,i2,3))/p3478q
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
  
*****************Compute diagrams of class 2.a) and 2.b)****************
*                                                                       
* First compute subdiagrams of the type  [czqcd3456(2,2,2,2,0:3)]       
*                                        [cfqcd3456(2,2,2,2,0:3)]       
  
  
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TT -- aa=clinetzz(i3,i4,mu)%a,bb=clinetzz(i3,i4,mu)%b,cc=clinetzz(i3,i
* 4,mu)%c,dd=clinetzz(i3,i4,mu)%d,a1=lg5_34(i3,i4)%a,b1=lg5_34(i3,i4)%b,
* c1=lg5_34(i3,i4)%c,d1=lg5_34(i3,i4)%d,a2=rz6_534(mu)%a,b2=rz6_534(mu)%
* b,c2=rz6_534(mu)%c,d2=rz6_534(mu)%d,prq=p534q,m=rmass(id5),nsum=0
      clinetzz(i3,i4,mu)%a(1,1)=lg5_34(i3,i4)%a(1,1)*rz6_534(mu)
     & %a(1,1)+lg5_34(i3,i4)%c(1,2)*p534q*rz6_534(mu)%b(2,1)
      clinetzz(i3,i4,mu)%b(1,1)=rmass(id5)*(lg5_34(i3,i4)%d(1,1)
     & *rz6_534(mu)%a(1,1)+lg5_34(i3,i4)%b(1,2)*rz6_534(mu)%b(2,
     & 1))
      clinetzz(i3,i4,mu)%c(1,1)=rmass(id5)*(lg5_34(i3,i4)%a(1,1)
     & *rz6_534(mu)%d(1,1)+lg5_34(i3,i4)%c(1,2)*rz6_534(mu)%c(2,
     & 1))
      clinetzz(i3,i4,mu)%d(1,1)=lg5_34(i3,i4)%d(1,1)*p534q*rz6_5
     & 34(mu)%d(1,1)+lg5_34(i3,i4)%b(1,2)*rz6_534(mu)%c(2,1)
      clinetzz(i3,i4,mu)%a(1,2)=rmass(id5)*(lg5_34(i3,i4)%a(1,1)
     & *rz6_534(mu)%b(1,2)+lg5_34(i3,i4)%c(1,2)*rz6_534(mu)%a(2,
     & 2))
      clinetzz(i3,i4,mu)%b(1,2)=lg5_34(i3,i4)%d(1,1)*p534q*rz6_5
     & 34(mu)%b(1,2)+lg5_34(i3,i4)%b(1,2)*rz6_534(mu)%a(2,2)
      clinetzz(i3,i4,mu)%c(1,2)=lg5_34(i3,i4)%a(1,1)*rz6_534(mu)
     & %c(1,2)+lg5_34(i3,i4)%c(1,2)*p534q*rz6_534(mu)%d(2,2)
      clinetzz(i3,i4,mu)%d(1,2)=rmass(id5)*(lg5_34(i3,i4)%d(1,1)
     & *rz6_534(mu)%c(1,2)+lg5_34(i3,i4)%b(1,2)*rz6_534(mu)%d(2,
     & 2))
      clinetzz(i3,i4,mu)%a(2,1)=rmass(id5)*(lg5_34(i3,i4)%c(2,1)
     & *rz6_534(mu)%a(1,1)+lg5_34(i3,i4)%a(2,2)*rz6_534(mu)%b(2,
     & 1))
      clinetzz(i3,i4,mu)%b(2,1)=lg5_34(i3,i4)%b(2,1)*rz6_534(mu)
     & %a(1,1)+lg5_34(i3,i4)%d(2,2)*p534q*rz6_534(mu)%b(2,1)
      clinetzz(i3,i4,mu)%c(2,1)=lg5_34(i3,i4)%c(2,1)*p534q*rz6_5
     & 34(mu)%d(1,1)+lg5_34(i3,i4)%a(2,2)*rz6_534(mu)%c(2,1)
      clinetzz(i3,i4,mu)%d(2,1)=rmass(id5)*(lg5_34(i3,i4)%b(2,1)
     & *rz6_534(mu)%d(1,1)+lg5_34(i3,i4)%d(2,2)*rz6_534(mu)%c(2,
     & 1))
      clinetzz(i3,i4,mu)%a(2,2)=lg5_34(i3,i4)%c(2,1)*p534q*rz6_5
     & 34(mu)%b(1,2)+lg5_34(i3,i4)%a(2,2)*rz6_534(mu)%a(2,2)
      clinetzz(i3,i4,mu)%b(2,2)=rmass(id5)*(lg5_34(i3,i4)%b(2,1)
     & *rz6_534(mu)%b(1,2)+lg5_34(i3,i4)%d(2,2)*rz6_534(mu)%a(2,
     & 2))
      clinetzz(i3,i4,mu)%c(2,2)=rmass(id5)*(lg5_34(i3,i4)%c(2,1)
     & *rz6_534(mu)%c(1,2)+lg5_34(i3,i4)%a(2,2)*rz6_534(mu)%d(2,
     & 2))
      clinetzz(i3,i4,mu)%d(2,2)=lg5_34(i3,i4)%b(2,1)*rz6_534(mu)
     & %c(1,2)+lg5_34(i3,i4)%d(2,2)*p534q*rz6_534(mu)%d(2,2)
      end do
      end do
      end do
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TT -- aa=clinetzz(i3,i4,mu)%a,bb=clinetzz(i3,i4,mu)%b,cc=clinetzz(i3,i
* 4,mu)%c,dd=clinetzz(i3,i4,mu)%d,a1=lz5_634(mu)%a,b1=lz5_634(mu)%b,c1=l
* z5_634(mu)%c,d1=lz5_634(mu)%d,a2=rg6_34(i3,i4)%a,b2=rg6_34(i3,i4)%b,c2
* =rg6_34(i3,i4)%c,d2=rg6_34(i3,i4)%d,prq=p634q,m=rmass(id5),nsum=1
      clinetzz(i3,i4,mu)%a(1,1)=clinetzz(i3,i4,mu)%a(1,1)+lz5_63
     & 4(mu)%a(1,1)*rg6_34(i3,i4)%a(1,1)+lz5_634(mu)%c(1,2)*p634
     & q*rg6_34(i3,i4)%b(2,1)
      clinetzz(i3,i4,mu)%b(1,1)=clinetzz(i3,i4,mu)%b(1,1)+rmass(
     & id5)*(lz5_634(mu)%d(1,1)*rg6_34(i3,i4)%a(1,1)+lz5_634(mu)
     & %b(1,2)*rg6_34(i3,i4)%b(2,1))
      clinetzz(i3,i4,mu)%c(1,1)=clinetzz(i3,i4,mu)%c(1,1)+rmass(
     & id5)*(lz5_634(mu)%a(1,1)*rg6_34(i3,i4)%d(1,1)+lz5_634(mu)
     & %c(1,2)*rg6_34(i3,i4)%c(2,1))
      clinetzz(i3,i4,mu)%d(1,1)=clinetzz(i3,i4,mu)%d(1,1)+lz5_63
     & 4(mu)%d(1,1)*p634q*rg6_34(i3,i4)%d(1,1)+lz5_634(mu)%b(1,2
     & )*rg6_34(i3,i4)%c(2,1)
      clinetzz(i3,i4,mu)%a(1,2)=clinetzz(i3,i4,mu)%a(1,2)+rmass(
     & id5)*(lz5_634(mu)%a(1,1)*rg6_34(i3,i4)%b(1,2)+lz5_634(mu)
     & %c(1,2)*rg6_34(i3,i4)%a(2,2))
      clinetzz(i3,i4,mu)%b(1,2)=clinetzz(i3,i4,mu)%b(1,2)+lz5_63
     & 4(mu)%d(1,1)*p634q*rg6_34(i3,i4)%b(1,2)+lz5_634(mu)%b(1,2
     & )*rg6_34(i3,i4)%a(2,2)
      clinetzz(i3,i4,mu)%c(1,2)=clinetzz(i3,i4,mu)%c(1,2)+lz5_63
     & 4(mu)%a(1,1)*rg6_34(i3,i4)%c(1,2)+lz5_634(mu)%c(1,2)*p634
     & q*rg6_34(i3,i4)%d(2,2)
      clinetzz(i3,i4,mu)%d(1,2)=clinetzz(i3,i4,mu)%d(1,2)+rmass(
     & id5)*(lz5_634(mu)%d(1,1)*rg6_34(i3,i4)%c(1,2)+lz5_634(mu)
     & %b(1,2)*rg6_34(i3,i4)%d(2,2))
      clinetzz(i3,i4,mu)%a(2,1)=clinetzz(i3,i4,mu)%a(2,1)+rmass(
     & id5)*(lz5_634(mu)%c(2,1)*rg6_34(i3,i4)%a(1,1)+lz5_634(mu)
     & %a(2,2)*rg6_34(i3,i4)%b(2,1))
      clinetzz(i3,i4,mu)%b(2,1)=clinetzz(i3,i4,mu)%b(2,1)+lz5_63
     & 4(mu)%b(2,1)*rg6_34(i3,i4)%a(1,1)+lz5_634(mu)%d(2,2)*p634
     & q*rg6_34(i3,i4)%b(2,1)
      clinetzz(i3,i4,mu)%c(2,1)=clinetzz(i3,i4,mu)%c(2,1)+lz5_63
     & 4(mu)%c(2,1)*p634q*rg6_34(i3,i4)%d(1,1)+lz5_634(mu)%a(2,2
     & )*rg6_34(i3,i4)%c(2,1)
      clinetzz(i3,i4,mu)%d(2,1)=clinetzz(i3,i4,mu)%d(2,1)+rmass(
     & id5)*(lz5_634(mu)%b(2,1)*rg6_34(i3,i4)%d(1,1)+lz5_634(mu)
     & %d(2,2)*rg6_34(i3,i4)%c(2,1))
      clinetzz(i3,i4,mu)%a(2,2)=clinetzz(i3,i4,mu)%a(2,2)+lz5_63
     & 4(mu)%c(2,1)*p634q*rg6_34(i3,i4)%b(1,2)+lz5_634(mu)%a(2,2
     & )*rg6_34(i3,i4)%a(2,2)
      clinetzz(i3,i4,mu)%b(2,2)=clinetzz(i3,i4,mu)%b(2,2)+rmass(
     & id5)*(lz5_634(mu)%b(2,1)*rg6_34(i3,i4)%b(1,2)+lz5_634(mu)
     & %d(2,2)*rg6_34(i3,i4)%a(2,2))
      clinetzz(i3,i4,mu)%c(2,2)=clinetzz(i3,i4,mu)%c(2,2)+rmass(
     & id5)*(lz5_634(mu)%c(2,1)*rg6_34(i3,i4)%c(1,2)+lz5_634(mu)
     & %a(2,2)*rg6_34(i3,i4)%d(2,2))
      clinetzz(i3,i4,mu)%d(2,2)=clinetzz(i3,i4,mu)%d(2,2)+lz5_63
     & 4(mu)%b(2,1)*rg6_34(i3,i4)%c(1,2)+lz5_634(mu)%d(2,2)*p634
     & q*rg6_34(i3,i4)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id5)
      rmassr=-rmass(id5)
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=czqcd3456(i3,i4,&1,&2,mu),abcd=clinetzz(i3,i4,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      czqcd3456(i3,i4,iut,jut,mu)=clinetzz(i3,i4,mu)%a(iut,jut)+
     & rmassl*clinetzz(i3,i4,mu)%b(iut,jut)+rmassr*clinetzz(i3,i
     & 4,mu)%c(iut,jut)+rmassl*rmassr*clinetzz(i3,i4,mu)%d(iut,j
     & ut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TT -- aa=clinetzz(i5,i6,mu)%a,bb=clinetzz(i5,i6,mu)%b,cc=clinetzz(i5,i
* 6,mu)%c,dd=clinetzz(i5,i6,mu)%d,a1=lg3_56(i5,i6)%a,b1=lg3_56(i5,i6)%b,
* c1=lg3_56(i5,i6)%c,d1=lg3_56(i5,i6)%d,a2=rz4_356(mu)%a,b2=rz4_356(mu)%
* b,c2=rz4_356(mu)%c,d2=rz4_356(mu)%d,prq=p356q,m=rmass(id3),nsum=0
      clinetzz(i5,i6,mu)%a(1,1)=lg3_56(i5,i6)%a(1,1)*rz4_356(mu)
     & %a(1,1)+lg3_56(i5,i6)%c(1,2)*p356q*rz4_356(mu)%b(2,1)
      clinetzz(i5,i6,mu)%b(1,1)=rmass(id3)*(lg3_56(i5,i6)%d(1,1)
     & *rz4_356(mu)%a(1,1)+lg3_56(i5,i6)%b(1,2)*rz4_356(mu)%b(2,
     & 1))
      clinetzz(i5,i6,mu)%c(1,1)=rmass(id3)*(lg3_56(i5,i6)%a(1,1)
     & *rz4_356(mu)%d(1,1)+lg3_56(i5,i6)%c(1,2)*rz4_356(mu)%c(2,
     & 1))
      clinetzz(i5,i6,mu)%d(1,1)=lg3_56(i5,i6)%d(1,1)*p356q*rz4_3
     & 56(mu)%d(1,1)+lg3_56(i5,i6)%b(1,2)*rz4_356(mu)%c(2,1)
      clinetzz(i5,i6,mu)%a(1,2)=rmass(id3)*(lg3_56(i5,i6)%a(1,1)
     & *rz4_356(mu)%b(1,2)+lg3_56(i5,i6)%c(1,2)*rz4_356(mu)%a(2,
     & 2))
      clinetzz(i5,i6,mu)%b(1,2)=lg3_56(i5,i6)%d(1,1)*p356q*rz4_3
     & 56(mu)%b(1,2)+lg3_56(i5,i6)%b(1,2)*rz4_356(mu)%a(2,2)
      clinetzz(i5,i6,mu)%c(1,2)=lg3_56(i5,i6)%a(1,1)*rz4_356(mu)
     & %c(1,2)+lg3_56(i5,i6)%c(1,2)*p356q*rz4_356(mu)%d(2,2)
      clinetzz(i5,i6,mu)%d(1,2)=rmass(id3)*(lg3_56(i5,i6)%d(1,1)
     & *rz4_356(mu)%c(1,2)+lg3_56(i5,i6)%b(1,2)*rz4_356(mu)%d(2,
     & 2))
      clinetzz(i5,i6,mu)%a(2,1)=rmass(id3)*(lg3_56(i5,i6)%c(2,1)
     & *rz4_356(mu)%a(1,1)+lg3_56(i5,i6)%a(2,2)*rz4_356(mu)%b(2,
     & 1))
      clinetzz(i5,i6,mu)%b(2,1)=lg3_56(i5,i6)%b(2,1)*rz4_356(mu)
     & %a(1,1)+lg3_56(i5,i6)%d(2,2)*p356q*rz4_356(mu)%b(2,1)
      clinetzz(i5,i6,mu)%c(2,1)=lg3_56(i5,i6)%c(2,1)*p356q*rz4_3
     & 56(mu)%d(1,1)+lg3_56(i5,i6)%a(2,2)*rz4_356(mu)%c(2,1)
      clinetzz(i5,i6,mu)%d(2,1)=rmass(id3)*(lg3_56(i5,i6)%b(2,1)
     & *rz4_356(mu)%d(1,1)+lg3_56(i5,i6)%d(2,2)*rz4_356(mu)%c(2,
     & 1))
      clinetzz(i5,i6,mu)%a(2,2)=lg3_56(i5,i6)%c(2,1)*p356q*rz4_3
     & 56(mu)%b(1,2)+lg3_56(i5,i6)%a(2,2)*rz4_356(mu)%a(2,2)
      clinetzz(i5,i6,mu)%b(2,2)=rmass(id3)*(lg3_56(i5,i6)%b(2,1)
     & *rz4_356(mu)%b(1,2)+lg3_56(i5,i6)%d(2,2)*rz4_356(mu)%a(2,
     & 2))
      clinetzz(i5,i6,mu)%c(2,2)=rmass(id3)*(lg3_56(i5,i6)%c(2,1)
     & *rz4_356(mu)%c(1,2)+lg3_56(i5,i6)%a(2,2)*rz4_356(mu)%d(2,
     & 2))
      clinetzz(i5,i6,mu)%d(2,2)=lg3_56(i5,i6)%b(2,1)*rz4_356(mu)
     & %c(1,2)+lg3_56(i5,i6)%d(2,2)*p356q*rz4_356(mu)%d(2,2)
      end do
      end do
      end do
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TT -- aa=clinetzz(i5,i6,mu)%a,bb=clinetzz(i5,i6,mu)%b,cc=clinetzz(i5,i
* 6,mu)%c,dd=clinetzz(i5,i6,mu)%d,a1=lz3_456(mu)%a,b1=lz3_456(mu)%b,c1=l
* z3_456(mu)%c,d1=lz3_456(mu)%d,a2=rg4_56(i5,i6)%a,b2=rg4_56(i5,i6)%b,c2
* =rg4_56(i5,i6)%c,d2=rg4_56(i5,i6)%d,prq=p456q,m=rmass(id3),nsum=1
      clinetzz(i5,i6,mu)%a(1,1)=clinetzz(i5,i6,mu)%a(1,1)+lz3_45
     & 6(mu)%a(1,1)*rg4_56(i5,i6)%a(1,1)+lz3_456(mu)%c(1,2)*p456
     & q*rg4_56(i5,i6)%b(2,1)
      clinetzz(i5,i6,mu)%b(1,1)=clinetzz(i5,i6,mu)%b(1,1)+rmass(
     & id3)*(lz3_456(mu)%d(1,1)*rg4_56(i5,i6)%a(1,1)+lz3_456(mu)
     & %b(1,2)*rg4_56(i5,i6)%b(2,1))
      clinetzz(i5,i6,mu)%c(1,1)=clinetzz(i5,i6,mu)%c(1,1)+rmass(
     & id3)*(lz3_456(mu)%a(1,1)*rg4_56(i5,i6)%d(1,1)+lz3_456(mu)
     & %c(1,2)*rg4_56(i5,i6)%c(2,1))
      clinetzz(i5,i6,mu)%d(1,1)=clinetzz(i5,i6,mu)%d(1,1)+lz3_45
     & 6(mu)%d(1,1)*p456q*rg4_56(i5,i6)%d(1,1)+lz3_456(mu)%b(1,2
     & )*rg4_56(i5,i6)%c(2,1)
      clinetzz(i5,i6,mu)%a(1,2)=clinetzz(i5,i6,mu)%a(1,2)+rmass(
     & id3)*(lz3_456(mu)%a(1,1)*rg4_56(i5,i6)%b(1,2)+lz3_456(mu)
     & %c(1,2)*rg4_56(i5,i6)%a(2,2))
      clinetzz(i5,i6,mu)%b(1,2)=clinetzz(i5,i6,mu)%b(1,2)+lz3_45
     & 6(mu)%d(1,1)*p456q*rg4_56(i5,i6)%b(1,2)+lz3_456(mu)%b(1,2
     & )*rg4_56(i5,i6)%a(2,2)
      clinetzz(i5,i6,mu)%c(1,2)=clinetzz(i5,i6,mu)%c(1,2)+lz3_45
     & 6(mu)%a(1,1)*rg4_56(i5,i6)%c(1,2)+lz3_456(mu)%c(1,2)*p456
     & q*rg4_56(i5,i6)%d(2,2)
      clinetzz(i5,i6,mu)%d(1,2)=clinetzz(i5,i6,mu)%d(1,2)+rmass(
     & id3)*(lz3_456(mu)%d(1,1)*rg4_56(i5,i6)%c(1,2)+lz3_456(mu)
     & %b(1,2)*rg4_56(i5,i6)%d(2,2))
      clinetzz(i5,i6,mu)%a(2,1)=clinetzz(i5,i6,mu)%a(2,1)+rmass(
     & id3)*(lz3_456(mu)%c(2,1)*rg4_56(i5,i6)%a(1,1)+lz3_456(mu)
     & %a(2,2)*rg4_56(i5,i6)%b(2,1))
      clinetzz(i5,i6,mu)%b(2,1)=clinetzz(i5,i6,mu)%b(2,1)+lz3_45
     & 6(mu)%b(2,1)*rg4_56(i5,i6)%a(1,1)+lz3_456(mu)%d(2,2)*p456
     & q*rg4_56(i5,i6)%b(2,1)
      clinetzz(i5,i6,mu)%c(2,1)=clinetzz(i5,i6,mu)%c(2,1)+lz3_45
     & 6(mu)%c(2,1)*p456q*rg4_56(i5,i6)%d(1,1)+lz3_456(mu)%a(2,2
     & )*rg4_56(i5,i6)%c(2,1)
      clinetzz(i5,i6,mu)%d(2,1)=clinetzz(i5,i6,mu)%d(2,1)+rmass(
     & id3)*(lz3_456(mu)%b(2,1)*rg4_56(i5,i6)%d(1,1)+lz3_456(mu)
     & %d(2,2)*rg4_56(i5,i6)%c(2,1))
      clinetzz(i5,i6,mu)%a(2,2)=clinetzz(i5,i6,mu)%a(2,2)+lz3_45
     & 6(mu)%c(2,1)*p456q*rg4_56(i5,i6)%b(1,2)+lz3_456(mu)%a(2,2
     & )*rg4_56(i5,i6)%a(2,2)
      clinetzz(i5,i6,mu)%b(2,2)=clinetzz(i5,i6,mu)%b(2,2)+rmass(
     & id3)*(lz3_456(mu)%b(2,1)*rg4_56(i5,i6)%b(1,2)+lz3_456(mu)
     & %d(2,2)*rg4_56(i5,i6)%a(2,2))
      clinetzz(i5,i6,mu)%c(2,2)=clinetzz(i5,i6,mu)%c(2,2)+rmass(
     & id3)*(lz3_456(mu)%c(2,1)*rg4_56(i5,i6)%c(1,2)+lz3_456(mu)
     & %a(2,2)*rg4_56(i5,i6)%d(2,2))
      clinetzz(i5,i6,mu)%d(2,2)=clinetzz(i5,i6,mu)%d(2,2)+lz3_45
     & 6(mu)%b(2,1)*rg4_56(i5,i6)%c(1,2)+lz3_456(mu)%d(2,2)*p456
     & q*rg4_56(i5,i6)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id3)
      rmassr=-rmass(id3)
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* mline -- res=czqcd3456(&1,&2,i5,i6,mu),abcd=clinetzz(i5,i6,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      czqcd3456(iut,jut,i5,i6,mu)=czqcd3456(iut,jut,i5,i6,mu)+cl
     & inetzz(i5,i6,mu)%a(iut,jut)+rmassl*clinetzz(i5,i6,mu)%b(i
     & ut,jut)+rmassr*clinetzz(i5,i6,mu)%c(iut,jut)+rmassl*rmass
     & r*clinetzz(i5,i6,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TT -- aa=clinetfz(i3,i4,mu)%a,bb=clinetfz(i3,i4,mu)%b,cc=clinetfz(i3,i
* 4,mu)%c,dd=clinetfz(i3,i4,mu)%d,a1=lg5_34(i3,i4)%a,b1=lg5_34(i3,i4)%b,
* c1=lg5_34(i3,i4)%c,d1=lg5_34(i3,i4)%d,a2=rf6_534(mu)%a,b2=rf6_534(mu)%
* b,c2=rf6_534(mu)%c,d2=rf6_534(mu)%d,prq=p534q,m=rmass(id5),nsum=0
      clinetfz(i3,i4,mu)%a(1,1)=lg5_34(i3,i4)%a(1,1)*rf6_534(mu)
     & %a(1,1)+lg5_34(i3,i4)%c(1,2)*p534q*rf6_534(mu)%b(2,1)
      clinetfz(i3,i4,mu)%b(1,1)=rmass(id5)*(lg5_34(i3,i4)%d(1,1)
     & *rf6_534(mu)%a(1,1)+lg5_34(i3,i4)%b(1,2)*rf6_534(mu)%b(2,
     & 1))
      clinetfz(i3,i4,mu)%c(1,1)=rmass(id5)*(lg5_34(i3,i4)%a(1,1)
     & *rf6_534(mu)%d(1,1)+lg5_34(i3,i4)%c(1,2)*rf6_534(mu)%c(2,
     & 1))
      clinetfz(i3,i4,mu)%d(1,1)=lg5_34(i3,i4)%d(1,1)*p534q*rf6_5
     & 34(mu)%d(1,1)+lg5_34(i3,i4)%b(1,2)*rf6_534(mu)%c(2,1)
      clinetfz(i3,i4,mu)%a(1,2)=rmass(id5)*(lg5_34(i3,i4)%a(1,1)
     & *rf6_534(mu)%b(1,2)+lg5_34(i3,i4)%c(1,2)*rf6_534(mu)%a(2,
     & 2))
      clinetfz(i3,i4,mu)%b(1,2)=lg5_34(i3,i4)%d(1,1)*p534q*rf6_5
     & 34(mu)%b(1,2)+lg5_34(i3,i4)%b(1,2)*rf6_534(mu)%a(2,2)
      clinetfz(i3,i4,mu)%c(1,2)=lg5_34(i3,i4)%a(1,1)*rf6_534(mu)
     & %c(1,2)+lg5_34(i3,i4)%c(1,2)*p534q*rf6_534(mu)%d(2,2)
      clinetfz(i3,i4,mu)%d(1,2)=rmass(id5)*(lg5_34(i3,i4)%d(1,1)
     & *rf6_534(mu)%c(1,2)+lg5_34(i3,i4)%b(1,2)*rf6_534(mu)%d(2,
     & 2))
      clinetfz(i3,i4,mu)%a(2,1)=rmass(id5)*(lg5_34(i3,i4)%c(2,1)
     & *rf6_534(mu)%a(1,1)+lg5_34(i3,i4)%a(2,2)*rf6_534(mu)%b(2,
     & 1))
      clinetfz(i3,i4,mu)%b(2,1)=lg5_34(i3,i4)%b(2,1)*rf6_534(mu)
     & %a(1,1)+lg5_34(i3,i4)%d(2,2)*p534q*rf6_534(mu)%b(2,1)
      clinetfz(i3,i4,mu)%c(2,1)=lg5_34(i3,i4)%c(2,1)*p534q*rf6_5
     & 34(mu)%d(1,1)+lg5_34(i3,i4)%a(2,2)*rf6_534(mu)%c(2,1)
      clinetfz(i3,i4,mu)%d(2,1)=rmass(id5)*(lg5_34(i3,i4)%b(2,1)
     & *rf6_534(mu)%d(1,1)+lg5_34(i3,i4)%d(2,2)*rf6_534(mu)%c(2,
     & 1))
      clinetfz(i3,i4,mu)%a(2,2)=lg5_34(i3,i4)%c(2,1)*p534q*rf6_5
     & 34(mu)%b(1,2)+lg5_34(i3,i4)%a(2,2)*rf6_534(mu)%a(2,2)
      clinetfz(i3,i4,mu)%b(2,2)=rmass(id5)*(lg5_34(i3,i4)%b(2,1)
     & *rf6_534(mu)%b(1,2)+lg5_34(i3,i4)%d(2,2)*rf6_534(mu)%a(2,
     & 2))
      clinetfz(i3,i4,mu)%c(2,2)=rmass(id5)*(lg5_34(i3,i4)%c(2,1)
     & *rf6_534(mu)%c(1,2)+lg5_34(i3,i4)%a(2,2)*rf6_534(mu)%d(2,
     & 2))
      clinetfz(i3,i4,mu)%d(2,2)=lg5_34(i3,i4)%b(2,1)*rf6_534(mu)
     & %c(1,2)+lg5_34(i3,i4)%d(2,2)*p534q*rf6_534(mu)%d(2,2)
      end do
      end do
      end do
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TT -- aa=clinetfz(i3,i4,mu)%a,bb=clinetfz(i3,i4,mu)%b,cc=clinetfz(i3,i
* 4,mu)%c,dd=clinetfz(i3,i4,mu)%d,a1=lf5_634(mu)%a,b1=lf5_634(mu)%b,c1=l
* f5_634(mu)%c,d1=lf5_634(mu)%d,a2=rg6_34(i3,i4)%a,b2=rg6_34(i3,i4)%b,c2
* =rg6_34(i3,i4)%c,d2=rg6_34(i3,i4)%d,prq=p634q,m=rmass(id5),nsum=1
      clinetfz(i3,i4,mu)%a(1,1)=clinetfz(i3,i4,mu)%a(1,1)+lf5_63
     & 4(mu)%a(1,1)*rg6_34(i3,i4)%a(1,1)+lf5_634(mu)%c(1,2)*p634
     & q*rg6_34(i3,i4)%b(2,1)
      clinetfz(i3,i4,mu)%b(1,1)=clinetfz(i3,i4,mu)%b(1,1)+rmass(
     & id5)*(lf5_634(mu)%d(1,1)*rg6_34(i3,i4)%a(1,1)+lf5_634(mu)
     & %b(1,2)*rg6_34(i3,i4)%b(2,1))
      clinetfz(i3,i4,mu)%c(1,1)=clinetfz(i3,i4,mu)%c(1,1)+rmass(
     & id5)*(lf5_634(mu)%a(1,1)*rg6_34(i3,i4)%d(1,1)+lf5_634(mu)
     & %c(1,2)*rg6_34(i3,i4)%c(2,1))
      clinetfz(i3,i4,mu)%d(1,1)=clinetfz(i3,i4,mu)%d(1,1)+lf5_63
     & 4(mu)%d(1,1)*p634q*rg6_34(i3,i4)%d(1,1)+lf5_634(mu)%b(1,2
     & )*rg6_34(i3,i4)%c(2,1)
      clinetfz(i3,i4,mu)%a(1,2)=clinetfz(i3,i4,mu)%a(1,2)+rmass(
     & id5)*(lf5_634(mu)%a(1,1)*rg6_34(i3,i4)%b(1,2)+lf5_634(mu)
     & %c(1,2)*rg6_34(i3,i4)%a(2,2))
      clinetfz(i3,i4,mu)%b(1,2)=clinetfz(i3,i4,mu)%b(1,2)+lf5_63
     & 4(mu)%d(1,1)*p634q*rg6_34(i3,i4)%b(1,2)+lf5_634(mu)%b(1,2
     & )*rg6_34(i3,i4)%a(2,2)
      clinetfz(i3,i4,mu)%c(1,2)=clinetfz(i3,i4,mu)%c(1,2)+lf5_63
     & 4(mu)%a(1,1)*rg6_34(i3,i4)%c(1,2)+lf5_634(mu)%c(1,2)*p634
     & q*rg6_34(i3,i4)%d(2,2)
      clinetfz(i3,i4,mu)%d(1,2)=clinetfz(i3,i4,mu)%d(1,2)+rmass(
     & id5)*(lf5_634(mu)%d(1,1)*rg6_34(i3,i4)%c(1,2)+lf5_634(mu)
     & %b(1,2)*rg6_34(i3,i4)%d(2,2))
      clinetfz(i3,i4,mu)%a(2,1)=clinetfz(i3,i4,mu)%a(2,1)+rmass(
     & id5)*(lf5_634(mu)%c(2,1)*rg6_34(i3,i4)%a(1,1)+lf5_634(mu)
     & %a(2,2)*rg6_34(i3,i4)%b(2,1))
      clinetfz(i3,i4,mu)%b(2,1)=clinetfz(i3,i4,mu)%b(2,1)+lf5_63
     & 4(mu)%b(2,1)*rg6_34(i3,i4)%a(1,1)+lf5_634(mu)%d(2,2)*p634
     & q*rg6_34(i3,i4)%b(2,1)
      clinetfz(i3,i4,mu)%c(2,1)=clinetfz(i3,i4,mu)%c(2,1)+lf5_63
     & 4(mu)%c(2,1)*p634q*rg6_34(i3,i4)%d(1,1)+lf5_634(mu)%a(2,2
     & )*rg6_34(i3,i4)%c(2,1)
      clinetfz(i3,i4,mu)%d(2,1)=clinetfz(i3,i4,mu)%d(2,1)+rmass(
     & id5)*(lf5_634(mu)%b(2,1)*rg6_34(i3,i4)%d(1,1)+lf5_634(mu)
     & %d(2,2)*rg6_34(i3,i4)%c(2,1))
      clinetfz(i3,i4,mu)%a(2,2)=clinetfz(i3,i4,mu)%a(2,2)+lf5_63
     & 4(mu)%c(2,1)*p634q*rg6_34(i3,i4)%b(1,2)+lf5_634(mu)%a(2,2
     & )*rg6_34(i3,i4)%a(2,2)
      clinetfz(i3,i4,mu)%b(2,2)=clinetfz(i3,i4,mu)%b(2,2)+rmass(
     & id5)*(lf5_634(mu)%b(2,1)*rg6_34(i3,i4)%b(1,2)+lf5_634(mu)
     & %d(2,2)*rg6_34(i3,i4)%a(2,2))
      clinetfz(i3,i4,mu)%c(2,2)=clinetfz(i3,i4,mu)%c(2,2)+rmass(
     & id5)*(lf5_634(mu)%c(2,1)*rg6_34(i3,i4)%c(1,2)+lf5_634(mu)
     & %a(2,2)*rg6_34(i3,i4)%d(2,2))
      clinetfz(i3,i4,mu)%d(2,2)=clinetfz(i3,i4,mu)%d(2,2)+lf5_63
     & 4(mu)%b(2,1)*rg6_34(i3,i4)%c(1,2)+lf5_634(mu)%d(2,2)*p634
     & q*rg6_34(i3,i4)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id5)
      rmassr=-rmass(id5)
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=cfqcd3456(i3,i4,&1,&2,mu),abcd=clinetfz(i3,i4,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cfqcd3456(i3,i4,iut,jut,mu)=clinetfz(i3,i4,mu)%a(iut,jut)+
     & rmassl*clinetfz(i3,i4,mu)%b(iut,jut)+rmassr*clinetfz(i3,i
     & 4,mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i3,i4,mu)%d(iut,j
     & ut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TT -- aa=clinetfz(i5,i6,mu)%a,bb=clinetfz(i5,i6,mu)%b,cc=clinetfz(i5,i
* 6,mu)%c,dd=clinetfz(i5,i6,mu)%d,a1=lg3_56(i5,i6)%a,b1=lg3_56(i5,i6)%b,
* c1=lg3_56(i5,i6)%c,d1=lg3_56(i5,i6)%d,a2=rf4_356(mu)%a,b2=rf4_356(mu)%
* b,c2=rf4_356(mu)%c,d2=rf4_356(mu)%d,prq=p356q,m=rmass(id3),nsum=0
      clinetfz(i5,i6,mu)%a(1,1)=lg3_56(i5,i6)%a(1,1)*rf4_356(mu)
     & %a(1,1)+lg3_56(i5,i6)%c(1,2)*p356q*rf4_356(mu)%b(2,1)
      clinetfz(i5,i6,mu)%b(1,1)=rmass(id3)*(lg3_56(i5,i6)%d(1,1)
     & *rf4_356(mu)%a(1,1)+lg3_56(i5,i6)%b(1,2)*rf4_356(mu)%b(2,
     & 1))
      clinetfz(i5,i6,mu)%c(1,1)=rmass(id3)*(lg3_56(i5,i6)%a(1,1)
     & *rf4_356(mu)%d(1,1)+lg3_56(i5,i6)%c(1,2)*rf4_356(mu)%c(2,
     & 1))
      clinetfz(i5,i6,mu)%d(1,1)=lg3_56(i5,i6)%d(1,1)*p356q*rf4_3
     & 56(mu)%d(1,1)+lg3_56(i5,i6)%b(1,2)*rf4_356(mu)%c(2,1)
      clinetfz(i5,i6,mu)%a(1,2)=rmass(id3)*(lg3_56(i5,i6)%a(1,1)
     & *rf4_356(mu)%b(1,2)+lg3_56(i5,i6)%c(1,2)*rf4_356(mu)%a(2,
     & 2))
      clinetfz(i5,i6,mu)%b(1,2)=lg3_56(i5,i6)%d(1,1)*p356q*rf4_3
     & 56(mu)%b(1,2)+lg3_56(i5,i6)%b(1,2)*rf4_356(mu)%a(2,2)
      clinetfz(i5,i6,mu)%c(1,2)=lg3_56(i5,i6)%a(1,1)*rf4_356(mu)
     & %c(1,2)+lg3_56(i5,i6)%c(1,2)*p356q*rf4_356(mu)%d(2,2)
      clinetfz(i5,i6,mu)%d(1,2)=rmass(id3)*(lg3_56(i5,i6)%d(1,1)
     & *rf4_356(mu)%c(1,2)+lg3_56(i5,i6)%b(1,2)*rf4_356(mu)%d(2,
     & 2))
      clinetfz(i5,i6,mu)%a(2,1)=rmass(id3)*(lg3_56(i5,i6)%c(2,1)
     & *rf4_356(mu)%a(1,1)+lg3_56(i5,i6)%a(2,2)*rf4_356(mu)%b(2,
     & 1))
      clinetfz(i5,i6,mu)%b(2,1)=lg3_56(i5,i6)%b(2,1)*rf4_356(mu)
     & %a(1,1)+lg3_56(i5,i6)%d(2,2)*p356q*rf4_356(mu)%b(2,1)
      clinetfz(i5,i6,mu)%c(2,1)=lg3_56(i5,i6)%c(2,1)*p356q*rf4_3
     & 56(mu)%d(1,1)+lg3_56(i5,i6)%a(2,2)*rf4_356(mu)%c(2,1)
      clinetfz(i5,i6,mu)%d(2,1)=rmass(id3)*(lg3_56(i5,i6)%b(2,1)
     & *rf4_356(mu)%d(1,1)+lg3_56(i5,i6)%d(2,2)*rf4_356(mu)%c(2,
     & 1))
      clinetfz(i5,i6,mu)%a(2,2)=lg3_56(i5,i6)%c(2,1)*p356q*rf4_3
     & 56(mu)%b(1,2)+lg3_56(i5,i6)%a(2,2)*rf4_356(mu)%a(2,2)
      clinetfz(i5,i6,mu)%b(2,2)=rmass(id3)*(lg3_56(i5,i6)%b(2,1)
     & *rf4_356(mu)%b(1,2)+lg3_56(i5,i6)%d(2,2)*rf4_356(mu)%a(2,
     & 2))
      clinetfz(i5,i6,mu)%c(2,2)=rmass(id3)*(lg3_56(i5,i6)%c(2,1)
     & *rf4_356(mu)%c(1,2)+lg3_56(i5,i6)%a(2,2)*rf4_356(mu)%d(2,
     & 2))
      clinetfz(i5,i6,mu)%d(2,2)=lg3_56(i5,i6)%b(2,1)*rf4_356(mu)
     & %c(1,2)+lg3_56(i5,i6)%d(2,2)*p356q*rf4_356(mu)%d(2,2)
      end do
      end do
      end do
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TT -- aa=clinetfz(i5,i6,mu)%a,bb=clinetfz(i5,i6,mu)%b,cc=clinetfz(i5,i
* 6,mu)%c,dd=clinetfz(i5,i6,mu)%d,a1=lf3_456(mu)%a,b1=lf3_456(mu)%b,c1=l
* f3_456(mu)%c,d1=lf3_456(mu)%d,a2=rg4_56(i5,i6)%a,b2=rg4_56(i5,i6)%b,c2
* =rg4_56(i5,i6)%c,d2=rg4_56(i5,i6)%d,prq=p456q,m=rmass(id3),nsum=1
      clinetfz(i5,i6,mu)%a(1,1)=clinetfz(i5,i6,mu)%a(1,1)+lf3_45
     & 6(mu)%a(1,1)*rg4_56(i5,i6)%a(1,1)+lf3_456(mu)%c(1,2)*p456
     & q*rg4_56(i5,i6)%b(2,1)
      clinetfz(i5,i6,mu)%b(1,1)=clinetfz(i5,i6,mu)%b(1,1)+rmass(
     & id3)*(lf3_456(mu)%d(1,1)*rg4_56(i5,i6)%a(1,1)+lf3_456(mu)
     & %b(1,2)*rg4_56(i5,i6)%b(2,1))
      clinetfz(i5,i6,mu)%c(1,1)=clinetfz(i5,i6,mu)%c(1,1)+rmass(
     & id3)*(lf3_456(mu)%a(1,1)*rg4_56(i5,i6)%d(1,1)+lf3_456(mu)
     & %c(1,2)*rg4_56(i5,i6)%c(2,1))
      clinetfz(i5,i6,mu)%d(1,1)=clinetfz(i5,i6,mu)%d(1,1)+lf3_45
     & 6(mu)%d(1,1)*p456q*rg4_56(i5,i6)%d(1,1)+lf3_456(mu)%b(1,2
     & )*rg4_56(i5,i6)%c(2,1)
      clinetfz(i5,i6,mu)%a(1,2)=clinetfz(i5,i6,mu)%a(1,2)+rmass(
     & id3)*(lf3_456(mu)%a(1,1)*rg4_56(i5,i6)%b(1,2)+lf3_456(mu)
     & %c(1,2)*rg4_56(i5,i6)%a(2,2))
      clinetfz(i5,i6,mu)%b(1,2)=clinetfz(i5,i6,mu)%b(1,2)+lf3_45
     & 6(mu)%d(1,1)*p456q*rg4_56(i5,i6)%b(1,2)+lf3_456(mu)%b(1,2
     & )*rg4_56(i5,i6)%a(2,2)
      clinetfz(i5,i6,mu)%c(1,2)=clinetfz(i5,i6,mu)%c(1,2)+lf3_45
     & 6(mu)%a(1,1)*rg4_56(i5,i6)%c(1,2)+lf3_456(mu)%c(1,2)*p456
     & q*rg4_56(i5,i6)%d(2,2)
      clinetfz(i5,i6,mu)%d(1,2)=clinetfz(i5,i6,mu)%d(1,2)+rmass(
     & id3)*(lf3_456(mu)%d(1,1)*rg4_56(i5,i6)%c(1,2)+lf3_456(mu)
     & %b(1,2)*rg4_56(i5,i6)%d(2,2))
      clinetfz(i5,i6,mu)%a(2,1)=clinetfz(i5,i6,mu)%a(2,1)+rmass(
     & id3)*(lf3_456(mu)%c(2,1)*rg4_56(i5,i6)%a(1,1)+lf3_456(mu)
     & %a(2,2)*rg4_56(i5,i6)%b(2,1))
      clinetfz(i5,i6,mu)%b(2,1)=clinetfz(i5,i6,mu)%b(2,1)+lf3_45
     & 6(mu)%b(2,1)*rg4_56(i5,i6)%a(1,1)+lf3_456(mu)%d(2,2)*p456
     & q*rg4_56(i5,i6)%b(2,1)
      clinetfz(i5,i6,mu)%c(2,1)=clinetfz(i5,i6,mu)%c(2,1)+lf3_45
     & 6(mu)%c(2,1)*p456q*rg4_56(i5,i6)%d(1,1)+lf3_456(mu)%a(2,2
     & )*rg4_56(i5,i6)%c(2,1)
      clinetfz(i5,i6,mu)%d(2,1)=clinetfz(i5,i6,mu)%d(2,1)+rmass(
     & id3)*(lf3_456(mu)%b(2,1)*rg4_56(i5,i6)%d(1,1)+lf3_456(mu)
     & %d(2,2)*rg4_56(i5,i6)%c(2,1))
      clinetfz(i5,i6,mu)%a(2,2)=clinetfz(i5,i6,mu)%a(2,2)+lf3_45
     & 6(mu)%c(2,1)*p456q*rg4_56(i5,i6)%b(1,2)+lf3_456(mu)%a(2,2
     & )*rg4_56(i5,i6)%a(2,2)
      clinetfz(i5,i6,mu)%b(2,2)=clinetfz(i5,i6,mu)%b(2,2)+rmass(
     & id3)*(lf3_456(mu)%b(2,1)*rg4_56(i5,i6)%b(1,2)+lf3_456(mu)
     & %d(2,2)*rg4_56(i5,i6)%a(2,2))
      clinetfz(i5,i6,mu)%c(2,2)=clinetfz(i5,i6,mu)%c(2,2)+rmass(
     & id3)*(lf3_456(mu)%c(2,1)*rg4_56(i5,i6)%c(1,2)+lf3_456(mu)
     & %a(2,2)*rg4_56(i5,i6)%d(2,2))
      clinetfz(i5,i6,mu)%d(2,2)=clinetfz(i5,i6,mu)%d(2,2)+lf3_45
     & 6(mu)%b(2,1)*rg4_56(i5,i6)%c(1,2)+lf3_456(mu)%d(2,2)*p456
     & q*rg4_56(i5,i6)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id3)
      rmassr=-rmass(id3)
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* mline -- res=cfqcd3456(&1,&2,i5,i6,mu),abcd=clinetfz(i5,i6,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cfqcd3456(iut,jut,i5,i6,mu)=cfqcd3456(iut,jut,i5,i6,mu)+cl
     & inetfz(i5,i6,mu)%a(iut,jut)+rmassl*clinetfz(i5,i6,mu)%b(i
     & ut,jut)+rmassr*clinetfz(i5,i6,mu)%c(iut,jut)+rmassl*rmass
     & r*clinetfz(i5,i6,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
  
*                                                                       
* Then link the computed subdiagrams with the "Z" and "gamma" insertions
* [cz1278(2,2,2,2,0:3) and cf1278(2,2,2,2,0:3)]%                        
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4)   
*                                                                       
  
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
  
* "Z" insertion                                                         
* p.q -- p.q=cp1278dotczqcd3456,p=p1278(#),q=czqcd3456(i3,i4,i5,i6,#),be
* f=,aft=
      cp1278dotczqcd3456=(p1278(0)*czqcd3456(i3,i4,i5,i6,0)-p127
     & 8(1)*czqcd3456(i3,i4,i5,i6,1)-p1278(2)*czqcd3456(i3,i4,i5
     & ,i6,2)-p1278(3)*czqcd3456(i3,i4,i5,i6,3))
  
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4),p=czqcd3456(i3,i4,i5,
* i6,#),q=cz1278(i1,i2,i7,i8,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4
* )-,aft=/(p1278q-cmz2)
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,4)-(czqcd3456(i3,i4,i5,i6,0)*cz1278(i1,i2,
     & i7,i8,0)-czqcd3456(i3,i4,i5,i6,1)*cz1278(i1,i2,i7,i8,1)-c
     & zqcd3456(i3,i4,i5,i6,2)*cz1278(i1,i2,i7,i8,2)-czqcd3456(i
     & 3,i4,i5,i6,3)*cz1278(i1,i2,i7,i8,3))/(p1278q-cmz2)
  
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) =
     &   cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) +
     &   (cp1278dotczqcd3456*cp1278dotcz1278(i1,i2,i7,i8))
     &   /cmz2/(p1278q-cmz2)
  
* "gamma" insertion                                                     
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4),p=cfqcd3456(i3,i4,i5,
* i6,#),q=cf1278(i1,i2,i7,i8,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4
* )-,aft=/p1278q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,4)-(cfqcd3456(i3,i4,i5,i6,0)*cf1278(i1,i2,
     & i7,i8,0)-cfqcd3456(i3,i4,i5,i6,1)*cf1278(i1,i2,i7,i8,1)-c
     & fqcd3456(i3,i4,i5,i6,2)*cf1278(i1,i2,i7,i8,2)-cfqcd3456(i
     & 3,i4,i5,i6,3)*cf1278(i1,i2,i7,i8,3))/p1278q
  
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
*****************Compute diagrams of class 2.c)*************************
*                                                                       
*First compute subdiagrams of the type  [chqcd3456(2,2,2,2)]            
*                                                                       
*                                                                       
  
      do i3=1,2
        do i4=1,2
          do i5=1,2
            do i6=1,2
              chqcd3456(i3,i4,i5,i6)=czero
            enddo
          enddo
        enddo
      enddo
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.rmh.ge.0.d0) then
  
      do i5=1,2
      do i6=1,2
* TTSC -- aa=clineth_4f(i5,i6)%a,bb=clineth_4f(i5,i6)%b,cc=clineth_4f(i5
* ,i6)%c,dd=clineth_4f(i5,i6)%d,a1=lg3_56(i5,i6)%a,b1=lg3_56(i5,i6)%b,c1
* =lg3_56(i5,i6)%c,d1=lg3_56(i5,i6)%d,a2=rh4_356%a,b2=rh4_356%b,c2=rh4_3
* 56%c,prq=p356q,m=rmass(id3),nsum=0
      clineth_4f(i5,i6)%a(1,2)=lg3_56(i5,i6)%a(1,1)*rh4_356%a(1,
     & 2)+lg3_56(i5,i6)%c(1,2)*p356q*rh4_356%b(2,2)
      clineth_4f(i5,i6)%b(1,2)=rmass(id3)*(lg3_56(i5,i6)%d(1,1)*
     & rh4_356%a(1,2)+lg3_56(i5,i6)%b(1,2)*rh4_356%b(2,2))
      clineth_4f(i5,i6)%c(1,2)=rmass(id3)*lg3_56(i5,i6)%c(1,2)*r
     & h4_356%c(2,2)
      clineth_4f(i5,i6)%d(1,2)=lg3_56(i5,i6)%b(1,2)*rh4_356%c(2,
     & 2)
      clineth_4f(i5,i6)%a(1,1)=rmass(id3)*(lg3_56(i5,i6)%a(1,1)*
     & rh4_356%b(1,1)+lg3_56(i5,i6)%c(1,2)*rh4_356%a(2,1))
      clineth_4f(i5,i6)%b(1,1)=lg3_56(i5,i6)%d(1,1)*p356q*rh4_35
     & 6%b(1,1)+lg3_56(i5,i6)%b(1,2)*rh4_356%a(2,1)
      clineth_4f(i5,i6)%c(1,1)=lg3_56(i5,i6)%a(1,1)*rh4_356%c(1,
     & 1)
      clineth_4f(i5,i6)%d(1,1)=rmass(id3)*lg3_56(i5,i6)%d(1,1)*r
     & h4_356%c(1,1)
      clineth_4f(i5,i6)%a(2,2)=rmass(id3)*(lg3_56(i5,i6)%c(2,1)*
     & rh4_356%a(1,2)+lg3_56(i5,i6)%a(2,2)*rh4_356%b(2,2))
      clineth_4f(i5,i6)%b(2,2)=lg3_56(i5,i6)%b(2,1)*rh4_356%a(1,
     & 2)+lg3_56(i5,i6)%d(2,2)*p356q*rh4_356%b(2,2)
      clineth_4f(i5,i6)%c(2,2)=lg3_56(i5,i6)%a(2,2)*rh4_356%c(2,
     & 2)
      clineth_4f(i5,i6)%d(2,2)=rmass(id3)*lg3_56(i5,i6)%d(2,2)*r
     & h4_356%c(2,2)
      clineth_4f(i5,i6)%a(2,1)=lg3_56(i5,i6)%c(2,1)*p356q*rh4_35
     & 6%b(1,1)+lg3_56(i5,i6)%a(2,2)*rh4_356%a(2,1)
      clineth_4f(i5,i6)%b(2,1)=rmass(id3)*(lg3_56(i5,i6)%b(2,1)*
     & rh4_356%b(1,1)+lg3_56(i5,i6)%d(2,2)*rh4_356%a(2,1))
      clineth_4f(i5,i6)%c(2,1)=rmass(id3)*lg3_56(i5,i6)%c(2,1)*r
     & h4_356%c(1,1)
      clineth_4f(i5,i6)%d(2,1)=lg3_56(i5,i6)%b(2,1)*rh4_356%c(1,
     & 1)
      end do
      end do
  
      do i5=1,2
      do i6=1,2
* TSCT -- aa=clineth_4f(i5,i6)%a,bb=clineth_4f(i5,i6)%b,cc=clineth_4f(i5
* ,i6)%c,dd=clineth_4f(i5,i6)%d,a1=lh3_456%a,b1=lh3_456%b,c1=lh3_456%c,a
* 2=rg4_56(i5,i6)%a,b2=rg4_56(i5,i6)%b,c2=rg4_56(i5,i6)%c,d2=rg4_56(i5,i
* 6)%d,prq=p456q,m=rmass(id3),nsum=1
      clineth_4f(i5,i6)%a(2,1)=clineth_4f(i5,i6)%a(2,1)+lh3_456%
     & a(2,1)*rg4_56(i5,i6)%a(1,1)+lh3_456%c(2,2)*p456q*rg4_56(i
     & 5,i6)%b(2,1)
      clineth_4f(i5,i6)%b(2,1)=clineth_4f(i5,i6)%b(2,1)+rmass(id
     & 3)*lh3_456%b(2,2)*rg4_56(i5,i6)%b(2,1)
      clineth_4f(i5,i6)%c(2,1)=clineth_4f(i5,i6)%c(2,1)+rmass(id
     & 3)*(lh3_456%a(2,1)*rg4_56(i5,i6)%d(1,1)+lh3_456%c(2,2)*rg
     & 4_56(i5,i6)%c(2,1))
      clineth_4f(i5,i6)%d(2,1)=clineth_4f(i5,i6)%d(2,1)+lh3_456%
     & b(2,2)*rg4_56(i5,i6)%c(2,1)
      clineth_4f(i5,i6)%a(2,2)=clineth_4f(i5,i6)%a(2,2)+rmass(id
     & 3)*(lh3_456%a(2,1)*rg4_56(i5,i6)%b(1,2)+lh3_456%c(2,2)*rg
     & 4_56(i5,i6)%a(2,2))
      clineth_4f(i5,i6)%b(2,2)=clineth_4f(i5,i6)%b(2,2)+lh3_456%
     & b(2,2)*rg4_56(i5,i6)%a(2,2)
      clineth_4f(i5,i6)%c(2,2)=clineth_4f(i5,i6)%c(2,2)+lh3_456%
     & a(2,1)*rg4_56(i5,i6)%c(1,2)+lh3_456%c(2,2)*p456q*rg4_56(i
     & 5,i6)%d(2,2)
      clineth_4f(i5,i6)%d(2,2)=clineth_4f(i5,i6)%d(2,2)+rmass(id
     & 3)*lh3_456%b(2,2)*rg4_56(i5,i6)%d(2,2)
      clineth_4f(i5,i6)%a(1,1)=clineth_4f(i5,i6)%a(1,1)+rmass(id
     & 3)*(lh3_456%c(1,1)*rg4_56(i5,i6)%a(1,1)+lh3_456%a(1,2)*rg
     & 4_56(i5,i6)%b(2,1))
      clineth_4f(i5,i6)%b(1,1)=clineth_4f(i5,i6)%b(1,1)+lh3_456%
     & b(1,1)*rg4_56(i5,i6)%a(1,1)
      clineth_4f(i5,i6)%c(1,1)=clineth_4f(i5,i6)%c(1,1)+lh3_456%
     & c(1,1)*p456q*rg4_56(i5,i6)%d(1,1)+lh3_456%a(1,2)*rg4_56(i
     & 5,i6)%c(2,1)
      clineth_4f(i5,i6)%d(1,1)=clineth_4f(i5,i6)%d(1,1)+rmass(id
     & 3)*lh3_456%b(1,1)*rg4_56(i5,i6)%d(1,1)
      clineth_4f(i5,i6)%a(1,2)=clineth_4f(i5,i6)%a(1,2)+lh3_456%
     & c(1,1)*p456q*rg4_56(i5,i6)%b(1,2)+lh3_456%a(1,2)*rg4_56(i
     & 5,i6)%a(2,2)
      clineth_4f(i5,i6)%b(1,2)=clineth_4f(i5,i6)%b(1,2)+rmass(id
     & 3)*lh3_456%b(1,1)*rg4_56(i5,i6)%b(1,2)
      clineth_4f(i5,i6)%c(1,2)=clineth_4f(i5,i6)%c(1,2)+rmass(id
     & 3)*(lh3_456%c(1,1)*rg4_56(i5,i6)%c(1,2)+lh3_456%a(1,2)*rg
     & 4_56(i5,i6)%d(2,2))
      clineth_4f(i5,i6)%d(1,2)=clineth_4f(i5,i6)%d(1,2)+lh3_456%
     & b(1,1)*rg4_56(i5,i6)%c(1,2)
      end do
      end do
  
      rmassl=rmass(id3)
      rmassr=-rmass(id3)
  
      do i5=1,2
      do i6=1,2
* mline -- res=chqcd3456(&1,&2,i5,i6),abcd=clineth_4f(i5,i6)%,m1=rmassl,
* m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      chqcd3456(iut,jut,i5,i6)=clineth_4f(i5,i6)%a(iut,jut)+rmas
     & sl*clineth_4f(i5,i6)%b(iut,jut)+rmassr*clineth_4f(i5,i6)%
     & c(iut,jut)+rmassl*rmassr*clineth_4f(i5,i6)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
      endif
  
      if (id5.eq.5.and.rmh.ge.0.d0) then
  
      do i3=1,2
      do i4=1,2
* TTSC -- aa=clineth_4f(i3,i4)%a,bb=clineth_4f(i3,i4)%b,cc=clineth_4f(i3
* ,i4)%c,dd=clineth_4f(i3,i4)%d,a1=lg5_34(i3,i4)%a,b1=lg5_34(i3,i4)%b,c1
* =lg5_34(i3,i4)%c,d1=lg5_34(i3,i4)%d,a2=rh6_534%a,b2=rh6_534%b,c2=rh6_5
* 34%c,prq=p534q,m=rmass(id5),nsum=0
      clineth_4f(i3,i4)%a(1,2)=lg5_34(i3,i4)%a(1,1)*rh6_534%a(1,
     & 2)+lg5_34(i3,i4)%c(1,2)*p534q*rh6_534%b(2,2)
      clineth_4f(i3,i4)%b(1,2)=rmass(id5)*(lg5_34(i3,i4)%d(1,1)*
     & rh6_534%a(1,2)+lg5_34(i3,i4)%b(1,2)*rh6_534%b(2,2))
      clineth_4f(i3,i4)%c(1,2)=rmass(id5)*lg5_34(i3,i4)%c(1,2)*r
     & h6_534%c(2,2)
      clineth_4f(i3,i4)%d(1,2)=lg5_34(i3,i4)%b(1,2)*rh6_534%c(2,
     & 2)
      clineth_4f(i3,i4)%a(1,1)=rmass(id5)*(lg5_34(i3,i4)%a(1,1)*
     & rh6_534%b(1,1)+lg5_34(i3,i4)%c(1,2)*rh6_534%a(2,1))
      clineth_4f(i3,i4)%b(1,1)=lg5_34(i3,i4)%d(1,1)*p534q*rh6_53
     & 4%b(1,1)+lg5_34(i3,i4)%b(1,2)*rh6_534%a(2,1)
      clineth_4f(i3,i4)%c(1,1)=lg5_34(i3,i4)%a(1,1)*rh6_534%c(1,
     & 1)
      clineth_4f(i3,i4)%d(1,1)=rmass(id5)*lg5_34(i3,i4)%d(1,1)*r
     & h6_534%c(1,1)
      clineth_4f(i3,i4)%a(2,2)=rmass(id5)*(lg5_34(i3,i4)%c(2,1)*
     & rh6_534%a(1,2)+lg5_34(i3,i4)%a(2,2)*rh6_534%b(2,2))
      clineth_4f(i3,i4)%b(2,2)=lg5_34(i3,i4)%b(2,1)*rh6_534%a(1,
     & 2)+lg5_34(i3,i4)%d(2,2)*p534q*rh6_534%b(2,2)
      clineth_4f(i3,i4)%c(2,2)=lg5_34(i3,i4)%a(2,2)*rh6_534%c(2,
     & 2)
      clineth_4f(i3,i4)%d(2,2)=rmass(id5)*lg5_34(i3,i4)%d(2,2)*r
     & h6_534%c(2,2)
      clineth_4f(i3,i4)%a(2,1)=lg5_34(i3,i4)%c(2,1)*p534q*rh6_53
     & 4%b(1,1)+lg5_34(i3,i4)%a(2,2)*rh6_534%a(2,1)
      clineth_4f(i3,i4)%b(2,1)=rmass(id5)*(lg5_34(i3,i4)%b(2,1)*
     & rh6_534%b(1,1)+lg5_34(i3,i4)%d(2,2)*rh6_534%a(2,1))
      clineth_4f(i3,i4)%c(2,1)=rmass(id5)*lg5_34(i3,i4)%c(2,1)*r
     & h6_534%c(1,1)
      clineth_4f(i3,i4)%d(2,1)=lg5_34(i3,i4)%b(2,1)*rh6_534%c(1,
     & 1)
      end do
      end do
  
      do i3=1,2
      do i4=1,2
* TSCT -- aa=clineth_4f(i3,i4)%a,bb=clineth_4f(i3,i4)%b,cc=clineth_4f(i3
* ,i4)%c,dd=clineth_4f(i3,i4)%d,a1=lh5_634%a,b1=lh5_634%b,c1=lh5_634%c,a
* 2=rg6_34(i3,i4)%a,b2=rg6_34(i3,i4)%b,c2=rg6_34(i3,i4)%c,d2=rg6_34(i3,i
* 4)%d,prq=p634q,m=rmass(id5),nsum=1
      clineth_4f(i3,i4)%a(2,1)=clineth_4f(i3,i4)%a(2,1)+lh5_634%
     & a(2,1)*rg6_34(i3,i4)%a(1,1)+lh5_634%c(2,2)*p634q*rg6_34(i
     & 3,i4)%b(2,1)
      clineth_4f(i3,i4)%b(2,1)=clineth_4f(i3,i4)%b(2,1)+rmass(id
     & 5)*lh5_634%b(2,2)*rg6_34(i3,i4)%b(2,1)
      clineth_4f(i3,i4)%c(2,1)=clineth_4f(i3,i4)%c(2,1)+rmass(id
     & 5)*(lh5_634%a(2,1)*rg6_34(i3,i4)%d(1,1)+lh5_634%c(2,2)*rg
     & 6_34(i3,i4)%c(2,1))
      clineth_4f(i3,i4)%d(2,1)=clineth_4f(i3,i4)%d(2,1)+lh5_634%
     & b(2,2)*rg6_34(i3,i4)%c(2,1)
      clineth_4f(i3,i4)%a(2,2)=clineth_4f(i3,i4)%a(2,2)+rmass(id
     & 5)*(lh5_634%a(2,1)*rg6_34(i3,i4)%b(1,2)+lh5_634%c(2,2)*rg
     & 6_34(i3,i4)%a(2,2))
      clineth_4f(i3,i4)%b(2,2)=clineth_4f(i3,i4)%b(2,2)+lh5_634%
     & b(2,2)*rg6_34(i3,i4)%a(2,2)
      clineth_4f(i3,i4)%c(2,2)=clineth_4f(i3,i4)%c(2,2)+lh5_634%
     & a(2,1)*rg6_34(i3,i4)%c(1,2)+lh5_634%c(2,2)*p634q*rg6_34(i
     & 3,i4)%d(2,2)
      clineth_4f(i3,i4)%d(2,2)=clineth_4f(i3,i4)%d(2,2)+rmass(id
     & 5)*lh5_634%b(2,2)*rg6_34(i3,i4)%d(2,2)
      clineth_4f(i3,i4)%a(1,1)=clineth_4f(i3,i4)%a(1,1)+rmass(id
     & 5)*(lh5_634%c(1,1)*rg6_34(i3,i4)%a(1,1)+lh5_634%a(1,2)*rg
     & 6_34(i3,i4)%b(2,1))
      clineth_4f(i3,i4)%b(1,1)=clineth_4f(i3,i4)%b(1,1)+lh5_634%
     & b(1,1)*rg6_34(i3,i4)%a(1,1)
      clineth_4f(i3,i4)%c(1,1)=clineth_4f(i3,i4)%c(1,1)+lh5_634%
     & c(1,1)*p634q*rg6_34(i3,i4)%d(1,1)+lh5_634%a(1,2)*rg6_34(i
     & 3,i4)%c(2,1)
      clineth_4f(i3,i4)%d(1,1)=clineth_4f(i3,i4)%d(1,1)+rmass(id
     & 5)*lh5_634%b(1,1)*rg6_34(i3,i4)%d(1,1)
      clineth_4f(i3,i4)%a(1,2)=clineth_4f(i3,i4)%a(1,2)+lh5_634%
     & c(1,1)*p634q*rg6_34(i3,i4)%b(1,2)+lh5_634%a(1,2)*rg6_34(i
     & 3,i4)%a(2,2)
      clineth_4f(i3,i4)%b(1,2)=clineth_4f(i3,i4)%b(1,2)+rmass(id
     & 5)*lh5_634%b(1,1)*rg6_34(i3,i4)%b(1,2)
      clineth_4f(i3,i4)%c(1,2)=clineth_4f(i3,i4)%c(1,2)+rmass(id
     & 5)*(lh5_634%c(1,1)*rg6_34(i3,i4)%c(1,2)+lh5_634%a(1,2)*rg
     & 6_34(i3,i4)%d(2,2))
      clineth_4f(i3,i4)%d(1,2)=clineth_4f(i3,i4)%d(1,2)+lh5_634%
     & b(1,1)*rg6_34(i3,i4)%c(1,2)
      end do
      end do
  
      rmassl=rmass(id5)
      rmassr=-rmass(id5)
  
      do i3=1,2
      do i4=1,2
* mline -- res=chqcd3456(i3,i4,&1,&2),abcd=clineth_4f(i3,i4)%,m1=rmassl,
* m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      chqcd3456(i3,i4,iut,jut)=chqcd3456(i3,i4,iut,jut)+clineth_
     & 4f(i3,i4)%a(iut,jut)+rmassl*clineth_4f(i3,i4)%b(iut,jut)+
     & rmassr*clineth_4f(i3,i4)%c(iut,jut)+rmassl*rmassr*clineth
     & _4f(i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
      endif
  
*                                                                       
* Then link the computed subdiagrams with the "higgs" insertion         
* [ch1278(2,2,2,2)]                                                     
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4)   
*                                                                       
  
      if(rmh.ge.0.d0 .and. (id3.eq.5 .or. id5.eq.5))then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) =
     &                       cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) +
     &                       (chqcd3456(i3,i4,i5,i6)*
     &                       ch1278(i1,i2,i7,i8))/
     &                       (p3456q-cmh2)
                      enddo
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
  
**************Compute diagrams of class 2.d) (three-forks)**************
*                                                                       
* Diagrams are built-up by linking the following structures:            
*                                                                       
* u3|_1278     % rg4|_5|6|       [Z/f/h Z/f/h g]                        
* ug3|_5|6|12  % r4|_78          [g Z/f/h Z/f/h + Z/f/h g Z/f/h]        
* ug3|_5|6|78  % r4|_12          [g Z/f/h Z/f/h + Z/f/h g Z/f/h]        
*                                                                       
* where 3|={3,5}, 4|={4,6}, 5|6|={56,34}.                               
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4)   
*                                                                       
  
      rmassl=rmass(id3)
      rmassr=-rmass(id3)
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=cline_3forks_34(i1,i2,i7,i8,i5,i6)%a,bb=cline_3forks_34(i1,i
* 2,i7,i8,i5,i6)%b,cc=cline_3forks_34(i1,i2,i7,i8,i5,i6)%c,dd=cline_3for
* ks_34(i1,i2,i7,i8,i5,i6)%d,a1=u3_1278(i1,i2,i7,i8)%a,b1=u3_1278(i1,i2,
* i7,i8)%b,c1=u3_1278(i1,i2,i7,i8)%c,d1=u3_1278(i1,i2,i7,i8)%d,a2=rg4_56
* (i5,i6)%a,b2=rg4_56(i5,i6)%b,c2=rg4_56(i5,i6)%c,d2=rg4_56(i5,i6)%d,prq
* =p456q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=u3_1278(i1,i2,i7,i8)%a(iut,1)+u3_1278(i1,i2,i7,i8)%c(i
     & ut,1)*rmass(id3)
      cx2=u3_1278(i1,i2,i7,i8)%c(iut,2)*p456q+u3_1278(i1,i2,i7,i
     & 8)%a(iut,2)*rmass(id3)
      cy1=u3_1278(i1,i2,i7,i8)%b(iut,1)+u3_1278(i1,i2,i7,i8)%d(i
     & ut,1)*rmass(id3)
      cy2=u3_1278(i1,i2,i7,i8)%d(iut,2)*p456q+u3_1278(i1,i2,i7,i
     & 8)%b(iut,2)*rmass(id3)
      cw1=u3_1278(i1,i2,i7,i8)%c(iut,1)*p456q+u3_1278(i1,i2,i7,i
     & 8)%a(iut,1)*rmass(id3)
      cw2=u3_1278(i1,i2,i7,i8)%a(iut,2)+u3_1278(i1,i2,i7,i8)%c(i
     & ut,2)*rmass(id3)
      cz1=u3_1278(i1,i2,i7,i8)%d(iut,1)*p456q+u3_1278(i1,i2,i7,i
     & 8)%b(iut,1)*rmass(id3)
      cz2=u3_1278(i1,i2,i7,i8)%b(iut,2)+u3_1278(i1,i2,i7,i8)%d(i
     & ut,2)*rmass(id3)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%a(iut,1)=cx1*rg4_56(i5,
     & i6)%a(1,1)+cx2*rg4_56(i5,i6)%b(2,1)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%b(iut,1)=cy1*rg4_56(i5,
     & i6)%a(1,1)+cy2*rg4_56(i5,i6)%b(2,1)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%c(iut,1)=cw1*rg4_56(i5,
     & i6)%d(1,1)+cw2*rg4_56(i5,i6)%c(2,1)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%d(iut,1)=cz1*rg4_56(i5,
     & i6)%d(1,1)+cz2*rg4_56(i5,i6)%c(2,1)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%a(iut,2)=cw1*rg4_56(i5,
     & i6)%b(1,2)+cw2*rg4_56(i5,i6)%a(2,2)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%b(iut,2)=cz1*rg4_56(i5,
     & i6)%b(1,2)+cz2*rg4_56(i5,i6)%a(2,2)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%c(iut,2)=cx1*rg4_56(i5,
     & i6)%c(1,2)+cx2*rg4_56(i5,i6)%d(2,2)
      cline_3forks_34(i1,i2,i7,i8,i5,i6)%d(iut,2)=cy1*rg4_56(i5,
     & i6)%c(1,2)+cy2*rg4_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
* mline -- res=cres_3forks_34(i1,i2,i7,i8,i5,i6)%pol(&1,&2),abcd=cline_3
* forks_34(i1,i2,i7,i8,i5,i6)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_34(i1,i2,i7,i8,i5,i6)%pol(iut,jut)=cline_3fork
     & s_34(i1,i2,i7,i8,i5,i6)%a(iut,jut)+rmassl*cline_3forks_34
     & (i1,i2,i7,i8,i5,i6)%b(iut,jut)+rmassr*cline_3forks_34(i1,
     & i2,i7,i8,i5,i6)%c(iut,jut)+rmassl*rmassr*cline_3forks_34(
     & i1,i2,i7,i8,i5,i6)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) +
     &                     cres_3forks_34(i1,i2,i7,i8,i5,i6)
     &                     %pol(i3,i4)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id7.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=cline_3forks_34(i5,i6,i1,i2,i7,i8)%a,bb=cline_3forks_34(i5,
* i6,i1,i2,i7,i8)%b,cc=cline_3forks_34(i5,i6,i1,i2,i7,i8)%c,dd=cline_3fo
* rks_34(i5,i6,i1,i2,i7,i8)%d,a1=ug3_5612(i5,i6,i1,i2)%a,b1=ug3_5612(i5,
* i6,i1,i2)%b,c1=ug3_5612(i5,i6,i1,i2)%c,d1=ug3_5612(i5,i6,i1,i2)%d,a2=r
* 4_78(i7,i8)%a,b2=r4_78(i7,i8)%b,c2=r4_78(i7,i8)%c,d2=r4_78(i7,i8)%d,pr
* q=p478q,m=rmass(id3),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r4_78(i7,i8)%a(1,jut)+rmass(id3)*r4_78(i7,i8)%b(1,jut)
      cx2=r4_78(i7,i8)%a(2,jut)+rmass(id3)*r4_78(i7,i8)%b(2,jut)
      cy1=p478q*r4_78(i7,i8)%b(1,jut)+rmass(id3)*r4_78(i7,i8)%a(
     & 1,jut)
      cy2=p478q*r4_78(i7,i8)%b(2,jut)+rmass(id3)*r4_78(i7,i8)%a(
     & 2,jut)
      cline_3forks_34(i5,i6,i1,i2,i7,i8)%a(iut,jut)=ug3_5612(i5,
     & i6,i1,i2)%a(iut,1)*cx1+ug3_5612(i5,i6,i1,i2)%c(iut,1)*cy1
     & +ug3_5612(i5,i6,i1,i2)%a(iut,2)*cx2+ug3_5612(i5,i6,i1,i2)
     & %c(iut,2)*cy2
      cline_3forks_34(i5,i6,i1,i2,i7,i8)%b(iut,jut)=ug3_5612(i5,
     & i6,i1,i2)%b(iut,1)*cx1+ug3_5612(i5,i6,i1,i2)%d(iut,1)*cy1
     & +ug3_5612(i5,i6,i1,i2)%b(iut,2)*cx2+ug3_5612(i5,i6,i1,i2)
     & %d(iut,2)*cy2
      cw1=r4_78(i7,i8)%c(1,jut)+rmass(id3)*r4_78(i7,i8)%d(1,jut)
      cw2=r4_78(i7,i8)%c(2,jut)+rmass(id3)*r4_78(i7,i8)%d(2,jut)
      cz1=p478q*r4_78(i7,i8)%d(1,jut)+rmass(id3)*r4_78(i7,i8)%c(
     & 1,jut)
      cz2=p478q*r4_78(i7,i8)%d(2,jut)+rmass(id3)*r4_78(i7,i8)%c(
     & 2,jut)
      cline_3forks_34(i5,i6,i1,i2,i7,i8)%c(iut,jut)=ug3_5612(i5,
     & i6,i1,i2)%a(iut,1)*cw1+ug3_5612(i5,i6,i1,i2)%c(iut,1)*cz1
     & +ug3_5612(i5,i6,i1,i2)%a(iut,2)*cw2+ug3_5612(i5,i6,i1,i2)
     & %c(iut,2)*cz2
      cline_3forks_34(i5,i6,i1,i2,i7,i8)%d(iut,jut)=ug3_5612(i5,
     & i6,i1,i2)%b(iut,1)*cw1+ug3_5612(i5,i6,i1,i2)%d(iut,1)*cz1
     & +ug3_5612(i5,i6,i1,i2)%b(iut,2)*cw2+ug3_5612(i5,i6,i1,i2)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=cline_3forks_34(i5,i6,i1,i2,i7,i8)%a,bb=cline_3forks_34(i5,i
* 6,i1,i2,i7,i8)%b,cc=cline_3forks_34(i5,i6,i1,i2,i7,i8)%c,dd=cline_3for
* ks_34(i5,i6,i1,i2,i7,i8)%d,a1=ug3_5612(i5,i6,i1,i2)%a,b1=ug3_5612(i5,i
* 6,i1,i2)%b,c1=ug3_5612(i5,i6,i1,i2)%c,d1=ug3_5612(i5,i6,i1,i2)%d,a2=r4
* _78(i7,i8)%a,b2=r4_78(i7,i8)%b,c2=r4_78(i7,i8)%c,d2=r4_78(i7,i8)%d,prq
* =p478q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=ug3_5612(i5,i6,i1,i2)%a(iut,1)+ug3_5612(i5,i6,i1,i2)%c
     & (iut,1)*rmass(id3)
      cx2=ug3_5612(i5,i6,i1,i2)%c(iut,2)*p478q+ug3_5612(i5,i6,i1
     & ,i2)%a(iut,2)*rmass(id3)
      cy1=ug3_5612(i5,i6,i1,i2)%b(iut,1)+ug3_5612(i5,i6,i1,i2)%d
     & (iut,1)*rmass(id3)
      cy2=ug3_5612(i5,i6,i1,i2)%d(iut,2)*p478q+ug3_5612(i5,i6,i1
     & ,i2)%b(iut,2)*rmass(id3)
      cw1=ug3_5612(i5,i6,i1,i2)%c(iut,1)*p478q+ug3_5612(i5,i6,i1
     & ,i2)%a(iut,1)*rmass(id3)
      cw2=ug3_5612(i5,i6,i1,i2)%a(iut,2)+ug3_5612(i5,i6,i1,i2)%c
     & (iut,2)*rmass(id3)
      cz1=ug3_5612(i5,i6,i1,i2)%d(iut,1)*p478q+ug3_5612(i5,i6,i1
     & ,i2)%b(iut,1)*rmass(id3)
      cz2=ug3_5612(i5,i6,i1,i2)%b(iut,2)+ug3_5612(i5,i6,i1,i2)%d
     & (iut,2)*rmass(id3)
      cline_3forks_34(i5,i6,i1,i2,i7,i8)%a(iut,1)=cx1*r4_78(i7,i
     & 8)%a(1,1)+cx2*r4_78(i7,i8)%b(2,1)
      cline_3forks_34(i5,i6,i1,i2,i7,i8)%b(iut,1)=cy1*r4_78(i7,i
     & 8)%a(1,1)+cy2*r4_78(i7,i8)%b(2,1)
      cline_3forks_34(i5,i6,i1,i2,i7,i8)%c(iut,1)=cw1*r4_78(i7,i
     & 8)%d(1,1)+cw2*r4_78(i7,i8)%c(2,1)
      cline_3forks_34(i5,i6,i1,i2,i7,i8)%d(iut,1)=cz1*r4_78(i7,i
     & 8)%d(1,1)+cz2*r4_78(i7,i8)%c(2,1)
      cline_3forks_34(i5,i6,i1,i2,i7,i8)%a(iut,2)=cw1*r4_78(i7,i
     & 8)%b(1,2)+cw2*r4_78(i7,i8)%a(2,2)
      cline_3forks_34(i5,i6,i1,i2,i7,i8)%b(iut,2)=cz1*r4_78(i7,i
     & 8)%b(1,2)+cz2*r4_78(i7,i8)%a(2,2)
      cline_3forks_34(i5,i6,i1,i2,i7,i8)%c(iut,2)=cx1*r4_78(i7,i
     & 8)%c(1,2)+cx2*r4_78(i7,i8)%d(2,2)
      cline_3forks_34(i5,i6,i1,i2,i7,i8)%d(iut,2)=cy1*r4_78(i7,i
     & 8)%c(1,2)+cy2*r4_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* mline -- res=cres_3forks_34(i5,i6,i1,i2,i7,i8)%pol(&1,&2),abcd=cline_3
* forks_34(i5,i6,i1,i2,i7,i8)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_34(i5,i6,i1,i2,i7,i8)%pol(iut,jut)=cline_3fork
     & s_34(i5,i6,i1,i2,i7,i8)%a(iut,jut)+rmassl*cline_3forks_34
     & (i5,i6,i1,i2,i7,i8)%b(iut,jut)+rmassr*cline_3forks_34(i5,
     & i6,i1,i2,i7,i8)%c(iut,jut)+rmassl*rmassr*cline_3forks_34(
     & i5,i6,i1,i2,i7,i8)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) +
     &                     cres_3forks_34(i5,i6,i1,i2,i7,i8)
     &                     %pol(i3,i4)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
      if(id1.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TsTs -- aa=cline_3forks_34(i5,i6,i7,i8,i1,i2)%a,bb=cline_3forks_34(i5,
* i6,i7,i8,i1,i2)%b,cc=cline_3forks_34(i5,i6,i7,i8,i1,i2)%c,dd=cline_3fo
* rks_34(i5,i6,i7,i8,i1,i2)%d,a1=ug3_5678(i5,i6,i7,i8)%a,b1=ug3_5678(i5,
* i6,i7,i8)%b,c1=ug3_5678(i5,i6,i7,i8)%c,d1=ug3_5678(i5,i6,i7,i8)%d,a2=r
* 4_12(i1,i2)%a,b2=r4_12(i1,i2)%b,c2=r4_12(i1,i2)%c,d2=r4_12(i1,i2)%d,pr
* q=p412q,m=rmass(id3),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r4_12(i1,i2)%a(1,jut)+rmass(id3)*r4_12(i1,i2)%b(1,jut)
      cx2=r4_12(i1,i2)%a(2,jut)+rmass(id3)*r4_12(i1,i2)%b(2,jut)
      cy1=p412q*r4_12(i1,i2)%b(1,jut)+rmass(id3)*r4_12(i1,i2)%a(
     & 1,jut)
      cy2=p412q*r4_12(i1,i2)%b(2,jut)+rmass(id3)*r4_12(i1,i2)%a(
     & 2,jut)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%a(iut,jut)=ug3_5678(i5,
     & i6,i7,i8)%a(iut,1)*cx1+ug3_5678(i5,i6,i7,i8)%c(iut,1)*cy1
     & +ug3_5678(i5,i6,i7,i8)%a(iut,2)*cx2+ug3_5678(i5,i6,i7,i8)
     & %c(iut,2)*cy2
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%b(iut,jut)=ug3_5678(i5,
     & i6,i7,i8)%b(iut,1)*cx1+ug3_5678(i5,i6,i7,i8)%d(iut,1)*cy1
     & +ug3_5678(i5,i6,i7,i8)%b(iut,2)*cx2+ug3_5678(i5,i6,i7,i8)
     & %d(iut,2)*cy2
      cw1=r4_12(i1,i2)%c(1,jut)+rmass(id3)*r4_12(i1,i2)%d(1,jut)
      cw2=r4_12(i1,i2)%c(2,jut)+rmass(id3)*r4_12(i1,i2)%d(2,jut)
      cz1=p412q*r4_12(i1,i2)%d(1,jut)+rmass(id3)*r4_12(i1,i2)%c(
     & 1,jut)
      cz2=p412q*r4_12(i1,i2)%d(2,jut)+rmass(id3)*r4_12(i1,i2)%c(
     & 2,jut)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%c(iut,jut)=ug3_5678(i5,
     & i6,i7,i8)%a(iut,1)*cw1+ug3_5678(i5,i6,i7,i8)%c(iut,1)*cz1
     & +ug3_5678(i5,i6,i7,i8)%a(iut,2)*cw2+ug3_5678(i5,i6,i7,i8)
     & %c(iut,2)*cz2
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%d(iut,jut)=ug3_5678(i5,
     & i6,i7,i8)%b(iut,1)*cw1+ug3_5678(i5,i6,i7,i8)%d(iut,1)*cz1
     & +ug3_5678(i5,i6,i7,i8)%b(iut,2)*cw2+ug3_5678(i5,i6,i7,i8)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=cline_3forks_34(i5,i6,i7,i8,i1,i2)%a,bb=cline_3forks_34(i5,i
* 6,i7,i8,i1,i2)%b,cc=cline_3forks_34(i5,i6,i7,i8,i1,i2)%c,dd=cline_3for
* ks_34(i5,i6,i7,i8,i1,i2)%d,a1=ug3_5678(i5,i6,i7,i8)%a,b1=ug3_5678(i5,i
* 6,i7,i8)%b,c1=ug3_5678(i5,i6,i7,i8)%c,d1=ug3_5678(i5,i6,i7,i8)%d,a2=r4
* _12(i1,i2)%a,b2=r4_12(i1,i2)%b,c2=r4_12(i1,i2)%c,d2=r4_12(i1,i2)%d,prq
* =p412q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=ug3_5678(i5,i6,i7,i8)%a(iut,1)+ug3_5678(i5,i6,i7,i8)%c
     & (iut,1)*rmass(id3)
      cx2=ug3_5678(i5,i6,i7,i8)%c(iut,2)*p412q+ug3_5678(i5,i6,i7
     & ,i8)%a(iut,2)*rmass(id3)
      cy1=ug3_5678(i5,i6,i7,i8)%b(iut,1)+ug3_5678(i5,i6,i7,i8)%d
     & (iut,1)*rmass(id3)
      cy2=ug3_5678(i5,i6,i7,i8)%d(iut,2)*p412q+ug3_5678(i5,i6,i7
     & ,i8)%b(iut,2)*rmass(id3)
      cw1=ug3_5678(i5,i6,i7,i8)%c(iut,1)*p412q+ug3_5678(i5,i6,i7
     & ,i8)%a(iut,1)*rmass(id3)
      cw2=ug3_5678(i5,i6,i7,i8)%a(iut,2)+ug3_5678(i5,i6,i7,i8)%c
     & (iut,2)*rmass(id3)
      cz1=ug3_5678(i5,i6,i7,i8)%d(iut,1)*p412q+ug3_5678(i5,i6,i7
     & ,i8)%b(iut,1)*rmass(id3)
      cz2=ug3_5678(i5,i6,i7,i8)%b(iut,2)+ug3_5678(i5,i6,i7,i8)%d
     & (iut,2)*rmass(id3)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%a(iut,1)=cx1*r4_12(i1,i
     & 2)%a(1,1)+cx2*r4_12(i1,i2)%b(2,1)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%b(iut,1)=cy1*r4_12(i1,i
     & 2)%a(1,1)+cy2*r4_12(i1,i2)%b(2,1)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%c(iut,1)=cw1*r4_12(i1,i
     & 2)%d(1,1)+cw2*r4_12(i1,i2)%c(2,1)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%d(iut,1)=cz1*r4_12(i1,i
     & 2)%d(1,1)+cz2*r4_12(i1,i2)%c(2,1)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%a(iut,2)=cw1*r4_12(i1,i
     & 2)%b(1,2)+cw2*r4_12(i1,i2)%a(2,2)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%b(iut,2)=cz1*r4_12(i1,i
     & 2)%b(1,2)+cz2*r4_12(i1,i2)%a(2,2)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%c(iut,2)=cx1*r4_12(i1,i
     & 2)%c(1,2)+cx2*r4_12(i1,i2)%d(2,2)
      cline_3forks_34(i5,i6,i7,i8,i1,i2)%d(iut,2)=cy1*r4_12(i1,i
     & 2)%c(1,2)+cy2*r4_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* mline -- res=cres_3forks_34(i5,i6,i7,i8,i1,i2)%pol(&1,&2),abcd=cline_3
* forks_34(i5,i6,i7,i8,i1,i2)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_34(i5,i6,i7,i8,i1,i2)%pol(iut,jut)=cline_3fork
     & s_34(i5,i6,i7,i8,i1,i2)%a(iut,jut)+rmassl*cline_3forks_34
     & (i5,i6,i7,i8,i1,i2)%b(iut,jut)+rmassr*cline_3forks_34(i5,
     & i6,i7,i8,i1,i2)%c(iut,jut)+rmassl*rmassr*cline_3forks_34(
     & i5,i6,i7,i8,i1,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) +
     &                     cres_3forks_34(i5,i6,i7,i8,i1,i2)
     &                     %pol(i3,i4)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
  
      rmassl=rmass(id5)
      rmassr=-rmass(id5)
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=cline_3forks_56(i1,i2,i7,i8,i3,i4)%a,bb=cline_3forks_56(i1,i
* 2,i7,i8,i3,i4)%b,cc=cline_3forks_56(i1,i2,i7,i8,i3,i4)%c,dd=cline_3for
* ks_56(i1,i2,i7,i8,i3,i4)%d,a1=u5_1278(i1,i2,i7,i8)%a,b1=u5_1278(i1,i2,
* i7,i8)%b,c1=u5_1278(i1,i2,i7,i8)%c,d1=u5_1278(i1,i2,i7,i8)%d,a2=rg6_34
* (i3,i4)%a,b2=rg6_34(i3,i4)%b,c2=rg6_34(i3,i4)%c,d2=rg6_34(i3,i4)%d,prq
* =p634q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=u5_1278(i1,i2,i7,i8)%a(iut,1)+u5_1278(i1,i2,i7,i8)%c(i
     & ut,1)*rmass(id5)
      cx2=u5_1278(i1,i2,i7,i8)%c(iut,2)*p634q+u5_1278(i1,i2,i7,i
     & 8)%a(iut,2)*rmass(id5)
      cy1=u5_1278(i1,i2,i7,i8)%b(iut,1)+u5_1278(i1,i2,i7,i8)%d(i
     & ut,1)*rmass(id5)
      cy2=u5_1278(i1,i2,i7,i8)%d(iut,2)*p634q+u5_1278(i1,i2,i7,i
     & 8)%b(iut,2)*rmass(id5)
      cw1=u5_1278(i1,i2,i7,i8)%c(iut,1)*p634q+u5_1278(i1,i2,i7,i
     & 8)%a(iut,1)*rmass(id5)
      cw2=u5_1278(i1,i2,i7,i8)%a(iut,2)+u5_1278(i1,i2,i7,i8)%c(i
     & ut,2)*rmass(id5)
      cz1=u5_1278(i1,i2,i7,i8)%d(iut,1)*p634q+u5_1278(i1,i2,i7,i
     & 8)%b(iut,1)*rmass(id5)
      cz2=u5_1278(i1,i2,i7,i8)%b(iut,2)+u5_1278(i1,i2,i7,i8)%d(i
     & ut,2)*rmass(id5)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%a(iut,1)=cx1*rg6_34(i3,
     & i4)%a(1,1)+cx2*rg6_34(i3,i4)%b(2,1)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%b(iut,1)=cy1*rg6_34(i3,
     & i4)%a(1,1)+cy2*rg6_34(i3,i4)%b(2,1)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%c(iut,1)=cw1*rg6_34(i3,
     & i4)%d(1,1)+cw2*rg6_34(i3,i4)%c(2,1)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%d(iut,1)=cz1*rg6_34(i3,
     & i4)%d(1,1)+cz2*rg6_34(i3,i4)%c(2,1)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%a(iut,2)=cw1*rg6_34(i3,
     & i4)%b(1,2)+cw2*rg6_34(i3,i4)%a(2,2)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%b(iut,2)=cz1*rg6_34(i3,
     & i4)%b(1,2)+cz2*rg6_34(i3,i4)%a(2,2)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%c(iut,2)=cx1*rg6_34(i3,
     & i4)%c(1,2)+cx2*rg6_34(i3,i4)%d(2,2)
      cline_3forks_56(i1,i2,i7,i8,i3,i4)%d(iut,2)=cy1*rg6_34(i3,
     & i4)%c(1,2)+cy2*rg6_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
* mline -- res=cres_3forks_56(i1,i2,i7,i8,i3,i4)%pol(&1,&2),abcd=cline_3
* forks_56(i1,i2,i7,i8,i3,i4)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_56(i1,i2,i7,i8,i3,i4)%pol(iut,jut)=cline_3fork
     & s_56(i1,i2,i7,i8,i3,i4)%a(iut,jut)+rmassl*cline_3forks_56
     & (i1,i2,i7,i8,i3,i4)%b(iut,jut)+rmassr*cline_3forks_56(i1,
     & i2,i7,i8,i3,i4)%c(iut,jut)+rmassl*rmassr*cline_3forks_56(
     & i1,i2,i7,i8,i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) +
     &                     cres_3forks_56(i1,i2,i7,i8,i3,i4)
     &                     %pol(i5,i6)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id7.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TsTs -- aa=cline_3forks_56(i3,i4,i1,i2,i7,i8)%a,bb=cline_3forks_56(i3,
* i4,i1,i2,i7,i8)%b,cc=cline_3forks_56(i3,i4,i1,i2,i7,i8)%c,dd=cline_3fo
* rks_56(i3,i4,i1,i2,i7,i8)%d,a1=ug5_3412(i3,i4,i1,i2)%a,b1=ug5_3412(i3,
* i4,i1,i2)%b,c1=ug5_3412(i3,i4,i1,i2)%c,d1=ug5_3412(i3,i4,i1,i2)%d,a2=r
* 6_78(i7,i8)%a,b2=r6_78(i7,i8)%b,c2=r6_78(i7,i8)%c,d2=r6_78(i7,i8)%d,pr
* q=p678q,m=rmass(id5),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r6_78(i7,i8)%a(1,jut)+rmass(id5)*r6_78(i7,i8)%b(1,jut)
      cx2=r6_78(i7,i8)%a(2,jut)+rmass(id5)*r6_78(i7,i8)%b(2,jut)
      cy1=p678q*r6_78(i7,i8)%b(1,jut)+rmass(id5)*r6_78(i7,i8)%a(
     & 1,jut)
      cy2=p678q*r6_78(i7,i8)%b(2,jut)+rmass(id5)*r6_78(i7,i8)%a(
     & 2,jut)
      cline_3forks_56(i3,i4,i1,i2,i7,i8)%a(iut,jut)=ug5_3412(i3,
     & i4,i1,i2)%a(iut,1)*cx1+ug5_3412(i3,i4,i1,i2)%c(iut,1)*cy1
     & +ug5_3412(i3,i4,i1,i2)%a(iut,2)*cx2+ug5_3412(i3,i4,i1,i2)
     & %c(iut,2)*cy2
      cline_3forks_56(i3,i4,i1,i2,i7,i8)%b(iut,jut)=ug5_3412(i3,
     & i4,i1,i2)%b(iut,1)*cx1+ug5_3412(i3,i4,i1,i2)%d(iut,1)*cy1
     & +ug5_3412(i3,i4,i1,i2)%b(iut,2)*cx2+ug5_3412(i3,i4,i1,i2)
     & %d(iut,2)*cy2
      cw1=r6_78(i7,i8)%c(1,jut)+rmass(id5)*r6_78(i7,i8)%d(1,jut)
      cw2=r6_78(i7,i8)%c(2,jut)+rmass(id5)*r6_78(i7,i8)%d(2,jut)
      cz1=p678q*r6_78(i7,i8)%d(1,jut)+rmass(id5)*r6_78(i7,i8)%c(
     & 1,jut)
      cz2=p678q*r6_78(i7,i8)%d(2,jut)+rmass(id5)*r6_78(i7,i8)%c(
     & 2,jut)
      cline_3forks_56(i3,i4,i1,i2,i7,i8)%c(iut,jut)=ug5_3412(i3,
     & i4,i1,i2)%a(iut,1)*cw1+ug5_3412(i3,i4,i1,i2)%c(iut,1)*cz1
     & +ug5_3412(i3,i4,i1,i2)%a(iut,2)*cw2+ug5_3412(i3,i4,i1,i2)
     & %c(iut,2)*cz2
      cline_3forks_56(i3,i4,i1,i2,i7,i8)%d(iut,jut)=ug5_3412(i3,
     & i4,i1,i2)%b(iut,1)*cw1+ug5_3412(i3,i4,i1,i2)%d(iut,1)*cz1
     & +ug5_3412(i3,i4,i1,i2)%b(iut,2)*cw2+ug5_3412(i3,i4,i1,i2)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=cline_3forks_56(i3,i4,i1,i2,i7,i8)%a,bb=cline_3forks_56(i3,i
* 4,i1,i2,i7,i8)%b,cc=cline_3forks_56(i3,i4,i1,i2,i7,i8)%c,dd=cline_3for
* ks_56(i3,i4,i1,i2,i7,i8)%d,a1=ug5_3412(i3,i4,i1,i2)%a,b1=ug5_3412(i3,i
* 4,i1,i2)%b,c1=ug5_3412(i3,i4,i1,i2)%c,d1=ug5_3412(i3,i4,i1,i2)%d,a2=r6
* _78(i7,i8)%a,b2=r6_78(i7,i8)%b,c2=r6_78(i7,i8)%c,d2=r6_78(i7,i8)%d,prq
* =p678q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=ug5_3412(i3,i4,i1,i2)%a(iut,1)+ug5_3412(i3,i4,i1,i2)%c
     & (iut,1)*rmass(id5)
      cx2=ug5_3412(i3,i4,i1,i2)%c(iut,2)*p678q+ug5_3412(i3,i4,i1
     & ,i2)%a(iut,2)*rmass(id5)
      cy1=ug5_3412(i3,i4,i1,i2)%b(iut,1)+ug5_3412(i3,i4,i1,i2)%d
     & (iut,1)*rmass(id5)
      cy2=ug5_3412(i3,i4,i1,i2)%d(iut,2)*p678q+ug5_3412(i3,i4,i1
     & ,i2)%b(iut,2)*rmass(id5)
      cw1=ug5_3412(i3,i4,i1,i2)%c(iut,1)*p678q+ug5_3412(i3,i4,i1
     & ,i2)%a(iut,1)*rmass(id5)
      cw2=ug5_3412(i3,i4,i1,i2)%a(iut,2)+ug5_3412(i3,i4,i1,i2)%c
     & (iut,2)*rmass(id5)
      cz1=ug5_3412(i3,i4,i1,i2)%d(iut,1)*p678q+ug5_3412(i3,i4,i1
     & ,i2)%b(iut,1)*rmass(id5)
      cz2=ug5_3412(i3,i4,i1,i2)%b(iut,2)+ug5_3412(i3,i4,i1,i2)%d
     & (iut,2)*rmass(id5)
      cline_3forks_56(i3,i4,i1,i2,i7,i8)%a(iut,1)=cx1*r6_78(i7,i
     & 8)%a(1,1)+cx2*r6_78(i7,i8)%b(2,1)
      cline_3forks_56(i3,i4,i1,i2,i7,i8)%b(iut,1)=cy1*r6_78(i7,i
     & 8)%a(1,1)+cy2*r6_78(i7,i8)%b(2,1)
      cline_3forks_56(i3,i4,i1,i2,i7,i8)%c(iut,1)=cw1*r6_78(i7,i
     & 8)%d(1,1)+cw2*r6_78(i7,i8)%c(2,1)
      cline_3forks_56(i3,i4,i1,i2,i7,i8)%d(iut,1)=cz1*r6_78(i7,i
     & 8)%d(1,1)+cz2*r6_78(i7,i8)%c(2,1)
      cline_3forks_56(i3,i4,i1,i2,i7,i8)%a(iut,2)=cw1*r6_78(i7,i
     & 8)%b(1,2)+cw2*r6_78(i7,i8)%a(2,2)
      cline_3forks_56(i3,i4,i1,i2,i7,i8)%b(iut,2)=cz1*r6_78(i7,i
     & 8)%b(1,2)+cz2*r6_78(i7,i8)%a(2,2)
      cline_3forks_56(i3,i4,i1,i2,i7,i8)%c(iut,2)=cx1*r6_78(i7,i
     & 8)%c(1,2)+cx2*r6_78(i7,i8)%d(2,2)
      cline_3forks_56(i3,i4,i1,i2,i7,i8)%d(iut,2)=cy1*r6_78(i7,i
     & 8)%c(1,2)+cy2*r6_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
      do i7=1,2
      do i8=1,2
* mline -- res=cres_3forks_56(i3,i4,i1,i2,i7,i8)%pol(&1,&2),abcd=cline_3
* forks_56(i3,i4,i1,i2,i7,i8)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_56(i3,i4,i1,i2,i7,i8)%pol(iut,jut)=cline_3fork
     & s_56(i3,i4,i1,i2,i7,i8)%a(iut,jut)+rmassl*cline_3forks_56
     & (i3,i4,i1,i2,i7,i8)%b(iut,jut)+rmassr*cline_3forks_56(i3,
     & i4,i1,i2,i7,i8)%c(iut,jut)+rmassl*rmassr*cline_3forks_56(
     & i3,i4,i1,i2,i7,i8)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) +
     &                     cres_3forks_56(i3,i4,i1,i2,i7,i8)
     &                     %pol(i5,i6)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id1.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TsTs -- aa=cline_3forks_56(i3,i4,i7,i8,i1,i2)%a,bb=cline_3forks_56(i3,
* i4,i7,i8,i1,i2)%b,cc=cline_3forks_56(i3,i4,i7,i8,i1,i2)%c,dd=cline_3fo
* rks_56(i3,i4,i7,i8,i1,i2)%d,a1=ug5_3478(i3,i4,i7,i8)%a,b1=ug5_3478(i3,
* i4,i7,i8)%b,c1=ug5_3478(i3,i4,i7,i8)%c,d1=ug5_3478(i3,i4,i7,i8)%d,a2=r
* 6_12(i1,i2)%a,b2=r6_12(i1,i2)%b,c2=r6_12(i1,i2)%c,d2=r6_12(i1,i2)%d,pr
* q=p612q,m=rmass(id5),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r6_12(i1,i2)%a(1,jut)+rmass(id5)*r6_12(i1,i2)%b(1,jut)
      cx2=r6_12(i1,i2)%a(2,jut)+rmass(id5)*r6_12(i1,i2)%b(2,jut)
      cy1=p612q*r6_12(i1,i2)%b(1,jut)+rmass(id5)*r6_12(i1,i2)%a(
     & 1,jut)
      cy2=p612q*r6_12(i1,i2)%b(2,jut)+rmass(id5)*r6_12(i1,i2)%a(
     & 2,jut)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%a(iut,jut)=ug5_3478(i3,
     & i4,i7,i8)%a(iut,1)*cx1+ug5_3478(i3,i4,i7,i8)%c(iut,1)*cy1
     & +ug5_3478(i3,i4,i7,i8)%a(iut,2)*cx2+ug5_3478(i3,i4,i7,i8)
     & %c(iut,2)*cy2
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%b(iut,jut)=ug5_3478(i3,
     & i4,i7,i8)%b(iut,1)*cx1+ug5_3478(i3,i4,i7,i8)%d(iut,1)*cy1
     & +ug5_3478(i3,i4,i7,i8)%b(iut,2)*cx2+ug5_3478(i3,i4,i7,i8)
     & %d(iut,2)*cy2
      cw1=r6_12(i1,i2)%c(1,jut)+rmass(id5)*r6_12(i1,i2)%d(1,jut)
      cw2=r6_12(i1,i2)%c(2,jut)+rmass(id5)*r6_12(i1,i2)%d(2,jut)
      cz1=p612q*r6_12(i1,i2)%d(1,jut)+rmass(id5)*r6_12(i1,i2)%c(
     & 1,jut)
      cz2=p612q*r6_12(i1,i2)%d(2,jut)+rmass(id5)*r6_12(i1,i2)%c(
     & 2,jut)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%c(iut,jut)=ug5_3478(i3,
     & i4,i7,i8)%a(iut,1)*cw1+ug5_3478(i3,i4,i7,i8)%c(iut,1)*cz1
     & +ug5_3478(i3,i4,i7,i8)%a(iut,2)*cw2+ug5_3478(i3,i4,i7,i8)
     & %c(iut,2)*cz2
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%d(iut,jut)=ug5_3478(i3,
     & i4,i7,i8)%b(iut,1)*cw1+ug5_3478(i3,i4,i7,i8)%d(iut,1)*cz1
     & +ug5_3478(i3,i4,i7,i8)%b(iut,2)*cw2+ug5_3478(i3,i4,i7,i8)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=cline_3forks_56(i3,i4,i7,i8,i1,i2)%a,bb=cline_3forks_56(i3,i
* 4,i7,i8,i1,i2)%b,cc=cline_3forks_56(i3,i4,i7,i8,i1,i2)%c,dd=cline_3for
* ks_56(i3,i4,i7,i8,i1,i2)%d,a1=ug5_3478(i3,i4,i7,i8)%a,b1=ug5_3478(i3,i
* 4,i7,i8)%b,c1=ug5_3478(i3,i4,i7,i8)%c,d1=ug5_3478(i3,i4,i7,i8)%d,a2=r6
* _12(i1,i2)%a,b2=r6_12(i1,i2)%b,c2=r6_12(i1,i2)%c,d2=r6_12(i1,i2)%d,prq
* =p612q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=ug5_3478(i3,i4,i7,i8)%a(iut,1)+ug5_3478(i3,i4,i7,i8)%c
     & (iut,1)*rmass(id5)
      cx2=ug5_3478(i3,i4,i7,i8)%c(iut,2)*p612q+ug5_3478(i3,i4,i7
     & ,i8)%a(iut,2)*rmass(id5)
      cy1=ug5_3478(i3,i4,i7,i8)%b(iut,1)+ug5_3478(i3,i4,i7,i8)%d
     & (iut,1)*rmass(id5)
      cy2=ug5_3478(i3,i4,i7,i8)%d(iut,2)*p612q+ug5_3478(i3,i4,i7
     & ,i8)%b(iut,2)*rmass(id5)
      cw1=ug5_3478(i3,i4,i7,i8)%c(iut,1)*p612q+ug5_3478(i3,i4,i7
     & ,i8)%a(iut,1)*rmass(id5)
      cw2=ug5_3478(i3,i4,i7,i8)%a(iut,2)+ug5_3478(i3,i4,i7,i8)%c
     & (iut,2)*rmass(id5)
      cz1=ug5_3478(i3,i4,i7,i8)%d(iut,1)*p612q+ug5_3478(i3,i4,i7
     & ,i8)%b(iut,1)*rmass(id5)
      cz2=ug5_3478(i3,i4,i7,i8)%b(iut,2)+ug5_3478(i3,i4,i7,i8)%d
     & (iut,2)*rmass(id5)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%a(iut,1)=cx1*r6_12(i1,i
     & 2)%a(1,1)+cx2*r6_12(i1,i2)%b(2,1)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%b(iut,1)=cy1*r6_12(i1,i
     & 2)%a(1,1)+cy2*r6_12(i1,i2)%b(2,1)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%c(iut,1)=cw1*r6_12(i1,i
     & 2)%d(1,1)+cw2*r6_12(i1,i2)%c(2,1)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%d(iut,1)=cz1*r6_12(i1,i
     & 2)%d(1,1)+cz2*r6_12(i1,i2)%c(2,1)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%a(iut,2)=cw1*r6_12(i1,i
     & 2)%b(1,2)+cw2*r6_12(i1,i2)%a(2,2)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%b(iut,2)=cz1*r6_12(i1,i
     & 2)%b(1,2)+cz2*r6_12(i1,i2)%a(2,2)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%c(iut,2)=cx1*r6_12(i1,i
     & 2)%c(1,2)+cx2*r6_12(i1,i2)%d(2,2)
      cline_3forks_56(i3,i4,i7,i8,i1,i2)%d(iut,2)=cy1*r6_12(i1,i
     & 2)%c(1,2)+cy2*r6_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
* mline -- res=cres_3forks_56(i3,i4,i7,i8,i1,i2)%pol(&1,&2),abcd=cline_3
* forks_56(i3,i4,i7,i8,i1,i2)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_56(i3,i4,i7,i8,i1,i2)%pol(iut,jut)=cline_3fork
     & s_56(i3,i4,i7,i8,i1,i2)%a(iut,jut)+rmassl*cline_3forks_56
     & (i3,i4,i7,i8,i1,i2)%b(iut,jut)+rmassr*cline_3forks_56(i3,
     & i4,i7,i8,i1,i2)%c(iut,jut)+rmassl*rmassr*cline_3forks_56(
     & i3,i4,i7,i8,i1,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,4) +
     &                     cres_3forks_56(i3,i4,i7,i8,i1,i2)
     &                     %pol(i5,i6)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
      endif    !if((ilept(id3).ne.1) .and. (ilept(id5).ne.1))
  
  
  
************************************************************************
******Color configuration no. 5 ***** [cres(...).caux(i7,i8,5)]*******  
************************************************************************
*                                                                       
*                           3| 1| 7| 5|                                 
*                            |  |~~|  |                                 
*                           4| 2| 8| 6|                                 
*                                                                       
*                                                                       
*Sum the diagrams belonging to classes 1), 2.a), 2.b), 2.c), 2.d) in    
*which the gluon connects Zlines 12 and 78                              
  
      if((ilept(id1).ne.1) .and. (ilept(id7).ne.1)) then
  
*****************Compute diagrams of class 1)***************************
*Link cg1234(2,2,2,2,0:3) with cg7856(2,2,2,2,0:3)                      
*     cg1256(2,2,2,2,0:3) with cg7834(2,2,2,2,0:3)                      
*The result is directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5)  
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5),p=cg1234(i1,i2,i3,i4,
* #),q=cg7856(i7,i8,i5,i6,#),bef=-,aft=/p1234q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5)=-(cg1234(i1,i2,i3,i4
     & ,0)*cg7856(i7,i8,i5,i6,0)-cg1234(i1,i2,i3,i4,1)*cg7856(i7
     & ,i8,i5,i6,1)-cg1234(i1,i2,i3,i4,2)*cg7856(i7,i8,i5,i6,2)-
     & cg1234(i1,i2,i3,i4,3)*cg7856(i7,i8,i5,i6,3))/p1234q
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5),p=cg1256(i1,i2,i5,i6,
* #),q=cg7834(i7,i8,i3,i4,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5)-,
* aft=/p1256q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,5)-(cg1256(i1,i2,i5,i6,0)*cg7834(i7,i8,i3,
     & i4,0)-cg1256(i1,i2,i5,i6,1)*cg7834(i7,i8,i3,i4,1)-cg1256(
     & i1,i2,i5,i6,2)*cg7834(i7,i8,i3,i4,2)-cg1256(i1,i2,i5,i6,3
     & )*cg7834(i7,i8,i3,i4,3))/p1256q
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
  
*****************Compute diagrams of class 2.a) and 2.b)****************
*                                                                       
* First compute subdiagrams of the type  [czqcd1278(2,2,2,2,0:3)]       
*                                        [cfqcd1278(2,2,2,2,0:3)]       
  
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TT -- aa=clinetzz(i1,i2,mu)%a,bb=clinetzz(i1,i2,mu)%b,cc=clinetzz(i1,i
* 2,mu)%c,dd=clinetzz(i1,i2,mu)%d,a1=lg7_12(i1,i2)%a,b1=lg7_12(i1,i2)%b,
* c1=lg7_12(i1,i2)%c,d1=lg7_12(i1,i2)%d,a2=rz8_712(mu)%a,b2=rz8_712(mu)%
* b,c2=rz8_712(mu)%c,d2=rz8_712(mu)%d,prq=p712q,m=rmass(id7),nsum=0
      clinetzz(i1,i2,mu)%a(1,1)=lg7_12(i1,i2)%a(1,1)*rz8_712(mu)
     & %a(1,1)+lg7_12(i1,i2)%c(1,2)*p712q*rz8_712(mu)%b(2,1)
      clinetzz(i1,i2,mu)%b(1,1)=rmass(id7)*(lg7_12(i1,i2)%d(1,1)
     & *rz8_712(mu)%a(1,1)+lg7_12(i1,i2)%b(1,2)*rz8_712(mu)%b(2,
     & 1))
      clinetzz(i1,i2,mu)%c(1,1)=rmass(id7)*(lg7_12(i1,i2)%a(1,1)
     & *rz8_712(mu)%d(1,1)+lg7_12(i1,i2)%c(1,2)*rz8_712(mu)%c(2,
     & 1))
      clinetzz(i1,i2,mu)%d(1,1)=lg7_12(i1,i2)%d(1,1)*p712q*rz8_7
     & 12(mu)%d(1,1)+lg7_12(i1,i2)%b(1,2)*rz8_712(mu)%c(2,1)
      clinetzz(i1,i2,mu)%a(1,2)=rmass(id7)*(lg7_12(i1,i2)%a(1,1)
     & *rz8_712(mu)%b(1,2)+lg7_12(i1,i2)%c(1,2)*rz8_712(mu)%a(2,
     & 2))
      clinetzz(i1,i2,mu)%b(1,2)=lg7_12(i1,i2)%d(1,1)*p712q*rz8_7
     & 12(mu)%b(1,2)+lg7_12(i1,i2)%b(1,2)*rz8_712(mu)%a(2,2)
      clinetzz(i1,i2,mu)%c(1,2)=lg7_12(i1,i2)%a(1,1)*rz8_712(mu)
     & %c(1,2)+lg7_12(i1,i2)%c(1,2)*p712q*rz8_712(mu)%d(2,2)
      clinetzz(i1,i2,mu)%d(1,2)=rmass(id7)*(lg7_12(i1,i2)%d(1,1)
     & *rz8_712(mu)%c(1,2)+lg7_12(i1,i2)%b(1,2)*rz8_712(mu)%d(2,
     & 2))
      clinetzz(i1,i2,mu)%a(2,1)=rmass(id7)*(lg7_12(i1,i2)%c(2,1)
     & *rz8_712(mu)%a(1,1)+lg7_12(i1,i2)%a(2,2)*rz8_712(mu)%b(2,
     & 1))
      clinetzz(i1,i2,mu)%b(2,1)=lg7_12(i1,i2)%b(2,1)*rz8_712(mu)
     & %a(1,1)+lg7_12(i1,i2)%d(2,2)*p712q*rz8_712(mu)%b(2,1)
      clinetzz(i1,i2,mu)%c(2,1)=lg7_12(i1,i2)%c(2,1)*p712q*rz8_7
     & 12(mu)%d(1,1)+lg7_12(i1,i2)%a(2,2)*rz8_712(mu)%c(2,1)
      clinetzz(i1,i2,mu)%d(2,1)=rmass(id7)*(lg7_12(i1,i2)%b(2,1)
     & *rz8_712(mu)%d(1,1)+lg7_12(i1,i2)%d(2,2)*rz8_712(mu)%c(2,
     & 1))
      clinetzz(i1,i2,mu)%a(2,2)=lg7_12(i1,i2)%c(2,1)*p712q*rz8_7
     & 12(mu)%b(1,2)+lg7_12(i1,i2)%a(2,2)*rz8_712(mu)%a(2,2)
      clinetzz(i1,i2,mu)%b(2,2)=rmass(id7)*(lg7_12(i1,i2)%b(2,1)
     & *rz8_712(mu)%b(1,2)+lg7_12(i1,i2)%d(2,2)*rz8_712(mu)%a(2,
     & 2))
      clinetzz(i1,i2,mu)%c(2,2)=rmass(id7)*(lg7_12(i1,i2)%c(2,1)
     & *rz8_712(mu)%c(1,2)+lg7_12(i1,i2)%a(2,2)*rz8_712(mu)%d(2,
     & 2))
      clinetzz(i1,i2,mu)%d(2,2)=lg7_12(i1,i2)%b(2,1)*rz8_712(mu)
     & %c(1,2)+lg7_12(i1,i2)%d(2,2)*p712q*rz8_712(mu)%d(2,2)
      end do
      end do
      end do
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TT -- aa=clinetzz(i1,i2,mu)%a,bb=clinetzz(i1,i2,mu)%b,cc=clinetzz(i1,i
* 2,mu)%c,dd=clinetzz(i1,i2,mu)%d,a1=lz7_812(mu)%a,b1=lz7_812(mu)%b,c1=l
* z7_812(mu)%c,d1=lz7_812(mu)%d,a2=rg8_12(i1,i2)%a,b2=rg8_12(i1,i2)%b,c2
* =rg8_12(i1,i2)%c,d2=rg8_12(i1,i2)%d,prq=p812q,m=rmass(id7),nsum=1
      clinetzz(i1,i2,mu)%a(1,1)=clinetzz(i1,i2,mu)%a(1,1)+lz7_81
     & 2(mu)%a(1,1)*rg8_12(i1,i2)%a(1,1)+lz7_812(mu)%c(1,2)*p812
     & q*rg8_12(i1,i2)%b(2,1)
      clinetzz(i1,i2,mu)%b(1,1)=clinetzz(i1,i2,mu)%b(1,1)+rmass(
     & id7)*(lz7_812(mu)%d(1,1)*rg8_12(i1,i2)%a(1,1)+lz7_812(mu)
     & %b(1,2)*rg8_12(i1,i2)%b(2,1))
      clinetzz(i1,i2,mu)%c(1,1)=clinetzz(i1,i2,mu)%c(1,1)+rmass(
     & id7)*(lz7_812(mu)%a(1,1)*rg8_12(i1,i2)%d(1,1)+lz7_812(mu)
     & %c(1,2)*rg8_12(i1,i2)%c(2,1))
      clinetzz(i1,i2,mu)%d(1,1)=clinetzz(i1,i2,mu)%d(1,1)+lz7_81
     & 2(mu)%d(1,1)*p812q*rg8_12(i1,i2)%d(1,1)+lz7_812(mu)%b(1,2
     & )*rg8_12(i1,i2)%c(2,1)
      clinetzz(i1,i2,mu)%a(1,2)=clinetzz(i1,i2,mu)%a(1,2)+rmass(
     & id7)*(lz7_812(mu)%a(1,1)*rg8_12(i1,i2)%b(1,2)+lz7_812(mu)
     & %c(1,2)*rg8_12(i1,i2)%a(2,2))
      clinetzz(i1,i2,mu)%b(1,2)=clinetzz(i1,i2,mu)%b(1,2)+lz7_81
     & 2(mu)%d(1,1)*p812q*rg8_12(i1,i2)%b(1,2)+lz7_812(mu)%b(1,2
     & )*rg8_12(i1,i2)%a(2,2)
      clinetzz(i1,i2,mu)%c(1,2)=clinetzz(i1,i2,mu)%c(1,2)+lz7_81
     & 2(mu)%a(1,1)*rg8_12(i1,i2)%c(1,2)+lz7_812(mu)%c(1,2)*p812
     & q*rg8_12(i1,i2)%d(2,2)
      clinetzz(i1,i2,mu)%d(1,2)=clinetzz(i1,i2,mu)%d(1,2)+rmass(
     & id7)*(lz7_812(mu)%d(1,1)*rg8_12(i1,i2)%c(1,2)+lz7_812(mu)
     & %b(1,2)*rg8_12(i1,i2)%d(2,2))
      clinetzz(i1,i2,mu)%a(2,1)=clinetzz(i1,i2,mu)%a(2,1)+rmass(
     & id7)*(lz7_812(mu)%c(2,1)*rg8_12(i1,i2)%a(1,1)+lz7_812(mu)
     & %a(2,2)*rg8_12(i1,i2)%b(2,1))
      clinetzz(i1,i2,mu)%b(2,1)=clinetzz(i1,i2,mu)%b(2,1)+lz7_81
     & 2(mu)%b(2,1)*rg8_12(i1,i2)%a(1,1)+lz7_812(mu)%d(2,2)*p812
     & q*rg8_12(i1,i2)%b(2,1)
      clinetzz(i1,i2,mu)%c(2,1)=clinetzz(i1,i2,mu)%c(2,1)+lz7_81
     & 2(mu)%c(2,1)*p812q*rg8_12(i1,i2)%d(1,1)+lz7_812(mu)%a(2,2
     & )*rg8_12(i1,i2)%c(2,1)
      clinetzz(i1,i2,mu)%d(2,1)=clinetzz(i1,i2,mu)%d(2,1)+rmass(
     & id7)*(lz7_812(mu)%b(2,1)*rg8_12(i1,i2)%d(1,1)+lz7_812(mu)
     & %d(2,2)*rg8_12(i1,i2)%c(2,1))
      clinetzz(i1,i2,mu)%a(2,2)=clinetzz(i1,i2,mu)%a(2,2)+lz7_81
     & 2(mu)%c(2,1)*p812q*rg8_12(i1,i2)%b(1,2)+lz7_812(mu)%a(2,2
     & )*rg8_12(i1,i2)%a(2,2)
      clinetzz(i1,i2,mu)%b(2,2)=clinetzz(i1,i2,mu)%b(2,2)+rmass(
     & id7)*(lz7_812(mu)%b(2,1)*rg8_12(i1,i2)%b(1,2)+lz7_812(mu)
     & %d(2,2)*rg8_12(i1,i2)%a(2,2))
      clinetzz(i1,i2,mu)%c(2,2)=clinetzz(i1,i2,mu)%c(2,2)+rmass(
     & id7)*(lz7_812(mu)%c(2,1)*rg8_12(i1,i2)%c(1,2)+lz7_812(mu)
     & %a(2,2)*rg8_12(i1,i2)%d(2,2))
      clinetzz(i1,i2,mu)%d(2,2)=clinetzz(i1,i2,mu)%d(2,2)+lz7_81
     & 2(mu)%b(2,1)*rg8_12(i1,i2)%c(1,2)+lz7_812(mu)%d(2,2)*p812
     & q*rg8_12(i1,i2)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id7)
      rmassr=-rmass(id7)
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=czqcd1278(i1,i2,&1,&2,mu),abcd=clinetzz(i1,i2,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      czqcd1278(i1,i2,iut,jut,mu)=clinetzz(i1,i2,mu)%a(iut,jut)+
     & rmassl*clinetzz(i1,i2,mu)%b(iut,jut)+rmassr*clinetzz(i1,i
     & 2,mu)%c(iut,jut)+rmassl*rmassr*clinetzz(i1,i2,mu)%d(iut,j
     & ut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TT -- aa=clinetzz(i7,i8,mu)%a,bb=clinetzz(i7,i8,mu)%b,cc=clinetzz(i7,i
* 8,mu)%c,dd=clinetzz(i7,i8,mu)%d,a1=lg1_78(i7,i8)%a,b1=lg1_78(i7,i8)%b,
* c1=lg1_78(i7,i8)%c,d1=lg1_78(i7,i8)%d,a2=rz2_178(mu)%a,b2=rz2_178(mu)%
* b,c2=rz2_178(mu)%c,d2=rz2_178(mu)%d,prq=p178q,m=rmass(id1),nsum=0
      clinetzz(i7,i8,mu)%a(1,1)=lg1_78(i7,i8)%a(1,1)*rz2_178(mu)
     & %a(1,1)+lg1_78(i7,i8)%c(1,2)*p178q*rz2_178(mu)%b(2,1)
      clinetzz(i7,i8,mu)%b(1,1)=rmass(id1)*(lg1_78(i7,i8)%d(1,1)
     & *rz2_178(mu)%a(1,1)+lg1_78(i7,i8)%b(1,2)*rz2_178(mu)%b(2,
     & 1))
      clinetzz(i7,i8,mu)%c(1,1)=rmass(id1)*(lg1_78(i7,i8)%a(1,1)
     & *rz2_178(mu)%d(1,1)+lg1_78(i7,i8)%c(1,2)*rz2_178(mu)%c(2,
     & 1))
      clinetzz(i7,i8,mu)%d(1,1)=lg1_78(i7,i8)%d(1,1)*p178q*rz2_1
     & 78(mu)%d(1,1)+lg1_78(i7,i8)%b(1,2)*rz2_178(mu)%c(2,1)
      clinetzz(i7,i8,mu)%a(1,2)=rmass(id1)*(lg1_78(i7,i8)%a(1,1)
     & *rz2_178(mu)%b(1,2)+lg1_78(i7,i8)%c(1,2)*rz2_178(mu)%a(2,
     & 2))
      clinetzz(i7,i8,mu)%b(1,2)=lg1_78(i7,i8)%d(1,1)*p178q*rz2_1
     & 78(mu)%b(1,2)+lg1_78(i7,i8)%b(1,2)*rz2_178(mu)%a(2,2)
      clinetzz(i7,i8,mu)%c(1,2)=lg1_78(i7,i8)%a(1,1)*rz2_178(mu)
     & %c(1,2)+lg1_78(i7,i8)%c(1,2)*p178q*rz2_178(mu)%d(2,2)
      clinetzz(i7,i8,mu)%d(1,2)=rmass(id1)*(lg1_78(i7,i8)%d(1,1)
     & *rz2_178(mu)%c(1,2)+lg1_78(i7,i8)%b(1,2)*rz2_178(mu)%d(2,
     & 2))
      clinetzz(i7,i8,mu)%a(2,1)=rmass(id1)*(lg1_78(i7,i8)%c(2,1)
     & *rz2_178(mu)%a(1,1)+lg1_78(i7,i8)%a(2,2)*rz2_178(mu)%b(2,
     & 1))
      clinetzz(i7,i8,mu)%b(2,1)=lg1_78(i7,i8)%b(2,1)*rz2_178(mu)
     & %a(1,1)+lg1_78(i7,i8)%d(2,2)*p178q*rz2_178(mu)%b(2,1)
      clinetzz(i7,i8,mu)%c(2,1)=lg1_78(i7,i8)%c(2,1)*p178q*rz2_1
     & 78(mu)%d(1,1)+lg1_78(i7,i8)%a(2,2)*rz2_178(mu)%c(2,1)
      clinetzz(i7,i8,mu)%d(2,1)=rmass(id1)*(lg1_78(i7,i8)%b(2,1)
     & *rz2_178(mu)%d(1,1)+lg1_78(i7,i8)%d(2,2)*rz2_178(mu)%c(2,
     & 1))
      clinetzz(i7,i8,mu)%a(2,2)=lg1_78(i7,i8)%c(2,1)*p178q*rz2_1
     & 78(mu)%b(1,2)+lg1_78(i7,i8)%a(2,2)*rz2_178(mu)%a(2,2)
      clinetzz(i7,i8,mu)%b(2,2)=rmass(id1)*(lg1_78(i7,i8)%b(2,1)
     & *rz2_178(mu)%b(1,2)+lg1_78(i7,i8)%d(2,2)*rz2_178(mu)%a(2,
     & 2))
      clinetzz(i7,i8,mu)%c(2,2)=rmass(id1)*(lg1_78(i7,i8)%c(2,1)
     & *rz2_178(mu)%c(1,2)+lg1_78(i7,i8)%a(2,2)*rz2_178(mu)%d(2,
     & 2))
      clinetzz(i7,i8,mu)%d(2,2)=lg1_78(i7,i8)%b(2,1)*rz2_178(mu)
     & %c(1,2)+lg1_78(i7,i8)%d(2,2)*p178q*rz2_178(mu)%d(2,2)
      end do
      end do
      end do
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TT -- aa=clinetzz(i7,i8,mu)%a,bb=clinetzz(i7,i8,mu)%b,cc=clinetzz(i7,i
* 8,mu)%c,dd=clinetzz(i7,i8,mu)%d,a1=lz1_278(mu)%a,b1=lz1_278(mu)%b,c1=l
* z1_278(mu)%c,d1=lz1_278(mu)%d,a2=rg2_78(i7,i8)%a,b2=rg2_78(i7,i8)%b,c2
* =rg2_78(i7,i8)%c,d2=rg2_78(i7,i8)%d,prq=p278q,m=rmass(id1),nsum=1
      clinetzz(i7,i8,mu)%a(1,1)=clinetzz(i7,i8,mu)%a(1,1)+lz1_27
     & 8(mu)%a(1,1)*rg2_78(i7,i8)%a(1,1)+lz1_278(mu)%c(1,2)*p278
     & q*rg2_78(i7,i8)%b(2,1)
      clinetzz(i7,i8,mu)%b(1,1)=clinetzz(i7,i8,mu)%b(1,1)+rmass(
     & id1)*(lz1_278(mu)%d(1,1)*rg2_78(i7,i8)%a(1,1)+lz1_278(mu)
     & %b(1,2)*rg2_78(i7,i8)%b(2,1))
      clinetzz(i7,i8,mu)%c(1,1)=clinetzz(i7,i8,mu)%c(1,1)+rmass(
     & id1)*(lz1_278(mu)%a(1,1)*rg2_78(i7,i8)%d(1,1)+lz1_278(mu)
     & %c(1,2)*rg2_78(i7,i8)%c(2,1))
      clinetzz(i7,i8,mu)%d(1,1)=clinetzz(i7,i8,mu)%d(1,1)+lz1_27
     & 8(mu)%d(1,1)*p278q*rg2_78(i7,i8)%d(1,1)+lz1_278(mu)%b(1,2
     & )*rg2_78(i7,i8)%c(2,1)
      clinetzz(i7,i8,mu)%a(1,2)=clinetzz(i7,i8,mu)%a(1,2)+rmass(
     & id1)*(lz1_278(mu)%a(1,1)*rg2_78(i7,i8)%b(1,2)+lz1_278(mu)
     & %c(1,2)*rg2_78(i7,i8)%a(2,2))
      clinetzz(i7,i8,mu)%b(1,2)=clinetzz(i7,i8,mu)%b(1,2)+lz1_27
     & 8(mu)%d(1,1)*p278q*rg2_78(i7,i8)%b(1,2)+lz1_278(mu)%b(1,2
     & )*rg2_78(i7,i8)%a(2,2)
      clinetzz(i7,i8,mu)%c(1,2)=clinetzz(i7,i8,mu)%c(1,2)+lz1_27
     & 8(mu)%a(1,1)*rg2_78(i7,i8)%c(1,2)+lz1_278(mu)%c(1,2)*p278
     & q*rg2_78(i7,i8)%d(2,2)
      clinetzz(i7,i8,mu)%d(1,2)=clinetzz(i7,i8,mu)%d(1,2)+rmass(
     & id1)*(lz1_278(mu)%d(1,1)*rg2_78(i7,i8)%c(1,2)+lz1_278(mu)
     & %b(1,2)*rg2_78(i7,i8)%d(2,2))
      clinetzz(i7,i8,mu)%a(2,1)=clinetzz(i7,i8,mu)%a(2,1)+rmass(
     & id1)*(lz1_278(mu)%c(2,1)*rg2_78(i7,i8)%a(1,1)+lz1_278(mu)
     & %a(2,2)*rg2_78(i7,i8)%b(2,1))
      clinetzz(i7,i8,mu)%b(2,1)=clinetzz(i7,i8,mu)%b(2,1)+lz1_27
     & 8(mu)%b(2,1)*rg2_78(i7,i8)%a(1,1)+lz1_278(mu)%d(2,2)*p278
     & q*rg2_78(i7,i8)%b(2,1)
      clinetzz(i7,i8,mu)%c(2,1)=clinetzz(i7,i8,mu)%c(2,1)+lz1_27
     & 8(mu)%c(2,1)*p278q*rg2_78(i7,i8)%d(1,1)+lz1_278(mu)%a(2,2
     & )*rg2_78(i7,i8)%c(2,1)
      clinetzz(i7,i8,mu)%d(2,1)=clinetzz(i7,i8,mu)%d(2,1)+rmass(
     & id1)*(lz1_278(mu)%b(2,1)*rg2_78(i7,i8)%d(1,1)+lz1_278(mu)
     & %d(2,2)*rg2_78(i7,i8)%c(2,1))
      clinetzz(i7,i8,mu)%a(2,2)=clinetzz(i7,i8,mu)%a(2,2)+lz1_27
     & 8(mu)%c(2,1)*p278q*rg2_78(i7,i8)%b(1,2)+lz1_278(mu)%a(2,2
     & )*rg2_78(i7,i8)%a(2,2)
      clinetzz(i7,i8,mu)%b(2,2)=clinetzz(i7,i8,mu)%b(2,2)+rmass(
     & id1)*(lz1_278(mu)%b(2,1)*rg2_78(i7,i8)%b(1,2)+lz1_278(mu)
     & %d(2,2)*rg2_78(i7,i8)%a(2,2))
      clinetzz(i7,i8,mu)%c(2,2)=clinetzz(i7,i8,mu)%c(2,2)+rmass(
     & id1)*(lz1_278(mu)%c(2,1)*rg2_78(i7,i8)%c(1,2)+lz1_278(mu)
     & %a(2,2)*rg2_78(i7,i8)%d(2,2))
      clinetzz(i7,i8,mu)%d(2,2)=clinetzz(i7,i8,mu)%d(2,2)+lz1_27
     & 8(mu)%b(2,1)*rg2_78(i7,i8)%c(1,2)+lz1_278(mu)%d(2,2)*p278
     & q*rg2_78(i7,i8)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id1)
      rmassr=-rmass(id1)
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* mline -- res=czqcd1278(&1,&2,i7,i8,mu),abcd=clinetzz(i7,i8,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      czqcd1278(iut,jut,i7,i8,mu)=czqcd1278(iut,jut,i7,i8,mu)+cl
     & inetzz(i7,i8,mu)%a(iut,jut)+rmassl*clinetzz(i7,i8,mu)%b(i
     & ut,jut)+rmassr*clinetzz(i7,i8,mu)%c(iut,jut)+rmassl*rmass
     & r*clinetzz(i7,i8,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TT -- aa=clinetfz(i1,i2,mu)%a,bb=clinetfz(i1,i2,mu)%b,cc=clinetfz(i1,i
* 2,mu)%c,dd=clinetfz(i1,i2,mu)%d,a1=lg7_12(i1,i2)%a,b1=lg7_12(i1,i2)%b,
* c1=lg7_12(i1,i2)%c,d1=lg7_12(i1,i2)%d,a2=rf8_712(mu)%a,b2=rf8_712(mu)%
* b,c2=rf8_712(mu)%c,d2=rf8_712(mu)%d,prq=p712q,m=rmass(id7),nsum=0
      clinetfz(i1,i2,mu)%a(1,1)=lg7_12(i1,i2)%a(1,1)*rf8_712(mu)
     & %a(1,1)+lg7_12(i1,i2)%c(1,2)*p712q*rf8_712(mu)%b(2,1)
      clinetfz(i1,i2,mu)%b(1,1)=rmass(id7)*(lg7_12(i1,i2)%d(1,1)
     & *rf8_712(mu)%a(1,1)+lg7_12(i1,i2)%b(1,2)*rf8_712(mu)%b(2,
     & 1))
      clinetfz(i1,i2,mu)%c(1,1)=rmass(id7)*(lg7_12(i1,i2)%a(1,1)
     & *rf8_712(mu)%d(1,1)+lg7_12(i1,i2)%c(1,2)*rf8_712(mu)%c(2,
     & 1))
      clinetfz(i1,i2,mu)%d(1,1)=lg7_12(i1,i2)%d(1,1)*p712q*rf8_7
     & 12(mu)%d(1,1)+lg7_12(i1,i2)%b(1,2)*rf8_712(mu)%c(2,1)
      clinetfz(i1,i2,mu)%a(1,2)=rmass(id7)*(lg7_12(i1,i2)%a(1,1)
     & *rf8_712(mu)%b(1,2)+lg7_12(i1,i2)%c(1,2)*rf8_712(mu)%a(2,
     & 2))
      clinetfz(i1,i2,mu)%b(1,2)=lg7_12(i1,i2)%d(1,1)*p712q*rf8_7
     & 12(mu)%b(1,2)+lg7_12(i1,i2)%b(1,2)*rf8_712(mu)%a(2,2)
      clinetfz(i1,i2,mu)%c(1,2)=lg7_12(i1,i2)%a(1,1)*rf8_712(mu)
     & %c(1,2)+lg7_12(i1,i2)%c(1,2)*p712q*rf8_712(mu)%d(2,2)
      clinetfz(i1,i2,mu)%d(1,2)=rmass(id7)*(lg7_12(i1,i2)%d(1,1)
     & *rf8_712(mu)%c(1,2)+lg7_12(i1,i2)%b(1,2)*rf8_712(mu)%d(2,
     & 2))
      clinetfz(i1,i2,mu)%a(2,1)=rmass(id7)*(lg7_12(i1,i2)%c(2,1)
     & *rf8_712(mu)%a(1,1)+lg7_12(i1,i2)%a(2,2)*rf8_712(mu)%b(2,
     & 1))
      clinetfz(i1,i2,mu)%b(2,1)=lg7_12(i1,i2)%b(2,1)*rf8_712(mu)
     & %a(1,1)+lg7_12(i1,i2)%d(2,2)*p712q*rf8_712(mu)%b(2,1)
      clinetfz(i1,i2,mu)%c(2,1)=lg7_12(i1,i2)%c(2,1)*p712q*rf8_7
     & 12(mu)%d(1,1)+lg7_12(i1,i2)%a(2,2)*rf8_712(mu)%c(2,1)
      clinetfz(i1,i2,mu)%d(2,1)=rmass(id7)*(lg7_12(i1,i2)%b(2,1)
     & *rf8_712(mu)%d(1,1)+lg7_12(i1,i2)%d(2,2)*rf8_712(mu)%c(2,
     & 1))
      clinetfz(i1,i2,mu)%a(2,2)=lg7_12(i1,i2)%c(2,1)*p712q*rf8_7
     & 12(mu)%b(1,2)+lg7_12(i1,i2)%a(2,2)*rf8_712(mu)%a(2,2)
      clinetfz(i1,i2,mu)%b(2,2)=rmass(id7)*(lg7_12(i1,i2)%b(2,1)
     & *rf8_712(mu)%b(1,2)+lg7_12(i1,i2)%d(2,2)*rf8_712(mu)%a(2,
     & 2))
      clinetfz(i1,i2,mu)%c(2,2)=rmass(id7)*(lg7_12(i1,i2)%c(2,1)
     & *rf8_712(mu)%c(1,2)+lg7_12(i1,i2)%a(2,2)*rf8_712(mu)%d(2,
     & 2))
      clinetfz(i1,i2,mu)%d(2,2)=lg7_12(i1,i2)%b(2,1)*rf8_712(mu)
     & %c(1,2)+lg7_12(i1,i2)%d(2,2)*p712q*rf8_712(mu)%d(2,2)
      end do
      end do
      end do
      do i1=1,2
      do i2=1,2
      do mu=0,3
* TT -- aa=clinetfz(i1,i2,mu)%a,bb=clinetfz(i1,i2,mu)%b,cc=clinetfz(i1,i
* 2,mu)%c,dd=clinetfz(i1,i2,mu)%d,a1=lf7_812(mu)%a,b1=lf7_812(mu)%b,c1=l
* f7_812(mu)%c,d1=lf7_812(mu)%d,a2=rg8_12(i1,i2)%a,b2=rg8_12(i1,i2)%b,c2
* =rg8_12(i1,i2)%c,d2=rg8_12(i1,i2)%d,prq=p812q,m=rmass(id7),nsum=1
      clinetfz(i1,i2,mu)%a(1,1)=clinetfz(i1,i2,mu)%a(1,1)+lf7_81
     & 2(mu)%a(1,1)*rg8_12(i1,i2)%a(1,1)+lf7_812(mu)%c(1,2)*p812
     & q*rg8_12(i1,i2)%b(2,1)
      clinetfz(i1,i2,mu)%b(1,1)=clinetfz(i1,i2,mu)%b(1,1)+rmass(
     & id7)*(lf7_812(mu)%d(1,1)*rg8_12(i1,i2)%a(1,1)+lf7_812(mu)
     & %b(1,2)*rg8_12(i1,i2)%b(2,1))
      clinetfz(i1,i2,mu)%c(1,1)=clinetfz(i1,i2,mu)%c(1,1)+rmass(
     & id7)*(lf7_812(mu)%a(1,1)*rg8_12(i1,i2)%d(1,1)+lf7_812(mu)
     & %c(1,2)*rg8_12(i1,i2)%c(2,1))
      clinetfz(i1,i2,mu)%d(1,1)=clinetfz(i1,i2,mu)%d(1,1)+lf7_81
     & 2(mu)%d(1,1)*p812q*rg8_12(i1,i2)%d(1,1)+lf7_812(mu)%b(1,2
     & )*rg8_12(i1,i2)%c(2,1)
      clinetfz(i1,i2,mu)%a(1,2)=clinetfz(i1,i2,mu)%a(1,2)+rmass(
     & id7)*(lf7_812(mu)%a(1,1)*rg8_12(i1,i2)%b(1,2)+lf7_812(mu)
     & %c(1,2)*rg8_12(i1,i2)%a(2,2))
      clinetfz(i1,i2,mu)%b(1,2)=clinetfz(i1,i2,mu)%b(1,2)+lf7_81
     & 2(mu)%d(1,1)*p812q*rg8_12(i1,i2)%b(1,2)+lf7_812(mu)%b(1,2
     & )*rg8_12(i1,i2)%a(2,2)
      clinetfz(i1,i2,mu)%c(1,2)=clinetfz(i1,i2,mu)%c(1,2)+lf7_81
     & 2(mu)%a(1,1)*rg8_12(i1,i2)%c(1,2)+lf7_812(mu)%c(1,2)*p812
     & q*rg8_12(i1,i2)%d(2,2)
      clinetfz(i1,i2,mu)%d(1,2)=clinetfz(i1,i2,mu)%d(1,2)+rmass(
     & id7)*(lf7_812(mu)%d(1,1)*rg8_12(i1,i2)%c(1,2)+lf7_812(mu)
     & %b(1,2)*rg8_12(i1,i2)%d(2,2))
      clinetfz(i1,i2,mu)%a(2,1)=clinetfz(i1,i2,mu)%a(2,1)+rmass(
     & id7)*(lf7_812(mu)%c(2,1)*rg8_12(i1,i2)%a(1,1)+lf7_812(mu)
     & %a(2,2)*rg8_12(i1,i2)%b(2,1))
      clinetfz(i1,i2,mu)%b(2,1)=clinetfz(i1,i2,mu)%b(2,1)+lf7_81
     & 2(mu)%b(2,1)*rg8_12(i1,i2)%a(1,1)+lf7_812(mu)%d(2,2)*p812
     & q*rg8_12(i1,i2)%b(2,1)
      clinetfz(i1,i2,mu)%c(2,1)=clinetfz(i1,i2,mu)%c(2,1)+lf7_81
     & 2(mu)%c(2,1)*p812q*rg8_12(i1,i2)%d(1,1)+lf7_812(mu)%a(2,2
     & )*rg8_12(i1,i2)%c(2,1)
      clinetfz(i1,i2,mu)%d(2,1)=clinetfz(i1,i2,mu)%d(2,1)+rmass(
     & id7)*(lf7_812(mu)%b(2,1)*rg8_12(i1,i2)%d(1,1)+lf7_812(mu)
     & %d(2,2)*rg8_12(i1,i2)%c(2,1))
      clinetfz(i1,i2,mu)%a(2,2)=clinetfz(i1,i2,mu)%a(2,2)+lf7_81
     & 2(mu)%c(2,1)*p812q*rg8_12(i1,i2)%b(1,2)+lf7_812(mu)%a(2,2
     & )*rg8_12(i1,i2)%a(2,2)
      clinetfz(i1,i2,mu)%b(2,2)=clinetfz(i1,i2,mu)%b(2,2)+rmass(
     & id7)*(lf7_812(mu)%b(2,1)*rg8_12(i1,i2)%b(1,2)+lf7_812(mu)
     & %d(2,2)*rg8_12(i1,i2)%a(2,2))
      clinetfz(i1,i2,mu)%c(2,2)=clinetfz(i1,i2,mu)%c(2,2)+rmass(
     & id7)*(lf7_812(mu)%c(2,1)*rg8_12(i1,i2)%c(1,2)+lf7_812(mu)
     & %a(2,2)*rg8_12(i1,i2)%d(2,2))
      clinetfz(i1,i2,mu)%d(2,2)=clinetfz(i1,i2,mu)%d(2,2)+lf7_81
     & 2(mu)%b(2,1)*rg8_12(i1,i2)%c(1,2)+lf7_812(mu)%d(2,2)*p812
     & q*rg8_12(i1,i2)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id7)
      rmassr=-rmass(id7)
  
      do i1=1,2
      do i2=1,2
      do mu=0,3
* mline -- res=cfqcd1278(i1,i2,&1,&2,mu),abcd=clinetfz(i1,i2,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cfqcd1278(i1,i2,iut,jut,mu)=clinetfz(i1,i2,mu)%a(iut,jut)+
     & rmassl*clinetfz(i1,i2,mu)%b(iut,jut)+rmassr*clinetfz(i1,i
     & 2,mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i1,i2,mu)%d(iut,j
     & ut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TT -- aa=clinetfz(i7,i8,mu)%a,bb=clinetfz(i7,i8,mu)%b,cc=clinetfz(i7,i
* 8,mu)%c,dd=clinetfz(i7,i8,mu)%d,a1=lg1_78(i7,i8)%a,b1=lg1_78(i7,i8)%b,
* c1=lg1_78(i7,i8)%c,d1=lg1_78(i7,i8)%d,a2=rf2_178(mu)%a,b2=rf2_178(mu)%
* b,c2=rf2_178(mu)%c,d2=rf2_178(mu)%d,prq=p178q,m=rmass(id1),nsum=0
      clinetfz(i7,i8,mu)%a(1,1)=lg1_78(i7,i8)%a(1,1)*rf2_178(mu)
     & %a(1,1)+lg1_78(i7,i8)%c(1,2)*p178q*rf2_178(mu)%b(2,1)
      clinetfz(i7,i8,mu)%b(1,1)=rmass(id1)*(lg1_78(i7,i8)%d(1,1)
     & *rf2_178(mu)%a(1,1)+lg1_78(i7,i8)%b(1,2)*rf2_178(mu)%b(2,
     & 1))
      clinetfz(i7,i8,mu)%c(1,1)=rmass(id1)*(lg1_78(i7,i8)%a(1,1)
     & *rf2_178(mu)%d(1,1)+lg1_78(i7,i8)%c(1,2)*rf2_178(mu)%c(2,
     & 1))
      clinetfz(i7,i8,mu)%d(1,1)=lg1_78(i7,i8)%d(1,1)*p178q*rf2_1
     & 78(mu)%d(1,1)+lg1_78(i7,i8)%b(1,2)*rf2_178(mu)%c(2,1)
      clinetfz(i7,i8,mu)%a(1,2)=rmass(id1)*(lg1_78(i7,i8)%a(1,1)
     & *rf2_178(mu)%b(1,2)+lg1_78(i7,i8)%c(1,2)*rf2_178(mu)%a(2,
     & 2))
      clinetfz(i7,i8,mu)%b(1,2)=lg1_78(i7,i8)%d(1,1)*p178q*rf2_1
     & 78(mu)%b(1,2)+lg1_78(i7,i8)%b(1,2)*rf2_178(mu)%a(2,2)
      clinetfz(i7,i8,mu)%c(1,2)=lg1_78(i7,i8)%a(1,1)*rf2_178(mu)
     & %c(1,2)+lg1_78(i7,i8)%c(1,2)*p178q*rf2_178(mu)%d(2,2)
      clinetfz(i7,i8,mu)%d(1,2)=rmass(id1)*(lg1_78(i7,i8)%d(1,1)
     & *rf2_178(mu)%c(1,2)+lg1_78(i7,i8)%b(1,2)*rf2_178(mu)%d(2,
     & 2))
      clinetfz(i7,i8,mu)%a(2,1)=rmass(id1)*(lg1_78(i7,i8)%c(2,1)
     & *rf2_178(mu)%a(1,1)+lg1_78(i7,i8)%a(2,2)*rf2_178(mu)%b(2,
     & 1))
      clinetfz(i7,i8,mu)%b(2,1)=lg1_78(i7,i8)%b(2,1)*rf2_178(mu)
     & %a(1,1)+lg1_78(i7,i8)%d(2,2)*p178q*rf2_178(mu)%b(2,1)
      clinetfz(i7,i8,mu)%c(2,1)=lg1_78(i7,i8)%c(2,1)*p178q*rf2_1
     & 78(mu)%d(1,1)+lg1_78(i7,i8)%a(2,2)*rf2_178(mu)%c(2,1)
      clinetfz(i7,i8,mu)%d(2,1)=rmass(id1)*(lg1_78(i7,i8)%b(2,1)
     & *rf2_178(mu)%d(1,1)+lg1_78(i7,i8)%d(2,2)*rf2_178(mu)%c(2,
     & 1))
      clinetfz(i7,i8,mu)%a(2,2)=lg1_78(i7,i8)%c(2,1)*p178q*rf2_1
     & 78(mu)%b(1,2)+lg1_78(i7,i8)%a(2,2)*rf2_178(mu)%a(2,2)
      clinetfz(i7,i8,mu)%b(2,2)=rmass(id1)*(lg1_78(i7,i8)%b(2,1)
     & *rf2_178(mu)%b(1,2)+lg1_78(i7,i8)%d(2,2)*rf2_178(mu)%a(2,
     & 2))
      clinetfz(i7,i8,mu)%c(2,2)=rmass(id1)*(lg1_78(i7,i8)%c(2,1)
     & *rf2_178(mu)%c(1,2)+lg1_78(i7,i8)%a(2,2)*rf2_178(mu)%d(2,
     & 2))
      clinetfz(i7,i8,mu)%d(2,2)=lg1_78(i7,i8)%b(2,1)*rf2_178(mu)
     & %c(1,2)+lg1_78(i7,i8)%d(2,2)*p178q*rf2_178(mu)%d(2,2)
      end do
      end do
      end do
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TT -- aa=clinetfz(i7,i8,mu)%a,bb=clinetfz(i7,i8,mu)%b,cc=clinetfz(i7,i
* 8,mu)%c,dd=clinetfz(i7,i8,mu)%d,a1=lf1_278(mu)%a,b1=lf1_278(mu)%b,c1=l
* f1_278(mu)%c,d1=lf1_278(mu)%d,a2=rg2_78(i7,i8)%a,b2=rg2_78(i7,i8)%b,c2
* =rg2_78(i7,i8)%c,d2=rg2_78(i7,i8)%d,prq=p278q,m=rmass(id1),nsum=1
      clinetfz(i7,i8,mu)%a(1,1)=clinetfz(i7,i8,mu)%a(1,1)+lf1_27
     & 8(mu)%a(1,1)*rg2_78(i7,i8)%a(1,1)+lf1_278(mu)%c(1,2)*p278
     & q*rg2_78(i7,i8)%b(2,1)
      clinetfz(i7,i8,mu)%b(1,1)=clinetfz(i7,i8,mu)%b(1,1)+rmass(
     & id1)*(lf1_278(mu)%d(1,1)*rg2_78(i7,i8)%a(1,1)+lf1_278(mu)
     & %b(1,2)*rg2_78(i7,i8)%b(2,1))
      clinetfz(i7,i8,mu)%c(1,1)=clinetfz(i7,i8,mu)%c(1,1)+rmass(
     & id1)*(lf1_278(mu)%a(1,1)*rg2_78(i7,i8)%d(1,1)+lf1_278(mu)
     & %c(1,2)*rg2_78(i7,i8)%c(2,1))
      clinetfz(i7,i8,mu)%d(1,1)=clinetfz(i7,i8,mu)%d(1,1)+lf1_27
     & 8(mu)%d(1,1)*p278q*rg2_78(i7,i8)%d(1,1)+lf1_278(mu)%b(1,2
     & )*rg2_78(i7,i8)%c(2,1)
      clinetfz(i7,i8,mu)%a(1,2)=clinetfz(i7,i8,mu)%a(1,2)+rmass(
     & id1)*(lf1_278(mu)%a(1,1)*rg2_78(i7,i8)%b(1,2)+lf1_278(mu)
     & %c(1,2)*rg2_78(i7,i8)%a(2,2))
      clinetfz(i7,i8,mu)%b(1,2)=clinetfz(i7,i8,mu)%b(1,2)+lf1_27
     & 8(mu)%d(1,1)*p278q*rg2_78(i7,i8)%b(1,2)+lf1_278(mu)%b(1,2
     & )*rg2_78(i7,i8)%a(2,2)
      clinetfz(i7,i8,mu)%c(1,2)=clinetfz(i7,i8,mu)%c(1,2)+lf1_27
     & 8(mu)%a(1,1)*rg2_78(i7,i8)%c(1,2)+lf1_278(mu)%c(1,2)*p278
     & q*rg2_78(i7,i8)%d(2,2)
      clinetfz(i7,i8,mu)%d(1,2)=clinetfz(i7,i8,mu)%d(1,2)+rmass(
     & id1)*(lf1_278(mu)%d(1,1)*rg2_78(i7,i8)%c(1,2)+lf1_278(mu)
     & %b(1,2)*rg2_78(i7,i8)%d(2,2))
      clinetfz(i7,i8,mu)%a(2,1)=clinetfz(i7,i8,mu)%a(2,1)+rmass(
     & id1)*(lf1_278(mu)%c(2,1)*rg2_78(i7,i8)%a(1,1)+lf1_278(mu)
     & %a(2,2)*rg2_78(i7,i8)%b(2,1))
      clinetfz(i7,i8,mu)%b(2,1)=clinetfz(i7,i8,mu)%b(2,1)+lf1_27
     & 8(mu)%b(2,1)*rg2_78(i7,i8)%a(1,1)+lf1_278(mu)%d(2,2)*p278
     & q*rg2_78(i7,i8)%b(2,1)
      clinetfz(i7,i8,mu)%c(2,1)=clinetfz(i7,i8,mu)%c(2,1)+lf1_27
     & 8(mu)%c(2,1)*p278q*rg2_78(i7,i8)%d(1,1)+lf1_278(mu)%a(2,2
     & )*rg2_78(i7,i8)%c(2,1)
      clinetfz(i7,i8,mu)%d(2,1)=clinetfz(i7,i8,mu)%d(2,1)+rmass(
     & id1)*(lf1_278(mu)%b(2,1)*rg2_78(i7,i8)%d(1,1)+lf1_278(mu)
     & %d(2,2)*rg2_78(i7,i8)%c(2,1))
      clinetfz(i7,i8,mu)%a(2,2)=clinetfz(i7,i8,mu)%a(2,2)+lf1_27
     & 8(mu)%c(2,1)*p278q*rg2_78(i7,i8)%b(1,2)+lf1_278(mu)%a(2,2
     & )*rg2_78(i7,i8)%a(2,2)
      clinetfz(i7,i8,mu)%b(2,2)=clinetfz(i7,i8,mu)%b(2,2)+rmass(
     & id1)*(lf1_278(mu)%b(2,1)*rg2_78(i7,i8)%b(1,2)+lf1_278(mu)
     & %d(2,2)*rg2_78(i7,i8)%a(2,2))
      clinetfz(i7,i8,mu)%c(2,2)=clinetfz(i7,i8,mu)%c(2,2)+rmass(
     & id1)*(lf1_278(mu)%c(2,1)*rg2_78(i7,i8)%c(1,2)+lf1_278(mu)
     & %a(2,2)*rg2_78(i7,i8)%d(2,2))
      clinetfz(i7,i8,mu)%d(2,2)=clinetfz(i7,i8,mu)%d(2,2)+lf1_27
     & 8(mu)%b(2,1)*rg2_78(i7,i8)%c(1,2)+lf1_278(mu)%d(2,2)*p278
     & q*rg2_78(i7,i8)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id1)
      rmassr=-rmass(id1)
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* mline -- res=cfqcd1278(&1,&2,i7,i8,mu),abcd=clinetfz(i7,i8,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cfqcd1278(iut,jut,i7,i8,mu)=cfqcd1278(iut,jut,i7,i8,mu)+cl
     & inetfz(i7,i8,mu)%a(iut,jut)+rmassl*clinetfz(i7,i8,mu)%b(i
     & ut,jut)+rmassr*clinetfz(i7,i8,mu)%c(iut,jut)+rmassl*rmass
     & r*clinetfz(i7,i8,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
  
*                                                                       
* Then link the computed subdiagrams with the "Z" and "gamma" insertions
* [cz3456(2,2,2,2,0:3) and cf3456(2,2,2,2,0:3)]%                        
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5)   
*                                                                       
  
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
  
* "Z" insertion                                                         
* p.q -- p.q=cp1278dotczqcd1278,p=p1278(#),q=czqcd1278(i1,i2,i7,i8,#),be
* f=,aft=
      cp1278dotczqcd1278=(p1278(0)*czqcd1278(i1,i2,i7,i8,0)-p127
     & 8(1)*czqcd1278(i1,i2,i7,i8,1)-p1278(2)*czqcd1278(i1,i2,i7
     & ,i8,2)-p1278(3)*czqcd1278(i1,i2,i7,i8,3))
  
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5),p=czqcd1278(i1,i2,i7,
* i8,#),q=cz3456(i3,i4,i5,i6,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5
* )-,aft=/(p1278q-cmz2)
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,5)-(czqcd1278(i1,i2,i7,i8,0)*cz3456(i3,i4,
     & i5,i6,0)-czqcd1278(i1,i2,i7,i8,1)*cz3456(i3,i4,i5,i6,1)-c
     & zqcd1278(i1,i2,i7,i8,2)*cz3456(i3,i4,i5,i6,2)-czqcd1278(i
     & 1,i2,i7,i8,3)*cz3456(i3,i4,i5,i6,3))/(p1278q-cmz2)
  
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) =
     &   cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) +
     &   (cp1278dotczqcd1278*cp1278dotcz3456(i3,i4,i5,i6))
     &   /cmz2/(p1278q-cmz2)
  
* "gamma" insertion                                                     
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5),p=cfqcd1278(i1,i2,i7,
* i8,#),q=cf3456(i3,i4,i5,i6,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5
* )-,aft=/p1278q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,5)-(cfqcd1278(i1,i2,i7,i8,0)*cf3456(i3,i4,
     & i5,i6,0)-cfqcd1278(i1,i2,i7,i8,1)*cf3456(i3,i4,i5,i6,1)-c
     & fqcd1278(i1,i2,i7,i8,2)*cf3456(i3,i4,i5,i6,2)-cfqcd1278(i
     & 1,i2,i7,i8,3)*cf3456(i3,i4,i5,i6,3))/p1278q
  
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
*****************Compute diagrams of class 2.c)*************************
*                                                                       
*First compute subdiagrams of the type  [chqcd1278(2,2,2,2)]            
*                                                                       
*                                                                       
  
      do i1=1,2
        do i2=1,2
          do i7=1,2
            do i8=1,2
              chqcd1278(i1,i2,i7,i8)=czero
            enddo
          enddo
        enddo
      enddo
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id1.eq.5.and.rmh.ge.0.d0) then
  
      do i7=1,2
      do i8=1,2
* TTSC -- aa=clineth_4f(i7,i8)%a,bb=clineth_4f(i7,i8)%b,cc=clineth_4f(i7
* ,i8)%c,dd=clineth_4f(i7,i8)%d,a1=lg1_78(i7,i8)%a,b1=lg1_78(i7,i8)%b,c1
* =lg1_78(i7,i8)%c,d1=lg1_78(i7,i8)%d,a2=rh2_178%a,b2=rh2_178%b,c2=rh2_1
* 78%c,prq=p178q,m=rmass(id1),nsum=0
      clineth_4f(i7,i8)%a(1,2)=lg1_78(i7,i8)%a(1,1)*rh2_178%a(1,
     & 2)+lg1_78(i7,i8)%c(1,2)*p178q*rh2_178%b(2,2)
      clineth_4f(i7,i8)%b(1,2)=rmass(id1)*(lg1_78(i7,i8)%d(1,1)*
     & rh2_178%a(1,2)+lg1_78(i7,i8)%b(1,2)*rh2_178%b(2,2))
      clineth_4f(i7,i8)%c(1,2)=rmass(id1)*lg1_78(i7,i8)%c(1,2)*r
     & h2_178%c(2,2)
      clineth_4f(i7,i8)%d(1,2)=lg1_78(i7,i8)%b(1,2)*rh2_178%c(2,
     & 2)
      clineth_4f(i7,i8)%a(1,1)=rmass(id1)*(lg1_78(i7,i8)%a(1,1)*
     & rh2_178%b(1,1)+lg1_78(i7,i8)%c(1,2)*rh2_178%a(2,1))
      clineth_4f(i7,i8)%b(1,1)=lg1_78(i7,i8)%d(1,1)*p178q*rh2_17
     & 8%b(1,1)+lg1_78(i7,i8)%b(1,2)*rh2_178%a(2,1)
      clineth_4f(i7,i8)%c(1,1)=lg1_78(i7,i8)%a(1,1)*rh2_178%c(1,
     & 1)
      clineth_4f(i7,i8)%d(1,1)=rmass(id1)*lg1_78(i7,i8)%d(1,1)*r
     & h2_178%c(1,1)
      clineth_4f(i7,i8)%a(2,2)=rmass(id1)*(lg1_78(i7,i8)%c(2,1)*
     & rh2_178%a(1,2)+lg1_78(i7,i8)%a(2,2)*rh2_178%b(2,2))
      clineth_4f(i7,i8)%b(2,2)=lg1_78(i7,i8)%b(2,1)*rh2_178%a(1,
     & 2)+lg1_78(i7,i8)%d(2,2)*p178q*rh2_178%b(2,2)
      clineth_4f(i7,i8)%c(2,2)=lg1_78(i7,i8)%a(2,2)*rh2_178%c(2,
     & 2)
      clineth_4f(i7,i8)%d(2,2)=rmass(id1)*lg1_78(i7,i8)%d(2,2)*r
     & h2_178%c(2,2)
      clineth_4f(i7,i8)%a(2,1)=lg1_78(i7,i8)%c(2,1)*p178q*rh2_17
     & 8%b(1,1)+lg1_78(i7,i8)%a(2,2)*rh2_178%a(2,1)
      clineth_4f(i7,i8)%b(2,1)=rmass(id1)*(lg1_78(i7,i8)%b(2,1)*
     & rh2_178%b(1,1)+lg1_78(i7,i8)%d(2,2)*rh2_178%a(2,1))
      clineth_4f(i7,i8)%c(2,1)=rmass(id1)*lg1_78(i7,i8)%c(2,1)*r
     & h2_178%c(1,1)
      clineth_4f(i7,i8)%d(2,1)=lg1_78(i7,i8)%b(2,1)*rh2_178%c(1,
     & 1)
      end do
      end do
  
      do i7=1,2
      do i8=1,2
* TSCT -- aa=clineth_4f(i7,i8)%a,bb=clineth_4f(i7,i8)%b,cc=clineth_4f(i7
* ,i8)%c,dd=clineth_4f(i7,i8)%d,a1=lh1_278%a,b1=lh1_278%b,c1=lh1_278%c,a
* 2=rg2_78(i7,i8)%a,b2=rg2_78(i7,i8)%b,c2=rg2_78(i7,i8)%c,d2=rg2_78(i7,i
* 8)%d,prq=p278q,m=rmass(id1),nsum=1
      clineth_4f(i7,i8)%a(2,1)=clineth_4f(i7,i8)%a(2,1)+lh1_278%
     & a(2,1)*rg2_78(i7,i8)%a(1,1)+lh1_278%c(2,2)*p278q*rg2_78(i
     & 7,i8)%b(2,1)
      clineth_4f(i7,i8)%b(2,1)=clineth_4f(i7,i8)%b(2,1)+rmass(id
     & 1)*lh1_278%b(2,2)*rg2_78(i7,i8)%b(2,1)
      clineth_4f(i7,i8)%c(2,1)=clineth_4f(i7,i8)%c(2,1)+rmass(id
     & 1)*(lh1_278%a(2,1)*rg2_78(i7,i8)%d(1,1)+lh1_278%c(2,2)*rg
     & 2_78(i7,i8)%c(2,1))
      clineth_4f(i7,i8)%d(2,1)=clineth_4f(i7,i8)%d(2,1)+lh1_278%
     & b(2,2)*rg2_78(i7,i8)%c(2,1)
      clineth_4f(i7,i8)%a(2,2)=clineth_4f(i7,i8)%a(2,2)+rmass(id
     & 1)*(lh1_278%a(2,1)*rg2_78(i7,i8)%b(1,2)+lh1_278%c(2,2)*rg
     & 2_78(i7,i8)%a(2,2))
      clineth_4f(i7,i8)%b(2,2)=clineth_4f(i7,i8)%b(2,2)+lh1_278%
     & b(2,2)*rg2_78(i7,i8)%a(2,2)
      clineth_4f(i7,i8)%c(2,2)=clineth_4f(i7,i8)%c(2,2)+lh1_278%
     & a(2,1)*rg2_78(i7,i8)%c(1,2)+lh1_278%c(2,2)*p278q*rg2_78(i
     & 7,i8)%d(2,2)
      clineth_4f(i7,i8)%d(2,2)=clineth_4f(i7,i8)%d(2,2)+rmass(id
     & 1)*lh1_278%b(2,2)*rg2_78(i7,i8)%d(2,2)
      clineth_4f(i7,i8)%a(1,1)=clineth_4f(i7,i8)%a(1,1)+rmass(id
     & 1)*(lh1_278%c(1,1)*rg2_78(i7,i8)%a(1,1)+lh1_278%a(1,2)*rg
     & 2_78(i7,i8)%b(2,1))
      clineth_4f(i7,i8)%b(1,1)=clineth_4f(i7,i8)%b(1,1)+lh1_278%
     & b(1,1)*rg2_78(i7,i8)%a(1,1)
      clineth_4f(i7,i8)%c(1,1)=clineth_4f(i7,i8)%c(1,1)+lh1_278%
     & c(1,1)*p278q*rg2_78(i7,i8)%d(1,1)+lh1_278%a(1,2)*rg2_78(i
     & 7,i8)%c(2,1)
      clineth_4f(i7,i8)%d(1,1)=clineth_4f(i7,i8)%d(1,1)+rmass(id
     & 1)*lh1_278%b(1,1)*rg2_78(i7,i8)%d(1,1)
      clineth_4f(i7,i8)%a(1,2)=clineth_4f(i7,i8)%a(1,2)+lh1_278%
     & c(1,1)*p278q*rg2_78(i7,i8)%b(1,2)+lh1_278%a(1,2)*rg2_78(i
     & 7,i8)%a(2,2)
      clineth_4f(i7,i8)%b(1,2)=clineth_4f(i7,i8)%b(1,2)+rmass(id
     & 1)*lh1_278%b(1,1)*rg2_78(i7,i8)%b(1,2)
      clineth_4f(i7,i8)%c(1,2)=clineth_4f(i7,i8)%c(1,2)+rmass(id
     & 1)*(lh1_278%c(1,1)*rg2_78(i7,i8)%c(1,2)+lh1_278%a(1,2)*rg
     & 2_78(i7,i8)%d(2,2))
      clineth_4f(i7,i8)%d(1,2)=clineth_4f(i7,i8)%d(1,2)+lh1_278%
     & b(1,1)*rg2_78(i7,i8)%c(1,2)
      end do
      end do
  
      rmassl=rmass(id1)
      rmassr=-rmass(id1)
  
      do i7=1,2
      do i8=1,2
* mline -- res=chqcd1278(&1,&2,i7,i8),abcd=clineth_4f(i7,i8)%,m1=rmassl,
* m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      chqcd1278(iut,jut,i7,i8)=clineth_4f(i7,i8)%a(iut,jut)+rmas
     & sl*clineth_4f(i7,i8)%b(iut,jut)+rmassr*clineth_4f(i7,i8)%
     & c(iut,jut)+rmassl*rmassr*clineth_4f(i7,i8)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
      endif
  
      if (id7.eq.5.and.rmh.ge.0.d0) then
  
      do i1=1,2
      do i2=1,2
* TTSC -- aa=clineth_4f(i1,i2)%a,bb=clineth_4f(i1,i2)%b,cc=clineth_4f(i1
* ,i2)%c,dd=clineth_4f(i1,i2)%d,a1=lg7_12(i1,i2)%a,b1=lg7_12(i1,i2)%b,c1
* =lg7_12(i1,i2)%c,d1=lg7_12(i1,i2)%d,a2=rh8_712%a,b2=rh8_712%b,c2=rh8_7
* 12%c,prq=p712q,m=rmass(id7),nsum=0
      clineth_4f(i1,i2)%a(1,2)=lg7_12(i1,i2)%a(1,1)*rh8_712%a(1,
     & 2)+lg7_12(i1,i2)%c(1,2)*p712q*rh8_712%b(2,2)
      clineth_4f(i1,i2)%b(1,2)=rmass(id7)*(lg7_12(i1,i2)%d(1,1)*
     & rh8_712%a(1,2)+lg7_12(i1,i2)%b(1,2)*rh8_712%b(2,2))
      clineth_4f(i1,i2)%c(1,2)=rmass(id7)*lg7_12(i1,i2)%c(1,2)*r
     & h8_712%c(2,2)
      clineth_4f(i1,i2)%d(1,2)=lg7_12(i1,i2)%b(1,2)*rh8_712%c(2,
     & 2)
      clineth_4f(i1,i2)%a(1,1)=rmass(id7)*(lg7_12(i1,i2)%a(1,1)*
     & rh8_712%b(1,1)+lg7_12(i1,i2)%c(1,2)*rh8_712%a(2,1))
      clineth_4f(i1,i2)%b(1,1)=lg7_12(i1,i2)%d(1,1)*p712q*rh8_71
     & 2%b(1,1)+lg7_12(i1,i2)%b(1,2)*rh8_712%a(2,1)
      clineth_4f(i1,i2)%c(1,1)=lg7_12(i1,i2)%a(1,1)*rh8_712%c(1,
     & 1)
      clineth_4f(i1,i2)%d(1,1)=rmass(id7)*lg7_12(i1,i2)%d(1,1)*r
     & h8_712%c(1,1)
      clineth_4f(i1,i2)%a(2,2)=rmass(id7)*(lg7_12(i1,i2)%c(2,1)*
     & rh8_712%a(1,2)+lg7_12(i1,i2)%a(2,2)*rh8_712%b(2,2))
      clineth_4f(i1,i2)%b(2,2)=lg7_12(i1,i2)%b(2,1)*rh8_712%a(1,
     & 2)+lg7_12(i1,i2)%d(2,2)*p712q*rh8_712%b(2,2)
      clineth_4f(i1,i2)%c(2,2)=lg7_12(i1,i2)%a(2,2)*rh8_712%c(2,
     & 2)
      clineth_4f(i1,i2)%d(2,2)=rmass(id7)*lg7_12(i1,i2)%d(2,2)*r
     & h8_712%c(2,2)
      clineth_4f(i1,i2)%a(2,1)=lg7_12(i1,i2)%c(2,1)*p712q*rh8_71
     & 2%b(1,1)+lg7_12(i1,i2)%a(2,2)*rh8_712%a(2,1)
      clineth_4f(i1,i2)%b(2,1)=rmass(id7)*(lg7_12(i1,i2)%b(2,1)*
     & rh8_712%b(1,1)+lg7_12(i1,i2)%d(2,2)*rh8_712%a(2,1))
      clineth_4f(i1,i2)%c(2,1)=rmass(id7)*lg7_12(i1,i2)%c(2,1)*r
     & h8_712%c(1,1)
      clineth_4f(i1,i2)%d(2,1)=lg7_12(i1,i2)%b(2,1)*rh8_712%c(1,
     & 1)
      end do
      end do
  
      do i1=1,2
      do i2=1,2
* TSCT -- aa=clineth_4f(i1,i2)%a,bb=clineth_4f(i1,i2)%b,cc=clineth_4f(i1
* ,i2)%c,dd=clineth_4f(i1,i2)%d,a1=lh7_812%a,b1=lh7_812%b,c1=lh7_812%c,a
* 2=rg8_12(i1,i2)%a,b2=rg8_12(i1,i2)%b,c2=rg8_12(i1,i2)%c,d2=rg8_12(i1,i
* 2)%d,prq=p812q,m=rmass(id7),nsum=1
      clineth_4f(i1,i2)%a(2,1)=clineth_4f(i1,i2)%a(2,1)+lh7_812%
     & a(2,1)*rg8_12(i1,i2)%a(1,1)+lh7_812%c(2,2)*p812q*rg8_12(i
     & 1,i2)%b(2,1)
      clineth_4f(i1,i2)%b(2,1)=clineth_4f(i1,i2)%b(2,1)+rmass(id
     & 7)*lh7_812%b(2,2)*rg8_12(i1,i2)%b(2,1)
      clineth_4f(i1,i2)%c(2,1)=clineth_4f(i1,i2)%c(2,1)+rmass(id
     & 7)*(lh7_812%a(2,1)*rg8_12(i1,i2)%d(1,1)+lh7_812%c(2,2)*rg
     & 8_12(i1,i2)%c(2,1))
      clineth_4f(i1,i2)%d(2,1)=clineth_4f(i1,i2)%d(2,1)+lh7_812%
     & b(2,2)*rg8_12(i1,i2)%c(2,1)
      clineth_4f(i1,i2)%a(2,2)=clineth_4f(i1,i2)%a(2,2)+rmass(id
     & 7)*(lh7_812%a(2,1)*rg8_12(i1,i2)%b(1,2)+lh7_812%c(2,2)*rg
     & 8_12(i1,i2)%a(2,2))
      clineth_4f(i1,i2)%b(2,2)=clineth_4f(i1,i2)%b(2,2)+lh7_812%
     & b(2,2)*rg8_12(i1,i2)%a(2,2)
      clineth_4f(i1,i2)%c(2,2)=clineth_4f(i1,i2)%c(2,2)+lh7_812%
     & a(2,1)*rg8_12(i1,i2)%c(1,2)+lh7_812%c(2,2)*p812q*rg8_12(i
     & 1,i2)%d(2,2)
      clineth_4f(i1,i2)%d(2,2)=clineth_4f(i1,i2)%d(2,2)+rmass(id
     & 7)*lh7_812%b(2,2)*rg8_12(i1,i2)%d(2,2)
      clineth_4f(i1,i2)%a(1,1)=clineth_4f(i1,i2)%a(1,1)+rmass(id
     & 7)*(lh7_812%c(1,1)*rg8_12(i1,i2)%a(1,1)+lh7_812%a(1,2)*rg
     & 8_12(i1,i2)%b(2,1))
      clineth_4f(i1,i2)%b(1,1)=clineth_4f(i1,i2)%b(1,1)+lh7_812%
     & b(1,1)*rg8_12(i1,i2)%a(1,1)
      clineth_4f(i1,i2)%c(1,1)=clineth_4f(i1,i2)%c(1,1)+lh7_812%
     & c(1,1)*p812q*rg8_12(i1,i2)%d(1,1)+lh7_812%a(1,2)*rg8_12(i
     & 1,i2)%c(2,1)
      clineth_4f(i1,i2)%d(1,1)=clineth_4f(i1,i2)%d(1,1)+rmass(id
     & 7)*lh7_812%b(1,1)*rg8_12(i1,i2)%d(1,1)
      clineth_4f(i1,i2)%a(1,2)=clineth_4f(i1,i2)%a(1,2)+lh7_812%
     & c(1,1)*p812q*rg8_12(i1,i2)%b(1,2)+lh7_812%a(1,2)*rg8_12(i
     & 1,i2)%a(2,2)
      clineth_4f(i1,i2)%b(1,2)=clineth_4f(i1,i2)%b(1,2)+rmass(id
     & 7)*lh7_812%b(1,1)*rg8_12(i1,i2)%b(1,2)
      clineth_4f(i1,i2)%c(1,2)=clineth_4f(i1,i2)%c(1,2)+rmass(id
     & 7)*(lh7_812%c(1,1)*rg8_12(i1,i2)%c(1,2)+lh7_812%a(1,2)*rg
     & 8_12(i1,i2)%d(2,2))
      clineth_4f(i1,i2)%d(1,2)=clineth_4f(i1,i2)%d(1,2)+lh7_812%
     & b(1,1)*rg8_12(i1,i2)%c(1,2)
      end do
      end do
  
      rmassl=rmass(id7)
      rmassr=-rmass(id7)
  
      do i1=1,2
      do i2=1,2
* mline -- res=chqcd1278(i1,i2,&1,&2),abcd=clineth_4f(i1,i2)%,m1=rmassl,
* m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      chqcd1278(i1,i2,iut,jut)=chqcd1278(i1,i2,iut,jut)+clineth_
     & 4f(i1,i2)%a(iut,jut)+rmassl*clineth_4f(i1,i2)%b(iut,jut)+
     & rmassr*clineth_4f(i1,i2)%c(iut,jut)+rmassl*rmassr*clineth
     & _4f(i1,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
      endif
  
*                                                                       
* Then link the computed subdiagrams with the "higgs" insertion         
* [ch3456(2,2,2,2)]                                                     
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5)   
*                                                                       
  
      if(rmh.ge.0.d0 .and. (id1.eq.5 .or. id7.eq.5))then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) =
     &                       cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) +
     &                       (chqcd1278(i1,i2,i7,i8)*
     &                       ch3456(i3,i4,i5,i6))/
     &                       (p1278q-cmh2)
                      enddo
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
  
**************Compute diagrams of class 2.d) (three-forks)**************
*                                                                       
* Diagrams are built-up by linking the following structures:            
*                                                                       
* u1|_3456     % rg2|_7|8|       [Z/f/h Z/f/h g]                        
* ug1|_7|8|34  % r2|_56          [g Z/f/h Z/f/h + Z/f/h g Z/f/h]        
* ug1|_7|8|56  % r2|_34          [g Z/f/h Z/f/h + Z/f/h g Z/f/h]        
*                                                                       
* where 1|={1,7}, 2|={2,8}, 7|8|={78,12}.                               
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5)   
*                                                                       
  
      rmassl=rmass(id1)
      rmassr=-rmass(id1)
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=cline_3forks_12(i3,i4,i5,i6,i7,i8)%a,bb=cline_3forks_12(i3,i
* 4,i5,i6,i7,i8)%b,cc=cline_3forks_12(i3,i4,i5,i6,i7,i8)%c,dd=cline_3for
* ks_12(i3,i4,i5,i6,i7,i8)%d,a1=u1_3456(i3,i4,i5,i6)%a,b1=u1_3456(i3,i4,
* i5,i6)%b,c1=u1_3456(i3,i4,i5,i6)%c,d1=u1_3456(i3,i4,i5,i6)%d,a2=rg2_78
* (i7,i8)%a,b2=rg2_78(i7,i8)%b,c2=rg2_78(i7,i8)%c,d2=rg2_78(i7,i8)%d,prq
* =p278q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=u1_3456(i3,i4,i5,i6)%a(iut,1)+u1_3456(i3,i4,i5,i6)%c(i
     & ut,1)*rmass(id1)
      cx2=u1_3456(i3,i4,i5,i6)%c(iut,2)*p278q+u1_3456(i3,i4,i5,i
     & 6)%a(iut,2)*rmass(id1)
      cy1=u1_3456(i3,i4,i5,i6)%b(iut,1)+u1_3456(i3,i4,i5,i6)%d(i
     & ut,1)*rmass(id1)
      cy2=u1_3456(i3,i4,i5,i6)%d(iut,2)*p278q+u1_3456(i3,i4,i5,i
     & 6)%b(iut,2)*rmass(id1)
      cw1=u1_3456(i3,i4,i5,i6)%c(iut,1)*p278q+u1_3456(i3,i4,i5,i
     & 6)%a(iut,1)*rmass(id1)
      cw2=u1_3456(i3,i4,i5,i6)%a(iut,2)+u1_3456(i3,i4,i5,i6)%c(i
     & ut,2)*rmass(id1)
      cz1=u1_3456(i3,i4,i5,i6)%d(iut,1)*p278q+u1_3456(i3,i4,i5,i
     & 6)%b(iut,1)*rmass(id1)
      cz2=u1_3456(i3,i4,i5,i6)%b(iut,2)+u1_3456(i3,i4,i5,i6)%d(i
     & ut,2)*rmass(id1)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%a(iut,1)=cx1*rg2_78(i7,
     & i8)%a(1,1)+cx2*rg2_78(i7,i8)%b(2,1)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%b(iut,1)=cy1*rg2_78(i7,
     & i8)%a(1,1)+cy2*rg2_78(i7,i8)%b(2,1)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%c(iut,1)=cw1*rg2_78(i7,
     & i8)%d(1,1)+cw2*rg2_78(i7,i8)%c(2,1)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%d(iut,1)=cz1*rg2_78(i7,
     & i8)%d(1,1)+cz2*rg2_78(i7,i8)%c(2,1)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%a(iut,2)=cw1*rg2_78(i7,
     & i8)%b(1,2)+cw2*rg2_78(i7,i8)%a(2,2)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%b(iut,2)=cz1*rg2_78(i7,
     & i8)%b(1,2)+cz2*rg2_78(i7,i8)%a(2,2)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%c(iut,2)=cx1*rg2_78(i7,
     & i8)%c(1,2)+cx2*rg2_78(i7,i8)%d(2,2)
      cline_3forks_12(i3,i4,i5,i6,i7,i8)%d(iut,2)=cy1*rg2_78(i7,
     & i8)%c(1,2)+cy2*rg2_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* mline -- res=cres_3forks_12(i3,i4,i5,i6,i7,i8)%pol(&1,&2),abcd=cline_3
* forks_12(i3,i4,i5,i6,i7,i8)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_12(i3,i4,i5,i6,i7,i8)%pol(iut,jut)=cline_3fork
     & s_12(i3,i4,i5,i6,i7,i8)%a(iut,jut)+rmassl*cline_3forks_12
     & (i3,i4,i5,i6,i7,i8)%b(iut,jut)+rmassr*cline_3forks_12(i3,
     & i4,i5,i6,i7,i8)%c(iut,jut)+rmassl*rmassr*cline_3forks_12(
     & i3,i4,i5,i6,i7,i8)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) +
     &                     cres_3forks_12(i3,i4,i5,i6,i7,i8)
     &                     %pol(i1,i2)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id5.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=cline_3forks_12(i7,i8,i3,i4,i5,i6)%a,bb=cline_3forks_12(i7,
* i8,i3,i4,i5,i6)%b,cc=cline_3forks_12(i7,i8,i3,i4,i5,i6)%c,dd=cline_3fo
* rks_12(i7,i8,i3,i4,i5,i6)%d,a1=ug1_7834(i7,i8,i3,i4)%a,b1=ug1_7834(i7,
* i8,i3,i4)%b,c1=ug1_7834(i7,i8,i3,i4)%c,d1=ug1_7834(i7,i8,i3,i4)%d,a2=r
* 2_56(i5,i6)%a,b2=r2_56(i5,i6)%b,c2=r2_56(i5,i6)%c,d2=r2_56(i5,i6)%d,pr
* q=p256q,m=rmass(id1),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r2_56(i5,i6)%a(1,jut)+rmass(id1)*r2_56(i5,i6)%b(1,jut)
      cx2=r2_56(i5,i6)%a(2,jut)+rmass(id1)*r2_56(i5,i6)%b(2,jut)
      cy1=p256q*r2_56(i5,i6)%b(1,jut)+rmass(id1)*r2_56(i5,i6)%a(
     & 1,jut)
      cy2=p256q*r2_56(i5,i6)%b(2,jut)+rmass(id1)*r2_56(i5,i6)%a(
     & 2,jut)
      cline_3forks_12(i7,i8,i3,i4,i5,i6)%a(iut,jut)=ug1_7834(i7,
     & i8,i3,i4)%a(iut,1)*cx1+ug1_7834(i7,i8,i3,i4)%c(iut,1)*cy1
     & +ug1_7834(i7,i8,i3,i4)%a(iut,2)*cx2+ug1_7834(i7,i8,i3,i4)
     & %c(iut,2)*cy2
      cline_3forks_12(i7,i8,i3,i4,i5,i6)%b(iut,jut)=ug1_7834(i7,
     & i8,i3,i4)%b(iut,1)*cx1+ug1_7834(i7,i8,i3,i4)%d(iut,1)*cy1
     & +ug1_7834(i7,i8,i3,i4)%b(iut,2)*cx2+ug1_7834(i7,i8,i3,i4)
     & %d(iut,2)*cy2
      cw1=r2_56(i5,i6)%c(1,jut)+rmass(id1)*r2_56(i5,i6)%d(1,jut)
      cw2=r2_56(i5,i6)%c(2,jut)+rmass(id1)*r2_56(i5,i6)%d(2,jut)
      cz1=p256q*r2_56(i5,i6)%d(1,jut)+rmass(id1)*r2_56(i5,i6)%c(
     & 1,jut)
      cz2=p256q*r2_56(i5,i6)%d(2,jut)+rmass(id1)*r2_56(i5,i6)%c(
     & 2,jut)
      cline_3forks_12(i7,i8,i3,i4,i5,i6)%c(iut,jut)=ug1_7834(i7,
     & i8,i3,i4)%a(iut,1)*cw1+ug1_7834(i7,i8,i3,i4)%c(iut,1)*cz1
     & +ug1_7834(i7,i8,i3,i4)%a(iut,2)*cw2+ug1_7834(i7,i8,i3,i4)
     & %c(iut,2)*cz2
      cline_3forks_12(i7,i8,i3,i4,i5,i6)%d(iut,jut)=ug1_7834(i7,
     & i8,i3,i4)%b(iut,1)*cw1+ug1_7834(i7,i8,i3,i4)%d(iut,1)*cz1
     & +ug1_7834(i7,i8,i3,i4)%b(iut,2)*cw2+ug1_7834(i7,i8,i3,i4)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=cline_3forks_12(i7,i8,i3,i4,i5,i6)%a,bb=cline_3forks_12(i7,i
* 8,i3,i4,i5,i6)%b,cc=cline_3forks_12(i7,i8,i3,i4,i5,i6)%c,dd=cline_3for
* ks_12(i7,i8,i3,i4,i5,i6)%d,a1=ug1_7834(i7,i8,i3,i4)%a,b1=ug1_7834(i7,i
* 8,i3,i4)%b,c1=ug1_7834(i7,i8,i3,i4)%c,d1=ug1_7834(i7,i8,i3,i4)%d,a2=r2
* _56(i5,i6)%a,b2=r2_56(i5,i6)%b,c2=r2_56(i5,i6)%c,d2=r2_56(i5,i6)%d,prq
* =p256q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=ug1_7834(i7,i8,i3,i4)%a(iut,1)+ug1_7834(i7,i8,i3,i4)%c
     & (iut,1)*rmass(id1)
      cx2=ug1_7834(i7,i8,i3,i4)%c(iut,2)*p256q+ug1_7834(i7,i8,i3
     & ,i4)%a(iut,2)*rmass(id1)
      cy1=ug1_7834(i7,i8,i3,i4)%b(iut,1)+ug1_7834(i7,i8,i3,i4)%d
     & (iut,1)*rmass(id1)
      cy2=ug1_7834(i7,i8,i3,i4)%d(iut,2)*p256q+ug1_7834(i7,i8,i3
     & ,i4)%b(iut,2)*rmass(id1)
      cw1=ug1_7834(i7,i8,i3,i4)%c(iut,1)*p256q+ug1_7834(i7,i8,i3
     & ,i4)%a(iut,1)*rmass(id1)
      cw2=ug1_7834(i7,i8,i3,i4)%a(iut,2)+ug1_7834(i7,i8,i3,i4)%c
     & (iut,2)*rmass(id1)
      cz1=ug1_7834(i7,i8,i3,i4)%d(iut,1)*p256q+ug1_7834(i7,i8,i3
     & ,i4)%b(iut,1)*rmass(id1)
      cz2=ug1_7834(i7,i8,i3,i4)%b(iut,2)+ug1_7834(i7,i8,i3,i4)%d
     & (iut,2)*rmass(id1)
      cline_3forks_12(i7,i8,i3,i4,i5,i6)%a(iut,1)=cx1*r2_56(i5,i
     & 6)%a(1,1)+cx2*r2_56(i5,i6)%b(2,1)
      cline_3forks_12(i7,i8,i3,i4,i5,i6)%b(iut,1)=cy1*r2_56(i5,i
     & 6)%a(1,1)+cy2*r2_56(i5,i6)%b(2,1)
      cline_3forks_12(i7,i8,i3,i4,i5,i6)%c(iut,1)=cw1*r2_56(i5,i
     & 6)%d(1,1)+cw2*r2_56(i5,i6)%c(2,1)
      cline_3forks_12(i7,i8,i3,i4,i5,i6)%d(iut,1)=cz1*r2_56(i5,i
     & 6)%d(1,1)+cz2*r2_56(i5,i6)%c(2,1)
      cline_3forks_12(i7,i8,i3,i4,i5,i6)%a(iut,2)=cw1*r2_56(i5,i
     & 6)%b(1,2)+cw2*r2_56(i5,i6)%a(2,2)
      cline_3forks_12(i7,i8,i3,i4,i5,i6)%b(iut,2)=cz1*r2_56(i5,i
     & 6)%b(1,2)+cz2*r2_56(i5,i6)%a(2,2)
      cline_3forks_12(i7,i8,i3,i4,i5,i6)%c(iut,2)=cx1*r2_56(i5,i
     & 6)%c(1,2)+cx2*r2_56(i5,i6)%d(2,2)
      cline_3forks_12(i7,i8,i3,i4,i5,i6)%d(iut,2)=cy1*r2_56(i5,i
     & 6)%c(1,2)+cy2*r2_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* mline -- res=cres_3forks_12(i7,i8,i3,i4,i5,i6)%pol(&1,&2),abcd=cline_3
* forks_12(i7,i8,i3,i4,i5,i6)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_12(i7,i8,i3,i4,i5,i6)%pol(iut,jut)=cline_3fork
     & s_12(i7,i8,i3,i4,i5,i6)%a(iut,jut)+rmassl*cline_3forks_12
     & (i7,i8,i3,i4,i5,i6)%b(iut,jut)+rmassr*cline_3forks_12(i7,
     & i8,i3,i4,i5,i6)%c(iut,jut)+rmassl*rmassr*cline_3forks_12(
     & i7,i8,i3,i4,i5,i6)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) +
     &                     cres_3forks_12(i7,i8,i3,i4,i5,i6)
     &                     %pol(i1,i2)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
      if(id3.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* TsTs -- aa=cline_3forks_12(i7,i8,i5,i6,i3,i4)%a,bb=cline_3forks_12(i7,
* i8,i5,i6,i3,i4)%b,cc=cline_3forks_12(i7,i8,i5,i6,i3,i4)%c,dd=cline_3fo
* rks_12(i7,i8,i5,i6,i3,i4)%d,a1=ug1_7856(i7,i8,i5,i6)%a,b1=ug1_7856(i7,
* i8,i5,i6)%b,c1=ug1_7856(i7,i8,i5,i6)%c,d1=ug1_7856(i7,i8,i5,i6)%d,a2=r
* 2_34(i3,i4)%a,b2=r2_34(i3,i4)%b,c2=r2_34(i3,i4)%c,d2=r2_34(i3,i4)%d,pr
* q=p234q,m=rmass(id1),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r2_34(i3,i4)%a(1,jut)+rmass(id1)*r2_34(i3,i4)%b(1,jut)
      cx2=r2_34(i3,i4)%a(2,jut)+rmass(id1)*r2_34(i3,i4)%b(2,jut)
      cy1=p234q*r2_34(i3,i4)%b(1,jut)+rmass(id1)*r2_34(i3,i4)%a(
     & 1,jut)
      cy2=p234q*r2_34(i3,i4)%b(2,jut)+rmass(id1)*r2_34(i3,i4)%a(
     & 2,jut)
      cline_3forks_12(i7,i8,i5,i6,i3,i4)%a(iut,jut)=ug1_7856(i7,
     & i8,i5,i6)%a(iut,1)*cx1+ug1_7856(i7,i8,i5,i6)%c(iut,1)*cy1
     & +ug1_7856(i7,i8,i5,i6)%a(iut,2)*cx2+ug1_7856(i7,i8,i5,i6)
     & %c(iut,2)*cy2
      cline_3forks_12(i7,i8,i5,i6,i3,i4)%b(iut,jut)=ug1_7856(i7,
     & i8,i5,i6)%b(iut,1)*cx1+ug1_7856(i7,i8,i5,i6)%d(iut,1)*cy1
     & +ug1_7856(i7,i8,i5,i6)%b(iut,2)*cx2+ug1_7856(i7,i8,i5,i6)
     & %d(iut,2)*cy2
      cw1=r2_34(i3,i4)%c(1,jut)+rmass(id1)*r2_34(i3,i4)%d(1,jut)
      cw2=r2_34(i3,i4)%c(2,jut)+rmass(id1)*r2_34(i3,i4)%d(2,jut)
      cz1=p234q*r2_34(i3,i4)%d(1,jut)+rmass(id1)*r2_34(i3,i4)%c(
     & 1,jut)
      cz2=p234q*r2_34(i3,i4)%d(2,jut)+rmass(id1)*r2_34(i3,i4)%c(
     & 2,jut)
      cline_3forks_12(i7,i8,i5,i6,i3,i4)%c(iut,jut)=ug1_7856(i7,
     & i8,i5,i6)%a(iut,1)*cw1+ug1_7856(i7,i8,i5,i6)%c(iut,1)*cz1
     & +ug1_7856(i7,i8,i5,i6)%a(iut,2)*cw2+ug1_7856(i7,i8,i5,i6)
     & %c(iut,2)*cz2
      cline_3forks_12(i7,i8,i5,i6,i3,i4)%d(iut,jut)=ug1_7856(i7,
     & i8,i5,i6)%b(iut,1)*cw1+ug1_7856(i7,i8,i5,i6)%d(iut,1)*cz1
     & +ug1_7856(i7,i8,i5,i6)%b(iut,2)*cw2+ug1_7856(i7,i8,i5,i6)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=cline_3forks_12(i7,i8,i5,i6,i3,i4)%a,bb=cline_3forks_12(i7,i
* 8,i5,i6,i3,i4)%b,cc=cline_3forks_12(i7,i8,i5,i6,i3,i4)%c,dd=cline_3for
* ks_12(i7,i8,i5,i6,i3,i4)%d,a1=ug1_7856(i7,i8,i5,i6)%a,b1=ug1_7856(i7,i
* 8,i5,i6)%b,c1=ug1_7856(i7,i8,i5,i6)%c,d1=ug1_7856(i7,i8,i5,i6)%d,a2=r2
* _34(i3,i4)%a,b2=r2_34(i3,i4)%b,c2=r2_34(i3,i4)%c,d2=r2_34(i3,i4)%d,prq
* =p234q,m=rmass(id1),nsum=0
      do iut=1,2
      cx1=ug1_7856(i7,i8,i5,i6)%a(iut,1)+ug1_7856(i7,i8,i5,i6)%c
     & (iut,1)*rmass(id1)
      cx2=ug1_7856(i7,i8,i5,i6)%c(iut,2)*p234q+ug1_7856(i7,i8,i5
     & ,i6)%a(iut,2)*rmass(id1)
      cy1=ug1_7856(i7,i8,i5,i6)%b(iut,1)+ug1_7856(i7,i8,i5,i6)%d
     & (iut,1)*rmass(id1)
      cy2=ug1_7856(i7,i8,i5,i6)%d(iut,2)*p234q+ug1_7856(i7,i8,i5
     & ,i6)%b(iut,2)*rmass(id1)
      cw1=ug1_7856(i7,i8,i5,i6)%c(iut,1)*p234q+ug1_7856(i7,i8,i5
     & ,i6)%a(iut,1)*rmass(id1)
      cw2=ug1_7856(i7,i8,i5,i6)%a(iut,2)+ug1_7856(i7,i8,i5,i6)%c
     & (iut,2)*rmass(id1)
      cz1=ug1_7856(i7,i8,i5,i6)%d(iut,1)*p234q+ug1_7856(i7,i8,i5
     & ,i6)%b(iut,1)*rmass(id1)
      cz2=ug1_7856(i7,i8,i5,i6)%b(iut,2)+ug1_7856(i7,i8,i5,i6)%d
     & (iut,2)*rmass(id1)
      cline_3forks_12(i7,i8,i5,i6,i3,i4)%a(iut,1)=cx1*r2_34(i3,i
     & 4)%a(1,1)+cx2*r2_34(i3,i4)%b(2,1)
      cline_3forks_12(i7,i8,i5,i6,i3,i4)%b(iut,1)=cy1*r2_34(i3,i
     & 4)%a(1,1)+cy2*r2_34(i3,i4)%b(2,1)
      cline_3forks_12(i7,i8,i5,i6,i3,i4)%c(iut,1)=cw1*r2_34(i3,i
     & 4)%d(1,1)+cw2*r2_34(i3,i4)%c(2,1)
      cline_3forks_12(i7,i8,i5,i6,i3,i4)%d(iut,1)=cz1*r2_34(i3,i
     & 4)%d(1,1)+cz2*r2_34(i3,i4)%c(2,1)
      cline_3forks_12(i7,i8,i5,i6,i3,i4)%a(iut,2)=cw1*r2_34(i3,i
     & 4)%b(1,2)+cw2*r2_34(i3,i4)%a(2,2)
      cline_3forks_12(i7,i8,i5,i6,i3,i4)%b(iut,2)=cz1*r2_34(i3,i
     & 4)%b(1,2)+cz2*r2_34(i3,i4)%a(2,2)
      cline_3forks_12(i7,i8,i5,i6,i3,i4)%c(iut,2)=cx1*r2_34(i3,i
     & 4)%c(1,2)+cx2*r2_34(i3,i4)%d(2,2)
      cline_3forks_12(i7,i8,i5,i6,i3,i4)%d(iut,2)=cy1*r2_34(i3,i
     & 4)%c(1,2)+cy2*r2_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* mline -- res=cres_3forks_12(i7,i8,i5,i6,i3,i4)%pol(&1,&2),abcd=cline_3
* forks_12(i7,i8,i5,i6,i3,i4)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_12(i7,i8,i5,i6,i3,i4)%pol(iut,jut)=cline_3fork
     & s_12(i7,i8,i5,i6,i3,i4)%a(iut,jut)+rmassl*cline_3forks_12
     & (i7,i8,i5,i6,i3,i4)%b(iut,jut)+rmassr*cline_3forks_12(i7,
     & i8,i5,i6,i3,i4)%c(iut,jut)+rmassl*rmassr*cline_3forks_12(
     & i7,i8,i5,i6,i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) +
     &                     cres_3forks_12(i7,i8,i5,i6,i3,i4)
     &                     %pol(i1,i2)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
  
      rmassl=rmass(id7)
      rmassr=-rmass(id7)
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=cline_3forks_78(i3,i4,i5,i6,i1,i2)%a,bb=cline_3forks_78(i3,i
* 4,i5,i6,i1,i2)%b,cc=cline_3forks_78(i3,i4,i5,i6,i1,i2)%c,dd=cline_3for
* ks_78(i3,i4,i5,i6,i1,i2)%d,a1=u7_3456(i3,i4,i5,i6)%a,b1=u7_3456(i3,i4,
* i5,i6)%b,c1=u7_3456(i3,i4,i5,i6)%c,d1=u7_3456(i3,i4,i5,i6)%d,a2=rg8_12
* (i1,i2)%a,b2=rg8_12(i1,i2)%b,c2=rg8_12(i1,i2)%c,d2=rg8_12(i1,i2)%d,prq
* =p812q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=u7_3456(i3,i4,i5,i6)%a(iut,1)+u7_3456(i3,i4,i5,i6)%c(i
     & ut,1)*rmass(id7)
      cx2=u7_3456(i3,i4,i5,i6)%c(iut,2)*p812q+u7_3456(i3,i4,i5,i
     & 6)%a(iut,2)*rmass(id7)
      cy1=u7_3456(i3,i4,i5,i6)%b(iut,1)+u7_3456(i3,i4,i5,i6)%d(i
     & ut,1)*rmass(id7)
      cy2=u7_3456(i3,i4,i5,i6)%d(iut,2)*p812q+u7_3456(i3,i4,i5,i
     & 6)%b(iut,2)*rmass(id7)
      cw1=u7_3456(i3,i4,i5,i6)%c(iut,1)*p812q+u7_3456(i3,i4,i5,i
     & 6)%a(iut,1)*rmass(id7)
      cw2=u7_3456(i3,i4,i5,i6)%a(iut,2)+u7_3456(i3,i4,i5,i6)%c(i
     & ut,2)*rmass(id7)
      cz1=u7_3456(i3,i4,i5,i6)%d(iut,1)*p812q+u7_3456(i3,i4,i5,i
     & 6)%b(iut,1)*rmass(id7)
      cz2=u7_3456(i3,i4,i5,i6)%b(iut,2)+u7_3456(i3,i4,i5,i6)%d(i
     & ut,2)*rmass(id7)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%a(iut,1)=cx1*rg8_12(i1,
     & i2)%a(1,1)+cx2*rg8_12(i1,i2)%b(2,1)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%b(iut,1)=cy1*rg8_12(i1,
     & i2)%a(1,1)+cy2*rg8_12(i1,i2)%b(2,1)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%c(iut,1)=cw1*rg8_12(i1,
     & i2)%d(1,1)+cw2*rg8_12(i1,i2)%c(2,1)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%d(iut,1)=cz1*rg8_12(i1,
     & i2)%d(1,1)+cz2*rg8_12(i1,i2)%c(2,1)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%a(iut,2)=cw1*rg8_12(i1,
     & i2)%b(1,2)+cw2*rg8_12(i1,i2)%a(2,2)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%b(iut,2)=cz1*rg8_12(i1,
     & i2)%b(1,2)+cz2*rg8_12(i1,i2)%a(2,2)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%c(iut,2)=cx1*rg8_12(i1,
     & i2)%c(1,2)+cx2*rg8_12(i1,i2)%d(2,2)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%d(iut,2)=cy1*rg8_12(i1,
     & i2)%c(1,2)+cy2*rg8_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* mline -- res=cres_3forks_78(i3,i4,i5,i6,i1,i2)%pol(&1,&2),abcd=cline_3
* forks_78(i3,i4,i5,i6,i1,i2)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_78(i3,i4,i5,i6,i1,i2)%pol(iut,jut)=cline_3fork
     & s_78(i3,i4,i5,i6,i1,i2)%a(iut,jut)+rmassl*cline_3forks_78
     & (i3,i4,i5,i6,i1,i2)%b(iut,jut)+rmassr*cline_3forks_78(i3,
     & i4,i5,i6,i1,i2)%c(iut,jut)+rmassl*rmassr*cline_3forks_78(
     & i3,i4,i5,i6,i1,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) +
     &                     cres_3forks_78(i3,i4,i5,i6,i1,i2)
     &                     %pol(i7,i8)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id5.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=cline_3forks_78(i1,i2,i3,i4,i5,i6)%a,bb=cline_3forks_78(i1,
* i2,i3,i4,i5,i6)%b,cc=cline_3forks_78(i1,i2,i3,i4,i5,i6)%c,dd=cline_3fo
* rks_78(i1,i2,i3,i4,i5,i6)%d,a1=ug7_1234(i1,i2,i3,i4)%a,b1=ug7_1234(i1,
* i2,i3,i4)%b,c1=ug7_1234(i1,i2,i3,i4)%c,d1=ug7_1234(i1,i2,i3,i4)%d,a2=r
* 8_56(i5,i6)%a,b2=r8_56(i5,i6)%b,c2=r8_56(i5,i6)%c,d2=r8_56(i5,i6)%d,pr
* q=p856q,m=rmass(id7),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r8_56(i5,i6)%a(1,jut)+rmass(id7)*r8_56(i5,i6)%b(1,jut)
      cx2=r8_56(i5,i6)%a(2,jut)+rmass(id7)*r8_56(i5,i6)%b(2,jut)
      cy1=p856q*r8_56(i5,i6)%b(1,jut)+rmass(id7)*r8_56(i5,i6)%a(
     & 1,jut)
      cy2=p856q*r8_56(i5,i6)%b(2,jut)+rmass(id7)*r8_56(i5,i6)%a(
     & 2,jut)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%a(iut,jut)=ug7_1234(i1,
     & i2,i3,i4)%a(iut,1)*cx1+ug7_1234(i1,i2,i3,i4)%c(iut,1)*cy1
     & +ug7_1234(i1,i2,i3,i4)%a(iut,2)*cx2+ug7_1234(i1,i2,i3,i4)
     & %c(iut,2)*cy2
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%b(iut,jut)=ug7_1234(i1,
     & i2,i3,i4)%b(iut,1)*cx1+ug7_1234(i1,i2,i3,i4)%d(iut,1)*cy1
     & +ug7_1234(i1,i2,i3,i4)%b(iut,2)*cx2+ug7_1234(i1,i2,i3,i4)
     & %d(iut,2)*cy2
      cw1=r8_56(i5,i6)%c(1,jut)+rmass(id7)*r8_56(i5,i6)%d(1,jut)
      cw2=r8_56(i5,i6)%c(2,jut)+rmass(id7)*r8_56(i5,i6)%d(2,jut)
      cz1=p856q*r8_56(i5,i6)%d(1,jut)+rmass(id7)*r8_56(i5,i6)%c(
     & 1,jut)
      cz2=p856q*r8_56(i5,i6)%d(2,jut)+rmass(id7)*r8_56(i5,i6)%c(
     & 2,jut)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%c(iut,jut)=ug7_1234(i1,
     & i2,i3,i4)%a(iut,1)*cw1+ug7_1234(i1,i2,i3,i4)%c(iut,1)*cz1
     & +ug7_1234(i1,i2,i3,i4)%a(iut,2)*cw2+ug7_1234(i1,i2,i3,i4)
     & %c(iut,2)*cz2
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%d(iut,jut)=ug7_1234(i1,
     & i2,i3,i4)%b(iut,1)*cw1+ug7_1234(i1,i2,i3,i4)%d(iut,1)*cz1
     & +ug7_1234(i1,i2,i3,i4)%b(iut,2)*cw2+ug7_1234(i1,i2,i3,i4)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=cline_3forks_78(i1,i2,i3,i4,i5,i6)%a,bb=cline_3forks_78(i1,i
* 2,i3,i4,i5,i6)%b,cc=cline_3forks_78(i1,i2,i3,i4,i5,i6)%c,dd=cline_3for
* ks_78(i1,i2,i3,i4,i5,i6)%d,a1=ug7_1234(i1,i2,i3,i4)%a,b1=ug7_1234(i1,i
* 2,i3,i4)%b,c1=ug7_1234(i1,i2,i3,i4)%c,d1=ug7_1234(i1,i2,i3,i4)%d,a2=r8
* _56(i5,i6)%a,b2=r8_56(i5,i6)%b,c2=r8_56(i5,i6)%c,d2=r8_56(i5,i6)%d,prq
* =p856q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=ug7_1234(i1,i2,i3,i4)%a(iut,1)+ug7_1234(i1,i2,i3,i4)%c
     & (iut,1)*rmass(id7)
      cx2=ug7_1234(i1,i2,i3,i4)%c(iut,2)*p856q+ug7_1234(i1,i2,i3
     & ,i4)%a(iut,2)*rmass(id7)
      cy1=ug7_1234(i1,i2,i3,i4)%b(iut,1)+ug7_1234(i1,i2,i3,i4)%d
     & (iut,1)*rmass(id7)
      cy2=ug7_1234(i1,i2,i3,i4)%d(iut,2)*p856q+ug7_1234(i1,i2,i3
     & ,i4)%b(iut,2)*rmass(id7)
      cw1=ug7_1234(i1,i2,i3,i4)%c(iut,1)*p856q+ug7_1234(i1,i2,i3
     & ,i4)%a(iut,1)*rmass(id7)
      cw2=ug7_1234(i1,i2,i3,i4)%a(iut,2)+ug7_1234(i1,i2,i3,i4)%c
     & (iut,2)*rmass(id7)
      cz1=ug7_1234(i1,i2,i3,i4)%d(iut,1)*p856q+ug7_1234(i1,i2,i3
     & ,i4)%b(iut,1)*rmass(id7)
      cz2=ug7_1234(i1,i2,i3,i4)%b(iut,2)+ug7_1234(i1,i2,i3,i4)%d
     & (iut,2)*rmass(id7)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%a(iut,1)=cx1*r8_56(i5,i
     & 6)%a(1,1)+cx2*r8_56(i5,i6)%b(2,1)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%b(iut,1)=cy1*r8_56(i5,i
     & 6)%a(1,1)+cy2*r8_56(i5,i6)%b(2,1)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%c(iut,1)=cw1*r8_56(i5,i
     & 6)%d(1,1)+cw2*r8_56(i5,i6)%c(2,1)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%d(iut,1)=cz1*r8_56(i5,i
     & 6)%d(1,1)+cz2*r8_56(i5,i6)%c(2,1)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%a(iut,2)=cw1*r8_56(i5,i
     & 6)%b(1,2)+cw2*r8_56(i5,i6)%a(2,2)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%b(iut,2)=cz1*r8_56(i5,i
     & 6)%b(1,2)+cz2*r8_56(i5,i6)%a(2,2)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%c(iut,2)=cx1*r8_56(i5,i
     & 6)%c(1,2)+cx2*r8_56(i5,i6)%d(2,2)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%d(iut,2)=cy1*r8_56(i5,i
     & 6)%c(1,2)+cy2*r8_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* mline -- res=cres_3forks_78(i1,i2,i3,i4,i5,i6)%pol(&1,&2),abcd=cline_3
* forks_78(i1,i2,i3,i4,i5,i6)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_78(i1,i2,i3,i4,i5,i6)%pol(iut,jut)=cline_3fork
     & s_78(i1,i2,i3,i4,i5,i6)%a(iut,jut)+rmassl*cline_3forks_78
     & (i1,i2,i3,i4,i5,i6)%b(iut,jut)+rmassr*cline_3forks_78(i1,
     & i2,i3,i4,i5,i6)%c(iut,jut)+rmassl*rmassr*cline_3forks_78(
     & i1,i2,i3,i4,i5,i6)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) +
     &                     cres_3forks_78(i1,i2,i3,i4,i5,i6)
     &                     %pol(i7,i8)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id3.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* TsTs -- aa=cline_3forks_78(i1,i2,i5,i6,i3,i4)%a,bb=cline_3forks_78(i1,
* i2,i5,i6,i3,i4)%b,cc=cline_3forks_78(i1,i2,i5,i6,i3,i4)%c,dd=cline_3fo
* rks_78(i1,i2,i5,i6,i3,i4)%d,a1=ug7_1256(i1,i2,i5,i6)%a,b1=ug7_1256(i1,
* i2,i5,i6)%b,c1=ug7_1256(i1,i2,i5,i6)%c,d1=ug7_1256(i1,i2,i5,i6)%d,a2=r
* 8_34(i3,i4)%a,b2=r8_34(i3,i4)%b,c2=r8_34(i3,i4)%c,d2=r8_34(i3,i4)%d,pr
* q=p834q,m=rmass(id7),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r8_34(i3,i4)%a(1,jut)+rmass(id7)*r8_34(i3,i4)%b(1,jut)
      cx2=r8_34(i3,i4)%a(2,jut)+rmass(id7)*r8_34(i3,i4)%b(2,jut)
      cy1=p834q*r8_34(i3,i4)%b(1,jut)+rmass(id7)*r8_34(i3,i4)%a(
     & 1,jut)
      cy2=p834q*r8_34(i3,i4)%b(2,jut)+rmass(id7)*r8_34(i3,i4)%a(
     & 2,jut)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%a(iut,jut)=ug7_1256(i1,
     & i2,i5,i6)%a(iut,1)*cx1+ug7_1256(i1,i2,i5,i6)%c(iut,1)*cy1
     & +ug7_1256(i1,i2,i5,i6)%a(iut,2)*cx2+ug7_1256(i1,i2,i5,i6)
     & %c(iut,2)*cy2
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%b(iut,jut)=ug7_1256(i1,
     & i2,i5,i6)%b(iut,1)*cx1+ug7_1256(i1,i2,i5,i6)%d(iut,1)*cy1
     & +ug7_1256(i1,i2,i5,i6)%b(iut,2)*cx2+ug7_1256(i1,i2,i5,i6)
     & %d(iut,2)*cy2
      cw1=r8_34(i3,i4)%c(1,jut)+rmass(id7)*r8_34(i3,i4)%d(1,jut)
      cw2=r8_34(i3,i4)%c(2,jut)+rmass(id7)*r8_34(i3,i4)%d(2,jut)
      cz1=p834q*r8_34(i3,i4)%d(1,jut)+rmass(id7)*r8_34(i3,i4)%c(
     & 1,jut)
      cz2=p834q*r8_34(i3,i4)%d(2,jut)+rmass(id7)*r8_34(i3,i4)%c(
     & 2,jut)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%c(iut,jut)=ug7_1256(i1,
     & i2,i5,i6)%a(iut,1)*cw1+ug7_1256(i1,i2,i5,i6)%c(iut,1)*cz1
     & +ug7_1256(i1,i2,i5,i6)%a(iut,2)*cw2+ug7_1256(i1,i2,i5,i6)
     & %c(iut,2)*cz2
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%d(iut,jut)=ug7_1256(i1,
     & i2,i5,i6)%b(iut,1)*cw1+ug7_1256(i1,i2,i5,i6)%d(iut,1)*cz1
     & +ug7_1256(i1,i2,i5,i6)%b(iut,2)*cw2+ug7_1256(i1,i2,i5,i6)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=cline_3forks_78(i1,i2,i5,i6,i3,i4)%a,bb=cline_3forks_78(i1,i
* 2,i5,i6,i3,i4)%b,cc=cline_3forks_78(i1,i2,i5,i6,i3,i4)%c,dd=cline_3for
* ks_78(i1,i2,i5,i6,i3,i4)%d,a1=ug7_1256(i1,i2,i5,i6)%a,b1=ug7_1256(i1,i
* 2,i5,i6)%b,c1=ug7_1256(i1,i2,i5,i6)%c,d1=ug7_1256(i1,i2,i5,i6)%d,a2=r8
* _34(i3,i4)%a,b2=r8_34(i3,i4)%b,c2=r8_34(i3,i4)%c,d2=r8_34(i3,i4)%d,prq
* =p834q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=ug7_1256(i1,i2,i5,i6)%a(iut,1)+ug7_1256(i1,i2,i5,i6)%c
     & (iut,1)*rmass(id7)
      cx2=ug7_1256(i1,i2,i5,i6)%c(iut,2)*p834q+ug7_1256(i1,i2,i5
     & ,i6)%a(iut,2)*rmass(id7)
      cy1=ug7_1256(i1,i2,i5,i6)%b(iut,1)+ug7_1256(i1,i2,i5,i6)%d
     & (iut,1)*rmass(id7)
      cy2=ug7_1256(i1,i2,i5,i6)%d(iut,2)*p834q+ug7_1256(i1,i2,i5
     & ,i6)%b(iut,2)*rmass(id7)
      cw1=ug7_1256(i1,i2,i5,i6)%c(iut,1)*p834q+ug7_1256(i1,i2,i5
     & ,i6)%a(iut,1)*rmass(id7)
      cw2=ug7_1256(i1,i2,i5,i6)%a(iut,2)+ug7_1256(i1,i2,i5,i6)%c
     & (iut,2)*rmass(id7)
      cz1=ug7_1256(i1,i2,i5,i6)%d(iut,1)*p834q+ug7_1256(i1,i2,i5
     & ,i6)%b(iut,1)*rmass(id7)
      cz2=ug7_1256(i1,i2,i5,i6)%b(iut,2)+ug7_1256(i1,i2,i5,i6)%d
     & (iut,2)*rmass(id7)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%a(iut,1)=cx1*r8_34(i3,i
     & 4)%a(1,1)+cx2*r8_34(i3,i4)%b(2,1)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%b(iut,1)=cy1*r8_34(i3,i
     & 4)%a(1,1)+cy2*r8_34(i3,i4)%b(2,1)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%c(iut,1)=cw1*r8_34(i3,i
     & 4)%d(1,1)+cw2*r8_34(i3,i4)%c(2,1)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%d(iut,1)=cz1*r8_34(i3,i
     & 4)%d(1,1)+cz2*r8_34(i3,i4)%c(2,1)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%a(iut,2)=cw1*r8_34(i3,i
     & 4)%b(1,2)+cw2*r8_34(i3,i4)%a(2,2)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%b(iut,2)=cz1*r8_34(i3,i
     & 4)%b(1,2)+cz2*r8_34(i3,i4)%a(2,2)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%c(iut,2)=cx1*r8_34(i3,i
     & 4)%c(1,2)+cx2*r8_34(i3,i4)%d(2,2)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%d(iut,2)=cy1*r8_34(i3,i
     & 4)%c(1,2)+cy2*r8_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* mline -- res=cres_3forks_78(i1,i2,i5,i6,i3,i4)%pol(&1,&2),abcd=cline_3
* forks_78(i1,i2,i5,i6,i3,i4)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_78(i1,i2,i5,i6,i3,i4)%pol(iut,jut)=cline_3fork
     & s_78(i1,i2,i5,i6,i3,i4)%a(iut,jut)+rmassl*cline_3forks_78
     & (i1,i2,i5,i6,i3,i4)%b(iut,jut)+rmassr*cline_3forks_78(i1,
     & i2,i5,i6,i3,i4)%c(iut,jut)+rmassl*rmassr*cline_3forks_78(
     & i1,i2,i5,i6,i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,5) +
     &                     cres_3forks_78(i1,i2,i5,i6,i3,i4)
     &                     %pol(i7,i8)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
      endif    !if((ilept(id1).ne.1) .and. (ilept(id7).ne.1))
  
  
  
************************************************************************
******Color configuration no. 6 ***** [cres(...).caux(i7,i8,6)]*******  
************************************************************************
*                                                                       
*                           1| 3| 7| 5|                                 
*                            |  |~~|  |                                 
*                           2| 4| 8| 6|                                 
*                                                                       
*                                                                       
*Sum the diagrams belonging to classes 1), 2.a), 2.b), 2.c), 2.d) in    
*which the gluon connects Zlines 34 and 78                              
  
      if((ilept(id3).ne.1) .and. (ilept(id7).ne.1)) then
  
*****************Compute diagrams of class 1)***************************
*Link cg3412(2,2,2,2,0:3) with cg7856(2,2,2,2,0:3)                      
*     cg3456(2,2,2,2,0:3) with cg7812(2,2,2,2,0:3)                      
*The result is directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6)  
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6),p=cg3412(i3,i4,i1,i2,
* #),q=cg7856(i7,i8,i5,i6,#),bef=-,aft=/p1234q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6)=-(cg3412(i3,i4,i1,i2
     & ,0)*cg7856(i7,i8,i5,i6,0)-cg3412(i3,i4,i1,i2,1)*cg7856(i7
     & ,i8,i5,i6,1)-cg3412(i3,i4,i1,i2,2)*cg7856(i7,i8,i5,i6,2)-
     & cg3412(i3,i4,i1,i2,3)*cg7856(i7,i8,i5,i6,3))/p1234q
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6),p=cg3456(i3,i4,i5,i6,
* #),q=cg7812(i7,i8,i1,i2,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6)-,
* aft=/p3456q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,6)-(cg3456(i3,i4,i5,i6,0)*cg7812(i7,i8,i1,
     & i2,0)-cg3456(i3,i4,i5,i6,1)*cg7812(i7,i8,i1,i2,1)-cg3456(
     & i3,i4,i5,i6,2)*cg7812(i7,i8,i1,i2,2)-cg3456(i3,i4,i5,i6,3
     & )*cg7812(i7,i8,i1,i2,3))/p3456q
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
  
*****************Compute diagrams of class 2.a) and 2.b)****************
*                                                                       
* First compute subdiagrams of the type  [czqcd3478(2,2,2,2,0:3)]       
*                                        [cfqcd3478(2,2,2,2,0:3)]       
  
  
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TT -- aa=clinetzz(i3,i4,mu)%a,bb=clinetzz(i3,i4,mu)%b,cc=clinetzz(i3,i
* 4,mu)%c,dd=clinetzz(i3,i4,mu)%d,a1=lg7_34(i3,i4)%a,b1=lg7_34(i3,i4)%b,
* c1=lg7_34(i3,i4)%c,d1=lg7_34(i3,i4)%d,a2=rz8_734(mu)%a,b2=rz8_734(mu)%
* b,c2=rz8_734(mu)%c,d2=rz8_734(mu)%d,prq=p734q,m=rmass(id7),nsum=0
      clinetzz(i3,i4,mu)%a(1,1)=lg7_34(i3,i4)%a(1,1)*rz8_734(mu)
     & %a(1,1)+lg7_34(i3,i4)%c(1,2)*p734q*rz8_734(mu)%b(2,1)
      clinetzz(i3,i4,mu)%b(1,1)=rmass(id7)*(lg7_34(i3,i4)%d(1,1)
     & *rz8_734(mu)%a(1,1)+lg7_34(i3,i4)%b(1,2)*rz8_734(mu)%b(2,
     & 1))
      clinetzz(i3,i4,mu)%c(1,1)=rmass(id7)*(lg7_34(i3,i4)%a(1,1)
     & *rz8_734(mu)%d(1,1)+lg7_34(i3,i4)%c(1,2)*rz8_734(mu)%c(2,
     & 1))
      clinetzz(i3,i4,mu)%d(1,1)=lg7_34(i3,i4)%d(1,1)*p734q*rz8_7
     & 34(mu)%d(1,1)+lg7_34(i3,i4)%b(1,2)*rz8_734(mu)%c(2,1)
      clinetzz(i3,i4,mu)%a(1,2)=rmass(id7)*(lg7_34(i3,i4)%a(1,1)
     & *rz8_734(mu)%b(1,2)+lg7_34(i3,i4)%c(1,2)*rz8_734(mu)%a(2,
     & 2))
      clinetzz(i3,i4,mu)%b(1,2)=lg7_34(i3,i4)%d(1,1)*p734q*rz8_7
     & 34(mu)%b(1,2)+lg7_34(i3,i4)%b(1,2)*rz8_734(mu)%a(2,2)
      clinetzz(i3,i4,mu)%c(1,2)=lg7_34(i3,i4)%a(1,1)*rz8_734(mu)
     & %c(1,2)+lg7_34(i3,i4)%c(1,2)*p734q*rz8_734(mu)%d(2,2)
      clinetzz(i3,i4,mu)%d(1,2)=rmass(id7)*(lg7_34(i3,i4)%d(1,1)
     & *rz8_734(mu)%c(1,2)+lg7_34(i3,i4)%b(1,2)*rz8_734(mu)%d(2,
     & 2))
      clinetzz(i3,i4,mu)%a(2,1)=rmass(id7)*(lg7_34(i3,i4)%c(2,1)
     & *rz8_734(mu)%a(1,1)+lg7_34(i3,i4)%a(2,2)*rz8_734(mu)%b(2,
     & 1))
      clinetzz(i3,i4,mu)%b(2,1)=lg7_34(i3,i4)%b(2,1)*rz8_734(mu)
     & %a(1,1)+lg7_34(i3,i4)%d(2,2)*p734q*rz8_734(mu)%b(2,1)
      clinetzz(i3,i4,mu)%c(2,1)=lg7_34(i3,i4)%c(2,1)*p734q*rz8_7
     & 34(mu)%d(1,1)+lg7_34(i3,i4)%a(2,2)*rz8_734(mu)%c(2,1)
      clinetzz(i3,i4,mu)%d(2,1)=rmass(id7)*(lg7_34(i3,i4)%b(2,1)
     & *rz8_734(mu)%d(1,1)+lg7_34(i3,i4)%d(2,2)*rz8_734(mu)%c(2,
     & 1))
      clinetzz(i3,i4,mu)%a(2,2)=lg7_34(i3,i4)%c(2,1)*p734q*rz8_7
     & 34(mu)%b(1,2)+lg7_34(i3,i4)%a(2,2)*rz8_734(mu)%a(2,2)
      clinetzz(i3,i4,mu)%b(2,2)=rmass(id7)*(lg7_34(i3,i4)%b(2,1)
     & *rz8_734(mu)%b(1,2)+lg7_34(i3,i4)%d(2,2)*rz8_734(mu)%a(2,
     & 2))
      clinetzz(i3,i4,mu)%c(2,2)=rmass(id7)*(lg7_34(i3,i4)%c(2,1)
     & *rz8_734(mu)%c(1,2)+lg7_34(i3,i4)%a(2,2)*rz8_734(mu)%d(2,
     & 2))
      clinetzz(i3,i4,mu)%d(2,2)=lg7_34(i3,i4)%b(2,1)*rz8_734(mu)
     & %c(1,2)+lg7_34(i3,i4)%d(2,2)*p734q*rz8_734(mu)%d(2,2)
      end do
      end do
      end do
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TT -- aa=clinetzz(i3,i4,mu)%a,bb=clinetzz(i3,i4,mu)%b,cc=clinetzz(i3,i
* 4,mu)%c,dd=clinetzz(i3,i4,mu)%d,a1=lz7_834(mu)%a,b1=lz7_834(mu)%b,c1=l
* z7_834(mu)%c,d1=lz7_834(mu)%d,a2=rg8_34(i3,i4)%a,b2=rg8_34(i3,i4)%b,c2
* =rg8_34(i3,i4)%c,d2=rg8_34(i3,i4)%d,prq=p834q,m=rmass(id7),nsum=1
      clinetzz(i3,i4,mu)%a(1,1)=clinetzz(i3,i4,mu)%a(1,1)+lz7_83
     & 4(mu)%a(1,1)*rg8_34(i3,i4)%a(1,1)+lz7_834(mu)%c(1,2)*p834
     & q*rg8_34(i3,i4)%b(2,1)
      clinetzz(i3,i4,mu)%b(1,1)=clinetzz(i3,i4,mu)%b(1,1)+rmass(
     & id7)*(lz7_834(mu)%d(1,1)*rg8_34(i3,i4)%a(1,1)+lz7_834(mu)
     & %b(1,2)*rg8_34(i3,i4)%b(2,1))
      clinetzz(i3,i4,mu)%c(1,1)=clinetzz(i3,i4,mu)%c(1,1)+rmass(
     & id7)*(lz7_834(mu)%a(1,1)*rg8_34(i3,i4)%d(1,1)+lz7_834(mu)
     & %c(1,2)*rg8_34(i3,i4)%c(2,1))
      clinetzz(i3,i4,mu)%d(1,1)=clinetzz(i3,i4,mu)%d(1,1)+lz7_83
     & 4(mu)%d(1,1)*p834q*rg8_34(i3,i4)%d(1,1)+lz7_834(mu)%b(1,2
     & )*rg8_34(i3,i4)%c(2,1)
      clinetzz(i3,i4,mu)%a(1,2)=clinetzz(i3,i4,mu)%a(1,2)+rmass(
     & id7)*(lz7_834(mu)%a(1,1)*rg8_34(i3,i4)%b(1,2)+lz7_834(mu)
     & %c(1,2)*rg8_34(i3,i4)%a(2,2))
      clinetzz(i3,i4,mu)%b(1,2)=clinetzz(i3,i4,mu)%b(1,2)+lz7_83
     & 4(mu)%d(1,1)*p834q*rg8_34(i3,i4)%b(1,2)+lz7_834(mu)%b(1,2
     & )*rg8_34(i3,i4)%a(2,2)
      clinetzz(i3,i4,mu)%c(1,2)=clinetzz(i3,i4,mu)%c(1,2)+lz7_83
     & 4(mu)%a(1,1)*rg8_34(i3,i4)%c(1,2)+lz7_834(mu)%c(1,2)*p834
     & q*rg8_34(i3,i4)%d(2,2)
      clinetzz(i3,i4,mu)%d(1,2)=clinetzz(i3,i4,mu)%d(1,2)+rmass(
     & id7)*(lz7_834(mu)%d(1,1)*rg8_34(i3,i4)%c(1,2)+lz7_834(mu)
     & %b(1,2)*rg8_34(i3,i4)%d(2,2))
      clinetzz(i3,i4,mu)%a(2,1)=clinetzz(i3,i4,mu)%a(2,1)+rmass(
     & id7)*(lz7_834(mu)%c(2,1)*rg8_34(i3,i4)%a(1,1)+lz7_834(mu)
     & %a(2,2)*rg8_34(i3,i4)%b(2,1))
      clinetzz(i3,i4,mu)%b(2,1)=clinetzz(i3,i4,mu)%b(2,1)+lz7_83
     & 4(mu)%b(2,1)*rg8_34(i3,i4)%a(1,1)+lz7_834(mu)%d(2,2)*p834
     & q*rg8_34(i3,i4)%b(2,1)
      clinetzz(i3,i4,mu)%c(2,1)=clinetzz(i3,i4,mu)%c(2,1)+lz7_83
     & 4(mu)%c(2,1)*p834q*rg8_34(i3,i4)%d(1,1)+lz7_834(mu)%a(2,2
     & )*rg8_34(i3,i4)%c(2,1)
      clinetzz(i3,i4,mu)%d(2,1)=clinetzz(i3,i4,mu)%d(2,1)+rmass(
     & id7)*(lz7_834(mu)%b(2,1)*rg8_34(i3,i4)%d(1,1)+lz7_834(mu)
     & %d(2,2)*rg8_34(i3,i4)%c(2,1))
      clinetzz(i3,i4,mu)%a(2,2)=clinetzz(i3,i4,mu)%a(2,2)+lz7_83
     & 4(mu)%c(2,1)*p834q*rg8_34(i3,i4)%b(1,2)+lz7_834(mu)%a(2,2
     & )*rg8_34(i3,i4)%a(2,2)
      clinetzz(i3,i4,mu)%b(2,2)=clinetzz(i3,i4,mu)%b(2,2)+rmass(
     & id7)*(lz7_834(mu)%b(2,1)*rg8_34(i3,i4)%b(1,2)+lz7_834(mu)
     & %d(2,2)*rg8_34(i3,i4)%a(2,2))
      clinetzz(i3,i4,mu)%c(2,2)=clinetzz(i3,i4,mu)%c(2,2)+rmass(
     & id7)*(lz7_834(mu)%c(2,1)*rg8_34(i3,i4)%c(1,2)+lz7_834(mu)
     & %a(2,2)*rg8_34(i3,i4)%d(2,2))
      clinetzz(i3,i4,mu)%d(2,2)=clinetzz(i3,i4,mu)%d(2,2)+lz7_83
     & 4(mu)%b(2,1)*rg8_34(i3,i4)%c(1,2)+lz7_834(mu)%d(2,2)*p834
     & q*rg8_34(i3,i4)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id7)
      rmassr=-rmass(id7)
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=czqcd3478(i3,i4,&1,&2,mu),abcd=clinetzz(i3,i4,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      czqcd3478(i3,i4,iut,jut,mu)=clinetzz(i3,i4,mu)%a(iut,jut)+
     & rmassl*clinetzz(i3,i4,mu)%b(iut,jut)+rmassr*clinetzz(i3,i
     & 4,mu)%c(iut,jut)+rmassl*rmassr*clinetzz(i3,i4,mu)%d(iut,j
     & ut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TT -- aa=clinetzz(i7,i8,mu)%a,bb=clinetzz(i7,i8,mu)%b,cc=clinetzz(i7,i
* 8,mu)%c,dd=clinetzz(i7,i8,mu)%d,a1=lg3_78(i7,i8)%a,b1=lg3_78(i7,i8)%b,
* c1=lg3_78(i7,i8)%c,d1=lg3_78(i7,i8)%d,a2=rz4_378(mu)%a,b2=rz4_378(mu)%
* b,c2=rz4_378(mu)%c,d2=rz4_378(mu)%d,prq=p378q,m=rmass(id3),nsum=0
      clinetzz(i7,i8,mu)%a(1,1)=lg3_78(i7,i8)%a(1,1)*rz4_378(mu)
     & %a(1,1)+lg3_78(i7,i8)%c(1,2)*p378q*rz4_378(mu)%b(2,1)
      clinetzz(i7,i8,mu)%b(1,1)=rmass(id3)*(lg3_78(i7,i8)%d(1,1)
     & *rz4_378(mu)%a(1,1)+lg3_78(i7,i8)%b(1,2)*rz4_378(mu)%b(2,
     & 1))
      clinetzz(i7,i8,mu)%c(1,1)=rmass(id3)*(lg3_78(i7,i8)%a(1,1)
     & *rz4_378(mu)%d(1,1)+lg3_78(i7,i8)%c(1,2)*rz4_378(mu)%c(2,
     & 1))
      clinetzz(i7,i8,mu)%d(1,1)=lg3_78(i7,i8)%d(1,1)*p378q*rz4_3
     & 78(mu)%d(1,1)+lg3_78(i7,i8)%b(1,2)*rz4_378(mu)%c(2,1)
      clinetzz(i7,i8,mu)%a(1,2)=rmass(id3)*(lg3_78(i7,i8)%a(1,1)
     & *rz4_378(mu)%b(1,2)+lg3_78(i7,i8)%c(1,2)*rz4_378(mu)%a(2,
     & 2))
      clinetzz(i7,i8,mu)%b(1,2)=lg3_78(i7,i8)%d(1,1)*p378q*rz4_3
     & 78(mu)%b(1,2)+lg3_78(i7,i8)%b(1,2)*rz4_378(mu)%a(2,2)
      clinetzz(i7,i8,mu)%c(1,2)=lg3_78(i7,i8)%a(1,1)*rz4_378(mu)
     & %c(1,2)+lg3_78(i7,i8)%c(1,2)*p378q*rz4_378(mu)%d(2,2)
      clinetzz(i7,i8,mu)%d(1,2)=rmass(id3)*(lg3_78(i7,i8)%d(1,1)
     & *rz4_378(mu)%c(1,2)+lg3_78(i7,i8)%b(1,2)*rz4_378(mu)%d(2,
     & 2))
      clinetzz(i7,i8,mu)%a(2,1)=rmass(id3)*(lg3_78(i7,i8)%c(2,1)
     & *rz4_378(mu)%a(1,1)+lg3_78(i7,i8)%a(2,2)*rz4_378(mu)%b(2,
     & 1))
      clinetzz(i7,i8,mu)%b(2,1)=lg3_78(i7,i8)%b(2,1)*rz4_378(mu)
     & %a(1,1)+lg3_78(i7,i8)%d(2,2)*p378q*rz4_378(mu)%b(2,1)
      clinetzz(i7,i8,mu)%c(2,1)=lg3_78(i7,i8)%c(2,1)*p378q*rz4_3
     & 78(mu)%d(1,1)+lg3_78(i7,i8)%a(2,2)*rz4_378(mu)%c(2,1)
      clinetzz(i7,i8,mu)%d(2,1)=rmass(id3)*(lg3_78(i7,i8)%b(2,1)
     & *rz4_378(mu)%d(1,1)+lg3_78(i7,i8)%d(2,2)*rz4_378(mu)%c(2,
     & 1))
      clinetzz(i7,i8,mu)%a(2,2)=lg3_78(i7,i8)%c(2,1)*p378q*rz4_3
     & 78(mu)%b(1,2)+lg3_78(i7,i8)%a(2,2)*rz4_378(mu)%a(2,2)
      clinetzz(i7,i8,mu)%b(2,2)=rmass(id3)*(lg3_78(i7,i8)%b(2,1)
     & *rz4_378(mu)%b(1,2)+lg3_78(i7,i8)%d(2,2)*rz4_378(mu)%a(2,
     & 2))
      clinetzz(i7,i8,mu)%c(2,2)=rmass(id3)*(lg3_78(i7,i8)%c(2,1)
     & *rz4_378(mu)%c(1,2)+lg3_78(i7,i8)%a(2,2)*rz4_378(mu)%d(2,
     & 2))
      clinetzz(i7,i8,mu)%d(2,2)=lg3_78(i7,i8)%b(2,1)*rz4_378(mu)
     & %c(1,2)+lg3_78(i7,i8)%d(2,2)*p378q*rz4_378(mu)%d(2,2)
      end do
      end do
      end do
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TT -- aa=clinetzz(i7,i8,mu)%a,bb=clinetzz(i7,i8,mu)%b,cc=clinetzz(i7,i
* 8,mu)%c,dd=clinetzz(i7,i8,mu)%d,a1=lz3_478(mu)%a,b1=lz3_478(mu)%b,c1=l
* z3_478(mu)%c,d1=lz3_478(mu)%d,a2=rg4_78(i7,i8)%a,b2=rg4_78(i7,i8)%b,c2
* =rg4_78(i7,i8)%c,d2=rg4_78(i7,i8)%d,prq=p478q,m=rmass(id3),nsum=1
      clinetzz(i7,i8,mu)%a(1,1)=clinetzz(i7,i8,mu)%a(1,1)+lz3_47
     & 8(mu)%a(1,1)*rg4_78(i7,i8)%a(1,1)+lz3_478(mu)%c(1,2)*p478
     & q*rg4_78(i7,i8)%b(2,1)
      clinetzz(i7,i8,mu)%b(1,1)=clinetzz(i7,i8,mu)%b(1,1)+rmass(
     & id3)*(lz3_478(mu)%d(1,1)*rg4_78(i7,i8)%a(1,1)+lz3_478(mu)
     & %b(1,2)*rg4_78(i7,i8)%b(2,1))
      clinetzz(i7,i8,mu)%c(1,1)=clinetzz(i7,i8,mu)%c(1,1)+rmass(
     & id3)*(lz3_478(mu)%a(1,1)*rg4_78(i7,i8)%d(1,1)+lz3_478(mu)
     & %c(1,2)*rg4_78(i7,i8)%c(2,1))
      clinetzz(i7,i8,mu)%d(1,1)=clinetzz(i7,i8,mu)%d(1,1)+lz3_47
     & 8(mu)%d(1,1)*p478q*rg4_78(i7,i8)%d(1,1)+lz3_478(mu)%b(1,2
     & )*rg4_78(i7,i8)%c(2,1)
      clinetzz(i7,i8,mu)%a(1,2)=clinetzz(i7,i8,mu)%a(1,2)+rmass(
     & id3)*(lz3_478(mu)%a(1,1)*rg4_78(i7,i8)%b(1,2)+lz3_478(mu)
     & %c(1,2)*rg4_78(i7,i8)%a(2,2))
      clinetzz(i7,i8,mu)%b(1,2)=clinetzz(i7,i8,mu)%b(1,2)+lz3_47
     & 8(mu)%d(1,1)*p478q*rg4_78(i7,i8)%b(1,2)+lz3_478(mu)%b(1,2
     & )*rg4_78(i7,i8)%a(2,2)
      clinetzz(i7,i8,mu)%c(1,2)=clinetzz(i7,i8,mu)%c(1,2)+lz3_47
     & 8(mu)%a(1,1)*rg4_78(i7,i8)%c(1,2)+lz3_478(mu)%c(1,2)*p478
     & q*rg4_78(i7,i8)%d(2,2)
      clinetzz(i7,i8,mu)%d(1,2)=clinetzz(i7,i8,mu)%d(1,2)+rmass(
     & id3)*(lz3_478(mu)%d(1,1)*rg4_78(i7,i8)%c(1,2)+lz3_478(mu)
     & %b(1,2)*rg4_78(i7,i8)%d(2,2))
      clinetzz(i7,i8,mu)%a(2,1)=clinetzz(i7,i8,mu)%a(2,1)+rmass(
     & id3)*(lz3_478(mu)%c(2,1)*rg4_78(i7,i8)%a(1,1)+lz3_478(mu)
     & %a(2,2)*rg4_78(i7,i8)%b(2,1))
      clinetzz(i7,i8,mu)%b(2,1)=clinetzz(i7,i8,mu)%b(2,1)+lz3_47
     & 8(mu)%b(2,1)*rg4_78(i7,i8)%a(1,1)+lz3_478(mu)%d(2,2)*p478
     & q*rg4_78(i7,i8)%b(2,1)
      clinetzz(i7,i8,mu)%c(2,1)=clinetzz(i7,i8,mu)%c(2,1)+lz3_47
     & 8(mu)%c(2,1)*p478q*rg4_78(i7,i8)%d(1,1)+lz3_478(mu)%a(2,2
     & )*rg4_78(i7,i8)%c(2,1)
      clinetzz(i7,i8,mu)%d(2,1)=clinetzz(i7,i8,mu)%d(2,1)+rmass(
     & id3)*(lz3_478(mu)%b(2,1)*rg4_78(i7,i8)%d(1,1)+lz3_478(mu)
     & %d(2,2)*rg4_78(i7,i8)%c(2,1))
      clinetzz(i7,i8,mu)%a(2,2)=clinetzz(i7,i8,mu)%a(2,2)+lz3_47
     & 8(mu)%c(2,1)*p478q*rg4_78(i7,i8)%b(1,2)+lz3_478(mu)%a(2,2
     & )*rg4_78(i7,i8)%a(2,2)
      clinetzz(i7,i8,mu)%b(2,2)=clinetzz(i7,i8,mu)%b(2,2)+rmass(
     & id3)*(lz3_478(mu)%b(2,1)*rg4_78(i7,i8)%b(1,2)+lz3_478(mu)
     & %d(2,2)*rg4_78(i7,i8)%a(2,2))
      clinetzz(i7,i8,mu)%c(2,2)=clinetzz(i7,i8,mu)%c(2,2)+rmass(
     & id3)*(lz3_478(mu)%c(2,1)*rg4_78(i7,i8)%c(1,2)+lz3_478(mu)
     & %a(2,2)*rg4_78(i7,i8)%d(2,2))
      clinetzz(i7,i8,mu)%d(2,2)=clinetzz(i7,i8,mu)%d(2,2)+lz3_47
     & 8(mu)%b(2,1)*rg4_78(i7,i8)%c(1,2)+lz3_478(mu)%d(2,2)*p478
     & q*rg4_78(i7,i8)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id3)
      rmassr=-rmass(id3)
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* mline -- res=czqcd3478(&1,&2,i7,i8,mu),abcd=clinetzz(i7,i8,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      czqcd3478(iut,jut,i7,i8,mu)=czqcd3478(iut,jut,i7,i8,mu)+cl
     & inetzz(i7,i8,mu)%a(iut,jut)+rmassl*clinetzz(i7,i8,mu)%b(i
     & ut,jut)+rmassr*clinetzz(i7,i8,mu)%c(iut,jut)+rmassl*rmass
     & r*clinetzz(i7,i8,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TT -- aa=clinetfz(i3,i4,mu)%a,bb=clinetfz(i3,i4,mu)%b,cc=clinetfz(i3,i
* 4,mu)%c,dd=clinetfz(i3,i4,mu)%d,a1=lg7_34(i3,i4)%a,b1=lg7_34(i3,i4)%b,
* c1=lg7_34(i3,i4)%c,d1=lg7_34(i3,i4)%d,a2=rf8_734(mu)%a,b2=rf8_734(mu)%
* b,c2=rf8_734(mu)%c,d2=rf8_734(mu)%d,prq=p734q,m=rmass(id7),nsum=0
      clinetfz(i3,i4,mu)%a(1,1)=lg7_34(i3,i4)%a(1,1)*rf8_734(mu)
     & %a(1,1)+lg7_34(i3,i4)%c(1,2)*p734q*rf8_734(mu)%b(2,1)
      clinetfz(i3,i4,mu)%b(1,1)=rmass(id7)*(lg7_34(i3,i4)%d(1,1)
     & *rf8_734(mu)%a(1,1)+lg7_34(i3,i4)%b(1,2)*rf8_734(mu)%b(2,
     & 1))
      clinetfz(i3,i4,mu)%c(1,1)=rmass(id7)*(lg7_34(i3,i4)%a(1,1)
     & *rf8_734(mu)%d(1,1)+lg7_34(i3,i4)%c(1,2)*rf8_734(mu)%c(2,
     & 1))
      clinetfz(i3,i4,mu)%d(1,1)=lg7_34(i3,i4)%d(1,1)*p734q*rf8_7
     & 34(mu)%d(1,1)+lg7_34(i3,i4)%b(1,2)*rf8_734(mu)%c(2,1)
      clinetfz(i3,i4,mu)%a(1,2)=rmass(id7)*(lg7_34(i3,i4)%a(1,1)
     & *rf8_734(mu)%b(1,2)+lg7_34(i3,i4)%c(1,2)*rf8_734(mu)%a(2,
     & 2))
      clinetfz(i3,i4,mu)%b(1,2)=lg7_34(i3,i4)%d(1,1)*p734q*rf8_7
     & 34(mu)%b(1,2)+lg7_34(i3,i4)%b(1,2)*rf8_734(mu)%a(2,2)
      clinetfz(i3,i4,mu)%c(1,2)=lg7_34(i3,i4)%a(1,1)*rf8_734(mu)
     & %c(1,2)+lg7_34(i3,i4)%c(1,2)*p734q*rf8_734(mu)%d(2,2)
      clinetfz(i3,i4,mu)%d(1,2)=rmass(id7)*(lg7_34(i3,i4)%d(1,1)
     & *rf8_734(mu)%c(1,2)+lg7_34(i3,i4)%b(1,2)*rf8_734(mu)%d(2,
     & 2))
      clinetfz(i3,i4,mu)%a(2,1)=rmass(id7)*(lg7_34(i3,i4)%c(2,1)
     & *rf8_734(mu)%a(1,1)+lg7_34(i3,i4)%a(2,2)*rf8_734(mu)%b(2,
     & 1))
      clinetfz(i3,i4,mu)%b(2,1)=lg7_34(i3,i4)%b(2,1)*rf8_734(mu)
     & %a(1,1)+lg7_34(i3,i4)%d(2,2)*p734q*rf8_734(mu)%b(2,1)
      clinetfz(i3,i4,mu)%c(2,1)=lg7_34(i3,i4)%c(2,1)*p734q*rf8_7
     & 34(mu)%d(1,1)+lg7_34(i3,i4)%a(2,2)*rf8_734(mu)%c(2,1)
      clinetfz(i3,i4,mu)%d(2,1)=rmass(id7)*(lg7_34(i3,i4)%b(2,1)
     & *rf8_734(mu)%d(1,1)+lg7_34(i3,i4)%d(2,2)*rf8_734(mu)%c(2,
     & 1))
      clinetfz(i3,i4,mu)%a(2,2)=lg7_34(i3,i4)%c(2,1)*p734q*rf8_7
     & 34(mu)%b(1,2)+lg7_34(i3,i4)%a(2,2)*rf8_734(mu)%a(2,2)
      clinetfz(i3,i4,mu)%b(2,2)=rmass(id7)*(lg7_34(i3,i4)%b(2,1)
     & *rf8_734(mu)%b(1,2)+lg7_34(i3,i4)%d(2,2)*rf8_734(mu)%a(2,
     & 2))
      clinetfz(i3,i4,mu)%c(2,2)=rmass(id7)*(lg7_34(i3,i4)%c(2,1)
     & *rf8_734(mu)%c(1,2)+lg7_34(i3,i4)%a(2,2)*rf8_734(mu)%d(2,
     & 2))
      clinetfz(i3,i4,mu)%d(2,2)=lg7_34(i3,i4)%b(2,1)*rf8_734(mu)
     & %c(1,2)+lg7_34(i3,i4)%d(2,2)*p734q*rf8_734(mu)%d(2,2)
      end do
      end do
      end do
      do i3=1,2
      do i4=1,2
      do mu=0,3
* TT -- aa=clinetfz(i3,i4,mu)%a,bb=clinetfz(i3,i4,mu)%b,cc=clinetfz(i3,i
* 4,mu)%c,dd=clinetfz(i3,i4,mu)%d,a1=lf7_834(mu)%a,b1=lf7_834(mu)%b,c1=l
* f7_834(mu)%c,d1=lf7_834(mu)%d,a2=rg8_34(i3,i4)%a,b2=rg8_34(i3,i4)%b,c2
* =rg8_34(i3,i4)%c,d2=rg8_34(i3,i4)%d,prq=p834q,m=rmass(id7),nsum=1
      clinetfz(i3,i4,mu)%a(1,1)=clinetfz(i3,i4,mu)%a(1,1)+lf7_83
     & 4(mu)%a(1,1)*rg8_34(i3,i4)%a(1,1)+lf7_834(mu)%c(1,2)*p834
     & q*rg8_34(i3,i4)%b(2,1)
      clinetfz(i3,i4,mu)%b(1,1)=clinetfz(i3,i4,mu)%b(1,1)+rmass(
     & id7)*(lf7_834(mu)%d(1,1)*rg8_34(i3,i4)%a(1,1)+lf7_834(mu)
     & %b(1,2)*rg8_34(i3,i4)%b(2,1))
      clinetfz(i3,i4,mu)%c(1,1)=clinetfz(i3,i4,mu)%c(1,1)+rmass(
     & id7)*(lf7_834(mu)%a(1,1)*rg8_34(i3,i4)%d(1,1)+lf7_834(mu)
     & %c(1,2)*rg8_34(i3,i4)%c(2,1))
      clinetfz(i3,i4,mu)%d(1,1)=clinetfz(i3,i4,mu)%d(1,1)+lf7_83
     & 4(mu)%d(1,1)*p834q*rg8_34(i3,i4)%d(1,1)+lf7_834(mu)%b(1,2
     & )*rg8_34(i3,i4)%c(2,1)
      clinetfz(i3,i4,mu)%a(1,2)=clinetfz(i3,i4,mu)%a(1,2)+rmass(
     & id7)*(lf7_834(mu)%a(1,1)*rg8_34(i3,i4)%b(1,2)+lf7_834(mu)
     & %c(1,2)*rg8_34(i3,i4)%a(2,2))
      clinetfz(i3,i4,mu)%b(1,2)=clinetfz(i3,i4,mu)%b(1,2)+lf7_83
     & 4(mu)%d(1,1)*p834q*rg8_34(i3,i4)%b(1,2)+lf7_834(mu)%b(1,2
     & )*rg8_34(i3,i4)%a(2,2)
      clinetfz(i3,i4,mu)%c(1,2)=clinetfz(i3,i4,mu)%c(1,2)+lf7_83
     & 4(mu)%a(1,1)*rg8_34(i3,i4)%c(1,2)+lf7_834(mu)%c(1,2)*p834
     & q*rg8_34(i3,i4)%d(2,2)
      clinetfz(i3,i4,mu)%d(1,2)=clinetfz(i3,i4,mu)%d(1,2)+rmass(
     & id7)*(lf7_834(mu)%d(1,1)*rg8_34(i3,i4)%c(1,2)+lf7_834(mu)
     & %b(1,2)*rg8_34(i3,i4)%d(2,2))
      clinetfz(i3,i4,mu)%a(2,1)=clinetfz(i3,i4,mu)%a(2,1)+rmass(
     & id7)*(lf7_834(mu)%c(2,1)*rg8_34(i3,i4)%a(1,1)+lf7_834(mu)
     & %a(2,2)*rg8_34(i3,i4)%b(2,1))
      clinetfz(i3,i4,mu)%b(2,1)=clinetfz(i3,i4,mu)%b(2,1)+lf7_83
     & 4(mu)%b(2,1)*rg8_34(i3,i4)%a(1,1)+lf7_834(mu)%d(2,2)*p834
     & q*rg8_34(i3,i4)%b(2,1)
      clinetfz(i3,i4,mu)%c(2,1)=clinetfz(i3,i4,mu)%c(2,1)+lf7_83
     & 4(mu)%c(2,1)*p834q*rg8_34(i3,i4)%d(1,1)+lf7_834(mu)%a(2,2
     & )*rg8_34(i3,i4)%c(2,1)
      clinetfz(i3,i4,mu)%d(2,1)=clinetfz(i3,i4,mu)%d(2,1)+rmass(
     & id7)*(lf7_834(mu)%b(2,1)*rg8_34(i3,i4)%d(1,1)+lf7_834(mu)
     & %d(2,2)*rg8_34(i3,i4)%c(2,1))
      clinetfz(i3,i4,mu)%a(2,2)=clinetfz(i3,i4,mu)%a(2,2)+lf7_83
     & 4(mu)%c(2,1)*p834q*rg8_34(i3,i4)%b(1,2)+lf7_834(mu)%a(2,2
     & )*rg8_34(i3,i4)%a(2,2)
      clinetfz(i3,i4,mu)%b(2,2)=clinetfz(i3,i4,mu)%b(2,2)+rmass(
     & id7)*(lf7_834(mu)%b(2,1)*rg8_34(i3,i4)%b(1,2)+lf7_834(mu)
     & %d(2,2)*rg8_34(i3,i4)%a(2,2))
      clinetfz(i3,i4,mu)%c(2,2)=clinetfz(i3,i4,mu)%c(2,2)+rmass(
     & id7)*(lf7_834(mu)%c(2,1)*rg8_34(i3,i4)%c(1,2)+lf7_834(mu)
     & %a(2,2)*rg8_34(i3,i4)%d(2,2))
      clinetfz(i3,i4,mu)%d(2,2)=clinetfz(i3,i4,mu)%d(2,2)+lf7_83
     & 4(mu)%b(2,1)*rg8_34(i3,i4)%c(1,2)+lf7_834(mu)%d(2,2)*p834
     & q*rg8_34(i3,i4)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id7)
      rmassr=-rmass(id7)
  
      do i3=1,2
      do i4=1,2
      do mu=0,3
* mline -- res=cfqcd3478(i3,i4,&1,&2,mu),abcd=clinetfz(i3,i4,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cfqcd3478(i3,i4,iut,jut,mu)=clinetfz(i3,i4,mu)%a(iut,jut)+
     & rmassl*clinetfz(i3,i4,mu)%b(iut,jut)+rmassr*clinetfz(i3,i
     & 4,mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i3,i4,mu)%d(iut,j
     & ut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TT -- aa=clinetfz(i7,i8,mu)%a,bb=clinetfz(i7,i8,mu)%b,cc=clinetfz(i7,i
* 8,mu)%c,dd=clinetfz(i7,i8,mu)%d,a1=lg3_78(i7,i8)%a,b1=lg3_78(i7,i8)%b,
* c1=lg3_78(i7,i8)%c,d1=lg3_78(i7,i8)%d,a2=rf4_378(mu)%a,b2=rf4_378(mu)%
* b,c2=rf4_378(mu)%c,d2=rf4_378(mu)%d,prq=p378q,m=rmass(id3),nsum=0
      clinetfz(i7,i8,mu)%a(1,1)=lg3_78(i7,i8)%a(1,1)*rf4_378(mu)
     & %a(1,1)+lg3_78(i7,i8)%c(1,2)*p378q*rf4_378(mu)%b(2,1)
      clinetfz(i7,i8,mu)%b(1,1)=rmass(id3)*(lg3_78(i7,i8)%d(1,1)
     & *rf4_378(mu)%a(1,1)+lg3_78(i7,i8)%b(1,2)*rf4_378(mu)%b(2,
     & 1))
      clinetfz(i7,i8,mu)%c(1,1)=rmass(id3)*(lg3_78(i7,i8)%a(1,1)
     & *rf4_378(mu)%d(1,1)+lg3_78(i7,i8)%c(1,2)*rf4_378(mu)%c(2,
     & 1))
      clinetfz(i7,i8,mu)%d(1,1)=lg3_78(i7,i8)%d(1,1)*p378q*rf4_3
     & 78(mu)%d(1,1)+lg3_78(i7,i8)%b(1,2)*rf4_378(mu)%c(2,1)
      clinetfz(i7,i8,mu)%a(1,2)=rmass(id3)*(lg3_78(i7,i8)%a(1,1)
     & *rf4_378(mu)%b(1,2)+lg3_78(i7,i8)%c(1,2)*rf4_378(mu)%a(2,
     & 2))
      clinetfz(i7,i8,mu)%b(1,2)=lg3_78(i7,i8)%d(1,1)*p378q*rf4_3
     & 78(mu)%b(1,2)+lg3_78(i7,i8)%b(1,2)*rf4_378(mu)%a(2,2)
      clinetfz(i7,i8,mu)%c(1,2)=lg3_78(i7,i8)%a(1,1)*rf4_378(mu)
     & %c(1,2)+lg3_78(i7,i8)%c(1,2)*p378q*rf4_378(mu)%d(2,2)
      clinetfz(i7,i8,mu)%d(1,2)=rmass(id3)*(lg3_78(i7,i8)%d(1,1)
     & *rf4_378(mu)%c(1,2)+lg3_78(i7,i8)%b(1,2)*rf4_378(mu)%d(2,
     & 2))
      clinetfz(i7,i8,mu)%a(2,1)=rmass(id3)*(lg3_78(i7,i8)%c(2,1)
     & *rf4_378(mu)%a(1,1)+lg3_78(i7,i8)%a(2,2)*rf4_378(mu)%b(2,
     & 1))
      clinetfz(i7,i8,mu)%b(2,1)=lg3_78(i7,i8)%b(2,1)*rf4_378(mu)
     & %a(1,1)+lg3_78(i7,i8)%d(2,2)*p378q*rf4_378(mu)%b(2,1)
      clinetfz(i7,i8,mu)%c(2,1)=lg3_78(i7,i8)%c(2,1)*p378q*rf4_3
     & 78(mu)%d(1,1)+lg3_78(i7,i8)%a(2,2)*rf4_378(mu)%c(2,1)
      clinetfz(i7,i8,mu)%d(2,1)=rmass(id3)*(lg3_78(i7,i8)%b(2,1)
     & *rf4_378(mu)%d(1,1)+lg3_78(i7,i8)%d(2,2)*rf4_378(mu)%c(2,
     & 1))
      clinetfz(i7,i8,mu)%a(2,2)=lg3_78(i7,i8)%c(2,1)*p378q*rf4_3
     & 78(mu)%b(1,2)+lg3_78(i7,i8)%a(2,2)*rf4_378(mu)%a(2,2)
      clinetfz(i7,i8,mu)%b(2,2)=rmass(id3)*(lg3_78(i7,i8)%b(2,1)
     & *rf4_378(mu)%b(1,2)+lg3_78(i7,i8)%d(2,2)*rf4_378(mu)%a(2,
     & 2))
      clinetfz(i7,i8,mu)%c(2,2)=rmass(id3)*(lg3_78(i7,i8)%c(2,1)
     & *rf4_378(mu)%c(1,2)+lg3_78(i7,i8)%a(2,2)*rf4_378(mu)%d(2,
     & 2))
      clinetfz(i7,i8,mu)%d(2,2)=lg3_78(i7,i8)%b(2,1)*rf4_378(mu)
     & %c(1,2)+lg3_78(i7,i8)%d(2,2)*p378q*rf4_378(mu)%d(2,2)
      end do
      end do
      end do
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TT -- aa=clinetfz(i7,i8,mu)%a,bb=clinetfz(i7,i8,mu)%b,cc=clinetfz(i7,i
* 8,mu)%c,dd=clinetfz(i7,i8,mu)%d,a1=lf3_478(mu)%a,b1=lf3_478(mu)%b,c1=l
* f3_478(mu)%c,d1=lf3_478(mu)%d,a2=rg4_78(i7,i8)%a,b2=rg4_78(i7,i8)%b,c2
* =rg4_78(i7,i8)%c,d2=rg4_78(i7,i8)%d,prq=p478q,m=rmass(id3),nsum=1
      clinetfz(i7,i8,mu)%a(1,1)=clinetfz(i7,i8,mu)%a(1,1)+lf3_47
     & 8(mu)%a(1,1)*rg4_78(i7,i8)%a(1,1)+lf3_478(mu)%c(1,2)*p478
     & q*rg4_78(i7,i8)%b(2,1)
      clinetfz(i7,i8,mu)%b(1,1)=clinetfz(i7,i8,mu)%b(1,1)+rmass(
     & id3)*(lf3_478(mu)%d(1,1)*rg4_78(i7,i8)%a(1,1)+lf3_478(mu)
     & %b(1,2)*rg4_78(i7,i8)%b(2,1))
      clinetfz(i7,i8,mu)%c(1,1)=clinetfz(i7,i8,mu)%c(1,1)+rmass(
     & id3)*(lf3_478(mu)%a(1,1)*rg4_78(i7,i8)%d(1,1)+lf3_478(mu)
     & %c(1,2)*rg4_78(i7,i8)%c(2,1))
      clinetfz(i7,i8,mu)%d(1,1)=clinetfz(i7,i8,mu)%d(1,1)+lf3_47
     & 8(mu)%d(1,1)*p478q*rg4_78(i7,i8)%d(1,1)+lf3_478(mu)%b(1,2
     & )*rg4_78(i7,i8)%c(2,1)
      clinetfz(i7,i8,mu)%a(1,2)=clinetfz(i7,i8,mu)%a(1,2)+rmass(
     & id3)*(lf3_478(mu)%a(1,1)*rg4_78(i7,i8)%b(1,2)+lf3_478(mu)
     & %c(1,2)*rg4_78(i7,i8)%a(2,2))
      clinetfz(i7,i8,mu)%b(1,2)=clinetfz(i7,i8,mu)%b(1,2)+lf3_47
     & 8(mu)%d(1,1)*p478q*rg4_78(i7,i8)%b(1,2)+lf3_478(mu)%b(1,2
     & )*rg4_78(i7,i8)%a(2,2)
      clinetfz(i7,i8,mu)%c(1,2)=clinetfz(i7,i8,mu)%c(1,2)+lf3_47
     & 8(mu)%a(1,1)*rg4_78(i7,i8)%c(1,2)+lf3_478(mu)%c(1,2)*p478
     & q*rg4_78(i7,i8)%d(2,2)
      clinetfz(i7,i8,mu)%d(1,2)=clinetfz(i7,i8,mu)%d(1,2)+rmass(
     & id3)*(lf3_478(mu)%d(1,1)*rg4_78(i7,i8)%c(1,2)+lf3_478(mu)
     & %b(1,2)*rg4_78(i7,i8)%d(2,2))
      clinetfz(i7,i8,mu)%a(2,1)=clinetfz(i7,i8,mu)%a(2,1)+rmass(
     & id3)*(lf3_478(mu)%c(2,1)*rg4_78(i7,i8)%a(1,1)+lf3_478(mu)
     & %a(2,2)*rg4_78(i7,i8)%b(2,1))
      clinetfz(i7,i8,mu)%b(2,1)=clinetfz(i7,i8,mu)%b(2,1)+lf3_47
     & 8(mu)%b(2,1)*rg4_78(i7,i8)%a(1,1)+lf3_478(mu)%d(2,2)*p478
     & q*rg4_78(i7,i8)%b(2,1)
      clinetfz(i7,i8,mu)%c(2,1)=clinetfz(i7,i8,mu)%c(2,1)+lf3_47
     & 8(mu)%c(2,1)*p478q*rg4_78(i7,i8)%d(1,1)+lf3_478(mu)%a(2,2
     & )*rg4_78(i7,i8)%c(2,1)
      clinetfz(i7,i8,mu)%d(2,1)=clinetfz(i7,i8,mu)%d(2,1)+rmass(
     & id3)*(lf3_478(mu)%b(2,1)*rg4_78(i7,i8)%d(1,1)+lf3_478(mu)
     & %d(2,2)*rg4_78(i7,i8)%c(2,1))
      clinetfz(i7,i8,mu)%a(2,2)=clinetfz(i7,i8,mu)%a(2,2)+lf3_47
     & 8(mu)%c(2,1)*p478q*rg4_78(i7,i8)%b(1,2)+lf3_478(mu)%a(2,2
     & )*rg4_78(i7,i8)%a(2,2)
      clinetfz(i7,i8,mu)%b(2,2)=clinetfz(i7,i8,mu)%b(2,2)+rmass(
     & id3)*(lf3_478(mu)%b(2,1)*rg4_78(i7,i8)%b(1,2)+lf3_478(mu)
     & %d(2,2)*rg4_78(i7,i8)%a(2,2))
      clinetfz(i7,i8,mu)%c(2,2)=clinetfz(i7,i8,mu)%c(2,2)+rmass(
     & id3)*(lf3_478(mu)%c(2,1)*rg4_78(i7,i8)%c(1,2)+lf3_478(mu)
     & %a(2,2)*rg4_78(i7,i8)%d(2,2))
      clinetfz(i7,i8,mu)%d(2,2)=clinetfz(i7,i8,mu)%d(2,2)+lf3_47
     & 8(mu)%b(2,1)*rg4_78(i7,i8)%c(1,2)+lf3_478(mu)%d(2,2)*p478
     & q*rg4_78(i7,i8)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id3)
      rmassr=-rmass(id3)
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* mline -- res=cfqcd3478(&1,&2,i7,i8,mu),abcd=clinetfz(i7,i8,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cfqcd3478(iut,jut,i7,i8,mu)=cfqcd3478(iut,jut,i7,i8,mu)+cl
     & inetfz(i7,i8,mu)%a(iut,jut)+rmassl*clinetfz(i7,i8,mu)%b(i
     & ut,jut)+rmassr*clinetfz(i7,i8,mu)%c(iut,jut)+rmassl*rmass
     & r*clinetfz(i7,i8,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
  
*                                                                       
* Then link the computed subdiagrams with the "Z" and "gamma" insertions
* [cz1256(2,2,2,2,0:3) and cf1256(2,2,2,2,0:3)]%                        
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6)   
*                                                                       
  
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
  
* "Z" insertion                                                         
* p.q -- p.q=cp1256dotczqcd3478,p=p1256(#),q=czqcd3478(i3,i4,i7,i8,#),be
* f=,aft=
      cp1256dotczqcd3478=(p1256(0)*czqcd3478(i3,i4,i7,i8,0)-p125
     & 6(1)*czqcd3478(i3,i4,i7,i8,1)-p1256(2)*czqcd3478(i3,i4,i7
     & ,i8,2)-p1256(3)*czqcd3478(i3,i4,i7,i8,3))
  
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6),p=czqcd3478(i3,i4,i7,
* i8,#),q=cz1256(i1,i2,i5,i6,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6
* )-,aft=/(p1256q-cmz2)
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,6)-(czqcd3478(i3,i4,i7,i8,0)*cz1256(i1,i2,
     & i5,i6,0)-czqcd3478(i3,i4,i7,i8,1)*cz1256(i1,i2,i5,i6,1)-c
     & zqcd3478(i3,i4,i7,i8,2)*cz1256(i1,i2,i5,i6,2)-czqcd3478(i
     & 3,i4,i7,i8,3)*cz1256(i1,i2,i5,i6,3))/(p1256q-cmz2)
  
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) =
     &   cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) +
     &   (cp1256dotczqcd3478*cp1256dotcz1256(i1,i2,i5,i6))
     &   /cmz2/(p1256q-cmz2)
  
* "gamma" insertion                                                     
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6),p=cfqcd3478(i3,i4,i7,
* i8,#),q=cf1256(i1,i2,i5,i6,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6
* )-,aft=/p1256q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,6)-(cfqcd3478(i3,i4,i7,i8,0)*cf1256(i1,i2,
     & i5,i6,0)-cfqcd3478(i3,i4,i7,i8,1)*cf1256(i1,i2,i5,i6,1)-c
     & fqcd3478(i3,i4,i7,i8,2)*cf1256(i1,i2,i5,i6,2)-cfqcd3478(i
     & 3,i4,i7,i8,3)*cf1256(i1,i2,i5,i6,3))/p1256q
  
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
*****************Compute diagrams of class 2.c)*************************
*                                                                       
*First compute subdiagrams of the type  [chqcd3478(2,2,2,2)]            
*                                                                       
*                                                                       
  
      do i3=1,2
        do i4=1,2
          do i7=1,2
            do i8=1,2
              chqcd3478(i3,i4,i7,i8)=czero
            enddo
          enddo
        enddo
      enddo
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id3.eq.5.and.rmh.ge.0.d0) then
  
      do i7=1,2
      do i8=1,2
* TTSC -- aa=clineth_4f(i7,i8)%a,bb=clineth_4f(i7,i8)%b,cc=clineth_4f(i7
* ,i8)%c,dd=clineth_4f(i7,i8)%d,a1=lg3_78(i7,i8)%a,b1=lg3_78(i7,i8)%b,c1
* =lg3_78(i7,i8)%c,d1=lg3_78(i7,i8)%d,a2=rh4_378%a,b2=rh4_378%b,c2=rh4_3
* 78%c,prq=p378q,m=rmass(id3),nsum=0
      clineth_4f(i7,i8)%a(1,2)=lg3_78(i7,i8)%a(1,1)*rh4_378%a(1,
     & 2)+lg3_78(i7,i8)%c(1,2)*p378q*rh4_378%b(2,2)
      clineth_4f(i7,i8)%b(1,2)=rmass(id3)*(lg3_78(i7,i8)%d(1,1)*
     & rh4_378%a(1,2)+lg3_78(i7,i8)%b(1,2)*rh4_378%b(2,2))
      clineth_4f(i7,i8)%c(1,2)=rmass(id3)*lg3_78(i7,i8)%c(1,2)*r
     & h4_378%c(2,2)
      clineth_4f(i7,i8)%d(1,2)=lg3_78(i7,i8)%b(1,2)*rh4_378%c(2,
     & 2)
      clineth_4f(i7,i8)%a(1,1)=rmass(id3)*(lg3_78(i7,i8)%a(1,1)*
     & rh4_378%b(1,1)+lg3_78(i7,i8)%c(1,2)*rh4_378%a(2,1))
      clineth_4f(i7,i8)%b(1,1)=lg3_78(i7,i8)%d(1,1)*p378q*rh4_37
     & 8%b(1,1)+lg3_78(i7,i8)%b(1,2)*rh4_378%a(2,1)
      clineth_4f(i7,i8)%c(1,1)=lg3_78(i7,i8)%a(1,1)*rh4_378%c(1,
     & 1)
      clineth_4f(i7,i8)%d(1,1)=rmass(id3)*lg3_78(i7,i8)%d(1,1)*r
     & h4_378%c(1,1)
      clineth_4f(i7,i8)%a(2,2)=rmass(id3)*(lg3_78(i7,i8)%c(2,1)*
     & rh4_378%a(1,2)+lg3_78(i7,i8)%a(2,2)*rh4_378%b(2,2))
      clineth_4f(i7,i8)%b(2,2)=lg3_78(i7,i8)%b(2,1)*rh4_378%a(1,
     & 2)+lg3_78(i7,i8)%d(2,2)*p378q*rh4_378%b(2,2)
      clineth_4f(i7,i8)%c(2,2)=lg3_78(i7,i8)%a(2,2)*rh4_378%c(2,
     & 2)
      clineth_4f(i7,i8)%d(2,2)=rmass(id3)*lg3_78(i7,i8)%d(2,2)*r
     & h4_378%c(2,2)
      clineth_4f(i7,i8)%a(2,1)=lg3_78(i7,i8)%c(2,1)*p378q*rh4_37
     & 8%b(1,1)+lg3_78(i7,i8)%a(2,2)*rh4_378%a(2,1)
      clineth_4f(i7,i8)%b(2,1)=rmass(id3)*(lg3_78(i7,i8)%b(2,1)*
     & rh4_378%b(1,1)+lg3_78(i7,i8)%d(2,2)*rh4_378%a(2,1))
      clineth_4f(i7,i8)%c(2,1)=rmass(id3)*lg3_78(i7,i8)%c(2,1)*r
     & h4_378%c(1,1)
      clineth_4f(i7,i8)%d(2,1)=lg3_78(i7,i8)%b(2,1)*rh4_378%c(1,
     & 1)
      end do
      end do
  
      do i7=1,2
      do i8=1,2
* TSCT -- aa=clineth_4f(i7,i8)%a,bb=clineth_4f(i7,i8)%b,cc=clineth_4f(i7
* ,i8)%c,dd=clineth_4f(i7,i8)%d,a1=lh3_478%a,b1=lh3_478%b,c1=lh3_478%c,a
* 2=rg4_78(i7,i8)%a,b2=rg4_78(i7,i8)%b,c2=rg4_78(i7,i8)%c,d2=rg4_78(i7,i
* 8)%d,prq=p478q,m=rmass(id3),nsum=1
      clineth_4f(i7,i8)%a(2,1)=clineth_4f(i7,i8)%a(2,1)+lh3_478%
     & a(2,1)*rg4_78(i7,i8)%a(1,1)+lh3_478%c(2,2)*p478q*rg4_78(i
     & 7,i8)%b(2,1)
      clineth_4f(i7,i8)%b(2,1)=clineth_4f(i7,i8)%b(2,1)+rmass(id
     & 3)*lh3_478%b(2,2)*rg4_78(i7,i8)%b(2,1)
      clineth_4f(i7,i8)%c(2,1)=clineth_4f(i7,i8)%c(2,1)+rmass(id
     & 3)*(lh3_478%a(2,1)*rg4_78(i7,i8)%d(1,1)+lh3_478%c(2,2)*rg
     & 4_78(i7,i8)%c(2,1))
      clineth_4f(i7,i8)%d(2,1)=clineth_4f(i7,i8)%d(2,1)+lh3_478%
     & b(2,2)*rg4_78(i7,i8)%c(2,1)
      clineth_4f(i7,i8)%a(2,2)=clineth_4f(i7,i8)%a(2,2)+rmass(id
     & 3)*(lh3_478%a(2,1)*rg4_78(i7,i8)%b(1,2)+lh3_478%c(2,2)*rg
     & 4_78(i7,i8)%a(2,2))
      clineth_4f(i7,i8)%b(2,2)=clineth_4f(i7,i8)%b(2,2)+lh3_478%
     & b(2,2)*rg4_78(i7,i8)%a(2,2)
      clineth_4f(i7,i8)%c(2,2)=clineth_4f(i7,i8)%c(2,2)+lh3_478%
     & a(2,1)*rg4_78(i7,i8)%c(1,2)+lh3_478%c(2,2)*p478q*rg4_78(i
     & 7,i8)%d(2,2)
      clineth_4f(i7,i8)%d(2,2)=clineth_4f(i7,i8)%d(2,2)+rmass(id
     & 3)*lh3_478%b(2,2)*rg4_78(i7,i8)%d(2,2)
      clineth_4f(i7,i8)%a(1,1)=clineth_4f(i7,i8)%a(1,1)+rmass(id
     & 3)*(lh3_478%c(1,1)*rg4_78(i7,i8)%a(1,1)+lh3_478%a(1,2)*rg
     & 4_78(i7,i8)%b(2,1))
      clineth_4f(i7,i8)%b(1,1)=clineth_4f(i7,i8)%b(1,1)+lh3_478%
     & b(1,1)*rg4_78(i7,i8)%a(1,1)
      clineth_4f(i7,i8)%c(1,1)=clineth_4f(i7,i8)%c(1,1)+lh3_478%
     & c(1,1)*p478q*rg4_78(i7,i8)%d(1,1)+lh3_478%a(1,2)*rg4_78(i
     & 7,i8)%c(2,1)
      clineth_4f(i7,i8)%d(1,1)=clineth_4f(i7,i8)%d(1,1)+rmass(id
     & 3)*lh3_478%b(1,1)*rg4_78(i7,i8)%d(1,1)
      clineth_4f(i7,i8)%a(1,2)=clineth_4f(i7,i8)%a(1,2)+lh3_478%
     & c(1,1)*p478q*rg4_78(i7,i8)%b(1,2)+lh3_478%a(1,2)*rg4_78(i
     & 7,i8)%a(2,2)
      clineth_4f(i7,i8)%b(1,2)=clineth_4f(i7,i8)%b(1,2)+rmass(id
     & 3)*lh3_478%b(1,1)*rg4_78(i7,i8)%b(1,2)
      clineth_4f(i7,i8)%c(1,2)=clineth_4f(i7,i8)%c(1,2)+rmass(id
     & 3)*(lh3_478%c(1,1)*rg4_78(i7,i8)%c(1,2)+lh3_478%a(1,2)*rg
     & 4_78(i7,i8)%d(2,2))
      clineth_4f(i7,i8)%d(1,2)=clineth_4f(i7,i8)%d(1,2)+lh3_478%
     & b(1,1)*rg4_78(i7,i8)%c(1,2)
      end do
      end do
  
      rmassl=rmass(id3)
      rmassr=-rmass(id3)
  
      do i7=1,2
      do i8=1,2
* mline -- res=chqcd3478(&1,&2,i7,i8),abcd=clineth_4f(i7,i8)%,m1=rmassl,
* m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      chqcd3478(iut,jut,i7,i8)=clineth_4f(i7,i8)%a(iut,jut)+rmas
     & sl*clineth_4f(i7,i8)%b(iut,jut)+rmassr*clineth_4f(i7,i8)%
     & c(iut,jut)+rmassl*rmassr*clineth_4f(i7,i8)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
      endif
  
      if (id7.eq.5.and.rmh.ge.0.d0) then
  
      do i3=1,2
      do i4=1,2
* TTSC -- aa=clineth_4f(i3,i4)%a,bb=clineth_4f(i3,i4)%b,cc=clineth_4f(i3
* ,i4)%c,dd=clineth_4f(i3,i4)%d,a1=lg7_34(i3,i4)%a,b1=lg7_34(i3,i4)%b,c1
* =lg7_34(i3,i4)%c,d1=lg7_34(i3,i4)%d,a2=rh8_734%a,b2=rh8_734%b,c2=rh8_7
* 34%c,prq=p734q,m=rmass(id7),nsum=0
      clineth_4f(i3,i4)%a(1,2)=lg7_34(i3,i4)%a(1,1)*rh8_734%a(1,
     & 2)+lg7_34(i3,i4)%c(1,2)*p734q*rh8_734%b(2,2)
      clineth_4f(i3,i4)%b(1,2)=rmass(id7)*(lg7_34(i3,i4)%d(1,1)*
     & rh8_734%a(1,2)+lg7_34(i3,i4)%b(1,2)*rh8_734%b(2,2))
      clineth_4f(i3,i4)%c(1,2)=rmass(id7)*lg7_34(i3,i4)%c(1,2)*r
     & h8_734%c(2,2)
      clineth_4f(i3,i4)%d(1,2)=lg7_34(i3,i4)%b(1,2)*rh8_734%c(2,
     & 2)
      clineth_4f(i3,i4)%a(1,1)=rmass(id7)*(lg7_34(i3,i4)%a(1,1)*
     & rh8_734%b(1,1)+lg7_34(i3,i4)%c(1,2)*rh8_734%a(2,1))
      clineth_4f(i3,i4)%b(1,1)=lg7_34(i3,i4)%d(1,1)*p734q*rh8_73
     & 4%b(1,1)+lg7_34(i3,i4)%b(1,2)*rh8_734%a(2,1)
      clineth_4f(i3,i4)%c(1,1)=lg7_34(i3,i4)%a(1,1)*rh8_734%c(1,
     & 1)
      clineth_4f(i3,i4)%d(1,1)=rmass(id7)*lg7_34(i3,i4)%d(1,1)*r
     & h8_734%c(1,1)
      clineth_4f(i3,i4)%a(2,2)=rmass(id7)*(lg7_34(i3,i4)%c(2,1)*
     & rh8_734%a(1,2)+lg7_34(i3,i4)%a(2,2)*rh8_734%b(2,2))
      clineth_4f(i3,i4)%b(2,2)=lg7_34(i3,i4)%b(2,1)*rh8_734%a(1,
     & 2)+lg7_34(i3,i4)%d(2,2)*p734q*rh8_734%b(2,2)
      clineth_4f(i3,i4)%c(2,2)=lg7_34(i3,i4)%a(2,2)*rh8_734%c(2,
     & 2)
      clineth_4f(i3,i4)%d(2,2)=rmass(id7)*lg7_34(i3,i4)%d(2,2)*r
     & h8_734%c(2,2)
      clineth_4f(i3,i4)%a(2,1)=lg7_34(i3,i4)%c(2,1)*p734q*rh8_73
     & 4%b(1,1)+lg7_34(i3,i4)%a(2,2)*rh8_734%a(2,1)
      clineth_4f(i3,i4)%b(2,1)=rmass(id7)*(lg7_34(i3,i4)%b(2,1)*
     & rh8_734%b(1,1)+lg7_34(i3,i4)%d(2,2)*rh8_734%a(2,1))
      clineth_4f(i3,i4)%c(2,1)=rmass(id7)*lg7_34(i3,i4)%c(2,1)*r
     & h8_734%c(1,1)
      clineth_4f(i3,i4)%d(2,1)=lg7_34(i3,i4)%b(2,1)*rh8_734%c(1,
     & 1)
      end do
      end do
  
      do i3=1,2
      do i4=1,2
* TSCT -- aa=clineth_4f(i3,i4)%a,bb=clineth_4f(i3,i4)%b,cc=clineth_4f(i3
* ,i4)%c,dd=clineth_4f(i3,i4)%d,a1=lh7_834%a,b1=lh7_834%b,c1=lh7_834%c,a
* 2=rg8_34(i3,i4)%a,b2=rg8_34(i3,i4)%b,c2=rg8_34(i3,i4)%c,d2=rg8_34(i3,i
* 4)%d,prq=p834q,m=rmass(id7),nsum=1
      clineth_4f(i3,i4)%a(2,1)=clineth_4f(i3,i4)%a(2,1)+lh7_834%
     & a(2,1)*rg8_34(i3,i4)%a(1,1)+lh7_834%c(2,2)*p834q*rg8_34(i
     & 3,i4)%b(2,1)
      clineth_4f(i3,i4)%b(2,1)=clineth_4f(i3,i4)%b(2,1)+rmass(id
     & 7)*lh7_834%b(2,2)*rg8_34(i3,i4)%b(2,1)
      clineth_4f(i3,i4)%c(2,1)=clineth_4f(i3,i4)%c(2,1)+rmass(id
     & 7)*(lh7_834%a(2,1)*rg8_34(i3,i4)%d(1,1)+lh7_834%c(2,2)*rg
     & 8_34(i3,i4)%c(2,1))
      clineth_4f(i3,i4)%d(2,1)=clineth_4f(i3,i4)%d(2,1)+lh7_834%
     & b(2,2)*rg8_34(i3,i4)%c(2,1)
      clineth_4f(i3,i4)%a(2,2)=clineth_4f(i3,i4)%a(2,2)+rmass(id
     & 7)*(lh7_834%a(2,1)*rg8_34(i3,i4)%b(1,2)+lh7_834%c(2,2)*rg
     & 8_34(i3,i4)%a(2,2))
      clineth_4f(i3,i4)%b(2,2)=clineth_4f(i3,i4)%b(2,2)+lh7_834%
     & b(2,2)*rg8_34(i3,i4)%a(2,2)
      clineth_4f(i3,i4)%c(2,2)=clineth_4f(i3,i4)%c(2,2)+lh7_834%
     & a(2,1)*rg8_34(i3,i4)%c(1,2)+lh7_834%c(2,2)*p834q*rg8_34(i
     & 3,i4)%d(2,2)
      clineth_4f(i3,i4)%d(2,2)=clineth_4f(i3,i4)%d(2,2)+rmass(id
     & 7)*lh7_834%b(2,2)*rg8_34(i3,i4)%d(2,2)
      clineth_4f(i3,i4)%a(1,1)=clineth_4f(i3,i4)%a(1,1)+rmass(id
     & 7)*(lh7_834%c(1,1)*rg8_34(i3,i4)%a(1,1)+lh7_834%a(1,2)*rg
     & 8_34(i3,i4)%b(2,1))
      clineth_4f(i3,i4)%b(1,1)=clineth_4f(i3,i4)%b(1,1)+lh7_834%
     & b(1,1)*rg8_34(i3,i4)%a(1,1)
      clineth_4f(i3,i4)%c(1,1)=clineth_4f(i3,i4)%c(1,1)+lh7_834%
     & c(1,1)*p834q*rg8_34(i3,i4)%d(1,1)+lh7_834%a(1,2)*rg8_34(i
     & 3,i4)%c(2,1)
      clineth_4f(i3,i4)%d(1,1)=clineth_4f(i3,i4)%d(1,1)+rmass(id
     & 7)*lh7_834%b(1,1)*rg8_34(i3,i4)%d(1,1)
      clineth_4f(i3,i4)%a(1,2)=clineth_4f(i3,i4)%a(1,2)+lh7_834%
     & c(1,1)*p834q*rg8_34(i3,i4)%b(1,2)+lh7_834%a(1,2)*rg8_34(i
     & 3,i4)%a(2,2)
      clineth_4f(i3,i4)%b(1,2)=clineth_4f(i3,i4)%b(1,2)+rmass(id
     & 7)*lh7_834%b(1,1)*rg8_34(i3,i4)%b(1,2)
      clineth_4f(i3,i4)%c(1,2)=clineth_4f(i3,i4)%c(1,2)+rmass(id
     & 7)*(lh7_834%c(1,1)*rg8_34(i3,i4)%c(1,2)+lh7_834%a(1,2)*rg
     & 8_34(i3,i4)%d(2,2))
      clineth_4f(i3,i4)%d(1,2)=clineth_4f(i3,i4)%d(1,2)+lh7_834%
     & b(1,1)*rg8_34(i3,i4)%c(1,2)
      end do
      end do
  
      rmassl=rmass(id7)
      rmassr=-rmass(id7)
  
      do i3=1,2
      do i4=1,2
* mline -- res=chqcd3478(i3,i4,&1,&2),abcd=clineth_4f(i3,i4)%,m1=rmassl,
* m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      chqcd3478(i3,i4,iut,jut)=chqcd3478(i3,i4,iut,jut)+clineth_
     & 4f(i3,i4)%a(iut,jut)+rmassl*clineth_4f(i3,i4)%b(iut,jut)+
     & rmassr*clineth_4f(i3,i4)%c(iut,jut)+rmassl*rmassr*clineth
     & _4f(i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
      endif
  
*                                                                       
* Then link the computed subdiagrams with the "higgs" insertion         
* [ch1256(2,2,2,2)]                                                     
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6)   
*                                                                       
  
      if(rmh.ge.0.d0 .and. (id3.eq.5 .or. id7.eq.5))then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) =
     &                       cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) +
     &                       (chqcd3478(i3,i4,i7,i8)*
     &                       ch1256(i1,i2,i5,i6))/
     &                       (p3478q-cmh2)
                      enddo
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
  
**************Compute diagrams of class 2.d) (three-forks)**************
*                                                                       
* Diagrams are built-up by linking the following structures:            
*                                                                       
* u3|_1256     % rg4|_7|8|       [Z/f/h Z/f/h g]                        
* ug3|_7|8|12  % r4|_56          [g Z/f/h Z/f/h + Z/f/h g Z/f/h]        
* ug3|_7|8|56  % r4|_12          [g Z/f/h Z/f/h + Z/f/h g Z/f/h]        
*                                                                       
* where 3|={3,7}, 4|={4,8}, 7|8|={78,34}.                               
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6)   
*                                                                       
  
      rmassl=rmass(id3)
      rmassr=-rmass(id3)
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=cline_3forks_34(i1,i2,i5,i6,i7,i8)%a,bb=cline_3forks_34(i1,i
* 2,i5,i6,i7,i8)%b,cc=cline_3forks_34(i1,i2,i5,i6,i7,i8)%c,dd=cline_3for
* ks_34(i1,i2,i5,i6,i7,i8)%d,a1=u3_1256(i1,i2,i5,i6)%a,b1=u3_1256(i1,i2,
* i5,i6)%b,c1=u3_1256(i1,i2,i5,i6)%c,d1=u3_1256(i1,i2,i5,i6)%d,a2=rg4_78
* (i7,i8)%a,b2=rg4_78(i7,i8)%b,c2=rg4_78(i7,i8)%c,d2=rg4_78(i7,i8)%d,prq
* =p478q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=u3_1256(i1,i2,i5,i6)%a(iut,1)+u3_1256(i1,i2,i5,i6)%c(i
     & ut,1)*rmass(id3)
      cx2=u3_1256(i1,i2,i5,i6)%c(iut,2)*p478q+u3_1256(i1,i2,i5,i
     & 6)%a(iut,2)*rmass(id3)
      cy1=u3_1256(i1,i2,i5,i6)%b(iut,1)+u3_1256(i1,i2,i5,i6)%d(i
     & ut,1)*rmass(id3)
      cy2=u3_1256(i1,i2,i5,i6)%d(iut,2)*p478q+u3_1256(i1,i2,i5,i
     & 6)%b(iut,2)*rmass(id3)
      cw1=u3_1256(i1,i2,i5,i6)%c(iut,1)*p478q+u3_1256(i1,i2,i5,i
     & 6)%a(iut,1)*rmass(id3)
      cw2=u3_1256(i1,i2,i5,i6)%a(iut,2)+u3_1256(i1,i2,i5,i6)%c(i
     & ut,2)*rmass(id3)
      cz1=u3_1256(i1,i2,i5,i6)%d(iut,1)*p478q+u3_1256(i1,i2,i5,i
     & 6)%b(iut,1)*rmass(id3)
      cz2=u3_1256(i1,i2,i5,i6)%b(iut,2)+u3_1256(i1,i2,i5,i6)%d(i
     & ut,2)*rmass(id3)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%a(iut,1)=cx1*rg4_78(i7,
     & i8)%a(1,1)+cx2*rg4_78(i7,i8)%b(2,1)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%b(iut,1)=cy1*rg4_78(i7,
     & i8)%a(1,1)+cy2*rg4_78(i7,i8)%b(2,1)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%c(iut,1)=cw1*rg4_78(i7,
     & i8)%d(1,1)+cw2*rg4_78(i7,i8)%c(2,1)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%d(iut,1)=cz1*rg4_78(i7,
     & i8)%d(1,1)+cz2*rg4_78(i7,i8)%c(2,1)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%a(iut,2)=cw1*rg4_78(i7,
     & i8)%b(1,2)+cw2*rg4_78(i7,i8)%a(2,2)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%b(iut,2)=cz1*rg4_78(i7,
     & i8)%b(1,2)+cz2*rg4_78(i7,i8)%a(2,2)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%c(iut,2)=cx1*rg4_78(i7,
     & i8)%c(1,2)+cx2*rg4_78(i7,i8)%d(2,2)
      cline_3forks_34(i1,i2,i5,i6,i7,i8)%d(iut,2)=cy1*rg4_78(i7,
     & i8)%c(1,2)+cy2*rg4_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* mline -- res=cres_3forks_34(i1,i2,i5,i6,i7,i8)%pol(&1,&2),abcd=cline_3
* forks_34(i1,i2,i5,i6,i7,i8)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_34(i1,i2,i5,i6,i7,i8)%pol(iut,jut)=cline_3fork
     & s_34(i1,i2,i5,i6,i7,i8)%a(iut,jut)+rmassl*cline_3forks_34
     & (i1,i2,i5,i6,i7,i8)%b(iut,jut)+rmassr*cline_3forks_34(i1,
     & i2,i5,i6,i7,i8)%c(iut,jut)+rmassl*rmassr*cline_3forks_34(
     & i1,i2,i5,i6,i7,i8)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) +
     &                     cres_3forks_34(i1,i2,i5,i6,i7,i8)
     &                     %pol(i3,i4)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id5.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=cline_3forks_34(i7,i8,i1,i2,i5,i6)%a,bb=cline_3forks_34(i7,
* i8,i1,i2,i5,i6)%b,cc=cline_3forks_34(i7,i8,i1,i2,i5,i6)%c,dd=cline_3fo
* rks_34(i7,i8,i1,i2,i5,i6)%d,a1=ug3_7812(i7,i8,i1,i2)%a,b1=ug3_7812(i7,
* i8,i1,i2)%b,c1=ug3_7812(i7,i8,i1,i2)%c,d1=ug3_7812(i7,i8,i1,i2)%d,a2=r
* 4_56(i5,i6)%a,b2=r4_56(i5,i6)%b,c2=r4_56(i5,i6)%c,d2=r4_56(i5,i6)%d,pr
* q=p456q,m=rmass(id3),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r4_56(i5,i6)%a(1,jut)+rmass(id3)*r4_56(i5,i6)%b(1,jut)
      cx2=r4_56(i5,i6)%a(2,jut)+rmass(id3)*r4_56(i5,i6)%b(2,jut)
      cy1=p456q*r4_56(i5,i6)%b(1,jut)+rmass(id3)*r4_56(i5,i6)%a(
     & 1,jut)
      cy2=p456q*r4_56(i5,i6)%b(2,jut)+rmass(id3)*r4_56(i5,i6)%a(
     & 2,jut)
      cline_3forks_34(i7,i8,i1,i2,i5,i6)%a(iut,jut)=ug3_7812(i7,
     & i8,i1,i2)%a(iut,1)*cx1+ug3_7812(i7,i8,i1,i2)%c(iut,1)*cy1
     & +ug3_7812(i7,i8,i1,i2)%a(iut,2)*cx2+ug3_7812(i7,i8,i1,i2)
     & %c(iut,2)*cy2
      cline_3forks_34(i7,i8,i1,i2,i5,i6)%b(iut,jut)=ug3_7812(i7,
     & i8,i1,i2)%b(iut,1)*cx1+ug3_7812(i7,i8,i1,i2)%d(iut,1)*cy1
     & +ug3_7812(i7,i8,i1,i2)%b(iut,2)*cx2+ug3_7812(i7,i8,i1,i2)
     & %d(iut,2)*cy2
      cw1=r4_56(i5,i6)%c(1,jut)+rmass(id3)*r4_56(i5,i6)%d(1,jut)
      cw2=r4_56(i5,i6)%c(2,jut)+rmass(id3)*r4_56(i5,i6)%d(2,jut)
      cz1=p456q*r4_56(i5,i6)%d(1,jut)+rmass(id3)*r4_56(i5,i6)%c(
     & 1,jut)
      cz2=p456q*r4_56(i5,i6)%d(2,jut)+rmass(id3)*r4_56(i5,i6)%c(
     & 2,jut)
      cline_3forks_34(i7,i8,i1,i2,i5,i6)%c(iut,jut)=ug3_7812(i7,
     & i8,i1,i2)%a(iut,1)*cw1+ug3_7812(i7,i8,i1,i2)%c(iut,1)*cz1
     & +ug3_7812(i7,i8,i1,i2)%a(iut,2)*cw2+ug3_7812(i7,i8,i1,i2)
     & %c(iut,2)*cz2
      cline_3forks_34(i7,i8,i1,i2,i5,i6)%d(iut,jut)=ug3_7812(i7,
     & i8,i1,i2)%b(iut,1)*cw1+ug3_7812(i7,i8,i1,i2)%d(iut,1)*cz1
     & +ug3_7812(i7,i8,i1,i2)%b(iut,2)*cw2+ug3_7812(i7,i8,i1,i2)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=cline_3forks_34(i7,i8,i1,i2,i5,i6)%a,bb=cline_3forks_34(i7,i
* 8,i1,i2,i5,i6)%b,cc=cline_3forks_34(i7,i8,i1,i2,i5,i6)%c,dd=cline_3for
* ks_34(i7,i8,i1,i2,i5,i6)%d,a1=ug3_7812(i7,i8,i1,i2)%a,b1=ug3_7812(i7,i
* 8,i1,i2)%b,c1=ug3_7812(i7,i8,i1,i2)%c,d1=ug3_7812(i7,i8,i1,i2)%d,a2=r4
* _56(i5,i6)%a,b2=r4_56(i5,i6)%b,c2=r4_56(i5,i6)%c,d2=r4_56(i5,i6)%d,prq
* =p456q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=ug3_7812(i7,i8,i1,i2)%a(iut,1)+ug3_7812(i7,i8,i1,i2)%c
     & (iut,1)*rmass(id3)
      cx2=ug3_7812(i7,i8,i1,i2)%c(iut,2)*p456q+ug3_7812(i7,i8,i1
     & ,i2)%a(iut,2)*rmass(id3)
      cy1=ug3_7812(i7,i8,i1,i2)%b(iut,1)+ug3_7812(i7,i8,i1,i2)%d
     & (iut,1)*rmass(id3)
      cy2=ug3_7812(i7,i8,i1,i2)%d(iut,2)*p456q+ug3_7812(i7,i8,i1
     & ,i2)%b(iut,2)*rmass(id3)
      cw1=ug3_7812(i7,i8,i1,i2)%c(iut,1)*p456q+ug3_7812(i7,i8,i1
     & ,i2)%a(iut,1)*rmass(id3)
      cw2=ug3_7812(i7,i8,i1,i2)%a(iut,2)+ug3_7812(i7,i8,i1,i2)%c
     & (iut,2)*rmass(id3)
      cz1=ug3_7812(i7,i8,i1,i2)%d(iut,1)*p456q+ug3_7812(i7,i8,i1
     & ,i2)%b(iut,1)*rmass(id3)
      cz2=ug3_7812(i7,i8,i1,i2)%b(iut,2)+ug3_7812(i7,i8,i1,i2)%d
     & (iut,2)*rmass(id3)
      cline_3forks_34(i7,i8,i1,i2,i5,i6)%a(iut,1)=cx1*r4_56(i5,i
     & 6)%a(1,1)+cx2*r4_56(i5,i6)%b(2,1)
      cline_3forks_34(i7,i8,i1,i2,i5,i6)%b(iut,1)=cy1*r4_56(i5,i
     & 6)%a(1,1)+cy2*r4_56(i5,i6)%b(2,1)
      cline_3forks_34(i7,i8,i1,i2,i5,i6)%c(iut,1)=cw1*r4_56(i5,i
     & 6)%d(1,1)+cw2*r4_56(i5,i6)%c(2,1)
      cline_3forks_34(i7,i8,i1,i2,i5,i6)%d(iut,1)=cz1*r4_56(i5,i
     & 6)%d(1,1)+cz2*r4_56(i5,i6)%c(2,1)
      cline_3forks_34(i7,i8,i1,i2,i5,i6)%a(iut,2)=cw1*r4_56(i5,i
     & 6)%b(1,2)+cw2*r4_56(i5,i6)%a(2,2)
      cline_3forks_34(i7,i8,i1,i2,i5,i6)%b(iut,2)=cz1*r4_56(i5,i
     & 6)%b(1,2)+cz2*r4_56(i5,i6)%a(2,2)
      cline_3forks_34(i7,i8,i1,i2,i5,i6)%c(iut,2)=cx1*r4_56(i5,i
     & 6)%c(1,2)+cx2*r4_56(i5,i6)%d(2,2)
      cline_3forks_34(i7,i8,i1,i2,i5,i6)%d(iut,2)=cy1*r4_56(i5,i
     & 6)%c(1,2)+cy2*r4_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* mline -- res=cres_3forks_34(i7,i8,i1,i2,i5,i6)%pol(&1,&2),abcd=cline_3
* forks_34(i7,i8,i1,i2,i5,i6)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_34(i7,i8,i1,i2,i5,i6)%pol(iut,jut)=cline_3fork
     & s_34(i7,i8,i1,i2,i5,i6)%a(iut,jut)+rmassl*cline_3forks_34
     & (i7,i8,i1,i2,i5,i6)%b(iut,jut)+rmassr*cline_3forks_34(i7,
     & i8,i1,i2,i5,i6)%c(iut,jut)+rmassl*rmassr*cline_3forks_34(
     & i7,i8,i1,i2,i5,i6)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) +
     &                     cres_3forks_34(i7,i8,i1,i2,i5,i6)
     &                     %pol(i3,i4)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
      if(id1.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* TsTs -- aa=cline_3forks_34(i7,i8,i5,i6,i1,i2)%a,bb=cline_3forks_34(i7,
* i8,i5,i6,i1,i2)%b,cc=cline_3forks_34(i7,i8,i5,i6,i1,i2)%c,dd=cline_3fo
* rks_34(i7,i8,i5,i6,i1,i2)%d,a1=ug3_7856(i7,i8,i5,i6)%a,b1=ug3_7856(i7,
* i8,i5,i6)%b,c1=ug3_7856(i7,i8,i5,i6)%c,d1=ug3_7856(i7,i8,i5,i6)%d,a2=r
* 4_12(i1,i2)%a,b2=r4_12(i1,i2)%b,c2=r4_12(i1,i2)%c,d2=r4_12(i1,i2)%d,pr
* q=p412q,m=rmass(id3),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r4_12(i1,i2)%a(1,jut)+rmass(id3)*r4_12(i1,i2)%b(1,jut)
      cx2=r4_12(i1,i2)%a(2,jut)+rmass(id3)*r4_12(i1,i2)%b(2,jut)
      cy1=p412q*r4_12(i1,i2)%b(1,jut)+rmass(id3)*r4_12(i1,i2)%a(
     & 1,jut)
      cy2=p412q*r4_12(i1,i2)%b(2,jut)+rmass(id3)*r4_12(i1,i2)%a(
     & 2,jut)
      cline_3forks_34(i7,i8,i5,i6,i1,i2)%a(iut,jut)=ug3_7856(i7,
     & i8,i5,i6)%a(iut,1)*cx1+ug3_7856(i7,i8,i5,i6)%c(iut,1)*cy1
     & +ug3_7856(i7,i8,i5,i6)%a(iut,2)*cx2+ug3_7856(i7,i8,i5,i6)
     & %c(iut,2)*cy2
      cline_3forks_34(i7,i8,i5,i6,i1,i2)%b(iut,jut)=ug3_7856(i7,
     & i8,i5,i6)%b(iut,1)*cx1+ug3_7856(i7,i8,i5,i6)%d(iut,1)*cy1
     & +ug3_7856(i7,i8,i5,i6)%b(iut,2)*cx2+ug3_7856(i7,i8,i5,i6)
     & %d(iut,2)*cy2
      cw1=r4_12(i1,i2)%c(1,jut)+rmass(id3)*r4_12(i1,i2)%d(1,jut)
      cw2=r4_12(i1,i2)%c(2,jut)+rmass(id3)*r4_12(i1,i2)%d(2,jut)
      cz1=p412q*r4_12(i1,i2)%d(1,jut)+rmass(id3)*r4_12(i1,i2)%c(
     & 1,jut)
      cz2=p412q*r4_12(i1,i2)%d(2,jut)+rmass(id3)*r4_12(i1,i2)%c(
     & 2,jut)
      cline_3forks_34(i7,i8,i5,i6,i1,i2)%c(iut,jut)=ug3_7856(i7,
     & i8,i5,i6)%a(iut,1)*cw1+ug3_7856(i7,i8,i5,i6)%c(iut,1)*cz1
     & +ug3_7856(i7,i8,i5,i6)%a(iut,2)*cw2+ug3_7856(i7,i8,i5,i6)
     & %c(iut,2)*cz2
      cline_3forks_34(i7,i8,i5,i6,i1,i2)%d(iut,jut)=ug3_7856(i7,
     & i8,i5,i6)%b(iut,1)*cw1+ug3_7856(i7,i8,i5,i6)%d(iut,1)*cz1
     & +ug3_7856(i7,i8,i5,i6)%b(iut,2)*cw2+ug3_7856(i7,i8,i5,i6)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=cline_3forks_34(i7,i8,i5,i6,i1,i2)%a,bb=cline_3forks_34(i7,i
* 8,i5,i6,i1,i2)%b,cc=cline_3forks_34(i7,i8,i5,i6,i1,i2)%c,dd=cline_3for
* ks_34(i7,i8,i5,i6,i1,i2)%d,a1=ug3_7856(i7,i8,i5,i6)%a,b1=ug3_7856(i7,i
* 8,i5,i6)%b,c1=ug3_7856(i7,i8,i5,i6)%c,d1=ug3_7856(i7,i8,i5,i6)%d,a2=r4
* _12(i1,i2)%a,b2=r4_12(i1,i2)%b,c2=r4_12(i1,i2)%c,d2=r4_12(i1,i2)%d,prq
* =p412q,m=rmass(id3),nsum=0
      do iut=1,2
      cx1=ug3_7856(i7,i8,i5,i6)%a(iut,1)+ug3_7856(i7,i8,i5,i6)%c
     & (iut,1)*rmass(id3)
      cx2=ug3_7856(i7,i8,i5,i6)%c(iut,2)*p412q+ug3_7856(i7,i8,i5
     & ,i6)%a(iut,2)*rmass(id3)
      cy1=ug3_7856(i7,i8,i5,i6)%b(iut,1)+ug3_7856(i7,i8,i5,i6)%d
     & (iut,1)*rmass(id3)
      cy2=ug3_7856(i7,i8,i5,i6)%d(iut,2)*p412q+ug3_7856(i7,i8,i5
     & ,i6)%b(iut,2)*rmass(id3)
      cw1=ug3_7856(i7,i8,i5,i6)%c(iut,1)*p412q+ug3_7856(i7,i8,i5
     & ,i6)%a(iut,1)*rmass(id3)
      cw2=ug3_7856(i7,i8,i5,i6)%a(iut,2)+ug3_7856(i7,i8,i5,i6)%c
     & (iut,2)*rmass(id3)
      cz1=ug3_7856(i7,i8,i5,i6)%d(iut,1)*p412q+ug3_7856(i7,i8,i5
     & ,i6)%b(iut,1)*rmass(id3)
      cz2=ug3_7856(i7,i8,i5,i6)%b(iut,2)+ug3_7856(i7,i8,i5,i6)%d
     & (iut,2)*rmass(id3)
      cline_3forks_34(i7,i8,i5,i6,i1,i2)%a(iut,1)=cx1*r4_12(i1,i
     & 2)%a(1,1)+cx2*r4_12(i1,i2)%b(2,1)
      cline_3forks_34(i7,i8,i5,i6,i1,i2)%b(iut,1)=cy1*r4_12(i1,i
     & 2)%a(1,1)+cy2*r4_12(i1,i2)%b(2,1)
      cline_3forks_34(i7,i8,i5,i6,i1,i2)%c(iut,1)=cw1*r4_12(i1,i
     & 2)%d(1,1)+cw2*r4_12(i1,i2)%c(2,1)
      cline_3forks_34(i7,i8,i5,i6,i1,i2)%d(iut,1)=cz1*r4_12(i1,i
     & 2)%d(1,1)+cz2*r4_12(i1,i2)%c(2,1)
      cline_3forks_34(i7,i8,i5,i6,i1,i2)%a(iut,2)=cw1*r4_12(i1,i
     & 2)%b(1,2)+cw2*r4_12(i1,i2)%a(2,2)
      cline_3forks_34(i7,i8,i5,i6,i1,i2)%b(iut,2)=cz1*r4_12(i1,i
     & 2)%b(1,2)+cz2*r4_12(i1,i2)%a(2,2)
      cline_3forks_34(i7,i8,i5,i6,i1,i2)%c(iut,2)=cx1*r4_12(i1,i
     & 2)%c(1,2)+cx2*r4_12(i1,i2)%d(2,2)
      cline_3forks_34(i7,i8,i5,i6,i1,i2)%d(iut,2)=cy1*r4_12(i1,i
     & 2)%c(1,2)+cy2*r4_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i7=1,2
      do i8=1,2
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* mline -- res=cres_3forks_34(i7,i8,i5,i6,i1,i2)%pol(&1,&2),abcd=cline_3
* forks_34(i7,i8,i5,i6,i1,i2)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_34(i7,i8,i5,i6,i1,i2)%pol(iut,jut)=cline_3fork
     & s_34(i7,i8,i5,i6,i1,i2)%a(iut,jut)+rmassl*cline_3forks_34
     & (i7,i8,i5,i6,i1,i2)%b(iut,jut)+rmassr*cline_3forks_34(i7,
     & i8,i5,i6,i1,i2)%c(iut,jut)+rmassl*rmassr*cline_3forks_34(
     & i7,i8,i5,i6,i1,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) +
     &                     cres_3forks_34(i7,i8,i5,i6,i1,i2)
     &                     %pol(i3,i4)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
  
      rmassl=rmass(id7)
      rmassr=-rmass(id7)
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=cline_3forks_78(i1,i2,i5,i6,i3,i4)%a,bb=cline_3forks_78(i1,i
* 2,i5,i6,i3,i4)%b,cc=cline_3forks_78(i1,i2,i5,i6,i3,i4)%c,dd=cline_3for
* ks_78(i1,i2,i5,i6,i3,i4)%d,a1=u7_1256(i1,i2,i5,i6)%a,b1=u7_1256(i1,i2,
* i5,i6)%b,c1=u7_1256(i1,i2,i5,i6)%c,d1=u7_1256(i1,i2,i5,i6)%d,a2=rg8_34
* (i3,i4)%a,b2=rg8_34(i3,i4)%b,c2=rg8_34(i3,i4)%c,d2=rg8_34(i3,i4)%d,prq
* =p834q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=u7_1256(i1,i2,i5,i6)%a(iut,1)+u7_1256(i1,i2,i5,i6)%c(i
     & ut,1)*rmass(id7)
      cx2=u7_1256(i1,i2,i5,i6)%c(iut,2)*p834q+u7_1256(i1,i2,i5,i
     & 6)%a(iut,2)*rmass(id7)
      cy1=u7_1256(i1,i2,i5,i6)%b(iut,1)+u7_1256(i1,i2,i5,i6)%d(i
     & ut,1)*rmass(id7)
      cy2=u7_1256(i1,i2,i5,i6)%d(iut,2)*p834q+u7_1256(i1,i2,i5,i
     & 6)%b(iut,2)*rmass(id7)
      cw1=u7_1256(i1,i2,i5,i6)%c(iut,1)*p834q+u7_1256(i1,i2,i5,i
     & 6)%a(iut,1)*rmass(id7)
      cw2=u7_1256(i1,i2,i5,i6)%a(iut,2)+u7_1256(i1,i2,i5,i6)%c(i
     & ut,2)*rmass(id7)
      cz1=u7_1256(i1,i2,i5,i6)%d(iut,1)*p834q+u7_1256(i1,i2,i5,i
     & 6)%b(iut,1)*rmass(id7)
      cz2=u7_1256(i1,i2,i5,i6)%b(iut,2)+u7_1256(i1,i2,i5,i6)%d(i
     & ut,2)*rmass(id7)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%a(iut,1)=cx1*rg8_34(i3,
     & i4)%a(1,1)+cx2*rg8_34(i3,i4)%b(2,1)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%b(iut,1)=cy1*rg8_34(i3,
     & i4)%a(1,1)+cy2*rg8_34(i3,i4)%b(2,1)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%c(iut,1)=cw1*rg8_34(i3,
     & i4)%d(1,1)+cw2*rg8_34(i3,i4)%c(2,1)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%d(iut,1)=cz1*rg8_34(i3,
     & i4)%d(1,1)+cz2*rg8_34(i3,i4)%c(2,1)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%a(iut,2)=cw1*rg8_34(i3,
     & i4)%b(1,2)+cw2*rg8_34(i3,i4)%a(2,2)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%b(iut,2)=cz1*rg8_34(i3,
     & i4)%b(1,2)+cz2*rg8_34(i3,i4)%a(2,2)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%c(iut,2)=cx1*rg8_34(i3,
     & i4)%c(1,2)+cx2*rg8_34(i3,i4)%d(2,2)
      cline_3forks_78(i1,i2,i5,i6,i3,i4)%d(iut,2)=cy1*rg8_34(i3,
     & i4)%c(1,2)+cy2*rg8_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
* mline -- res=cres_3forks_78(i1,i2,i5,i6,i3,i4)%pol(&1,&2),abcd=cline_3
* forks_78(i1,i2,i5,i6,i3,i4)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_78(i1,i2,i5,i6,i3,i4)%pol(iut,jut)=cline_3fork
     & s_78(i1,i2,i5,i6,i3,i4)%a(iut,jut)+rmassl*cline_3forks_78
     & (i1,i2,i5,i6,i3,i4)%b(iut,jut)+rmassr*cline_3forks_78(i1,
     & i2,i5,i6,i3,i4)%c(iut,jut)+rmassl*rmassr*cline_3forks_78(
     & i1,i2,i5,i6,i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) +
     &                     cres_3forks_78(i1,i2,i5,i6,i3,i4)
     &                     %pol(i7,i8)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id5.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TsTs -- aa=cline_3forks_78(i3,i4,i1,i2,i5,i6)%a,bb=cline_3forks_78(i3,
* i4,i1,i2,i5,i6)%b,cc=cline_3forks_78(i3,i4,i1,i2,i5,i6)%c,dd=cline_3fo
* rks_78(i3,i4,i1,i2,i5,i6)%d,a1=ug7_3412(i3,i4,i1,i2)%a,b1=ug7_3412(i3,
* i4,i1,i2)%b,c1=ug7_3412(i3,i4,i1,i2)%c,d1=ug7_3412(i3,i4,i1,i2)%d,a2=r
* 8_56(i5,i6)%a,b2=r8_56(i5,i6)%b,c2=r8_56(i5,i6)%c,d2=r8_56(i5,i6)%d,pr
* q=p856q,m=rmass(id7),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r8_56(i5,i6)%a(1,jut)+rmass(id7)*r8_56(i5,i6)%b(1,jut)
      cx2=r8_56(i5,i6)%a(2,jut)+rmass(id7)*r8_56(i5,i6)%b(2,jut)
      cy1=p856q*r8_56(i5,i6)%b(1,jut)+rmass(id7)*r8_56(i5,i6)%a(
     & 1,jut)
      cy2=p856q*r8_56(i5,i6)%b(2,jut)+rmass(id7)*r8_56(i5,i6)%a(
     & 2,jut)
      cline_3forks_78(i3,i4,i1,i2,i5,i6)%a(iut,jut)=ug7_3412(i3,
     & i4,i1,i2)%a(iut,1)*cx1+ug7_3412(i3,i4,i1,i2)%c(iut,1)*cy1
     & +ug7_3412(i3,i4,i1,i2)%a(iut,2)*cx2+ug7_3412(i3,i4,i1,i2)
     & %c(iut,2)*cy2
      cline_3forks_78(i3,i4,i1,i2,i5,i6)%b(iut,jut)=ug7_3412(i3,
     & i4,i1,i2)%b(iut,1)*cx1+ug7_3412(i3,i4,i1,i2)%d(iut,1)*cy1
     & +ug7_3412(i3,i4,i1,i2)%b(iut,2)*cx2+ug7_3412(i3,i4,i1,i2)
     & %d(iut,2)*cy2
      cw1=r8_56(i5,i6)%c(1,jut)+rmass(id7)*r8_56(i5,i6)%d(1,jut)
      cw2=r8_56(i5,i6)%c(2,jut)+rmass(id7)*r8_56(i5,i6)%d(2,jut)
      cz1=p856q*r8_56(i5,i6)%d(1,jut)+rmass(id7)*r8_56(i5,i6)%c(
     & 1,jut)
      cz2=p856q*r8_56(i5,i6)%d(2,jut)+rmass(id7)*r8_56(i5,i6)%c(
     & 2,jut)
      cline_3forks_78(i3,i4,i1,i2,i5,i6)%c(iut,jut)=ug7_3412(i3,
     & i4,i1,i2)%a(iut,1)*cw1+ug7_3412(i3,i4,i1,i2)%c(iut,1)*cz1
     & +ug7_3412(i3,i4,i1,i2)%a(iut,2)*cw2+ug7_3412(i3,i4,i1,i2)
     & %c(iut,2)*cz2
      cline_3forks_78(i3,i4,i1,i2,i5,i6)%d(iut,jut)=ug7_3412(i3,
     & i4,i1,i2)%b(iut,1)*cw1+ug7_3412(i3,i4,i1,i2)%d(iut,1)*cz1
     & +ug7_3412(i3,i4,i1,i2)%b(iut,2)*cw2+ug7_3412(i3,i4,i1,i2)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=cline_3forks_78(i3,i4,i1,i2,i5,i6)%a,bb=cline_3forks_78(i3,i
* 4,i1,i2,i5,i6)%b,cc=cline_3forks_78(i3,i4,i1,i2,i5,i6)%c,dd=cline_3for
* ks_78(i3,i4,i1,i2,i5,i6)%d,a1=ug7_3412(i3,i4,i1,i2)%a,b1=ug7_3412(i3,i
* 4,i1,i2)%b,c1=ug7_3412(i3,i4,i1,i2)%c,d1=ug7_3412(i3,i4,i1,i2)%d,a2=r8
* _56(i5,i6)%a,b2=r8_56(i5,i6)%b,c2=r8_56(i5,i6)%c,d2=r8_56(i5,i6)%d,prq
* =p856q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=ug7_3412(i3,i4,i1,i2)%a(iut,1)+ug7_3412(i3,i4,i1,i2)%c
     & (iut,1)*rmass(id7)
      cx2=ug7_3412(i3,i4,i1,i2)%c(iut,2)*p856q+ug7_3412(i3,i4,i1
     & ,i2)%a(iut,2)*rmass(id7)
      cy1=ug7_3412(i3,i4,i1,i2)%b(iut,1)+ug7_3412(i3,i4,i1,i2)%d
     & (iut,1)*rmass(id7)
      cy2=ug7_3412(i3,i4,i1,i2)%d(iut,2)*p856q+ug7_3412(i3,i4,i1
     & ,i2)%b(iut,2)*rmass(id7)
      cw1=ug7_3412(i3,i4,i1,i2)%c(iut,1)*p856q+ug7_3412(i3,i4,i1
     & ,i2)%a(iut,1)*rmass(id7)
      cw2=ug7_3412(i3,i4,i1,i2)%a(iut,2)+ug7_3412(i3,i4,i1,i2)%c
     & (iut,2)*rmass(id7)
      cz1=ug7_3412(i3,i4,i1,i2)%d(iut,1)*p856q+ug7_3412(i3,i4,i1
     & ,i2)%b(iut,1)*rmass(id7)
      cz2=ug7_3412(i3,i4,i1,i2)%b(iut,2)+ug7_3412(i3,i4,i1,i2)%d
     & (iut,2)*rmass(id7)
      cline_3forks_78(i3,i4,i1,i2,i5,i6)%a(iut,1)=cx1*r8_56(i5,i
     & 6)%a(1,1)+cx2*r8_56(i5,i6)%b(2,1)
      cline_3forks_78(i3,i4,i1,i2,i5,i6)%b(iut,1)=cy1*r8_56(i5,i
     & 6)%a(1,1)+cy2*r8_56(i5,i6)%b(2,1)
      cline_3forks_78(i3,i4,i1,i2,i5,i6)%c(iut,1)=cw1*r8_56(i5,i
     & 6)%d(1,1)+cw2*r8_56(i5,i6)%c(2,1)
      cline_3forks_78(i3,i4,i1,i2,i5,i6)%d(iut,1)=cz1*r8_56(i5,i
     & 6)%d(1,1)+cz2*r8_56(i5,i6)%c(2,1)
      cline_3forks_78(i3,i4,i1,i2,i5,i6)%a(iut,2)=cw1*r8_56(i5,i
     & 6)%b(1,2)+cw2*r8_56(i5,i6)%a(2,2)
      cline_3forks_78(i3,i4,i1,i2,i5,i6)%b(iut,2)=cz1*r8_56(i5,i
     & 6)%b(1,2)+cz2*r8_56(i5,i6)%a(2,2)
      cline_3forks_78(i3,i4,i1,i2,i5,i6)%c(iut,2)=cx1*r8_56(i5,i
     & 6)%c(1,2)+cx2*r8_56(i5,i6)%d(2,2)
      cline_3forks_78(i3,i4,i1,i2,i5,i6)%d(iut,2)=cy1*r8_56(i5,i
     & 6)%c(1,2)+cy2*r8_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
      do i5=1,2
      do i6=1,2
* mline -- res=cres_3forks_78(i3,i4,i1,i2,i5,i6)%pol(&1,&2),abcd=cline_3
* forks_78(i3,i4,i1,i2,i5,i6)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_78(i3,i4,i1,i2,i5,i6)%pol(iut,jut)=cline_3fork
     & s_78(i3,i4,i1,i2,i5,i6)%a(iut,jut)+rmassl*cline_3forks_78
     & (i3,i4,i1,i2,i5,i6)%b(iut,jut)+rmassr*cline_3forks_78(i3,
     & i4,i1,i2,i5,i6)%c(iut,jut)+rmassl*rmassr*cline_3forks_78(
     & i3,i4,i1,i2,i5,i6)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) +
     &                     cres_3forks_78(i3,i4,i1,i2,i5,i6)
     &                     %pol(i7,i8)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id1.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* TsTs -- aa=cline_3forks_78(i3,i4,i5,i6,i1,i2)%a,bb=cline_3forks_78(i3,
* i4,i5,i6,i1,i2)%b,cc=cline_3forks_78(i3,i4,i5,i6,i1,i2)%c,dd=cline_3fo
* rks_78(i3,i4,i5,i6,i1,i2)%d,a1=ug7_3456(i3,i4,i5,i6)%a,b1=ug7_3456(i3,
* i4,i5,i6)%b,c1=ug7_3456(i3,i4,i5,i6)%c,d1=ug7_3456(i3,i4,i5,i6)%d,a2=r
* 8_12(i1,i2)%a,b2=r8_12(i1,i2)%b,c2=r8_12(i1,i2)%c,d2=r8_12(i1,i2)%d,pr
* q=p812q,m=rmass(id7),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r8_12(i1,i2)%a(1,jut)+rmass(id7)*r8_12(i1,i2)%b(1,jut)
      cx2=r8_12(i1,i2)%a(2,jut)+rmass(id7)*r8_12(i1,i2)%b(2,jut)
      cy1=p812q*r8_12(i1,i2)%b(1,jut)+rmass(id7)*r8_12(i1,i2)%a(
     & 1,jut)
      cy2=p812q*r8_12(i1,i2)%b(2,jut)+rmass(id7)*r8_12(i1,i2)%a(
     & 2,jut)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%a(iut,jut)=ug7_3456(i3,
     & i4,i5,i6)%a(iut,1)*cx1+ug7_3456(i3,i4,i5,i6)%c(iut,1)*cy1
     & +ug7_3456(i3,i4,i5,i6)%a(iut,2)*cx2+ug7_3456(i3,i4,i5,i6)
     & %c(iut,2)*cy2
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%b(iut,jut)=ug7_3456(i3,
     & i4,i5,i6)%b(iut,1)*cx1+ug7_3456(i3,i4,i5,i6)%d(iut,1)*cy1
     & +ug7_3456(i3,i4,i5,i6)%b(iut,2)*cx2+ug7_3456(i3,i4,i5,i6)
     & %d(iut,2)*cy2
      cw1=r8_12(i1,i2)%c(1,jut)+rmass(id7)*r8_12(i1,i2)%d(1,jut)
      cw2=r8_12(i1,i2)%c(2,jut)+rmass(id7)*r8_12(i1,i2)%d(2,jut)
      cz1=p812q*r8_12(i1,i2)%d(1,jut)+rmass(id7)*r8_12(i1,i2)%c(
     & 1,jut)
      cz2=p812q*r8_12(i1,i2)%d(2,jut)+rmass(id7)*r8_12(i1,i2)%c(
     & 2,jut)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%c(iut,jut)=ug7_3456(i3,
     & i4,i5,i6)%a(iut,1)*cw1+ug7_3456(i3,i4,i5,i6)%c(iut,1)*cz1
     & +ug7_3456(i3,i4,i5,i6)%a(iut,2)*cw2+ug7_3456(i3,i4,i5,i6)
     & %c(iut,2)*cz2
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%d(iut,jut)=ug7_3456(i3,
     & i4,i5,i6)%b(iut,1)*cw1+ug7_3456(i3,i4,i5,i6)%d(iut,1)*cz1
     & +ug7_3456(i3,i4,i5,i6)%b(iut,2)*cw2+ug7_3456(i3,i4,i5,i6)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=cline_3forks_78(i3,i4,i5,i6,i1,i2)%a,bb=cline_3forks_78(i3,i
* 4,i5,i6,i1,i2)%b,cc=cline_3forks_78(i3,i4,i5,i6,i1,i2)%c,dd=cline_3for
* ks_78(i3,i4,i5,i6,i1,i2)%d,a1=ug7_3456(i3,i4,i5,i6)%a,b1=ug7_3456(i3,i
* 4,i5,i6)%b,c1=ug7_3456(i3,i4,i5,i6)%c,d1=ug7_3456(i3,i4,i5,i6)%d,a2=r8
* _12(i1,i2)%a,b2=r8_12(i1,i2)%b,c2=r8_12(i1,i2)%c,d2=r8_12(i1,i2)%d,prq
* =p812q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=ug7_3456(i3,i4,i5,i6)%a(iut,1)+ug7_3456(i3,i4,i5,i6)%c
     & (iut,1)*rmass(id7)
      cx2=ug7_3456(i3,i4,i5,i6)%c(iut,2)*p812q+ug7_3456(i3,i4,i5
     & ,i6)%a(iut,2)*rmass(id7)
      cy1=ug7_3456(i3,i4,i5,i6)%b(iut,1)+ug7_3456(i3,i4,i5,i6)%d
     & (iut,1)*rmass(id7)
      cy2=ug7_3456(i3,i4,i5,i6)%d(iut,2)*p812q+ug7_3456(i3,i4,i5
     & ,i6)%b(iut,2)*rmass(id7)
      cw1=ug7_3456(i3,i4,i5,i6)%c(iut,1)*p812q+ug7_3456(i3,i4,i5
     & ,i6)%a(iut,1)*rmass(id7)
      cw2=ug7_3456(i3,i4,i5,i6)%a(iut,2)+ug7_3456(i3,i4,i5,i6)%c
     & (iut,2)*rmass(id7)
      cz1=ug7_3456(i3,i4,i5,i6)%d(iut,1)*p812q+ug7_3456(i3,i4,i5
     & ,i6)%b(iut,1)*rmass(id7)
      cz2=ug7_3456(i3,i4,i5,i6)%b(iut,2)+ug7_3456(i3,i4,i5,i6)%d
     & (iut,2)*rmass(id7)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%a(iut,1)=cx1*r8_12(i1,i
     & 2)%a(1,1)+cx2*r8_12(i1,i2)%b(2,1)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%b(iut,1)=cy1*r8_12(i1,i
     & 2)%a(1,1)+cy2*r8_12(i1,i2)%b(2,1)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%c(iut,1)=cw1*r8_12(i1,i
     & 2)%d(1,1)+cw2*r8_12(i1,i2)%c(2,1)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%d(iut,1)=cz1*r8_12(i1,i
     & 2)%d(1,1)+cz2*r8_12(i1,i2)%c(2,1)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%a(iut,2)=cw1*r8_12(i1,i
     & 2)%b(1,2)+cw2*r8_12(i1,i2)%a(2,2)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%b(iut,2)=cz1*r8_12(i1,i
     & 2)%b(1,2)+cz2*r8_12(i1,i2)%a(2,2)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%c(iut,2)=cx1*r8_12(i1,i
     & 2)%c(1,2)+cx2*r8_12(i1,i2)%d(2,2)
      cline_3forks_78(i3,i4,i5,i6,i1,i2)%d(iut,2)=cy1*r8_12(i1,i
     & 2)%c(1,2)+cy2*r8_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
* mline -- res=cres_3forks_78(i3,i4,i5,i6,i1,i2)%pol(&1,&2),abcd=cline_3
* forks_78(i3,i4,i5,i6,i1,i2)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_78(i3,i4,i5,i6,i1,i2)%pol(iut,jut)=cline_3fork
     & s_78(i3,i4,i5,i6,i1,i2)%a(iut,jut)+rmassl*cline_3forks_78
     & (i3,i4,i5,i6,i1,i2)%b(iut,jut)+rmassr*cline_3forks_78(i3,
     & i4,i5,i6,i1,i2)%c(iut,jut)+rmassl*rmassr*cline_3forks_78(
     & i3,i4,i5,i6,i1,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,6) +
     &                     cres_3forks_78(i3,i4,i5,i6,i1,i2)
     &                     %pol(i7,i8)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
      endif    !if((ilept(id3).ne.1) .and. (ilept(id7).ne.1))
  
  
  
************************************************************************
******Color configuration no. 7 ***** [cres(...).caux(i7,i8,7)]*******  
************************************************************************
*                                                                       
*                           1| 5| 7| 3|                                 
*                            |  |~~|  |                                 
*                           2| 6| 8| 4|                                 
*                                                                       
*                                                                       
*Sum the diagrams belonging to classes 1), 2.a), 2.b), 2.c), 2.d) in    
*which the gluon connects Zlines 56 and 78                              
  
      if((ilept(id5).ne.1) .and. (ilept(id7).ne.1)) then
  
*****************Compute diagrams of class 1)***************************
*Link cg5612(2,2,2,2,0:3) with cg7834(2,2,2,2,0:3)                      
*     cg5634(2,2,2,2,0:3) with cg7812(2,2,2,2,0:3)                      
*The result is directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7)  
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7),p=cg5612(i5,i6,i1,i2,
* #),q=cg7834(i7,i8,i3,i4,#),bef=-,aft=/p1256q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7)=-(cg5612(i5,i6,i1,i2
     & ,0)*cg7834(i7,i8,i3,i4,0)-cg5612(i5,i6,i1,i2,1)*cg7834(i7
     & ,i8,i3,i4,1)-cg5612(i5,i6,i1,i2,2)*cg7834(i7,i8,i3,i4,2)-
     & cg5612(i5,i6,i1,i2,3)*cg7834(i7,i8,i3,i4,3))/p1256q
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
      do i7=1,2
      do i8=1,2
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7),p=cg5634(i5,i6,i3,i4,
* #),q=cg7812(i7,i8,i1,i2,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7)-,
* aft=/p3456q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,7)-(cg5634(i5,i6,i3,i4,0)*cg7812(i7,i8,i1,
     & i2,0)-cg5634(i5,i6,i3,i4,1)*cg7812(i7,i8,i1,i2,1)-cg5634(
     & i5,i6,i3,i4,2)*cg7812(i7,i8,i1,i2,2)-cg5634(i5,i6,i3,i4,3
     & )*cg7812(i7,i8,i1,i2,3))/p3456q
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
  
*****************Compute diagrams of class 2.a) and 2.b)****************
*                                                                       
* First compute subdiagrams of the type  [czqcd5678(2,2,2,2,0:3)]       
*                                        [cfqcd5678(2,2,2,2,0:3)]       
  
  
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TT -- aa=clinetzz(i5,i6,mu)%a,bb=clinetzz(i5,i6,mu)%b,cc=clinetzz(i5,i
* 6,mu)%c,dd=clinetzz(i5,i6,mu)%d,a1=lg7_56(i5,i6)%a,b1=lg7_56(i5,i6)%b,
* c1=lg7_56(i5,i6)%c,d1=lg7_56(i5,i6)%d,a2=rz8_756(mu)%a,b2=rz8_756(mu)%
* b,c2=rz8_756(mu)%c,d2=rz8_756(mu)%d,prq=p756q,m=rmass(id7),nsum=0
      clinetzz(i5,i6,mu)%a(1,1)=lg7_56(i5,i6)%a(1,1)*rz8_756(mu)
     & %a(1,1)+lg7_56(i5,i6)%c(1,2)*p756q*rz8_756(mu)%b(2,1)
      clinetzz(i5,i6,mu)%b(1,1)=rmass(id7)*(lg7_56(i5,i6)%d(1,1)
     & *rz8_756(mu)%a(1,1)+lg7_56(i5,i6)%b(1,2)*rz8_756(mu)%b(2,
     & 1))
      clinetzz(i5,i6,mu)%c(1,1)=rmass(id7)*(lg7_56(i5,i6)%a(1,1)
     & *rz8_756(mu)%d(1,1)+lg7_56(i5,i6)%c(1,2)*rz8_756(mu)%c(2,
     & 1))
      clinetzz(i5,i6,mu)%d(1,1)=lg7_56(i5,i6)%d(1,1)*p756q*rz8_7
     & 56(mu)%d(1,1)+lg7_56(i5,i6)%b(1,2)*rz8_756(mu)%c(2,1)
      clinetzz(i5,i6,mu)%a(1,2)=rmass(id7)*(lg7_56(i5,i6)%a(1,1)
     & *rz8_756(mu)%b(1,2)+lg7_56(i5,i6)%c(1,2)*rz8_756(mu)%a(2,
     & 2))
      clinetzz(i5,i6,mu)%b(1,2)=lg7_56(i5,i6)%d(1,1)*p756q*rz8_7
     & 56(mu)%b(1,2)+lg7_56(i5,i6)%b(1,2)*rz8_756(mu)%a(2,2)
      clinetzz(i5,i6,mu)%c(1,2)=lg7_56(i5,i6)%a(1,1)*rz8_756(mu)
     & %c(1,2)+lg7_56(i5,i6)%c(1,2)*p756q*rz8_756(mu)%d(2,2)
      clinetzz(i5,i6,mu)%d(1,2)=rmass(id7)*(lg7_56(i5,i6)%d(1,1)
     & *rz8_756(mu)%c(1,2)+lg7_56(i5,i6)%b(1,2)*rz8_756(mu)%d(2,
     & 2))
      clinetzz(i5,i6,mu)%a(2,1)=rmass(id7)*(lg7_56(i5,i6)%c(2,1)
     & *rz8_756(mu)%a(1,1)+lg7_56(i5,i6)%a(2,2)*rz8_756(mu)%b(2,
     & 1))
      clinetzz(i5,i6,mu)%b(2,1)=lg7_56(i5,i6)%b(2,1)*rz8_756(mu)
     & %a(1,1)+lg7_56(i5,i6)%d(2,2)*p756q*rz8_756(mu)%b(2,1)
      clinetzz(i5,i6,mu)%c(2,1)=lg7_56(i5,i6)%c(2,1)*p756q*rz8_7
     & 56(mu)%d(1,1)+lg7_56(i5,i6)%a(2,2)*rz8_756(mu)%c(2,1)
      clinetzz(i5,i6,mu)%d(2,1)=rmass(id7)*(lg7_56(i5,i6)%b(2,1)
     & *rz8_756(mu)%d(1,1)+lg7_56(i5,i6)%d(2,2)*rz8_756(mu)%c(2,
     & 1))
      clinetzz(i5,i6,mu)%a(2,2)=lg7_56(i5,i6)%c(2,1)*p756q*rz8_7
     & 56(mu)%b(1,2)+lg7_56(i5,i6)%a(2,2)*rz8_756(mu)%a(2,2)
      clinetzz(i5,i6,mu)%b(2,2)=rmass(id7)*(lg7_56(i5,i6)%b(2,1)
     & *rz8_756(mu)%b(1,2)+lg7_56(i5,i6)%d(2,2)*rz8_756(mu)%a(2,
     & 2))
      clinetzz(i5,i6,mu)%c(2,2)=rmass(id7)*(lg7_56(i5,i6)%c(2,1)
     & *rz8_756(mu)%c(1,2)+lg7_56(i5,i6)%a(2,2)*rz8_756(mu)%d(2,
     & 2))
      clinetzz(i5,i6,mu)%d(2,2)=lg7_56(i5,i6)%b(2,1)*rz8_756(mu)
     & %c(1,2)+lg7_56(i5,i6)%d(2,2)*p756q*rz8_756(mu)%d(2,2)
      end do
      end do
      end do
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TT -- aa=clinetzz(i5,i6,mu)%a,bb=clinetzz(i5,i6,mu)%b,cc=clinetzz(i5,i
* 6,mu)%c,dd=clinetzz(i5,i6,mu)%d,a1=lz7_856(mu)%a,b1=lz7_856(mu)%b,c1=l
* z7_856(mu)%c,d1=lz7_856(mu)%d,a2=rg8_56(i5,i6)%a,b2=rg8_56(i5,i6)%b,c2
* =rg8_56(i5,i6)%c,d2=rg8_56(i5,i6)%d,prq=p856q,m=rmass(id7),nsum=1
      clinetzz(i5,i6,mu)%a(1,1)=clinetzz(i5,i6,mu)%a(1,1)+lz7_85
     & 6(mu)%a(1,1)*rg8_56(i5,i6)%a(1,1)+lz7_856(mu)%c(1,2)*p856
     & q*rg8_56(i5,i6)%b(2,1)
      clinetzz(i5,i6,mu)%b(1,1)=clinetzz(i5,i6,mu)%b(1,1)+rmass(
     & id7)*(lz7_856(mu)%d(1,1)*rg8_56(i5,i6)%a(1,1)+lz7_856(mu)
     & %b(1,2)*rg8_56(i5,i6)%b(2,1))
      clinetzz(i5,i6,mu)%c(1,1)=clinetzz(i5,i6,mu)%c(1,1)+rmass(
     & id7)*(lz7_856(mu)%a(1,1)*rg8_56(i5,i6)%d(1,1)+lz7_856(mu)
     & %c(1,2)*rg8_56(i5,i6)%c(2,1))
      clinetzz(i5,i6,mu)%d(1,1)=clinetzz(i5,i6,mu)%d(1,1)+lz7_85
     & 6(mu)%d(1,1)*p856q*rg8_56(i5,i6)%d(1,1)+lz7_856(mu)%b(1,2
     & )*rg8_56(i5,i6)%c(2,1)
      clinetzz(i5,i6,mu)%a(1,2)=clinetzz(i5,i6,mu)%a(1,2)+rmass(
     & id7)*(lz7_856(mu)%a(1,1)*rg8_56(i5,i6)%b(1,2)+lz7_856(mu)
     & %c(1,2)*rg8_56(i5,i6)%a(2,2))
      clinetzz(i5,i6,mu)%b(1,2)=clinetzz(i5,i6,mu)%b(1,2)+lz7_85
     & 6(mu)%d(1,1)*p856q*rg8_56(i5,i6)%b(1,2)+lz7_856(mu)%b(1,2
     & )*rg8_56(i5,i6)%a(2,2)
      clinetzz(i5,i6,mu)%c(1,2)=clinetzz(i5,i6,mu)%c(1,2)+lz7_85
     & 6(mu)%a(1,1)*rg8_56(i5,i6)%c(1,2)+lz7_856(mu)%c(1,2)*p856
     & q*rg8_56(i5,i6)%d(2,2)
      clinetzz(i5,i6,mu)%d(1,2)=clinetzz(i5,i6,mu)%d(1,2)+rmass(
     & id7)*(lz7_856(mu)%d(1,1)*rg8_56(i5,i6)%c(1,2)+lz7_856(mu)
     & %b(1,2)*rg8_56(i5,i6)%d(2,2))
      clinetzz(i5,i6,mu)%a(2,1)=clinetzz(i5,i6,mu)%a(2,1)+rmass(
     & id7)*(lz7_856(mu)%c(2,1)*rg8_56(i5,i6)%a(1,1)+lz7_856(mu)
     & %a(2,2)*rg8_56(i5,i6)%b(2,1))
      clinetzz(i5,i6,mu)%b(2,1)=clinetzz(i5,i6,mu)%b(2,1)+lz7_85
     & 6(mu)%b(2,1)*rg8_56(i5,i6)%a(1,1)+lz7_856(mu)%d(2,2)*p856
     & q*rg8_56(i5,i6)%b(2,1)
      clinetzz(i5,i6,mu)%c(2,1)=clinetzz(i5,i6,mu)%c(2,1)+lz7_85
     & 6(mu)%c(2,1)*p856q*rg8_56(i5,i6)%d(1,1)+lz7_856(mu)%a(2,2
     & )*rg8_56(i5,i6)%c(2,1)
      clinetzz(i5,i6,mu)%d(2,1)=clinetzz(i5,i6,mu)%d(2,1)+rmass(
     & id7)*(lz7_856(mu)%b(2,1)*rg8_56(i5,i6)%d(1,1)+lz7_856(mu)
     & %d(2,2)*rg8_56(i5,i6)%c(2,1))
      clinetzz(i5,i6,mu)%a(2,2)=clinetzz(i5,i6,mu)%a(2,2)+lz7_85
     & 6(mu)%c(2,1)*p856q*rg8_56(i5,i6)%b(1,2)+lz7_856(mu)%a(2,2
     & )*rg8_56(i5,i6)%a(2,2)
      clinetzz(i5,i6,mu)%b(2,2)=clinetzz(i5,i6,mu)%b(2,2)+rmass(
     & id7)*(lz7_856(mu)%b(2,1)*rg8_56(i5,i6)%b(1,2)+lz7_856(mu)
     & %d(2,2)*rg8_56(i5,i6)%a(2,2))
      clinetzz(i5,i6,mu)%c(2,2)=clinetzz(i5,i6,mu)%c(2,2)+rmass(
     & id7)*(lz7_856(mu)%c(2,1)*rg8_56(i5,i6)%c(1,2)+lz7_856(mu)
     & %a(2,2)*rg8_56(i5,i6)%d(2,2))
      clinetzz(i5,i6,mu)%d(2,2)=clinetzz(i5,i6,mu)%d(2,2)+lz7_85
     & 6(mu)%b(2,1)*rg8_56(i5,i6)%c(1,2)+lz7_856(mu)%d(2,2)*p856
     & q*rg8_56(i5,i6)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id7)
      rmassr=-rmass(id7)
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* mline -- res=czqcd5678(i5,i6,&1,&2,mu),abcd=clinetzz(i5,i6,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      czqcd5678(i5,i6,iut,jut,mu)=clinetzz(i5,i6,mu)%a(iut,jut)+
     & rmassl*clinetzz(i5,i6,mu)%b(iut,jut)+rmassr*clinetzz(i5,i
     & 6,mu)%c(iut,jut)+rmassl*rmassr*clinetzz(i5,i6,mu)%d(iut,j
     & ut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TT -- aa=clinetzz(i7,i8,mu)%a,bb=clinetzz(i7,i8,mu)%b,cc=clinetzz(i7,i
* 8,mu)%c,dd=clinetzz(i7,i8,mu)%d,a1=lg5_78(i7,i8)%a,b1=lg5_78(i7,i8)%b,
* c1=lg5_78(i7,i8)%c,d1=lg5_78(i7,i8)%d,a2=rz6_578(mu)%a,b2=rz6_578(mu)%
* b,c2=rz6_578(mu)%c,d2=rz6_578(mu)%d,prq=p578q,m=rmass(id5),nsum=0
      clinetzz(i7,i8,mu)%a(1,1)=lg5_78(i7,i8)%a(1,1)*rz6_578(mu)
     & %a(1,1)+lg5_78(i7,i8)%c(1,2)*p578q*rz6_578(mu)%b(2,1)
      clinetzz(i7,i8,mu)%b(1,1)=rmass(id5)*(lg5_78(i7,i8)%d(1,1)
     & *rz6_578(mu)%a(1,1)+lg5_78(i7,i8)%b(1,2)*rz6_578(mu)%b(2,
     & 1))
      clinetzz(i7,i8,mu)%c(1,1)=rmass(id5)*(lg5_78(i7,i8)%a(1,1)
     & *rz6_578(mu)%d(1,1)+lg5_78(i7,i8)%c(1,2)*rz6_578(mu)%c(2,
     & 1))
      clinetzz(i7,i8,mu)%d(1,1)=lg5_78(i7,i8)%d(1,1)*p578q*rz6_5
     & 78(mu)%d(1,1)+lg5_78(i7,i8)%b(1,2)*rz6_578(mu)%c(2,1)
      clinetzz(i7,i8,mu)%a(1,2)=rmass(id5)*(lg5_78(i7,i8)%a(1,1)
     & *rz6_578(mu)%b(1,2)+lg5_78(i7,i8)%c(1,2)*rz6_578(mu)%a(2,
     & 2))
      clinetzz(i7,i8,mu)%b(1,2)=lg5_78(i7,i8)%d(1,1)*p578q*rz6_5
     & 78(mu)%b(1,2)+lg5_78(i7,i8)%b(1,2)*rz6_578(mu)%a(2,2)
      clinetzz(i7,i8,mu)%c(1,2)=lg5_78(i7,i8)%a(1,1)*rz6_578(mu)
     & %c(1,2)+lg5_78(i7,i8)%c(1,2)*p578q*rz6_578(mu)%d(2,2)
      clinetzz(i7,i8,mu)%d(1,2)=rmass(id5)*(lg5_78(i7,i8)%d(1,1)
     & *rz6_578(mu)%c(1,2)+lg5_78(i7,i8)%b(1,2)*rz6_578(mu)%d(2,
     & 2))
      clinetzz(i7,i8,mu)%a(2,1)=rmass(id5)*(lg5_78(i7,i8)%c(2,1)
     & *rz6_578(mu)%a(1,1)+lg5_78(i7,i8)%a(2,2)*rz6_578(mu)%b(2,
     & 1))
      clinetzz(i7,i8,mu)%b(2,1)=lg5_78(i7,i8)%b(2,1)*rz6_578(mu)
     & %a(1,1)+lg5_78(i7,i8)%d(2,2)*p578q*rz6_578(mu)%b(2,1)
      clinetzz(i7,i8,mu)%c(2,1)=lg5_78(i7,i8)%c(2,1)*p578q*rz6_5
     & 78(mu)%d(1,1)+lg5_78(i7,i8)%a(2,2)*rz6_578(mu)%c(2,1)
      clinetzz(i7,i8,mu)%d(2,1)=rmass(id5)*(lg5_78(i7,i8)%b(2,1)
     & *rz6_578(mu)%d(1,1)+lg5_78(i7,i8)%d(2,2)*rz6_578(mu)%c(2,
     & 1))
      clinetzz(i7,i8,mu)%a(2,2)=lg5_78(i7,i8)%c(2,1)*p578q*rz6_5
     & 78(mu)%b(1,2)+lg5_78(i7,i8)%a(2,2)*rz6_578(mu)%a(2,2)
      clinetzz(i7,i8,mu)%b(2,2)=rmass(id5)*(lg5_78(i7,i8)%b(2,1)
     & *rz6_578(mu)%b(1,2)+lg5_78(i7,i8)%d(2,2)*rz6_578(mu)%a(2,
     & 2))
      clinetzz(i7,i8,mu)%c(2,2)=rmass(id5)*(lg5_78(i7,i8)%c(2,1)
     & *rz6_578(mu)%c(1,2)+lg5_78(i7,i8)%a(2,2)*rz6_578(mu)%d(2,
     & 2))
      clinetzz(i7,i8,mu)%d(2,2)=lg5_78(i7,i8)%b(2,1)*rz6_578(mu)
     & %c(1,2)+lg5_78(i7,i8)%d(2,2)*p578q*rz6_578(mu)%d(2,2)
      end do
      end do
      end do
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TT -- aa=clinetzz(i7,i8,mu)%a,bb=clinetzz(i7,i8,mu)%b,cc=clinetzz(i7,i
* 8,mu)%c,dd=clinetzz(i7,i8,mu)%d,a1=lz5_678(mu)%a,b1=lz5_678(mu)%b,c1=l
* z5_678(mu)%c,d1=lz5_678(mu)%d,a2=rg6_78(i7,i8)%a,b2=rg6_78(i7,i8)%b,c2
* =rg6_78(i7,i8)%c,d2=rg6_78(i7,i8)%d,prq=p678q,m=rmass(id5),nsum=1
      clinetzz(i7,i8,mu)%a(1,1)=clinetzz(i7,i8,mu)%a(1,1)+lz5_67
     & 8(mu)%a(1,1)*rg6_78(i7,i8)%a(1,1)+lz5_678(mu)%c(1,2)*p678
     & q*rg6_78(i7,i8)%b(2,1)
      clinetzz(i7,i8,mu)%b(1,1)=clinetzz(i7,i8,mu)%b(1,1)+rmass(
     & id5)*(lz5_678(mu)%d(1,1)*rg6_78(i7,i8)%a(1,1)+lz5_678(mu)
     & %b(1,2)*rg6_78(i7,i8)%b(2,1))
      clinetzz(i7,i8,mu)%c(1,1)=clinetzz(i7,i8,mu)%c(1,1)+rmass(
     & id5)*(lz5_678(mu)%a(1,1)*rg6_78(i7,i8)%d(1,1)+lz5_678(mu)
     & %c(1,2)*rg6_78(i7,i8)%c(2,1))
      clinetzz(i7,i8,mu)%d(1,1)=clinetzz(i7,i8,mu)%d(1,1)+lz5_67
     & 8(mu)%d(1,1)*p678q*rg6_78(i7,i8)%d(1,1)+lz5_678(mu)%b(1,2
     & )*rg6_78(i7,i8)%c(2,1)
      clinetzz(i7,i8,mu)%a(1,2)=clinetzz(i7,i8,mu)%a(1,2)+rmass(
     & id5)*(lz5_678(mu)%a(1,1)*rg6_78(i7,i8)%b(1,2)+lz5_678(mu)
     & %c(1,2)*rg6_78(i7,i8)%a(2,2))
      clinetzz(i7,i8,mu)%b(1,2)=clinetzz(i7,i8,mu)%b(1,2)+lz5_67
     & 8(mu)%d(1,1)*p678q*rg6_78(i7,i8)%b(1,2)+lz5_678(mu)%b(1,2
     & )*rg6_78(i7,i8)%a(2,2)
      clinetzz(i7,i8,mu)%c(1,2)=clinetzz(i7,i8,mu)%c(1,2)+lz5_67
     & 8(mu)%a(1,1)*rg6_78(i7,i8)%c(1,2)+lz5_678(mu)%c(1,2)*p678
     & q*rg6_78(i7,i8)%d(2,2)
      clinetzz(i7,i8,mu)%d(1,2)=clinetzz(i7,i8,mu)%d(1,2)+rmass(
     & id5)*(lz5_678(mu)%d(1,1)*rg6_78(i7,i8)%c(1,2)+lz5_678(mu)
     & %b(1,2)*rg6_78(i7,i8)%d(2,2))
      clinetzz(i7,i8,mu)%a(2,1)=clinetzz(i7,i8,mu)%a(2,1)+rmass(
     & id5)*(lz5_678(mu)%c(2,1)*rg6_78(i7,i8)%a(1,1)+lz5_678(mu)
     & %a(2,2)*rg6_78(i7,i8)%b(2,1))
      clinetzz(i7,i8,mu)%b(2,1)=clinetzz(i7,i8,mu)%b(2,1)+lz5_67
     & 8(mu)%b(2,1)*rg6_78(i7,i8)%a(1,1)+lz5_678(mu)%d(2,2)*p678
     & q*rg6_78(i7,i8)%b(2,1)
      clinetzz(i7,i8,mu)%c(2,1)=clinetzz(i7,i8,mu)%c(2,1)+lz5_67
     & 8(mu)%c(2,1)*p678q*rg6_78(i7,i8)%d(1,1)+lz5_678(mu)%a(2,2
     & )*rg6_78(i7,i8)%c(2,1)
      clinetzz(i7,i8,mu)%d(2,1)=clinetzz(i7,i8,mu)%d(2,1)+rmass(
     & id5)*(lz5_678(mu)%b(2,1)*rg6_78(i7,i8)%d(1,1)+lz5_678(mu)
     & %d(2,2)*rg6_78(i7,i8)%c(2,1))
      clinetzz(i7,i8,mu)%a(2,2)=clinetzz(i7,i8,mu)%a(2,2)+lz5_67
     & 8(mu)%c(2,1)*p678q*rg6_78(i7,i8)%b(1,2)+lz5_678(mu)%a(2,2
     & )*rg6_78(i7,i8)%a(2,2)
      clinetzz(i7,i8,mu)%b(2,2)=clinetzz(i7,i8,mu)%b(2,2)+rmass(
     & id5)*(lz5_678(mu)%b(2,1)*rg6_78(i7,i8)%b(1,2)+lz5_678(mu)
     & %d(2,2)*rg6_78(i7,i8)%a(2,2))
      clinetzz(i7,i8,mu)%c(2,2)=clinetzz(i7,i8,mu)%c(2,2)+rmass(
     & id5)*(lz5_678(mu)%c(2,1)*rg6_78(i7,i8)%c(1,2)+lz5_678(mu)
     & %a(2,2)*rg6_78(i7,i8)%d(2,2))
      clinetzz(i7,i8,mu)%d(2,2)=clinetzz(i7,i8,mu)%d(2,2)+lz5_67
     & 8(mu)%b(2,1)*rg6_78(i7,i8)%c(1,2)+lz5_678(mu)%d(2,2)*p678
     & q*rg6_78(i7,i8)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id5)
      rmassr=-rmass(id5)
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* mline -- res=czqcd5678(&1,&2,i7,i8,mu),abcd=clinetzz(i7,i8,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      czqcd5678(iut,jut,i7,i8,mu)=czqcd5678(iut,jut,i7,i8,mu)+cl
     & inetzz(i7,i8,mu)%a(iut,jut)+rmassl*clinetzz(i7,i8,mu)%b(i
     & ut,jut)+rmassr*clinetzz(i7,i8,mu)%c(iut,jut)+rmassl*rmass
     & r*clinetzz(i7,i8,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TT -- aa=clinetfz(i5,i6,mu)%a,bb=clinetfz(i5,i6,mu)%b,cc=clinetfz(i5,i
* 6,mu)%c,dd=clinetfz(i5,i6,mu)%d,a1=lg7_56(i5,i6)%a,b1=lg7_56(i5,i6)%b,
* c1=lg7_56(i5,i6)%c,d1=lg7_56(i5,i6)%d,a2=rf8_756(mu)%a,b2=rf8_756(mu)%
* b,c2=rf8_756(mu)%c,d2=rf8_756(mu)%d,prq=p756q,m=rmass(id7),nsum=0
      clinetfz(i5,i6,mu)%a(1,1)=lg7_56(i5,i6)%a(1,1)*rf8_756(mu)
     & %a(1,1)+lg7_56(i5,i6)%c(1,2)*p756q*rf8_756(mu)%b(2,1)
      clinetfz(i5,i6,mu)%b(1,1)=rmass(id7)*(lg7_56(i5,i6)%d(1,1)
     & *rf8_756(mu)%a(1,1)+lg7_56(i5,i6)%b(1,2)*rf8_756(mu)%b(2,
     & 1))
      clinetfz(i5,i6,mu)%c(1,1)=rmass(id7)*(lg7_56(i5,i6)%a(1,1)
     & *rf8_756(mu)%d(1,1)+lg7_56(i5,i6)%c(1,2)*rf8_756(mu)%c(2,
     & 1))
      clinetfz(i5,i6,mu)%d(1,1)=lg7_56(i5,i6)%d(1,1)*p756q*rf8_7
     & 56(mu)%d(1,1)+lg7_56(i5,i6)%b(1,2)*rf8_756(mu)%c(2,1)
      clinetfz(i5,i6,mu)%a(1,2)=rmass(id7)*(lg7_56(i5,i6)%a(1,1)
     & *rf8_756(mu)%b(1,2)+lg7_56(i5,i6)%c(1,2)*rf8_756(mu)%a(2,
     & 2))
      clinetfz(i5,i6,mu)%b(1,2)=lg7_56(i5,i6)%d(1,1)*p756q*rf8_7
     & 56(mu)%b(1,2)+lg7_56(i5,i6)%b(1,2)*rf8_756(mu)%a(2,2)
      clinetfz(i5,i6,mu)%c(1,2)=lg7_56(i5,i6)%a(1,1)*rf8_756(mu)
     & %c(1,2)+lg7_56(i5,i6)%c(1,2)*p756q*rf8_756(mu)%d(2,2)
      clinetfz(i5,i6,mu)%d(1,2)=rmass(id7)*(lg7_56(i5,i6)%d(1,1)
     & *rf8_756(mu)%c(1,2)+lg7_56(i5,i6)%b(1,2)*rf8_756(mu)%d(2,
     & 2))
      clinetfz(i5,i6,mu)%a(2,1)=rmass(id7)*(lg7_56(i5,i6)%c(2,1)
     & *rf8_756(mu)%a(1,1)+lg7_56(i5,i6)%a(2,2)*rf8_756(mu)%b(2,
     & 1))
      clinetfz(i5,i6,mu)%b(2,1)=lg7_56(i5,i6)%b(2,1)*rf8_756(mu)
     & %a(1,1)+lg7_56(i5,i6)%d(2,2)*p756q*rf8_756(mu)%b(2,1)
      clinetfz(i5,i6,mu)%c(2,1)=lg7_56(i5,i6)%c(2,1)*p756q*rf8_7
     & 56(mu)%d(1,1)+lg7_56(i5,i6)%a(2,2)*rf8_756(mu)%c(2,1)
      clinetfz(i5,i6,mu)%d(2,1)=rmass(id7)*(lg7_56(i5,i6)%b(2,1)
     & *rf8_756(mu)%d(1,1)+lg7_56(i5,i6)%d(2,2)*rf8_756(mu)%c(2,
     & 1))
      clinetfz(i5,i6,mu)%a(2,2)=lg7_56(i5,i6)%c(2,1)*p756q*rf8_7
     & 56(mu)%b(1,2)+lg7_56(i5,i6)%a(2,2)*rf8_756(mu)%a(2,2)
      clinetfz(i5,i6,mu)%b(2,2)=rmass(id7)*(lg7_56(i5,i6)%b(2,1)
     & *rf8_756(mu)%b(1,2)+lg7_56(i5,i6)%d(2,2)*rf8_756(mu)%a(2,
     & 2))
      clinetfz(i5,i6,mu)%c(2,2)=rmass(id7)*(lg7_56(i5,i6)%c(2,1)
     & *rf8_756(mu)%c(1,2)+lg7_56(i5,i6)%a(2,2)*rf8_756(mu)%d(2,
     & 2))
      clinetfz(i5,i6,mu)%d(2,2)=lg7_56(i5,i6)%b(2,1)*rf8_756(mu)
     & %c(1,2)+lg7_56(i5,i6)%d(2,2)*p756q*rf8_756(mu)%d(2,2)
      end do
      end do
      end do
      do i5=1,2
      do i6=1,2
      do mu=0,3
* TT -- aa=clinetfz(i5,i6,mu)%a,bb=clinetfz(i5,i6,mu)%b,cc=clinetfz(i5,i
* 6,mu)%c,dd=clinetfz(i5,i6,mu)%d,a1=lf7_856(mu)%a,b1=lf7_856(mu)%b,c1=l
* f7_856(mu)%c,d1=lf7_856(mu)%d,a2=rg8_56(i5,i6)%a,b2=rg8_56(i5,i6)%b,c2
* =rg8_56(i5,i6)%c,d2=rg8_56(i5,i6)%d,prq=p856q,m=rmass(id7),nsum=1
      clinetfz(i5,i6,mu)%a(1,1)=clinetfz(i5,i6,mu)%a(1,1)+lf7_85
     & 6(mu)%a(1,1)*rg8_56(i5,i6)%a(1,1)+lf7_856(mu)%c(1,2)*p856
     & q*rg8_56(i5,i6)%b(2,1)
      clinetfz(i5,i6,mu)%b(1,1)=clinetfz(i5,i6,mu)%b(1,1)+rmass(
     & id7)*(lf7_856(mu)%d(1,1)*rg8_56(i5,i6)%a(1,1)+lf7_856(mu)
     & %b(1,2)*rg8_56(i5,i6)%b(2,1))
      clinetfz(i5,i6,mu)%c(1,1)=clinetfz(i5,i6,mu)%c(1,1)+rmass(
     & id7)*(lf7_856(mu)%a(1,1)*rg8_56(i5,i6)%d(1,1)+lf7_856(mu)
     & %c(1,2)*rg8_56(i5,i6)%c(2,1))
      clinetfz(i5,i6,mu)%d(1,1)=clinetfz(i5,i6,mu)%d(1,1)+lf7_85
     & 6(mu)%d(1,1)*p856q*rg8_56(i5,i6)%d(1,1)+lf7_856(mu)%b(1,2
     & )*rg8_56(i5,i6)%c(2,1)
      clinetfz(i5,i6,mu)%a(1,2)=clinetfz(i5,i6,mu)%a(1,2)+rmass(
     & id7)*(lf7_856(mu)%a(1,1)*rg8_56(i5,i6)%b(1,2)+lf7_856(mu)
     & %c(1,2)*rg8_56(i5,i6)%a(2,2))
      clinetfz(i5,i6,mu)%b(1,2)=clinetfz(i5,i6,mu)%b(1,2)+lf7_85
     & 6(mu)%d(1,1)*p856q*rg8_56(i5,i6)%b(1,2)+lf7_856(mu)%b(1,2
     & )*rg8_56(i5,i6)%a(2,2)
      clinetfz(i5,i6,mu)%c(1,2)=clinetfz(i5,i6,mu)%c(1,2)+lf7_85
     & 6(mu)%a(1,1)*rg8_56(i5,i6)%c(1,2)+lf7_856(mu)%c(1,2)*p856
     & q*rg8_56(i5,i6)%d(2,2)
      clinetfz(i5,i6,mu)%d(1,2)=clinetfz(i5,i6,mu)%d(1,2)+rmass(
     & id7)*(lf7_856(mu)%d(1,1)*rg8_56(i5,i6)%c(1,2)+lf7_856(mu)
     & %b(1,2)*rg8_56(i5,i6)%d(2,2))
      clinetfz(i5,i6,mu)%a(2,1)=clinetfz(i5,i6,mu)%a(2,1)+rmass(
     & id7)*(lf7_856(mu)%c(2,1)*rg8_56(i5,i6)%a(1,1)+lf7_856(mu)
     & %a(2,2)*rg8_56(i5,i6)%b(2,1))
      clinetfz(i5,i6,mu)%b(2,1)=clinetfz(i5,i6,mu)%b(2,1)+lf7_85
     & 6(mu)%b(2,1)*rg8_56(i5,i6)%a(1,1)+lf7_856(mu)%d(2,2)*p856
     & q*rg8_56(i5,i6)%b(2,1)
      clinetfz(i5,i6,mu)%c(2,1)=clinetfz(i5,i6,mu)%c(2,1)+lf7_85
     & 6(mu)%c(2,1)*p856q*rg8_56(i5,i6)%d(1,1)+lf7_856(mu)%a(2,2
     & )*rg8_56(i5,i6)%c(2,1)
      clinetfz(i5,i6,mu)%d(2,1)=clinetfz(i5,i6,mu)%d(2,1)+rmass(
     & id7)*(lf7_856(mu)%b(2,1)*rg8_56(i5,i6)%d(1,1)+lf7_856(mu)
     & %d(2,2)*rg8_56(i5,i6)%c(2,1))
      clinetfz(i5,i6,mu)%a(2,2)=clinetfz(i5,i6,mu)%a(2,2)+lf7_85
     & 6(mu)%c(2,1)*p856q*rg8_56(i5,i6)%b(1,2)+lf7_856(mu)%a(2,2
     & )*rg8_56(i5,i6)%a(2,2)
      clinetfz(i5,i6,mu)%b(2,2)=clinetfz(i5,i6,mu)%b(2,2)+rmass(
     & id7)*(lf7_856(mu)%b(2,1)*rg8_56(i5,i6)%b(1,2)+lf7_856(mu)
     & %d(2,2)*rg8_56(i5,i6)%a(2,2))
      clinetfz(i5,i6,mu)%c(2,2)=clinetfz(i5,i6,mu)%c(2,2)+rmass(
     & id7)*(lf7_856(mu)%c(2,1)*rg8_56(i5,i6)%c(1,2)+lf7_856(mu)
     & %a(2,2)*rg8_56(i5,i6)%d(2,2))
      clinetfz(i5,i6,mu)%d(2,2)=clinetfz(i5,i6,mu)%d(2,2)+lf7_85
     & 6(mu)%b(2,1)*rg8_56(i5,i6)%c(1,2)+lf7_856(mu)%d(2,2)*p856
     & q*rg8_56(i5,i6)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id7)
      rmassr=-rmass(id7)
  
      do i5=1,2
      do i6=1,2
      do mu=0,3
* mline -- res=cfqcd5678(i5,i6,&1,&2,mu),abcd=clinetfz(i5,i6,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cfqcd5678(i5,i6,iut,jut,mu)=clinetfz(i5,i6,mu)%a(iut,jut)+
     & rmassl*clinetfz(i5,i6,mu)%b(iut,jut)+rmassr*clinetfz(i5,i
     & 6,mu)%c(iut,jut)+rmassl*rmassr*clinetfz(i5,i6,mu)%d(iut,j
     & ut)
      enddo
      enddo
      end do
      end do
      end do
  
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TT -- aa=clinetfz(i7,i8,mu)%a,bb=clinetfz(i7,i8,mu)%b,cc=clinetfz(i7,i
* 8,mu)%c,dd=clinetfz(i7,i8,mu)%d,a1=lg5_78(i7,i8)%a,b1=lg5_78(i7,i8)%b,
* c1=lg5_78(i7,i8)%c,d1=lg5_78(i7,i8)%d,a2=rf6_578(mu)%a,b2=rf6_578(mu)%
* b,c2=rf6_578(mu)%c,d2=rf6_578(mu)%d,prq=p578q,m=rmass(id5),nsum=0
      clinetfz(i7,i8,mu)%a(1,1)=lg5_78(i7,i8)%a(1,1)*rf6_578(mu)
     & %a(1,1)+lg5_78(i7,i8)%c(1,2)*p578q*rf6_578(mu)%b(2,1)
      clinetfz(i7,i8,mu)%b(1,1)=rmass(id5)*(lg5_78(i7,i8)%d(1,1)
     & *rf6_578(mu)%a(1,1)+lg5_78(i7,i8)%b(1,2)*rf6_578(mu)%b(2,
     & 1))
      clinetfz(i7,i8,mu)%c(1,1)=rmass(id5)*(lg5_78(i7,i8)%a(1,1)
     & *rf6_578(mu)%d(1,1)+lg5_78(i7,i8)%c(1,2)*rf6_578(mu)%c(2,
     & 1))
      clinetfz(i7,i8,mu)%d(1,1)=lg5_78(i7,i8)%d(1,1)*p578q*rf6_5
     & 78(mu)%d(1,1)+lg5_78(i7,i8)%b(1,2)*rf6_578(mu)%c(2,1)
      clinetfz(i7,i8,mu)%a(1,2)=rmass(id5)*(lg5_78(i7,i8)%a(1,1)
     & *rf6_578(mu)%b(1,2)+lg5_78(i7,i8)%c(1,2)*rf6_578(mu)%a(2,
     & 2))
      clinetfz(i7,i8,mu)%b(1,2)=lg5_78(i7,i8)%d(1,1)*p578q*rf6_5
     & 78(mu)%b(1,2)+lg5_78(i7,i8)%b(1,2)*rf6_578(mu)%a(2,2)
      clinetfz(i7,i8,mu)%c(1,2)=lg5_78(i7,i8)%a(1,1)*rf6_578(mu)
     & %c(1,2)+lg5_78(i7,i8)%c(1,2)*p578q*rf6_578(mu)%d(2,2)
      clinetfz(i7,i8,mu)%d(1,2)=rmass(id5)*(lg5_78(i7,i8)%d(1,1)
     & *rf6_578(mu)%c(1,2)+lg5_78(i7,i8)%b(1,2)*rf6_578(mu)%d(2,
     & 2))
      clinetfz(i7,i8,mu)%a(2,1)=rmass(id5)*(lg5_78(i7,i8)%c(2,1)
     & *rf6_578(mu)%a(1,1)+lg5_78(i7,i8)%a(2,2)*rf6_578(mu)%b(2,
     & 1))
      clinetfz(i7,i8,mu)%b(2,1)=lg5_78(i7,i8)%b(2,1)*rf6_578(mu)
     & %a(1,1)+lg5_78(i7,i8)%d(2,2)*p578q*rf6_578(mu)%b(2,1)
      clinetfz(i7,i8,mu)%c(2,1)=lg5_78(i7,i8)%c(2,1)*p578q*rf6_5
     & 78(mu)%d(1,1)+lg5_78(i7,i8)%a(2,2)*rf6_578(mu)%c(2,1)
      clinetfz(i7,i8,mu)%d(2,1)=rmass(id5)*(lg5_78(i7,i8)%b(2,1)
     & *rf6_578(mu)%d(1,1)+lg5_78(i7,i8)%d(2,2)*rf6_578(mu)%c(2,
     & 1))
      clinetfz(i7,i8,mu)%a(2,2)=lg5_78(i7,i8)%c(2,1)*p578q*rf6_5
     & 78(mu)%b(1,2)+lg5_78(i7,i8)%a(2,2)*rf6_578(mu)%a(2,2)
      clinetfz(i7,i8,mu)%b(2,2)=rmass(id5)*(lg5_78(i7,i8)%b(2,1)
     & *rf6_578(mu)%b(1,2)+lg5_78(i7,i8)%d(2,2)*rf6_578(mu)%a(2,
     & 2))
      clinetfz(i7,i8,mu)%c(2,2)=rmass(id5)*(lg5_78(i7,i8)%c(2,1)
     & *rf6_578(mu)%c(1,2)+lg5_78(i7,i8)%a(2,2)*rf6_578(mu)%d(2,
     & 2))
      clinetfz(i7,i8,mu)%d(2,2)=lg5_78(i7,i8)%b(2,1)*rf6_578(mu)
     & %c(1,2)+lg5_78(i7,i8)%d(2,2)*p578q*rf6_578(mu)%d(2,2)
      end do
      end do
      end do
      do i7=1,2
      do i8=1,2
      do mu=0,3
* TT -- aa=clinetfz(i7,i8,mu)%a,bb=clinetfz(i7,i8,mu)%b,cc=clinetfz(i7,i
* 8,mu)%c,dd=clinetfz(i7,i8,mu)%d,a1=lf5_678(mu)%a,b1=lf5_678(mu)%b,c1=l
* f5_678(mu)%c,d1=lf5_678(mu)%d,a2=rg6_78(i7,i8)%a,b2=rg6_78(i7,i8)%b,c2
* =rg6_78(i7,i8)%c,d2=rg6_78(i7,i8)%d,prq=p678q,m=rmass(id5),nsum=1
      clinetfz(i7,i8,mu)%a(1,1)=clinetfz(i7,i8,mu)%a(1,1)+lf5_67
     & 8(mu)%a(1,1)*rg6_78(i7,i8)%a(1,1)+lf5_678(mu)%c(1,2)*p678
     & q*rg6_78(i7,i8)%b(2,1)
      clinetfz(i7,i8,mu)%b(1,1)=clinetfz(i7,i8,mu)%b(1,1)+rmass(
     & id5)*(lf5_678(mu)%d(1,1)*rg6_78(i7,i8)%a(1,1)+lf5_678(mu)
     & %b(1,2)*rg6_78(i7,i8)%b(2,1))
      clinetfz(i7,i8,mu)%c(1,1)=clinetfz(i7,i8,mu)%c(1,1)+rmass(
     & id5)*(lf5_678(mu)%a(1,1)*rg6_78(i7,i8)%d(1,1)+lf5_678(mu)
     & %c(1,2)*rg6_78(i7,i8)%c(2,1))
      clinetfz(i7,i8,mu)%d(1,1)=clinetfz(i7,i8,mu)%d(1,1)+lf5_67
     & 8(mu)%d(1,1)*p678q*rg6_78(i7,i8)%d(1,1)+lf5_678(mu)%b(1,2
     & )*rg6_78(i7,i8)%c(2,1)
      clinetfz(i7,i8,mu)%a(1,2)=clinetfz(i7,i8,mu)%a(1,2)+rmass(
     & id5)*(lf5_678(mu)%a(1,1)*rg6_78(i7,i8)%b(1,2)+lf5_678(mu)
     & %c(1,2)*rg6_78(i7,i8)%a(2,2))
      clinetfz(i7,i8,mu)%b(1,2)=clinetfz(i7,i8,mu)%b(1,2)+lf5_67
     & 8(mu)%d(1,1)*p678q*rg6_78(i7,i8)%b(1,2)+lf5_678(mu)%b(1,2
     & )*rg6_78(i7,i8)%a(2,2)
      clinetfz(i7,i8,mu)%c(1,2)=clinetfz(i7,i8,mu)%c(1,2)+lf5_67
     & 8(mu)%a(1,1)*rg6_78(i7,i8)%c(1,2)+lf5_678(mu)%c(1,2)*p678
     & q*rg6_78(i7,i8)%d(2,2)
      clinetfz(i7,i8,mu)%d(1,2)=clinetfz(i7,i8,mu)%d(1,2)+rmass(
     & id5)*(lf5_678(mu)%d(1,1)*rg6_78(i7,i8)%c(1,2)+lf5_678(mu)
     & %b(1,2)*rg6_78(i7,i8)%d(2,2))
      clinetfz(i7,i8,mu)%a(2,1)=clinetfz(i7,i8,mu)%a(2,1)+rmass(
     & id5)*(lf5_678(mu)%c(2,1)*rg6_78(i7,i8)%a(1,1)+lf5_678(mu)
     & %a(2,2)*rg6_78(i7,i8)%b(2,1))
      clinetfz(i7,i8,mu)%b(2,1)=clinetfz(i7,i8,mu)%b(2,1)+lf5_67
     & 8(mu)%b(2,1)*rg6_78(i7,i8)%a(1,1)+lf5_678(mu)%d(2,2)*p678
     & q*rg6_78(i7,i8)%b(2,1)
      clinetfz(i7,i8,mu)%c(2,1)=clinetfz(i7,i8,mu)%c(2,1)+lf5_67
     & 8(mu)%c(2,1)*p678q*rg6_78(i7,i8)%d(1,1)+lf5_678(mu)%a(2,2
     & )*rg6_78(i7,i8)%c(2,1)
      clinetfz(i7,i8,mu)%d(2,1)=clinetfz(i7,i8,mu)%d(2,1)+rmass(
     & id5)*(lf5_678(mu)%b(2,1)*rg6_78(i7,i8)%d(1,1)+lf5_678(mu)
     & %d(2,2)*rg6_78(i7,i8)%c(2,1))
      clinetfz(i7,i8,mu)%a(2,2)=clinetfz(i7,i8,mu)%a(2,2)+lf5_67
     & 8(mu)%c(2,1)*p678q*rg6_78(i7,i8)%b(1,2)+lf5_678(mu)%a(2,2
     & )*rg6_78(i7,i8)%a(2,2)
      clinetfz(i7,i8,mu)%b(2,2)=clinetfz(i7,i8,mu)%b(2,2)+rmass(
     & id5)*(lf5_678(mu)%b(2,1)*rg6_78(i7,i8)%b(1,2)+lf5_678(mu)
     & %d(2,2)*rg6_78(i7,i8)%a(2,2))
      clinetfz(i7,i8,mu)%c(2,2)=clinetfz(i7,i8,mu)%c(2,2)+rmass(
     & id5)*(lf5_678(mu)%c(2,1)*rg6_78(i7,i8)%c(1,2)+lf5_678(mu)
     & %a(2,2)*rg6_78(i7,i8)%d(2,2))
      clinetfz(i7,i8,mu)%d(2,2)=clinetfz(i7,i8,mu)%d(2,2)+lf5_67
     & 8(mu)%b(2,1)*rg6_78(i7,i8)%c(1,2)+lf5_678(mu)%d(2,2)*p678
     & q*rg6_78(i7,i8)%d(2,2)
      end do
      end do
      end do
  
      rmassl=rmass(id5)
      rmassr=-rmass(id5)
  
      do i7=1,2
      do i8=1,2
      do mu=0,3
* mline -- res=cfqcd5678(&1,&2,i7,i8,mu),abcd=clinetfz(i7,i8,mu)%,m1=rma
* ssl,m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      cfqcd5678(iut,jut,i7,i8,mu)=cfqcd5678(iut,jut,i7,i8,mu)+cl
     & inetfz(i7,i8,mu)%a(iut,jut)+rmassl*clinetfz(i7,i8,mu)%b(i
     & ut,jut)+rmassr*clinetfz(i7,i8,mu)%c(iut,jut)+rmassl*rmass
     & r*clinetfz(i7,i8,mu)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
  
  
  
*                                                                       
* Then link the computed subdiagrams with the "Z" and "gamma" insertions
* [cz1234(2,2,2,2,0:3) and cf1234(2,2,2,2,0:3)]%                        
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7)   
*                                                                       
  
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
  
* "Z" insertion                                                         
* p.q -- p.q=cp1234dotczqcd5678,p=p1234(#),q=czqcd5678(i5,i6,i7,i8,#),be
* f=,aft=
      cp1234dotczqcd5678=(p1234(0)*czqcd5678(i5,i6,i7,i8,0)-p123
     & 4(1)*czqcd5678(i5,i6,i7,i8,1)-p1234(2)*czqcd5678(i5,i6,i7
     & ,i8,2)-p1234(3)*czqcd5678(i5,i6,i7,i8,3))
  
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7),p=czqcd5678(i5,i6,i7,
* i8,#),q=cz1234(i1,i2,i3,i4,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7
* )-,aft=/(p1234q-cmz2)
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,7)-(czqcd5678(i5,i6,i7,i8,0)*cz1234(i1,i2,
     & i3,i4,0)-czqcd5678(i5,i6,i7,i8,1)*cz1234(i1,i2,i3,i4,1)-c
     & zqcd5678(i5,i6,i7,i8,2)*cz1234(i1,i2,i3,i4,2)-czqcd5678(i
     & 5,i6,i7,i8,3)*cz1234(i1,i2,i3,i4,3))/(p1234q-cmz2)
  
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) =
     &   cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) +
     &   (cp1234dotczqcd5678*cp1234dotcz1234(i1,i2,i3,i4))
     &   /cmz2/(p1234q-cmz2)
  
* "gamma" insertion                                                     
* p.q -- p.q=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7),p=cfqcd5678(i5,i6,i7,
* i8,#),q=cf1234(i1,i2,i3,i4,#),bef=cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7
* )-,aft=/p1234q
      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7)=cres(i1,i2,i3,i4,i5,
     & i6)%caux(i7,i8,7)-(cfqcd5678(i5,i6,i7,i8,0)*cf1234(i1,i2,
     & i3,i4,0)-cfqcd5678(i5,i6,i7,i8,1)*cf1234(i1,i2,i3,i4,1)-c
     & fqcd5678(i5,i6,i7,i8,2)*cf1234(i1,i2,i3,i4,2)-cfqcd5678(i
     & 5,i6,i7,i8,3)*cf1234(i1,i2,i3,i4,3))/p1234q
  
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
*****************Compute diagrams of class 2.c)*************************
*                                                                       
*First compute subdiagrams of the type  [chqcd5678(2,2,2,2)]            
*                                                                       
*                                                                       
  
      do i5=1,2
        do i6=1,2
          do i7=1,2
            do i8=1,2
              chqcd5678(i5,i6,i7,i8)=czero
            enddo
          enddo
        enddo
      enddo
  
* rmh < 0 in our convention means no higgs coupling                     
      if (id5.eq.5.and.rmh.ge.0.d0) then
  
      do i7=1,2
      do i8=1,2
* TTSC -- aa=clineth_4f(i7,i8)%a,bb=clineth_4f(i7,i8)%b,cc=clineth_4f(i7
* ,i8)%c,dd=clineth_4f(i7,i8)%d,a1=lg5_78(i7,i8)%a,b1=lg5_78(i7,i8)%b,c1
* =lg5_78(i7,i8)%c,d1=lg5_78(i7,i8)%d,a2=rh6_578%a,b2=rh6_578%b,c2=rh6_5
* 78%c,prq=p578q,m=rmass(id5),nsum=0
      clineth_4f(i7,i8)%a(1,2)=lg5_78(i7,i8)%a(1,1)*rh6_578%a(1,
     & 2)+lg5_78(i7,i8)%c(1,2)*p578q*rh6_578%b(2,2)
      clineth_4f(i7,i8)%b(1,2)=rmass(id5)*(lg5_78(i7,i8)%d(1,1)*
     & rh6_578%a(1,2)+lg5_78(i7,i8)%b(1,2)*rh6_578%b(2,2))
      clineth_4f(i7,i8)%c(1,2)=rmass(id5)*lg5_78(i7,i8)%c(1,2)*r
     & h6_578%c(2,2)
      clineth_4f(i7,i8)%d(1,2)=lg5_78(i7,i8)%b(1,2)*rh6_578%c(2,
     & 2)
      clineth_4f(i7,i8)%a(1,1)=rmass(id5)*(lg5_78(i7,i8)%a(1,1)*
     & rh6_578%b(1,1)+lg5_78(i7,i8)%c(1,2)*rh6_578%a(2,1))
      clineth_4f(i7,i8)%b(1,1)=lg5_78(i7,i8)%d(1,1)*p578q*rh6_57
     & 8%b(1,1)+lg5_78(i7,i8)%b(1,2)*rh6_578%a(2,1)
      clineth_4f(i7,i8)%c(1,1)=lg5_78(i7,i8)%a(1,1)*rh6_578%c(1,
     & 1)
      clineth_4f(i7,i8)%d(1,1)=rmass(id5)*lg5_78(i7,i8)%d(1,1)*r
     & h6_578%c(1,1)
      clineth_4f(i7,i8)%a(2,2)=rmass(id5)*(lg5_78(i7,i8)%c(2,1)*
     & rh6_578%a(1,2)+lg5_78(i7,i8)%a(2,2)*rh6_578%b(2,2))
      clineth_4f(i7,i8)%b(2,2)=lg5_78(i7,i8)%b(2,1)*rh6_578%a(1,
     & 2)+lg5_78(i7,i8)%d(2,2)*p578q*rh6_578%b(2,2)
      clineth_4f(i7,i8)%c(2,2)=lg5_78(i7,i8)%a(2,2)*rh6_578%c(2,
     & 2)
      clineth_4f(i7,i8)%d(2,2)=rmass(id5)*lg5_78(i7,i8)%d(2,2)*r
     & h6_578%c(2,2)
      clineth_4f(i7,i8)%a(2,1)=lg5_78(i7,i8)%c(2,1)*p578q*rh6_57
     & 8%b(1,1)+lg5_78(i7,i8)%a(2,2)*rh6_578%a(2,1)
      clineth_4f(i7,i8)%b(2,1)=rmass(id5)*(lg5_78(i7,i8)%b(2,1)*
     & rh6_578%b(1,1)+lg5_78(i7,i8)%d(2,2)*rh6_578%a(2,1))
      clineth_4f(i7,i8)%c(2,1)=rmass(id5)*lg5_78(i7,i8)%c(2,1)*r
     & h6_578%c(1,1)
      clineth_4f(i7,i8)%d(2,1)=lg5_78(i7,i8)%b(2,1)*rh6_578%c(1,
     & 1)
      end do
      end do
  
      do i7=1,2
      do i8=1,2
* TSCT -- aa=clineth_4f(i7,i8)%a,bb=clineth_4f(i7,i8)%b,cc=clineth_4f(i7
* ,i8)%c,dd=clineth_4f(i7,i8)%d,a1=lh5_678%a,b1=lh5_678%b,c1=lh5_678%c,a
* 2=rg6_78(i7,i8)%a,b2=rg6_78(i7,i8)%b,c2=rg6_78(i7,i8)%c,d2=rg6_78(i7,i
* 8)%d,prq=p678q,m=rmass(id5),nsum=1
      clineth_4f(i7,i8)%a(2,1)=clineth_4f(i7,i8)%a(2,1)+lh5_678%
     & a(2,1)*rg6_78(i7,i8)%a(1,1)+lh5_678%c(2,2)*p678q*rg6_78(i
     & 7,i8)%b(2,1)
      clineth_4f(i7,i8)%b(2,1)=clineth_4f(i7,i8)%b(2,1)+rmass(id
     & 5)*lh5_678%b(2,2)*rg6_78(i7,i8)%b(2,1)
      clineth_4f(i7,i8)%c(2,1)=clineth_4f(i7,i8)%c(2,1)+rmass(id
     & 5)*(lh5_678%a(2,1)*rg6_78(i7,i8)%d(1,1)+lh5_678%c(2,2)*rg
     & 6_78(i7,i8)%c(2,1))
      clineth_4f(i7,i8)%d(2,1)=clineth_4f(i7,i8)%d(2,1)+lh5_678%
     & b(2,2)*rg6_78(i7,i8)%c(2,1)
      clineth_4f(i7,i8)%a(2,2)=clineth_4f(i7,i8)%a(2,2)+rmass(id
     & 5)*(lh5_678%a(2,1)*rg6_78(i7,i8)%b(1,2)+lh5_678%c(2,2)*rg
     & 6_78(i7,i8)%a(2,2))
      clineth_4f(i7,i8)%b(2,2)=clineth_4f(i7,i8)%b(2,2)+lh5_678%
     & b(2,2)*rg6_78(i7,i8)%a(2,2)
      clineth_4f(i7,i8)%c(2,2)=clineth_4f(i7,i8)%c(2,2)+lh5_678%
     & a(2,1)*rg6_78(i7,i8)%c(1,2)+lh5_678%c(2,2)*p678q*rg6_78(i
     & 7,i8)%d(2,2)
      clineth_4f(i7,i8)%d(2,2)=clineth_4f(i7,i8)%d(2,2)+rmass(id
     & 5)*lh5_678%b(2,2)*rg6_78(i7,i8)%d(2,2)
      clineth_4f(i7,i8)%a(1,1)=clineth_4f(i7,i8)%a(1,1)+rmass(id
     & 5)*(lh5_678%c(1,1)*rg6_78(i7,i8)%a(1,1)+lh5_678%a(1,2)*rg
     & 6_78(i7,i8)%b(2,1))
      clineth_4f(i7,i8)%b(1,1)=clineth_4f(i7,i8)%b(1,1)+lh5_678%
     & b(1,1)*rg6_78(i7,i8)%a(1,1)
      clineth_4f(i7,i8)%c(1,1)=clineth_4f(i7,i8)%c(1,1)+lh5_678%
     & c(1,1)*p678q*rg6_78(i7,i8)%d(1,1)+lh5_678%a(1,2)*rg6_78(i
     & 7,i8)%c(2,1)
      clineth_4f(i7,i8)%d(1,1)=clineth_4f(i7,i8)%d(1,1)+rmass(id
     & 5)*lh5_678%b(1,1)*rg6_78(i7,i8)%d(1,1)
      clineth_4f(i7,i8)%a(1,2)=clineth_4f(i7,i8)%a(1,2)+lh5_678%
     & c(1,1)*p678q*rg6_78(i7,i8)%b(1,2)+lh5_678%a(1,2)*rg6_78(i
     & 7,i8)%a(2,2)
      clineth_4f(i7,i8)%b(1,2)=clineth_4f(i7,i8)%b(1,2)+rmass(id
     & 5)*lh5_678%b(1,1)*rg6_78(i7,i8)%b(1,2)
      clineth_4f(i7,i8)%c(1,2)=clineth_4f(i7,i8)%c(1,2)+rmass(id
     & 5)*(lh5_678%c(1,1)*rg6_78(i7,i8)%c(1,2)+lh5_678%a(1,2)*rg
     & 6_78(i7,i8)%d(2,2))
      clineth_4f(i7,i8)%d(1,2)=clineth_4f(i7,i8)%d(1,2)+lh5_678%
     & b(1,1)*rg6_78(i7,i8)%c(1,2)
      end do
      end do
  
      rmassl=rmass(id5)
      rmassr=-rmass(id5)
  
      do i7=1,2
      do i8=1,2
* mline -- res=chqcd5678(&1,&2,i7,i8),abcd=clineth_4f(i7,i8)%,m1=rmassl,
* m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      chqcd5678(iut,jut,i7,i8)=clineth_4f(i7,i8)%a(iut,jut)+rmas
     & sl*clineth_4f(i7,i8)%b(iut,jut)+rmassr*clineth_4f(i7,i8)%
     & c(iut,jut)+rmassl*rmassr*clineth_4f(i7,i8)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
      endif
  
      if (id7.eq.5.and.rmh.ge.0.d0) then
  
      do i5=1,2
      do i6=1,2
* TTSC -- aa=clineth_4f(i5,i6)%a,bb=clineth_4f(i5,i6)%b,cc=clineth_4f(i5
* ,i6)%c,dd=clineth_4f(i5,i6)%d,a1=lg7_56(i5,i6)%a,b1=lg7_56(i5,i6)%b,c1
* =lg7_56(i5,i6)%c,d1=lg7_56(i5,i6)%d,a2=rh8_756%a,b2=rh8_756%b,c2=rh8_7
* 56%c,prq=p756q,m=rmass(id7),nsum=0
      clineth_4f(i5,i6)%a(1,2)=lg7_56(i5,i6)%a(1,1)*rh8_756%a(1,
     & 2)+lg7_56(i5,i6)%c(1,2)*p756q*rh8_756%b(2,2)
      clineth_4f(i5,i6)%b(1,2)=rmass(id7)*(lg7_56(i5,i6)%d(1,1)*
     & rh8_756%a(1,2)+lg7_56(i5,i6)%b(1,2)*rh8_756%b(2,2))
      clineth_4f(i5,i6)%c(1,2)=rmass(id7)*lg7_56(i5,i6)%c(1,2)*r
     & h8_756%c(2,2)
      clineth_4f(i5,i6)%d(1,2)=lg7_56(i5,i6)%b(1,2)*rh8_756%c(2,
     & 2)
      clineth_4f(i5,i6)%a(1,1)=rmass(id7)*(lg7_56(i5,i6)%a(1,1)*
     & rh8_756%b(1,1)+lg7_56(i5,i6)%c(1,2)*rh8_756%a(2,1))
      clineth_4f(i5,i6)%b(1,1)=lg7_56(i5,i6)%d(1,1)*p756q*rh8_75
     & 6%b(1,1)+lg7_56(i5,i6)%b(1,2)*rh8_756%a(2,1)
      clineth_4f(i5,i6)%c(1,1)=lg7_56(i5,i6)%a(1,1)*rh8_756%c(1,
     & 1)
      clineth_4f(i5,i6)%d(1,1)=rmass(id7)*lg7_56(i5,i6)%d(1,1)*r
     & h8_756%c(1,1)
      clineth_4f(i5,i6)%a(2,2)=rmass(id7)*(lg7_56(i5,i6)%c(2,1)*
     & rh8_756%a(1,2)+lg7_56(i5,i6)%a(2,2)*rh8_756%b(2,2))
      clineth_4f(i5,i6)%b(2,2)=lg7_56(i5,i6)%b(2,1)*rh8_756%a(1,
     & 2)+lg7_56(i5,i6)%d(2,2)*p756q*rh8_756%b(2,2)
      clineth_4f(i5,i6)%c(2,2)=lg7_56(i5,i6)%a(2,2)*rh8_756%c(2,
     & 2)
      clineth_4f(i5,i6)%d(2,2)=rmass(id7)*lg7_56(i5,i6)%d(2,2)*r
     & h8_756%c(2,2)
      clineth_4f(i5,i6)%a(2,1)=lg7_56(i5,i6)%c(2,1)*p756q*rh8_75
     & 6%b(1,1)+lg7_56(i5,i6)%a(2,2)*rh8_756%a(2,1)
      clineth_4f(i5,i6)%b(2,1)=rmass(id7)*(lg7_56(i5,i6)%b(2,1)*
     & rh8_756%b(1,1)+lg7_56(i5,i6)%d(2,2)*rh8_756%a(2,1))
      clineth_4f(i5,i6)%c(2,1)=rmass(id7)*lg7_56(i5,i6)%c(2,1)*r
     & h8_756%c(1,1)
      clineth_4f(i5,i6)%d(2,1)=lg7_56(i5,i6)%b(2,1)*rh8_756%c(1,
     & 1)
      end do
      end do
  
      do i5=1,2
      do i6=1,2
* TSCT -- aa=clineth_4f(i5,i6)%a,bb=clineth_4f(i5,i6)%b,cc=clineth_4f(i5
* ,i6)%c,dd=clineth_4f(i5,i6)%d,a1=lh7_856%a,b1=lh7_856%b,c1=lh7_856%c,a
* 2=rg8_56(i5,i6)%a,b2=rg8_56(i5,i6)%b,c2=rg8_56(i5,i6)%c,d2=rg8_56(i5,i
* 6)%d,prq=p856q,m=rmass(id7),nsum=1
      clineth_4f(i5,i6)%a(2,1)=clineth_4f(i5,i6)%a(2,1)+lh7_856%
     & a(2,1)*rg8_56(i5,i6)%a(1,1)+lh7_856%c(2,2)*p856q*rg8_56(i
     & 5,i6)%b(2,1)
      clineth_4f(i5,i6)%b(2,1)=clineth_4f(i5,i6)%b(2,1)+rmass(id
     & 7)*lh7_856%b(2,2)*rg8_56(i5,i6)%b(2,1)
      clineth_4f(i5,i6)%c(2,1)=clineth_4f(i5,i6)%c(2,1)+rmass(id
     & 7)*(lh7_856%a(2,1)*rg8_56(i5,i6)%d(1,1)+lh7_856%c(2,2)*rg
     & 8_56(i5,i6)%c(2,1))
      clineth_4f(i5,i6)%d(2,1)=clineth_4f(i5,i6)%d(2,1)+lh7_856%
     & b(2,2)*rg8_56(i5,i6)%c(2,1)
      clineth_4f(i5,i6)%a(2,2)=clineth_4f(i5,i6)%a(2,2)+rmass(id
     & 7)*(lh7_856%a(2,1)*rg8_56(i5,i6)%b(1,2)+lh7_856%c(2,2)*rg
     & 8_56(i5,i6)%a(2,2))
      clineth_4f(i5,i6)%b(2,2)=clineth_4f(i5,i6)%b(2,2)+lh7_856%
     & b(2,2)*rg8_56(i5,i6)%a(2,2)
      clineth_4f(i5,i6)%c(2,2)=clineth_4f(i5,i6)%c(2,2)+lh7_856%
     & a(2,1)*rg8_56(i5,i6)%c(1,2)+lh7_856%c(2,2)*p856q*rg8_56(i
     & 5,i6)%d(2,2)
      clineth_4f(i5,i6)%d(2,2)=clineth_4f(i5,i6)%d(2,2)+rmass(id
     & 7)*lh7_856%b(2,2)*rg8_56(i5,i6)%d(2,2)
      clineth_4f(i5,i6)%a(1,1)=clineth_4f(i5,i6)%a(1,1)+rmass(id
     & 7)*(lh7_856%c(1,1)*rg8_56(i5,i6)%a(1,1)+lh7_856%a(1,2)*rg
     & 8_56(i5,i6)%b(2,1))
      clineth_4f(i5,i6)%b(1,1)=clineth_4f(i5,i6)%b(1,1)+lh7_856%
     & b(1,1)*rg8_56(i5,i6)%a(1,1)
      clineth_4f(i5,i6)%c(1,1)=clineth_4f(i5,i6)%c(1,1)+lh7_856%
     & c(1,1)*p856q*rg8_56(i5,i6)%d(1,1)+lh7_856%a(1,2)*rg8_56(i
     & 5,i6)%c(2,1)
      clineth_4f(i5,i6)%d(1,1)=clineth_4f(i5,i6)%d(1,1)+rmass(id
     & 7)*lh7_856%b(1,1)*rg8_56(i5,i6)%d(1,1)
      clineth_4f(i5,i6)%a(1,2)=clineth_4f(i5,i6)%a(1,2)+lh7_856%
     & c(1,1)*p856q*rg8_56(i5,i6)%b(1,2)+lh7_856%a(1,2)*rg8_56(i
     & 5,i6)%a(2,2)
      clineth_4f(i5,i6)%b(1,2)=clineth_4f(i5,i6)%b(1,2)+rmass(id
     & 7)*lh7_856%b(1,1)*rg8_56(i5,i6)%b(1,2)
      clineth_4f(i5,i6)%c(1,2)=clineth_4f(i5,i6)%c(1,2)+rmass(id
     & 7)*(lh7_856%c(1,1)*rg8_56(i5,i6)%c(1,2)+lh7_856%a(1,2)*rg
     & 8_56(i5,i6)%d(2,2))
      clineth_4f(i5,i6)%d(1,2)=clineth_4f(i5,i6)%d(1,2)+lh7_856%
     & b(1,1)*rg8_56(i5,i6)%c(1,2)
      end do
      end do
  
      rmassl=rmass(id7)
      rmassr=-rmass(id7)
  
      do i5=1,2
      do i6=1,2
* mline -- res=chqcd5678(i5,i6,&1,&2),abcd=clineth_4f(i5,i6)%,m1=rmassl,
* m2=rmassr,den=0,nsum=1
      do iut=1,2
      do jut=1,2
      chqcd5678(i5,i6,iut,jut)=chqcd5678(i5,i6,iut,jut)+clineth_
     & 4f(i5,i6)%a(iut,jut)+rmassl*clineth_4f(i5,i6)%b(iut,jut)+
     & rmassr*clineth_4f(i5,i6)%c(iut,jut)+rmassl*rmassr*clineth
     & _4f(i5,i6)%d(iut,jut)
      enddo
      enddo
      end do
      end do
  
      endif
  
*                                                                       
* Then link the computed subdiagrams with the "higgs" insertion         
* [ch1234(2,2,2,2)]                                                     
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7)   
*                                                                       
  
      if(rmh.ge.0.d0 .and. (id5.eq.5 .or. id7.eq.5))then
        do i1=1,2
          do i2=1,2
            do i3=1,2
              do i4=1,2
                do i5=1,2
                  do i6=1,2
                    do i7=1,2
                      do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) =
     &                       cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) +
     &                       (chqcd5678(i5,i6,i7,i8)*
     &                       ch1234(i1,i2,i3,i4))/
     &                       (p5678q-cmh2)
                      enddo
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      endif
  
  
**************Compute diagrams of class 2.d) (three-forks)**************
*                                                                       
* Diagrams are built-up by linking the following structures:            
*                                                                       
* u5|_1234     % rg6|_7|8|       [Z/f/h Z/f/h g]                        
* ug5|_7|8|12  % r6|_34          [g Z/f/h Z/f/h + Z/f/h g Z/f/h]        
* ug5|_7|8|34  % r6|_12          [g Z/f/h Z/f/h + Z/f/h g Z/f/h]        
*                                                                       
* where 5|={5,7}, 6|={6,8}, 7|8|={78,56}.                               
* Results are directly added to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7)   
*                                                                       
  
      rmassl=rmass(id5)
      rmassr=-rmass(id5)
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* TsT -- aa=cline_3forks_56(i1,i2,i3,i4,i7,i8)%a,bb=cline_3forks_56(i1,i
* 2,i3,i4,i7,i8)%b,cc=cline_3forks_56(i1,i2,i3,i4,i7,i8)%c,dd=cline_3for
* ks_56(i1,i2,i3,i4,i7,i8)%d,a1=u5_1234(i1,i2,i3,i4)%a,b1=u5_1234(i1,i2,
* i3,i4)%b,c1=u5_1234(i1,i2,i3,i4)%c,d1=u5_1234(i1,i2,i3,i4)%d,a2=rg6_78
* (i7,i8)%a,b2=rg6_78(i7,i8)%b,c2=rg6_78(i7,i8)%c,d2=rg6_78(i7,i8)%d,prq
* =p678q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=u5_1234(i1,i2,i3,i4)%a(iut,1)+u5_1234(i1,i2,i3,i4)%c(i
     & ut,1)*rmass(id5)
      cx2=u5_1234(i1,i2,i3,i4)%c(iut,2)*p678q+u5_1234(i1,i2,i3,i
     & 4)%a(iut,2)*rmass(id5)
      cy1=u5_1234(i1,i2,i3,i4)%b(iut,1)+u5_1234(i1,i2,i3,i4)%d(i
     & ut,1)*rmass(id5)
      cy2=u5_1234(i1,i2,i3,i4)%d(iut,2)*p678q+u5_1234(i1,i2,i3,i
     & 4)%b(iut,2)*rmass(id5)
      cw1=u5_1234(i1,i2,i3,i4)%c(iut,1)*p678q+u5_1234(i1,i2,i3,i
     & 4)%a(iut,1)*rmass(id5)
      cw2=u5_1234(i1,i2,i3,i4)%a(iut,2)+u5_1234(i1,i2,i3,i4)%c(i
     & ut,2)*rmass(id5)
      cz1=u5_1234(i1,i2,i3,i4)%d(iut,1)*p678q+u5_1234(i1,i2,i3,i
     & 4)%b(iut,1)*rmass(id5)
      cz2=u5_1234(i1,i2,i3,i4)%b(iut,2)+u5_1234(i1,i2,i3,i4)%d(i
     & ut,2)*rmass(id5)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%a(iut,1)=cx1*rg6_78(i7,
     & i8)%a(1,1)+cx2*rg6_78(i7,i8)%b(2,1)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%b(iut,1)=cy1*rg6_78(i7,
     & i8)%a(1,1)+cy2*rg6_78(i7,i8)%b(2,1)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%c(iut,1)=cw1*rg6_78(i7,
     & i8)%d(1,1)+cw2*rg6_78(i7,i8)%c(2,1)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%d(iut,1)=cz1*rg6_78(i7,
     & i8)%d(1,1)+cz2*rg6_78(i7,i8)%c(2,1)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%a(iut,2)=cw1*rg6_78(i7,
     & i8)%b(1,2)+cw2*rg6_78(i7,i8)%a(2,2)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%b(iut,2)=cz1*rg6_78(i7,
     & i8)%b(1,2)+cz2*rg6_78(i7,i8)%a(2,2)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%c(iut,2)=cx1*rg6_78(i7,
     & i8)%c(1,2)+cx2*rg6_78(i7,i8)%d(2,2)
      cline_3forks_56(i1,i2,i3,i4,i7,i8)%d(iut,2)=cy1*rg6_78(i7,
     & i8)%c(1,2)+cy2*rg6_78(i7,i8)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i7=1,2
      do i8=1,2
* mline -- res=cres_3forks_56(i1,i2,i3,i4,i7,i8)%pol(&1,&2),abcd=cline_3
* forks_56(i1,i2,i3,i4,i7,i8)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_56(i1,i2,i3,i4,i7,i8)%pol(iut,jut)=cline_3fork
     & s_56(i1,i2,i3,i4,i7,i8)%a(iut,jut)+rmassl*cline_3forks_56
     & (i1,i2,i3,i4,i7,i8)%b(iut,jut)+rmassr*cline_3forks_56(i1,
     & i2,i3,i4,i7,i8)%c(iut,jut)+rmassl*rmassr*cline_3forks_56(
     & i1,i2,i3,i4,i7,i8)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) +
     &                     cres_3forks_56(i1,i2,i3,i4,i7,i8)
     &                     %pol(i5,i6)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id3.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TsTs -- aa=cline_3forks_56(i7,i8,i1,i2,i3,i4)%a,bb=cline_3forks_56(i7,
* i8,i1,i2,i3,i4)%b,cc=cline_3forks_56(i7,i8,i1,i2,i3,i4)%c,dd=cline_3fo
* rks_56(i7,i8,i1,i2,i3,i4)%d,a1=ug5_7812(i7,i8,i1,i2)%a,b1=ug5_7812(i7,
* i8,i1,i2)%b,c1=ug5_7812(i7,i8,i1,i2)%c,d1=ug5_7812(i7,i8,i1,i2)%d,a2=r
* 6_34(i3,i4)%a,b2=r6_34(i3,i4)%b,c2=r6_34(i3,i4)%c,d2=r6_34(i3,i4)%d,pr
* q=p634q,m=rmass(id5),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r6_34(i3,i4)%a(1,jut)+rmass(id5)*r6_34(i3,i4)%b(1,jut)
      cx2=r6_34(i3,i4)%a(2,jut)+rmass(id5)*r6_34(i3,i4)%b(2,jut)
      cy1=p634q*r6_34(i3,i4)%b(1,jut)+rmass(id5)*r6_34(i3,i4)%a(
     & 1,jut)
      cy2=p634q*r6_34(i3,i4)%b(2,jut)+rmass(id5)*r6_34(i3,i4)%a(
     & 2,jut)
      cline_3forks_56(i7,i8,i1,i2,i3,i4)%a(iut,jut)=ug5_7812(i7,
     & i8,i1,i2)%a(iut,1)*cx1+ug5_7812(i7,i8,i1,i2)%c(iut,1)*cy1
     & +ug5_7812(i7,i8,i1,i2)%a(iut,2)*cx2+ug5_7812(i7,i8,i1,i2)
     & %c(iut,2)*cy2
      cline_3forks_56(i7,i8,i1,i2,i3,i4)%b(iut,jut)=ug5_7812(i7,
     & i8,i1,i2)%b(iut,1)*cx1+ug5_7812(i7,i8,i1,i2)%d(iut,1)*cy1
     & +ug5_7812(i7,i8,i1,i2)%b(iut,2)*cx2+ug5_7812(i7,i8,i1,i2)
     & %d(iut,2)*cy2
      cw1=r6_34(i3,i4)%c(1,jut)+rmass(id5)*r6_34(i3,i4)%d(1,jut)
      cw2=r6_34(i3,i4)%c(2,jut)+rmass(id5)*r6_34(i3,i4)%d(2,jut)
      cz1=p634q*r6_34(i3,i4)%d(1,jut)+rmass(id5)*r6_34(i3,i4)%c(
     & 1,jut)
      cz2=p634q*r6_34(i3,i4)%d(2,jut)+rmass(id5)*r6_34(i3,i4)%c(
     & 2,jut)
      cline_3forks_56(i7,i8,i1,i2,i3,i4)%c(iut,jut)=ug5_7812(i7,
     & i8,i1,i2)%a(iut,1)*cw1+ug5_7812(i7,i8,i1,i2)%c(iut,1)*cz1
     & +ug5_7812(i7,i8,i1,i2)%a(iut,2)*cw2+ug5_7812(i7,i8,i1,i2)
     & %c(iut,2)*cz2
      cline_3forks_56(i7,i8,i1,i2,i3,i4)%d(iut,jut)=ug5_7812(i7,
     & i8,i1,i2)%b(iut,1)*cw1+ug5_7812(i7,i8,i1,i2)%d(iut,1)*cz1
     & +ug5_7812(i7,i8,i1,i2)%b(iut,2)*cw2+ug5_7812(i7,i8,i1,i2)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=cline_3forks_56(i7,i8,i1,i2,i3,i4)%a,bb=cline_3forks_56(i7,i
* 8,i1,i2,i3,i4)%b,cc=cline_3forks_56(i7,i8,i1,i2,i3,i4)%c,dd=cline_3for
* ks_56(i7,i8,i1,i2,i3,i4)%d,a1=ug5_7812(i7,i8,i1,i2)%a,b1=ug5_7812(i7,i
* 8,i1,i2)%b,c1=ug5_7812(i7,i8,i1,i2)%c,d1=ug5_7812(i7,i8,i1,i2)%d,a2=r6
* _34(i3,i4)%a,b2=r6_34(i3,i4)%b,c2=r6_34(i3,i4)%c,d2=r6_34(i3,i4)%d,prq
* =p634q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=ug5_7812(i7,i8,i1,i2)%a(iut,1)+ug5_7812(i7,i8,i1,i2)%c
     & (iut,1)*rmass(id5)
      cx2=ug5_7812(i7,i8,i1,i2)%c(iut,2)*p634q+ug5_7812(i7,i8,i1
     & ,i2)%a(iut,2)*rmass(id5)
      cy1=ug5_7812(i7,i8,i1,i2)%b(iut,1)+ug5_7812(i7,i8,i1,i2)%d
     & (iut,1)*rmass(id5)
      cy2=ug5_7812(i7,i8,i1,i2)%d(iut,2)*p634q+ug5_7812(i7,i8,i1
     & ,i2)%b(iut,2)*rmass(id5)
      cw1=ug5_7812(i7,i8,i1,i2)%c(iut,1)*p634q+ug5_7812(i7,i8,i1
     & ,i2)%a(iut,1)*rmass(id5)
      cw2=ug5_7812(i7,i8,i1,i2)%a(iut,2)+ug5_7812(i7,i8,i1,i2)%c
     & (iut,2)*rmass(id5)
      cz1=ug5_7812(i7,i8,i1,i2)%d(iut,1)*p634q+ug5_7812(i7,i8,i1
     & ,i2)%b(iut,1)*rmass(id5)
      cz2=ug5_7812(i7,i8,i1,i2)%b(iut,2)+ug5_7812(i7,i8,i1,i2)%d
     & (iut,2)*rmass(id5)
      cline_3forks_56(i7,i8,i1,i2,i3,i4)%a(iut,1)=cx1*r6_34(i3,i
     & 4)%a(1,1)+cx2*r6_34(i3,i4)%b(2,1)
      cline_3forks_56(i7,i8,i1,i2,i3,i4)%b(iut,1)=cy1*r6_34(i3,i
     & 4)%a(1,1)+cy2*r6_34(i3,i4)%b(2,1)
      cline_3forks_56(i7,i8,i1,i2,i3,i4)%c(iut,1)=cw1*r6_34(i3,i
     & 4)%d(1,1)+cw2*r6_34(i3,i4)%c(2,1)
      cline_3forks_56(i7,i8,i1,i2,i3,i4)%d(iut,1)=cz1*r6_34(i3,i
     & 4)%d(1,1)+cz2*r6_34(i3,i4)%c(2,1)
      cline_3forks_56(i7,i8,i1,i2,i3,i4)%a(iut,2)=cw1*r6_34(i3,i
     & 4)%b(1,2)+cw2*r6_34(i3,i4)%a(2,2)
      cline_3forks_56(i7,i8,i1,i2,i3,i4)%b(iut,2)=cz1*r6_34(i3,i
     & 4)%b(1,2)+cz2*r6_34(i3,i4)%a(2,2)
      cline_3forks_56(i7,i8,i1,i2,i3,i4)%c(iut,2)=cx1*r6_34(i3,i
     & 4)%c(1,2)+cx2*r6_34(i3,i4)%d(2,2)
      cline_3forks_56(i7,i8,i1,i2,i3,i4)%d(iut,2)=cy1*r6_34(i3,i
     & 4)%c(1,2)+cy2*r6_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i7=1,2
      do i8=1,2
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* mline -- res=cres_3forks_56(i7,i8,i1,i2,i3,i4)%pol(&1,&2),abcd=cline_3
* forks_56(i7,i8,i1,i2,i3,i4)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_56(i7,i8,i1,i2,i3,i4)%pol(iut,jut)=cline_3fork
     & s_56(i7,i8,i1,i2,i3,i4)%a(iut,jut)+rmassl*cline_3forks_56
     & (i7,i8,i1,i2,i3,i4)%b(iut,jut)+rmassr*cline_3forks_56(i7,
     & i8,i1,i2,i3,i4)%c(iut,jut)+rmassl*rmassr*cline_3forks_56(
     & i7,i8,i1,i2,i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) +
     &                     cres_3forks_56(i7,i8,i1,i2,i3,i4)
     &                     %pol(i5,i6)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
      if(id1.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
* TsTs -- aa=cline_3forks_56(i7,i8,i3,i4,i1,i2)%a,bb=cline_3forks_56(i7,
* i8,i3,i4,i1,i2)%b,cc=cline_3forks_56(i7,i8,i3,i4,i1,i2)%c,dd=cline_3fo
* rks_56(i7,i8,i3,i4,i1,i2)%d,a1=ug5_7834(i7,i8,i3,i4)%a,b1=ug5_7834(i7,
* i8,i3,i4)%b,c1=ug5_7834(i7,i8,i3,i4)%c,d1=ug5_7834(i7,i8,i3,i4)%d,a2=r
* 6_12(i1,i2)%a,b2=r6_12(i1,i2)%b,c2=r6_12(i1,i2)%c,d2=r6_12(i1,i2)%d,pr
* q=p612q,m=rmass(id5),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r6_12(i1,i2)%a(1,jut)+rmass(id5)*r6_12(i1,i2)%b(1,jut)
      cx2=r6_12(i1,i2)%a(2,jut)+rmass(id5)*r6_12(i1,i2)%b(2,jut)
      cy1=p612q*r6_12(i1,i2)%b(1,jut)+rmass(id5)*r6_12(i1,i2)%a(
     & 1,jut)
      cy2=p612q*r6_12(i1,i2)%b(2,jut)+rmass(id5)*r6_12(i1,i2)%a(
     & 2,jut)
      cline_3forks_56(i7,i8,i3,i4,i1,i2)%a(iut,jut)=ug5_7834(i7,
     & i8,i3,i4)%a(iut,1)*cx1+ug5_7834(i7,i8,i3,i4)%c(iut,1)*cy1
     & +ug5_7834(i7,i8,i3,i4)%a(iut,2)*cx2+ug5_7834(i7,i8,i3,i4)
     & %c(iut,2)*cy2
      cline_3forks_56(i7,i8,i3,i4,i1,i2)%b(iut,jut)=ug5_7834(i7,
     & i8,i3,i4)%b(iut,1)*cx1+ug5_7834(i7,i8,i3,i4)%d(iut,1)*cy1
     & +ug5_7834(i7,i8,i3,i4)%b(iut,2)*cx2+ug5_7834(i7,i8,i3,i4)
     & %d(iut,2)*cy2
      cw1=r6_12(i1,i2)%c(1,jut)+rmass(id5)*r6_12(i1,i2)%d(1,jut)
      cw2=r6_12(i1,i2)%c(2,jut)+rmass(id5)*r6_12(i1,i2)%d(2,jut)
      cz1=p612q*r6_12(i1,i2)%d(1,jut)+rmass(id5)*r6_12(i1,i2)%c(
     & 1,jut)
      cz2=p612q*r6_12(i1,i2)%d(2,jut)+rmass(id5)*r6_12(i1,i2)%c(
     & 2,jut)
      cline_3forks_56(i7,i8,i3,i4,i1,i2)%c(iut,jut)=ug5_7834(i7,
     & i8,i3,i4)%a(iut,1)*cw1+ug5_7834(i7,i8,i3,i4)%c(iut,1)*cz1
     & +ug5_7834(i7,i8,i3,i4)%a(iut,2)*cw2+ug5_7834(i7,i8,i3,i4)
     & %c(iut,2)*cz2
      cline_3forks_56(i7,i8,i3,i4,i1,i2)%d(iut,jut)=ug5_7834(i7,
     & i8,i3,i4)%b(iut,1)*cw1+ug5_7834(i7,i8,i3,i4)%d(iut,1)*cz1
     & +ug5_7834(i7,i8,i3,i4)%b(iut,2)*cw2+ug5_7834(i7,i8,i3,i4)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=cline_3forks_56(i7,i8,i3,i4,i1,i2)%a,bb=cline_3forks_56(i7,i
* 8,i3,i4,i1,i2)%b,cc=cline_3forks_56(i7,i8,i3,i4,i1,i2)%c,dd=cline_3for
* ks_56(i7,i8,i3,i4,i1,i2)%d,a1=ug5_7834(i7,i8,i3,i4)%a,b1=ug5_7834(i7,i
* 8,i3,i4)%b,c1=ug5_7834(i7,i8,i3,i4)%c,d1=ug5_7834(i7,i8,i3,i4)%d,a2=r6
* _12(i1,i2)%a,b2=r6_12(i1,i2)%b,c2=r6_12(i1,i2)%c,d2=r6_12(i1,i2)%d,prq
* =p612q,m=rmass(id5),nsum=0
      do iut=1,2
      cx1=ug5_7834(i7,i8,i3,i4)%a(iut,1)+ug5_7834(i7,i8,i3,i4)%c
     & (iut,1)*rmass(id5)
      cx2=ug5_7834(i7,i8,i3,i4)%c(iut,2)*p612q+ug5_7834(i7,i8,i3
     & ,i4)%a(iut,2)*rmass(id5)
      cy1=ug5_7834(i7,i8,i3,i4)%b(iut,1)+ug5_7834(i7,i8,i3,i4)%d
     & (iut,1)*rmass(id5)
      cy2=ug5_7834(i7,i8,i3,i4)%d(iut,2)*p612q+ug5_7834(i7,i8,i3
     & ,i4)%b(iut,2)*rmass(id5)
      cw1=ug5_7834(i7,i8,i3,i4)%c(iut,1)*p612q+ug5_7834(i7,i8,i3
     & ,i4)%a(iut,1)*rmass(id5)
      cw2=ug5_7834(i7,i8,i3,i4)%a(iut,2)+ug5_7834(i7,i8,i3,i4)%c
     & (iut,2)*rmass(id5)
      cz1=ug5_7834(i7,i8,i3,i4)%d(iut,1)*p612q+ug5_7834(i7,i8,i3
     & ,i4)%b(iut,1)*rmass(id5)
      cz2=ug5_7834(i7,i8,i3,i4)%b(iut,2)+ug5_7834(i7,i8,i3,i4)%d
     & (iut,2)*rmass(id5)
      cline_3forks_56(i7,i8,i3,i4,i1,i2)%a(iut,1)=cx1*r6_12(i1,i
     & 2)%a(1,1)+cx2*r6_12(i1,i2)%b(2,1)
      cline_3forks_56(i7,i8,i3,i4,i1,i2)%b(iut,1)=cy1*r6_12(i1,i
     & 2)%a(1,1)+cy2*r6_12(i1,i2)%b(2,1)
      cline_3forks_56(i7,i8,i3,i4,i1,i2)%c(iut,1)=cw1*r6_12(i1,i
     & 2)%d(1,1)+cw2*r6_12(i1,i2)%c(2,1)
      cline_3forks_56(i7,i8,i3,i4,i1,i2)%d(iut,1)=cz1*r6_12(i1,i
     & 2)%d(1,1)+cz2*r6_12(i1,i2)%c(2,1)
      cline_3forks_56(i7,i8,i3,i4,i1,i2)%a(iut,2)=cw1*r6_12(i1,i
     & 2)%b(1,2)+cw2*r6_12(i1,i2)%a(2,2)
      cline_3forks_56(i7,i8,i3,i4,i1,i2)%b(iut,2)=cz1*r6_12(i1,i
     & 2)%b(1,2)+cz2*r6_12(i1,i2)%a(2,2)
      cline_3forks_56(i7,i8,i3,i4,i1,i2)%c(iut,2)=cx1*r6_12(i1,i
     & 2)%c(1,2)+cx2*r6_12(i1,i2)%d(2,2)
      cline_3forks_56(i7,i8,i3,i4,i1,i2)%d(iut,2)=cy1*r6_12(i1,i
     & 2)%c(1,2)+cy2*r6_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i7=1,2
      do i8=1,2
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
* mline -- res=cres_3forks_56(i7,i8,i3,i4,i1,i2)%pol(&1,&2),abcd=cline_3
* forks_56(i7,i8,i3,i4,i1,i2)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_56(i7,i8,i3,i4,i1,i2)%pol(iut,jut)=cline_3fork
     & s_56(i7,i8,i3,i4,i1,i2)%a(iut,jut)+rmassl*cline_3forks_56
     & (i7,i8,i3,i4,i1,i2)%b(iut,jut)+rmassr*cline_3forks_56(i7,
     & i8,i3,i4,i1,i2)%c(iut,jut)+rmassl*rmassr*cline_3forks_56(
     & i7,i8,i3,i4,i1,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) +
     &                     cres_3forks_56(i7,i8,i3,i4,i1,i2)
     &                     %pol(i5,i6)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
  
      rmassl=rmass(id7)
      rmassr=-rmass(id7)
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* TsT -- aa=cline_3forks_78(i1,i2,i3,i4,i5,i6)%a,bb=cline_3forks_78(i1,i
* 2,i3,i4,i5,i6)%b,cc=cline_3forks_78(i1,i2,i3,i4,i5,i6)%c,dd=cline_3for
* ks_78(i1,i2,i3,i4,i5,i6)%d,a1=u7_1234(i1,i2,i3,i4)%a,b1=u7_1234(i1,i2,
* i3,i4)%b,c1=u7_1234(i1,i2,i3,i4)%c,d1=u7_1234(i1,i2,i3,i4)%d,a2=rg8_56
* (i5,i6)%a,b2=rg8_56(i5,i6)%b,c2=rg8_56(i5,i6)%c,d2=rg8_56(i5,i6)%d,prq
* =p856q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=u7_1234(i1,i2,i3,i4)%a(iut,1)+u7_1234(i1,i2,i3,i4)%c(i
     & ut,1)*rmass(id7)
      cx2=u7_1234(i1,i2,i3,i4)%c(iut,2)*p856q+u7_1234(i1,i2,i3,i
     & 4)%a(iut,2)*rmass(id7)
      cy1=u7_1234(i1,i2,i3,i4)%b(iut,1)+u7_1234(i1,i2,i3,i4)%d(i
     & ut,1)*rmass(id7)
      cy2=u7_1234(i1,i2,i3,i4)%d(iut,2)*p856q+u7_1234(i1,i2,i3,i
     & 4)%b(iut,2)*rmass(id7)
      cw1=u7_1234(i1,i2,i3,i4)%c(iut,1)*p856q+u7_1234(i1,i2,i3,i
     & 4)%a(iut,1)*rmass(id7)
      cw2=u7_1234(i1,i2,i3,i4)%a(iut,2)+u7_1234(i1,i2,i3,i4)%c(i
     & ut,2)*rmass(id7)
      cz1=u7_1234(i1,i2,i3,i4)%d(iut,1)*p856q+u7_1234(i1,i2,i3,i
     & 4)%b(iut,1)*rmass(id7)
      cz2=u7_1234(i1,i2,i3,i4)%b(iut,2)+u7_1234(i1,i2,i3,i4)%d(i
     & ut,2)*rmass(id7)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%a(iut,1)=cx1*rg8_56(i5,
     & i6)%a(1,1)+cx2*rg8_56(i5,i6)%b(2,1)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%b(iut,1)=cy1*rg8_56(i5,
     & i6)%a(1,1)+cy2*rg8_56(i5,i6)%b(2,1)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%c(iut,1)=cw1*rg8_56(i5,
     & i6)%d(1,1)+cw2*rg8_56(i5,i6)%c(2,1)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%d(iut,1)=cz1*rg8_56(i5,
     & i6)%d(1,1)+cz2*rg8_56(i5,i6)%c(2,1)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%a(iut,2)=cw1*rg8_56(i5,
     & i6)%b(1,2)+cw2*rg8_56(i5,i6)%a(2,2)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%b(iut,2)=cz1*rg8_56(i5,
     & i6)%b(1,2)+cz2*rg8_56(i5,i6)%a(2,2)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%c(iut,2)=cx1*rg8_56(i5,
     & i6)%c(1,2)+cx2*rg8_56(i5,i6)%d(2,2)
      cline_3forks_78(i1,i2,i3,i4,i5,i6)%d(iut,2)=cy1*rg8_56(i5,
     & i6)%c(1,2)+cy2*rg8_56(i5,i6)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
  
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
      do i5=1,2
      do i6=1,2
* mline -- res=cres_3forks_78(i1,i2,i3,i4,i5,i6)%pol(&1,&2),abcd=cline_3
* forks_78(i1,i2,i3,i4,i5,i6)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_78(i1,i2,i3,i4,i5,i6)%pol(iut,jut)=cline_3fork
     & s_78(i1,i2,i3,i4,i5,i6)%a(iut,jut)+rmassl*cline_3forks_78
     & (i1,i2,i3,i4,i5,i6)%b(iut,jut)+rmassr*cline_3forks_78(i1,
     & i2,i3,i4,i5,i6)%c(iut,jut)+rmassl*rmassr*cline_3forks_78(
     & i1,i2,i3,i4,i5,i6)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) +
     &                     cres_3forks_78(i1,i2,i3,i4,i5,i6)
     &                     %pol(i7,i8)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id3.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TsTs -- aa=cline_3forks_78(i5,i6,i1,i2,i3,i4)%a,bb=cline_3forks_78(i5,
* i6,i1,i2,i3,i4)%b,cc=cline_3forks_78(i5,i6,i1,i2,i3,i4)%c,dd=cline_3fo
* rks_78(i5,i6,i1,i2,i3,i4)%d,a1=ug7_5612(i5,i6,i1,i2)%a,b1=ug7_5612(i5,
* i6,i1,i2)%b,c1=ug7_5612(i5,i6,i1,i2)%c,d1=ug7_5612(i5,i6,i1,i2)%d,a2=r
* 8_34(i3,i4)%a,b2=r8_34(i3,i4)%b,c2=r8_34(i3,i4)%c,d2=r8_34(i3,i4)%d,pr
* q=p834q,m=rmass(id7),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r8_34(i3,i4)%a(1,jut)+rmass(id7)*r8_34(i3,i4)%b(1,jut)
      cx2=r8_34(i3,i4)%a(2,jut)+rmass(id7)*r8_34(i3,i4)%b(2,jut)
      cy1=p834q*r8_34(i3,i4)%b(1,jut)+rmass(id7)*r8_34(i3,i4)%a(
     & 1,jut)
      cy2=p834q*r8_34(i3,i4)%b(2,jut)+rmass(id7)*r8_34(i3,i4)%a(
     & 2,jut)
      cline_3forks_78(i5,i6,i1,i2,i3,i4)%a(iut,jut)=ug7_5612(i5,
     & i6,i1,i2)%a(iut,1)*cx1+ug7_5612(i5,i6,i1,i2)%c(iut,1)*cy1
     & +ug7_5612(i5,i6,i1,i2)%a(iut,2)*cx2+ug7_5612(i5,i6,i1,i2)
     & %c(iut,2)*cy2
      cline_3forks_78(i5,i6,i1,i2,i3,i4)%b(iut,jut)=ug7_5612(i5,
     & i6,i1,i2)%b(iut,1)*cx1+ug7_5612(i5,i6,i1,i2)%d(iut,1)*cy1
     & +ug7_5612(i5,i6,i1,i2)%b(iut,2)*cx2+ug7_5612(i5,i6,i1,i2)
     & %d(iut,2)*cy2
      cw1=r8_34(i3,i4)%c(1,jut)+rmass(id7)*r8_34(i3,i4)%d(1,jut)
      cw2=r8_34(i3,i4)%c(2,jut)+rmass(id7)*r8_34(i3,i4)%d(2,jut)
      cz1=p834q*r8_34(i3,i4)%d(1,jut)+rmass(id7)*r8_34(i3,i4)%c(
     & 1,jut)
      cz2=p834q*r8_34(i3,i4)%d(2,jut)+rmass(id7)*r8_34(i3,i4)%c(
     & 2,jut)
      cline_3forks_78(i5,i6,i1,i2,i3,i4)%c(iut,jut)=ug7_5612(i5,
     & i6,i1,i2)%a(iut,1)*cw1+ug7_5612(i5,i6,i1,i2)%c(iut,1)*cz1
     & +ug7_5612(i5,i6,i1,i2)%a(iut,2)*cw2+ug7_5612(i5,i6,i1,i2)
     & %c(iut,2)*cz2
      cline_3forks_78(i5,i6,i1,i2,i3,i4)%d(iut,jut)=ug7_5612(i5,
     & i6,i1,i2)%b(iut,1)*cw1+ug7_5612(i5,i6,i1,i2)%d(iut,1)*cz1
     & +ug7_5612(i5,i6,i1,i2)%b(iut,2)*cw2+ug7_5612(i5,i6,i1,i2)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* TsT -- aa=cline_3forks_78(i5,i6,i1,i2,i3,i4)%a,bb=cline_3forks_78(i5,i
* 6,i1,i2,i3,i4)%b,cc=cline_3forks_78(i5,i6,i1,i2,i3,i4)%c,dd=cline_3for
* ks_78(i5,i6,i1,i2,i3,i4)%d,a1=ug7_5612(i5,i6,i1,i2)%a,b1=ug7_5612(i5,i
* 6,i1,i2)%b,c1=ug7_5612(i5,i6,i1,i2)%c,d1=ug7_5612(i5,i6,i1,i2)%d,a2=r8
* _34(i3,i4)%a,b2=r8_34(i3,i4)%b,c2=r8_34(i3,i4)%c,d2=r8_34(i3,i4)%d,prq
* =p834q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=ug7_5612(i5,i6,i1,i2)%a(iut,1)+ug7_5612(i5,i6,i1,i2)%c
     & (iut,1)*rmass(id7)
      cx2=ug7_5612(i5,i6,i1,i2)%c(iut,2)*p834q+ug7_5612(i5,i6,i1
     & ,i2)%a(iut,2)*rmass(id7)
      cy1=ug7_5612(i5,i6,i1,i2)%b(iut,1)+ug7_5612(i5,i6,i1,i2)%d
     & (iut,1)*rmass(id7)
      cy2=ug7_5612(i5,i6,i1,i2)%d(iut,2)*p834q+ug7_5612(i5,i6,i1
     & ,i2)%b(iut,2)*rmass(id7)
      cw1=ug7_5612(i5,i6,i1,i2)%c(iut,1)*p834q+ug7_5612(i5,i6,i1
     & ,i2)%a(iut,1)*rmass(id7)
      cw2=ug7_5612(i5,i6,i1,i2)%a(iut,2)+ug7_5612(i5,i6,i1,i2)%c
     & (iut,2)*rmass(id7)
      cz1=ug7_5612(i5,i6,i1,i2)%d(iut,1)*p834q+ug7_5612(i5,i6,i1
     & ,i2)%b(iut,1)*rmass(id7)
      cz2=ug7_5612(i5,i6,i1,i2)%b(iut,2)+ug7_5612(i5,i6,i1,i2)%d
     & (iut,2)*rmass(id7)
      cline_3forks_78(i5,i6,i1,i2,i3,i4)%a(iut,1)=cx1*r8_34(i3,i
     & 4)%a(1,1)+cx2*r8_34(i3,i4)%b(2,1)
      cline_3forks_78(i5,i6,i1,i2,i3,i4)%b(iut,1)=cy1*r8_34(i3,i
     & 4)%a(1,1)+cy2*r8_34(i3,i4)%b(2,1)
      cline_3forks_78(i5,i6,i1,i2,i3,i4)%c(iut,1)=cw1*r8_34(i3,i
     & 4)%d(1,1)+cw2*r8_34(i3,i4)%c(2,1)
      cline_3forks_78(i5,i6,i1,i2,i3,i4)%d(iut,1)=cz1*r8_34(i3,i
     & 4)%d(1,1)+cz2*r8_34(i3,i4)%c(2,1)
      cline_3forks_78(i5,i6,i1,i2,i3,i4)%a(iut,2)=cw1*r8_34(i3,i
     & 4)%b(1,2)+cw2*r8_34(i3,i4)%a(2,2)
      cline_3forks_78(i5,i6,i1,i2,i3,i4)%b(iut,2)=cz1*r8_34(i3,i
     & 4)%b(1,2)+cz2*r8_34(i3,i4)%a(2,2)
      cline_3forks_78(i5,i6,i1,i2,i3,i4)%c(iut,2)=cx1*r8_34(i3,i
     & 4)%c(1,2)+cx2*r8_34(i3,i4)%d(2,2)
      cline_3forks_78(i5,i6,i1,i2,i3,i4)%d(iut,2)=cy1*r8_34(i3,i
     & 4)%c(1,2)+cy2*r8_34(i3,i4)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i5=1,2
      do i6=1,2
      do i1=1,2
      do i2=1,2
      do i3=1,2
      do i4=1,2
* mline -- res=cres_3forks_78(i5,i6,i1,i2,i3,i4)%pol(&1,&2),abcd=cline_3
* forks_78(i5,i6,i1,i2,i3,i4)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_78(i5,i6,i1,i2,i3,i4)%pol(iut,jut)=cline_3fork
     & s_78(i5,i6,i1,i2,i3,i4)%a(iut,jut)+rmassl*cline_3forks_78
     & (i5,i6,i1,i2,i3,i4)%b(iut,jut)+rmassr*cline_3forks_78(i5,
     & i6,i1,i2,i3,i4)%c(iut,jut)+rmassl*rmassr*cline_3forks_78(
     & i5,i6,i1,i2,i3,i4)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) +
     &                     cres_3forks_78(i5,i6,i1,i2,i3,i4)
     &                     %pol(i7,i8)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
      if(id1.eq.5 .and. rmh.ge.0.d0)then ! higgs insertion => use tsts
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
* TsTs -- aa=cline_3forks_78(i5,i6,i3,i4,i1,i2)%a,bb=cline_3forks_78(i5,
* i6,i3,i4,i1,i2)%b,cc=cline_3forks_78(i5,i6,i3,i4,i1,i2)%c,dd=cline_3fo
* rks_78(i5,i6,i3,i4,i1,i2)%d,a1=ug7_5634(i5,i6,i3,i4)%a,b1=ug7_5634(i5,
* i6,i3,i4)%b,c1=ug7_5634(i5,i6,i3,i4)%c,d1=ug7_5634(i5,i6,i3,i4)%d,a2=r
* 8_12(i1,i2)%a,b2=r8_12(i1,i2)%b,c2=r8_12(i1,i2)%c,d2=r8_12(i1,i2)%d,pr
* q=p812q,m=rmass(id7),nsum=0
      do iut=1,2
      do jut=1,2
      cx1=r8_12(i1,i2)%a(1,jut)+rmass(id7)*r8_12(i1,i2)%b(1,jut)
      cx2=r8_12(i1,i2)%a(2,jut)+rmass(id7)*r8_12(i1,i2)%b(2,jut)
      cy1=p812q*r8_12(i1,i2)%b(1,jut)+rmass(id7)*r8_12(i1,i2)%a(
     & 1,jut)
      cy2=p812q*r8_12(i1,i2)%b(2,jut)+rmass(id7)*r8_12(i1,i2)%a(
     & 2,jut)
      cline_3forks_78(i5,i6,i3,i4,i1,i2)%a(iut,jut)=ug7_5634(i5,
     & i6,i3,i4)%a(iut,1)*cx1+ug7_5634(i5,i6,i3,i4)%c(iut,1)*cy1
     & +ug7_5634(i5,i6,i3,i4)%a(iut,2)*cx2+ug7_5634(i5,i6,i3,i4)
     & %c(iut,2)*cy2
      cline_3forks_78(i5,i6,i3,i4,i1,i2)%b(iut,jut)=ug7_5634(i5,
     & i6,i3,i4)%b(iut,1)*cx1+ug7_5634(i5,i6,i3,i4)%d(iut,1)*cy1
     & +ug7_5634(i5,i6,i3,i4)%b(iut,2)*cx2+ug7_5634(i5,i6,i3,i4)
     & %d(iut,2)*cy2
      cw1=r8_12(i1,i2)%c(1,jut)+rmass(id7)*r8_12(i1,i2)%d(1,jut)
      cw2=r8_12(i1,i2)%c(2,jut)+rmass(id7)*r8_12(i1,i2)%d(2,jut)
      cz1=p812q*r8_12(i1,i2)%d(1,jut)+rmass(id7)*r8_12(i1,i2)%c(
     & 1,jut)
      cz2=p812q*r8_12(i1,i2)%d(2,jut)+rmass(id7)*r8_12(i1,i2)%c(
     & 2,jut)
      cline_3forks_78(i5,i6,i3,i4,i1,i2)%c(iut,jut)=ug7_5634(i5,
     & i6,i3,i4)%a(iut,1)*cw1+ug7_5634(i5,i6,i3,i4)%c(iut,1)*cz1
     & +ug7_5634(i5,i6,i3,i4)%a(iut,2)*cw2+ug7_5634(i5,i6,i3,i4)
     & %c(iut,2)*cz2
      cline_3forks_78(i5,i6,i3,i4,i1,i2)%d(iut,jut)=ug7_5634(i5,
     & i6,i3,i4)%b(iut,1)*cw1+ug7_5634(i5,i6,i3,i4)%d(iut,1)*cz1
     & +ug7_5634(i5,i6,i3,i4)%b(iut,2)*cw2+ug7_5634(i5,i6,i3,i4)
     & %d(iut,2)*cz2
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      else                      ! no higgs insertion => tst is enough
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
* TsT -- aa=cline_3forks_78(i5,i6,i3,i4,i1,i2)%a,bb=cline_3forks_78(i5,i
* 6,i3,i4,i1,i2)%b,cc=cline_3forks_78(i5,i6,i3,i4,i1,i2)%c,dd=cline_3for
* ks_78(i5,i6,i3,i4,i1,i2)%d,a1=ug7_5634(i5,i6,i3,i4)%a,b1=ug7_5634(i5,i
* 6,i3,i4)%b,c1=ug7_5634(i5,i6,i3,i4)%c,d1=ug7_5634(i5,i6,i3,i4)%d,a2=r8
* _12(i1,i2)%a,b2=r8_12(i1,i2)%b,c2=r8_12(i1,i2)%c,d2=r8_12(i1,i2)%d,prq
* =p812q,m=rmass(id7),nsum=0
      do iut=1,2
      cx1=ug7_5634(i5,i6,i3,i4)%a(iut,1)+ug7_5634(i5,i6,i3,i4)%c
     & (iut,1)*rmass(id7)
      cx2=ug7_5634(i5,i6,i3,i4)%c(iut,2)*p812q+ug7_5634(i5,i6,i3
     & ,i4)%a(iut,2)*rmass(id7)
      cy1=ug7_5634(i5,i6,i3,i4)%b(iut,1)+ug7_5634(i5,i6,i3,i4)%d
     & (iut,1)*rmass(id7)
      cy2=ug7_5634(i5,i6,i3,i4)%d(iut,2)*p812q+ug7_5634(i5,i6,i3
     & ,i4)%b(iut,2)*rmass(id7)
      cw1=ug7_5634(i5,i6,i3,i4)%c(iut,1)*p812q+ug7_5634(i5,i6,i3
     & ,i4)%a(iut,1)*rmass(id7)
      cw2=ug7_5634(i5,i6,i3,i4)%a(iut,2)+ug7_5634(i5,i6,i3,i4)%c
     & (iut,2)*rmass(id7)
      cz1=ug7_5634(i5,i6,i3,i4)%d(iut,1)*p812q+ug7_5634(i5,i6,i3
     & ,i4)%b(iut,1)*rmass(id7)
      cz2=ug7_5634(i5,i6,i3,i4)%b(iut,2)+ug7_5634(i5,i6,i3,i4)%d
     & (iut,2)*rmass(id7)
      cline_3forks_78(i5,i6,i3,i4,i1,i2)%a(iut,1)=cx1*r8_12(i1,i
     & 2)%a(1,1)+cx2*r8_12(i1,i2)%b(2,1)
      cline_3forks_78(i5,i6,i3,i4,i1,i2)%b(iut,1)=cy1*r8_12(i1,i
     & 2)%a(1,1)+cy2*r8_12(i1,i2)%b(2,1)
      cline_3forks_78(i5,i6,i3,i4,i1,i2)%c(iut,1)=cw1*r8_12(i1,i
     & 2)%d(1,1)+cw2*r8_12(i1,i2)%c(2,1)
      cline_3forks_78(i5,i6,i3,i4,i1,i2)%d(iut,1)=cz1*r8_12(i1,i
     & 2)%d(1,1)+cz2*r8_12(i1,i2)%c(2,1)
      cline_3forks_78(i5,i6,i3,i4,i1,i2)%a(iut,2)=cw1*r8_12(i1,i
     & 2)%b(1,2)+cw2*r8_12(i1,i2)%a(2,2)
      cline_3forks_78(i5,i6,i3,i4,i1,i2)%b(iut,2)=cz1*r8_12(i1,i
     & 2)%b(1,2)+cz2*r8_12(i1,i2)%a(2,2)
      cline_3forks_78(i5,i6,i3,i4,i1,i2)%c(iut,2)=cx1*r8_12(i1,i
     & 2)%c(1,2)+cx2*r8_12(i1,i2)%d(2,2)
      cline_3forks_78(i5,i6,i3,i4,i1,i2)%d(iut,2)=cy1*r8_12(i1,i
     & 2)%c(1,2)+cy2*r8_12(i1,i2)%d(2,2)
      end do
      end do
      end do
      end do
      end do
      end do
      end do
      endif
  
      do i5=1,2
      do i6=1,2
      do i3=1,2
      do i4=1,2
      do i1=1,2
      do i2=1,2
* mline -- res=cres_3forks_78(i5,i6,i3,i4,i1,i2)%pol(&1,&2),abcd=cline_3
* forks_78(i5,i6,i3,i4,i1,i2)%,m1=rmassl,m2=rmassr,den=0,nsum=0
      do iut=1,2
      do jut=1,2
      cres_3forks_78(i5,i6,i3,i4,i1,i2)%pol(iut,jut)=cline_3fork
     & s_78(i5,i6,i3,i4,i1,i2)%a(iut,jut)+rmassl*cline_3forks_78
     & (i5,i6,i3,i4,i1,i2)%b(iut,jut)+rmassr*cline_3forks_78(i5,
     & i6,i3,i4,i1,i2)%c(iut,jut)+rmassl*rmassr*cline_3forks_78(
     & i5,i6,i3,i4,i1,i2)%d(iut,jut)
      enddo
      enddo
      end do
      end do
      end do
      end do
      end do
      end do
  
* Add result to cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7)                   
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) =
     &                     cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,7) +
     &                     cres_3forks_78(i5,i6,i3,i4,i1,i2)
     &                     %pol(i7,i8)
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
      endif    !if((ilept(id5).ne.1) .and. (ilept(id7).ne.1))
  
  
  
  
* the resulting amplitudes are now divided by sqrt(abs(p.k0)) for every 
* external particle                                                     
  
      spk0=sqrt(p1k0*p2k0*p3k0*p4k0*p5k0*p6k0*p7k0*p8k0)
  
      do i1=1,2
        do i2=1,2
          do i3=1,2
            do i4=1,2
              do i5=1,2
                do i6=1,2
                  do i7=1,2
                    do i8=1,2
                      do k=1,7
                        cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,k) =
     &                       cres(i1,i2,i3,i4,i5,i6)%caux(i7,i8,k)/spk0
                      enddo
                    enddo
                  enddo
                enddo
              enddo
            enddo
          enddo
        enddo
      enddo
  
  
* Sum and average over spin and colour factors                          
* has to be performed externally, when the |amp|**2 is computed         
  
      return
      end
